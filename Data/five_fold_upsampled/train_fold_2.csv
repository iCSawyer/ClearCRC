patch,msg,lang,relevance,informativeness,expression
"@@ -161,6 +161,13 @@ static void gamma_control_manager_get_gamma_control(struct wl_client *client,
 	wl_resource_set_implementation(gamma_control->resource, &gamma_control_impl,
 		gamma_control, gamma_control_handle_resource_destroy);
 
+	if (output == NULL) {
+		wl_resource_set_user_data(gamma_control->resource, NULL);
+		zwlr_gamma_control_v1_send_failed(gamma_control->resource);
+		free(gamma_control);
+		return;
+	}
+
 	wl_signal_add(&output->events.destroy,
 		&gamma_control->output_destroy_listener);
 	gamma_control->output_destroy_listener.notify =",This code could be rerouted to avoid the unnecessary gamma_control allocation,c,1,1,1
"@@ -3481,5 +3481,17 @@ move_mm_reg_opcode(bool aligned16, bool aligned32)
 #    endif /* X86/ARM */
 }
 
+uint
+move_mm_avx512_reg_opcode(bool aligned64)
+{
+#    ifdef X86
+    CLIENT_ASSERT(ZMM_ENABLED(), ""move_mm_avx512_reg_opcode on unsupported processor"");
+    return (aligned64 ? OP_vmovdqa64 : OP_vmovdqu64);
+#    else
+    CLIENT_ASSERT(false, ""move_mm_avx512_reg_opcode not supported on ARM/AArch64"");
+    return 0;
+#    endif /* X86 */
+}
+
 #endif /* !STANDALONE_DECODER */
 /****************************************************************************/",Isn't this an internal function? CLIENT_ASSERT is for API functions for reporting interface errors.,c,1,1,1
"@@ -709,7 +709,7 @@ read_vex(byte *pc, decode_info_t *di, byte instr_byte,
 }
 
 /* Given an instr_info_t PREFIX_EXT entry, reads the next entry based on the prefixes.
- * Note that this function does not initialise the opcode field in \p di but is set in
+ * Note that this function does not initialize the opcode field in \p di but is set in
  * \p info->type.
  */
 static inline const instr_info_t *",Not a fan of British spelling?,c,1,0,1
"@@ -1470,6 +1470,7 @@ func isValidRuleForXDP(rule *proto.Rule) bool {
 		len(rule.DstPorts) == 0 &&
 		len(rule.DstNamedPortIpSetIds) == 0 &&
 		len(rule.DstIpSetIds) == 0 &&
+		len(rule.DstIpPortSetIds) == 0 &&
 		len(rule.NotDstNet) == 0 &&
 		len(rule.NotDstPorts) == 0 &&
 		len(rule.NotDstIpSetIds) == 0 &&","Yep, looks right; your new selector _should_ disqualify the rule from being XDP accelerated.",c,1,1,1
"@@ -92,7 +92,11 @@ int flb_parser_json_do(struct flb_parser *parser,
             off = 0;
             msgpack_unpacked_destroy(&result);
             msgpack_unpacked_init(&result);
-            msgpack_unpack_next(&result, tmp_out_buf, tmp_out_size, &off);
+            if (msgpack_unpack_next(&result, tmp_out_buf, tmp_out_size, &off) < 0)
+{
+            msgpack_unpacked_destroy(&result);
+return -1;
+}
             map = result.data;
         }
     }",something went wrong with indentation there,c,0,0,1
"@@ -0,0 +1,12 @@
+package testutils
+
+import (
+	""os""
+	""path""
+)
+
+func TestDataFile(name string) string {
+	dir, _ := os.Getwd()
+
+	return path.Join(dir, ""testdata"", name)
+}","Would it make sense to create an empty file here, perhaps in a tmp dir, instead of checking empty files into Git?",c,1,1,1
"@@ -133,6 +133,11 @@ proc_init(void)
         global_heap_free(buf, PAGE_SIZE HEAPACCT(ACCT_OTHER));
         os_close(cpuinfo);
     }
+    CLIENT_ASSERT(dcache_zva_size > 0, ""invalid dcache block size for zeroing"");
+    LOG(GLOBAL, LOG_TOP, 1, ""Data cache block size for zeroing is %d bytes\n"",
+        dcache_zva_size);
+    CLIENT_ASSERT(cache_line_size == dcache_zva_size,
+                  ""cache line and block sizes do not match"");
 #endif
 }
 ",Will this fail in the DR_HOST_NOT_TARGET case? Do we want to maybe use a default to prevent this and other failures due to not getting the `dcache_zva_size`?,c,1,1,1
"@@ -54,6 +54,7 @@ void handle_keyboard_key(struct libinput_event *event,
 	struct libinput_event_keyboard *kbevent =
 		libinput_event_get_keyboard_event(event);
 	struct wlr_event_keyboard_key wlr_event = { 0 };
+	wlr_event.device = wlr_dev;
 	wlr_event.time_msec =
 		usec_to_msec(libinput_event_keyboard_get_time_usec(kbevent));
 	wlr_event.keycode = libinput_event_keyboard_get_key(kbevent);",`wlr_event.keyboard` is undefined.,c,1,1,1
"@@ -398,6 +398,7 @@ void wlr_send_tablet_v2_tablet_tool_proximity_out(
 			send_tool_frame(tool->current_client);
 		}
 		zwp_tablet_tool_v2_send_proximity_out(tool->current_client->resource);
+		send_tool_frame(tool->current_client);
 
 		tool->current_client = NULL;
 		tool->focused_surface = NULL;",Using `queue_tool_frame` is probably enough to make sure we don't send two.,c,1,1,1
"@@ -0,0 +1,16 @@
+#include <stdlib.h>
+#include <string.h>
+#include <wayland-server.h>
+#include <wlr/interfaces/wlr_tablet_tool.h>
+#include <wlr/types/wlr_tablet_tool.h>
+
+void wlr_tablet_tool_tool_init(struct wlr_tablet_tool_tool *tool) {
+	// Intentionaly empty (for now)
+}
+
+void wlr_tablet_tool_tool_destroy(struct wlr_tablet_tool_tool *tool) {
+	if (!tool) {
+		return;
+	}
+	free(tool);
+}","Should be in a header file, or removed.",c,1,1,1
"@@ -53,7 +53,7 @@ class OrderedCheckersAction(argparse.Action):
         namespace.ordered_checkers = ordered_checkers
 
 
-# ------------------------------------------------------------------------------
+# -----------------------------------------------------------------------------
 class DeprecatedOptionAction(argparse.Action):
     """"""
     Deprecated argument action.",Maybe we could remove these as well if we are already touching these.,c,1,1,1
"@@ -0,0 +1,15 @@
+#include<iostream>
+using namespace std;
+int main(){
+    int digit = 0;
+    int n;
+    cout<<""enter digit""<<endl;
+    cin>>n;
+    while(n!=0){
+        n = n/10;
+        digit++;
+    }
+    cout<<digit;
+    return 0;
+    
+}","if n is 0, it'd print 0. but the number of digits would be 1. correct it",c,1,1,1
"@@ -140,8 +140,8 @@ type Config struct {
         PrometheusMetricsEnabled bool `config:""bool;false""`
         PrometheusMetricsPort    int  `config:""int(0,65535);9091""`
 
-        FailsafeInboundHostPorts  []uint16 `config:""port-list;22;die-on-fail""`
-        FailsafeOutboundHostPorts []uint16 `config:""port-list;2379,2380,4001,7001;die-on-fail""`
+        FailsafeInboundHostPorts  []ProtoPort `config:""port-list;tcp:22,udp:68;die-on-fail""`
+        FailsafeOutboundHostPorts []ProtoPort `config:""port-list;tcp:2379,tcp:2380,tcp:4001,tcp:7001,udp:53,udp:67;die-on-fail""`
 
         UsageReportingEnabled bool   `config:""bool;true""`
         ClusterGUID           string `config:""string;baddecaf""`",Not a big fan of this format. We also need to update the docs - can you link me to that PR when it's ready? It should probably explain the reason for each port being included as well.,c,1,0,1
"@@ -185,9 +185,8 @@ class SourceCodeCommentHandler(object):
         for a bug line.
         """"""
         source_file = self.__source_file
-        LOG.debug(""Checking for source code comments in the source file '{0}'""
-                  ""at line {1}"".format(self.__source_file,
-                                       bug_line))
+        LOG.debug(""Checking for source code comments in the source file '%s'""
+                  ""at line %s"", self.__source_file, bug_line)
 
         previous_line_num = bug_line - 1
 ","As far as I've seen, this `bug_line` really is a string, but I wouldn't have counted on that.",c,1,1,1
"@@ -34,6 +34,7 @@
  */
 
 #include ""globals.h""
+#include ""arch.h""
 
 void
 unit_test_io(void);","Put the unit tests in an arch/ location, not in this top-level driver file. IIRC I suggested arch.c in my original request for a unit test, but arch/x86 may be better.",c,1,1,1
"@@ -352,6 +352,8 @@ static fpga_result driver_register_event(fpga_handle handle,
 		} else if (objtype == FPGA_ACCELERATOR) {
 			return send_port_event_request(handle, event_handle, FPGA_IRQ_ASSIGN);
 		}
+		FPGA_ERR(""Invalid objtype: %d"", objtype);
+		return FPGA_EXCEPTION;
 	case FPGA_EVENT_INTERRUPT:
 		if (objtype != FPGA_ACCELERATOR) {
 			FPGA_MSG(""User events need an accelerator object"");","@tswhison should we try to avoid multiple return statements in a function by setting the ""res = FPGA_EXCEPTION in default case and returning the 'res' variable at the end of this function?",c,0,1,1
"@@ -59,7 +59,6 @@ EXPORT void
 jacobi_init(int matrix_size, bool enable_annotations)
 {
     invoke_annotations = enable_annotations;
-
     x_temp = (double *)malloc(matrix_size * sizeof(double));
     if (invoke_annotations)
         TEST_ANNOTATION_EIGHT_ARGS(matrix_size, 102, 103, 104, 105, 106, 107, 108);",Best to revert this to avoid superfluous unrelated noise in the diff.,c,1,1,1
"@@ -355,9 +355,14 @@ static bool gles2_init_wl_display(struct wlr_renderer *wlr_renderer,
 		struct wl_display *wl_display) {
 	struct wlr_gles2_renderer *renderer =
 		gles2_get_renderer(wlr_renderer);
-	if (!wlr_egl_bind_display(renderer->egl, wl_display)) {
-		wlr_log(WLR_INFO, ""failed to bind wl_display to EGL"");
-		return false;
+
+	if (renderer->egl->exts.bind_wayland_display_wl) {
+		if (!wlr_egl_bind_display(renderer->egl, wl_display)) {
+			wlr_log(WLR_ERROR, ""Failed to bind wl_display to EGL"");
+			return false;
+		}
+	} else {
+		wlr_log(WLR_INFO, ""EGL_WL_bind_wayland_display is not supported"");
 	}
 	return true;
 }",Checking for BIND_WAYLAND_DISPLAY_WL is a separate change or should at least be mentioned in the commit message.,c,1,1,1
"@@ -1085,6 +1085,9 @@ module_lookup_symbol(ELF_SYM_TYPE *sym, os_privmod_data_t *pd)
      */
     ASSERT_OWN_RECURSIVE_LOCK(true, &privload_lock);
     mod = privload_first_module();
+    /* Symbols are currently looked up following the dependency chain depth-first instead
+     * of breadth-first as reflected in the global list 'modlist' (xref i#3850).
+     */
     while (mod != NULL) {
         pd = mod->os_privmod_data;
         ASSERT(pd != NULL && name != NULL);",This should be an XXX (or FIXME). Please mention that the ELF spec requires breadth-first symbol lookup.,c,1,1,1
"@@ -2009,6 +2009,7 @@ decode_operand(decode_info_t *di, byte optype, opnd_size_t opsize, opnd_t *opnd)
          */
         return decode_operand(di, TYPE_E, opsize, opnd);
     case TYPE_L: {
+        CLIENT_ASSERT(!TEST(PREFIX_EVEX_LL, di->prefixes), ""XXX i#1312: unsupported."");
         /* part of AVX: top 4 bits of 8-bit immed select xmm/ymm register */
         ptr_int_t immed = get_immed(di, OPSZ_1);
         reg_id_t reg = (reg_id_t)(immed & 0xf0) >> 4;","> Add instructions vunpcklps, vunpcklpd, more see below. There must be something which makes all these instructions similar: why did you group these particular ones? Use that in the title line. E.g., ""Add evex-encoded 0f{1,2}* opcodes"" or whatever it is.",c,1,1,1
"@@ -5761,6 +5761,19 @@ mark_page_as_guard(byte *pc)
     ASSERT(res);
 }
 
+/* Removes guard protection from page containing pc */
+void
+unmark_page_as_guard(byte *pc, uint prot)
+{
+    uint old_prot;
+    int res;
+    byte *start_page = (byte *)ALIGN_BACKWARD(pc, PAGE_SIZE);
+
+    uint flags = memprot_to_osprot(prot & ~MEMPROT_GUARD);
+    res = protect_virtual_memory(start_page, PAGE_SIZE, flags, &old_prot);
+    ASSERT(res);
+}
+
 /* Change page protection for pc:pc+size.
  * If set is false, makes [un]writable depending on add_writable argument,
  * preserving other flags; else, sets protection to new_prot.","Maybe assert, or curiosity if race could happen, that old_prot had PAGE_GUARD",c,1,1,1
"@@ -2853,8 +2853,10 @@ mangle_icache_op(dcontext_t *dcontext, instrlist_t *ilist, instr_t *instr,
                 opnd_create_base_disp(dr_reg_stolen, DR_REG_NULL, 0, 16, OPSZ_16),
                 opnd_create_reg(xt == dr_reg_stolen ? DR_REG_X0 : xt),
                 opnd_create_reg(DR_REG_X30)));
+#    ifndef DR_HOST_NOT_TARGET
         insert_mov_immed_arch(dcontext, NULL, NULL, (ptr_int_t)icache_op_ic_ivau_asm,
                               opnd_create_reg(DR_REG_X30), ilist, instr, NULL, NULL);
+#    endif
         PRE(ilist, instr, /* mov x0, x28 */
             XINST_CREATE_move(dcontext, opnd_create_reg(DR_REG_X0),
                               opnd_create_reg(dr_reg_stolen)));","This mangling code is never executed when DR_HOST_NOT_TARGET is set right? Just for my understanding, you are inserting ifdef outs primarily for compilation purposes no? If so, maybe add aa ASSERT_NOT_REACHED() somewhere?",c,1,1,1
"@@ -319,7 +319,7 @@ ot_variant_bsearch_str (GVariant   *array,
                         int        *out_pos)
 {
   gsize imax, imin;
-  gsize imid;
+  gsize imid = -1;
   gsize n;
 
   n = g_variant_n_children (array);","GCC is unfortunately not smart enough to figure out that the loop is guaranteed to run at least once. Maybe if we put it an the else block of the `n == 0` condition, but this is easier.",c,1,1,1
"@@ -455,6 +455,12 @@ static CALI_BPF_INLINE int calico_tc(struct __sk_buff *skb)
 		}
 	}
 
+	// Drop packets with IP options
+	if (ip_header->ihl > 5) {
+		fwd.reason = CALI_REASON_IP_OPTIONS;
+		CALI_DEBUG(""Drop packets with IP options\n"");
+		goto deny;
+	}
 	// Setting all of these up-front to keep the verifier happy.
 	struct tcphdr *tcp_header = (void*)(ip_header+1);
 	struct udphdr *udp_header = (void*)(ip_header+1);",I would say `!= 5`; A packet with <5 would be malformed.,c,1,1,1
"@@ -430,7 +430,7 @@ insert_meta_call_vargs(dcontext_t *dcontext, instrlist_t *ilist, instr_t *instr,
              * which specifies that the caller must save xax (and xcx and xdx)
              */
             insert_get_mcontext_base(dcontext, ilist, instr, SCRATCH_REG0);
-# ifdef AARCH64
+# ifdef AARCHXX
             /* TLS_REG1_SLOT is not safe since it may be used by clients.
              * We save it to dcontext.mcontext.x0.
              */","I realized that this is wrong. `SCRATCH_REG0` is `r0` on ARM, which is the first argument to each clean call... x86 is clearly fine though. I'm curious, how does this work for Aarch64 either then? Isn't `x0` the first argument to clean calls as well? @derekbruening thoughts?",c,0,1,1
"@@ -14,4 +14,4 @@ set_false_path -from [get_keepers *|platform_shim_ccip|c.ccip_async_shim|async_s
 ##
 ## Reset path to local memory clock after clock crossing.
 ##
-set_false_path -to [get_keepers *|platform_shim_avalon_mem_if|c.local_mem_reset_pipe[0]]
+set_false_path -to [get_keepers *|platform_shim_avalon_mem_if|c.mm_async*.local_mem_reset_pipe[0]]",What does this settings do? local_mem_reset_pipe value set to 0?,c,1,1,1
"@@ -570,10 +570,12 @@ void wlr_xdg_popup_destroy(struct wlr_xdg_surface *surface) {
 
 static void xdg_popup_get_position(struct wlr_xdg_popup *popup,
                 double *popup_sx, double *popup_sy) {
-        struct wlr_xdg_surface *parent =
-                wlr_xdg_surface_from_wlr_surface(popup->parent);
-        struct wlr_box parent_geo;
-        wlr_xdg_surface_get_geometry(parent, &parent_geo);
+        struct wlr_box parent_geo = {0};
+        if (wlr_surface_is_xdg_surface(popup->parent)) {
+                struct wlr_xdg_surface *parent =
+                        wlr_xdg_surface_from_wlr_surface(popup->parent);
+                wlr_xdg_surface_get_geometry(parent, &parent_geo);
+        }
         *popup_sx = parent_geo.x + popup->geometry.x -
                 popup->base->geometry.x;
         *popup_sy = parent_geo.y + popup->geometry.y -","Perhaps I've misunderstood the issue, but don't we need to use the parent coordinates if the parent is a layer surface as well? Currently I don't see how this PR actually changes the result.",c,0,1,1
"@@ -79,7 +79,8 @@ func (l *LivenessScanner) Scan() {
 			// Look up the reverse entry, where we do the book-keeping.
 			revEntryBytes, err := l.ctMap.Get(ctVal.ReverseNATKey().AsBytes())
 			if err != nil && bpf.IsNotExists(err) {
-				// Forward entry exists but no reverse entry (and the grace period has expired).
+				// Forward entry exists but no reverse entry. We might have come across the reverse
+				// entry first and removed it. It is useless on its own, so delete it now.
 				log.Info(""Found a forward NAT conntrack entry with no reverse entry, removing..."")
 				err := l.ctMap.Delete(k)
 				log.WithError(err).Debug(""Deletion result"")",Think you need to check the creation timestamp here to make sure that the entry wasn't just created (or we might be racing with the BPF program creating the pair of keys).,c,1,1,1
"@@ -843,13 +843,6 @@ err:
     return NULL;
 }
 
-/*  Create namespace name for jobid 'id'
- */
-static int job_get_ns_name (char *buf, int bufsz, flux_jobid_t id)
-{
-    return fluid_encode (buf, bufsz, id, FLUID_STRING_DOTHEX);
-}
-
 static double job_get_kill_timeout (flux_t *h)
 {
     double t = DEFAULT_KILL_TIMEOUT;","typo in commit message ""notiation"" -> ""notation""",c,0,0,1
"@@ -914,8 +914,7 @@ insert_reachable_cti(dcontext_t *dcontext, instrlist_t *ilist, instr_t *where,
 {
     ASSERT(scratch != REG_NULL); /* required */
     /* load target into scratch register */
-    insert_mov_immed_ptrsz(dcontext, (ptr_int_t)
-                           PC_AS_JMP_TGT(dr_get_isa_mode(dcontext), target),
+    insert_mov_immed_ptrsz(dcontext, (ptr_int_t)target,
                            opnd_create_reg(scratch), ilist, where, NULL, NULL);
     /* even if a call and not a jmp, we can skip this if it doesn't return */
     if (!jmp && returns) {","What I'm puzzling over is the reason that 850c10c0b8c3390608715074f0ce94379d039f2f put this here: it is called out in the commit message so there must have been something that did not have the lsb set. Not everything does: e.g., fragment tags deliberately do not have lsb set. There must have been something like that that would make its way here. Does a test suite run on arm hit any discrepancy here?",c,1,1,1
"@@ -350,7 +350,7 @@ session_thread_set_tls_interaction_cb (ThreadClosure *thread_closure,
   const char *cert_and_key_path = data; /* str\0str\0 in one malloc buf */
   const char *cert_path = cert_and_key_path;
   const char *key_path = cert_and_key_path + strlen (cert_and_key_path) + 1;
-  glnx_unref_object OstreeTlsCertInteraction *interaction = NULL;
+  g_autoptr(OstreeTlsCertInteraction) interaction = NULL;
 
   /* The GTlsInteraction instance must be created in the
    * session thread so it uses the correct GMainContext. */","AFAICT, there's no autocleanup defined for `OstreeTlsCertInteraction` yet.",c,1,1,1
"@@ -34,7 +34,7 @@ from shared.ttypes import DBStatus
 LOG = get_logger('system')
 
 
-class DBContext():
+class DBContext:
     """"""
     Simple helper class to setup and sql engine, a database session
     and a connection.",Please use new-style class `DBContext(object)`,c,1,1,1
"@@ -792,18 +792,6 @@ static void implicit_tool_up(struct wlr_tablet_tool_v2_grab *grab) {
         check_and_release_implicit_grab(grab);
 }
 
-/* Only send the motion event, when we are over the surface for now */
-static void implicit_tool_motion(
-        struct wlr_tablet_tool_v2_grab *grab, double x, double y) {
-        struct implicit_grab_state *state = grab->data;
-        if (state->focused != state->original) {
-                return;
-        }
-
-        wlr_send_tablet_v2_tablet_tool_motion(grab->tool, x, y);
-}
-
-
 static void implicit_tool_button(
         struct wlr_tablet_tool_v2_grab *grab, uint32_t button,
         enum zwp_tablet_pad_v2_button_state state) {",Hmm. But using the default handler would send the event to the wrong surface then?,c,1,1,1
"@@ -6,6 +6,7 @@
 #include <wlr/types/wlr_xdg_output.h>
 #include <wlr/util/log.h>
 #include ""xdg-output-unstable-v1-protocol.h""
+#include ""types/wlr_output_layout.h""
 
 #define OUTPUT_MANAGER_VERSION 2
 ",Hmmm. I'm not a fan of this.,c,0,0,1
"@@ -474,12 +474,12 @@ class TestAnalyze(unittest.TestCase):
         """"""
         build_json = os.path.join(self.test_workspace, ""build_extra_args.json"")
         report_dir = os.path.join(self.test_workspace, ""reports_extra_args"")
-        source_file = os.path.join(self.test_dir, ""extra_args.c"")
+        source_file = os.path.join(self.test_dir, ""extra_args.cpp"")
         tidyargs_file = os.path.join(self.test_dir, ""tidyargs"")
         saargs_file = os.path.join(self.test_dir, ""saargs"")
 
         build_log = [{""directory"": self.test_dir,
-                      ""command"": ""cc -c "" + source_file,
+                      ""command"": ""g++ -c "" + source_file,
                       ""file"": source_file
                       }]
 ",I don't see any test cases where you use the `--analyzer-config` and `--tidyargs` in the same command. So please create a new test case or extend an existing one with it.,c,1,1,1
"@@ -794,3 +794,13 @@ const char *h2o_npn_protocols = NPN_PROTOCOLS_CORE ""\x08""
                                                    ""http/1.1"";
 
 uint64_t h2o_connection_id = 0;
+
+extern void h2o_http2_wbuf_buffer_prototype__dispose(void);
+extern void h2o_mem_pool_allocator__dispose(void);
+
+void h2o_tls_data_dispose(void)
+{
+    h2o_mem_pool_allocator__dispose();
+    h2o_http2_wbuf_buffer_prototype__dispose();
+    h2o_mem_allocator_recycle__dispose(&h2o_socket_buffer_prototype.allocator);
+}","I appreciate your effort to keep the modularization. But for this case, I wouldn't mind changing the linkage of static thread-local variables to extern (and releasing them directly in this function), considering the fact that we already have `h2o_socket_buffer_prototype`. For example, you can rename `mempool_allocator` to `h2o_mem_pool_allocator` and call `h2o_mem_dispose_recycle(&h2o_mem_pool_allocator)` here. The same goes to `wbuf_buffer_prototype` (which could be renamed to `h2o_http2_wbuf_buffer_prototype`.",c,1,1,0
"@@ -486,6 +486,9 @@ static void render_output(struct roots_output *output) {
 		goto renderer_end;
 	}
 
+	// Uncomment this line to debug damage tracking
+	//wlr_renderer_clear(renderer, (float[]){1, 1, 0, 0});
+
 	int nrects;
 	pixman_box32_t *rects = pixman_region32_rectangles(&damage, &nrects);
 	for (int i = 0; i < nrects; ++i) {",I would rather see a startup flag to give to rootston for this purpose,c,1,1,1
"@@ -936,6 +936,8 @@ int32_t h2o_socket_getport(struct sockaddr *sa)
 static void create_ossl(h2o_socket_t *sock)
 {
     sock->ssl->ossl = SSL_new(sock->ssl->ssl_ctx);
+    /* set app data to be used in h2o_socket_ssl_new_session_cb */
+    assert(SSL_set_app_data(sock->ssl->ossl, sock));
     setup_bio(sock);
 }
 ","I think you need to split `assert` and the call to `SSL_set_app_data`. Otherwise, the call to the OpenSSL function will be eliminated when `NBEGUG` is set.",c,1,1,1
"@@ -298,7 +298,7 @@ commit_loose_regfile_object (OstreeRepo        *self,
        */
       if (S_ISREG (mode))
         {
-          const mode_t content_mode = (mode & (S_IFREG | 0775)) | S_IRUSR;
+          const mode_t content_mode = (mode & USERMODE_CANONICAL_MASK) | S_IFREG | S_IRUSR;
           if (!glnx_fchmod (tmpf->fd, content_mode, error))
             return FALSE;
         }","Hmm. There's a really important difference between `bare-user` and `bare-user-only`, which is that `bare-user` is intended to be losslessly convertible to-from `bare`. Now, we store the mode as an xattr, but it kind of intentional that the checked out tree mostly resembles what's in the `bare`. I'd be happier I think if this change only touched code paths involved in `bare-user-only`. Then the messaging is clearer.",c,1,1,1
"@@ -51,16 +51,7 @@ var _ = Context(""etcd connection interruption"", func() {
 
 	BeforeEach(func() {
 		felixes, etcd, client = infrastructure.StartNNodeEtcdTopology(2, infrastructure.DefaultTopologyOptions())
-
-		// Install a default profile that allows all ingress and egress, in the absence of any Policy.
-		defaultProfile := api.NewProfile()
-		defaultProfile.Name = ""default""
-		defaultProfile.Spec.LabelsToApply = map[string]string{""default"": """"}
-		defaultProfile.Spec.Egress = []api.Rule{{Action: api.Allow}}
-		defaultProfile.Spec.Ingress = []api.Rule{{Action: api.Allow}}
-		_, err := client.Profiles().Create(utils.Ctx, defaultProfile, utils.NoOptions)
-		Expect(err).NotTo(HaveOccurred())
-
+		infrastructure.CreateDefaultProfile(client, ""default"", map[string]string{""default"": """"}, """")
 		// Wait until the tunl0 device appears; it is created when felix inserts the ipip module
 		// into the kernel.
 		Eventually(func() error {","In the old code here there was no Source Selector, but CreateDefaultProfile will specify a Source Selector of `""""`. Is that equivalent?",c,1,1,1
"@@ -128,7 +128,7 @@ get_thread_private_dcontext(void)
 void
 external_error(const char *file, int line, const char *msg)
 {
-    fprintf(stderr, ""Usage error: %s (%s, line %d)\n"", msg, file, line);
+    print_file(STDERR, ""Usage error: %s (%s, line %d)\n"", msg, file, line);
     abort();
 }
 ",Not sure drdecode links utils.c which has print_file. The `STDERR` should work b/c it turns into either `our_stderr` or `dr_get_stderr_handle` and both are defined up above in this file. Probably this should be `s/print_file/fprintf/`?,c,1,1,1
"@@ -57,9 +57,8 @@ xfpga_fpgaGetPropertiesFromHandle(fpga_handle handle, fpga_properties *prop)
 	return result;
 }
 
-
-fpga_result __FPGA_API__
-xfpga_fpgaGetProperties(fpga_token token, fpga_properties *prop)
+fpga_result __FPGA_API__ xfpga_fpgaGetProperties(fpga_token token,
+						 fpga_properties *prop)
 {
 	struct _fpga_properties *_prop;
 	fpga_result result = FPGA_OK;",Should we call the API `fpgaGetProperties` with a null token to allocate the properties structure?,c,1,1,1
"@@ -317,7 +317,7 @@ int rlist_remap (struct rlist *rl)
     return 0;
 }
 
-struct rnode * rlist_find_host (struct rlist *rl, const char *host)
+struct rnode * rlist_find_host (const struct rlist *rl, const char *host)
 {
     struct rnode *n = zlistx_first (rl->nodes);
     while (n) {","typo in commit message ""reurn"" -> ""return""",c,0,0,1
"@@ -22,6 +22,10 @@ void wlr_texture_destroy(struct wlr_texture *texture) {
 struct wlr_texture *wlr_texture_from_pixels(struct wlr_renderer *renderer,
 		uint32_t fmt, uint32_t stride, uint32_t width, uint32_t height,
 		const void *data) {
+	assert(width > 0);
+	assert(height > 0);
+	assert(stride >= width);
+	assert(data);
 	return renderer->impl->texture_from_pixels(renderer, fmt, stride, width,
 		height, data);
 }",Maybe also assert that `stride > 0`?,c,1,0,1
"@@ -98,6 +98,10 @@ class ThriftProductHelper(object):
     def getCurrentProduct(self):
         pass
 
+    @ThriftClientCall
+    def getProductConfiguration(self, product_id):
+        pass
+
     # -----------------------------------------------------------------------
     @ThriftClientCall
     def addProduct(self, product):",Why did you add this to the product helper. Do you want to use it in the client?,c,1,1,1
"@@ -67,8 +67,8 @@ get_pthread_tls_offs(void)
 void
 init_android_version(void)
 {
-#   define VER_FILE ""/system/build.prop""
-#   define VER_PROP ""ro.build.version.release=""
+#define VER_FILE ""/system/build.prop""
+#define VER_PROP ""ro.build.version.release=""
     file_t fd = os_open(VER_FILE, OS_OPEN_READ);
     uint read_ver = 0;
     if (fd != INVALID_FILE) {",Ditto for these: lining up with code indentation level when inside function,c,1,1,1
"@@ -81,6 +81,16 @@ int main(int argc, char* argv[])
   opt.ast_print_width = get_width();
   opt.argv0 = argv[0];
 
+  size_t args_size = 0;
+  for (int i = 1; i < argc; i++)
+    args_size += strlen(argv[i]) + 1;
+  opt.all_args = (const char*)calloc(args_size, sizeof(const char));
+  for (int i = 1; i < argc; i++)
+  {
+    strncat((char*)opt.all_args, argv[i], strlen(argv[i]));
+    strncat((char*)opt.all_args, "" "", 1);
+  }
+
   ponyc_opt_process_t exit_code;
   bool print_program_ast;
   bool print_package_ast;",what's the purpose of this?,c,1,0,1
"@@ -1,9 +1,3 @@
- /*
-Copyright (C) 2017- The University of Notre Dame
-This software is distributed under the GNU General Public License.
-See the file COPYING for details.
-*/
-
 #include ""batch_job_internal.h""
 #include ""process.h""
 #include ""batch_job.h""","Don't remove the copyright, please.",c,1,1,1
"@@ -126,6 +126,11 @@ instr_clone(dcontext_t *dcontext, instr_t *orig)
         instr->bytes =
             (byte *)heap_reachable_alloc(dcontext, instr->length HEAPACCT(ACCT_IR));
         memcpy((void *)instr->bytes, (void *)orig->bytes, instr->length);
+    } else if (instr_is_label(orig)) {
+        /* We don't know what this callback does, we can't copy this. The caller that
+         * makes the clone needs to take care of this, xref i#3926.
+         */
+        instr_set_label_callback(instr, NULL);
     }
 #ifdef CUSTOM_EXIT_STUBS
     if ((orig->flags & INSTR_HAS_CUSTOM_STUB) != 0) {","There seem to be deeper issues: drmgr_is_emulation_start will still return true for a cloned instrlist, and if the original is freed, then drmgr_get_emulated_instr_data on the clone will point to freed memory. Is there something we can do to prevent use-after-frees. Adding on-clone callbacks (starting to get overkill? would want C++ or sthg at that point); zeroing label data instead of shallow-copying it and thus committing to clones being second-class copies? nit: More comma issues.",c,1,1,0
"@@ -2,11 +2,7 @@
 
 #include <wlr/config.h>
 
-#ifdef __linux__
 #include <linux/input-event-codes.h>
-#elif __FreeBSD__
-#include <dev/evdev/input-event-codes.h>
-#endif
 
 #include <xcb/xcb.h>
 #include <xcb/xfixes.h>","Hmm, what's the story about these? Are `linux/*` includes available on FreeBSD now?",c,1,1,1
"@@ -34,6 +34,10 @@ static int writeCtagsPtagEntry (tagWriter *writer CTAGS_ATTR_UNUSED,
                                                                 void *clientData);
 static bool treatFieldAsFixed (int fieldType);
 
+#ifdef WIN32
+static enum filenameSepOp overrideFilenameSeparator (enum filenameSepOp currentSetting);
+#endif        /* WIN32 */
+
 struct rejection {
         bool rejectionInThisInput;
 };",Did you intentionally remove this?,c,0,0,1
"@@ -22,6 +22,10 @@ def get_analyzer_checkers_cmd(cfg_handler, alpha=True, debug=True):
     Before clang9 alpha and debug checkers were printed by default.
     Since clang9 there are extra arguments to print the additional checkers.
     """"""
+    if not cfg_handler.version_info:
+        LOG.debug(""No clang version information. Can not get checkers."")
+        return None
+
     command = [cfg_handler.analyzer_binary, ""-cc1""]
 
     for plugin in cfg_handler.analyzer_plugins:","This should be a warning, not a normally silent debug.",c,1,1,1
"@@ -2,7 +2,7 @@
 
 Name:           felix
 Summary:        Project Calico virtual networking for cloud data centers
-Version:        2.2.1
+Version:        2.4.0
 Release:        1%{?dist}
 License:        Apache-2
 URL:            http://projectcalico.org",Erk. The fact this jumped from 2.2.1 to 2.4.0 - did we miss a change for 2.3.0?,c,1,1,1
"@@ -63,6 +63,7 @@ void shutdown_destroy (shutdown_t *s)
     if (s) {
         if (s->shutdown)
             flux_msg_handler_destroy (s->shutdown);
+        shutdown_disarm (s);
         if (s->h)
             (void)flux_event_unsubscribe (s->h, ""shutdown"");
         free (s);","Perhaps a good change, but unrelated to the logical topic of this commit.",c,1,1,1
"@@ -1350,6 +1350,8 @@ detach_and_exec_gdb(process_id_t pid, const char *library_path)
     os_unmap_file(base, size);
     os_close(f);
 
+    /* SIGSTOP can make gdb debugging early privload. */
+    kill(pid, SIGSTOP);
     our_ptrace(PTRACE_DETACH, pid, NULL, NULL);
     snprintf(pid_str, BUFFER_SIZE_ELEMENTS(pid_str), ""%d"", pid);
     NULL_TERMINATE_BUFFER(pid_str);",Please reword: I don't know what this is trying to say due to grammar issues.,c,1,1,1
"@@ -174,6 +174,16 @@ def add_arguments_to_parser(parser):
                                     ""compiler on the system is special, e.g. ""
                                     ""when doing cross-compilation."")
 
+    analyzer_opts.add_argument('--capture-analysis-output',
+                               dest='capture_analysis_output',
+                               action='store_true',
+                               default=argparse.SUPPRESS,
+                               required=False,
+                               help=""Store standard output and standard error ""
+                                    ""of successful analyzer invocations ""
+                                    ""into the '<OUTPUT_DIR>/success' ""
+                                    ""directory."")
+
     analyzer_opts.add_argument('--saargs',
                                dest=""clangsa_args_cfg_file"",
                                required=False,","I wonder, mayhaps _capture-**successful**-output_ could be a better optstring? Considering that failure output is also captured (about which I wonder perhaps we should introduce an optstring that _disables_ that notion, as there could be cases someone does not truly care about the analysis failures as deeply as the code currently does.)",c,1,1,1
"@@ -247,7 +247,8 @@ type Config struct {
 
 	DisableConntrackInvalid bool
 
-	NATPortRange numorstring.Port
+	NATPortRange                       numorstring.Port
+	IptablesNATOutgoingInterfaceFilter string
 }
 
 func (c *Config) validate() {",This new field needs to be set from the global config params object. Take a look at how NATPortRange gets set.,c,1,1,1
"@@ -120,6 +120,8 @@ static void init_request(struct st_h2o_http1_conn_t *conn)
             h2o_buffer_dispose(&conn->req_body);
         h2o_dispose_request(&conn->req);
     }
+    if (conn->_unconsumed_request_size)
+        h2o_buffer_consume(&conn->sock->input, conn->_unconsumed_request_size);
     assert(conn->req_body == NULL);
     h2o_init_request(&conn->req, &conn->super, NULL);
 ","Would it make sense to move these two lines into the end of `if` block above, right after `h2o_dispose_request`? Based on my understanding that the intent is to retain the input buffer until `h2o_dispose_request` completes, I think doing so would make the code more understandable.",c,1,1,1
"@@ -376,7 +376,7 @@ static void on_connect(h2o_socket_t *sock, const char *err)
         }
         __sync_sub_and_fetch(&req->pool->_shared.count, 1);
         req->sock = NULL;
-        errstr = ""connection failed""; /* shouldn't we return err? */
+        errstr = err;
     } else {
         h2o_url_t *target_url = &req->pool->targets.entries[req->selected_target]->url;
         if (target_url->scheme->is_ssl) {","This looks like a fine change, though I think we can just get rid of `errstr`, and pass `err` as the argument to `call_connect_cb`?",c,1,1,1
"@@ -20,6 +20,8 @@
 #include ""ext/types.h""
 #include ""ext/protocol.h""
 
+#include <iostream>
+
 namespace apache {
 namespace thrift {
 namespace py {",I usually include built-in lib first,c,1,0,1
"@@ -92,7 +92,7 @@ fpga_result __FPGA_API__ fpgaOpen(fpga_token token, fpga_handle *handle, int fla
 	_handle->mmio_root = NULL;
 
 	// Init workspace table
-	_handle->wsid_root = wsid_tracker_init(16384);
+	_handle->wsid_root = wsid_tracker_init(MAX_WSID_TRACKER_BUCKETS);
 
 	// set handle return value
 	*handle = (void *)_handle;","MAX is the wrong prefix. This is just a static number of buckets to allocate in the hash table. A better name would be ""NUM_WSID_TRACKER_BUCKETS"".",c,1,1,1
"@@ -82,6 +82,7 @@ IGNORED_OPTIONS_GCC = [
     '-fno-aggressive-loop-optimizations',
     '-fno-delete-null-pointer-checks',
     '-fno-jump-table',
+    '-fno-keep-static-consts',
     '-fno-strength-reduce',
     '-fno-toplevel-reorder',
     '-fno-unit-at-a-time',",Comma is missing at the end of line.,c,1,1,1
"@@ -681,6 +681,7 @@ d_r_arch_init(void)
      * masks. Also priv_mcontext_t.opmask slots are AVX512BW wide.
      */
     IF_X86(ASSERT(sizeof(dr_opmask_t) == OPMASK_AVX512BW_REG_SIZE));
+    ASSERT(NUM_GP_REGS == DR_NUM_GPR_REGS);
 
     /* Verify that the structures used for a register spill area and to hold IBT
      * table addresses & masks for IBL code are laid out as expected. We expect",Is that necessary?,c,1,0,1
"@@ -0,0 +1,18 @@
+/**
+ * Autogenerated by Thrift Compiler (0.11.0)
+ *
+ * DO NOT EDIT UNLESS YOU ARE SURE THAT YOU KNOW WHAT YOU ARE DOING
+ *  @generated
+ */
+
+/// <summary>
+/// You can define enums, which are just 32 bit integers. Values are optional
+/// and start at 1 if not supplied, C style again.
+/// </summary>
+public enum Operation
+{
+  ADD = 1,
+  SUBTRACT = 2,
+  MULTIPLY = 3,
+  DIVIDE = 4,
+}",Generated code should not be checked in.,c,1,1,1
"@@ -348,6 +348,8 @@ void wlr_seat_destroy(struct wlr_seat *wlr_seat) {
 		return;
 	}
 
+	wl_signal_emit(&wlr_seat->events.destroy, NULL);
+
 	wl_list_remove(&wlr_seat->display_destroy.link);
 
 	struct wlr_seat_client *client, *tmp;","We generally emit the signal with the object itself as data, here `wlr_seat`.",c,1,1,1
"@@ -65,7 +65,7 @@ disable=all
 # Enable the message, report, category or checker with the given id(s). You can
 # either give multiple identifier separated by comma (,) or put this option
 # multiple time. See also the ""--disable"" option for examples.
-enable=logging-format-interpolation,old-style-class,unused-import,unused-variable,len-as-condition,bad-indentation
+enable=logging-format-interpolation,old-style-class,unused-import,unused-variable,len-as-condition,bad-indentation,unpacking-in-except,import-star-module-level,parameter-unpacking,long-suffix,old-octal-literal,old-ne-operator,backtick,old-raise-syntax,print-statement,unpacking-in-except,import-star-module-level,parameter-unpacking,long-suffix,old-octal-literal,old-ne-operator,backtick,old-raise-syntax,print-statement,not-in-loop,function-redefined,continue-in-finally,abstract-class-instantiated,sstar-needs-assignment-target,duplicate-argument-name,too-many-star-expressions,nonlocal-and-global,return-outside-function,return-arg-in-generator,invalid-star-assignment-target,bad-reversed-sequence,nonexistent-operator,yield-outside-function,init-is-generator,nonlocal-without-binding,invalid-unary-operand-type,unsupported-binary-operation,no-member,not-callable,redundant-keyword-arg,assignment-from-no-return,assignment-from-none,not-context-manager,repeated-keyword,missing-kwoa,no-value-for-parameter,invalid-sequence-index,invalid-slice-index,too-many-function-args,unexpected-keyword-arg,unsupported-membership-test,unsubscriptable-object,unpacking-non-sequence,invalid-all-object,no-name-in-module,unbalanced-tuple-unpacking,undefined-variable,undefined-all-variable,used-before-assignment,format-needs-mapping,truncated-format-string,missing-format-string-key,mixed-format-string,too-few-format-args,bad-str-strip-call,too-many-format-args,bad-format-character,access-member-before-definition,method-hidden,assigning-non-slot,duplicate-bases,inconsistent-mro,inherit-non-class,invalid-slots,invalid-slots-object,no-method-argument,no-self-argument,unexpected-special-method-signature,non-iterator-returned,invalid-length-returned
 
 [REPORTS]
 ",travis fails with this config,c,1,1,1
"@@ -4111,7 +4111,17 @@ ostree_repo_pull_with_options (OstreeRepo             *self,
         g_string_append_printf (msg, ""libostree pull from '%s' for %u refs complete"",
                                 pull_data->remote_name, g_hash_table_size (requested_refs_to_fetch));
 
-      g_string_append_printf (msg, ""\nsecurity: GPG: %s "", pull_data->gpg_verify ? ""yes"" : ""no"");
+      const char *gpg_verify_state;
+      if (pull_data->gpg_verify_summary)
+        {
+          if (pull_data->gpg_verify)
+            gpg_verify_state = ""summary+commit"";
+          else
+            gpg_verify_state = ""summary-only"";
+        }
+      else
+        gpg_verify_state = (pull_data->gpg_verify ? ""commit"" : ""disabled"");
+      g_string_append_printf (msg, ""\nsecurity: GPG: %s "", gpg_verify_state);
       OstreeFetcherURI *first_uri = pull_data->meta_mirrorlist->pdata[0];
       g_autofree char *first_scheme = _ostree_fetcher_uri_get_scheme (first_uri);
       if (g_str_has_prefix (first_scheme, ""http""))","Nit: can we call this `summary`, to be consistent with `commit` and `summary+commit`?",c,1,1,1
"@@ -610,4 +610,11 @@ Application %1!s! (%2!s!). Cannot identify VFP frame offset.
 .
 ;#endif
 
+MessageId =
+Severity = Error
+Facility = DRCore
+SymbolicName = MSG_COULDNT_SYNCH_WITH_ALL_THREADS
+Language=English
+%1!s!:  DynamoRIO could not synch with all threads.
+.
 ;// ADD NEW MESSAGES HERE","Include the application name and pid, as all the other messages do: best to match them and start with that. I would avoid ""DynamoRIO"": that's parameterized out for crash messages (xref dr_set_client_name(), PRODUCT_NAME, etc.), so best to avoid here. Maybe just ""Application %1!s! (%2!s!): Failed to synchronize with all threads when detaching.""",c,1,1,1
"@@ -408,8 +408,16 @@ insert_load_dr_tls_base(dcontext_t *dcontext, instrlist_t *ilist, instr_t *where
 void
 append_fcache_enter_prologue(dcontext_t *dcontext, instrlist_t *ilist, bool absolute)
 {
+#ifdef UNIX
+    instr_t *no_signals = INSTR_CREATE_label(dcontext);
+    /* save callee-saved reg in case we return for a signal */
+    APP(ilist,
+        XINST_CREATE_move(dcontext, opnd_create_reg(DR_REG_X1),
+                          opnd_create_reg(REG_DCXT)));
+#endif
     ASSERT_NOT_IMPLEMENTED(!absolute &&
                            !TEST(SELFPROT_DCONTEXT, dynamo_options.protect_mask));
+
     /* Grab gen routine's parameter dcontext and put it into REG_DCXT:
      * mov x(dxct), x0
      */","This looks identical to ARM's version modulo register names, for which we already have generic versions (R maps to X for generic ptr-sized): could we move this to the aarchxx/ directory?",c,1,1,1
"@@ -1936,6 +1936,14 @@ class ThriftRequestHandler(object):
 
         session = self.__storage_session.get_transaction(run_id)
 
+        all_reports = session.query(Report) \
+            .filter(Report.run_id == run_id) \
+            .all()
+
+        hash_map_reports = defaultdict(list)
+        for report in all_reports:
+            hash_map_reports[report.bug_id].append(report)
+
         # Processing PList files.
         _, _, report_files = next(os.walk(report_dir), ([], [], []))
         for f in report_files:",Is `defaultdict` known? Maybe having a regular dict and `hash_map_reports[report.bug_id] = [report]` Is easier to read?,c,1,1,1
"@@ -339,8 +339,12 @@ void wlr_output_layout_closest_point(struct wlr_output_layout *layout,
 		}
 	}
 
-	*dest_x = min_x;
-	*dest_y = min_y;
+	if (dest_x) {
+		*dest_x = min_x;
+	}
+	if (dest_y) {
+		*dest_y = min_y;
+	}
 }
 
 struct wlr_box *wlr_output_layout_get_box(","We can return early from this function without doing anything if these are both NULL, right?",c,1,1,1
"@@ -714,7 +714,7 @@ dispatch_enter_native(dcontext_t *dcontext)
          * be an alarm signal so we drop it as the simplest solution.
          */
         ASSERT(dcontext->signals_pending);
-        dcontext->signals_pending = false;
+        dcontext->signals_pending = 0;
     } while (true);
 #else
     (*go_native)(dcontext);",I wonder if usages like this need to be audited too. `signals_pending` can be < 0 if one is being currently handled.,c,1,1,1
"@@ -136,6 +136,9 @@ static inline pmix_status_t _job_data_store(const char *nspace, void *cbdata)
     int32_t cnt;
     size_t nnodes;
     uint32_t i;
+#if !(defined(PMIX_ENABLE_DSTORE) && (PMIX_ENABLE_DSTORE == 1))
+    uint32_t j;
+#endif
     pmix_nrec_t *nrec, *nr2;
     char **procs = NULL;
     pmix_byte_object_t *bo;",Why this variable was introduced but no usages are visible?,c,1,1,1
"@@ -1169,7 +1169,8 @@ dynamo_shared_exit(thread_record_t *toexit /* must ==cur thread for Linux */
     return SUCCESS;
 }
 
-int
+/* NOINLINE because dynamorio_app_exit is a stopping point. */
+NOINLINE int
 dynamorio_app_exit(void)
 {
     return dynamo_process_exit();",> Those scenarios would need their own optimizer-specific solution. Not for this PR but a future one -- We should add that to the docs: though we never made particular docs for static-library DR so we need to do that first. Maybe we should file an issue on doing that.,c,0,1,1
"@@ -772,10 +772,10 @@ read_evex(byte *pc, decode_info_t *di, byte instr_byte,
         }
         *is_evex = true;
 #if !defined(STANDALONE_DECODER)
-        char pc_addr[IF_X64_ELSE(20, 12)];
-        snprintf(pc_addr, BUFFER_SIZE_ELEMENTS(pc_addr), PFX, pc);
-        NULL_TERMINATE_BUFFER(pc_addr);
-        DO_ONCE(SYSLOG(SYSLOG_ERROR, AVX_512_SUPPORT_INCOMPLETE, 2,
+        DO_ONCE(char pc_addr[IF_X64_ELSE(20, 12)];
+                snprintf(pc_addr, BUFFER_SIZE_ELEMENTS(pc_addr), PFX, pc);
+                NULL_TERMINATE_BUFFER(pc_addr);
+                SYSLOG(SYSLOG_ERROR, AVX_512_SUPPORT_INCOMPLETE, 2,
                        get_application_name(), get_application_pid(), pc_addr));
 #endif
         info = &evex_prefix_extensions[0][1];",The rest of the codebase uses {} for all multi-statement code inside a macro.,c,1,1,1
"@@ -71,7 +71,15 @@ DR_API
 int
 proc_num_simd_saved(void)
 {
+    SELF_UNPROTECT_DATASEC(DATASEC_RARELY_PROT);
     return num_simd_saved;
+    SELF_PROTECT_DATASEC(DATASEC_RARELY_PROT);
+}
+
+void
+proc_set_num_simd_saved(int num)
+{
+    ATOMIC_4BYTE_WRITE(&num_simd_saved, num, false);
 }
 
 DR_API",? This is a read. It should not unprotect .data.,c,1,1,1
"@@ -259,11 +259,11 @@ flb_sds_t flb_sds_cat_utf8 (flb_sds_t *sds, const char *str, int str_len)
             s[head->len++] = '\\';
             s[head->len++] = 'u';
             if (cp > 0xFFFF) {
-                c = int2hex[ (unsigned char) ((cp & 0xf00000) >> 20)];
+                c = (unsigned char) ((cp & 0xf00000) >> 20);
                 if (c > 0) {
                     s[head->len++] = int2hex[c];
                 }
-                c = int2hex[ (unsigned char) ((cp & 0x0f0000) >> 16)];
+                c = (unsigned char) ((cp & 0x0f0000) >> 16);
                 if (c > 0) {
                     s[head->len++] = int2hex[c];
                 }",Here's the array overrun (line 264 and 268).,c,1,1,1
"@@ -3853,6 +3853,8 @@ ostree_repo_pull_with_options (OstreeRepo             *self,
 
       while (g_variant_iter_loop (collection_refs_iter, ""(&s&s&s)"", &collection_id, &ref_name, &checksum))
         {
+          if (!ostree_validate_rev (ref_name, error))
+            goto out;
           g_hash_table_insert (requested_refs_to_fetch,
                                ostree_collection_ref_new (collection_id, ref_name),
                                (*checksum != '\0') ? g_strdup (checksum) : NULL);","We also need this in the next `else if` for `refs_to_fetch`, right?",c,1,1,1
"@@ -334,6 +334,11 @@ static int insert_literal_header(h2o_qpack_decoder_t *qpack, const char *name, s
     return decode_value_and_insert(qpack, header, value_is_huff, value, value_len, err_desc);
 }
 
+static int64_t qpack_table_cur(struct st_h2o_qpack_header_table_t *table)
+{
+    return table->base_offset + ((uintptr_t)table->last - (uintptr_t)table->first);
+}
+
 static int insert_with_name_reference(h2o_qpack_decoder_t *qpack, int name_is_static, int64_t name_index, int value_is_huff,
                                       const uint8_t *value, int64_t value_len, const char **err_desc)
 {","Thank you for the PR. I like the direction of the PR but the cast to `(uintptr_t)` seems incorrect, PTAL #2725.",c,0,1,1
"@@ -1,4 +1,4 @@
-// Copyright (c) 2020 Tigera, Inc. All rights reserved.
+// Copyright (c) 2020-2021 Tigera, Inc. All rights reserved.
 //
 // Licensed under the Apache License, Version 2.0 (the ""License"");
 // you may not use this file except in compliance with the License.","Should revert this copyright change, when the file isn't changing in any other way.",c,1,1,1
"@@ -1853,8 +1853,15 @@ presys_SetContextThread(dcontext_t *dcontext, reg_t *param_base)
     /* FIXME : we are going to read and write to cxt, which may be unsafe */
     ASSERT(tid != 0xFFFFFFFF);
     LOG(THREAD, LOG_SYSCALLS|LOG_THREADS, IF_DGCDIAG_ELSE(1, 2),
-        ""syscall: NtSetContextThread handle=""PFX"" tid=%d cxt->Xip=""PFX""\n"",
-        thread_handle, tid, cxt->CXT_XIP);
+        ""syscall: NtSetContextThread handle=""PFX"" tid=%d cxt->Xip=""PFX"" flags=""PFX""\n"",
+        thread_handle, tid, cxt->CXT_XIP, cxt->ContextFlags);
+    if (get_thread_id() == tid) {
+        /* Simple case when called on own thread. */
+        /* FIXME : we should handle theses flags. */
+        ASSERT(!TEST(CONTEXT_CONTROL, cxt->ContextFlags) &&
+               !TEST(CONTEXT_DEBUG_REGISTERS, cxt->ContextFlags));
+        return execute_syscall;
+    }
     mutex_lock(&thread_initexit_lock); /* need lock to lookup thread */
     if (intercept_asynch_for_thread(tid, false/*no unknown threads*/)) {
         priv_mcontext_t mcontext;","Include the issue number (so ""FIXME i#2249: ..."")",c,0,1,1
"@@ -412,7 +412,10 @@ os_loader_thread_init_epilogue(dcontext_t *dcontext)
 void
 os_loader_thread_exit(dcontext_t *dcontext)
 {
-    /* do nothing in Windows */
+    /* XXX i#3633: In case of windows 1903 if priv_fls_data endsup in internal lists of
+     * ntdll.dll for FLS, we have to unlink them manually. We do unlinking always.
+     */
+    ntdll_redir_fls_thread_exit(dcontext->priv_fls_data);
 }
 
 void","Again, I don't think we want the `XXX`.",c,1,0,1
"@@ -299,16 +299,11 @@ static int on_head(struct st_h2o_http2client_conn_t *conn, struct st_h2o_http2cl
         stream->super._cb.on_head(&stream->super, is_end_stream ? h2o_httpclient_error_is_eos : NULL, 0, stream->input.status,
                                   h2o_iovec_init(NULL, 0), stream->input.headers.entries, stream->input.headers.size, (int)len, 0);
 
-    if (is_end_stream) {
+    if (is_end_stream || stream->super._cb.on_body == NULL) {
         close_stream(stream);
         return 0;
     }
 
-    if (stream->super._cb.on_body == NULL) {
-        ret = H2O_HTTP2_ERROR_PROTOCOL; // TODO: what error is suitable for this case?
-        goto SendRSTStream;
-    }
-
     transition_state(stream, H2O_HTTP2CLIENT_STREAM_STATE_RECV_BODY);
 
     return 0;","The answer depends on what we want to do. If we are to allow applications to close the request by returning NULL in response to the `on_head` calleb with err (i.e. the second argument) set to NULL, we should send upstream a stream-level error and keep the connection alive. Otherwise, we would face errors on other requests sharing the same connection. If we are to *not* allow applications to return NULL, we should do `assert(stream->supe._cb.on_body != NULL)`. My assumption was that we are going for the latter approach, but I am definitely open to discussing what the correct way is, especially if there is a case that actually returns NULL.",c,1,1,0
"@@ -1337,12 +1337,12 @@ append_restore_simd_reg(dcontext_t *dcontext, instrlist_t *ilist, bool absolute)
         int i;
         uint opcode = move_mm_reg_opcode(true /*align32*/, true /*align16*/);
         ASSERT(proc_has_feature(FEATURE_SSE));
-        for (i = 0; i < NUM_SIMD_SAVED; i++) {
+        for (i = 0; i < proc_num_simd_saved(); i++) {
             APP(ilist,
                 instr_create_1dst_1src(
                     dcontext, opcode, opnd_create_reg(REG_SAVED_XMM0 + (reg_id_t)i),
                     OPND_DC_FIELD(absolute, dcontext, OPSZ_SAVED_XMM,
-                                  XMM_OFFSET + i * XMM_SAVED_REG_SIZE)));
+                                  XMM_OFFSET + i * MAX_SIMD_SLOT_SIZE)));
         }
     }
 }","This seems odd to me: to have a hardcoded opcde and operands for xmm, but with a MAX_ constant for the size? This seems like it could end in an error where MAX_ allows for zmm but this instruction only uses xmm. It seems like the whole insruction needs to vary, not just this size. Ditto below. OK after seeing that this MAX_ is the mcontext field size: how about renaming it so it doesn't sound like it varies. How about MCXT_SIMD_FIELD_SIZE or sthg?",c,1,1,0
"@@ -327,6 +327,14 @@ var _ = infrastructure.DatastoreDescribe(""_BPF-SAFE_ IPIP topology before adding
                 BeforeEach(func() {
                         ctx, cancel := context.WithTimeout(context.Background(), 20*time.Second)
                         defer cancel()
+                        if bpfEnabled {
+                                infra.RemoveNodeAddresses(felixes[0])
+                        } else {
+                                for _, f := range felixes {
+                                        infra.RemoveNodeAddresses(f)
+                                }
+                        }
+
                         listOptions := options.ListOptions{}
                         if bpfEnabled {
                                 listOptions.Name = felixes[0].Hostname",Why this difference?,c,1,0,1
"@@ -1409,10 +1409,11 @@ common_disassemble_fragment(dcontext_t *dcontext, fragment_t *f_in, file_t outfi
             pc = (cache_pc)disassemble_with_bytes(dcontext, (byte *)pc, outfile);
         }
         if (LINKSTUB_DIRECT(l->flags) && DIRECT_EXIT_STUB_DATA_SZ > 0) {
-            ASSERT(DIRECT_EXIT_STUB_DATA_SZ == sizeof(cache_pc));
-            if (stub_is_patched(f, EXIT_STUB_PC(dcontext, f, l))) {
+            ASSERT(DIRECT_EXIT_STUB_DATA_SZ == sizeof(cache_pc) IF_AARCH64(+4));
+            if (stub_is_patched(dcontext, f, EXIT_STUB_PC(dcontext, f, l))) {
                 print_file(outfile, ""  <stored target: "" PFX "">\n"",
-                           *(cache_pc *)next_stop_pc);
+                           *(cache_pc *)IF_AARCH64_ELSE(ALIGN_FORWARD(next_stop_pc, 8),
+                                                        next_stop_pc));
             }
             pc += DIRECT_EXIT_STUB_DATA_SZ;
         }",Maybe make a named constant and use it here and in the define above where it says 12?,c,1,1,1
"@@ -2834,7 +2834,7 @@ mangle_icache_op(dcontext_t *dcontext, instrlist_t *ilist, instr_t *instr,
 {
     int opc = instr_get_opcode(instr);
     if (opc == OP_sys) {
-        reg_id_t xt = opnd_get_reg(instr_get_src(instr, 1));
+        reg_id_t xt = opnd_get_base(instr_get_dst(instr, 0));
         /* ic ivau, xT is replaced with: */
         PRE(ilist, instr, /* stp x0, x30, [x28] */
             INSTR_CREATE_stp(","Hmm, a cache line invalidation on x86 uses `OP_clflush` which for DR has the address as a source, not a destination. The actual memory contents are not modified so it makes some logical sense. For consistency we should make it a source here, too, right?",c,1,1,1
"@@ -1534,6 +1534,7 @@ const instr_info_t * const op_instr[] =
 #define KVw TYPE_K_VEX, OPSZ_2
 #define KVd TYPE_K_VEX, OPSZ_4
 #define KVq TYPE_K_VEX, OPSZ_8
+#define KE1b TYPE_K_EVEX, OPSZ_1b
 #define KEb TYPE_K_EVEX, OPSZ_1
 #define KEw TYPE_K_EVEX, OPSZ_2
 #define KEd TYPE_K_EVEX, OPSZ_4",> Fixes the evex masks's size for all ss* and sd* vector opcodes to reflect 1 bit. Grammar: masks',c,1,1,1
"@@ -2379,8 +2379,8 @@ options_init()
     /* .lspdata pages start out writable so no unprotect needed here */
     write_lock(&options_lock);
     ASSERT(sizeof(dynamo_options) == sizeof(options_t));
-    /* get dynamo options */
-    adjust_defaults_for_page_size(&dynamo_options);
+    /* reset options to the defaults and get current dynamo options */
+    set_dynamo_options_defaults(&dynamo_options);
     retval = get_parameter(PARAM_STR(DYNAMORIO_VAR_OPTIONS), option_string,
                            sizeof(option_string));
     if (IS_GET_PARAMETER_SUCCESS(retval))","This is a big memcpy. I'd prefer to do this on exit and only if detaching, like we're doing the other expensive zeroing.",c,1,1,1
"@@ -310,6 +310,9 @@ void roots_cursor_handle_motion(struct roots_cursor *cursor,
         double dx = event->delta_x;
         double dy = event->delta_y;
 
+        wlr_seat_pointer_notify_relative_motion(cursor->seat->seat, (uint64_t)
+                event->time_msec, dx, dy, dx, dy);
+
         if (cursor->active_constraint) {
                 struct roots_view *view = cursor->pointer_view->view;
                 assert(view);","nit: put the cast next to the statement it's casting, don't split the line here",c,1,1,1
"@@ -183,6 +183,10 @@ CodeChecker quickcheck -w ~/workspace -b ""cd ~/myproject && make""
 
         workspace_help_msg = """"""Directory where the codechecker can store analysis related data.""""""
 
+        name_help_msg = """"""Name of the analysis.""""""
+
+        jobs_help_msg = '''Number of jobs. Start multiple processes for faster analisys''';
+
         log_argument_help_msg=""""""Path to the log file which is created during the build. \nIf there is an already generated log file with the compilation commands\ngenerated by 'CodeChecker log' or 'cmake -DCMAKE_EXPORT_COMPILE_COMMANDS' \nCodechecker check can use it for the analisys in that case running the original build will \nbe left out from the analysis process (no log is needed).""""""
 
         # --------------------------------------","Use the same """""" everywhere.",c,1,1,1
"@@ -318,6 +318,8 @@ ostree_deployment_unlocked_state_to_string (OstreeDeploymentUnlockedState state)
       return ""hotfix"";
     case OSTREE_DEPLOYMENT_UNLOCKED_DEVELOPMENT:
       return ""development"";
+    case OSTREE_DEPLOYMENT_UNLOCKED_TRANSIENT:
+      return ""transient"";
     }
   g_assert_not_reached ();
 }","Bikeshed/optional: kinda feels like ""development"" should be aliased to ""transient"" instead and this new mode would be ""transient-readonly"" or something? That would capture better the core difference between the two.",c,1,1,1
"@@ -41,10 +41,8 @@ def send_suppress(run_id, connection, file_name):
     Collect suppress information from the suppress file to be stored
     in the database.
     """"""
-    suppress_data = []
-    if os.path.exists(file_name):
-        with codecs.open(file_name, 'r', 'UTF-8') as s_file:
-            suppress_data = suppress_file_handler.get_suppress_data(s_file)
+    suppress_data = suppress_file_handler.SuppressFileHandler. \
+        get_suppress_data_from_file(file_name)
 
     if len(suppress_data) > 0:
         connection.add_suppress_bug(run_id, suppress_data)","Is it on purpose not to use this UTF-8 thing? If it is, then `import codecs` is also unnecessary.",c,1,1,1
"@@ -47,7 +47,7 @@ bool legacy_crtc_set_cursor(struct wlr_drm_backend *drm,
 
         if (drmModeSetCursor(drm->fd, crtc->id, gbm_bo_get_handle(bo).u32,
                         plane->surf.width, plane->surf.height)) {
-                wlr_log_errno(L_ERROR, ""Failed to set hardware cursor"");
+                wlr_log_errno(L_DEBUG, ""Failed to set hardware cursor"");
                 return false;
         }
 ",Added an unrelated fix here,c,0,0,1
"@@ -44,7 +44,7 @@ def execute_buildcmd(command, silent=False, env=None, cwd=None):
         if not line and proc.poll() is not None:
             break
         if not silent:
-            print(line)
+            sys.stdout.write(line)
 
     return proc.returncode
 ",Should we check if the line is empty?,c,1,1,1
"@@ -93,6 +93,11 @@ xfpga_fpgaOpen(fpga_token token, fpga_handle *handle, int flags)
 	// Init workspace table
 	_handle->wsid_root = NULL;
 
+	// Init metric enum
+	_handle->metric_enum_status = false;
+	_handle->dl_handle = NULL;
+	_handle->_bmc_metric_value = NULL;
+
 	// Open resources in exclusive mode unless FPGA_OPEN_SHARED is given
 	open_flags = O_RDWR | ((flags & FPGA_OPEN_SHARED) ? 0 : O_EXCL);
 	fddev = open(_token->devpath, open_flags);",The name dl_handle is too generic. Please rename to reflect its association with metrics.,c,1,1,1
"@@ -67,6 +67,17 @@ static void handle_request_resize(struct wl_listener *listener, void *data) {
 	view_begin_resize(input, event->cursor, view, e->edges);
 }
 
+static void handle_commit(struct wl_listener *listener, void *data) {
+	struct roots_xdg_surface_v6 *roots_xdg_surface =
+		wl_container_of(listener, roots_xdg_surface, commit);
+	struct roots_view *view = roots_xdg_surface->view;
+
+	bool centered = view_center(view);
+	if (centered) {
+		wl_list_remove(&listener->link);
+	}
+}
+
 static void handle_destroy(struct wl_listener *listener, void *data) {
 	struct roots_xdg_surface_v6 *roots_xdg_surface =
 		wl_container_of(listener, roots_xdg_surface, destroy);","Why remove the link if the view is off-screen? Also, won't this center it every time the view configures itself? Like when it's resizing?",c,1,1,1
"@@ -156,6 +156,7 @@ static pmix_status_t query(pmix_query_t queries[], size_t nqueries, pmix_list_t
                 }
             }
 
+            pmix_output(0, ""SILENCE WARNINGS %u %u"", uid, gid);
             if (0 == strcmp(queries[n].keys[m], PMIX_STORAGE_CAPACITY_LIMIT)) {
                 /* ADD HERE:
                  *",I think the cause of the CI failure is this debugging line that was left in place.,c,1,1,1
"@@ -120,7 +120,11 @@ json_t *job_to_json (struct job *job, json_t *attrs, job_info_error_t *errp)
         else if (!strcmp (attr, ""ranks"")) {
             if (!(job->states_mask & FLUX_JOB_RUN))
                 continue;
-            val = json_string (job->ranks);
+            /* potentially NULL if R invalid */
+            if (job->ranks)
+                val = json_string (job->ranks);
+            else
+                val = json_string ("""");
         }
         else if (!strcmp (attr, ""expiration"")) {
             if (!(job->states_mask & FLUX_JOB_RUN))",Suggest you break the inner block of the loop out to its own function as this is getting pretty long and the control flow harder to follow.,c,1,1,1
"@@ -115,7 +115,7 @@ var _ = Describe(""with running container"", func() {
 		It(""iptables should succeed in getting the lock after 3s"", func() {
 			iptCmd := cmdInContainer(""iptables"", ""-w"", ""3"", ""-A"", ""FORWARD"")
 			out, err := iptCmd.CombinedOutput()
-			Expect(string(out)).To(ContainSubstring(""Another app is currently holding the xtables lock""))
+			log.Printf(""iptables output='%s'"", out)
 			Expect(err).NotTo(HaveOccurred())
 		})
 ","Since we're using Logrus, probably best to use `Infof` to avoid confusion (Logrus' Printf behaves differently to the built in one)",c,1,1,1
"@@ -142,6 +142,19 @@ def add_arguments_to_parser(parser):
                              ""consult the User guide on how a Skipfile ""
                              ""should be laid out."")
 
+    parser.add_argument('--trim-path-prefix',
+                        type=str,
+                        nargs='*',
+                        dest=""trim_path_prefix"",
+                        required=False,
+                        default=argparse.SUPPRESS,
+                        help=""Removes leading path from files which will be ""
+                             ""printed. So if you have /a/b/c/x.cpp and ""
+                             ""/a/b/c/y.cpp then by removing \""/a/b/\"" prefix ""
+                             ""will print files like c/x.cpp and c/y.cpp. ""
+                             ""If multiple prefix is given, the longest match ""
+                             ""will be removed."")
+
     logger.add_verbose_arguments(parser)
 
     def __handle(args):",Please update the help message. This is done for parse not for store.,c,1,1,1
"@@ -354,7 +354,12 @@ int main(int argc, char **argv)
 
     if (mode_listen) {
         int fd, reuseaddr_flag = 1;
-        if ((fd = socket(AF_INET, SOCK_STREAM, 0)) == -1 ||
+        if (
+#ifdef __linux__
+            (fd = socket(AF_INET, SOCK_STREAM | SOCK_CLOEXEC | SOCK_NONBLOCK, 0)) == -1 ||
+#else
+            (fd = socket(AF_INET, SOCK_STREAM, 0)) == -1 ||
+#endif
             setsockopt(fd, SOL_SOCKET, SO_REUSEADDR, &reuseaddr_flag, sizeof(reuseaddr_flag)) != 0 ||
             bind(fd, res->ai_addr, res->ai_addrlen) != 0 || listen(fd, SOMAXCONN) != 0) {
             fprintf(stderr, ""failed to listen to %s:%s:%s\n"", host, port, strerror(errno));","I would appreciate it if you could revert the change to minimize the maintenance cost of the code. Considering that a HTTP/2 connection is typically long-running and that latency optimization issues many syscalls than when set to off, I do not think we need to complicate things here.",c,1,1,1
"@@ -73,7 +73,7 @@ fpga_result read_sysfs(fpga_token token, char *sysfs_path,
 		resval = res;
 		goto out_destroy;
 	}
-	printf(""size=%d \n"", size);
+
 	if (size > len) {
 		OPAE_ERR(""object size bigger then buffer size"");
 		resval = FPGA_EXCEPTION;",Could you submit this one in a separate pull request?,c,0,0,1
"@@ -336,7 +336,7 @@ static CALI_BPF_INLINE int calico_tc(struct __sk_buff *skb)
 		.reason = CALI_REASON_UNKNOWN,
 	};
 	struct calico_nat_dest *nat_dest = NULL;
-	bool nat_lvl1_drop = 0;
+	int res = 0;
 
 	/* we assume we do FIB and from this point on, we only set it to false
 	 * if we decide not to do it.",I think (a) should be initialized to `NAT_FE_LOOKUP_ALLOW` and (b) it should be probably the first thing in `calico_v4_nat_lookup2`,c,1,1,1
"@@ -12,7 +12,7 @@
  * * Redistributions in binary form must reproduce the above copyright notice,
  *   this list of conditions and the following disclaimer in the documentation
  *   and/or other materials provided with the distribution.
- *
+ *sig
  * * Neither the name of Google, Inc. nor the names of its contributors may be
  *   used to endorse or promote products derived from this software without
  *   specific prior written permission.",Please do a self-review before posting.,c,0,0,1
"@@ -47,5 +47,11 @@ class ClangTidyPlistToFile(ResultHandler):
         tidy_stdout = self.analyzer_stdout.splitlines()
         generate_plist_from_tidy_result(output_file, tidy_stdout)
 
-        if self.report_hash_type == 'context-free':
+        # In the earlier versions of CodeChecker Clang Tidy never used context
+        # free hash even if we enabled it with '--report-hash context-free'
+        # when calling the analyze command. To do not break every hash
+        # automatically when using this option we introduced a new choice for
+        # --report-hash option ('context-free-v2') and we still do not use
+        # context free hash for 'context-free' choice.
+        if self.report_hash_type == 'context-free-v2':
             report.use_context_free_hashes(output_file)",why would `if self.report_hash_type == 'context-free-v2':` not enough here?,c,1,1,1
"@@ -93,8 +93,10 @@ static int signal_frame(void *data) {
 	return 0;
 }
 
+static int current_output_id = 0;
+
 struct wlr_output *wlr_headless_add_output(struct wlr_backend *wlr_backend,
-		unsigned int width, unsigned int height) {
+		unsigned int width, unsigned int height, char *name) {
 	struct wlr_headless_backend *backend =
 		(struct wlr_headless_backend *)wlr_backend;
 ",You can use `wl_list_length` instead of a global.,c,1,1,1
"@@ -5092,7 +5092,7 @@ const instr_info_t prefix_extensions[][12] = {
     {INVALID,  0xf338f018, ""(bad)"",   xx, xx, xx, xx, xx, no, x, NA},
     /* really this is regular data-size prefix */
     {OP_movbe, 0x6638f018, ""movbe"", Gw, xx, Mw, xx, xx, mrm, x, tpe[139][2]},
-    {OP_crc32, 0xf238f018, ""crc32"", Gv, xx, Eb, Gv, xx, mrm, x, END_LIST},
+    {OP_crc32, 0xf238f018, ""crc32"", Gd_q, xx, Eb, Gd_q, xx, mrm, x, END_LIST},
     {INVALID,    0x38f018, ""(bad)"",   xx, xx, xx, xx, xx, no, x, NA},
     {INVALID,  0xf338f018, ""(bad)"",   xx, xx, xx, xx, xx, no, x, NA},
     {INVALID,  0x6638f018, ""(bad)"",   xx, xx, xx, xx, xx, no, x, NA},","Looking at the manual, yes for the destination. But the source seems to be always 1-byte for the F0 version, and 2/4/8 bytes for the F1. Why Gd_q for the source?",c,1,1,1
"@@ -289,6 +289,12 @@ h2o_logconf_t *h2o_logconf_compile(const char *fmt, int escape, char *errbuf)
                     MAP_EXT_TO_PROTO(""ssl.cipher-bits"", ssl.cipher_bits);
                     MAP_EXT_TO_PROTO(""ssl.session-id"", ssl.session_id);
                     MAP_EXT_TO_PROTO(""ssl.server-name"", ssl.server_name);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.protocol-version"", proxy_ssl.protocol_version);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.session-reused"", proxy_ssl.session_reused);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.cipher"", proxy_ssl.cipher);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.cipher-bits"", proxy_ssl.cipher_bits);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.session-id"", proxy_ssl.session_id);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.server-name"", proxy_ssl.server_name);
                     { /* not found */
                         h2o_iovec_t name = strdup_lowercased(pt, quote_end - pt);
                         NEW_ELEMENT(ELEMENT_TYPE_EXTENDED_VAR);",Maybe you missed removing some from here?,c,1,1,1
"@@ -623,6 +623,8 @@ get_config_val_other_arch(const char *var, char *val, size_t valsz, bool *app_sp
 void
 config_init(void)
 {
+    // Zero out myvals in case of reattach so that we re-load the config:
+    myvals = (const config_vals_t){0};
     config.u.v = &myvals;
     config_read(&config, NULL, 0, CFG_SFX);
     config_initialized = true;",Please put this in config_exit with the existing detach zeroing,c,1,1,1
"@@ -543,6 +543,9 @@ main(int argc, char **argv)
     /* We have no clue where the input focus is right now */
     globalconf.focus.need_update = true;
 
+    /* set the default preferred icon size */
+    globalconf.preferred_icon_size = 0;
+
     /* XLib sucks */
     XkbIgnoreExtension(True);
 ","Could the default be more dynamic, e.g. depending on the DPI?",c,1,1,1
"@@ -94,7 +94,7 @@ my_setjmp(sigjmp_buf env)
 }
 
 static void
-signal_handler(int sig)
+signal_handler(int sig, siginfo_t *siginfo)
 {
     if (sig == SIGILL) {
         count++;",A signal handler should either have 1 arg (signal()) or 3 (sigaction()): I don't think there is any such thing as one taking 2 args.,c,1,1,1
"@@ -472,6 +472,18 @@ void TNonblockingServer::TConnection::workSocket() {
     }
     // size known; now get the rest of the frame
     transition();
+
+    // If the socket has more data than the frame header, continue to work on it. This is not strictly necessary for
+    // regular sockets, because if there is more data, libevent will fire the event handler registered for read
+    // readiness, which will in turn call workSocket(). However, some socket types (such as TSSLSocket) may have the
+    // data sitting in their internal buffers and from libevent's perspective, there is no further data available. In
+    // that case, not having this workSocket() call here would result in a hang as we will never get to work the socket,
+    // despite having more data.
+    if (tSocket_->hasPendingDataToRead())
+    {
+        workSocket();
+    }
+
     return;
 
   case SOCKET_RECV:","Should this be an ""if"" or a ""while""?",c,1,1,1
"@@ -22,7 +22,7 @@ import traceback
 import zipfile
 import zlib
 
-from Authentication.ttypes import Permission
+from shared.ttypes import Permission
 
 from libcodechecker import generic_package_context
 from libcodechecker import host_check",don't we want to separate handlers by directory too? like libhandlers/v6/store.py etc.,c,0,1,1
"@@ -1266,7 +1266,7 @@ const instr_info_t * const op_instr[] =
     /* OP_vpbroadcastd  */   &third_byte_38[118],
     /* OP_vpbroadcastq  */   &third_byte_38[119],
 
-    /* added in Intel Skylake */
+    /* Added in Intel Skylake */
     /* OP_xsavec32      */   &rex_w_extensions[5][0],
     /* OP_xsavec64      */   &rex_w_extensions[5][1],
 ","Per style guide: punctuate as well (end in period, or maybe colon here) and ideally make it a complete sentence. In general, either capitalized + punctuated + complete sentences, or short snippet where we don't care, with preference in new code for the former. So it seems either leave it alone or ""Opcodes added in Intel Skylake:"" or sthg.",c,1,1,1
"@@ -16,7 +16,6 @@
  *  See the License for the specific language governing permissions and
  *  limitations under the License.
  */
-
 #include <fluent-bit.h>
 #include <fluent-bit/flb_pack.h>
 #include <fluent-bit/flb_record_accessor.h>",Is this blank line deleted intentionally?,c,1,1,1
"@@ -32,6 +32,7 @@
 #include ""stackdriver.h""
 #include ""stackdriver_conf.h""
 
+
 static inline int key_cmp(const char *str, int len, const char *cmp) {
 
     if (strlen(cmp) != len) {",I think this is an accidental newline?,c,1,1,1
"@@ -0,0 +1,19 @@
+#include <iostream>
+using namespace std;
+
+void check(int n)
+{
+    if(n%2 == 0)
+       cout << ""EVEN"";
+    else
+       cout << ""ODD"";
+}
+
+int main()
+{
+    int n;
+    cout <<""\n Enter value of n:"" << endl;
+    cin >> n;
+    check(n);
+    return 0;
+}",use anything else except % operator,c,1,1,1
"@@ -0,0 +1,15 @@
+#include <stddef.h>
+
+#ifdef PLATFORM_IS_VISUAL_STUDIO
+#  define EXPORT_SYMBOL __declspec(dllexport)
+#else
+#  define EXPORT_SYMBOL
+#endif
+
+typedef void (*baretest_callback_fn)(size_t value);
+
+EXPORT_SYMBOL extern void baretest_callback(baretest_callback_fn cb, size_t value)
+{
+  cb(value);
+}
+","If we don't support Windows, this wouldn't be needed.",c,1,1,1
"@@ -17,8 +17,8 @@
 #include <libgen.h>
 #include <dlfcn.h>
 #include <argz.h>
-#include <flux/core.h>
 #include <czmq.h>
+#include <flux/core.h>
 #include <jansson.h>
 
 #include ""src/common/libutil/xzmalloc.h""",Can this czmq.h include be dropped with the addition of the czmq_containers.h?,c,1,1,1
"@@ -293,6 +293,7 @@ release:
 	pixman_region32_init(&surface->current.buffer_damage);
 
 	wl_resource_queue_event(surface->current.buffer, WL_BUFFER_RELEASE);
+	surface->current.buffer = NULL;
 }
 
 static void surface_set_buffer_transform(struct wl_client *client,","Probably ok for a temporary workaround. But keep in mind that this will lead to issues as soon as we implement the TODO at the top of the function, i.e. empty the texture when there was a null buffer attached. It would be triggered from this i guess (when damage_flush is called multiple times).",c,1,1,1
"@@ -63,7 +63,9 @@ type L3RouteResolver struct {
         blockToRoutes          map[string]set.Set
         allPools               map[string]model.IPPool
         workloadIDToCIDRs      map[model.WorkloadEndpointKey][]cnet.IPNet
+        nodeToCIDRs            map[string]set.Set
         useNodeResourceUpdates bool
+        routeSource            string
 }
 
 type l3rrNodeInfo struct {","UT spotted that we weren't marking routes dirty when they targeted at Node and that node's IP changed. e.g., the case where a WEP appears in the syncer before the corresponding node does, so we don't know the node's IP. I added a new map to track the CIDRs for each node so that when the node IP changes we can mark those CIDRs dirty. Right now it's only used for the ""WorkloadIPs"" scenario. Need to decide if the same issue applies in the ""CalicoIPAM' case. I suspect it might. It looks like we have some logic present to detect when our own node IP changes, but we don't seem to handle when a remote node's IP changes.",c,1,1,0
"@@ -72,7 +72,7 @@ static void cond_normalise(ast_t** astp)
               NODE(TK_IFDEFFLAG, ID(OS_LINUX_NAME))
               NODE(TK_IFDEFFLAG, ID(OS_MACOSX_NAME))
               NODE(TK_NONE))
-            NODE(TK_IFDEFFLAG, ID(OS_FREEBSD_NAME))
+            NODE(TK_IFDEFFLAG, ID(OS_BSD_NAME))
             NODE(TK_NONE)));
         break;
       }","i believe this is correct. we want any BSD. and we don't need freebsd or dragonfly specifically, correct?",c,1,1,1
"@@ -172,13 +172,16 @@ int main()
         # Check the second file version.
         self._create_source_file(1, 'test_run_tag_update')
 
+        test_run_tags = self.__get_run_tag_counts(run_id, 100, 0)
+        run_tags_v0 = [t for t in test_run_tags if t.name == self.tags[0]]
+        self.assertEqual(len(run_tags_v0), 1)
+        run_tags_v0 = run_tags_v0[0]
+
         # We do not show future bugs for later tags.
         reports = self.__reports_by_tag([run_tags_v0.id])
         self.assertEqual(run_tags_v0.count, len(reports))
 
-        test_run_tags = self.__get_run_tag_counts(run_id)
         run_tags_v1 = [t for t in test_run_tags if t.name == self.tags[1]]
-
         self.assertEqual(len(run_tags_v1), 1)
         run_tags_v1 = run_tags_v1[0]
         self.__check_reports(run_tags_v1)","are there any other run tags mixed into the test data, that is why this run tag filtering needed?",c,1,1,1
"@@ -172,6 +172,7 @@ type Config struct {
 	IptablesLockFilePath               string        `config:""file;/run/xtables.lock""`
 	IptablesLockTimeoutSecs            time.Duration `config:""seconds;0""`
 	IptablesLockProbeIntervalMillis    time.Duration `config:""millis;50""`
+	IptablesFeatureDetectOverride      string        `config:""string;;local""`
 	IpsetsRefreshInterval              time.Duration `config:""seconds;10""`
 	MaxIpsetSize                       int           `config:""int;1048576;non-zero""`
 	XDPRefreshInterval                 time.Duration `config:""seconds;90""`","Suggest making this just `FeatureDetectOverride`; can see it being useful with the BPF dataplane too. It's fairly easy to add a validator, just change `config:""string;;local""` to `config:""feat-override;;local""`, for example, and then add an entry to the `loadParams()` function below. To validate, you could call the parse function and return an error if the parse fails.",c,1,1,1
"@@ -35,7 +35,9 @@
 #include <pthread.h>
 #include <pwd.h>
 #include <signal.h>
+#ifndef __ANDROID__
 #include <spawn.h>
+#endif
 #include <stdio.h>
 #include <unistd.h>
 #include <sys/resource.h>",The same goes here as well.,c,0,0,1
"@@ -77,9 +77,6 @@ struct flb_td *td_config_init(struct flb_output_instance *ins)
             return NULL;
         }
     }
-    else {
-        ctx->region = FLB_TD_REGION_US;
-    }
 
     flb_plg_info(ctx->ins, ""Treasure Data / database='%s' table='%s'"",
                  ctx->db_name, ctx->db_table);","If `tmp` is guaranteed not to be `NULL`, whole if statement has to be removed.",c,1,1,1
"@@ -2836,10 +2836,12 @@ client_process_bb(dcontext_t *dcontext, build_bb_t *bb)
 #    ifdef X86
         if (!d_r_is_avx512_code_in_use()) {
             if (ZMM_ENABLED()) {
-                if (instr_may_write_zmm_register(inst)) {
-                    LOG(THREAD, LOG_INTERP, 2, ""Detected AVX-512 code in use\n"");
-                    d_r_set_avx512_code_in_use(true);
-                    proc_set_num_simd_saved(MCXT_NUM_SIMD_SLOTS);
+                if (!instr_is_meta(inst)) {
+                    if (instr_may_write_zmm_or_opmask_register(inst)) {
+                        LOG(THREAD, LOG_INTERP, 2, ""Detected AVX-512 code in use\n"");
+                        d_r_set_avx512_code_in_use(true);
+                        proc_set_num_simd_saved(MCXT_NUM_SIMD_SLOTS);
+                    }
                 }
             }
         }",Just move this down below the instr_is_meta check + continue below and then this if goes away.,c,1,1,1
"@@ -312,6 +312,10 @@ static app_pc executable_end = NULL;
 static char executable_path[MAXIMUM_PATH];
 static char *executable_basename;
 
+/* Used by get_cl_args(). */
+static int *argc = NULL;
+static char **argv = NULL;
+
 /* does the kernel provide tids that must be used to distinguish threads in a group? */
 static bool kernel_thread_groups;
 ",Please qualify these: `app_argc` or `application_argc` or sthg.,c,1,1,1
"@@ -164,6 +164,7 @@ type Config struct {
 
         IptablesBackend                    string            `config:""oneof(legacy,nft,auto);legacy""`
         RouteRefreshInterval               time.Duration     `config:""seconds;90""`
+        InterfaceRefreshInterval           time.Duration     `config:""seconds;90""`
         DeviceRouteSourceAddress           net.IP            `config:""ipv4;""`
         DeviceRouteProtocol                int               `config:""int;3""`
         RemoveExternalRoutes               bool              `config:""bool;true""`",Shall we set default to 10 seconds as before?,c,1,1,1
"@@ -125,7 +125,8 @@ type Config struct {
         MetadataAddr string `config:""hostname;127.0.0.1;die-on-fail""`
         MetadataPort int    `config:""int(0,65535);8775;die-on-fail""`
 
-        InterfacePrefix string `config:""iface-list;cali;non-zero,die-on-fail""`
+        InterfacePrefix  string `config:""iface-list;cali;non-zero,die-on-fail""`
+        InterfaceExclude string `config:""iface-list;kube-ipvs0""`
 
         ChainInsertMode             string `config:""oneof(insert,append);insert;non-zero,die-on-fail""`
         DefaultEndpointToHostAction string `config:""oneof(DROP,RETURN,ACCEPT);DROP;non-zero,die-on-fail""`","I feel slightly that InterfaceExclude is not a clear name - bearing in mind that our config names are, to some extent, an external API. From an external point of view, a clearer name might be IPVSInterfaces. Then it would obviously make sense for the value to be something like 'kube-ipvs0', and it would be a matter of Felix's internal implementation that we choose to exclude those interfaces from our monitoring. Alternatively, if we want to keep this at a level that is more general than just IPVS, perhaps 'UnmonitoredInterfaces'? WDYT?",c,1,1,0
"@@ -394,6 +394,8 @@ static SSL_CTX *_create_ssl_context(int is_client) {
 
         openssl_initialized = 1;
 
+        SSL_load_error_strings();
+
         if(is_client) {
                 #ifdef HAS_TLS_method
                 method = TLS_client_method();",Move to if in line 390.,c,1,0,1
"@@ -801,6 +801,13 @@ func findHostMTU(matchRegex *regexp.Regexp) (int, error) {
 			smallest = l.Attrs().MTU
 		}
 	}
+
+	if smallest == 0 {
+		// We failed to find a usable interface. Default the MTU of the host
+		// to 1460 - the smallest among common cloud providers.
+		log.Warn(""Failed to auto-detect host MTU, assuming 1460"")
+		return 1460, nil
+	}
 	return smallest, nil
 }
 ","You could improve this log by saying something like ""Failed to auto-detect host's MTU, no interfaces matched the MTU data interface pattern; to use auto MTU detection, set <param name> to match your host's interfaces.""",c,1,1,1
"@@ -823,7 +823,10 @@ err:
  */
 static int job_get_ns_name (char *buf, int bufsz, flux_jobid_t id)
 {
-    return fluid_encode (buf, bufsz, id, FLUID_STRING_DOTHEX);
+    int n = snprintf (buf, bufsz - 1, ""job-%ju"", id);
+    if (n < 0 || n > bufsz - 1)
+        return -1;
+    return 0;
 }
 
 static double job_get_kill_timeout (flux_t *h)","i think you have to check `n` for validity before doing `n-1` b/c snprintf takes a `size_t`. although this is internal code (static function), so maybe it doesn't matter.",c,1,1,1
"@@ -53,6 +53,8 @@ instr_length_arch(dcontext_t *dcontext, instr_t *instr)
 {
     if (instr_get_opcode(instr) == OP_LABEL)
         return 0;
+    if (instr_get_opcode(instr) == OP_ldstex)
+        return opnd_get_immed_int(instr_get_src(instr, 0)) * AARCH64_INSTR_SIZE;
     return AARCH64_INSTR_SIZE;
 }
 ",Could we use instr_t.length and avoid having a hacky fake operand?,c,1,1,1
"@@ -645,13 +645,6 @@ func (r *DefaultRuleRenderer) filterOutputChain(ipVersion uint8) *Chain {
 		},
 	)
 
-	// Jump to chain for blocking service CIDR loops.
-	rules = append(rules,
-		Rule{
-			Action: JumpAction{Target: ChainCIDRBlock},
-		},
-	)
-
 	return &Chain{
 		Name:  ChainFilterOutput,
 		Rules: rules,",Does that mean we disable service loop prevention for packet generated by local host?,c,1,1,1
"@@ -316,9 +316,9 @@ AS_IF([test ""x$enable_pylint"" = ""xyes""], [
   AC_CHECK_PROG(PYLINT,[pylint],[pylint])
   AS_IF([test ""x$PYLINT"" != ""xpylint""], [AC_MSG_ERROR([No pylint found in PATH])])
   AM_CHECK_PYMOD(pylint,
-                   [StrictVersion(pylint.__version__) >= StrictVersion('1.4.5')],
+                   [StrictVersion(pylint.__version__) >= StrictVersion('1.8.4')],
                    ,
-                   [AC_MSG_ERROR([could not find python module pylint, version 1.4.5+ required])]
+                   [AC_MSG_ERROR([could not find python module pylint, version 1.8.4+ required])]
                  )
 ])
 AM_CONDITIONAL([ENABLE_PYLINT], [test ""x$PYLINT"" = ""xpylint""])","pylint on TOSS 3 is 1.6.5. However, since this check is only made with `--enable-pylint` it is probably fine.",c,1,1,1
"@@ -59,6 +59,15 @@ else
 fi
 AM_CONDITIONAL(BUILDOPT_ASAN, [test x$using_asan = xyes])
 
+AC_MSG_CHECKING([for -fsanitize=thread in CFLAGS])
+if echo $CFLAGS | grep -q -e -fsanitize=thread; then
+  AC_MSG_RESULT([yes])
+  using_tsan=yes
+else
+  AC_MSG_RESULT([no])
+fi
+AM_CONDITIONAL(BUILDOPT_TSAN, [test x$using_tsan = xyes])
+
 # Initialize libtool
 LT_PREREQ([2.2.4])
 LT_INIT([disable-static])",Almost; since we're doing the preprocessor here we need an `AM_COND_IF()` + `AC_DEFINE()`.,c,1,1,1
"@@ -9,6 +9,14 @@
 #include ""rootston/desktop.h""
 #include ""rootston/server.h""
 
+static void resize(struct roots_view *view, uint32_t width, uint32_t height) {
+	assert(view->type == ROOTS_XWAYLAND_VIEW);
+	struct wlr_xwayland_surface *xwayland_surface = view->xwayland_surface;
+	xwayland_surface->width = width;
+	xwayland_surface->height = height;
+	wlr_xwayland_surface_configure(view->desktop->xwayland, xwayland_surface);
+}
+
 static void handle_destroy(struct wl_listener *listener, void *data) {
 	struct roots_xwayland_surface *roots_surface =
 		wl_container_of(listener, roots_surface, destroy);",Xwayland should handle setting the width and height itself.,c,1,1,1
"@@ -548,6 +548,10 @@ static int fill_headers(h2o_req_t *req, struct phr_header *headers, size_t num_h
         }
     }
 
+    /* add date: if it's missing from the response */
+    if (h2o_find_header(&req->res.headers, H2O_TOKEN_DATE, 0) < 0)
+        h2o_resp_add_date_header(req);
+
     return 0;
 }
 ","Could we use `!= -1` as a check? It means the same, but it might be a good idea to be consistent with other parts of the code that invoke the same function.",c,1,1,1
"@@ -294,7 +294,7 @@ static bool link_exe(compile_t* c, ast_t* program,
 
   snprintf(ld_cmd, ld_len,
 #if defined(PLATFORM_IS_ARM)
-    ""%s -execute -arch %.*s ""
+    ""%s -execute -no_pie -arch %.*s ""
 #else
     ""%s -execute -no_pie -arch %.*s ""
 #endif",This option doesn't exist on the m1. I don't know if it's something related to arm64 or apple-specific.,c,1,1,1
"@@ -488,7 +488,7 @@ int main(int argc, char** argv) {
       testClient.testBinary(bin_result, string(bin_data, 256));
       if (bin_result.size() != 256) {
         printf(""}\n*** FAILED ***\n"");
-        printf(""invalid length: %lu\n"", bin_result.size());
+        printf(""invalid length: %zu\n"", bin_result.size());
         return_code |= ERR_BASETYPES;
       } else {
         bool first = true;","Given this is in test code, why not use something that is more flexible: `printf(boost::str(boost::format(""invalid length: %1%\n"") % bin_result.size()));` instead?",c,1,1,1
"@@ -67,6 +67,8 @@ ewmh_client_update_hints(lua_State *L)
         state[i++] = _NET_WM_STATE_HIDDEN;
     if(c->urgent)
         state[i++] = _NET_WM_STATE_DEMANDS_ATTENTION;
+    if(c->ontop)
+        state[i++] = _NET_WM_STATE_ONTOP;
 
     xcb_change_property(globalconf.connection, XCB_PROP_MODE_REPLACE,
                         c->window, _NET_WM_STATE, XCB_ATOM_ATOM, 32, i, state);","This is a potential buffer overflow. If all the `if`s are taken (which should never happen since some states are mutually exclusive), this might write beyond the end of the array.",c,1,1,1
"@@ -485,7 +485,7 @@ void genprim_pointer_methods(compile_t* c, reach_type_t* t)
   pointer_lt(c, t);
 }
 
-static void maybe_create(compile_t* c, reach_type_t* t, compile_type_t* t_elem)
+static void nullable_pointer_create(compile_t* c, reach_type_t* t, compile_type_t* t_elem)
 {
   FIND_METHOD(""create"", TK_NONE);
 ",i dont think we want to do these changes as part of RFC. need to discuss at sync.,c,1,1,1
"@@ -76,7 +76,7 @@ class CppcheckAnalyzerResult(AnalyzerResult):
                                          files[diag['location']['file']])
                 diag['issue_hash_content_of_line_in_context'] = report_hash
 
-    def _write(self, file_to_plist_data, output_dir):
+    def _write(self, file_to_plist_data, output_dir, file_name):
         """""" Creates plist files from the parse result to the given output. """"""
         output_dir = os.path.abspath(output_dir)
         for file_name, plist_data in file_to_plist_data.items():",why is the filename_needed here? The variable is overwritten in the for loop below and not used before that.,c,1,1,1
"@@ -156,7 +156,7 @@ extern const char *tagFileName (void)
 
 extern void abort_if_ferror(MIO *const mio)
 {
-	if (mio_error (mio))
+	if (mio != NULL && mio_error (mio))
 		error (FATAL | PERROR, ""cannot write tag file"");
 }
 ",These NULL checks are here because we bypass opening the MIO which is always NULL in our case.,c,1,1,1
"@@ -56,6 +56,15 @@ struct st_h2o_http1_conn_t {
         void *data;
         h2o_http1_upgrade_cb cb;
     } upgrade;
+    struct {
+        unsigned sending : 1;
+        unsigned has_pending_hints : 1;
+        struct {
+            h2o_iovec_t *inbufs;
+            size_t inbufcnt;
+            h2o_send_state_t send_state;
+        } pending_final;
+    } informational;
     /* the HTTP request / response (intentionally placed at the last, since it is a large structure and has it's own ctor) */
     h2o_req_t req;
 };","I can see that we need to buffer the content passed from the generator, now that informational responses could be in flight. Then, can't we simplify the logic by using the same buffer for storing _any_ pending data, including when we receive an additional 103 while a previous 103 is in flight?",c,1,1,1
"@@ -49,10 +49,10 @@
 static int counter = 0;
 static struct itable *finished_tasks = NULL;
 static int is_mesos_py_path_known = 0;
-static int is_mesos_master_known = 0;
+static int is_mesos_manager_known = 0;
 static int is_scheduler_running = 0;
 static const char *mesos_py_path = NULL;
-static const char *mesos_master = NULL;
+static const char *mesos_manager = NULL;
 static const char *mesos_preload = NULL;
 
 static void start_mesos_scheduler(struct batch_queue *q)","IIRC ""master"" is the terminology used by mesos.",c,1,1,1
"@@ -1295,6 +1295,12 @@ static size_t decrypt_cid(quicly_cid_encryptor_t *self, quicly_cid_plaintext_t *
 
     update_quic_keys();
 
+    /* precondition for calling `keyset->cid->decrypt_cid` is that the input of that callback is not zero-length; that is met when
+     * when the input to this function is known to be capable of carrying full-sized V1 CID (i.e. len == 0) or the length is known
+     * (i.e. long header packet) and is at least 2 bytes long */
+    if (len == 1)
+        return SIZE_MAX;
+
     if ((keyset = find_quic_keyset(encrypted[0])) == NULL)
         return SIZE_MAX;
     if ((len = keyset->cid->decrypt_cid(keyset->cid, plaintext, encrypted + 1, len != 0 ? len - 1 : 0)) == SIZE_MAX)","nit: duplicated ""when""",c,1,0,1
"@@ -141,6 +141,8 @@ event_module_load(void *drcontext, const module_data_t *data, bool loaded)
         entry = drvector_get_entry(&module_table.vector, i);
         mod   = entry->data;
         if (entry->unload &&
+            /* only check the main (containing) module */
+            entry->id == entry->containing_id &&
             /* If the same module is re-loaded at the same address,
              * we will try to use the existing entry.
              */",Please add a note that this is needed b/c the loop is backward,c,1,1,1
"@@ -38,13 +38,17 @@
 
 /* Per-checkout call state/caching */
 typedef struct {
-  GString *selabel_path_buf;
+  GString *path_buf; /* buffer for real path if filtering enabled */
+  GString *selabel_path_buf; /* buffer for selinux path if labeling enabled */
+  gboolean shared_path_buf; /* we try to use the same buf if we can */
 } CheckoutState;
 
 static void
 checkout_state_clear (CheckoutState *state)
 {
-  if (state->selabel_path_buf)
+  if (state->path_buf)
+    g_string_free (state->path_buf, TRUE);
+  if (state->selabel_path_buf && !state->shared_path_buf)
     g_string_free (state->selabel_path_buf, TRUE);
 }
 G_DEFINE_AUTO_CLEANUP_CLEAR_FUNC(CheckoutState, checkout_state_clear)","We could also just check `state->path_buf != state->selabel_path_buf` and lose the boolean, right?",c,1,1,1
"@@ -490,6 +490,7 @@ static pmix_status_t create_local_tracker(char nspace[], pmix_rank_t rank,
     if (NULL == lcd){
         return PMIX_ERR_NOMEM;
     }
+    PMIX_RETAIN(cbdata);
     pmix_strncpy(lcd->proc.nspace, nspace, PMIX_MAX_NSLEN);
     lcd->proc.rank = rank;
     lcd->info = info;","Hold on a second - you cannot do a retain on cbdata as it is a void*, which means you cannot know for certain that it is a PMIX_OBJECT",c,1,1,1
"@@ -1824,7 +1824,7 @@ find_syscall_num(dcontext_t *dcontext, instrlist_t *ilist, instr_t *instr)
 
     if (prev == NULL) {
 #if defined(WINDOWS) && defined(X64)
-        if (get_os_version() >= WINDOWS_VERSION_10_1511) {
+        if (get_os_version() >= WINDOWS_VERSION_10_1511 && !DYNAMO_OPTION(inject_x64)) {
             /* Handle the branch added in 1511 that isolates OP_syscall:
              *   7ff9`13185630 4c8bd1          mov     r10,rcx
              *   7ff9`13185633 b843000000      mov     eax,43h",I don't understand: this same code will be there when in 64-bit mode: why disable it?,c,1,1,1
"@@ -4,11 +4,13 @@
 #   This file is distributed under the University of Illinois Open Source
 #   License. See LICENSE.TXT for details.
 # -----------------------------------------------------------------------------
+from time import sleep
 
 """"""Setup for the test package comment.""""""
 
 from subprocess import CalledProcessError
 
+import json
 import multiprocessing
 import os
 import shutil",This import might be unused.,c,1,1,1
"@@ -76,6 +76,13 @@ func StartKubeProxy(k8s kubernetes.Interface, hostname string,
         }
 
         go func() {
+                // Before we start, scan for all finished / timed out connections to
+                // free up the conntrack table asap as it may take time to sync up the
+                // proxy and kick off the first full cleaner scan.
+                lc := conntrack.NewLivenessScanner(kp.conntrackTimeouts, kp.dsrEnabled)
+                connScan := conntrack.NewScanner(kp.ctMap, lc.ScanEntry)
+                connScan.Scan()
+
                 err := kp.start()
                 if err != nil {
                         log.WithError(err).Panic(""kube-proxy failed to start"")","Since it's a one-off, worth putting an info log before and after.",c,1,1,1
"@@ -6,7 +6,7 @@
 
 #	Process this file with autoconf to produce a configure script.
 
-AC_PREREQ([2.59])
+AC_PREREQ([2.64])
 AC_INIT([universal-ctags],[5.9.0])
 
 if ! test -e ""${srcdir}/config.h.in""; then",NOTE for myself: the version of autoconf shipped as part of RHEL6 is 2.63. The time for thinking about preparing weekly tarball with generated configure comes.,c,0,0,1
"@@ -741,6 +741,12 @@ read_evex(byte *pc, decode_info_t *di, byte instr_byte,
             return pc;
         }
         *is_evex = true;
+#if !defined(STANDALONE_DECODER)
+        char pc_addr[IF_X64_ELSE(20, 12)];
+        snprintf(pc_addr, BUFFER_SIZE_ELEMENTS(pc_addr), PFX, pc);
+        SYSLOG(SYSLOG_ERROR, AVX_512_SUPPORT_INCOMPLETE, 2, get_application_name(),
+               get_application_pid(), pc_addr);
+#endif
         info = &evex_prefix_extensions[0][1];
     } else {
         /* not evex */",style: always NULL_TERMINATE_BUFFER after snprintf,c,1,1,1
"@@ -5555,10 +5555,6 @@ emit_special_ibl_xfer(dcontext_t *dcontext, byte *pc, generated_code_t *code, ui
         INSTR_CREATE_cbz(dcontext, opnd_create_instr(skip_unlinked_tgt_jump),
                          opnd_create_reg(SCRATCH_REG5)));
     insert_shared_restore_dcontext_reg(dcontext, &ilist, NULL);
-    /* i#4670: The unlinking case is observed to hit very infrequently on x86. The issue
-     *  or the fix have not been observed on AArchXX yet.
-     */
-    ASSERT_NOT_TESTED();
 #        if defined(AARCH64)
     APP(&ilist,
         INSTR_CREATE_ldr(","> iX: r We don't put ""iX"" in the title: just the branch name. So `s/iX: r/R/`.",c,0,0,1
"@@ -41,6 +41,10 @@ static gboolean opt_verbose;
 static gboolean opt_version;
 static gboolean opt_print_current_dir;
 
+// TODO: make this public?  But no one sane wants to use our C headers
+// to find where to put files.  Maybe we can make it printed by the CLI?
+#define _OSTREE_EXT_DIR PKGLIBEXECDIR ""/ext""
+
 static GOptionEntry global_entries[] = {
   { ""verbose"", 'v', 0, G_OPTION_ARG_NONE, &opt_verbose, ""Print debug information during command processing"", NULL },
   { ""version"", 0, 0, G_OPTION_ARG_NONE, &opt_version, ""Print version information and exit"", NULL },","`/usr/share/pkgconfig/ostree.pc` like `/usr/share/pkgconfig/systemd.pc`? Not a blocker, but I think it provides a natural place to provide info about the CLI. Another alternative is to put it in the `--version` output like `Features`.",c,1,1,1
"@@ -214,6 +214,12 @@ type Table struct {
 	// to top-level chains.
 	insertMode string
 
+	// Record when we did our most recent updates and refreshes of the table.  We use these to
+	// calculate the next time we should force a refresh.
+	lastUpdateTime  time.Time
+	lastRefreshTime time.Time
+	refreshInterval time.Duration
+
 	logCxt *log.Entry
 
 	gaugeNumChains        prometheus.Gauge","Can we rename 'refresh' to 'read' and 'update' to 'write'? Until I had read more of the code below, I couldn't tell the difference between 'update' and 'refresh'.",c,1,1,1
"@@ -84,8 +84,6 @@ void mainloop(struct work_queue *queue, struct link *client)
 		ssize_t read = link_read(client, message, 1, time(NULL) + timeout);
 		while(message[0] != '{') {
 
-			//printf(""server number read: %c\n"", message[0]);
-
 			l[i] = message[0];
 			i++;
 			link_read(client, message, 1, time(NULL) + timeout);",Use `link_readline` here to do what you want.,c,1,1,1
"@@ -12,6 +12,9 @@
 
 #include <inttypes.h>
 #include <argz.h>
+#include <assert.h>
+
+#include ""src/common/libidset/idset.h""
 
 static int internal_comms_info (optparse_t *p, int ac, char *av[])
 {","commit message could use a bit more :-) Wasn't entirely clear what the ""up"" subcommand was initially.",c,0,0,1
"@@ -71,6 +71,12 @@ static struct st_deferred_request_action_t *create_deferred_action(h2o_req_t *re
     return action;
 }
 
+static void strtolower_cpy(char *d, const char *s, size_t len)
+{
+    for (; len != 0; ++d, ++s, --len)
+        *d = h2o_tolower(*s);
+}
+
 static h2o_hostconf_t *find_hostconf(h2o_hostconf_t **hostconfs, h2o_iovec_t authority, uint16_t default_port,
                                      h2o_iovec_t *wildcard_match)
 {","How about doing the following? * Promote this function to an external function that sits next to `h2o_strtolower`, and maybe name it `h2o_strcopytolower`? * Let `h2o_strtolower` be a wrapper of `h2o_strcopytolower` that accepts the same address for `d` and `s`. The intent here is to avoid having duplicated code while keeping existing API consistent.",c,1,1,1
"@@ -1323,6 +1323,14 @@ os_terminate_with_code(dcontext_t *dcontext, terminate_flags_t flags, int exit_c
     if (TEST(TERMINATE_CLEANUP, flags)) {
         /* we enter from several different places, so rewind until top-level kstat */
         KSTOP_REWIND_UNTIL(thread_measured);
+
+        /* This thread is on its way to exit, we are blocking all signals since any
+         * signal that reaches us now can be delayed until after the exit is complete.
+         * We may still receive a suspend signal for synchronization that we may need
+         * to reply to (i#2921).
+         */
+        block_all_signals_except(NULL, 1, SUSPEND_SIGNAL);
+
         cleanup_and_terminate(dcontext, SYSNUM_EXIT_PROCESS, exit_code, 0,
                               true /*whole process*/, 0, 0);
     } else {","grammar: two separate sentences joined by a comma. Fix by s/, w/. W/ or sthg. Ditto multiple times below.",c,1,1,0
"@@ -364,6 +364,8 @@ handle_pre_extended_syscall_sigmasks(dcontext_t *dcontext, kernel_sigset_t *sigm
     if (sizemask != sizeof(kernel_sigset_t))
         return false;
     ASSERT(!info->pre_syscall_app_sigprocmask_valid);
+    if (sigmask == NULL)
+        return true;
     info->pre_syscall_app_sigprocmask_valid = true;
     info->pre_syscall_app_sigprocmask = info->app_sigblocked;
     signal_set_mask(dcontext, sigmask);","This leaves `*pending` as uninitialized. With no written contract, this function would be expected to set it when it succeeds.",c,1,1,1
"@@ -116,8 +116,7 @@ func fieldsByName(example interface{}) map[string]reflect.StructField {
 var _ = DescribeTable(""Config parsing"",
         func(key, value string, expected interface{}, errorExpected ...bool) {
                 config := New()
-                config.UpdateFrom(map[string]string{key: value},
-                        EnvironmentVariable)
+                config.UpdateFrom(map[string]string{key: value}, EnvironmentVariable)
                 configPtr := reflect.ValueOf(config)
                 configElem := configPtr.Elem()
                 fieldRef := configElem.FieldByName(key)","Note, another possibly unnecessary change here.",c,1,0,1
"@@ -3432,7 +3432,7 @@ enum xnn_status xnn_initialize(const struct xnn_allocator* allocator) {
     allocator = &xnn_default_allocator;
   }
   #ifdef _MSC_VER
-    _InterlockedCompareExchangePointer(&init_allocator, allocator, NULL);
+    _InterlockedCompareExchangePointer((void* volatile)(&init_allocator), allocator, NULL);
   #else
     __sync_bool_compare_and_swap(&init_allocator, NULL, allocator);
   #endif","Just `(void* volatile) &init_allocator`, no need for extra brackets.",c,1,1,1
"@@ -3719,6 +3719,11 @@ static int check_hand_against_task(struct work_queue *q, struct work_queue_worke
 	if(w->resources->gpus.inuse + limits->gpus > overcommitted_resource_total(q, w->resources->gpus.total, 0)) {
 		ok = 0;
 	}
+		
+	//if the wall time for the worker is specified and there's not enough time for the task, then not ok
+	if(w->resources->time_left != -1 && w->resources->time_left < t->resources_requested->wall_time){
+		ok = 0;
+	}
 
 	rmsummary_delete(limits);
 ","Here we should also check for t->resources_requested->end (if > 0). end is an absolute time, so something like: t->resources->time_left > t->resources_requested->end - timestamp(). or something like that. Also, not all tasks define -> wall_time, so you have to check for wall_time > 0 I would also change time_left != -1 to > 0 for consistency.",c,1,1,1
"@@ -31,6 +31,7 @@
  * DAMAGE.
  */
 
+/* Copyright (c) 2019 Google */
 /* Copyright (c) 2003-2007 Determina Corp. */
 /* Copyright (c) 2001-2003 Massachusetts Institute of Technology */
 /* Copyright (c) 2001 Hewlett-Packard Company */",The Google copyright is on line 1.,c,1,1,1
"@@ -734,6 +734,17 @@ write_content_object (OstreeRepo         *self,
     }
   else
     {
+      /* Update size metadata if configured */
+      if (indexable && object_file_type == G_FILE_TYPE_REGULAR)
+        {
+          struct stat stbuf;
+
+          if (!glnx_fstat (tmpf.fd, &stbuf, error))
+            return FALSE;
+
+          repo_store_size_entry (self, actual_checksum, unpacked_size, stbuf.st_size);
+        }
+
       /* This path is for regular files */
       if (!commit_loose_regfile_object (self, actual_checksum, &tmpf,
                                         uid, gid, mode,",Can you elaborate on how this makes a difference? Aren't `phys_object_is_symlink` and `object_file_type == G_FILE_TYPE_REGULAR` already mutually exclusive?,c,1,1,1
"@@ -64,6 +64,7 @@ static platform_data platform_data_table[] = {
 };
 
 static int initialized;
+static platforms_detected;
 
 static opae_api_adapter_table *adapter_list = (void *)0;
 static pthread_mutex_t adapter_list_lock =",You're thinking this would allow us to have another shot at platform detection if we failed the first time?,c,1,1,1
"@@ -31,8 +31,8 @@ const (
 	ChainFilterForward = ChainNamePrefix + ""-FORWARD""
 	ChainFilterOutput  = ChainNamePrefix + ""-OUTPUT""
 
-	ChainFailsafeIn  = ChainNamePrefix + ""-FAILSAFE-IN""
-	ChainFailsafeOut = ChainNamePrefix + ""-FAILSAFE-OUT""
+	ChainFailsafeIn  = ChainNamePrefix + ""-failsafe-in""
+	ChainFailsafeOut = ChainNamePrefix + ""-failsafe-out""
 
 	ChainNATPrerouting  = ChainNamePrefix + ""-PREROUTING""
 	ChainNATPostrouting = ChainNamePrefix + ""-POSTROUTING""",Upper case is reserved for our versions of top-level chains i.e. the `FORWARD` chain jumps to `cali-FORWARD`.,c,1,1,1
"@@ -410,7 +410,12 @@ drreg_insert_restore_all(void *drcontext, instrlist_t *bb, instr_t *inst,
     uint aflags = (uint)(ptr_uint_t)drvector_get_entry(&pt->aflags.live, pt->live_idx);
     if (!pt->aflags.native &&
         (force_restore ||
-         TESTANY(EFLAGS_READ_ARITH, instr_get_eflags(inst, DR_QUERY_DEFAULT)) ||
+         /* On AArch64, unrecognized instructions are decoded as instances of a generic
+          * instruction, OP_xx. For these instructions conservatively restore aflags in
+          * case they read/write the aflags.
+          */
+         IF_AARCH64(instr_get_opcode(inst) == OP_xx ||)
+             TESTANY(EFLAGS_READ_ARITH, instr_get_eflags(inst, DR_QUERY_DEFAULT)) ||
          /* Writing just a subset needs to combine with the original unwritten */
          (TESTANY(EFLAGS_WRITE_ARITH, instr_get_eflags(inst, DR_QUERY_INCLUDE_ALL)) &&
           aflags != 0 /*0 means everything is dead*/) ||","Given that all of the missing opcodes are vector instructions, I would expect a very small fraction to read or write flags (or GPR's for that matter). I wonder if adding the couple of opcodes that affect flags and GPR's would not be much work. Though it's certainly more work than this workaround. Let's wait for advice from those more familiar with the a64 decoder: @AssadHashmi?",c,0,1,1
"@@ -825,7 +825,7 @@ func (r *RouteTable) fullResyncRoutesForLink(logCxt *log.Entry, ifaceName string
                 logCxt := logCxt.WithField(""dest"", dest)
                 // Check if we should remove routes not added by us
                 if !r.removeExternalRoutes && route.Protocol != r.deviceRouteProtocol {
-                        logCxt.Info(""Syncing routes: not removing route as its not marked as Felix route"")
+                        logCxt.Debug(""Syncing routes: not removing route as its not marked as Felix route"")
                         continue
                 }
 ",Add the missing apostrophe here? (`its` -> `it's`),c,1,0,1
"@@ -170,7 +170,7 @@ const char* cxxDebugScopeDecode(enum CXXScopeType scope)
 		[CXXScopeTypeUnion] = ""union"",
 		[CXXScopeTypeStruct] = ""structg"",
 	};
-	if (sizeof(table) > scope)
+	if (CXXScopeTypeLAST > scope)
 		return table[scope];
 	else
 		return NULL;",could also have been `ARRAY_SIZE(table) > scope`,c,1,1,1
"@@ -16,7 +16,9 @@
  * specific language governing permissions and limitations
  * under the License.
  */
-
+#if defined(_MSC_VER) && (_MSC_VER < 1900)
+#define snprintf _snprintf
+#endif
 #include <thrift/thrift-config.h>
 
 #include <cstring>",This is already done in PlatformSocket.h - you can replace snprintf in this file with THRIFT_SNPRINTF and remove this code block instead.,c,1,1,1
"@@ -2833,6 +2833,15 @@ client_process_bb(dcontext_t *dcontext, build_bb_t *bb)
         if (!instr_opcode_valid(inst))
             continue;
 
+#    ifdef X86
+        if (!d_r_avx512_code_in_use()) {
+            if (instr_may_write_zmm_register(inst)) {
+                if (ZMM_ENABLED())
+                    dynamo_avx512_code_in_use = true;
+            }
+        }
+#    endif
+
         if (instr_is_cti(inst) && inst != instrlist_last(bb->ilist)) {
             /* PR 213005: coarse_units can't handle added ctis (meta or not)
              * since decode_fragment(), used for state recreation, can't","This seems odd to have an accessor function d_r_avx512_code_in_use() yet to have the state it's using be written here. You would expect to either have a set() routine and to hide the state var inside the getter and setter, or to expose both.",c,1,1,1
"@@ -226,7 +226,7 @@ void ValidationStateTracker::PreCallRecordCmdClearColorImage(VkCommandBuffer com
                                                              uint32_t rangeCount, const VkImageSubresourceRange *pRanges) {
     if (disabled[command_buffer_state]) return;
 
-    auto cb_node = Get<CMD_BUFFER_STATE>(commandBuffer);
+    auto cb_node = GetWrite<CMD_BUFFER_STATE>(commandBuffer);
     if (cb_node) {
         cb_node->RecordTransferCmd(CMD_CLEARCOLORIMAGE, Get<IMAGE_STATE>(image));
     }",All get writes this file. Same split lock concern.,cpp,0,0,0
"@@ -60,7 +60,12 @@ TEST_F(FunctionCallExpressionTest, FunctionCallTest) {
     path.src.vid = ""1"";
     STEP(""2"", ""edge"", 0, 1);
     STEP(""1"", ""edge"", 0, -1);
-    TEST_FUNCTION(hasSameEdgeInPath, {path}, true);
+    ArgumentList *argList = ArgumentList::make(&pool);
+    argList->addArgument(ConstantExpression::make(&pool, path));
+    auto functionCall = FunctionCallExpression::make(&pool, ""hasSameEdgeInPath"", argList);
+    auto eval = Expression::eval(functionCall, gExpCtxt);
+    // EXPECT_EQ(eval.type(), expected.type());
+    EXPECT_EQ(eval, Value(true));
   }
   {
     // hasSameEdgeInPath",I think you should provide some new test utilities instead of expand them.,cpp,1,1,0
"@@ -83,6 +83,12 @@ MSG(object_does_not_provide_read_access_to_columns,
 MSG(object_does_not_provide_write_access_to_columns,
     ""Given object does not provide write access to columns"")
 MSG(unsupported_conversion_types, ""Unsupported conversion types"")
+MSG(row_indices_lt_min_value, ""Row indices are less than minimum acceptable value"")
+MSG(row_indices_gt_max_value, ""Row indices are larger than maximum acceptable value"")
+MSG(column_indices_lt_min_value, ""Column indices are less than minimum acceptable value"")
+MSG(column_indices_gt_max_value, ""Column indices are larger than maximum acceptable value"")
+MSG(zero_based_indexing_is_not_supported, ""Zero based indexing is not supported for csr table"")
+MSG(object_does_not_provide_read_access_to_csr, ""Given object does not provide read access to csr"")
 
 /* Ranges */
 MSG(invalid_range_of_rows, ""Invalid range of rows"")",.. read access in csr format ?,cpp,1,0,0
"@@ -17,6 +17,14 @@
 
 #include <adios2.h>
 
+#define str_helper(X) #X
+#define str(X) str_helper(X)
+
+#ifndef DEFAULT_CONFIG
+#define DEFAULT_CONFIG helloBPWriter.xml
+#endif
+#define DEFAULT_CONFIG_STR str(DEFAULT_CONFIG)
+
 int main(int argc, char *argv[])
 {
     MPI_Init(&argc, &argv);","if( rank == 0 ) { std::cout << ""Using config file: "" << configFile << std::endl; }",cpp,1,1,0
"@@ -2789,7 +2789,7 @@ void tm_process_msg(BMS_SRE *pp_sre)
 {
     short                  lv_ret;
     char                   la_send_buffer[4096];
-    char                   la_recv_buffer[sizeof(Tm_Req_Msg_Type)];
+    char                   la_recv_buffer[pp_sre->sre_reqDataSize];
     char                  *la_recv_buffer_ddl = NULL;
     Tm_Broadcast_Req_Type *lp_br_req;
     Tm_Broadcast_Rsp_Type *lp_br_rsp; ","It is not obvious to me why this change solves the problem. For example, at line 2808 below, we check pp_src->src_reqDataSize to see if it is too big to fit in la_recv_buffer, and if so, we dynamically allocate a buffer la_recv_buffer_ddl for it. It looks like the remaining code in the method makes assumptions that certain message types are always shorter than sizeof(Tm_Req_Msg_Type) though; but then the logic would read the message into the wrong buffer and it would fail in some other way. Could you provide an explanation of why it solves the problem? Also, I'm wondering if we could get rid of dynamically allocating la_recv_buffer_ddl and just use la_recv_buffer, by using dynamic array sizing as you have done here. That would simplify the logic and reduce heap pressure. @zcorrea, what do you think?",cpp,0,1,0
"@@ -3635,6 +3635,8 @@ static PropertyDefinition g_properties[] = {
     {""swift-module-search-paths"", OptionValue::eTypeFileSpecList, false, 0,
      nullptr, nullptr,
      ""List of directories to be searched when locating modules for Swift.""},
+    {""swift-create-module-contexts-in-parallel"", OptionValue::eTypeBoolean, false, true,
+     nullptr, nullptr, ""Create modules AST context in parallel.""},
     {""auto-import-clang-modules"", OptionValue::eTypeBoolean, false, true,
      nullptr, nullptr,
      ""Automatically load Clang modules referred to by the program.""},",`Create the per-module Swift AST contexts in parallel.` ?,cpp,1,0,0
"@@ -354,6 +354,10 @@ TEST(Scanner, Basic) {
         CHECK_SEMANTIC_VALUE(""\""He\\\nllo\"""", TokenType::STRING, ""He\nllo""),
         CHECK_SEMANTIC_VALUE(""\""\\\""Hello\\\""\"""", TokenType::STRING, ""\""Hello\""""),
 
+        CHECK_SEMANTIC_VALUE(""'Hello'"", TokenType::STRING, ""Hello""),
+        CHECK_SEMANTIC_VALUE(""'\""Hello\""'"", TokenType::STRING, ""\""Hello\""""),
+        CHECK_SEMANTIC_VALUE(""'\\'Hello\\''"", TokenType::STRING, ""'Hello'""),
+
         // escape Normal character
         CHECK_SEMANTIC_VALUE(""\""Hell\\o\"""", TokenType::STRING, ""Hello""),
         CHECK_SEMANTIC_VALUE(""\""Hell\\\\o\"""", TokenType::STRING, ""Hell\\o""),","""he\'llo""-> he'llo ""he'llo"" -> he'llo or syntax error?",cpp,1,1,0
"@@ -981,7 +981,7 @@ void DatasetLoader::ConstructBinMappersFromTextData(int rank, int num_machines,
         bin_type = BinType::CategoricalBin;
       }
       bin_mappers[i].reset(new BinMapper());
-      if (sample_values.size() <= start[rank] + i) {
+      if (static_cast<int>(sample_values.size()) <= start[rank] + i) {
         continue;
       }
       if (config_.max_bin_by_feature.empty()) {",thanks! Was seeing this warning too last night,cpp,1,0,0
"@@ -886,6 +886,11 @@ void declare_optimization_goal(const size_t context,
 #include <cstring>
 
 namespace Kokkos {
+
+namespace Profiling {
+bool profileLibraryLoaded() { return false; }
+}  // namespace Profiling
+
 namespace Tools {
 
 bool profileLibraryLoaded() { return false; }","```diff diff --git a/core/src/impl/Kokkos_Profiling.cpp b/core/src/impl/Kokkos_Profiling.cpp index 3e593c5..387b83e 100644 --- a/core/src/impl/Kokkos_Profiling.cpp +++ b/core/src/impl/Kokkos_Profiling.cpp @@ -889,7 +889,7 @@ namespace Kokkos { namespace Profiling { bool profileLibraryLoaded() { return false; } -} +} // namespace Profiling namespace Tools {",cpp,0,0,0
"@@ -9,6 +9,7 @@
 #include ""meta/processors/ListHostsProcessor.h""
 #include ""meta/processors/ListSpacesProcessor.h""
 #include ""meta/processors/GetPartsAllocProcessor.h""
+#include <meta/processors/AuthenticationProcessor.h>
 
 #define RETURN_FUTURE(processor) \
     auto f = processor->getFuture(); \",Please do not use **<>** for our own header files,cpp,1,1,1
"@@ -3472,9 +3472,16 @@ bool SwiftASTContext::LoadOneImage(Process &process, FileSpec &link_lib_spec,
 
 static std::vector<std::string>
 GetLibrarySearchPaths(const swift::SearchPathOptions &search_path_opts) {
-  std::vector<std::string> paths(search_path_opts.LibrarySearchPaths.begin(),
-                                 search_path_opts.LibrarySearchPaths.end());
+  // The order in which we look up the libraries is important. The REPL
+  // dlopen()s libswiftCore, and gives precedence to the just built standard
+  // library instead of the one in the OS. When we type `import Foundation`,
+  // we want to make sure we end up loading the correct library, i.e. the
+  // one sitting next to the stdlib we just built, and then fall back to the
+  // one in the OS if that's not available.
+  std::vector<std::string> paths;
   paths.push_back(search_path_opts.RuntimeLibraryPath);
+  for (std::string path : search_path_opts.LibrarySearchPaths)
+    paths.push_back(path);
   return paths;
 }
 ",(Nit) We might want to reserve the vector.,cpp,1,1,1
"@@ -5357,7 +5357,8 @@ TEST_F(VkLayerTest, CreatePipelineExceedMaxComponentsBlocks) {
 
     // 1 for maxVertexOutputComponents and 1 for maxFragmentInputComponents
     CreatePipelineHelper::OneshotTest(*this, set_info, kErrorBit,
-                                      vector<string>{""VUID-RuntimeSpirv-Location-06272"", ""VUID-RuntimeSpirv-Location-06272""});
+                                      vector<string>{""VUID-RuntimeSpirv-Location-06272"", ""VUID-RuntimeSpirv-Location-06272"",
+                                                     ""VUID-RuntimeSpirv-Location-06272"", ""VUID-RuntimeSpirv-Location-06272""});
 }
 
 TEST_F(VkLayerTest, CreatePipelineExceedMaxTessellationControlInputOutputComponents) {","Maybe this is obvious, but why did this effect this test?",cpp,1,1,1
"@@ -848,13 +848,12 @@ class Dataset(object):
             self.set_weight(weight)
         if group is not None:
             self.set_group(group)
-        # load init score
-        if init_score is not None:
-            self.set_init_score(init_score)
-            if predictor is not None:
-                warnings.warn(""The prediction of init_model will be overridden by init_score."")
-        elif isinstance(predictor, _InnerPredictor):
+        if isinstance(predictor, _InnerPredictor):
+            if self._predictor is None and init_score is not None:
+                warnings.warn(""The init_score will be overridden by the prediction of init_model."")
             self._set_init_score_by_predictor(predictor, data)
+        elif init_score is not None:
+            self.set_init_score(init_score)
         elif predictor is not None:
             raise TypeError('Wrong predictor type {}'.format(type(predictor).__name__))
         # set feature names",Can you please clarify `if self._predictor is None` check?,cpp,1,1,1
"@@ -1074,7 +1074,7 @@ int main(int argc, char **argv) {
 #ifdef CURL_ENABLED
             if (proj_context_is_network_enabled(nullptr)) {
                 std::cout << ""Status: enabled"" << std::endl;
-                std::cout << ""URL: "" << pj_context_get_url_endpoint(nullptr)
+                std::cout << ""URL: "" << std::string(proj_context_get_url_endpoint(nullptr))
                           << std::endl;
             } else {
                 std::cout << ""Status: disabled"" << std::endl;",this shouldn't be needed. The << operator will be happy with a const char*,cpp,1,1,1
"@@ -330,7 +330,8 @@ class LGBMModel(_LGBMModelBase):
             sample_weight=None, init_score=None, group=None,
             eval_set=None, eval_names=None, eval_sample_weight=None,
             eval_class_weight=None, eval_init_score=None, eval_group=None,
-            eval_metric=None, early_stopping_rounds=None, verbose=True,
+            eval_metric=None, eval_train_metric=None, eval_valid_metric=None,
+            early_stopping_rounds=None, verbose=True,
             feature_name='auto', categorical_feature='auto', callbacks=None):
         """"""Build a gradient boosting model from the training set (X, y).
 ",I don't think that these new args are really needed. One can achieve the needed result in their rare case with `params`.,cpp,1,1,1
"@@ -43,6 +43,7 @@ DesktopSwitchConfiguration::DesktopSwitchConfiguration(PluginSettings *settings,
 
     connect(ui->rowsSB, SIGNAL(valueChanged(int)), this, SLOT(rowsChanged(int)));
     connect(ui->labelTypeCB, SIGNAL(currentIndexChanged(int)), this, SLOT(labelTypeChanged(int)));
+    connect(ui->showOnlyActiveCB, &QAbstractButton::toggled, [this] (bool checked) { this->settings().setValue(""showOnlyActive"", checked); });
 
     loadDesktopsNames();
 }",Implicit string cast,cpp,1,0,1
"@@ -79,13 +79,17 @@ bool PDPServer2::init(
         return false;
     }
 
+    // Initialize server dedicated thread.
+    resource_event_thread_.init_thread();
+
     /*
         Given the fact that a participant is either a client or a server the
         discoveryServer_client_syncperiod parameter has a context defined meaning.
      */
     mp_sync = new DServerEvent2(this,
-                    TimeConv::Duration_t2MilliSecondsDouble(m_discovery.discovery_config.
-                    discoveryServer_client_syncperiod));
+                    TimeConv::Duration_t2MilliSecondsDouble(
+                            m_discovery.discovery_config.discoveryServer_client_syncperiod));
+
     awakeServerThread();
 
     return true;","I'd leave the first awaken for the first data received/added to the database, either by listeners or `PDPServer2::announceParticipantState()`",cpp,1,1,1
"@@ -397,9 +397,6 @@ class LGBMModel(_LGBMModelBase):
             self._fobj = None
         evals_result = {}
         params = self.get_params()
-        # sklearn interface has another naming convention
-        params.setdefault('seed', params.pop('random_state'))
-        params.setdefault('nthread', params.pop('n_jobs'))
         # user can set verbose with kwargs, it has higher priority
         if 'verbose' not in params and self.silent:
             params['verbose'] = 0",Lets move these names to aliases at C++ side,cpp,1,1,1
"@@ -148,6 +148,16 @@ CONSTEXPR uint32_t info_dst_message_length = 16;
 CONSTEXPR uint32_t info_ts_message_length = 12;
 CONSTEXPR uint32_t data_frag_submessage_header_length = 36;
 
+uint32_t RTPSWriter::get_max_fragment_payload_size()
+{
+    constexpr uint32_t data_frag_header_size = 28;
+    constexpr uint32_t max_inline_qos_size = 32;
+    // Max fragment is 64KBytes_max - header - inlineqos - 4(for better alignment)
+    constexpr uint32_t max_fragment_size = std::numeric_limits<uint16_t>::max() - data_frag_header_size - max_inline_qos_size - 4;
+    
+    return max_fragment_size;
+}
+
 uint32_t RTPSWriter::getMaxDataSize()
 {
     return calculateMaxDataSize(mp_RTPSParticipant->getMaxMessageSize());",Move this method to the header file and make it an inline constexpr one.,cpp,1,1,1
"@@ -64,7 +64,11 @@ ExtractorOptions::ParseArguments(int argc, char *argv[], ExtractorConfig &extrac
         ""Number of threads to use"")(
             ""generate-edge-lookup"",boost::program_options::value<bool>(
                                                 &extractor_config.generate_edge_lookup)->implicit_value(true)->default_value(false),
-                                 ""Generate a lookup table for internal edge-expanded-edge IDs to OSM node pairs"");
+                                 ""Generate a lookup table for internal edge-expanded-edge IDs to OSM node pairs"")(
+        ""small-component-size"",
+        boost::program_options::value<unsigned int>(&extractor_config.small_component_size)
+            ->default_value(1000),
+        ""Number of nodes required before a strongly-connected-componennt is considered big (affects nearest neighbor snapping)"");
 
 #ifdef DEBUG_GEOMETRY
         config_options.add_options()(""debug-turns"",","Cool.. but how does it affect the snapping? From the description I can not see how it would affect snapping if I increase the size, and how it affects the snapping if I decrease the size. I think we can be more user-friendly here --- in the end it's not just us who wants to use this.",cpp,1,1,0
"@@ -29,7 +29,11 @@ Status ExecutionEngine::init(std::shared_ptr<folly::IOThreadPoolExecutor> ioExec
         return addrs.status();
     }
     metaClient_ = std::make_unique<meta::MetaClient>(ioExecutor, std::move(addrs.value()));
-    metaClient_->init();
+    // load data try 3 time
+    bool loadDataOk = metaClient_->waitForMetadReady(3);
+    if (!loadDataOk) {
+        LOG(ERROR) << ""ExecutionEngine::init loadData by thread error!"";
+    }
 
     schemaManager_ = meta::SchemaManager::create();
     schemaManager_->init(metaClient_.get());","storaged return failed when load meta data failed, but why here not?",cpp,1,1,1
"@@ -179,6 +179,14 @@ Client::Client(EQStreamInterface* ieqs)
         for (int client_filter = 0; client_filter < _FilterCount; client_filter++)
                 ClientFilters[client_filter] = FilterShow;
 
+        m_TimeSinceLastPositionCheck = 0;
+        m_DistanceSinceLastPositionCheck = 0.0f;
+        m_ShadowStepExemption = 0;
+        m_KnockBackExemption = 0;
+        m_PortExemption = 0;
+        m_SenseExemption = 0;
+        m_AssistExemption = 0;
+        m_CheatDetectMoved = false;
         mMovementManager->AddClient(this);
         character_id = 0;
         conn_state = NoPacketsReceived;","I know the source is inconsistent but I believe the effort is to have variable names snake case where possible for these, like `m_distance_since_last_position_check`, `m_cheat_detect_moved`, etc",cpp,1,1,1
"@@ -2277,7 +2277,7 @@ TEST_F(VkLayerTest, GpuValidationArrayOOB) {
 
     VkDescriptorImageInfo image_info[6] = {};
     for (int i = 0; i < 6; i++) {
-        image_info[i] = texture.m_imageInfo;
+        image_info[i] = texture.DescriptorImageInfo();
         image_info[i].sampler = sampler.handle();
         image_info[i].imageLayout = VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL;
     }","this is part of the framework cleanup for correct image layout tracking. The former code had a ""man with two watches"" problem. It tracked to different DescriptorImageInfo structs, partially updating each (and thus making part of each stale)",cpp,1,1,1
"@@ -56,6 +56,10 @@ void outputMetaData(const t_obj *obj, std::ostream &d_os,
     d_os << "" "" << prop.substr(10) << ""=\"""" << value << ""\"""";
   }
 }
+std::string formatDouble(double val) {
+  return str(boost::format(""%.1f"") % val);
+}
+
 }  // namespace
 
 std::string DrawColourToSVG(const DrawColour &col) {",this should be deleted after the function is moved,cpp,1,1,1
"@@ -111,6 +111,8 @@ void parseMCSParametersJSON(const char* json, MCSParameters* params) {
         ""RingMatchesRingOnly"", p.AtomCompareParameters.RingMatchesRingOnly);
     p.BondCompareParameters.RingMatchesRingOnly = pt.get<bool>(
         ""RingMatchesRingOnly"", p.BondCompareParameters.RingMatchesRingOnly);
+    p.AtomCompareParameters.CompleteRingsOnly = pt.get<bool>(
+        ""CompleteRingsOnly"", p.AtomCompareParameters.CompleteRingsOnly);
     p.BondCompareParameters.CompleteRingsOnly = pt.get<bool>(
         ""CompleteRingsOnly"", p.BondCompareParameters.CompleteRingsOnly);
     p.BondCompareParameters.MatchFusedRings = pt.get<bool>(",This is a little bit misleading since `CompleteRingsOnly` will apply to both to both atoms and bonds. Would it maybe be clearer to call this one `CompleteAtomRingsOnly`? (To be clear: I'm not sure... asking for your opinion),cpp,1,1,1
"@@ -46,7 +46,7 @@ void CleanTCPSocketsEvent::event(EventCode code, const char* /*msg*/)
 {
     if(code == EVENT_SUCCESS)
     {
-        mp_transport->clean_deleted_sockets();
+        //mp_transport->clean_deleted_sockets();
     }
 }
 ","So... the whole class isn't necessary, didn't?",cpp,1,0,1
"@@ -1516,6 +1516,10 @@ void LuaScriptInterface::registerFunctions()
 	registerEnum(ITEM_ATTRIBUTE_CHARGES)
 	registerEnum(ITEM_ATTRIBUTE_FLUIDTYPE)
 	registerEnum(ITEM_ATTRIBUTE_DOORID)
+	registerEnum(ITEM_ATTRIBUTE_DECAYTO)
+	registerEnum(ITEM_ATTRIBUTE_WRAPID)
+	registerEnum(ITEM_ATTRIBUTE_STOREITEM)
+	registerEnum(ITEM_ATTRIBUTE_ATTACK_SPEED)
 
 	registerEnum(ITEM_TYPE_DEPOT)
 	registerEnum(ITEM_TYPE_MAILBOX)",doesn't these belong to the attr PR?,cpp,0,0,1
"@@ -1971,6 +1971,17 @@ StmtDDLAlterTableAddColumn::synthesize()
     theColumn->traverseList(
          this,
          StmtDDLAlterTableAddColumn_visit);
+
+    ElemDDLColDefArray ColDefArray = getColDefArray();
+    ElemDDLColDef *pColDef = ColDefArray[0];
+    if (NOT pColDef->getColumnFamily().isNull())
+      {
+        //TEMPTEMP 
+        // Currently, DTM doesnt handle add columns with an explicit 
+        // column family as a transactional operation.
+        // Do not use ddl xns until that bug is fixed.
+        setDdlXns(FALSE);
+      }
   }
 }  //StmtDDLAlterTableAddColumn::synthesize()
 ",How about ALTER TABLE/INDEX ALTER HBASE_OPTIONS? Does it work transactionally? (I'm not sure that code was completed.),cpp,1,1,1
"@@ -39,17 +39,9 @@ kvstore::ResultCode QueryEdgePropsProcessor::collectEdgesProps(
     return ret;
 }
 
-void QueryEdgePropsProcessor::addDefaultProps() {
-    this->edgeContext_.props_.emplace_back(""_src"", 0, PropContext::PropInKeyType::SRC);
-    this->edgeContext_.props_.emplace_back(""_rank"", 1, PropContext::PropInKeyType::RANK);
-    this->edgeContext_.props_.emplace_back(""_dst"", 2, PropContext::PropInKeyType::DST);
-}
-
 void QueryEdgePropsProcessor::process(const cpp2::EdgePropRequest& req) {
     spaceId_ = req.get_space_id();
-    // By default, _src, _rank, _dst will be returned as the first 3 fields
-    addDefaultProps();
-    int32_t returnColumnsNum = req.get_return_columns().size() + this->edgeContext_.props_.size();
+    //    initContext(req.edge_types, true);
     auto retCode = this->checkAndBuildContexts(req);
     if (retCode != cpp2::ErrorCode::SUCCEEDED) {
         for (auto& p : req.get_parts()) {",Why remove the default props?,cpp,1,0,1
"@@ -111,7 +111,7 @@ bool save_model::do_save_model_weights(model *m) {
 
   // Shared checkpoint, logic identical to Distributed.i
   makedir(m_dir.c_str());
-  std::string epochdir = get_shared_checkpoint_dirname(m, m_dir.c_str(), c.get_execution_mode(), epoch, step);
+  std::string epochdir = get_shared_checkpoint_dirname(c.get_trainer().get_name(), m, m_dir.c_str(), c.get_execution_mode(), epoch, step);
   if (comm->am_trainer_master()) {
     p.open_checkpoint(epochdir.c_str());
   }",See. You got the trainer's name through a model pointer...,cpp,1,0,1
"@@ -44,13 +44,6 @@ Account IOLoginData::loadAccount(uint32_t accno)
 	return account;
 }
 
-bool IOLoginData::saveAccount(const Account& acc)
-{
-	std::ostringstream query;
-	query << ""UPDATE `accounts` SET `premium_ends_at` = "" << acc.premiumEndsAt << "" WHERE `id` = "" << acc.id;
-	return Database::getInstance().executeQuery(query.str());
-}
-
 std::string decodeSecret(const std::string& secret)
 {
 	// simple base32 decoding",why are you removing it?,cpp,1,0,1
"@@ -2892,7 +2892,8 @@ short ExpGenerator::generateKeyEncodeExpr(const IndexDesc * indexDesc,
       if (handleSerialization)
 	{
 	  NAColumn * nac = indexDesc->getNAFileSet()->getIndexKeyColumns()[i];
-	  if (CmpSeabaseDDL::isEncodingNeededForSerialization(nac))
+          NABoolean isAlignedRowFormat = indexDesc->getNAFileSet()->isSqlmxAlignedRowFormat();
+	  if ((!isAlignedRowFormat) && CmpSeabaseDDL::isEncodingNeededForSerialization(nac))
 	    {
 	      if (desc_flag)
 		{","Since the NAColumn object has a data member describing its serialization state, why do we ned the additional check of !isAlignedFormat here? For example t1.b is serialized bit the correspond column in the index t1_ix1.b is part of an aligned row and therefor not serailized. I would have expected CmpSeabaseDDL::isEncodingNeededForSerialization(nac) to return FALSE for t1_ix1.b since you havetaken care to set up two different NAColumn objects for the table and index.",cpp,1,1,0
"@@ -118,16 +118,13 @@ namespace RDKit{
       }
     }
 
-    void iterateCIPRanks(const ROMol &mol, DOUBLE_VECT &invars, UINT_VECT &ranks,bool seedWithInvars){
+    void iterateCIPRanks(const ROMol &mol, DOUBLE_VECT &invars,
+                         UINT_VECT &ranks,bool seedWithInvars){
       PRECONDITION(invars.size()==mol.getNumAtoms(),""bad invars size"");
       PRECONDITION(ranks.size()>=mol.getNumAtoms(),""bad ranks size"");
 
       unsigned int numAtoms = mol.getNumAtoms();
       CIP_ENTRY_VECT cipEntries(numAtoms);
-      INT_LIST allIndices;
-      for(unsigned int i=0;i<numAtoms;++i){
-        allIndices.push_back(i);
-      }
 #ifdef VERBOSE_CANON
       BOOST_LOG(rdDebugLog) << ""invariants:"" << std::endl;
       for(unsigned int i=0;i<numAtoms;i++){","Though the changes in this function seem to make sense after a brief review, I don't think they are connected to the const std::string fix that's the actual purpose of the PR.",cpp,0,1,1
"@@ -55,9 +55,10 @@ struct LocalFile : VirtualFileReader, VirtualFileWriter {
 };
 
 const char* kHdfsProto = ""hdfs://"";
-const size_t kHdfsProtoLength = strlen(kHdfsProto);
 
 #ifdef USE_HDFS
+const size_t kHdfsProtoLength = strlen(kHdfsProto);
+
 struct HDFSFile : VirtualFileReader, VirtualFileWriter {
   HDFSFile(const std::string& filename, int flags) : filename_(filename), flags_(flags) {}
   ~HDFSFile() {",maybe `const size_t kHdfsProtoLength = static_cast<size_t>(strlen(kHdfsProto));` ?,cpp,1,1,1
"@@ -134,6 +134,17 @@ void LmJavaOptions::addOptions(const char *options,
   NADELETEBASIC(copy, collHeap());
 }
 
+CollIndex LmJavaOptions::findByPrefix(const char *prefix) const
+{
+  size_t prefixLen = strlen(prefix);
+
+  for (CollIndex i=0; i<options_.entries(); i++)
+    if (strncmp(options_[i], prefix, prefixLen) == 0)
+      return i;
+
+  return NULL_COLL_INDEX;
+}
+
 void LmJavaOptions::addSystemProperty(const char *name,
                                       const char *value)
 {",Is it possible for one prefix to be a subset of another? Just making up a possible example: -Xms vs. -Xms2? Would this code behave correctly then?,cpp,1,1,1
"@@ -63,7 +63,7 @@ void P016_data_struct::ExecuteCode(uint32_t  Code) {
   uint32_t _now = millis();
   if (iLastCmd == Code) {
     // same code as before
-    if (iCmdInhibitTime > (int32_t)(_now - iLastCmdTime)) {
+    if (iCmdInhibitTime > static_cast<uint32_t>(_now - iLastCmdTime)) {
       // inhibit time not ellapsed
       return;
     }",Why not using the `timePassedSince` function here? This is very tricky what you're doing here.,cpp,1,1,1
"@@ -15,6 +15,10 @@ ExecutionContext::~ExecutionContext() {
         sm_ = nullptr;
     }
 
+    if (nullptr != gflagsManager_) {
+        gflagsManager_ = nullptr;
+    }
+
     if (nullptr != storage_) {
         storage_ = nullptr;
     }",maybe here can set nullptr directly.,cpp,1,0,1
"@@ -13,11 +13,15 @@ PartsMap MemPartManager::parts(const HostAddr& hostAddr) {
     return partsMap_;
 }
 
-PartMeta MemPartManager::partMeta(GraphSpaceID spaceId, PartitionID partId) {
+StatusOr<PartMeta> MemPartManager::partMeta(GraphSpaceID spaceId, PartitionID partId) {
     auto it = partsMap_.find(spaceId);
-    CHECK(it != partsMap_.end());
+    if (it == partsMap_.end()) {
+        return Status::Error(""Space not found"");
+    }
     auto partIt = it->second.find(partId);
-    CHECK(partIt != it->second.end());
+    if (partIt == it->second.end()) {
+        return Status::Error(""Part not found in MemPartManager, id was %d"", partId);
+    }
     return partIt->second;
 }
 ",error msg can include the spaceId and partId,cpp,1,1,1
"@@ -8,13 +8,13 @@ const char *counterNames[NUM_CONV_TYPES] = {
     ""version"", ""init"", ""device"", ""mem"", ""kern"", ""coord_func"", ""math_func"", ""device_func"",
     ""special_func"", ""stream"", ""event"", ""occupancy"", ""ctx"", ""peer"", ""module"",
     ""cache"", ""exec"", ""err"", ""def"", ""tex"", ""gl"", ""graphics"",
-    ""surface"", ""jit"", ""d3d9"", ""d3d10"", ""d3d11"", ""vdpau"", ""egl"",
+    ""surface"", ""jit"", ""d3d9"", ""d3d10"", ""d3d11"", ""vdpau"", ""egl"", ""complex"",
     ""thread"", ""other"", ""include"", ""include_cuda_main_header"", ""type"", ""literal"",
     ""numeric_literal""
 };
 
 const char *apiNames[NUM_API_TYPES] = {
-    ""CUDA Driver API"", ""CUDA RT API"", ""CUBLAS API"", ""CURAND API"", ""CUDNN API"", ""CUFFT API""
+    ""CUDA Driver API"", ""CUDA RT API"", ""CUBLAS API"", ""CURAND API"", ""CUDNN API"", ""CUFFT API"", ""cuComplex API""
 };
 
 namespace {",why this api name is not capitalized as other?,cpp,1,1,1
"@@ -1,6 +1,7 @@
 // unit tests creating LAMMPS instances via the library interface
 
 #include ""lammps.h""
+#define LAMMPS_LIB_MPI 1
 #include ""library.h""
 #include <cstdio> // for stdin, stdout
 #include <mpi.h>",Should this be here?,cpp,1,0,1
"@@ -305,7 +305,14 @@ void nano::bootstrap_server::receive_bulk_pull_action (boost::system::error_code
 		{
 			if (node->config.logging.bulk_pull_logging ())
 			{
-				node->logger.try_log (boost::str (boost::format (""Received bulk pull for %1% down to %2%, maximum of %3%"") % request->start.to_string () % request->end.to_string () % (request->count ? request->count : std::numeric_limits<double>::infinity ())));
+				if (!request->start.is_zero ())
+				{
+					node->logger.try_log (boost::str (boost::format (""Received bulk pull for %1% down to %2%, maximum of %3%"") % request->start.to_string () % request->end.to_string () % (request->count ? request->count : std::numeric_limits<double>::infinity ())));
+				}
+				else
+				{
+					node->logger.try_log (boost::str (boost::format (""Received bulk pull for %1% down to %2%, maximum of %3% from %4%"") % request->start.to_string () % request->end.to_string () % (request->count ? request->count : std::numeric_limits<double>::infinity ()) % remote_endpoint));
+				}
 			}
 			if (is_bootstrap_connection () && !node->flags.disable_bootstrap_bulk_pull_server)
 			{","These clauses are almost identical, can we just always log the remote endpoint?",cpp,1,1,1
"@@ -17,7 +17,9 @@
 #include ""oneapi/dal/test/engine/config.hpp""
 
 #include <stdexcept>
-#include ""oneapi/dal/test/engine/common.hpp""
+#include ""oneapi/dal/test/engine/common_base.hpp""
+
+#include <iostream>
 
 namespace oneapi::dal::test::engine {
 ",Is it necessary?,cpp,1,0,1
"@@ -47,6 +47,10 @@ void UpdateEdgeProcessor::onProcessFinished(int32_t retNum) {
             return it->second;
         };
         for (auto& exp : returnColumnsExp_) {
+            if (!exp->prepare().ok()) {
+                LOG(ERROR) << ""Expression::prepare failed"";
+                return;
+            }
             auto value = exp->eval(getters);
             if (!value.ok()) {
                 LOG(ERROR) << value.status();",The check here should be redundant because `UpdateEdgeProcessor::checkAndBuildContexts` has already processed.,cpp,1,1,1
"@@ -15,6 +15,7 @@
 // converted to color.
 
 #include <glog/logging.h>
+#include <gflags/gflags.h>
 #include <leveldb/db.h>
 #include <leveldb/write_batch.h>
 #include <lmdb.h>",Consider moving this up above glog.,cpp,1,1,1
"@@ -150,8 +150,10 @@ namespace LightGBM {
   }
 
   std::vector<double> FindBinWithZeroAsOneBin(const double* distinct_values, const int* counts,
-    int num_distinct_values, int max_bin, size_t total_sample_cnt, int min_data_in_bin) {
+    int num_distinct_values, int max_bin, size_t total_sample_cnt, int min_data_in_bin, std::vector<double> forced_upper_bounds) {
     std::vector<double> bin_upper_bound;
+
+    // get list of distinct values
     int left_cnt_data = 0;
     int cnt_zero = 0;
     int right_cnt_data = 0;","could we add an independent function,`FindBinWithPredefinedBin`, to include these changes? I am afraid of these changes may introduce some bugs.",cpp,1,1,1
"@@ -305,9 +305,15 @@ void addRecursiveQueriesHelper(ROMol &mol, python::dict replDict,
   addRecursiveQueries(mol, replacements, propName);
 }
 
-ROMol *addHs(const ROMol &orig, bool explicitOnly = false,
-             bool addCoords = false) {
-  return MolOps::addHs(orig, explicitOnly, addCoords);
+ROMol *addHs(const ROMol &orig, bool explicitOnly, bool addCoords,
+             python::object onlyOnAtoms) {
+  std::vector<unsigned int> *onlyOn = NULL;
+  if (onlyOnAtoms) {
+    onlyOn = pythonObjectToVect(onlyOnAtoms, orig.getNumAtoms());
+  }
+  ROMol *res = MolOps::addHs(orig, explicitOnly, addCoords, onlyOn);
+  delete onlyOn;
+  return res;
 }
 int getSSSR(ROMol &mol) {
   VECT_INT_VECT rings;","if this throws an exception, isn't onlyOn leaked since it never reaches delete? (normally RAII takes care of this stuff, but I have no idea how boost::python deals with this).",cpp,1,1,1
"@@ -32,7 +32,7 @@ namespace ddb {
 DiscoveryDataBase::DiscoveryDataBase(
         fastrtps::rtps::GuidPrefix_t server_guid_prefix)
     : server_guid_prefix_(server_guid_prefix)
-    , server_acked_by_all_(false)
+    , server_acked_by_all_(true)
 {
 }
 ",I would not change this until the list of servers is defined in the database construction. Better to change it with the implementation that @EduPonz is going to do in the pinging PR.,cpp,0,0,1
"@@ -416,6 +416,7 @@ void fence_internal() {
     Kokkos::Serial::impl_static_fence();
   }
 #endif
+  memory_fence();
 }
 
 bool check_arg(char const* arg, char const* expected) {","This feels like it's almost certainly superfluous. In what backend does `fence()` not imply `memory_fence()` already? IIUC, the end of a OpenMP section implies a memory fence, and the threads backend already has one. I can't imagine that the Cuda, ROCm, or HPX join mechanisms do some sort of voodoo that I'm unaware of to perform an execution fence without implying a memory fence. I'm additionally wary of adding this because compilers can't remove redundant memory fences (because of the nature of fences), and AFAICT this is redundant in every case, so it's strictly overhead.",cpp,1,1,0
"@@ -294,6 +294,9 @@ const std::unordered_set<std::string>& Config::parameter_set() {
   ""gpu_platform_id"",
   ""gpu_device_id"",
   ""gpu_use_dp"",
+#ifdef USE_CUDA
+  ""num_gpu"", /* LGBM_CUDA */
+#endif
   });
   return params;
 }","I remember these codes are auto-generated, so we cannot manually change it. @StrikerRUS to confirm.",cpp,0,1,1
"@@ -949,6 +949,9 @@ static bool ValidateFsOutputsAgainstRenderPass(debug_report_data const *report_d
     auto it_a = outputs.begin();
     auto it_b = color_attachments.begin();
     bool used = false;
+    bool alphaToCoverageEnabled = pipeline->graphicsPipelineCI.pMultisampleState != NULL &&
+                                  pipeline->graphicsPipelineCI.pMultisampleState->alphaToCoverageEnable == VK_TRUE;
+    bool locationZeroHasAlpha = false;
 
     // Walk attachment list and outputs together
 ","this is potentially dereferencing outputs.end(), checked above and below, but not here.",cpp,1,1,1
"@@ -1868,6 +1868,13 @@ static inline VkExtent3D GetImageSubresourceExtent(const IMAGE_STATE *img, const
     // Don't allow mip adjustment to create 0 dim, but pass along a 0 if that's what subresource specified
     VkExtent3D extent = img->createInfo.extent;
 
+    // If multi-plane, adjust per-plane extent
+    if (FormatIsMultiplane(img->createInfo.format)) {
+        VkExtent2D divisors = FindMultiplaneExtentDivisors(img->createInfo.format, subresource->aspectMask);
+        extent.width /= divisors.width;
+        extent.height /= divisors.height;
+    }
+
     if (img->createInfo.flags & VK_IMAGE_CREATE_CORNER_SAMPLED_BIT_NV) {
         extent.width = (0 == extent.width ? 0 : std::max(2U, 1 + ((extent.width - 1) >> mip)));
         extent.height = (0 == extent.height ? 0 : std::max(2U, 1 + ((extent.height - 1) >> mip)));","If these divisors are always power of 2, then could >> by 2^x for the pow of 2 instead of divide for perf.",cpp,1,1,1
"@@ -3718,7 +3718,16 @@ rai::thread_runner::thread_runner (boost::asio::io_service & service_a, unsigned
 			}
 			catch (...)
 			{
+#ifndef NDEBUG
+				/*
+				 * In a release build, catch and swallow the
+				 * service exception, in debug mode pass it
+				 * on
+				 */
+				throw;
+
 				assert (false && ""Unhandled service exception"");
+#endif
 			}
 		}));
 	}",Shouldn't we get rid of this assert?,cpp,1,0,1
"@@ -43,7 +43,8 @@ data_reader_merge_features::data_reader_merge_features(
   const data_reader_merge_features& other) :
   generic_compound_data_reader(other),
   m_data_size(other.m_data_size) {
-  m_label_reader = other.m_label_reader->copy();
+  if(other.m_label_reader != nullptr) 
+    m_label_reader = other.m_label_reader->copy();
 }
 
 data_reader_merge_features& data_reader_merge_features::operator=(",We should handle the case where `other.m_label_reader == nullptr`.,cpp,1,1,1
"@@ -51,6 +51,7 @@ using namespace MathSpecial;
 
 enum{REVERSE_RHO};
 enum{FORWARD_IK,FORWARD_AD,FORWARD_IK_PERATOM,FORWARD_AD_PERATOM};
+enum{FORWARD=-1,BACKWARD=1};
 
 #ifdef FFT_SINGLE
 #define ZEROF 0.0f",This enumerator should be placed inside the `FFT3d` class definition in `fft3d_wrap.h` and then referenced with `FFT3d::FORWARD` or `FFT3d::BACKWARD`.,cpp,1,1,1
"@@ -41,6 +41,7 @@ FixAveAtom::FixAveAtom(LAMMPS *lmp, int narg, char **arg) :
   nevery = utils::inumeric(FLERR,arg[3],false,lmp);
   nrepeat = utils::inumeric(FLERR,arg[4],false,lmp);
   peratom_freq = utils::inumeric(FLERR,arg[5],false,lmp);
+  time_depend = 1;
 
   nvalues = narg - 6;
 ",Should also remove the error check in end_of_step*( with message Invalid timestep reset ... Ditto for other fix ave/*,cpp,0,1,1
"@@ -56,6 +56,8 @@
 #include <cerrno>
 #ifndef _WIN32
 #include <unistd.h>
+#else
+#include <Windows.h>
 #endif
 
 //----------------------------------------------------------------------------",Is this needed because msvc includes it by default but msvc-cl doesn't?,cpp,1,1,1
"@@ -266,7 +266,7 @@ bool Condition::isPersistent() const
 		return false;
 	}
 
-	if (!(id == CONDITIONID_DEFAULT || id == CONDITIONID_COMBAT)) {
+	if (!(id == CONDITIONID_DEFAULT || id == CONDITIONID_COMBAT || condition->getType() == CONDITION_MUTED)) {
 		return false;
 	}
 ",`condition->getType()` to `conditionType`,cpp,1,1,1
"@@ -17,6 +17,8 @@
 #include ""../Helpers/PortStatus.h""
 #include ""../Helpers/StringConverter.h""
 
+#include ""../WebServer/HardwarePage.h""
+
 //#include ""../../ESPEasy-Globals.h""
 
 #ifdef ESP32",The same here... Why include a piece of WebServer code in a generic helper?,cpp,0,1,1
"@@ -1178,6 +1178,8 @@ static void CreateDirectoryRecursively(PJ_CONTEXT *ctx,
 
 std::string pj_context_get_user_writable_directory(PJ_CONTEXT *ctx,
                                                    bool create) {
+    if (!ctx)
+        ctx = pj_get_default_ctx();
     if (ctx->user_writable_directory.empty()) {
         // For testing purposes only
         const char *env_var_PROJ_USER_WRITABLE_DIRECTORY =",Was this missing before?,cpp,1,0,1
"@@ -278,6 +278,10 @@ String BuildFixes()
     Settings.WiFi_sensitivity_margin = 3; // Margin in dBm on top of sensitivity.
   }
 
+  if (Settings.Build < 20113) {
+    Settings.JSONBoolWithQuotes(true); // Set JSON output to backward compatible
+  }
+
   Settings.Build = BUILD;
   return SaveSettings();
 }","Why not invert the boolean logic, so that a `0` is the default value? This way you don't need this transition and also new default settings will be the old behavior.",cpp,1,1,1
"@@ -242,7 +242,7 @@ void nano::transport::tcp_channels::process_message (nano::message const & messa
 			{
 				node.network.process_message (message_a, channel);
 			}
-			else
+			else if (!node.flags.disable_udp || (message_a.header.type != nano::message_type::confirm_req && message_a.header.type != nano::message_type::confirm_req))
 			{
 				auto udp_channel (std::make_shared<nano::transport::channel_udp> (node.network.udp_channels, nano::transport::map_tcp_to_endpoint (endpoint_a)));
 				node.network.process_message (message_a, udp_channel);",Same type checked twice,cpp,0,1,1
"@@ -446,8 +446,9 @@ void YieldExecutor::feedResult(std::unique_ptr<InterimResult> result) {
 }
 
 void YieldExecutor::setupResponse(cpp2::ExecutionResponse &resp) {
-    CHECK(resp_ != nullptr);
-    resp = std::move(*resp_);
+    if (resp_ != nullptr) {
+        resp = std::move(*resp_);
+    }
 }
 
 }   // namespace graph","Here maybe an empty resp should be set to return to the caller, similar to the GoExecutor :: setupResponse method?",cpp,1,1,1
"@@ -48,6 +48,12 @@ bool nano::block_processor::full ()
 	return (blocks.size () + state_blocks.size ()) > node.flags.block_processor_full_size;
 }
 
+bool nano::block_processor::half_full ()
+{
+	std::unique_lock<std::mutex> lock (mutex);
+	return (blocks.size () + state_blocks.size ()) > node.flags.block_processor_full_size / 2;
+}
+
 void nano::block_processor::add (std::shared_ptr<nano::block> block_a, uint64_t origination)
 {
 	nano::unchecked_info info (block_a, 0, origination, nano::signature_verification::unknown);",Could extract `(blocks.size () + state_blocks.size ())` into a `size ()` method since it's repeated in `full ()`,cpp,1,1,1
"@@ -443,12 +443,13 @@ TEST (store, pruned_load)
 					nano::block_hash random_hash;
 					nano::random_pool::generate_block (random_hash.bytes.data (), random_hash.bytes.size ());
 					store->pruned.put (transaction, random_hash);
+					hashes.insert (random_hash);
 				}
 			}
 			if (!nano::rocksdb_config::using_rocksdb_in_tests ())
 			{
 				auto transaction (store->tx_begin_write ());
-				for (auto k (0); k < batch_size / 2; ++k)
+				for (auto k (0); !hashes.empty () && k < batch_size / 2; ++k)
 				{
 					auto hash (hashes.begin ());
 					store->pruned.del (transaction, *hash);","Do we need the check `!hashes.empty ()`? This is a unit test, if anything is wrong, we want to fail loud and clear rather than handle it quietly. So I would say that we should ASSERT that hashes is not empty.",cpp,1,1,1
"@@ -968,8 +968,8 @@ bool cvdescriptorset::ValidateCopyUpdate(const debug_report_data *report_data, c
     if (dst_layout->IsDestroyed()) {
         *error_code = ""VUID-VkCopyDescriptorSet-dstSet-parameter"";
         string_sprintf(error_msg,
-                       ""Cannot call %s to perform copy update on descriptor set dstSet %s""
-                       "" created with destroyed VkDescriptorSetLayout %s."",
+                       ""Cannot call %s to perform copy update on dstSet %s""
+                       "" created with destroyed %s."",
                        func_name, report_data->FormatHandle(dst_set->GetSet()).c_str(),
                        report_data->FormatHandle(dst_layout->GetDescriptorSetLayout()).c_str());
         return false;",Note that there a couple of places in descriptor_set where FormatHandle isn't being used... `cvdescriptorset::VerifySetLayoutCompatibility` has a couple uses like that. Also output of `buffer` and `imageView` in `ValidateDrawState` These all occur in error_str << message formatting lines. There may be others.,cpp,1,1,1
"@@ -1746,9 +1746,6 @@ MetaClient::regConfig(const std::vector<cpp2::ConfigItem>& items) {
 
 folly::Future<StatusOr<std::vector<cpp2::ConfigItem>>>
 MetaClient::getConfig(const cpp2::ConfigModule& module, const std::string& name) {
-    if (!configReady_) {
-        return Status::Error(""Not ready!"");
-    }
     cpp2::ConfigItem item;
     item.set_module(module);
     item.set_name(name);",How about judge `skipConfig_` instead of just delete it? This is useful,cpp,1,1,1
"@@ -1911,7 +1911,8 @@ ZonePoint* Zone::GetClosestZonePoint(const glm::vec3& location, uint32 to, Clien
 	// this shouldn't open up any exploits since those situations are detected later on
 	if ((zone->HasWaterMap() && !zone->watermap->InZoneLine(glm::vec3(client->GetPosition()))) || (!zone->HasWaterMap() && closest_dist > 400.0f && closest_dist < max_distance2))
 	{
-		//TODO cheat detection
+		if (client)
+			client->CheatDetected(MQZoneUnknownDest, location); // Someone is trying to use /zone
 		LogInfo(""WARNING: Closest zone point for zone id [{}] is [{}], you might need to update your zone_points table if you dont arrive at the right spot"", to, closest_dist);
 		LogInfo(""<Real Zone Points>. [{}]"", to_string(location).c_str());
 	}",Please use brackets here,cpp,1,0,1
"@@ -1637,7 +1637,15 @@ hipError_t ihipMemcpy2D(void* dst, size_t dpitch, const void* src, size_t spitch
                     stream->locked_copySync((unsigned char*)dst + i * dpitch,
                                     (unsigned char*)src + i * spitch, width, kind);
             } else {
-                stream->locked_copy2DSync(dst, src, width, height, spitch, dpitch, kind);
+                int HIP_MEMCPY2D_FORCE_SDMA = 0;
+                ihipReadEnv_I(&HIP_MEMCPY2D_FORCE_SDMA, ""HIP_MEMCPY2D_FORCE_SDMA"", ""HIP_MEMCPY2D_FORCE_SDMA"",
+                            ""Force SDMA for 2D Memcpy"");
+                if(HIP_MEMCPY2D_FORCE_SDMA)
+                    stream->locked_copy2DSync(dst, src, width, height, spitch, dpitch, kind);
+                else {
+                    ihipMemcpy2dKernel<uint8_t> (stream, static_cast<uint8_t*> (dst), static_cast<const uint8_t*> (src), width, height, dpitch, spitch);
+                    stream->locked_wait();
+                }
             }
         } catch (ihipException& ex) {
             e = ex._code;",Why are we reading this env variable in every memcpy2D? Is it a requirement for the user to be able to turn this on or off while the process is still running? We should probably handle it like the rest of the env variables that are read once during init. Also we seem to be changing the default from SDMA enabled to SDMA disabled.,cpp,1,1,1
"@@ -78,7 +78,7 @@ const Outfit* Outfits::getOutfitByLookType(PlayerSex_t sex, uint16_t lookType) c
 
 const Outfit* Outfits::getOutfitByLookType(uint16_t lookType) const
 {
-	for (uint8_t sex = 0; sex <= 1; sex++) {
+	for (uint8_t sex = PLAYERSEX_FEMALE; sex <= PLAYERSEX_LAST; sex++) {
 		for (const Outfit& outfit : outfits[sex]) {
 			if (outfit.lookType == lookType) {
 				return &outfit;","I'd argue that adding `PLAYERSEX_FIRST` enum would be a better choice and would be done as other enums. If you decide to add it, do not forget to register it in lua (along with `PLAYERSEX_LAST` which is missing for some reason  )",cpp,1,1,1
"@@ -18,11 +18,12 @@
 #include <iostream>
 #include <thread>
 
-#include <arpa/inet.h> //AvailableIpAddresses() inet_ntoa
-#include <net/if.h>    //AvailableIpAddresses() struct if_nameindex
-#include <string.h>    //AvailableIpAddresses() strncp
-#include <sys/ioctl.h> //AvailableIpAddresses() ioctl
-#include <unistd.h>    //AvailableIpAddresses() close
+#include <arpa/inet.h>  //AvailableIpAddresses() inet_ntoa
+#include <net/if.h>     //AvailableIpAddresses() struct if_nameindex
+#include <netinet/in.h> //AvailableIpAddresses() struct sockaddr_in
+#include <string.h>     //AvailableIpAddresses() strncp
+#include <sys/ioctl.h>  //AvailableIpAddresses() ioctl
+#include <unistd.h>     //AvailableIpAddresses() close
 
 #include <nlohmann/json.hpp>
 ","I have tried to make it compile on FreeBSD very long time ago, but as far as I remember these socket header files did not exist on BSD systems. Just wondering if there is any tricks I didn't know, or do they actually exist on BSD?",cpp,1,1,1
"@@ -201,13 +201,13 @@ TEST_F(MutateValidatorTest, UpdateEdgeTest) {
     auto cmd = ""UPDATE EDGE ON study \""Tom\""->\""Lily\"" SET count = 1"";
     ASSERT_FALSE(checkResult(cmd, {}));
   }
-  // Wrong expr ""$^.peson.age""
+  // Wrong expr ""$^.person_.age""
   {
     auto cmd =
         ""UPDATE EDGE \""Tom\""->\""Lily\"" OF like ""
         ""SET end = like.end + 1 ""
-        ""WHEN $^.peson.age >= 18 ""
-        ""YIELD $^.peson.age AS age, like.end AS end"";
+        ""WHEN $^.person_.age >= 18 ""
+        ""YIELD $^.person_.age AS age, like.end AS end"";
     ASSERT_FALSE(checkResult(cmd, {}));
   }
   // 1.0 syntax succeed","Happy to drop, but I find it's easier to understand things are typos when they're explicit, and `peson` isn't particularly obvious...",cpp,1,1,1
"@@ -789,6 +789,8 @@ SharedAllocationRecord<Kokkos::CudaHostPinnedSpace, void>
 // Iterate records to print orphaned memory ...
 void SharedAllocationRecord<Kokkos::CudaSpace, void>::print_records(
     std::ostream &s, const Kokkos::CudaSpace &, bool detail) {
+  (void)s;
+  (void)detail;
 #ifdef KOKKOS_DEBUG
   SharedAllocationRecord<void, void> *r = &s_root_record;
 ",from experience we know that this doesn't work on all compilers. but we can try.,cpp,1,1,1
"@@ -40,8 +40,8 @@ TEST_F(OrderByTest, SyntaxError) {
         cpp2::ExecutionResponse resp;
         auto &player = players_[""Boris Diaw""];
         auto *fmt = ""GO FROM %ld OVER serve YIELD ""
-                    ""$^[player].name as name, serve.start_year as start, $$[team].name""
-                    ""| ORDER BY $-.$$[team].name"";
+                    ""$^player.name as name, serve.start_year as start, $$[team].name""
+                    ""| ORDER BY $-.$$team.name"";
         auto query = folly::stringPrintf(fmt, player.vid());
         auto code = client_->execute(query, resp);
         ASSERT_EQ(cpp2::ErrorCode::E_SYNTAX_ERROR, code);",$$[team].name or $$team.name,cpp,1,0,1
"@@ -443,7 +443,11 @@ void KSpace::modify_params(int narg, char **arg)
       nx_pppm = nx_msm_max = force->inumeric(FLERR,arg[iarg+1]);
       ny_pppm = ny_msm_max = force->inumeric(FLERR,arg[iarg+2]);
       nz_pppm = nz_msm_max = force->inumeric(FLERR,arg[iarg+3]);
-      if (nx_pppm == 0 && ny_pppm == 0 && nz_pppm == 0) gridflag = 0;
+      if (nx_pppm == 0 && ny_pppm == 0 && nz_pppm == 0)
+        gridflag = 0;
+      else if (nx_pppm <= 0 || ny_pppm <= 0 || nz_pppm <= 0)
+        error->all(FLERR,""Kspace_modify mesh parameters must be all ""
+                   ""zero or all positive"");
       else gridflag = 1;
       iarg += 4;
     } else if (strcmp(arg[iarg],""mesh/disp"") == 0) {","I don't think we need this check. The default (if no `kspace_modify mesh` is given) is to set the grid automatically, so I don't think a user would go to the trouble of explicitly setting the grid to all zeros using a `kspace_modify` command, just to get the default behavior.",cpp,1,1,1
"@@ -54,7 +54,7 @@ DEFINE_string(part_type, ""simple"", ""simple, consensus..."");
     } while (false)
 
 /**
- * check spaceId is exist and return related partitions
+ * Check spaceId is exist and return related partitions.
  */
 #define CHECK_AND_RETURN_SPACE_ENGINES(spaceId) \
     auto it = kvs_.find(spaceId); \","What about `RETURN_IF_SPACE_NOT_FOUND`? Besides, if `it` would be used immediately, better to specify it in the macro parameter list, explicitly. Otherwise, better to enclose the macro body in a `do while (false)`",cpp,1,1,1
"@@ -53,12 +53,6 @@ int main(int argc, char *argv[]) {
         return EXIT_FAILURE;
     }
 
-    if (FLAGS_daemonize) {
-        google::SetStderrLogging(google::FATAL);
-    } else {
-        google::SetStderrLogging(google::INFO);
-    }
-
     // Setup logging
     auto status = setupLogging();
     if (!status.ok()) {",why remove this,cpp,1,0,1
"@@ -35,15 +35,17 @@ int main(int argc, char *argv[])
         adios2::Variable<float> bpFloats = bpIO.DefineVariable<float>(
             ""bpFloats"", {}, {}, {Nx}, adios2::ConstantDims);
 
+        std::string filename = ""myVector_cpp.bp"";
         /** Engine derived class, spawned to start IO operations */
         adios2::Engine bpWriter =
-            bpIO.Open(""myVector_cpp.bp"", adios2::Mode::Write);
+            bpIO.Open(filename, adios2::Mode::Write);
 
         /** Write variable for buffering */
         bpWriter.Put<float>(bpFloats, myFloats.data());
 
         /** Create bp file, engine becomes unreachable after this*/
         bpWriter.Close();
+        std::cout << ""Wrote file "" << filename << "" to disk. It can now be read by running ./bin/hello_bpReader.\n"";
     }
     catch (std::invalid_argument &e)
     {",Add an extra `catch(std::ios_base::failure &e) { ..// your extra error message }`,cpp,1,1,1
"@@ -95,9 +95,9 @@ services::Status generateShuffledIndicesImpl(const NumericTablePtr & idxTable, c
     const size_t nThreads  = threader_get_threads_number();
     const size_t n         = idxTable->getNumberOfRows();
     const size_t stateSize = rngStateTable->getNumberOfRows();
-    // number of generated uints: 1.5x of n for reserve
-    DAAL_OVERFLOW_CHECK_BY_MULTIPLICATION(size_t, n / 2lu, 3lu);
-    const size_t nRandomUInts = n / 2lu * 3lu;
+    // number of generated uints: 2 x n + 32 for reserve
+    DAAL_OVERFLOW_CHECK_BY_MULTIPLICATION(size_t, n + 16, 2);
+    const size_t nRandomUInts = 2 * n + 32;
 
     daal::internal::WriteColumns<IdxType, cpu> idxBlock(*idxTable, 0, 0, n);
     IdxType * idx = idxBlock.get();","Am I right that in Sklearn approximately the same amount of random number were generated? Do we have understanding how much the performance will change (might be better to save current number of random number for big ""n"" and change for small)?",cpp,1,1,1
"@@ -344,6 +344,16 @@ try:
     cast = image.astype(np.float32)
     assert cast.dtype == np.float32
 
+    # Test .astype for conversion between vector-like pixel types.
+    components = 3
+    numpyImage = np.random.randint(0, 256, (12,8,components)).astype(np.uint8)
+    input_image = itk.image_from_array(numpyImage, is_vector=True)
+    if (type(input_image) == itk.Image[itk.RGBPixel[itk.UC],2] and
+        hasattr(itk.CastImageFilter, 'IRGBUC2IVF32')):
+        output_pixel_type = itk.Vector[itk.F,components]
+        output_image = input_image.astype(output_pixel_type)
+        assert type(output_image) == itk.Image[output_pixel_type, 2]
+
 except ImportError:
     print(""NumPy not imported. Skipping BridgeNumPy tests"")
     # Numpy is not available, do not run the Bridge NumPy tests","Unrelated to this PR, we should remove this exception. We now require `numpy`.",cpp,0,1,1
"@@ -1408,7 +1408,7 @@ void Neighbor::init_topology()
 void Neighbor::print_pairwise_info()
 {
   int i,m;
-  char str[128];
+  char str[256];
   NeighRequest *rq;
   FILE *out;
 ",missing the changes of `sprintf` to `snprintf` in this file.,cpp,0,1,1
"@@ -56,14 +56,9 @@ int main(int argc, char const *argv[]) {
           .set_features_per_node(1)
           .set_min_observations_in_leaf_node(1)
           .set_variable_importance_mode(df::variable_importance_mode::mdi)
-          .set_train_results_to_compute(
-              df::train_result_to_compute::compute_out_of_bag_error)
-          .set_infer_results_to_compute(
-              df::infer_result_to_compute::compute_class_labels |
-              df::infer_result_to_compute::compute_class_probabilities)
           .set_voting_method(df::voting_method::weighted);
 
-  const auto result_train = dal::train(df_desc, x_train_table, y_train_table);
+  const auto result_train = dal::train(df_desc, x_train_table, y_train_table, df::train_result_to_compute::compute_out_of_bag_error);
 
   std::cout << ""Variable importance results:"" << std::endl
             << result_train.get_var_importance() << std::endl;",Seems like line wrapping convention is different for classification and regression examples,cpp,1,1,1
"@@ -332,7 +332,7 @@ TEST_F(UDPv4Tests, send_to_allowed_interface)
 
         if (IsAddressDefined(locator))
         {
-            descriptor.interfaceWhiteList.emplace_back(""127.0.0.1"");
+            // descriptor.interfaceWhiteList.emplace_back(""127.0.0.1"");
             descriptor.interfaceWhiteList.emplace_back(IPLocator::toIPv4string(locator));
             UDPv4Transport transportUnderTest(descriptor);
             transportUnderTest.init();","Can we remove this line, please?",cpp,1,0,1
"@@ -74,7 +74,7 @@ Status ListHostsProcessor::allHostsWithStatus() {
     }
 
     // get hosts which have send heartbeat recently
-    auto activeHosts = ActiveHostsMan::getActiveHosts(kvstore_, FLAGS_heartbeat_interval_secs + 1);
+    auto activeHosts = ActiveHostsMan::getActiveHosts(kvstore_, FLAGS_heartbeat_interval_secs * 2);
     while (iter->valid()) {
         auto host = MetaServiceUtils::parseLeaderKey(iter->key());
         if (std::find(activeHosts.begin(), activeHosts.end(),","Actually I'm not sure why heartbeat_interval_secs * 2 after talk with dooble offline, maybe more safe",cpp,1,1,1
"@@ -23,6 +23,9 @@
 #include <fastdds/rtps/network/NetworkFactory.h>
 #include <rtps/builtin/data/ProxyDataFilters.hpp>
 #include ""../../../fastdds/core/policy/QosPoliciesSerializer.hpp""
+#include ""../../../fastdds/core/policy/ParameterList.hpp""
+
+using ParameterList = eprosima::fastdds::dds::ParameterList;
 
 namespace eprosima {
 namespace fastrtps {",Don't use relative paths. src directory is already on the include search path,cpp,1,1,1
"@@ -708,7 +708,8 @@ void nano::rpc_handler::account_representative_set ()
 			{
 				bool generate_work (work == 0); // Disable work generation if ""work"" option is provided
 				auto response_a (response);
-				wallet->change_async (account, representative, [response_a](std::shared_ptr<nano::block> block) {
+				// clang-format off
+                wallet->change_async (account, representative, [response_a](std::shared_ptr<nano::block> block) {
 					nano::block_hash hash (0);
 					if (block != nullptr)
 					{","Something happened to indentation here it seems, and with clang-format off there're no complaints :D",cpp,1,1,1
"@@ -832,7 +832,6 @@ ParKeyWord ParKeyWords::keyWords_[] = {
   ParKeyWord(""PROTECTION"",         TOK_PROTECTION,  NONRESTOKEN_),  
   ParKeyWord(""PROTOTYPE"",          TOK_PROTOTYPE,   COMPAQ_|RESWORD_),
   ParKeyWord(""PUBLIC"",             TOK_PUBLIC,      ANS_|RESWORD_),
-  ParKeyWord(""PUBLISH"",            TOK_PUBLISH,     NONRESTOKEN_),
   ParKeyWord(""PURGEDATA"",          TOK_PURGEDATA,   NONRESTOKEN_),
   ParKeyWord(""QID"",                TOK_QID,         NONRESTOKEN_),
   ParKeyWord(""QID_INTERNAL"",       TOK_QID_INTERNAL,  NONRESTOKEN_),",sqlci/sqlci_yacc.y defines PUBLISH and UNPUBLISH as token. May want to remove this also.,cpp,1,1,1
"@@ -510,6 +510,12 @@ void PairMESONTTPM::compute(int eflag, int vflag){
 
   // set per atom values and accumulators
   // reallocate per-atom arrays if necessary
+  if (eatom_s == nullptr)
+   memory->create(eatom_s,comm->nthreads*maxeatom,""pair:eatom_s"");
+  if (eatom_b == nullptr)
+   memory->create(eatom_b,comm->nthreads*maxeatom,""pair:eatom_b"");
+  if (eatom_t == nullptr)
+   memory->create(eatom_t,comm->nthreads*maxeatom,""pair:eatom_t"");
   if (atom->nmax > maxeatom) {
     maxeatom = atom->nmax;
     memory->destroy(eatom);","This is likely the wrong fix. It should not be needed, if `maxeatom` is properly initialized.",cpp,1,1,1
"@@ -2971,6 +2971,15 @@ void rai::add_node_options (boost::program_options::options_description & descri
 bool rai::handle_node_options (boost::program_options::variables_map & vm)
 {
 	auto result (false);
+	boost::filesystem::path data_path;
+	if (vm.count (""data_path""))
+	{
+		data_path = boost::filesystem::path (vm [""data_path""].as <std::string> ());
+	}
+	else
+	{
+		data_path = rai::working_path ();
+	}
 	if (vm.count (""account_create""))
 	{
 		if (vm.count (""wallet"") == 1)",This would be better as a ternary IMO.,cpp,1,0,1
"@@ -5,6 +5,16 @@
 
 namespace caffe {
 
+// Function uses casting from int to unsigned to compare if value of
+// parameter a is greater or equal to zero and lower than value of
+// parameter b. The b parameter is of type signed and is always positive,
+// therefore its value is always lower than 0x800... where casting
+// negative value of a parameter converts it to value higher than 0x800...
+// The casting allows to use one condition instead of two.
+inline bool is_a_ge_zero_and_a_lt_b(int a, int b) {
+  return static_cast<unsigned>(a) < static_cast<unsigned>(b);
+}
+
 template <typename Dtype>
 void im2col_cpu(const Dtype* data_im, const int channels,
     const int height, const int width, const int kernel_h, const int kernel_w,",This should be a two-space indent per Google style guide (not sure why lint doesn't catch it).,cpp,1,1,1
"@@ -12769,7 +12769,7 @@ int LuaScriptInterface::luaMonsterTypeGetLoot(lua_State* L)
 		return 1;
 	}
 
-	static const std::function<void(const std::vector<LootBlock>&)> parseLoot = [&](const std::vector<LootBlock>& lootList) {
+	static const std::function<void(const std::vector<LootBlock>&)> parseLoot = [L](const std::vector<LootBlock>& lootList) {
 		lua_createtable(L, lootList.size(), 0);
 
 		int index = 0;","This is not a proper fix. Please move the code in this lambda into a separate function - `void pushLoot(lua_State* L, const std::vector<LootBlock>& loot)`",cpp,1,1,1
"@@ -42,10 +42,13 @@
 
 #include <mutex>
 
+#include ""../../../../fastdds/core/policy/ParameterList.hpp""
+
 using namespace eprosima::fastrtps;
 using namespace eprosima::fastrtps::types;
 using eprosima::fastdds::dds::PublicationMatchedStatus;
 using eprosima::fastdds::dds::SubscriptionMatchedStatus;
+using ParameterList = eprosima::fastdds::dds::ParameterList;
 
 namespace eprosima {
 namespace fastrtps {",Don't use relative paths. src directory is already on the include search path,cpp,1,1,1
"@@ -123,9 +123,17 @@ M  V30 END SGROUP
 M  V30 END CTAB
 M  END''')
     nm = rdAbbreviations.CondenseAbbreviationSubstanceGroups(m)
-    nm.RemoveAllConformers() # avoid coords in CXSMILES
+    nm.RemoveAllConformers()  # avoid coords in CXSMILES
     self.assertEqual(Chem.MolToCXSmiles(nm), '*C1CC1 |$CF3;;;$|')
 
+  def testGithub3692(self):
+    defaults = rdAbbreviations.GetDefaultAbbreviations()
+    self.assertIsNotNone(defaults[0].mol)
+    lbls = [x.label for x in defaults]
+    self.assertIn('CO2Et', lbls)
+    idx = lbls.index('CO2Et')
+    self.assertEqual(Chem.MolToSmiles(defaults[idx].mol), '*C(=O)OCC')
+
 
 if __name__ == '__main__':  # pragma: nocover
   unittest.main()",Is this commit supposed to be in this batch?,cpp,0,0,1
"@@ -242,7 +242,7 @@ void OverallConfig::CheckParamConflict() {
     int full_num_leaves = static_cast<int>(std::pow(2, boosting_config.tree_config.max_depth));
     if (full_num_leaves > boosting_config.tree_config.num_leaves 
         && boosting_config.tree_config.num_leaves == kDefaultNumLeaves) {
-      Log::Warning(""Accuarcy may be bad since you didn't set num_leaves."");
+      Log::Warning(""Accuracy may be bad since you didn't set num_leaves or max_depth² > num_leaves."");
     }
   }
 }",the logic is `and`,cpp,1,0,1
"@@ -53,11 +53,7 @@ static bool add_change_to_rtps_group(
         {
             for (uint32_t frag = 1; frag <= n_fragments; frag++)
             {
-                if (group.add_data_frag(*change, frag, inline_qos))
-                {
-                    reader_change->markFragmentsAsSent(frag);
-                }
-                else
+                if (!group.add_data_frag(*change, frag, inline_qos))
                 {
                     logError(RTPS_WRITER, ""Error sending fragment ("" << change->sequenceNumber << "", "" << frag << "")"");
                 }",Why now is not needed to mark fragment as sent?,cpp,1,0,1
"@@ -236,9 +236,7 @@ void ImageDataLayer<Dtype>::CreatePrefetchThread() {
   phase_ = Caffe::phase();
   const bool prefetch_needs_rand =
       this->layer_param_.image_data_param().shuffle() ||
-          ((phase_ == Caffe::TRAIN) &&
-           (this->layer_param_.image_data_param().mirror() ||
-            this->layer_param_.image_data_param().crop_size()));
+      this->layer_param_.image_data_param().crop_size();
   if (prefetch_needs_rand) {
     const unsigned int prefetch_rng_seed = caffe_rng_rand();
     prefetch_rng_.reset(new Caffe::RNG(prefetch_rng_seed));","Is this change intended? I guess it is fine to initialize a RNG and not use it, but this modification seems unnecessary...",cpp,1,1,1
"@@ -1121,11 +1121,11 @@ bool CoreChecks::ValidateCmdBufDrawState(const CMD_BUFFER_STATE *cb_node, CMD_TY
                                         state.per_set[setIndex].validated_set_binding_req_map.begin(),
                                         state.per_set[setIndex].validated_set_binding_req_map.end(),
                                         std::inserter(delta_reqs, delta_reqs.begin()));
-                    result |= ValidateDrawState(descriptor_set, delta_reqs, state.per_set[setIndex].dynamicOffsets, cb_node,
-                                                attachment_views, function, vuid);
+                    result |= ValidateDrawState(bind_point, descriptor_set, delta_reqs, state.per_set[setIndex].dynamicOffsets,
+                                                cb_node, attachment_views, function, vuid);
                 } else {
-                    result |= ValidateDrawState(descriptor_set, binding_req_map, state.per_set[setIndex].dynamicOffsets, cb_node,
-                                                attachment_views, function, vuid);
+                    result |= ValidateDrawState(bind_point, descriptor_set, binding_req_map, state.per_set[setIndex].dynamicOffsets,
+                                                cb_node, attachment_views, function, vuid);
                 }
             }
         }","EDIT: Hmmm... this is an ordered map lookup typically containing one entry, so while it's not going to be zero cost, compared to the two finds below this point probably not as bad as I was thinking... still it's inside out to do an inner loop lookup of an invariant key. --- I'm willing to bet this is a big part of the performance hit. We're passing in bind_point instead of a `const LAST_BOUND_STATE & ` ... and then in the in most loop, looking up the LAST_BOUND_STATE in the same map, at the same key over and over... if you need the CB's last bound state pass it in ... or look it up *once* at the top of the per descriptor set loop.",cpp,1,1,0
"@@ -257,6 +257,9 @@ bool CombatSpell::loadScriptCombat()
 
 bool CombatSpell::castSpell(Creature* creature)
 {
+	if (!creature) {
+		return false;
+	}
 	if (scripted) {
 		LuaVariant var;
 		var.type = VARIANT_POSITION;","This check is redundant, this function is only ever called from line 316.",cpp,1,1,1
"@@ -105,7 +105,7 @@ int Properties::registerProperty(PropertyFunctor *prop) {
 std::vector<std::string> Properties::getAvailableProperties() {
   registerDescriptors();
   std::vector<std::string> names;
-  BOOST_FOREACH (boost::shared_ptr<PropertyFunctor> prop,
+  for (boost::shared_ptr<PropertyFunctor> prop :
                  Properties::registry) {
     names.push_back(prop->getName());
   }","so _technically_ this is an extra copy of the shared_ptr, which invokes an extra increment/decrement of the reference count. But I think that using the C++11 range-based for loop makes pop out, so I'm a LGTM as is.",cpp,1,1,1
"@@ -357,6 +357,16 @@ class Booster {
     return boosting_->FeatureImportance(num_iteration, importance_type);
   }
 
+  double UpperBoundValue() const {
+    std::lock_guard<std::mutex> lock(mutex_);
+    return boosting_->GetUpperBoundValue();
+  }
+
+  double LowerBoundValue() const {
+    std::lock_guard<std::mutex> lock(mutex_);
+    return boosting_->GetLowerBoundValue();
+  }
+
   double GetLeafValue(int tree_idx, int leaf_idx) const {
     return dynamic_cast<GBDTBase*>(boosting_.get())->GetLeafValue(tree_idx, leaf_idx);
   }",Why mutex is needed here?,cpp,1,0,1
"@@ -1790,6 +1790,11 @@ public:
 					tree.put (""subtype"", ""change"");
 				}
 			}
+			else if (raw && balance == previous_balance && !handler.node.ledger.epoch_link.is_zero () && block_a.hashables.link == handler.node.ledger.epoch_link)
+			{
+				tree.put (""subtype"", ""epoch"");
+				tree.put (""account"", handler.node.ledger.epoch_signer.to_account ());
+			}
 			else
 			{
 				if (raw)","The `raw` condition needs to be in a separate if statement, like with the change condition above, otherwise it'll fall through to the receive code.",cpp,1,1,1
"@@ -700,7 +700,12 @@ BOOL GCObjInSegment(TADDR taddrObj, const GCHeapDetails &heap,
                     ExtOut(""Error requesting heap segment %p\n"", SOS_PTR(taddrSeg));
                     return FALSE;
                 }
-                if (taddrObj >= TO_TADDR(dacpSeg.mem) && taddrObj && taddrObj < TO_TADDR(dacpSeg.allocated))
+                TADDR allocated = TO_TADDR(dacpSeg.allocated);
+                if (taddrSeg == TO_TADDR(heap.ephemeral_heap_segment))
+                {
+                    allocated = TO_TADDR(heap.alloc_allocated);
+                }
+                if (taddrObj >= TO_TADDR(dacpSeg.mem) && taddrObj && taddrObj < allocated)
                 {
                     rngSeg.segAddr = (TADDR)dacpSeg.segmentAddr;
                     rngSeg.start = (TADDR)dacpSeg.mem;",can we change this to `if (taddrObj >= TO_TADDR(dacpSeg.mem) && taddrObj < allocated)` ?,cpp,1,0,1
"@@ -10552,12 +10552,12 @@ bool CoreChecks::ValidateBindImageMemory(VkImage image, VkDeviceMemory mem, VkDe
         uint64_t image_handle = HandleToUint64(image);
         skip = ValidateSetMemBinding(mem, image_handle, kVulkanObjectTypeImage, api_name);
 #ifdef VK_USE_PLATFORM_ANDROID_KHR
-        if (lvl_find_in_chain<VkExternalFormatANDROID>(image_state->createInfo.pNext)) {
+        if (image_state->external_format_android) {
             if (image_state->memory_requirements_checked) {
                 skip |= log_msg(report_data, VK_DEBUG_REPORT_ERROR_BIT_EXT, VK_DEBUG_REPORT_OBJECT_TYPE_IMAGE_EXT, image_handle,
                                 kVUID_Core_DrawState_InvalidImage,
-                                ""%s: Applications must not call vkGetImageMemoryRequirements with such an image %s before it has ""
-                                ""been bound to memory"",
+                                ""%s: Must not call vkGetImageMemoryRequirements on image %s that will be bound to an external ""
+                                ""Android hardware buffer."",
                                 api_name, report_data->FormatHandle(image_handle).c_str());
             }
             return skip;",Please clarify following message: Must not call vkGetImageMemoryRequirements on image %s that will be bound to an external Android hardware buffer,cpp,1,1,1
"@@ -178,10 +178,10 @@ TEST (work, eco_pow)
 	std::future<std::chrono::nanoseconds> future2 = promise2.get_future ();
 
 	std::thread thread1 (work_func, std::ref (promise1), std::chrono::nanoseconds (0));
-	std::thread thread2 (work_func, std::ref (promise2), std::chrono::nanoseconds (100000));
+	std::thread thread2 (work_func, std::ref (promise2), std::chrono::nanoseconds (10000000));
 
 	// Confirm that the eco pow rate limiter is working.
-	// It's possible under some unlucky circumstances that this fails.
+	// It's possible under some unlucky circumstances that this fails to the random nature of valid work generation. 
 	ASSERT_LT (future1.get (), future2.get ());
 
 	thread1.join ();","Maybe `std::chrono::milliseconds (10)` is a bit more readable. Other than that, LGTM and the test now survives 1000 iterations.",cpp,1,1,1
"@@ -46,7 +46,8 @@ bool ResultSchemaProvider::ResultSchemaField::isValid() const {
  *
  **********************************/
 ResultSchemaProvider::ResultSchemaProvider(Schema schema)
-        : columns_(std::move(schema.get_columns())) {
+        : columns_(std::move(schema.get_columns())),
+          schemaProp_(std::move(schema.get_schema_prop())) {
     for (int64_t i = 0; i < static_cast<int64_t>(columns_.size()); i++) {
         const std::string& name = columns_[i].get_name();
         nameIndex_.emplace(std::make_pair(SpookyHashV2::Hash64(name.data(), name.size(), 0), i));","Use NebulaSchemaProvider, ResultSchemaProvider is designed for result.",cpp,1,1,1
"@@ -272,6 +272,15 @@ def test_classifier(output, task, boosting_type, tree_learner, cluster):
         )
         dask_classifier = dask_classifier.fit(dX, dy, sample_weight=dw)
         p1 = dask_classifier.predict(dX)
+        p1_raw = dask_classifier.predict(dX, raw_score=True).compute()
+        p1_first_iter_raw = dask_classifier.predict(dX, start_iteration=0, num_iteration=1, raw_score=True).compute()
+        p1_early_stop_raw = dask_classifier.predict(
+            dX,
+            pred_early_stop=True,
+            pred_early_stop_margin=1.0,
+            pred_early_stop_freq=2,
+            raw_score=True
+        )
         p1_proba = dask_classifier.predict_proba(dX).compute()
         p1_pred_leaf = dask_classifier.predict(dX, pred_leaf=True)
         p1_local = dask_classifier.to_local().predict(X)",Just curious: why does this particular line not ends with `.compute()`?,cpp,1,0,1
"@@ -82,6 +82,8 @@ MSG(object_does_not_provide_read_access_to_columns,
     ""Given object does not provide read access to columns"")
 MSG(object_does_not_provide_write_access_to_columns,
     ""Given object does not provide write access to columns"")
+MSG(object_does_not_provide_access_to_rows_or_columns,
+    ""Given object does not provide access to rows or columns"")
 MSG(unsupported_conversion_types, ""Unsupported conversion types"")
 MSG(row_indices_lt_min_value, ""Row indices are less than the minimum acceptable value"")
 MSG(row_indices_gt_max_value, ""Row indices are larger than the maximum acceptable value"")","Place it in some ""compatibility"" section?",cpp,1,0,1
"@@ -58,6 +58,13 @@ void generic_data_reader::setup() {
   set_initial_position();
 
   shuffle_indices();
+
+  m_thread_buffer.resize(omp_get_max_threads(), std::vector<char>());
+#pragma omp parallel
+  {
+    int tid = omp_get_thread_num();
+    m_thread_buffer[tid].resize(get_linearized_data_size());
+  }
 }
 
 ",It seems simpler to loop through the buffers rather than launching an OpenMP section.,cpp,1,1,1
"@@ -179,6 +179,10 @@ model *build_model_from_prototext(int argc, char **argv,
                                    pb.model());
     model->setup(io_thread_pool);
 
+    if(opts->has_bool(""disable_background_io_activity"") && opts->get_bool(""disable_background_io_activity"")) {
+      model->allow_background_io_activity(false);
+    }
+
     //under development; experimental
     if (opts->has_bool(""use_data_store"") && opts->get_bool(""use_data_store"")) {
       if (master) {","You don't need has_bool(); The code was changed; instead of throwing an exception if the option doesn't exist, 'false' is returned. (other get_XX() methods still throw exceptions, since there's no reasonable default value)",cpp,1,1,1
"@@ -51,14 +51,15 @@ void updateSubMolConfs(const ROMol &mol, RWMol &res,
     res.addConformer(newConf, false);
   }
 }
-}
+}  // namespace
 
 ROMol *deleteSubstructs(const ROMol &mol, const ROMol &query, bool onlyFrags,
                         bool useChirality) {
-  RWMol *res = static_cast<RWMol *>(new ROMol(mol, false));
+  RWMol *res = new RWMol(mol, false);
   std::vector<MatchVectType> fgpMatches;
   std::vector<MatchVectType>::const_iterator mati;
-  VECT_INT_VECT matches;  // all matches on the molecule - list of list of atom ids
+  VECT_INT_VECT
+  matches;  // all matches on the molecule - list of list of atom ids
   MatchVectType::const_iterator mi;
   // do the substructure matching and get the atoms that match the query
   const bool uniquify = true;",This is odd formatting,cpp,1,0,1
"@@ -444,12 +444,11 @@ is passed to :cpp:func:`lammps_commands_string` for processing.
 
 void lammps_commands_list(void *handle, int ncmd, const char **cmds)
 {
-  LAMMPS *lmp = (LAMMPS *) handle;
   std::string allcmds;
 
   for (int i = 0; i < ncmd; i++) {
     allcmds.append(cmds[i]);
-    if (allcmds.back() != '\n') allcmds.append(1,'\n');
+    if (allcmds.empty() || (allcmds.back() != '\n')) allcmds.append(1,'\n');
   }
 
   lammps_commands_string(handle,allcmds.c_str());",@rbberger somehow this bug went unnoticed by the automated unit tests while it created an exception/segmentation fault on my local machine in the PythonCommands test (you must not use `std::string.back()` on an empty string). Was this just by chance or do some tests fall through the grid of the various configurations?,cpp,0,1,1
"@@ -2839,7 +2839,7 @@ SDDkwd__(ISO_MAPPING,           (char *)SQLCHARSETSTRING_ISO88591),
   DD_____(PCODE_DEBUG_LOGDIR,        """"  ), // Pathname of log directory for PCode work
   DDint__(PCODE_EXPR_CACHE_CMP_ONLY, ""0"" ), // PCode Expr Cache compare-only mode
   DDint__(PCODE_EXPR_CACHE_DEBUG,    ""0"" ), // PCode Expr Cache debug (set to 1 to enable dbg logging)
-  DDint__(PCODE_EXPR_CACHE_ENABLED,  ""1"" ), // PCode Expr Cache Enabled (set to 0 to disable the cache)
+  DDint__(PCODE_EXPR_CACHE_ENABLED,  ""0"" ), // PCode Expr Cache Enabled (set to 0 to disable the cache)
   DD0_10485760(PCODE_EXPR_CACHE_SIZE,""2000000""), // PCode Expr Cache Max Size
 
   // Maximum number of PCODE Branch Instructions in an Expr",Is the idea here that there is a memory leak in the PCODE cache that we intend to track down later?,cpp,1,1,1
"@@ -31,6 +31,7 @@ using result_t = compute_result<task::compute>;
 using descriptor_t = detail::descriptor_base<task::compute>;
 
 namespace daal_rbf_kernel = daal::algorithms::kernel_function::rbf;
+namespace daal_kernel_internal = daal::algorithms::kernel_function::internal;
 namespace interop = dal::backend::interop;
 
 template <typename Float, daal::CpuType Cpu>",You need to add implementation for dpcpp interfaces. but throw exception for gpu implementation,cpp,1,1,1
"@@ -217,7 +217,7 @@ void nano::bootstrap_connections::populate_connections (bool repeat)
 			if (auto client = c.lock ())
 			{
 				new_clients.push_back (client);
-				endpoints.insert (client->socket->remote_endpoint ());
+				endpoints.insert (*client->socket->remote_endpoint ());
 				double elapsed_sec = client->elapsed_seconds ();
 				auto blocks_per_sec = client->sample_block_rate ();
 				rate_sum += blocks_per_sec;",Is this guaranteed to have a value? Isn't remote_endpoint the side that can switch to ANYADDR?,cpp,1,1,1
"@@ -9,6 +9,8 @@
 #include <LightGBM/utils/openmp_wrapper.h>
 #include <LightGBM/utils/text_reader.h>
 
+#include <R_ext/Rdynload.h>
+
 #include <string>
 #include <cstdio>
 #include <cstring>","ah ok, thanks! I should have looked at `cpplint` manually in the logs when I did #2911",cpp,0,0,1
"@@ -1445,6 +1445,10 @@ ex_expr::exp_return_type convUnicodeToDatetime(char *target,
    }
 
    ExRaiseSqlError(heap, diagsArea, EXE_CONVERT_DATETIME_ERROR);
+   char hexstr[256];
+   if(*diagsArea)
+     **diagsArea << DgString0(stringToHex(hexstr, sizeof(hexstr) , source, sourceLen ));
+
    return ex_expr::EXPR_ERROR;
 
 }",This 256 should be a constant declared in some common header.,cpp,1,1,1
"@@ -1133,12 +1133,12 @@ bool CoreChecks::ValidateImageDescriptor(const char *caller, const DrawDispatchV
             static_cast<const cvdescriptorset::ImageSamplerDescriptor &>(image_descriptor).GetSamplerState());
     } else {
         if (binding_info.second.samplers_used_by_image.size() > index) {
-            for (auto &sampler : binding_info.second.samplers_used_by_image[index]) {
+            for (const auto &desc_index : binding_info.second.samplers_used_by_image[index]) {
+                const auto *desc = descriptor_set->GetDescriptorFromBinding(desc_index.sampler_slot.binding, desc_index.sampler_index);
                 // NOTE: This check _shouldn't_ be necessary due to the checks made in IsSpecificDescriptorType in
                 //       shader_validation.cpp. However, without this check some traces still crash.
-                if (sampler.second && (sampler.second->GetClass() == cvdescriptorset::DescriptorClass::PlainSampler)) {
-                    const auto *sampler_state =
-                        static_cast<const cvdescriptorset::SamplerDescriptor *>(sampler.second)->GetSamplerState();
+                if (desc && (desc->GetClass() == cvdescriptorset::DescriptorClass::PlainSampler)) {
+                    const auto *sampler_state = static_cast<const cvdescriptorset::SamplerDescriptor *>(desc)->GetSamplerState();
                     if (sampler_state) sampler_states.emplace_back(sampler_state);
                 }
             }","IIRC, it was never really understood why the `desc->GetClass() == cvdescriptorset::DescriptorClass::PlainSampler` check was necessary. On the one hand I wonder if this change allows this check to be removed. On the other hand, it's probably not worth the effort to find out as there's nothing incorrect about it.",cpp,1,1,1
"@@ -1376,8 +1376,6 @@ void DataReaderImpl::release_payload_pool()
 
     PoolConfig config = PoolConfig::from_history_attributes(history_.m_att);
     payload_pool_->release_history(config, true);
-
-    TopicPayloadPoolRegistry::release(payload_pool_);
 }
 
 ReturnCode_t DataReaderImpl::check_datasharing_compatible(",Shouldn't we do `payload_pool_.reset()` here ?,cpp,1,0,1
"@@ -0,0 +1,2 @@
+#include <cstdio>
+void print_cxx() { printf(""Hello From C++\n""); }",Should this file have the copyright too?,cpp,1,1,1
"@@ -19,10 +19,10 @@ import numpy as np
 import pandas as pd
 from scipy.stats import spearmanr
 from dask.array.utils import assert_eq
+from dask.distributed import wait
 from distributed.utils_test import client, cluster_fixture, gen_cluster, loop
 from scipy.sparse import csr_matrix
 from sklearn.datasets import make_blobs, make_regression
-from sklearn.utils import check_random_state
 
 from .utils import make_ranking
 ",oh thanks for removing this. Didn't realize it was unused.,cpp,1,1,1
"@@ -925,7 +925,6 @@ RelExpr *RelSample::bindNode(BindWA *bindWA)
   RelExpr* myChild = child(0);
   if (myChild->getOperatorType() == REL_SCAN &&
       (static_cast<Scan*>(myChild))->isHbaseTable() &&
-      myChild->selectionPred().entries() == 0 &&
       isSimpleRandomRelative() &&
       trafSampleRate <= 1.0f)
     {","I would have assumed that we still need this check for a query with a sample clause and a predicate ? Not for update stats, but for some other SELECT statement with SAMPLE. Simple predicates can be pushed down only for regular format rows, for aligned format rows predicate evaluation will be in Trafodion.",cpp,1,1,1
"@@ -139,7 +139,12 @@ CmpContext::CmpContext(UInt32 f, CollHeap * h)
   optPCodeCache_(NULL),                       // just to be safe ...
   CDBList_(NULL),
   allControlCount_(0),
-  optSimulator_(NULL)
+  optSimulator_(NULL),
+  hosts_(h),
+  invocationInfos_(h),
+  planInfos_(h),
+  routineHandles_(h),
+  ddlObjs_(h)
 {
   SetMode(isDynamicSQL() ? STMT_DYNAMIC : STMT_STATIC);
 ","My bad, sorry for adding these leaks.",cpp,0,0,1
"@@ -120,13 +120,12 @@ void InitLogs() {
   rdWarningLog = std::make_shared<boost::logging::rdLogger>(&std::cerr);
   rdErrorLog = std::make_shared<boost::logging::rdLogger>(&std::cerr);
 }
+
 std::ostream &toStream(std::ostream &logstrm) {
+  char buffer[16];
   time_t t = time(nullptr);
-  tm details = *localtime(&t);
-  logstrm << ""["" << std::setw(2) << std::setfill('0') << details.tm_hour << "":""
-          << std::setw(2) << std::setfill('0') << details.tm_min << "":""
-          << std::setw(2) << std::setfill('0') << int(details.tm_sec) << ""] "";
-  return logstrm;
+  strftime(buffer, 16, ""[%T] "", localtime(&t));
+  return logstrm << buffer;
 }
 }  // namespace RDLog
 ","This gives significantly cleaner output in multithreaded situations. It's not perfect, but it's much better.",cpp,1,1,1
"@@ -87,6 +87,8 @@ namespace thread_role
 			case nano::thread_role::name::wallet_actions:
 				thread_role_name_string = ""Wallet actions"";
 				break;
+			case nano::thread_role::name::wallet_work_regen:
+				thread_role_name_string = ""Wallet work regen"";
 			case nano::thread_role::name::bootstrap_initiator:
 				thread_role_name_string = ""Bootstrap init"";
 				break;",This will assert on debug builds as we check that the length is < 16 below.,cpp,1,1,1
"@@ -54,11 +54,11 @@ unsigned int RGroupDecompositionParameters::autoGetLabels(const RWMol &core) {
 
 bool rgdAtomCompare(const MCSAtomCompareParameters &p, const ROMol &mol1,
                     unsigned int atom1, const ROMol &mol2, unsigned int atom2,
-                    void *userData) {
-  if (!MCSAtomCompareElements(p, mol1, atom1, mol2, atom2, nullptr)) {
+                    MCSCompareFunctionsData& cfd) {
+  if (!MCSAtomCompareElements(p, mol1, atom1, mol2, atom2, cfd)) {
     return false;
   }
-  unsigned int autoLabels = *reinterpret_cast<unsigned int *>(userData);
+  unsigned int autoLabels = *reinterpret_cast<unsigned int *>(cfd.userData);
   bool atom1HasLabel = false;
   bool atom2HasLabel = false;
   const auto a1 = mol1.getAtomWithIdx(atom1);","with the new structure for MCSCompareFunctionsData, the MCSAtomCompareElements functor can pass around dynamic data and custom functors can call it without a problem",cpp,1,1,1
"@@ -41,13 +41,13 @@ void Connection::handle_read(const boost::system::error_code &error, std::size_t
 
     // no error detected, let's parse the request
     http::compression_type compression_type(http::no_compression);
-    util::tribool result;
+    RequestStatus result;
     std::tie(result, compression_type) =
         request_parser.parse(current_request, incoming_data_buffer.data(),
                              incoming_data_buffer.data() + bytes_transferred);
 
     // the request has been parsed
-    if (result == util::tribool::yes)
+    if (result == RequestStatus::yes)
     {
         current_request.endpoint = TCP_socket.remote_endpoint().address();
         request_handler.handle_request(current_request, current_reply);",This needs to be `RequestParser::RequestStatus`. Remember this is a nested type and we are outside of `RequestParser`.,cpp,1,1,1
"@@ -40,6 +40,10 @@
 
 #include <fastdds/dds/log/Log.hpp>
 
+#include ""../../../../fastdds/core/policy/ParameterList.hpp""
+
+using ParameterList = eprosima::fastdds::dds::ParameterList;
+
 // Release reader lock to avoid ABBA lock. PDP mutex should always be first.
 // Keep change information on local variables to check consistency later
 #define PREVENT_PDP_DEADLOCK(reader, change, pdp)                         \",Don't use relative paths. src directory is already on the include search path,cpp,1,1,1
"@@ -160,6 +160,19 @@ uint32_t IOLoginData::gameworldAuthentication(const std::string& accountName, co
 	return accountId;
 }
 
+uint32_t IOLoginData::getAccountIdByPlayerName(const std::string& playerName)
+{
+	Database* db = Database::getInstance();
+
+	std::ostringstream query;
+	query << ""SELECT `account_id` FROM `players` WHERE `name` = "" << db->escapeString(playerName);
+	DBResult_ptr result = db->storeQuery(query.str());
+	if (!result) {
+		return 0;
+	}
+	return result->getNumber<uint32_t>(""account_id"");
+}
+
 AccountType_t IOLoginData::getAccountType(uint32_t accountId)
 {
 	std::ostringstream query;","`bool House::isInvited(const Player* player)` is checked frequently, maybe needs a cache on Game class to improve performance.",cpp,1,1,1
"@@ -86,8 +86,7 @@ bool isValidMatch(const TurnLaneType::Mask tag, const TurnInstruction instructio
                (instruction.type ==
                     TurnType::Continue && // Forks can be experienced, even for straight segments
                 (instruction.direction_modifier == DirectionModifier::SlightLeft ||
-                 instruction.direction_modifier == DirectionModifier::SlightRight)) ||
-               instruction.type == TurnType::Suppressed;
+                 instruction.direction_modifier == DirectionModifier::SlightRight));
     }
     else if (tag == TurnLaneType::slight_left || tag == TurnLaneType::left ||
              tag == TurnLaneType::sharp_left)",we should refactor this ten line return statement ..,cpp,0,0,1
"@@ -36,6 +36,7 @@ ReaderLocator::ReaderLocator(
     : owner_(owner)
     , locator_info_(max_unicast_locators, max_multicast_locators)
     , expects_inline_qos_(false)
+    , is_local_reader_(false)
     , guid_prefix_as_vector_(1u)
     , guid_as_vector_(1u)
 {",Field `local_reader_` should be initialized to `nullptr`,cpp,1,0,1
"@@ -199,6 +199,18 @@ int main(int argc, const char **argv) {
 #if defined(HIPIFY_CLANG_RES)
     Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(""-resource-dir="" HIPIFY_CLANG_RES));
 #endif
+    if (!MacroNames.empty()) {
+      for (std::string s : MacroNames) {
+        Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(""-D"", ct::ArgumentInsertPosition::END));
+        Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(s.c_str(), ct::ArgumentInsertPosition::END));
+      }
+    }
+    if (!IncludeDirs.empty()) {
+      for (std::string s : IncludeDirs) {
+        Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(""-I"", ct::ArgumentInsertPosition::END));
+        Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(s.c_str(), ct::ArgumentInsertPosition::END));
+      }
+    }
     Tool.appendArgumentsAdjuster(ct::getClangSyntaxOnlyAdjuster());
     Statistics& currentStat = Statistics::current();
     // Hipify _all_ the things!","possible this and second checks are redundant otherwise, lgtm",cpp,1,1,1
"@@ -61,6 +61,9 @@ void ThroughputPublisher::DataPubListener::onPublicationMatched(
     if (info.status == MATCHED_MATCHING)
     {
         ++throughput_publisher_.data_discovery_count_;
+        std::cout << C_RED << ""Pub: DATA Pub Matched ""
+                  << throughput_publisher_.data_discovery_count_ << ""/"" << throughput_publisher_.subscribers_
+                  << C_DEF << std::endl;
     }
     else
     {","Should this be done before unlocking, as it is done below?",cpp,0,1,1
"@@ -57,8 +57,10 @@ ResultCode RocksEngine::get(const std::string& key, std::string* value) {
     if (status.ok()) {
         return ResultCode::SUCCEEDED;
     } else if (status.IsNotFound()) {
+        LOG(ERROR) << ""Get: "" << key << "" Not Found"";
         return ResultCode::ERR_KEY_NOT_FOUND;
     }
+    LOG(ERROR) << ""Failed Get: "" << key << "" "" << status.ToString();
     return ResultCode::ERR_UNKNOWN;
 }
 ","Better to put this line in the `else`, otherwise, one `get` will incur two duplicated log.",cpp,1,1,1
"@@ -350,7 +350,7 @@ if __name__ == ""__main__"":
               ],
           },
           maintainer='Guolin Ke',
-          maintainer_email='guolin.ke@microsoft.com',
+          maintainer_email='guolin.ke@outlook.com',
           zip_safe=False,
           cmdclass={
               'install': CustomInstall,",Ah thanks for catching this! Sorry I didn't think of it on #4633. Thankfully it's not as critical with PyPI as it is with CRAN. @shiyu1994 should this be changed to your name and email? My assumption is that Microsoft would prefer to have a Microsoft employee as the primary contact for these artifacts.,cpp,0,0,1
"@@ -121,7 +121,8 @@ TEST (node, send_single_observing_peer)
         }
 }
 
-TEST (node, send_single_many_peers)
+// TODO: rai::system fails to connect peers
+TEST (node, DISABLED_send_single_many_peers)
 {
         rai::system system (24000, 10);
         rai::keypair key2;",Due to the `max_peers_per_ip` reduction it seems,cpp,1,0,1
"@@ -525,7 +525,7 @@ void PDPServer2::announceParticipantState(
                 // Update the database with our own data
                 if (discovery_db().update(
                             change,
-                            ddb::DiscoveryParticipantChangeData(metatraffic_locators, false, false, false)))
+                            ddb::DiscoveryParticipantChangeData(metatraffic_locators, false, false)))
                 {
                     // Distribute
                     awake_routine_thread();","This will make our server apear as remote in the DDB. Should not affect anything I believe, but it's still weird IMHO",cpp,1,1,1
"@@ -281,7 +281,10 @@ bool nano::election::transition_time (nano::confirmation_solicitor & solicitor_a
 		result = true;
 		state_change (state_m.load (), nano::election::state_t::expired_unconfirmed);
 		status.type = nano::election_status_type::stopped;
-		log_votes (tally ());
+		if (node.config.logging.election_expiration_tally_logging ())
+		{
+			log_votes (tally (), ""Election expired"");
+		}
 	}
 	return result;
 }","This should probably be ""Election expired: "" otherwise it smashes in to ""Vote tally...""",cpp,1,1,1
"@@ -244,14 +244,14 @@ bool RowReader::processHeader(folly::StringPiece row) {
     }
     offsets_.resize(numFields + 1, -1);
     offsets_[0] = 0;
-    blockOffsets_.push_back(std::make_pair(0, 0));
+    blockOffsets_.emplace_back(std::make_pair(0, 0));
     blockOffsets_.reserve(numOffsets);
     for (uint32_t i = 0; i < numOffsets; i++) {
         int64_t offset = 0;
         for (int32_t j = 0; j < numBytesForOffset_; j++) {
             offset |= (uint64_t(*(it++)) << (8 * j));
         }
-        blockOffsets_.push_back(std::make_pair(offset, 0));
+        blockOffsets_.emplace_back(std::make_pair(offset, 0));
         offsets_[16 * (i + 1)] = offset;
     }
     // Now done with the header",You should have known that `std::make_pair` is not necessary here if `emplace_back` used.,cpp,1,1,1
"@@ -9,6 +9,7 @@
 
 DEFINE_int32(default_parts_num, 100, ""The default number of parts when a space is created"");
 DEFINE_int32(default_replica_factor, 1, ""The default replica factor when a space is created"");
+DEFINE_int32(default_max_parts_num, 100, ""The default max partitions number"");
 
 namespace nebula {
 namespace meta {","I think you can set default to max, and give it a proper value in configuration when deploy.",cpp,1,1,1
"@@ -19,6 +19,10 @@
 #include ""internal/conversion.h""
 #include ""service_memory.h""
 
+#if defined(__INTEL_COMPILER)
+    #include <immintrin.h>
+#endif
+
 namespace daal
 {
 namespace data_management",Add const where necessary,cpp,1,0,1
"@@ -428,6 +428,12 @@ void encodeVectorTile(const datafacade::ContiguousInternalMemoryDataFacadeBase &
                 const auto &edge = edges[edge_index];
                 const auto geometry_id = get_geometry_id(edge);
 
+                // Get coordinates for start/end nodes of segment (NodeIDs u and v)
+                const auto a = facade.GetCoordinateOfNode(edge.u);
+                const auto b = facade.GetCoordinateOfNode(edge.v);
+                // Calculate the length in meters
+                const double length = osrm::util::coordinate_calculation::haversineDistance(a, b);
+
                 // Weight values
                 const auto forward_weight_vector =
                     facade.GetUncompressedForwardWeights(geometry_id);","when trying to refactor this I thought about this line a bit. It adds some overhead for calculating the distances. Whats is you opinion here @danpat on the potential slowdown? I feel it might be alright, but I am not entirely sure. (This length calculation is already happening further down as well)",cpp,0,0,1
"@@ -33,14 +33,14 @@ static PJ_XY fouc_s_s_forward (PJ_LP lp, PJ *P) {           /* Spheroidal, forwa
 static PJ_LP fouc_s_s_inverse (PJ_XY xy, PJ *P) {           /* Spheroidal, inverse */
     PJ_LP lp = {0.0,0.0};
     struct pj_opaque *Q = static_cast<struct pj_opaque*>(P->opaque);
-    double V;
     int i;
 
     if (Q->n != 0.0) {
         lp.phi = xy.y;
         for (i = MAX_ITER; i ; --i) {
-            lp.phi -= V = (Q->n * lp.phi + Q->n1 * sin(lp.phi) - xy.y ) /
-                (Q->n + Q->n1 * cos(lp.phi));
+            const double V = (Q->n * lp.phi + Q->n1 * sin(lp.phi) - xy.y ) /
+                             (Q->n + Q->n1 * cos(lp.phi));
+            lp.phi -= V;
             if (fabs(V) < LOOP_TOL)
                 break;
         }","Curious question: in cases like this, would a new address for `V` need to be created each iteration within this for-loop? Are there advantages of declaring the scope of the variable as `const double V` within the for-loop rather than with `double V` outside the for-loop?",cpp,1,1,1
"@@ -183,6 +183,9 @@ double Bond::getBondTypeAsDouble() const {
 }
 
 double Bond::getValenceContrib(const Atom *atom) const {
+  if (atom != getBeginAtom() && atom != getEndAtom()) {
+    return 0.0;
+  }
   double res;
   if ((getBondType() == DATIVE || getBondType() == DATIVEONE) &&
       atom->getIdx() != getEndAtomIdx()) {",Should this be a warning? i.e. atom not in bond?,cpp,1,1,1
"@@ -125,11 +125,13 @@ TEST_F(IndexTest, TagIndex) {
         std::string query = ""SHOW TAG INDEX STATUS"";
         auto code = client->execute(query, resp);
         ASSERT_EQ(cpp2::ErrorCode::SUCCEEDED, code);
-        std::vector<uniform_tuple_t<std::string, 2>> expected{
-            {""single_person_index"", ""SUCCEEDED""},
-            {""multi_person_index"",  ""SUCCEEDED""},
-        };
-        ASSERT_TRUE(verifyResult(resp, expected));
+        /*
+         * Currently , expected the index status is ""RUNNING"" or ""SUCCEEDED""
+         */
+        for (auto& row : *resp.get_rows()) {
+            const auto &columns = row.get_columns();
+            ASSERT_NE(""FAILED"", columns[1].get_str());
+        }
     }
     {
         cpp2::ExecutionResponse resp;",I think you can try 3 time checking.,cpp,1,0,1
"@@ -132,7 +132,7 @@ util::Coordinate CoordinateExtractor::ExtractRepresentativeCoordinate(
     {
         const auto result = ExtractCoordinateAtLength(
             skipping_inaccuracies_distance, coordinates);
-        BOOST_ASSERT(is_valid_result(coordinates.back()));
+        BOOST_ASSERT(is_valid_result(result));
         return result;
     }
 ",This asserts the result is neither the to nor the intersection node? The assertion before therefore could trigger at any time? Should this be backported to 5.5?,cpp,1,1,1
"@@ -67,7 +67,17 @@ Status TablePlugin::HandleRequest(const datafacade::ContiguousInternalMemoryData
         return Error(""TooBig"", ""Too many table coordinates"", result);
     }
 
-    auto snapped_phantoms = SnapPhantomNodes(GetPhantomNodes(facade, params));
+    auto phantom_nodes = GetPhantomNodes(facade, params);
+
+    if (phantom_nodes.size() != params.coordinates.size())
+    {
+        return Error(""NoSegment"",
+                     std::string(""Could not find a matching segment for coordinate "") +
+                         std::to_string(phantom_nodes.size()),
+                     result);
+    }
+
+    auto snapped_phantoms = SnapPhantomNodes(phantom_nodes);
     auto result_table =
         algorithms.ManyToManySearch(snapped_phantoms, params.sources, params.destinations);
 ","You can use the size of `params.coordinate` to sprint a more helpful error message (e.g. ""Could not find a matching segment for the i-th coordinate"").",cpp,1,1,1
"@@ -11115,6 +11115,17 @@ bool CoreChecks::ValidateCreateSwapchain(const char *func_name, VkSwapchainCreat
     }
 
     auto physical_device_state = GetPhysicalDeviceState();
+    bool skip = false;
+    VkSurfaceTransformFlagBitsKHR currentTransform = physical_device_state->surfaceCapabilities.currentTransform;
+    if ((pCreateInfo->preTransform & currentTransform) != pCreateInfo->preTransform) {
+        skip |= log_msg(report_data, VK_DEBUG_REPORT_PERFORMANCE_WARNING_BIT_EXT, VK_DEBUG_REPORT_OBJECT_TYPE_PHYSICAL_DEVICE_EXT,
+                        HandleToUint64(physical_device), kVUID_Core_Swapchain_PreTransform,
+                        ""%s: pCreateInfo->preTransform (0x%"" PRIx32 "") doesn't match the currentTransform (0x%"" PRIx32
+                        "") returned by vkGetPhysicalDeviceSurfaceCapabilitiesKHR, the presentation engine will transform the image ""
+                        ""content as part of the presentation operation."",
+                        func_name, pCreateInfo->preTransform, currentTransform);
+    }
+
     if (physical_device_state->vkGetPhysicalDeviceSurfaceCapabilitiesKHRState == UNCALLED) {
         if (log_msg(report_data, VK_DEBUG_REPORT_WARNING_BIT_EXT, VK_DEBUG_REPORT_OBJECT_TYPE_PHYSICAL_DEVICE_EXT,
                     HandleToUint64(physical_device), kVUID_Core_DrawState_SwapchainCreateBeforeQuery,",Please use string_VkSurfaceTransformFlagBitsKHR() to convert transform bits to string.,cpp,1,1,1
"@@ -109,6 +109,7 @@ int main(int argc, char *argv[]) {
                                                                       paths);
     if (!gStorageServer->start()) {
         LOG(ERROR) << ""Storage server start failed"";
+        gStorageServer->stop();
         return EXIT_FAILURE;
     }
 ",Well done. I want to know why the daemon crash?,cpp,0,0,1
"@@ -4,7 +4,6 @@
  *  (found in the LICENSE.Apache file in the root directory)
  */
 
-#include ""base/Base.h""
 #include <gtest/gtest.h>
 #include <folly/String.h>
 #include <fstream>",Why did you remove this?,cpp,1,0,1
"@@ -89,6 +89,7 @@ TDTMolSupplier::TDTMolSupplier(const std::string &fileName,
   if (!tmpStream || (!(*tmpStream)) || (tmpStream->bad())) {
     std::ostringstream errout;
     errout << ""Bad input file "" << fileName;
+    if (tmpStream) { delete tmpStream; }
     throw BadFileException(errout.str());
   }
 ",the `if` isn't necessary,cpp,1,0,1
"@@ -43,7 +43,17 @@ services::Status Parameter::check() const
     return services::Status();
 }
 }
+namespace interface2
+{
+Parameter::Parameter(size_t nClasses) : nClasses(nClasses), resultsToEvaluate(computeClassLabels) {}
 
+services::Status Parameter::check() const
+{
+    DAAL_CHECK_EX(nClasses > 0, services::ErrorIncorrectParameter, services::ParameterName, nClassesStr());
+    DAAL_CHECK_EX(resultsToEvaluate != 0, services::ErrorIncorrectParameter, services::ParameterName, resultsToEvaluateStr())
+    return services::Status();
+}
+}
 namespace training
 {
 namespace interface1",On row 106 in current file we always cast to interface2::Parammeter class. That`s wrong. Branching should be added.,cpp,1,1,1
"@@ -204,6 +204,14 @@ void Tree::AddPredictionToScore(const Dataset* data,
   }
 }
 
+void Tree::AddMaxValueToScore(double& score) const {
+    score += *std::max_element(leaf_value_.begin(), leaf_value_.end());
+}
+
+void Tree::AddMinValueToScore(double& score) const {
+    score += *std::min_element(leaf_value_.begin(), leaf_value_.end());
+}
+
 #undef PredictionFun
 
 std::string Tree::ToString() const {","why not just return the max/min values, and add outside?",cpp,1,1,1
"@@ -13,7 +13,10 @@ template <typename Dtype>
 void CuDNNPoolingLayer<Dtype>::LayerSetUp(const vector<Blob<Dtype>*>& bottom,
     const vector<Blob<Dtype>*>& top) {
   PoolingLayer<Dtype>::LayerSetUp(bottom, top);
-
+  // Sanity check: CUDNN currently only supports pad=0 and top.size()=1 cases.
+  CHECK_EQ(pad_h_, 0);
+  CHECK_EQ(pad_w_, 0);
+  CHECK_EQ(top.size(), 1);
   CUDNN_CHECK(cudnnCreate(&handle_));
   cudnn::createTensor4dDesc<Dtype>(&bottom_desc_);
   cudnn::createTensor4dDesc<Dtype>(&top_desc_);","This does not compile for me, This does: CHECK_EQ(this->pad_h_, 0);",cpp,1,1,1
"@@ -478,7 +478,7 @@ void ExtractorCallbacks::ProcessWay(const osmium::Way &input_way, const Extracti
                    });
 
     external_memory.way_start_end_id_list.push_back(
-        {OSMWayID{static_cast<std::uint32_t>(input_way.id())},
+        {OSMWayID{static_cast<std::uint64_t>(input_way.id())},
          OSMNodeID{static_cast<std::uint64_t>(nodes[0].ref())},
          OSMNodeID{static_cast<std::uint64_t>(nodes[1].ref())},
          OSMNodeID{static_cast<std::uint64_t>(nodes[nodes.size() - 2].ref())},",here this must be uint64_t #5380,cpp,1,0,1
"@@ -280,15 +280,15 @@ dataframe_builder& dataframe_builder::fill_uniform(double a, double b, std::int6
 
 dataframe dataframe_builder::build() const {
     const auto& program = impl_->get_program();
-    const auto [df, hit] = get_dataframe_builder_cache().lookup(program);
+    const auto df_hit = get_dataframe_builder_cache().lookup(program);
 #ifdef ONEDAL_DEBUG_DATAFRAMES_CACHE
-    const std::string hit_or_miss = hit ? ""hit"" : ""miss"";
+    const std::string hit_or_miss = std::get<1>(df_hit) ? ""hit"" : ""miss"";
     fmt::print(""{}\t{}\t{:.2f}Mb\n"",
                hit_or_miss,
                program.get_code(),
                get_dataframe_builder_cache().get_occupied_size_mb());
 #endif
-    return df;
+    return std::get<0>(df_hit);
 }
 
 template <typename Float>","GCC 7.4 complains that `hit` variable is unused, but GCC 9.x is ok",cpp,1,1,1
"@@ -7,10 +7,16 @@
 #include ""base/Base.h""
 #include <gtest/gtest.h>
 #include ""graph/test/TestEnv.h""
+#include ""fs/TempDir.h""
+#include ""meta/test/TestUtils.h""
+
+DECLARE_string(meta_server_addrs);
 
 using nebula::graph::TestEnv;
 using nebula::graph::gEnv;
 DECLARE_string(meta_server_addrs);
+using nebula::meta::TestUtils;
+using nebula::fs::TempDir;
 
 int main(int argc, char **argv) {
     ::testing::InitGoogleTest(&argc, argv);",Please group simillar statements together.,cpp,1,1,1
"@@ -99,9 +99,12 @@ void Client::Handle_OP_ZoneChange(const EQApplicationPacket *app) {
 				//unable to find a zone point... is there anything else
 				//that can be a valid un-zolicited zone request?
 
-				//Todo cheat detection
 				Message(Chat::Red, ""Invalid unsolicited zone request."");
 				LogError(""Zoning [{}]: Invalid unsolicited zone request to zone id [{}]"", GetName(), target_zone_id);
+				if (GetBindZoneID() == target_zone_id)
+					CheatDetected(MQGate, glm::vec3(zc->x, zc->y, zc->z));
+				else
+					CheatDetected(MQZone, glm::vec3(zc->x, zc->y, zc->z));
 				SendZoneCancel(zc);
 				return;
 			}",Please use brackets here,cpp,1,1,1
"@@ -168,7 +168,7 @@ void testRingMatching3Score() {
   // expect test1 to have better score than test2 since all halogens are on R1
   // but this is not the case
 
-  TEST_ASSERT(test1 < test2); // Fix Me!
+  TEST_ASSERT(test1 > test2); 
 
   // But it is for the fingerprint score
 ",Now it's fixed we can remove this line,cpp,1,1,1
"@@ -47,8 +47,17 @@ short CmpSeabaseDDL::createRepos(ExeCliInterface * cliInterface)
 
   NABoolean xnWasStartedHere = FALSE;
 
+  cliRC = cliInterface->holdAndSetCQD
+    (""TRAF_MAX_CHARACTER_COL_LENGTH"", ""1000000"");
+
+  if (cliRC < 0)
+    {
+      cliInterface->retrieveSQLDiagnostics(CmpCommon::diags());
+      return -1;
+    }
+
   if (beginXnIfNotInProgress(cliInterface, xnWasStartedHere))
-    return -1;
+    goto label_error;
 
   // Create the _REPOS_ schema
   str_sprintf(queryBuf, ""create schema %s.\""%s\"" ; "",",Why was 1000000 chosen?,cpp,1,0,1
"@@ -308,8 +308,12 @@ std::string PrimaryExpression::toString() const {
         case VAR_INT64:
             snprintf(buf, sizeof(buf), ""%ld"", boost::get<int64_t>(operand_));
             break;
-        case VAR_DOUBLE:
-            return std::to_string(boost::get<double>(operand_));
+        case VAR_DOUBLE: {
+            int digits10 = std::numeric_limits<double>::digits10;
+            const char *fmt = folly::sformat(""%.{}lf"", digits10).c_str();
+            snprintf(buf, sizeof(buf), fmt, boost::get<double>(operand_));
+            break;
+        }
         case VAR_BOOL:
             snprintf(buf, sizeof(buf), ""%s"", boost::get<bool>(operand_) ? ""true"" : ""false"");
             break;",`fmt` will be a dangling pointer here.,cpp,1,1,1
"@@ -621,6 +621,19 @@ services::ErrorCollectionPtr Status::getCollection() const
     return services::ErrorCollectionPtr(new services::ErrorCollection());
 }
 
+namespace internal
+{
+ErrorID get_error_id(const Status & s)
+{
+    if (s._impl)
+    {
+        return static_cast<SharedErrorCollection *>(s._impl)->at(0)->id();
+    }
+    return ErrorID::UnknownError;
+}
+
+} // namespace internal
+
 /////////////////////////////////////////////////////////////////////////////////////////
 
 void ErrorMessageCollection::parseResourceFile()","For consistency, it is better to move this function to ""status_to_error_id.cpp"", but this is not critical",cpp,1,1,1
"@@ -580,12 +580,15 @@ void DataWriterImpl::InnerDataWriterListener::on_liveliness_lost(
         fastrtps::rtps::RTPSWriter* /*writer*/,
         const fastrtps::LivelinessLostStatus& status)
 {
+    fastdds::dds::LivelinessLostStatus dds_status;
+    dds_status.total_count = status.total_count;
+    dds_status.total_count_change = status.total_count_change;
     if (data_writer_->listener_ != nullptr)
     {
-        data_writer_->listener_->on_liveliness_lost(data_writer_->user_datawriter_, status);
+        data_writer_->listener_->on_liveliness_lost(data_writer_->user_datawriter_, dds_status);
     }
 
-    data_writer_->publisher_->publisher_listener_.on_liveliness_lost(data_writer_->user_datawriter_, status);
+    data_writer_->publisher_->publisher_listener_.on_liveliness_lost(data_writer_->user_datawriter_, dds_status);
 }
 
 bool DataWriterImpl::wait_for_acknowledgments(","`fastrtps::LivelinessLostStatus` should be another alias for `fasdds::dds::LivelinessLostStatus`, and thus, we can avoid the copy and code duplication.",cpp,1,1,1
"@@ -1184,13 +1184,8 @@ static swift::ASTContext *SetupASTContext(
   if (disable_objc_runtime())
     swift_ast_context->GetLanguageOptions().EnableObjCInterop = false;
 
-  if (repl || playground) {
-    swift_ast_context->GetLanguageOptions().Playground = true;
-    swift_ast_context->GetIRGenOptions().Playground = true;
-  } else {
-    swift_ast_context->GetLanguageOptions().Playground = true;
-    swift_ast_context->GetIRGenOptions().Playground = false;
-  }
+  swift_ast_context->GetLanguageOptions().Playground = repl || playground;
+  swift_ast_context->GetIRGenOptions().Playground = repl || playground;
 
   // For the expression parser and REPL we want to relax the
   // requirement that you put ""try"" in front of every expression that",This was a typo that prevented the feature to work correctly.,cpp,1,0,1
"@@ -65,11 +65,6 @@ class ChunkedArrayTest : public testing::Test {
 };
 
 
-/*! ChunkedArray cannot be built from chunks of size 0. */
-TEST_F(ChunkedArrayTest, constructorWithChunkSize0Throws) {
-  ASSERT_THROW(ChunkedArray<int> ca(0), std::runtime_error);
-}
-
 /*! get_chunk_size() should return the size used in the constructor */
 TEST_F(ChunkedArrayTest, constructorWithChunkSize) {
   for (size_t chunk_size = 1; chunk_size < 10; ++chunk_size) {","I believe this piece of code was dropped due to bad merge or something else, right?",cpp,1,1,1
"@@ -49,7 +49,8 @@ def GetDbNames(user='sysdba', password='masterkey', dirName='.', dBase='::templa
       names = ['::' + str(x[0]) for x in c.fetchall()]
     names.remove(dBase)
   elif DbModule.fileWildcard:
-    import os.path, glob
+    import os.path
+    import glob
     names = glob.glob(os.path.join(dirName, DbModule.fileWildcard))
   else:
     names = []",I don't really understand the reason to split these across multiple lines.,cpp,1,1,1
"@@ -10276,13 +10276,14 @@ void Client::RemoveItem(uint32 item_id, uint32 quantity)
 
 			item = GetInv().GetItem(slot_id);
 			if (item && item->GetID() == item_id) {
-				int stack_size = item->IsStackable() ? item->GetCharges() : 1;
-				if ((removed_count + stack_size) <= quantity) {
-					removed_count += stack_size;
+				int stack_size = item->IsStackable() ? item->GetCharges() : 0;
+				int real_stack_size = stack_size ? stack_size : 1;
+				if ((removed_count + real_stack_size) <= quantity) {
+					removed_count += real_stack_size;
 					DeleteItemInInventory(slot_id, stack_size, true);
 				} else {
 					int amount_left = (quantity - removed_count);
-					if (amount_left > 0 && stack_size >= amount_left) {
+					if (amount_left > 0 && real_stack_size >= amount_left) {
 						removed_count += amount_left;
 						DeleteItemInInventory(slot_id, amount_left, true);
 					}","Can do `= std::max(stack_size, 1)` to make this a little clearer Maybe also just rename `stack_size` to `charges` and then this `real_stack_size` to the original `stack_size` for clarity",cpp,1,1,1
"@@ -6234,7 +6234,7 @@ VisitNodeQualifiedArchetype (SwiftASTContext *ast,
     {
         swift::Demangle::Node::iterator end = cur_node->end();
         VisitNodeResult type_result;
-        size_t index = LLDB_INVALID_ADDRESS;
+        uint64_t index = LLDB_INVALID_ADDRESS;
         for (swift::Demangle::Node::iterator pos = cur_node->begin(); pos != end; ++pos)
         {
             switch (pos->get()->getKind())","This should be ""lldb::addr_t"" instead of ""uint64_t"" if we are initializing this with LLDB_INVALID_ADDRESS.",cpp,1,1,1
"@@ -3,6 +3,8 @@
  * Licensed under the MIT License. See LICENSE file in the project root for license information.
  */
 #include <LightGBM/config.h>
+#include <LightGBM/metric.h>
+#include <LightGBM/objective_function.h>
 
 #include <LightGBM/utils/common.h>
 #include <LightGBM/utils/log.h>",I guess that these includes are not needed anymore.,cpp,1,0,1
"@@ -41,8 +41,12 @@ using nebula::cpp2::SupportedType;
 using apache::thrift::FragileConstructor::FRAGILE;
 
 TEST(ProcessorTest, AddHostsTest) {
+    auto workers = std::make_shared<thread::GenericThreadPool>();
+    workers->start(4);
+    auto ioPool = std::make_shared<folly::IOThreadPoolExecutor>(4);
     fs::TempDir rootPath(""/tmp/AddHostsTest.XXXXXX"");
-    std::unique_ptr<kvstore::KVStore> kv(TestUtils::initKV(rootPath.path()));
+    auto kv = TestUtils::initKV(rootPath.path(), ioPool, workers);
+
     {
         std::vector<nebula::cpp2::HostAddr> thriftHosts;
         for (auto i = 0; i < 10; i++) {",You could move the workers and ioPool related code into TestUtils::initKV,cpp,1,1,1
"@@ -74,6 +74,15 @@ InternalRouteResult directShortestPathSearch(SearchEngineData<mld::Algorithm> &e
     auto &reverse_heap = *engine_working_data.reverse_heap_1;
     insertNodesInHeaps(forward_heap, reverse_heap, phantom_nodes);
 
+    std::cout << ""source_phantom.forward_segment_id.id: ""
+              << phantom_nodes.source_phantom.forward_segment_id.id
+              << "" source_phantom.reverse_segment_id.id: ""
+              << phantom_nodes.source_phantom.reverse_segment_id.id << std::endl;
+    std::cout << ""target_phantom.forward_segment_id.id: ""
+              << phantom_nodes.target_phantom.forward_segment_id.id
+              << "" target_phantom.reverse_segment_id.id: ""
+              << phantom_nodes.target_phantom.reverse_segment_id.id << std::endl;
+
     // TODO: when structured bindings will be allowed change to
     // auto [weight, source_node, target_node, unpacked_edges] = ...
     EdgeWeight weight = INVALID_EDGE_WEIGHT;",This is debug code and needs to be removed.,cpp,1,1,1
"@@ -2188,6 +2188,11 @@ bool Player::removeVIP(uint32_t vipGuid)
 
 bool Player::addVIP(uint32_t vipGuid, const std::string& vipName, VipStatus_t status)
 {
+	if (getGUID() == vipGuid) {
+		sendTextMessage(MESSAGE_STATUS_SMALL, ""You cannot add yourself."");
+		return false;
+	}
+
 	if (VIPList.size() >= getMaxVIPEntries() || VIPList.size() == 200) { // max number of buddies is 200 in 9.53
 		sendTextMessage(MESSAGE_STATUS_SMALL, ""You cannot add more buddies."");
 		return false;",I think you can just use `guid` since this variable is available from `this` sorry for bothering you so much   Someone else can come and say that something else is better so don't scold me later ;),cpp,1,1,1
"@@ -4,15 +4,17 @@
  */
 #include <LightGBM/config.h>
 
+#include <LightGBM/dataset.h>
 #include <LightGBM/utils/common.h>
 #include <LightGBM/utils/log.h>
 #include <LightGBM/utils/random.h>
+#include <LightGBM/utils/text_reader.h>
 
 #include <limits>
 
 namespace LightGBM {
 
-void Config::KV2Map(std::unordered_map<std::string, std::string>& params, const char* kv) {
+void Config::KV2Map(std::unordered_map<std::string, std::string>* params, const char* kv) {
   std::vector<std::string> tmp_strs = Common::Split(kv, '=');
   if (tmp_strs.size() == 2 || tmp_strs.size() == 1) {
     std::string key = Common::RemoveQuotationSymbol(Common::Trim(tmp_strs[0]));",Not needed anymore?,cpp,1,0,1
"@@ -145,10 +145,17 @@ hipError_t ihipModuleLaunchKernel(TlsData *tls, hipFunction_t f, uint32_t global
     auto ctx = ihipGetTlsDefaultCtx();
     hipError_t ret = hipSuccess;
 
+    std::size_t blockSize = hip_impl::get_program_state().get_kernattribute(f->_name);
+    if (blockSize < (localWorkSizeX * localWorkSizeY * localWorkSizeZ))
+    {
+        return hipErrorLaunchFailure;
+    }
+
     if (ctx == nullptr) {
         ret = hipErrorInvalidDevice;
 
     } else {
+
         int deviceId = ctx->getDevice()->_deviceId;
         ihipDevice_t* currentDevice = ihipGetDevice(deviceId);
         hsa_agent_t gpuAgent = (hsa_agent_t)currentDevice->_hsaAgent;","How about simply returning after line 155 with the error, and removing the `} else {` unnecessary indentation?",cpp,1,1,1
"@@ -53,7 +53,7 @@ void* DataLayerPrefetch(void* layer_pointer) {
       CHECK(data.size()) << ""Image cropping only support uint8 data"";
       int h_off, w_off;
       // We only do random crop when we do training.
-      if (Caffe::phase() == Caffe::TRAIN) {
+      if (layer->phase_ == Caffe::TRAIN) {
         // NOLINT_NEXT_LINE(runtime/threadsafe_fn)
         h_off = rand() % (height - crop_size);
         // NOLINT_NEXT_LINE(runtime/threadsafe_fn)","I'm not sure that this is related to anything, but rand() is not thread safe.",cpp,1,1,1
"@@ -302,6 +302,13 @@ void PDPServer2::initializeParticipantProxyData(
     {
         logWarning(RTPS_PDP_SERVER, ""SERVER or BACKUP PDP requires always all EDP endpoints creation."");
     }
+
+    // Set participant type and discovery server version properties
+    participant_data->m_properties.push_back(
+        std::pair<std::string, std::string>(
+            {dds::parameter_property_participant_type, ParticipantType::SERVER}));
+    participant_data->m_properties.push_back(
+        std::pair<std::string, std::string>({dds::parameter_property_ds_version, ""2.0""}));
 }
 
 void PDPServer2::assignRemoteEndpoints(",Use new constant for current version,cpp,1,0,1
"@@ -2816,9 +2816,11 @@ void rai::rpc_handler::representatives_online ()
 	boost::property_tree::ptree response_l;
 	boost::property_tree::ptree representatives;
 	auto reps (node.online_reps.list ());
+	rai::transaction transaction (node.store.environment, nullptr, false);
 	for (auto & i : reps)
 	{
-		representatives.put (i.to_account (), """");
+		auto sequence (node.store.vote_current (transaction, i)->sequence);
+		representatives.put (i.to_account (), std::to_string (sequence));
 	}
 	response_l.add_child (""representatives"", representatives);
 	response (response_l);","Would this make more sense on the ""representatives"" call to get all representatives sequence numbers?",cpp,1,1,1
"@@ -136,14 +136,14 @@ int main(int argc, char *argv[]) {
       if (master) std::cerr << ""\n STARTING train - G1 solver model at step "" << super_step << "" \n\n"";
       model_2->train( super_step*pb_model_2.num_epochs(),pb_model_2.num_batches());
       // Evaluate model on test set
-      model_2->evaluate(execution_mode::testing,pb_model_2.num_batches());
+      //      model_2->evaluate(execution_mode::testing,pb_model_2.num_batches());
 
       if(master) std::cout << "" Copy all trained weights from discriminator to G2 and train/freeze as appropriate "" << std::endl;
       model_3->copy_trained_weights_from(model1_weights);
       if (master) std::cerr << ""\n STARTING train - G2 solver model at step "" << super_step << "" \n\n"";
       model_3->train( super_step*pb_model_3.num_epochs(),pb_model_3.num_batches());
       // Evaluate model on test set
-      model_3->evaluate(execution_mode::testing,pb_model_3.num_batches());
+      //      model_3->evaluate(execution_mode::testing,pb_model_3.num_batches());
 
       if(master) std::cout << "" Update G1 weights "" << std::endl;
       auto model2_weights = model_2->get_weights();","This make assumption that we will not need to evaluate in between training which may be true for current large-scale inference that uses inference engine but does not consider ""small scale/normal"" training/inference where training and inference are done in the same run.",cpp,1,1,1
"@@ -1964,10 +1964,18 @@ bool CoreChecks::ValidatePipelineShaderStage(VkPipelineShaderStageCreateInfo con
 
     // The following tries to limit the number of passes through the shader module. The validation passes in here are ""stateless""
     // and mainly only checking the instruction in detail for a single operation
+    uint32_t total_shared_size = 0;
     for (auto insn : *module) {
         skip |= ValidateShaderCapabilitiesAndExtensions(module, insn);
         skip |= ValidatePropertiesAndFeatures(module, insn);
         skip |= ValidateShaderStageGroupNonUniform(module, pStage->stage, insn);
+        total_shared_size += module->CalcComputeSharedMemory(pStage->stage, insn);
+    }
+
+    if (total_shared_size > phys_dev_props.limits.maxComputeSharedMemorySize) {
+        skip |= LogError(device, kVUID_Core_Shader_MaxComputeSharedMemorySize,
+                         ""Shader uses %"" PRIu32 "" bytes of shared memory, more than allowed by physicalDeviceLimits::maxComputeSharedMemorySize (%"" PRIu32 "")"",
+                         total_shared_size, phys_dev_props.limits.maxComputeSharedMemorySize);
     }
 
     skip |=","This limit is in bytes, but isn't `total_shared_size` in bits?",cpp,1,1,1
"@@ -10929,9 +10929,12 @@ static bool AddAttachmentUse(const layer_data *dev_data, RenderPassCreateVersion
     const char *const function_name = use_rp2 ? ""vkCreateRenderPass2KHR()"" : ""vkCreateRenderPass()"";
 
     if (uses & new_use) {
-        log_msg(dev_data->report_data, VK_DEBUG_REPORT_ERROR_BIT_EXT, VK_DEBUG_REPORT_OBJECT_TYPE_UNKNOWN_EXT, 0,
-                kVUID_Core_DrawState_InvalidRenderpass, ""%s: subpass %u already uses attachment %u as a %s attachment."",
-                function_name, subpass, attachment, StringAttachmentType(new_use));
+        if (attachment_layouts[attachment] != new_layout) {
+            vuid = use_rp2 ? ""VUID-VkSubpassDescription2KHR-layout-02528"" : ""VUID-VkSubpassDescription-layout-02519"";
+            log_msg(dev_data->report_data, VK_DEBUG_REPORT_ERROR_BIT_EXT, VK_DEBUG_REPORT_OBJECT_TYPE_UNKNOWN_EXT, 0, vuid,
+                    ""%s: subpass %u already uses attachment %u with a different image layout (%s vs %s)."", function_name, subpass,
+                    attachment, string_VkImageLayout(attachment_layouts[attachment]), string_VkImageLayout(new_layout));
+        }
     } else if (uses & ~ATTACHMENT_INPUT || (uses && (new_use == ATTACHMENT_RESOLVE || new_use == ATTACHMENT_PRESERVE))) {
         /* Note: input attachments are assumed to be done first. */
         vuid = use_rp2 ? ""VUID-VkSubpassDescription2KHR-pPreserveAttachments-03074""",include the two conflicting layouts in the message -- `string_VkImageLayout` to convert them to human readable strings.,cpp,1,1,1
"@@ -1339,6 +1339,7 @@ void ProtocolGame::sendBasicData()
 {
 	NetworkMessage msg;
 	msg.AddByte(0x9F);
+	msg.AddByte(0x9F);
 	msg.AddByte(player->isPremium() ? 0x01 : 0x00);
 	msg.AddByte(player->getVocation()->getClientId());
 	msg.add<uint16_t>(0x00);",This doesn't make sense. Why another 0x9F?,cpp,1,1,1
"@@ -246,6 +246,18 @@ void model::replace_weights(std::vector<weights*>& new_weights) {
 
 }
 
+void model::replace_weights_by_name(std::vector<weights*>& new_weights) {
+  if (new_weights.empty()) {
+    throw lbann_exception(""Model::replace_weights_by name failed : because new_weight vector is empty."");
+  }
+  for(size_t i = 0; i < new_weights.size(); ++i) {
+     for (size_t j = 0; j < m_weights.size(); ++j) {
+       if(m_weights[j]->get_name() == new_weights[i]->get_name())
+         m_weights[j]->set_values(new_weights[i]->get_values());
+     }
+   }
+}
+
 optimizer* model::create_optimizer() const {
   if (m_default_optimizer != nullptr) {
     return m_default_optimizer->copy();",I don't think this check is necessary. The function can just do nothing if the input vector is empty.,cpp,1,1,1
"@@ -248,12 +248,13 @@ void runServer(Int32 argc, char **argv)
   {
      cout << tmbuf << "" RMS Shared segment exists, attaching to it, shmid=""<< shmid << "", key="" << (key_t)getStatsSegmentId() << ""\n"";
   }
-  if ((statsGlobalsAddr = shmat(shmid, getRmsSharedMemoryAddr(), 0))
+  if ((statsGlobalsAddr = shmat(shmid, getRmsSharedMemoryAddr(), SHM_REMAP | SHM_RND))
 		== (void *)-1)
   {
     cout << tmbuf << ""Shmat failed, shmid="" <<shmid << "", key="" << (key_t) getStatsSegmentId() << "", Error code : ""  << errno << ""("" << strerror(errno) << "")\n"";
     exit(errno);
   }
+  gRmsSharedMemoryAddr_ = statsGlobalsAddr;
   char *statsGlobalsStartAddr = (char *)statsGlobalsAddr;
   if (createStatsGlobals)
   {","This shared segment can't be remapped because RMS shared segment have pointers stored within its space. All the processes attaching to the shared segment should attach at the same address. If the process is unable to do it, then the process can't participate in updating the shared segment. This can lead to corruption in the shared segment",cpp,1,1,1
"@@ -200,6 +200,12 @@ HMODULE g_hInstance = NULL;
 #define IfFailRet(EXPR) do { Status = (EXPR); if(FAILED(Status)) { return (Status); } } while (0)
 #endif
 
+bool IsWindowsTarget()
+{
+    return (g_pRuntime->GetRuntimeConfiguration() == IRuntime::WindowsCore) ||
+           (g_pRuntime->GetRuntimeConfiguration() == IRuntime::WindowsDesktop);
+}
+
 #ifdef FEATURE_PAL
 
 #define MINIDUMP_NOT_SUPPORTED()",This seems like it should be in runtime.cpp with an extern in runtime.h. It may be useful in files other than strike.cpp.,cpp,1,1,1
"@@ -633,7 +633,7 @@ std::string DynamicStateString(CBStatusFlags input_value) {
     while (input_value) {
         if (input_value & 1) {
             if (!ret.empty()) ret.append(""|"");
-            ret.append(string_VkDynamicState(ConvertToDynamicState(static_cast<CBStatusFlagBits>(1 << index))));
+            ret.append(string_VkDynamicState(ConvertToDynamicState(static_cast<CBStatusFlagBits>(1llu << index))));
         }
         ++index;
         input_value >>= 1;","Just curious, was this causing an error?",cpp,1,0,1
"@@ -26,7 +26,7 @@ using namespace lldb_private::formatters::swift;
 
 bool lldb_private::formatters::swift::SwiftMetatype_SummaryProvider(
     ValueObject &valobj, Stream &stream, const TypeSummaryOptions &options) {
-  lldb::addr_t metadata_ptr = valobj.GetValueAsUnsigned(LLDB_INVALID_ADDRESS);
+  lldb::addr_t metadata_ptr = valobj.GetPointerValue();
   if (metadata_ptr == LLDB_INVALID_ADDRESS || metadata_ptr == 0) {
     CompilerType compiler_metatype_type(valobj.GetCompilerType());
     CompilerType instancetype(compiler_metatype_type.GetInstanceType());","As this might not be entirely obvious from the patch, the issue here is that GetValueAsUnsigned() doesn't work for a zero-sized type, e.g. MetaTypes, but we can call `GetPointerValue()` because we always have the location of the value in our hands.",cpp,1,1,1
"@@ -28,7 +28,9 @@
 #include ""lldb/Core/State.h""
 #include ""lldb/Core/StreamFile.h""
 #include ""lldb/Core/ValueObjectRegister.h""
+#ifndef LLDB_DISABLE_LIBEDIT
 #include ""lldb/Host/Editline.h""
+#endif
 #include ""lldb/Interpreter/CommandCompletions.h""
 #include ""lldb/Interpreter/CommandInterpreter.h""
 #include ""lldb/Symbol/Block.h""",Does this file differ from the LLDB llvm.org SVN top of tree and the changes here are just syncing with top of tree SVN?,cpp,1,1,1
"@@ -3545,7 +3545,7 @@ unsigned long ODBC::ConvertCharToNumeric(SQLPOINTER srcDataPtr,
     rTrim(cTmpBuf);
     tempLen = strlen(cTmpBuf);
     errno = 0;
-	dTmp = strtod(cTmpBuf, &errorCharPtr);
+	dTmp = strtold(cTmpBuf, &errorCharPtr);
 	if (errno == ERANGE || errorCharPtr < (cTmpBuf + tempLen))
 		return IDS_22_003;
 	return SQL_SUCCESS;","This looks innocuous, but strlod return long double which is 16 byte. This 16 byte is assigned to 8 byte double dTmp. I am not sure if there is an implicit casting to double from long double can work as expected.",cpp,1,1,1
"@@ -64,8 +64,6 @@ folly::Future<Status> DataCollectExecutor::doCollect() {
 Status DataCollectExecutor::collectSubgraph(const std::vector<std::string>& vars) {
   DataSet ds;
   ds.colNames = std::move(colNames_);
-  // the subgraph not need duplicate vertices or edges, so dedup here directly
-  std::unordered_set<Value> uniqueVids;
   std::unordered_set<std::tuple<Value, EdgeType, EdgeRanking, Value>> uniqueEdges;
   for (auto i = vars.begin(); i != vars.end(); ++i) {
     const auto& hist = ectx_->getHistory(*i);",We don't need deduplication now ?,cpp,1,0,1
"@@ -37,8 +37,8 @@ using namespace FixConst;
 extern ""C"" {
   void latte(int *, int *, double *, int *, int *,
              double *, double *, double *, double *,
-             double *, double *, double *, int*,
-             double *, double *, double *, double *, bool *);
+             double *, double *, double *, int *,
+             double *, double *, double *, double *, int * , bool *);
   int latte_abiversion();
 }
 ","If you are changing ABI you need to update the `LATTE_ABIVERSION` in `latte_lib.f90` and the abi check below. Plus, you need to update the version downloaded in `lib/latte/Install.py` and `cmake/CMakeLists.txt`.",cpp,1,1,1
"@@ -41,6 +41,8 @@ LXQtMountPlugin::LXQtMountPlugin(const ILXQtPanelPluginStartupInfo &startupInfo)
 
     connect(mButton, &QToolButton::clicked, mPopup, &Popup::showHide);
     connect(mPopup, &Popup::visibilityChanged, mButton, &QToolButton::setDown);
+    // Note: postpone creation of the mDeviceAction to not fire it in startup time
+    QTimer::singleShot(0, this, &LXQtMountPlugin::settingsChanged);
 }
 
 LXQtMountPlugin::~LXQtMountPlugin()","@lxde/lxqt Do we want to fire the action (info, popup) on the panel startup or not?",cpp,0,0,1
"@@ -111,7 +111,7 @@ FILELOADER_ERRORS Items::loadFromOtb(const std::string& file)
 		return ERROR_INVALID_FORMAT;
 	}
 
-	for(auto & itemNode : root.children) {
+	for (auto & itemNode : root.children) {
 		PropStream stream;
 		if (!loader.getProps(itemNode, stream)) {
 			return ERROR_INVALID_FORMAT;","While at it, remove that space before &",cpp,1,1,1
"@@ -73,6 +73,7 @@ FixRigidSmall::FixRigidSmall(LAMMPS *lmp, int narg, char **arg) :
   dof_flag = 1;
   enforce2d_flag = 1;
   stores_ids = 1;
+  centroidstressflag = CENTROID_AVAIL;
 
   MPI_Comm_rank(world,&me);
   MPI_Comm_size(world,&nprocs);","This flag will be inherited by the `FixRigidNHSmall` class and thus the corresponding derived classes, but I don't see the corresponding changes to enable the feature; similarly `FixRigidSmallOMP`. So it either needs to be disabled in the corresponding constructors or the equivalent changes added.",cpp,1,1,1
"@@ -40,11 +40,8 @@ namespace PrepareRelease
 
             foreach (var outputDirectory in outputDirectories)
             {
-                var filename = Path.Combine(outputDirectory, ""integrations.json"");
                 var utf8NoBom = new UTF8Encoding(encoderShouldEmitUTF8Identifier: false);
-                Console.WriteLine($""Writing {filename}..."");
-                File.WriteAllText(filename, json, utf8NoBom);
-
+                
                 // CallTarget
                 var calltargetPath = Path.Combine(outputDirectory, ""src"", ""Datadog.Trace"", ""ClrProfiler"", ""InstrumentationDefinitions.Generated.cs"");
                 Console.WriteLine($""Writing {calltargetPath}..."");","Doesn't have to be done in this PR, but we can also delete the `json` and `serializerSettings` variables, and the `IntegrationGroups.CallSite` property,",.cs,0,1,1
"@@ -101,6 +101,7 @@ namespace NLog
         /// <summary>
         /// Initializes static members of the LogManager class.
         /// </summary>
+        [System.Diagnostics.CodeAnalysis.SuppressMessage(""Microsoft.Performance"", ""CA1810:InitializeReferenceTypeStaticFieldsInline"", Justification = ""Significant logic in .cctor()"")]
         static LogFactory()
         {
             RegisterEvents(DefaultAppEnvironment);","What code-analysis tool where you using, that required this `SuppressMessage` ?",.cs,1,1,1
"@@ -62,6 +62,13 @@ namespace OpenTelemetry.Exporter
                     this.WriteLine($""{""LogRecord.Exception:"".PadRight(rightPaddingLength)}{logRecord.Exception?.Message}"");
                 }
 
+                logRecord.ForEachScope(
+                    (scope, state) =>
+                    {
+                        this.WriteLine($""{""LogRecord.Scope:"".PadRight(rightPaddingLength)}{scope}"");
+                    },
+                    logRecord.State);
+
                 this.WriteLine(string.Empty);
             }
 ",TODO for myself: avoid creating a closure here.,.cs,0,0,1
"@@ -119,11 +119,11 @@ namespace NLog.UnitTests.LayoutRenderers.Wrappers
         [Fact]
         public void CachedSecondsTimeoutTest()
         {
-            SimpleLayout l = ""${guid:cachedSeconds=10}"";
+            SimpleLayout l = ""${guid:cachedSeconds=60}"";
             var s1 = l.Render(LogEventInfo.CreateNullEvent());
             var s2 = l.Render(new LogEventInfo());
             Assert.Equal(s1, s2);
-            var s3 = l.Render(new LogEventInfo() { TimeStamp = NLog.Time.TimeSource.Current.Time.AddMinutes(1) });
+            var s3 = l.Render(new LogEventInfo() { TimeStamp = NLog.Time.TimeSource.Current.Time.AddMinutes(2) });
             Assert.NotEqual(s2, s3);
         }
     }","why does the test need a change? Not that I'm against it, but don't see the reason for it.",.cs,1,1,1
"@@ -29,8 +29,7 @@ namespace MicroBenchmarks
                     .WithMinIterationCount(15)
                     .WithMaxIterationCount(20) // we don't want to run more that 20 iterations
                     .AsDefault()) // tell BDN that this are our default settings
-                .WithArtifactsPath(Path.Combine(
-                    Path.GetDirectoryName(typeof(Program).Assembly.Location), ""BenchmarkDotNet.Artifacts""))
+                .With(ConfigOptions.DontOverwriteResults) // tell BDN to not overwrite the results
                 .With(MemoryDiagnoser.Default) // MemoryDiagnoser is enabled by default
                 .With(new OperatingSystemFilter())
                 .With(JsonExporter.Full) // make sure we export to Json (for BenchView integration purpose)","Data generated by the harness should be with the binaries, not drop side-by-side with the source code. I do not agree this should be changed.",.cs,1,1,1
"@@ -34,7 +34,12 @@ namespace Microsoft.CodeAnalysis.Sarif
 
                         var sha256Cng = new SHA256Cng();
                         checksum = sha256Cng.ComputeHash(bufferedStream);
-                        sha256 = BitConverter.ToString(checksum).Replace(""-"", String.Empty);                            
+                        sha256 = BitConverter.ToString(checksum).Replace(""-"", String.Empty);
+
+                        // disposals
+                        md5Cng.Dispose();
+                        sha1Cng.Dispose();
+                        sha256Cng.Dispose();                        
                     }
                 }
             }",As we've discussed: Use `using` statements to ensure that `Dispose` is called even if the intervening code throws an exception.,.cs,1,1,1
"@@ -23,6 +23,8 @@ using Microsoft.Extensions.Configuration;
 using Microsoft.Extensions.DependencyInjection;
 using Microsoft.Extensions.Hosting;
 using Microsoft.OpenApi.Models;
+using OpenTelemetry;
+using OpenTelemetry.Resources;
 using OpenTelemetry.Trace;
 
 namespace Examples.AspNetCore",I had to add both `OpenTelemetry` and `OpenTelemetry.Resources` here because the `AddService` extension method is in the `OpenTelemetry` namespace. Was this intentional? Relates to #1541 in that I think we should aim to be consistent.,.cs,0,1,1
"@@ -18,6 +18,12 @@ namespace Datadog.Trace.Configuration
         /// <seealso cref=""TracerSettings.Environment""/>
         public const string Environment = ""DD_ENV"";
 
+        /// <summary>
+        /// Configuration key for the application's version. Sets the ""version"" tag on every <see cref=""Span""/>.
+        /// </summary>
+        /// <seealso cref=""TracerSettings.Version""/>
+        public const string Version = ""DD_VERSION"";
+
         /// <summary>
         /// Configuration key for the application's default service name.
         /// Used as the service name for top-level spans,",Wasn't sure on wording for overriding `DD_SERVICE_NAME`. Thoughts?,.cs,1,0,1
"@@ -22,13 +22,6 @@ namespace System.Diagnostics
         [Benchmark]
         public void GetProcessById() => Process.GetProcessById(_currentProcessId).Dispose();
 
-        [Benchmark]
-        public void EnterLeaveDebugMode()
-        {
-            Process.EnterDebugMode();
-            Process.LeaveDebugMode();
-        }
-        
         [Benchmark]
         public void GetProcesses()
         {","@jorive @billwert I am removing this benchmark because: 1. it does nothing on Unix OSes (not implemented in CoreCLR, instead of throwing does nothing) 2. On Windows it requires some certain privileges to work, it currently fails even on my box (it used to work fine) I am the person who created this benchmark ;)",.cs,0,1,1
"@@ -356,6 +356,11 @@ namespace SkylineTester
             _process.StartInfo.Arguments = arguments;
             _process.StartInfo.StandardOutputEncoding = Encoding.UTF8; // So we can read Japanese from TestRunner's console
             _process.StartInfo.StandardErrorEncoding = Encoding.UTF8; // So we can read Japanese from TestRunner's console
+
+            // Configure git to fail if its https connection stalls out, so our retry logic can kick in
+            _process.StartInfo.EnvironmentVariables.Add(@""GIT_HTTP_LOW_SPEED_LIMIT"", @""1000""); // Fail if transfer rate falls below 1Kbps,
+            _process.StartInfo.EnvironmentVariables.Add(@""GIT_HTTP_LOW_SPEED_TIME"", @""300"");   // and stays that way for 5 minutes
+
             _process.OutputDataReceived += HandleOutput;
             _process.ErrorDataReceived += HandleOutput;
             _process.Exited += ProcessExit;",Did you test if it works by using some crazy values like 1gbit and 5 seconds?,.cs,1,1,1
"@@ -213,6 +213,11 @@ namespace Datadog.Trace
             {
                 lock (_globalInstanceLock)
                 {
+                    if (_instance is ILockedTracer)
+                    {
+                        throw new Exception(""The current tracer instance cannot be replaced."");
+                    }
+
                     _instance = value;
                     _globalInstanceInitialized = true;
                 }","Under what circumstances could this happen?   Do we definitely want to throw (rather than log an error and ignore the set), as that would bring down the test process?",.cs,1,1,1
"@@ -0,0 +1,12 @@
+namespace Microsoft.Azure.Cosmos.CosmosElements
+{
+    internal enum CosmosElementType
+    {
+        Array,
+        Boolean,
+        Null,
+        Number,
+        Object,
+        String,
+    }
+}",Is that an extra special character at the end?,.cs,1,1,1
"@@ -118,9 +118,9 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Internal.Networking
             _uv.read_stop(this);
         }
 
-        public int TryWrite(Libuv.uv_buf_t buf)
+        public void TryWrite(Libuv.uv_buf_t buf)
         {
-            return _uv.try_write(this, new[] { buf }, 1);
+            _uv.try_write(this, new[] { buf }, 1);
         }
 
         private static void UvConnectionCb(IntPtr handle, int status)","TryWrite returns the number of bytes written to a socket or an error. I don't think that removing the returned value is really something one wants to do with this API. It is currently not used, but in the future, if one were to use it, one would check how much of the buffer would have been written by using the returned value and eventually queue the rest of the buffer for writing with a normal Write call.",.cs,1,1,1
"@@ -2451,7 +2451,7 @@ namespace pwiz.Skyline
                     bool success = false;
                     using (var longWaitDlg = new LongWaitDlg(this)
                     {
-                        Text = Text,    // Same as dialog box
+                        Text = Text, // Same as dialog box
                         Message = message,
                         ProgressValue = 0
                     })",Can you revert these ReSharper autoformatting changes to make the important change clearer?,.cs,1,1,1
"@@ -22,6 +22,8 @@ namespace Nethermind.Consensus.Ethash
 {
     public class EthashCache : IEthashDataSet
     {
+        private ArrayPool<uint[]> _arrayPool = ArrayPool<uint[]>.Create(1024 * 1024 * 4, 50);
+        
         private uint[][] Data { get; set; }
 
         public uint Size { get; set; }",why separate pool?,.cs,1,0,1
"@@ -1303,6 +1303,7 @@ namespace pwiz.Skyline
 
             // Build library
             var builder = import.GetLibBuilder(doc, commandArgs.Saving ? commandArgs.SaveFile : commandArgs.SkylineFile, commandArgs.IncludeAmbiguousMatches);
+            builder.PreferEmbeddedSpectra = commandArgs.PreferEmbeddedSpectra;
             ImportPeptideSearch.ClosePeptideSearchLibraryStreams(doc);
             _out.WriteLine(Resources.CommandLine_ImportSearch_Creating_spectral_library_from_files_);
             foreach (var file in commandArgs.SearchResultsFiles)",This file seems to be missing special handling for the spectrum file missing error. You need a message that tells the user to relocate the raw data or use --import-search-prefer-embedded-spectra,.cs,1,1,1
"@@ -194,10 +194,8 @@ namespace NLog.Targets
         /// <param name=""installationContext"">The installation context.</param>
         public void Install(InstallationContext installationContext)
         {
-            var fixedSource = GetFixedSource();
-
-            //always throw error to keep backwardscomp behavior.
-            CreateEventSourceIfNeeded(fixedSource, true);
+            // always throw error to keep backwards compatible behavior.
+            CreateEventSourceIfNeeded(GetFixedSource(), true);
         }
 
         /// <summary>",Why is this changed?,.cs,1,0,1
"@@ -202,6 +202,19 @@ namespace Microsoft.AspNetCore.Server.KestrelTests
             }
         }
 
+        [Fact]
+        public async Task BadRequestIfContentLengthInvalid()
+        {
+            using (var server = new TestServer(context => { return Task.FromResult(0); }))
+            {
+                using (var connection = server.CreateConnection())
+                {
+                    await connection.Send(""GET / HTTP/1.1\r\nContent-Length: NaN\r\n\r\n"");
+                    await ReceiveBadRequestResponse(connection, ""400 Bad Request"", server.Context.DateHeaderValue);
+                }
+            }
+        }
+
         private async Task ReceiveBadRequestResponse(TestConnection connection, string expectedResponseStatusCode, string expectedDateHeaderValue)
         {
             await connection.ReceiveForcedEnd(",Test with negative value too.,.cs,1,0,1
"@@ -23,6 +23,7 @@ namespace Nethermind.Wallet
     public interface IBasicWallet
     {
         Signature Sign(Keccak message, Address address);
+        bool IsUnlocked(Address address);
         
         void Sign(Transaction tx, int chainId)
         {",This look like a common case when we decide to move only one of a group of transactions but truly we should move ll of them or none. I think that if you need to check whether address is unlocked then you should use IWallet instead. IBasicWallet does not include locking / unlocking.,.cs,1,1,1
"@@ -83,7 +83,7 @@ namespace Nethermind.Core.Collections
         public static int BinarySearch<TItem>(this IList<TItem> list, TItem value,  IComparer<TItem> comparer) => list.BinarySearch(value, comparer.Compare);
         
         public static bool TryGetSearchedItem<TComparable>(this IList<TComparable> list, in TComparable activation, out TComparable item) where TComparable : IComparable<TComparable> => 
-            list.TryGetSearchedItem(activation, (b, c) => b.CompareTo(c), out item);
+            list.TryGetSearchedItem(activation, (b, c) => b.CompareTo(c), out item!);
 
         public static bool TryGetForBlock(this IList<long> list, in long blockNumber, out long item) =>
             list.TryGetSearchedItem(blockNumber, (b, c) => b.CompareTo(c), out item);","the other way around, item can be nulll, so out TComparable? item",.cs,1,1,0
"@@ -22,10 +22,12 @@ namespace Nethermind.Blockchain.Processing
     public class BlockProcessedEventArgs : EventArgs
     {
         public Block Block { get; }
+        public TxReceipt[] TxReceipts { get; }
 
-        public BlockProcessedEventArgs(Block block)
+        public BlockProcessedEventArgs(Block block, TxReceipt[] txReceipts)
         {
             Block = block;
+            TxReceipts = txReceipts;
         }
     }
-}
+}",should be allowed to be null I guess as we sometimes may not create receipts,.cs,1,1,1
"@@ -95,7 +95,7 @@ namespace Nethermind.Blockchain.Processing
                     return false;
                 }
 
-                if (transaction.IsEip1559 && !transaction.IsServiceTransaction && senderBalance < (UInt256)transaction.GasLimit * transaction.MaxFeePerGas)
+                if (eip1559Enabled && !transaction.IsServiceTransaction && senderBalance < (UInt256)transaction.GasLimit * transaction.MaxFeePerGas + transaction.Value)
                 {
                     e.Set(TxAction.Skip, $""MaxFeePerGas ({transaction.MaxFeePerGas}) times GasLimit {transaction.GasLimit} is higher than sender balance ({senderBalance})"");
                     return false;","This and the check above in line 90 look similar (same?) as the ones in TransactionProcessor, should we have an extension method or something?",.cs,1,1,1
"@@ -0,0 +1,19 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+// See the LICENSE file in the project root for more information.
+
+using System;
+using Xunit.Sdk;
+
+namespace Xunit
+{
+    /// <summary>
+    /// Apply this attribute to your test method to specify this is a platform specific test.
+    /// </summary>
+    [TraitDiscoverer(""Xunit.NetCore.Extensions.SkipOnTargetFrameworkDiscoverer"", ""Xunit.NetCore.Extensions"")]
+    [AttributeUsage(AttributeTargets.Method | AttributeTargets.Class, AllowMultiple = false)]
+    public class SkipOnTargetFramework : Attribute, ITraitAttribute
+    {
+        public SkipOnTargetFramework(TargetFrameworkMoniker platform) { }
+    }
+}",This should be named `SkipOnTargetFrameworkAttribute` (with the Attribute suffix).,.cs,1,1,1
"@@ -11,10 +11,12 @@ using Microsoft.AspNetCore.Hosting;
 using Microsoft.AspNetCore.Hosting.Server;
 using Microsoft.AspNetCore.Http;
 using Microsoft.AspNetCore.Server.Kestrel.Core;
+using Microsoft.AspNetCore.Server.Kestrel.Core.Internal;
 using Microsoft.AspNetCore.Server.Kestrel.Transport.Abstractions.Internal;
 using Microsoft.AspNetCore.Testing;
 using Microsoft.Extensions.DependencyInjection;
 using Microsoft.Extensions.Options;
+using Moq;
 
 namespace Microsoft.AspNetCore.Server.Kestrel.FunctionalTests
 {",Nit: fix usings.,.cs,1,0,1
"@@ -59,7 +59,14 @@ namespace Datadog.Trace.Tests
                 Environment = env
             };
             var tracer = new Tracer(settings);
-            Tracer.Instance = tracer;
+            if (Ci.CIVisibility.IsRunning)
+            {
+                Tracer.UnsafeSetTracerInstance(tracer);
+            }
+            else
+            {
+                Tracer.Instance = tracer;
+            }
 
             using (var parentScope = Tracer.Instance.StartActive(""parent""))
             using (var childScope = Tracer.Instance.StartActive(""child""))",Do we need the condition? We could use `Tracer.UnsafeSetTracerInstance(tracer);` in either case right?,.cs,1,1,1
"@@ -176,6 +176,8 @@ namespace Datadog.Trace.ClrProfiler.IntegrationTests
                         {
                             if (!_process.HasExited)
                             {
+                                SubmitRequest(null, ""/shutdown"").GetAwaiter().GetResult();
+
                                 _process.Kill();
                             }
                         }",I think we should exclude this URL in `IsNotServerLifeCheck` too?,.cs,1,1,1
"@@ -14,7 +14,9 @@
 // limitations under the License.
 // </copyright>
 
+using System;
 using System.Diagnostics;
+using OpenTelemetry.Exporter.Jaeger.Implementation;
 
 namespace OpenTelemetry.Exporter
 {",I would move this section to a new method - eg `SetOptionsViaEnvironmentVariables`.,.cs,1,0,1
"@@ -38,6 +38,18 @@ namespace OpenTelemetry.Metrics
 
         public string[] TagKeys { get; set; }
 
+        /// <summary>
+        /// Gets or sets the names of <see cref=""Baggage""/> keys, which,
+        /// if available, will be used as additional tags for Metric
+        /// aggregation.
+        /// <see cref=""Baggage.GetBaggage(string)""/> will be used by the SDK
+        /// internally to obtain the additional tags.
+        /// </summary>
+        /// <remarks>
+        /// It is invalid to specify this for Observable instruments.
+        /// </remarks>
+        public string[] BaggageKeysForAdditionalTags { get; set; }
+
         public virtual Aggregation Aggregation { get; set; }
 
         // TODO: MetricPoints caps can be configured here","I'm not sure if these should be called Tags or Dimensions? It seems the word ""tag"" could mean two different things: 1. The .NET way of calling an Attribute. 2. The Prometheus way of calling a ""dimension"".",.cs,1,1,1
"@@ -112,7 +112,7 @@ namespace OpenTelemetry.Instrumentation.AspNetCore.Implementation
 
             if (activity.IsAllDataRequested)
             {
-                activity.SetCustomProperty(RequestCustomPropertyName, request);
+                this.options.Enrich?.Invoke(activity, ""OnStartActivity"", request);
 
                 var path = (request.PathBase.HasValue || request.Path.HasValue) ? (request.PathBase + request.Path).ToString() : ""/"";
                 activity.DisplayName = path;",this can be user code and can potentially throw. We need to try.catch.log,.cs,1,1,1
"@@ -13,8 +13,10 @@ namespace Microsoft.AspNet.Server.Kestrel.Http
 {
     public class Connection : ConnectionContext, IConnectionControl
     {
-        private static readonly Action<UvStreamHandle, int, object> _readCallback = ReadCallback;
-        private static readonly Func<UvStreamHandle, int, object, Libuv.uv_buf_t> _allocCallback = AllocCallback;
+        private static readonly Action<UvStreamHandle, int, object> _readCallback = 
+            (handle, status, state) => ReadCallback(handle, status, state);
+        private static readonly Func<UvStreamHandle, int, object, Libuv.uv_buf_t> _allocCallback = 
+            (handle, suggestedsize, state) => AllocCallback(handle, suggestedsize, state);
 
         private static long _lastConnectionId;
 ","Do you have to use the `=>` to remove the closure allocation? I think I remember that being the case at one point, but I figured that was a compiler bug that should be fixed by now.",.cs,1,1,1
"@@ -1396,8 +1396,11 @@ namespace pwiz.Skyline.Controls.Graphs
                 {
                     if (IsRunToRun)
                     {
-                        return string.Format(Resources.GraphData_CorrelationLabel_Measured_Time___0__,
-                            _document.MeasuredResults.Chromatograms[_originalIndex].Name);
+                        return _document.MeasuredResults != null && !_document.MeasuredResults.IsEmpty &&
+                               0 <= _originalIndex && _originalIndex < _document.MeasuredResults.Chromatograms.Count
+                            ? string.Format(Resources.GraphData_CorrelationLabel_Measured_Time___0__,
+                                _document.MeasuredResults.Chromatograms[_originalIndex].Name)
+                            : string.Empty;
                     }
                     else
                     {","I think you should make this an ""if/else"" statement instead of ""?:"" so that it's easier to understand. Also, we should probably get rid of the property ""MeasuredResults.IsEmpty"". We never create empty MeasuredResults objects (it's always null instead).",.cs,1,1,1
"@@ -30,12 +30,12 @@ namespace OpenTelemetry.Exporter.Zipkin.Implementation
 
         private static readonly Dictionary<string, int> RemoteEndpointServiceNameKeyResolutionDictionary = new Dictionary<string, int>(StringComparer.OrdinalIgnoreCase)
         {
-            [""net.peer.name""] = 0, // RemoteEndpoint.ServiceName primary.
-            [""peer.service""] = 0, // RemoteEndpoint.ServiceName primary.
-            [""peer.hostname""] = 1, // RemoteEndpoint.ServiceName alternative.
-            [""peer.address""] = 1, // RemoteEndpoint.ServiceName alternative.
-            [""http.host""] = 2, // RemoteEndpoint.ServiceName for Http.
-            [""db.instance""] = 2, // RemoteEndpoint.ServiceName for Redis.
+            [SpanAttributeConstants.PeerServiceKey] = 0, // RemoteEndpoint.ServiceName primary.
+            [""net.peer.name""] = 1, // RemoteEndpoint.ServiceName primary.
+            [""peer.hostname""] = 2, // RemoteEndpoint.ServiceName alternative.
+            [""peer.address""] = 2, // RemoteEndpoint.ServiceName alternative.
+            [""http.host""] = 3, // RemoteEndpoint.ServiceName for Http.
+            [""db.instance""] = 4, // RemoteEndpoint.ServiceName for Redis.
         };
 
         private static readonly ConcurrentDictionary<string, ZipkinEndpoint> LocalEndpointCache = new ConcurrentDictionary<string, ZipkinEndpoint>();","I made Zipkin & Jaeger consistent, but I wasn't sure what should have top priority: ""net.peer.name"" or ""peer.service."" I went with ""peer.service"" because that's what it is called in the Jaeger protocol, but OT spec calls out ""net.peer.name"" specifically. I have a feeling it will change a bunch.",.cs,1,1,1
"@@ -40,8 +40,8 @@ namespace Nethermind.JsonRpc.Test.Modules
         private EthereumJsonSerializer _serializer;
         private NetworkConfig _networkConfig;
         private IBlockTree _blockTree;
-        private const string _enodeString = ""enode://e1b7e0dc09aae610c9dec8a0bee62bab9946cc27ebdd2f9e3571ed6d444628f99e91e43f4a14d42d498217608bb3e1d1bc8ec2aa27d7f7e423413b851bae02bc@127.0.0.1:30303"";
-        private const string _exampleDataDir = ""/example/dbdir"";
+        private const string EnodeString = ""enode://e1b7e0dc09aae610c9dec8a0bee62bab9946cc27ebdd2f9e3571ed6d444628f99e91e43f4a14d42d498217608bb3e1d1bc8ec2aa27d7f7e423413b851bae02bc@www.google.com:30303"";
+        private const string ExampleDataDir = ""/example/dbdir"";
         
         [SetUp]
         public void Setup()",it tests dns now but does not test ip any more,.cs,1,1,0
"@@ -47,6 +47,11 @@ namespace OpenTelemetry.Instrumentation.Http
 
         internal bool EventFilter(HttpWebRequest request)
         {
+            if (Sdk.SuppressInstrumentation)
+            {
+                return false;
+            }
+
             Uri requestUri;
             if (request.Method == ""POST""
                 && (requestUri = request.RequestUri) != null","Now that we have this, we should be able to remove the whole IsInternalUrl thing. That was really just filtering out the calls from the instrumentation before we had the mechanism.",.cs,1,1,1
"@@ -41,7 +41,11 @@ namespace OpenTelemetry.Instrumentation
         {
             if (!this.handler.SupportsNullActivity && Activity.Current == null)
             {
-                InstrumentationEventSource.Log.NullActivity(value.Key);
+                if (!Sdk.SuppressInstrumentation)
+                {
+                    InstrumentationEventSource.Log.NullActivity(value.Key);
+                }
+
                 return;
             }
 ","should we add this check inside the instrumentationEventSource? because we can forget if someone adds a new Log, no?",.cs,1,1,1
"@@ -5,8 +5,8 @@ namespace Microsoft.CodeAnalysis.Sarif
     public static class VersionConstants                                       
     {                                                                          
         public const string Prerelease = ""-beta"";                       
-        public const string AssemblyVersion = ""1.5.21"";       
-        public const string FileVersion = ""1.5.21"" + "".0"";    
+        public const string AssemblyVersion = ""1.5.22"";       
+        public const string FileVersion = ""1.5.22"" + "".0"";    
         public const string Version = AssemblyVersion + Prerelease;            
     }                                                                          
  }                                                                             ",How'd this get updated? Why don't I see a chance somewhere to SetCurrentVersion.cmd?,.cs,1,1,1
"@@ -38,7 +38,7 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets
             _remoteEndPoint = (IPEndPoint)_socket.RemoteEndPoint;
         }
 
-        public async void Start(IConnectionHandler connectionHandler)
+        public async Task Start(IConnectionHandler connectionHandler)
         {
             try
             {",Can we rename this to `StartAsync`?,.cs,1,1,1
"@@ -660,7 +660,11 @@ namespace pwiz.Skyline.Model.AuditLog
 
         public AuditLogEntry ChangeExtraInfo(string extraInfo)
         {
-            return ChangeProp(ImClone(this), im => im.ExtraInfo = extraInfo);
+            return ChangeProp(ImClone(this), im =>
+            {
+                im._enExtraInfo = null;
+                im.ExtraInfo = extraInfo;
+            });
         }
 
         #endregion",Should the setter for ExtraInfo do this? Are their other cases where it makes sense to set ExtraInfo without doing this?,.cs,1,1,1
"@@ -21,5 +21,6 @@ namespace Nethermind.Core.Specs.ChainSpecStyle
     public interface IChainSpecLoader
     {
         ChainSpec Load(byte[] data);
+        ChainSpec Load(string jsonData);
     }
 }",i remember there was a reason for which I had to make it byte[] only... I do not remember the exact reason. I think that not every implementation could provide a string (do not know why),.cs,1,0,1
"@@ -470,14 +470,11 @@ namespace pwiz.Skyline.Controls.Graphs
                 progressControl.ShowGraph += (sender, args) => ShowGraph();
                 progressControl.ShowLog += (sender, args) => ShowLog();
                 controlsToAdd.Add(progressControl);
+                _fileProgressControls.Add(filePath.GetLocation(), progressControl);
                 first = false;
             }
 
             flowFileStatus.Controls.AddRange(controlsToAdd.ToArray());
-            foreach (var control in controlsToAdd)
-            {
-                _fileProgressControls.Add(control.FilePath.GetLocation(), control);
-            }
         }
 
         private void CancelMissingFiles(MultiProgressStatus status)",This seems to be a repeat or removal of Nick's recent change and not related to this PR.,.cs,0,1,1
"@@ -105,6 +105,10 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Core.Internal
         {
             try
             {
+                // TODO: When we start tracking all connection middleware for shutdown, go back
+                // to logging connections tart and stop in ConnectionDispatcher so we get these
+                // logs for all connection middleware.
+                Log.ConnectionStart(ConnectionId);
                 KestrelEventSource.Log.ConnectionStart(this);
 
                 AdaptedPipeline adaptedPipeline = null;",Why did you move this?,.cs,1,0,1
"@@ -2,11 +2,12 @@
 // The .NET Foundation licenses this file to you under the MIT license.
 // See the LICENSE file in the project root for more information.
 
+using System;
 using System.Threading.Tasks;
 
 namespace Microsoft.DotNet.VersionTools.Automation.GitHubApi
 {
-    public interface IGitHubClient
+    public interface IGitHubClient : IDisposable
     {
         GitHubAuth Auth { get; }
 ",Should this be renamed? `IGitClient` sounds better... Or `IRemoteGitClient`?,.cs,1,1,1
"@@ -13,6 +13,7 @@ namespace System.Buffers.Tests
     [BenchmarkCategory(Categories.CoreFX)]
     [GenericTypeArguments(typeof(byte))] // value type
     [GenericTypeArguments(typeof(object))] // reference type
+    [GcServer(true)] // Server GC is the most important scenario for ArrayPool
     public class RentReturnArrayPoolTests<T>
     {
         private readonly ArrayPool<T> _createdPool = ArrayPool<T>.Create();",Is doing this per test suite the right thing to do? Or would it be better to do GcServer(false) runs for all benchmarks and GcServer(true) runs for all benchmarks? I imagine that many of our benchmarks are allocation-heavy and would be influenced by client vs server GC.,.cs,1,1,1
"@@ -10,7 +10,7 @@ namespace MvvmCross.Platforms.Android.Views
 {
     public class MvxApplicationCallbacksCurrentTopActivity : Java.Lang.Object, Application.IActivityLifecycleCallbacks, IMvxAndroidCurrentTopActivity
     {
-        private ConcurrentDictionary<string, ActivityInfo> _Activities = new ConcurrentDictionary<string, ActivityInfo>();
+        protected ConcurrentDictionary<string, ActivityInfo> _Activities { private set; } = new ConcurrentDictionary<string, ActivityInfo>();
         public Activity Activity => GetCurrentActivity();
 
         public void OnActivityCreated(Activity activity, Bundle savedInstanceState)",Shouldn't it have a `get` too?,.cs,1,0,0
"@@ -54,7 +54,7 @@ namespace Nethermind.Core
                 }
             }
             
-            File.WriteAllText(@""network_diag.txt"", stringBuilder.ToString());
+            File.WriteAllText(@""C:\\Temp\\network_diag.txt"", stringBuilder.ToString());
         }
 
         [MethodImpl(MethodImplOptions.Synchronized)]",windows specific? Access to some absolute path?,.cs,1,0,0
"@@ -0,0 +1,13 @@
+namespace Datadog.Trace.Agent
+{
+    internal static class TraceRequestDecorator
+    {
+        public static void AddHeaders(IApiRequest request)
+        {
+            request.AddHeader(AgentHttpHeaderNames.Language, "".NET"");
+            request.AddHeader(AgentHttpHeaderNames.TracerVersion, TracerConstants.AssemblyVersion);
+            // don't add automatic instrumentation to requests from datadog code
+            request.AddHeader(HttpHeaderNames.TracingEnabled, ""false"");
+        }
+    }
+}","This isn't a big deal, but without a full Decorator pattern, this feels a little weird to me. Maybe this could be `IApiRequestExtensions`?",.cs,1,1,1
"@@ -45,17 +45,6 @@ namespace Microsoft.CodeAnalysis.Sarif
 
         private static string[] InvalidFiles = new string[]
         {
-            @""ClangAnalyzer\ArrayDataTypes.xml.sarif"",
-            @""ClangAnalyzer\BadMissingString.xml.sarif"",
-            @""ClangAnalyzer\ClangAnalyzer_issueLog1_raw.xml.sarif"",
-            @""ClangAnalyzer\DictionaryDataTypes.xml.sarif"",
-            @""ClangAnalyzer\DivByZero.xml.sarif"",
-            @""ClangAnalyzer\FileNumberCoverage.xml.sarif"",
-            @""ClangAnalyzer\GarbageValueLog.xml.sarif"",
-            @""ClangAnalyzer\MediumLog.xml.sarif"",
-            @""ClangAnalyzer\MissingLocation.xml.sarif"",
-            @""ClangAnalyzer\RealLog.xml.sarif"",
-            @""CppCheck\CppCheck_issueLog1_raw.xml.sarif""
         };
 
         public static IEnumerable<object[]> TestCases",I like that you left the empty array in there.,.cs,1,0,1
"@@ -18,6 +18,7 @@ namespace Nethermind.Trie.Pruning
 {
     public interface IPruningStrategy
     {
+        bool Enabled { get; }
         bool ShouldPrune(in long currentMemory);
     }
-}
+}",what does it mean enabled?,.cs,1,1,0
"@@ -0,0 +1,14 @@
+﻿using UIKit;
+using MvvmCross.Core.ViewModels;
+
+namespace MvvmCross.tvOS.Views
+{
+    public interface IMvxSplitViewController
+    {
+        void ShowMasterView(UIViewController viewController, bool wrapInNavigationController);
+
+        void ShowDetailView(UIViewController viewController, bool wrapInNavigationController);
+
+        bool CloseChildViewModel(IMvxViewModel viewModel);
+    }
+}",I think all of this could be controlled from the presenter?,.cs,1,1,1
"@@ -228,6 +228,19 @@ namespace Datadog.Trace.ClrProfiler.IntegrationTests
             SetEnvironmentVariable(""DD_VERSION"", serviceVersion);
         }
 
+        protected void SetCallTargetSettings(bool enableCallTarget, bool enableMethodInlining)
+        {
+            if (enableCallTarget)
+            {
+                SetEnvironmentVariable(""DD_TRACE_CALLTARGET_ENABLED"", ""true"");
+            }
+
+            if (enableMethodInlining)
+            {
+                SetEnvironmentVariable(""DD_CLR_ENABLE_INLINING"", ""true"");
+            }
+        }
+
         protected async Task AssertWebServerSpan(
             string path,
             MockTracerAgent agent,",Don't you need to also set the variable back to false when the argument is false?,.cs,1,1,1
"@@ -11,7 +11,6 @@ namespace Datadog.Trace.ClrProfiler.Integrations.AdoNet
 
             // .NET Core
             public const string SystemDataCommon = ""System.Data.Common"";
-            public const string SystemDataSqlClient = ""System.Data.SqlClient"";
 
             // .NET Standard
             public const string NetStandard = ""netstandard"";",This moved to `SqlCommandIntegration.cs`.,.cs,1,0,1
"@@ -55,6 +55,11 @@ namespace Nethermind.TxPool.Filters
 
             for (int i = 0; i < transactions.Length; i++)
             {
+                if (transactions[i].Nonce < account.Nonce)
+                {
+                    continue;
+                }
+
                 if (transactions[i].Nonce < tx.Nonce)
                 {
                     overflow |= UInt256.MultiplyOverflow(",it feels like this should be a separate filter -> why the nonce check is added to the TooExpensiveTxFilter?,.cs,1,1,1
"@@ -70,6 +70,13 @@ namespace NLog.Targets
         private Timer autoClosingTimer;
         private int initializedFilesCounter;
 
+        /// <summary>
+        /// Provides the shape of an archive file changed event. Event name will describe the action.
+        /// </summary>
+        /// <param name=""archiveFilename"">The name of the file in question.</param>
+        public delegate void ArchiveFileAlteredHandler(string archiveFilename);
+        
+
         private int maxArchiveFiles;
 
         private readonly DynamicFileArchive fileArchive;","With archiving, we like to know to things: the original path and the new archive File Path. This will opt for two separate delegates.",.cs,1,1,1
"@@ -19,7 +19,7 @@ namespace Microsoft.DotNet.Build.Tasks
 
         private const string ConfigurationPropsFilename = ""Configurations.props"";
         private static Regex s_configurationConditionRegex = new Regex(@""'\$\(Configuration\)\|\$\(Platform\)' ?== ?'(?<config>.*)'"");
-        private static string[] s_configurationSuffixes = new [] { ""Debug|AnyCPU"", ""Release|AnyCPU"" };
+        private static string[] s_configurationSuffixes = new [] { ""Debug"", ""Release"" };
 
         public override bool Execute()
         {",Just to confirm: every consumer of this is doing the switch so you don't need to keep the old format?,.cs,1,1,1
"@@ -31,7 +31,7 @@ namespace Nethermind.Blockchain.Producers
         private Task _producerTask;
         private readonly CancellationTokenSource _loopCancellationTokenSource = new CancellationTokenSource();
         private readonly CancellationTokenSource _stepCancellationTokenSource = new CancellationTokenSource();
-        private bool _canProduce;
+        private bool _canProduce = true;
 
         protected BaseLoopBlockProducer(
             IPendingTxSelector pendingTxSelector,","I had some nasty forks with this true as default when syncing pre-existing networks, this is under investigation",.cs,0,0,1
"@@ -259,7 +259,7 @@ namespace OpenTelemetry.Context.Propagation
                 return Convert.ToByte(c);
             }
 
-            throw new ArgumentOutOfRangeException(nameof(c), $""Invalid character: {c}."");
+            throw new ArgumentOutOfRangeException(nameof(c), c, $""Invalid character: {c}."");
         }
     }
 }",A general question - do we want all the exception messages to be ended with period `.` or not. I don't have strong opinion on either way. I would suggest that we 1) follow the .NET convention (if there is one) and 2) make it consistent in this repo.,.cs,1,1,1
"@@ -22,13 +22,15 @@ namespace Datadog.Trace.ClrProfiler.Integrations
         /// <summary>
         /// Type for unobtrusive hooking into Microsoft.AspNetCore.Mvc.Core pipeline.
         /// </summary>
-        private const string DiagnosticSource = ""Microsoft.AspNetCore.Mvc.Internal.MvcCoreDiagnosticSourceExtensions"";
+        private const string DiagnosticSourceTypeName = ""Microsoft.AspNetCore.Mvc.Internal.MvcCoreDiagnosticSourceExtensions"";
 
         /// <summary>
         /// Base type used for traversing the pipeline in Microsoft.AspNetCore.Mvc.Core.
         /// </summary>
-        private const string ResourceInvoker = ""Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker"";
+        private const string ResourceInvokerTypeName = ""Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker"";
 
+        private static readonly Type DiagnosticSourceType = Type.GetType($""{DiagnosticSourceTypeName}, {AspnetMvcCore}"");
+        private static readonly Type ResourceInvokerType = Type.GetType($""{ResourceInvokerTypeName}, {AspnetMvcCore}"");
         private static readonly ILog Log = LogProvider.GetLogger(typeof(AspNetCoreMvc2Integration));
 
         private readonly object _httpContext;","I like the `TypeName` postfix for clarity, I'm going to adopt that.",.cs,1,1,1
"@@ -23,6 +23,11 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Internal
 
         private static readonly Action<object, object> _postCallbackAdapter = (callback, state) => ((Action<object>)callback).Invoke(state);
         private static readonly Action<object, object> _postAsyncCallbackAdapter = (callback, state) => ((Action<object>)callback).Invoke(state);
+        private static readonly Libuv.uv_walk_cb _heartbeatWalkCallback = (ptr, arg) =>
+        {
+            var handle = UvMemory.FromIntPtr<UvHandle>(ptr);
+            (handle as UvStreamHandle)?.Connection?.Tick((long)arg);
+        };
 
         // maximum times the work queues swapped and are processed in a single pass
         // as completing a task may immediately have write data to put on the network",nit: call it `_heartbeatWalkCallbackAdapter` to be consistent with the other ones.,.cs,1,1,1
"@@ -32,7 +32,7 @@ namespace OpenTelemetry.Exporter
     /// Exporter consuming <see cref=""Metric""/> and exporting the data using
     /// the OpenTelemetry protocol (OTLP).
     /// </summary>
-    [AggregationTemporality(AggregationTemporality.Both, AggregationTemporality.Cumulative)]
+    [AggregationTemporality(AggregationTemporality.Cumulative | AggregationTemporality.Delta, AggregationTemporality.Cumulative)]
     public class OtlpMetricsExporter : BaseOtlpExporter<Metric>
     {
         private readonly OtlpCollector.MetricsService.IMetricsServiceClient metricsClient;","Not related to this PR, but I'm not following why the OTLP exporter is marked to prefer `Cumulative`. Seems to me the OTLP exporter should effectively not have a preference. For a given service, is it currently not possible for some metrics to have a cumulative aggregation and others to have a delta aggregation?",.cs,0,1,1
"@@ -13,12 +13,12 @@ namespace Datadog.Trace
     /// all newly created spans that are not created with the ignoreActiveSpan
     /// parameter will be automatically children of the active span.
     /// </summary>
-    public class Scope : IDisposable
+    public class Scope : IScope
     {
         private readonly IScopeManager _scopeManager;
         private readonly bool _finishOnClose;
 
-        internal Scope(Scope parent, Span span, IScopeManager scopeManager, bool finishOnClose)
+        internal Scope(Scope parent, ISpan span, IScopeManager scopeManager, bool finishOnClose)
         {
             Parent = parent;
             Span = span;","In the latest set of commits, I removed the member `Scope.InternalSpan` so the change is only that `Scope.Span` has type `ISpan`. This should remove concerns about nullability. Now at runtime we still don't know what runtime type `Scope.Span` actually is, so we have to test against `Scope.Span is Span` returning a null or non-null value",.cs,1,1,1
"@@ -348,6 +348,12 @@ namespace OpenTelemetry.Internal
             this.WriteEvent(35, methodName, ex);
         }
 
+        [Event(36, Message = ""Measurement dropped from Instrument Name/Metric Stream Name '{0}'. Reason: '{1}'. Suggested action: '{2}'"", Level = EventLevel.Warning)]
+        public void MeasurementDropped(string instrumentName, string reason, string fix)
+        {
+            this.WriteEvent(36, instrumentName, reason, fix);
+        }
+
 #if DEBUG
         public class OpenTelemetryEventListener : EventListener
         {","I really like this message. Includes what happened, why, and a potential fix  ",.cs,1,0,1
"@@ -90,8 +90,8 @@ namespace Nethermind.Baseline.Test
                 transaction.SenderAddress = key.Address;
                 ecdsa.Sign(key, transaction, true);
                 transaction.Hash = transaction.CalculateHash();
-                AddTxResult result = testRpc.TxPool.SubmitTx(transaction, TxHandlingOptions.None);
-                if (result != AddTxResult.Added)
+                AcceptTxResult result = testRpc.TxPool.SubmitTx(transaction, TxHandlingOptions.None);
+                if (!result.Equals(AcceptTxResult.Accepted))
                 {
                     throw new Exception(""failed to add "" + result);
                 }",implicit bool cast,.cs,1,0,0
"@@ -144,12 +144,17 @@ namespace pwiz.Skyline.Model.Irt
         {
             RequireUsable();
 
-            var returnStandard = peptides.Where(_database.IsStandard).Distinct().ToArray();
+            var pepArr = peptides.ToArray();
+            var returnStandard = pepArr.Where(_database.IsStandard).Distinct().ToArray();
             var returnCount = returnStandard.Length;
             var databaseCount = _database.StandardPeptideCount;
 
             if (!IsAcceptableStandardCount(databaseCount, returnCount))
+            {
+                Console.Out.WriteLine(@""Database standards: {0}"", string.Join(@""; "", _database.StandardPeptides.Select(pep => pep.ToString())));
+                Console.Out.WriteLine(@""Chosen ({0}): {1}"", pepArr.Length, string.Join(@""; "", pepArr.Select(pep => pep.ToString())));
                 throw new IncompleteStandardException(this);
+            }
 
             minCount = MinStandardCount(databaseCount);
             return returnStandard;","The pep.ToString() is not necessary. You can just do: string.Join(@""; "", _database.StandardPeptides)",.cs,1,1,1
"@@ -100,8 +100,15 @@ namespace Nethermind.Runner.Ethereum.Steps
             _ctx.SyncPeerPool = new SyncPeerPool(_ctx.BlockTree, _ctx.NodeStatsManager, maxPeersCount, _ctx.LogManager);
             _ctx.DisposeStack.Push(_ctx.SyncPeerPool);
             
-            SyncProgressResolver syncProgressResolver = new SyncProgressResolver(_ctx.BlockTree, _ctx.ReceiptStorage, _ctx.DbProvider.StateDb, _syncConfig, _ctx.LogManager);
+            SyncProgressResolver syncProgressResolver = new SyncProgressResolver(_ctx.BlockTree, _ctx.ReceiptStorage, _ctx.DbProvider.StateDb, _ctx.DbProvider.BeamStateDb, _syncConfig, _ctx.LogManager);
             MultiSyncModeSelector syncModeSelector = new MultiSyncModeSelector(syncProgressResolver, _ctx.SyncPeerPool, _syncConfig, _ctx.LogManager);
+            if (_ctx.SyncModeSelector != null)
+            {
+                // this is really bad and is a result of lack of proper dependency management
+                PendingSyncModeSelector pendingOne = (PendingSyncModeSelector) _ctx.SyncModeSelector;
+                pendingOne.SetActual(syncModeSelector);
+            }
+            
             _ctx.SyncModeSelector = syncModeSelector;
             _ctx.DisposeStack.Push(syncModeSelector);
             ",maybe just inject delegate to BeaSyncDb in the first place? Or SyncModeSelectorSource ;),.cs,1,1,1
"@@ -75,7 +75,7 @@ namespace NLog.Targets
         /// <value>The endpoint address.</value>
         /// <docgen category='Connection Options' order='10' />
         [RequiredParameter]
-        public string EndpointAddress { get; set; }
+        public virtual string EndpointAddress { get; set; }
 
 #if WCF_SUPPORTED
         /// <summary>",This is the only line that should change. Ignore any other file changes.,.cs,1,0,1
"@@ -10,10 +10,13 @@ using Microsoft.AspNetCore.Server.Kestrel.Filter;
 using Microsoft.AspNetCore.Server.Kestrel.Filter.Internal;
 using Microsoft.AspNetCore.Server.Kestrel.Internal.Infrastructure;
 using Microsoft.AspNetCore.Server.Kestrel.Internal.Networking;
+using Microsoft.Extensions.Internal;
 using Microsoft.Extensions.Logging;
 
 namespace Microsoft.AspNetCore.Server.Kestrel.Internal.Http
 {
+    using System.IO.Pipelines;
+
     public class Connection : ConnectionContext, IConnectionControl
     {
         // Base32 encoding - in ascii sort order for easy text based sorting",nit: move `using` outside of namespace,.cs,1,1,1
"@@ -58,11 +58,12 @@ namespace Datadog.Trace.Ci
                 // Clean branch name
                 if (!string.IsNullOrEmpty(Branch))
                 {
-                    var regex = new Regex(@""^refs\/heads\/(.*)|refs\/(.*)$"", RegexOptions.Compiled);
+                    var regex = new Regex(@""^refs\/heads\/(.*)|refs\/tags\/(.*)|refs\/(.*)$"", RegexOptions.Compiled);
                     var match = regex.Match(Branch);
-                    if (match.Success && match.Groups.Count == 3)
+                    if (match.Success && match.Groups.Count == 4)
                     {
-                        Branch = !string.IsNullOrWhiteSpace(match.Groups[1].Value) ? match.Groups[1].Value : match.Groups[2].Value;
+                        Branch = !string.IsNullOrWhiteSpace(match.Groups[1].Value) ? match.Groups[1].Value : match.Groups[3].Value;
+                        Tag = match.Groups[2].Value;
                     }
                 }
             }","As the number of groups is increasing, you should consider using named groups for better readability",.cs,1,1,1
"@@ -63,7 +63,7 @@ namespace Nethermind.HealthChecks
                     args: new object[] { _nodeHealthService });
             if (_healthChecksConfig.UIEnabled)
             {
-                service.AddHealthChecksUI(setup =>
+                service.AddHealthChecksUI(setupSettings: setup =>
                 {
                     setup.AddHealthCheckEndpoint(""health"", BuildEndpointForUi());
                     setup.SetEvaluationTimeInSeconds(_healthChecksConfig.PollingInterval);","This change was necessary because of the upgrade from `AspNetCore.HealthChecks.UI` 3.x to 5.x. I am not actually familiar with this syntax so I don't know what it is doing, but whatever it is doing it seemed to be necessary for things to compile.  ",.cs,1,1,1
"@@ -86,6 +86,12 @@ namespace Nethermind.Db.Config
         public uint EthRequestsDbWriteBufferNumber { get; set; } = 4;
         public ulong EthRequestsDbBlockCacheSize { get; set; } = 8.MB();
         public bool EthRequestsDbCacheIndexAndFilterBlocks { get; set; } = true;
+        
+        public ulong BloomDbWriteBufferSize { get; set; } = 1.KB();
+        public uint BloomDbWriteBufferNumber { get; set; } = 4;
+        public ulong BloomDbBlockCacheSize { get; set; } = 1.KB();
+        public bool BloomDbCacheIndexAndFilterBlocks { get; set; } = false;
+        
         public uint RecycleLogFileNum { get; set; } = 0;
         public bool WriteAheadLogSync { get; set; } = false;
     }",why so small?,.cs,1,0,1
"@@ -178,6 +178,16 @@ namespace OpenTelemetry.Metrics
                         }
                     }
                 };
+
+                // Everything double
+                this.listener.SetMeasurementEventCallback<double>((instrument, value, tags, state) => this.MeasurementRecordedDouble(instrument, value, tags, state));
+                this.listener.SetMeasurementEventCallback<float>((instrument, value, tags, state) => this.MeasurementRecordedDouble(instrument, value, tags, state));
+
+                // Everything long
+                this.listener.SetMeasurementEventCallback<long>((instrument, value, tags, state) => this.MeasurementRecordedLong(instrument, value, tags, state));
+                this.listener.SetMeasurementEventCallback<int>((instrument, value, tags, state) => this.MeasurementRecordedLong(instrument, value, tags, state));
+                this.listener.SetMeasurementEventCallback<short>((instrument, value, tags, state) => this.MeasurementRecordedLong(instrument, value, tags, state));
+                this.listener.SetMeasurementEventCallback<byte>((instrument, value, tags, state) => this.MeasurementRecordedLong(instrument, value, tags, state));
             }
             else
             {",if (metrics.Count ==1) { metrics[0].Update() } else { do foreach.. },.cs,1,0,0
"@@ -200,11 +200,11 @@ namespace Nethermind.Network.P2P.Subprotocols.Eth.V62
                 Transaction tx = transactions[i];
                 tx.DeliveredBy = Node.Id;
                 tx.Timestamp = _timestamper.UnixTime.Seconds;
-                AddTxResult result = _txPool.SubmitTx(tx, TxHandlingOptions.None);
-                _floodController.Report(result == AddTxResult.Added);
+                AcceptTxResult acceptTxResult = _txPool.SubmitTx(tx, TxHandlingOptions.None);
+                _floodController.Report(acceptTxResult.Equals(AcceptTxResult.Accepted));
 
                 if (Logger.IsTrace) Logger.Trace(
-                    $""{Node:c} sent {tx.Hash} tx and it was {result} (chain ID = {tx.Signature?.ChainId})"");
+                    $""{Node:c} sent {tx.Hash} tx and it was {acceptTxResult.ToString()} (chain ID = {tx.Signature?.ChainId})"");
             }
         }
 ",implicit bool cast,.cs,1,0,0
"@@ -358,6 +358,11 @@ namespace NLog.Targets.Wrappers
         /// </summary>
         /// <returns>Returns true when scheduled a timer-worker-thread</returns>
         protected virtual bool StartInstantWriterTimer()
+        {
+            return StartTimerUnlessWriterActive(true);
+        }
+
+        private bool StartTimerUnlessWriterActive(bool instant)
         {
             bool lockTaken = false;
             try",shouldn't we return `true` here?,.cs,1,0,1
"@@ -406,6 +406,8 @@ namespace Nethermind.State
                     Set(cellByAddress.Key, _zeroValue);
                 }
             }
+
+            _storages[address] = new StorageTree(_stateDb, Keccak.EmptyTreeHash);
         }
 
         private enum ChangeType",this is the fix,.cs,1,0,0
"@@ -13,7 +13,7 @@ namespace MvvmCross.Platforms.Android.Views
         Intent GetIntentFor(MvxViewModelRequest request);
 
         // Important: if calling GetIntentWithKeyFor then you must later call RemoveSubViewModelWithKey on the returned key
-        Tuple<Intent, int> GetIntentWithKeyFor(IMvxViewModel existingViewModelToUse);
+        (Intent Intent, int Key) GetIntentWithKeyFor(IMvxViewModel existingViewModelToUse, MvxViewModelRequest request);
 
         void RemoveSubViewModelWithKey(int key);
     }",Please lowercase return names.,.cs,1,1,1
"@@ -0,0 +1,10 @@
+﻿namespace Microsoft.Azure.Cosmos.CosmosElements
+{
+    internal abstract class CosmosNull : CosmosElement
+    {
+        protected CosmosNull()
+            : base(CosmosElementType.Null)
+        {
+        }
+    }
+}",does this class (also Boolean) need to be abstract?,.cs,1,1,1
"@@ -36,13 +36,13 @@ namespace pwiz.Skyline.Model
         public abstract string[] FragmentIons { get; }
         public abstract string EngineName { get; }
         public abstract Bitmap SearchEngineLogo { get; }
-        protected MsDataFileUri[] SpectrumFileNames { get; set; }
+        public MsDataFileUri[] SpectrumFileNames { get; protected set; }
         protected string[] FastaFileNames { get; set; }
 
         /// <summary>
         /// A string or numeric variable with a default value and, for numeric types, min and max values.
         /// </summary>
-        public class Setting
+        public class Setting : IAuditLogObject
         {
             public Setting(string name, int defaultValue, int minValue, int maxValue)
             {","I am not an expert on audit log objects, but I was under the impression that if a class had a self-describing ToString method, it would not need to implement IAuditLogObject.",.cs,1,1,1
"@@ -16,6 +16,7 @@
 
 using System.Runtime.CompilerServices;
 
+[assembly: InternalsVisibleTo(""OpenTelemetry"" + AssemblyInfo.PublicKey)]
 [assembly: InternalsVisibleTo(""OpenTelemetry.Tests"" + AssemblyInfo.PublicKey)]
 [assembly: InternalsVisibleTo(""OpenTelemetry.Shims.OpenTracing.Tests"" + AssemblyInfo.PublicKey)]
 [assembly: InternalsVisibleTo(""DynamicProxyGenAssembly2"" + AssemblyInfo.MoqPublicKey)]",which particular class/api is triggering this change? can we keep using shared file approach instead?,.cs,1,1,1
"@@ -30,8 +30,8 @@ namespace OpenTelemetry.Trace
         private readonly ActivityListener listener;
         private readonly Resource resource;
         private readonly Sampler sampler;
+        private readonly ActivitySourceAdapter adapter;
         private BaseProcessor<Activity> processor;
-        private ActivitySourceAdapter adapter;
 
         static TracerProviderSdk()
         {","Unrelated, VS was suggesting to make `ActivitySourceAdapter` readonly so I cleaned it up.",.cs,0,0,1
"@@ -52,6 +52,8 @@ namespace Nethermind.Runner.Ethereum.Steps
 
                 JsonRpcService jsonRpcService = new(_api.RpcModuleProvider, _api.LogManager);
 
+                _api.EthereumJsonSerializer.RegisterConverters(jsonRpcService.Converters);
+                
                 JsonRpcProcessor jsonRpcProcessor = new(
                     jsonRpcService,
                     _api.EthereumJsonSerializer,",This change will register JSON RPC converters for the API serializer that is used in multiple places. Is it OK ? HTTP JSON RPC uses own instance of the serializer. Maybe we should do the same for the sockets or share the same instance with the HTTP module ?,.cs,1,1,1
"@@ -47,7 +47,7 @@ namespace TestPerf // Note: tests in the ""TestPerf"" namespace only run when the
         public void WatersIMSImportTest()
         {
             Log.AddMemoryAppender();
-            TestFilesZip = GetPerfTestDataURL(@""PerfImportResultsWatersIMS.zip"");
+            TestFilesZip = GetPerfTestDataURL(@""PerfImportResultsWatersIMSv2.zip""); // v2 has _func003.cdt file removed, to test our former assumption that lockmass would have IMS data if other functions did and vice verse
             TestFilesPersistent = new[] { ""ID12692_01_UCA168_3727_040714.raw"", ""ID12692_01_UCA168_3727_040714_IA_final_fragment.csv"" }; // List of files that we'd like to unzip alongside parent zipFile, and (re)use in place
 
             MsDataFileImpl.PerfUtilFactory.IssueDummyPerfUtils = false; // Turn on performance measurement",Does this leave other tests still testing that the lockmass-with-IMS test still works?,.cs,1,1,1
"@@ -188,12 +188,13 @@ namespace Microsoft.CodeAnalysis.Sarif.Converters
         {
             var context = TestHelper.CreateProjectContext();
 
-            context.RefineMessage(""CA0000"", ""VeryUsefulCheck"", ""1"", ""MyCategory"", ""Breaking"");
+            context.RefineMessage(""CA0000"", ""VeryUsefulCheck"", ""1"", ""MyCategory"", ""Breaking"", ""ExcludedInSource"");
             Assert.AreEqual(""CA0000"", context.CheckId);
             Assert.AreEqual(""1"", context.MessageId);
             Assert.AreEqual(""MyCategory"", context.Category);
             Assert.AreEqual(""VeryUsefulCheck"", context.Typename);
             Assert.AreEqual(""Breaking"", context.FixCategory);
+            Assert.AreEqual(""ExcludedInSource"", context.Status);
         }
 
         [TestMethod]","I thought we had names `""Unknown""`, `""SuppressedInSource""`, and `""SuppressedInBaseLine""`.",.cs,1,0,1
"@@ -29,7 +29,7 @@ namespace ScenarioMeasurement
         /// <param name=""logFileName"">optional log file. Default is appExe.startup.log</param>
         /// <param name=""workingDir"">optional working directory</param>
         /// <param name=""warmup"">enables/disables warmup iteration</param>
-        /// <param name=""traceFileName"">trace file name</param>
+        /// <param name=""traceName"">trace file name</param>
         /// <param name=""guiApp"">true: app under test is a GUI app, false: console</param>
         /// <param name=""skipProfileIteration"">true: skip full results iteration</param>
         /// <param name=""reportJsonPath"">path to save report json</param>",Did the semantics of this variable change or is this just a cosmetic change?,.cs,1,1,1
"@@ -39,8 +39,8 @@ namespace OpenTelemetry.Trace
         /// <summary>
         /// Adds given activitysource names to the list of subscribed sources.
         /// </summary>
-        /// <param name=""names"">Activity source names.</param>
+        /// <param name=""sources"">Activity source names.</param>
         /// <returns>Returns <see cref=""TracerProviderBuilder""/> for chaining.</returns>
-        public abstract TracerProviderBuilder AddSource(params string[] names);
+        public abstract TracerProviderBuilder AddSource(params Source[] sources);
     }
 }","We can keep the string version as well, and internally convert that to use Source. Most users don't care about Version, so they can use the easy version.",.cs,1,1,1
"@@ -24,6 +24,11 @@ namespace OpenTelemetry.Metrics
     {
         private string name;
 
+        public MetricConsoleExporter()
+            : this(string.Empty)
+        {
+        }
+
         public MetricConsoleExporter(string name)
         {
             this.name = name;",It is a bit confusing to have the exporter class derived from processor class. Not introduced by this PR so no need to block on it.,.cs,0,1,1
"@@ -1,4 +1,7 @@
-﻿using System;
+﻿// Copyright (c) Microsoft Corporation. All rights reserved.
+// Licensed under the MIT license. See LICENSE file in the project root for full license information.
+
+using System;
 using System.Collections.Generic;
 using System.Linq;
 using System.Threading.Tasks;",Nitpick : Put using statements inside namespace declaration.,.cs,1,1,1
"@@ -1,12 +1,19 @@
 // Copyright (c) .NET Foundation. All rights reserved.
 // Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.
 
+using System;
 using Microsoft.AspNetCore.Server.Kestrel.Filter;
 
 namespace Microsoft.AspNetCore.Server.Kestrel
 {
     public interface IKestrelServerInformation
     {
+        TimeSpan ExecutionTimeout { get; set; }
+
+        TimeSpan HeadersCompleteTimeout { get; set; }
+
+        TimeSpan KeepAliveTimeout { get; set; }
+
         int ThreadCount { get; set; }
 
         bool NoDelay { get; set; }","KeepAlive and HeadersComplete are reasonable, but I don't think we need or want ExecutionTimeout at the server level. A) The same functionality can be provided in app/middleware code. B) The timeout is un-enforceable. You can't force an app to abandon a request, you can only close the socket and trip the token. The RequestAborted CancellationToken is at best a hint. There are no thread aborts like v4. C) There are known scenarios this breaks with long running requests. It's one more setting on the server to hunt down and fiddle with when that happens.",.cs,1,1,0
"@@ -5,12 +5,13 @@ using System;
 using System.IO;
 using System.Threading;
 using System.Threading.Tasks;
-using Microsoft.Extensions.Internal;
 
 namespace Microsoft.AspNetCore.Server.Kestrel.Https.Internal
 {
     internal class ClosedStream : Stream
     {
+        private static readonly Task<int> CompletedIntTask = Task.FromResult(default(int));
+
         public override bool CanRead => true;
         public override bool CanSeek => false;
         public override bool CanWrite => false;",That's pretty weird isn't it? Its explicitly a zero return - rather than a `default(int)`; also `CompletedIntTask` doesn't really specify what it is.,.cs,1,1,1
"@@ -47,7 +47,7 @@ namespace pwiz.SkylineTestData
         {
             var testFilesDir = new TestFilesDir(TestContext, ZIP_PATH);
             string docPath = testFilesDir.GetTestPath(DOC_NAME);
-            string rawPath = testFilesDir.GetTestPath(WIFF_NAME);
+            string rawPath = testFilesDir.GetTestPath(WIFF_NAME) ?? string.Empty;
             
             RunCommand(""--in="" + docPath,
                 ""--import-file="" + rawPath,","I am really feeling like we need something better than just adding all these ?? string.Empty uses. Could we maybe add a function which would have an explanation of its use, like PathEx.SafePath(). It might not even have to use string.Empty but could just Assume.IsNotNull(path); return path; This would actually be better, because it is more explicit about what the expectation is. In these changes you are making, if you are wrong about the assumption, then the code will behave in strange unexpected ways.",.cs,1,1,0
"@@ -21,8 +21,8 @@ namespace MvvmCross.Droid.Shared.Presenter
     {
         public const string ViewModelRequestBundleKey = ""__mvxViewModelRequest"";
 
-        private readonly FragmentHostRegistrationSettings _fragmentHostRegistrationSettings;
-        private readonly Lazy<IMvxNavigationSerializer> _lazyNavigationSerializerFactory;
+        protected FragmentHostRegistrationSettings _fragmentHostRegistrationSettings;
+        protected Lazy<IMvxNavigationSerializer> _lazyNavigationSerializerFactory;
 
         protected IMvxNavigationSerializer Serializer => _lazyNavigationSerializerFactory.Value;
 ",I would leave these as `private readonly` and just expose them as a protected property unless we want them to be assigned outside of the constructor.,.cs,1,1,1
"@@ -0,0 +1,14 @@
+// <copyright file=""OSPlatforms.cs"" company=""Datadog"">
+// Unless explicitly stated otherwise all files in this repository are licensed under the Apache 2 License.
+// This product includes software developed at Datadog (https://www.datadoghq.com/). Copyright 2017 Datadog, Inc.
+// </copyright>
+
+namespace Datadog.Trace
+{
+    internal static class OSPlatforms
+    {
+        public const string Windows = ""Windows"";
+        public const string Linux = ""Linux"";
+        public const string MacOS = ""MacOS"";
+    }
+}","Really small nit, I suggest removing the ""s"" so it's singular: `OSPlatform`",.cs,1,1,1
"@@ -1,9 +1,7 @@
 #if !NETSTANDARD2_0
 
 using System;
-using System.Diagnostics.CodeAnalysis;
 using System.Web;
-using Datadog.Trace.ClrProfiler.Emit;
 using Datadog.Trace.Logging;
 
 namespace Datadog.Trace.ClrProfiler.Integrations",Let's delete this file. We're not using `AspNetIntegration`.,.cs,1,1,1
"@@ -406,6 +406,11 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http2
                 throw new Http2ConnectionErrorException(Http2ErrorCode.PROTOCOL_ERROR);
             }
 
+            if (_incomingFrame.StreamId != 0)
+            {
+                throw new Http2ConnectionErrorException(Http2ErrorCode.PROTOCOL_ERROR);
+            }
+
             Stop();
             return Task.CompletedTask;
         }",For our logging purposes we should include messages describing these errors.,.cs,1,1,1
"@@ -5,14 +5,13 @@
 using Microsoft.Build.Framework;
 using Microsoft.DotNet.VersionTools.Automation;
 using System.Diagnostics;
-using System.Linq;
 
 namespace Microsoft.DotNet.Build.Tasks.VersionTools
 {
     public class LocalUpdatePublishedVersions : BuildTask
     {
         [Required]
-        public ITaskItem[] ShippedNuGetPackage { get; set; }
+        public string[] ShippedNuGetPackage { get; set; }
 
         [Required]
         public string VersionsRepoLocalBaseDir { get; set; }",Why the switch to string[]? This potentially break users of this task.,.cs,1,1,1
"@@ -22,7 +22,7 @@ namespace Nethermind.Network.Config
         public string LocalIp { get; set; }
         public string StaticPeers { get; set; }
         public bool OnlyStaticPeers { get; set; }
-        public string TrustedPeers { get; set; } = string.Empty;
+        public string TrustedPeers { get; set; } = null;
         public bool IsPeersPersistenceOn { get; set; } = true;
         public int ActivePeersMaxCount { get; set; } = 50;
         public int PeersPersistenceInterval { get; set; } = 1000 * 5;",I think this change may cause trouble in other parts of the system,.cs,1,0,1
"@@ -34,7 +34,8 @@ namespace Microsoft.CodeAnalysis.Sarif.Writers
         [TestMethod]
         public void ResultLogJsonWriter_DefaultIsEmpty()
         {
-            Assert.AreEqual(String.Empty, GetJson(delegate { }));
+            string expected = @""{""""version"""":""""1.0.0-beta.1"""",""""runLogs"""":[{}]}"";
+            Assert.AreEqual(expected, GetJson(delegate { }));
         }
 
         [TestMethod]","Is it ""beta.1""? I thought we were now ""beta.2"" after the big-breaking-change.",.cs,1,1,1
"@@ -0,0 +1,17 @@
+// Copyright (c) Microsoft.  All Rights Reserved.
+// Licensed under the Apache License, Version 2.0.  See License.txt in the project root for license information.
+
+using System.CodeDom.Compiler;
+
+namespace Microsoft.CodeAnalysis.Sarif
+{
+    /// <summary>
+    /// Indicates whether a result has been suppressed in source (or if that information is unknown).
+    /// </summary>
+    [GeneratedCode(""Microsoft.Json.Schema.ToDotNet"", ""0.16.0.0"")]
+    public enum IsSuppressedInSource
+    {
+        Unknown,
+        True,False
+    }
+}","I'm intrigued that the code gen put those on the same line. Not crazy about the names. How about: type = SourceSuppressionState, with values Unknown, Suppressed, NotSuppressed?",.cs,1,1,1
"@@ -0,0 +1,13 @@
+using Nethermind.Abi;
+
+namespace Nethermind.Baseline
+{
+    public static class ContractMerkleTree
+    {
+        public static readonly AbiSignature InsertLeafAbiSig = new AbiSignature(""insertLeaf"",
+            new AbiBytes(32)); // leafValue
+        
+        public static AbiSignature InsertLeavesAbiSig = new AbiSignature(""insertLeaves"",
+            new AbiArray(new AbiBytes(32))); // leafValues
+    }
+}",I suggest using AbiDefinition and parsing json ABI like in Contracts in AuRa,.cs,1,1,1
"@@ -115,6 +115,11 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Core.Adapter.Internal
                 var readableBuffer = result.Buffer;
                 try
                 {
+                    if (result.IsCompleted)
+                    {
+                        return 0;
+                    }
+
                     if (!readableBuffer.IsEmpty)
                     {
                         var count = Math.Min(readableBuffer.Length, buffer.Count);",If we want to make this similar to the request and response streams both read and write should throw.,.cs,1,1,1
"@@ -26,9 +26,10 @@ namespace DockerHarness
         }
     }
 
-    // A simple class for escaping strings for CSV writing
-    // https://stackoverflow.com/a/769713
-    // Used instead of a package because only these < 20 lines of code are needed
+    /// <summary>
+    ///   A simple class for escaping strings for CSV writing
+    ///   https://stackoverflow.com/a/769713
+    /// </summary>
     internal static class Csv
     {
         public static string Escape(string s)",">internal static class Csv [](start = 4, length = 25) Can we use an existing Csv parser instead of creating our own?",.cs,1,1,1
"@@ -1,4 +1,4 @@
-﻿#if NETSTANDARD && !NETSTANDARD1_3
+﻿#if NETSTANDARD && UWP10
 using System;
 using System.Collections.Generic;
 using System.IO;",UWP10 isn't necessary anymore?,.cs,1,0,1
"@@ -3,8 +3,9 @@
 // See the LICENSE file in the project root for more information.
 
 using System;
-using System.Collections.Generic;
 using System.IO;
+using System.Text;
+using System.Threading;
 using Microsoft.Build.Framework;
 using Microsoft.Build.Utilities;
 using Newtonsoft.Json;",You can probably revert this whole file. None of the changes here look substantive.,.cs,1,1,1
"@@ -174,7 +174,11 @@ namespace Microsoft.CodeAnalysis.Sarif
             }
         }
 
-        public static string GetMessageText(this Result result, IRule rule, bool concise = false)
+        public static string GetMessageText(this Result result, IRule rule)
+        {
+            return GetMessageText(result, rule, concise: false);
+        }
+        public static string GetMessageText(this Result result, IRule rule, bool concise)
         {
             if (result == null)
             {",The purpose is to allow the _caller_ to pass in `consise = true;`. I'll come see you about this one.,.cs,0,0,1
"@@ -0,0 +1,18 @@
+namespace Datadog.Trace
+{
+    /// <summary>
+    /// Contains a set of standard operation names that can be used by integrations.
+    /// </summary>
+    public static class OperationNames
+    {
+        /// <summary>
+        /// Gets the operation name for an ASP.NET MVC web request.
+        /// </summary>
+        public static string AspNetMvcRequest => ""aspnet_mvc.request"";
+
+        /// <summary>
+        /// Gets the operation name for an ASP.NET Core MVC web request.
+        /// </summary>
+        public static string AspNetCoreMvcRequest => ""aspnet_core_mvc.request"";
+    }
+}","This is really integration specific, would it make more sense to have it as a constant in the integration itself?",.cs,1,1,1
"@@ -147,8 +147,8 @@ namespace Nethermind.Blockchain.Synchronization
             receipt.TxHash = transaction.Hash;
             receipt.Index = transactionIndex;
             receipt.Sender = transaction.SenderAddress;
-            receipt.Recipient = transaction.IsContractCreation ? null : transaction.To;
-            receipt.ContractAddress = transaction.IsContractCreation ? transaction.To : null;
+            receipt.Recipient = transaction.GetRecipient();
+            receipt.ContractAddress = transaction.GetCreatedContract();
             receipt.GasUsed = receipt.GasUsedTotal - gasUsedBefore;
             if (receipt.StatusCode != StatusCode.Success)
             {",this is actually all incorrect here for created contract - created contract is not the To field,.cs,1,1,1
"@@ -78,8 +78,9 @@ namespace NLog.Internal
         /// </summary>
         /// <param name=""exception"">The exception to check.</param>
         /// <param name=""loggerContext"">Target context of the exception.</param>
+        /// <param name=""logFactory"">For checking <see cref=""LogFactory.ThrowExceptions""/> and <see cref=""LogFactory.ThrowConfigExceptions""/>. Falls back to <see cref=""LogManager""/> </param>
         /// <returns><c>true</c>if the <paramref name=""exception""/> must be rethrown, <c>false</c> otherwise.</returns>
-        public static bool MustBeRethrown(this Exception exception, IInternalLoggerContext loggerContext = null)
+        public static bool MustBeRethrown(this Exception exception, IInternalLoggerContext loggerContext = null, LogFactory logFactory = null)
         {
             if (exception.MustBeRethrownImmediately())
             {","Maybe add LoggingConfiguration as property to `IInternalLoggerContext`, and then extract the LogFactory from that? When InternalLogger-logging is improved with Nlog 5, then it will all work automagically.",.cs,1,1,1
"@@ -85,7 +85,7 @@ CLI access is not currently included in the Nethermind launcher but will be adde
 
             Console.WriteLine(result);
             File.WriteAllText(""cli.rst"", result);
-            File.WriteAllText(""../../../../../../docs/source/cli.rst"", result);
+            File.WriteAllText(""../../../docs/source/cli.rst"", result);
         }
     }
 }",why did you need to change the folder structure? will it still work when invoked manually?,.cs,1,1,1
"@@ -38,7 +38,16 @@ namespace OpenTelemetry.Trace
                 throw new ArgumentNullException(nameof(builder));
             }
 
-            var exporterOptions = new JaegerExporterOptions();
+            JaegerExporterOptions exporterOptions;
+            if (builder is IResolvingTracerProviderBuilder resolvingTracerProviderBuilder)
+            {
+                exporterOptions = resolvingTracerProviderBuilder.ResolveOptions<JaegerExporterOptions>();
+            }
+            else
+            {
+                exporterOptions = new JaegerExporterOptions();
+            }
+
             configure?.Invoke(exporterOptions);
             var jaegerExporter = new JaegerExporter(exporterOptions);
 ",Here is an example of how something like JaegerExporter can use IResolvingTracerProviderBuilder to inject options.,.cs,1,1,1
"@@ -43,11 +43,6 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Internal.System.IO.Pipelines
             {
                 var part = _enumerator.Current;
 
-                if (_end)
-                {
-                    return new ReadCursor(part.Segment, part.Start + _currentSpan.Length);
-                }
-
                 return new ReadCursor(part.Segment, part.Start + _index);
             }
         }","This is really strange, now when I look at it.",.cs,1,0,1
"@@ -15,7 +15,14 @@ namespace System.Diagnostics
         
         [Benchmark]
         public void GetCurrentProcess() => Process.GetCurrentProcess().Dispose();
-        
+
+        [Benchmark]
+        public string GetCurrentProcessName()
+        {
+            using var process = Process.GetCurrentProcess();
+            return process.ProcessName;
+        }
+
         [GlobalSetup(Target = nameof(GetProcessById))]
         public void SetupGetProcessById() => _currentProcessId = Process.GetCurrentProcess().Id;
         ",should we be including the cost of Dispose()? it does do some work but perhaps it's not significant. although I see the test above is doing that too.,.cs,1,1,1
"@@ -92,7 +92,7 @@ namespace pwiz.SkylineTestTutorial
         {
             // Lest we get ""To export a scheduled method, you must first choose a retention time predictor in Peptide Settings / Prediction, or import results for all peptides in the document.""
             TestSmallMolecules = false;
-
+            Settings.Default.AuditLogging = true;
             // Skyline Collision Energy Optimization
             RunUI(() => SkylineWindow.OpenFile(GetTestPath(""CE_Vantage_15mTorr.sky""))); // Not L10N
 ",Why do some tutorial tests have to set this an not others?,.cs,0,1,1
"@@ -461,6 +461,11 @@ namespace Nethermind.TxPool
             return transaction != null;
         }
 
+        public bool IsTransactionKnown(Keccak hash)
+        {
+            return _hashCache.Get(hash);
+        }
+
         // TODO: Ensure that nonce is always valid in case of sending own transactions from different nodes.
         public UInt256 ReserveOwnTransactionNonce(Address address)
         {",Now good question. Is know would be hashCashe? Or maybe we should only check actual held transactions? Or maybe we should also check DB?,.cs,1,1,0
"@@ -49,7 +49,11 @@ namespace Examples.Console
             */
             using var meterProvider = Sdk.CreateMeterProviderBuilder()
                 .AddSource(""TestMeter"")
-                .AddPrometheusExporter(opt => opt.Url = $""http://localhost:{port}/metrics/"")
+                .AddPrometheusExporter(opt =>
+                {
+                    opt.StartHttpListener = true;
+                    opt.HttpListenerPrefixes = new string[] { $""http://*:{port}/"" };
+                })
                 .Build();
 
             ObservableGauge<long> gauge = MyMeter.CreateObservableGauge<long>(","nit: there is a message printed to console showing the path where metrics is available, which still has /metrics in it..",.cs,1,1,1
"@@ -25,7 +25,9 @@ namespace Benchmarks.Trace
         {
             var settings = new TracerSettings { StartupDiagnosticLogEnabled = false };
 
+#pragma warning disable CS0618 // Setter isn't actually obsolete, just should be internal
             Tracer.Instance = new Tracer(settings, new DummyAgentWriter(), null, null, null);
+#pragma warning restore CS0618
 
             var builder = new WebHostBuilder()
                 .UseStartup<Startup>();",One way to avoid this warning could be to add an internal `SetTracer` method and use it instead,.cs,1,1,1
"@@ -26,9 +26,19 @@ namespace Datadog.Trace
         private readonly CultureInfo _invariantCulture = CultureInfo.InvariantCulture;
         private readonly IDatadogLogger _log = DatadogLogging.GetLoggerFor<SpanContextPropagator>();
         private readonly ConcurrentDictionary<Key, string?> _defaultTagMappingCache = new();
+        private readonly Func<IReadOnlyDictionary<string, string?>?, string, IEnumerable<string?>> _readOnlyDictionaryValueGetterDelegate;
 
         private SpanContextPropagator()
         {
+            IEnumerable<string?> ReadOnlyDictionaryValueGetter(IReadOnlyDictionary<string, string?>? carrier, string name)
+            {
+                if (carrier != null && carrier.TryGetValue(name, out var value))
+                {
+                    yield return value;
+                }
+            }
+
+            _readOnlyDictionaryValueGetterDelegate = ReadOnlyDictionaryValueGetter;
         }
 
         public static SpanContextPropagator Instance { get; } = new();",TODO: `yield return value` or `return new[] { value }`?,.cs,0,0,1
"@@ -1,15 +1,16 @@
 ﻿// Copyright (c) Microsoft Open Technologies, Inc. All rights reserved.
 // Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.
 
-using System;
-using System.Collections.Generic;
-using System.Threading.Tasks;
 using Microsoft.AspNet.Builder;
 using Microsoft.AspNet.FeatureModel;
 using Microsoft.AspNet.Hosting.Server;
 using Microsoft.AspNet.Server.Kestrel;
 using Microsoft.Framework.ConfigurationModel;
+using Microsoft.Framework.Logging;
 using Microsoft.Framework.Runtime;
+using System;
+using System.Collections.Generic;
+using System.Threading.Tasks;
 
 namespace Kestrel
 {",This is the wrong sort order for usings.,.cs,1,0,1
"@@ -150,7 +150,8 @@ namespace Datadog.Trace.TestHelpers
             int aspNetCorePort,
             int? statsdPort,
             string processPath,
-            StringDictionary environmentVariables)
+            StringDictionary environmentVariables,
+            bool ignoringProfilerProcesses = false)
         {
             var processName = processPath;
             string profilerEnabled = _requiresProfiling ? ""1"" : ""0"";","nit: should this be a command, ie. `ignoreProfilerProcesses`?",.cs,1,1,1
"@@ -0,0 +1,10 @@
+﻿namespace Microsoft.Azure.Cosmos.CosmosElements
+{
+    using System.IO;
+    using Microsoft.Azure.Cosmos.Json;
+
+    internal interface ILazyCosmosElement
+    {
+        void WriteToWriter(IJsonWriter jsonWriter);
+    }
+}","Lets use ""abstract class"" for consistency inside SDK.",.cs,1,1,1
"@@ -77,7 +77,7 @@ namespace Examples.Console
                 providerBuilder
                     .AddConsoleExporter(o =>
                     {
-                        o.MetricExportIntervalMilliseconds = options.DefaultCollectionPeriodMilliseconds;
+                        o.PeriodicExportingMetricReaderOptions.ExportIntervalMilliseconds = options.DefaultCollectionPeriodMilliseconds;
                         o.AggregationTemporality = options.IsDelta ? AggregationTemporality.Delta : AggregationTemporality.Cumulative;
                     });
             }",we need to set ReaderType to be periodic for this to take effect?,.cs,1,1,1
"@@ -40,6 +40,8 @@ namespace Nethermind.State
         
         Keccak GetCodeHash(Address address);
 
+        public bool IsContract(Address address) => GetCodeHash(address) != Keccak.OfAnEmptyString;
+
         void Accept(ITreeVisitor visitor, Keccak stateRoot);
         
         bool AccountExists(Address address);","this is generally not true, it is possible to deploy a contract with an empty code There should be a method called HasCode?",.cs,1,1,0
"@@ -0,0 +1,11 @@
+using Xamarin.Forms;
+
+[assembly: XmlnsDefinition(""http://mvvmcross.com/bind"", nameof(MvvmCross.Forms.Bindings))]
+[assembly: XmlnsDefinition(""http://mvvmcross.com/bind"", nameof(MvvmCross.Forms.Converters))]
+[assembly: XmlnsDefinition(""http://mvvmcross.com/bind"", nameof(MvvmCross.Forms.Views))]
+namespace MvvmCross.Forms
+{
+    internal class AssemblyInfo
+    {
+    }
+}",This won't work unless you also tell msbuild not to generate its own default AssemblyInfo file. Can we add these assembly things elsewhere?,.cs,1,1,1
"@@ -18,6 +18,7 @@
  */
 
 using System;
+using System.Globalization;
 using System.IO;
 using System.Linq;
 using System.Windows.Forms;",This is causing a code inspection failure.,.cs,1,1,1
"@@ -116,6 +116,11 @@ namespace OpenTelemetry.Trace
                 + ""}"";
         }
 
+        public override Type GetType()
+        {
+            return this.GetType();
+        }
+
         /// <inheritdoc/>
         public override TReturn Match<TReturn>(
             Func<string, TReturn> stringFunction,",is this needed?,.cs,1,0,0
"@@ -60,7 +60,10 @@ namespace MvvmCross.Forms.Platform.Ios.Core
                     Xamarin.Forms.Forms.Init();
                 if (_formsApplication == null)
                 {
-                    _formsApplication = _formsApplication ?? CreateFormsApplication();
+                    _formsApplication = CreateFormsApplication();
+                }
+                if (Application.Current != _formsApplication) {
+                    Application.Current = _formsApplication;
                 }
                 return _formsApplication;
             }",`{` should be placed in a new line,.cs,1,1,1
"@@ -14,6 +14,10 @@ namespace Datadog.Trace.ClrProfiler.Managed.Loader
     public partial class Startup
     {
         private const string AssemblyName = ""Datadog.Trace, Version=2.0.1.0, Culture=neutral, PublicKeyToken=def86d061d0d2eeb"";
+        private const string AzureAppServicesKey = ""DD_AZURE_APP_SERVICES"";
+        private const string AasCustomTracingKey = ""DD_AAS_ENABLE_CUSTOM_TRACING"";
+        private const string AasCustomMetricsKey = ""DD_AAS_ENABLE_CUSTOM_METRICS"";
+        private const string TraceEnabledKey = ""DD_TRACE_ENABLED"";
 
         /// <summary>
         /// Initializes static members of the <see cref=""Startup""/> class.","`DD_AZURE_APP_SERVICES` is already defined in `AzureAppServices`, and `DD_TRACE_ENABLED` is already defined in `ConfigurationKeys`. I suggest we reuse those, and add `DD_AAS_ENABLE_CUSTOM_TRACING` and `DD_AAS_ENABLE_CUSTOM_METRICS` to `AzureAppServices`.",.cs,1,1,1
"@@ -331,6 +331,7 @@ namespace NLog.UnitTests.Layouts
                         new CsvColumn(""date"", ""${longdate}""),
                         new CsvColumn(""level"", ""${level}""),
                         new CsvColumn(""message"", ""${message}""),
+                        new CsvColumn(""threadid"", ""${threadid}""),
                     },
                 QuoteChar = ""'"",
                 Delimiter = CsvColumnDelimiterMode.Semicolon,",was a new unit test not a better option?,.cs,1,0,1
"@@ -24,13 +24,18 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http2.HPack
             _enumerator.MoveNext();
 
             var statusCodeLength = EncodeStatusCode(statusCode, buffer);
-            var done = Encode(buffer.Slice(statusCodeLength), out var headersLength);
+            var done = Encode(buffer.Slice(statusCodeLength), throwIfNoneEncoded: false, out var headersLength);
             length = statusCodeLength + headersLength;
 
             return done;
         }
 
         public bool Encode(Span<byte> buffer, out int length)
+        {
+            return Encode(buffer, throwIfNoneEncoded: true, out length);
+        }
+
+        private bool Encode(Span<byte> buffer, bool throwIfNoneEncoded, out int length)
         {
             length = 0;
 ","Will this be raised to app code on the first write to the body if an encoded header is greater than the max frame size specified to the client or the server? If this can be induced simply by the client setting a small enough max frame size, I'm not sure that an ArgumentOutOfRangeException is appropriate particularly if there's no way for the app to discover what the client configured the max frame size to be. If this is typically thrown on the first write to the body, how is this handled and logged if there is no body? Any particular reason for not using a resource string here?",.cs,1,1,0
"@@ -61,7 +61,7 @@ namespace System.Text.Json.Tests
             }
         }
 
-        private static ReadOnlySequence<byte> GetSequence(byte[] dataUtf8, int segmentSize)
+        internal static ReadOnlySequence<byte> GetSequence(byte[] dataUtf8, int segmentSize)
         {
             int numberOfSegments = dataUtf8.Length / segmentSize + 1;
             byte[][] buffers = new byte[numberOfSegments][];",good idea to reuse the existing code!,.cs,1,0,1
"@@ -29,6 +29,8 @@ namespace Microsoft.DotNet.Build.Tasks
             }
         }
 
+        public bool GenerateLegacyDepsJson { get; set; }
+
         public string RuntimeDirectory { get; set; }
 
         public ITaskItem[] DepsExceptions { get; set; }",If we want to be backwards compatible then we need to reverse the default.,.cs,1,1,1
"@@ -89,7 +89,7 @@ namespace Benchmarks.Exporter
             {
                 for (int c = 0; c < this.NumberOfSpans; c++)
                 {
-                    await jaegerUdpBatcher.AppendAsync(this.testSpan, CancellationToken.None).ConfigureAwait(false);
+                    await jaegerUdpBatcher.AppendAsync(this.testSpan.ToJaegerSpan(), CancellationToken.None).ConfigureAwait(false);
                 }
 
                 await jaegerUdpBatcher.FlushAsync(CancellationToken.None).ConfigureAwait(false);",Prior to this PR `ToJaegerSpan()` was called inside `AppendAsync` so the amount of work in the benchmark it is still the same.,.cs,0,1,1
"@@ -1,10 +1,11 @@
 ﻿using Microsoft.Diagnostics.Tracing.Parsers;
-using Microsoft.Diagnostics.Tracing.Session;
 using Reporting;
 using System;
 using System.Collections.Generic;
+using System.Diagnostics;
 using System.IO;
 using System.Linq;
+using System.Runtime.CompilerServices;
 
 namespace ScenarioMeasurement
 {",What uses these new usings? Not seeing it in the code immediately..,.cs,1,1,1
"@@ -63,7 +63,7 @@ namespace System.Text.Json.Document.Tests
             int arrayLength = _element.GetArrayLength();
             for (int j = 0; j < arrayLength; j++)
             {
-                JsonElement dummy = _element[j];
+                _ = _element[j];
             }
         }
     }",Will this still work in 3.1 and 5.0? I don't remember what version of C# this is from.,.cs,1,1,1
"@@ -66,7 +66,7 @@ namespace MvvmCross.Droid.Views
             onGlobalLayout = (sender, args) =>
             {
                 view.ViewTreeObserver.GlobalLayout -= onGlobalLayout;
-                ViewModel.Appeared();
+                ViewModel?.Appeared();
             };
 
             view.ViewTreeObserver.GlobalLayout += onGlobalLayout;",We might need to add those null checks on iOS and Windows as well.,.cs,1,1,1
"@@ -44,12 +44,6 @@ namespace OpenTelemetry.Instrumentation.Http
         {
             var originalString = requestUri.OriginalString;
 
-            // zipkin
-            if (originalString.Contains("":9411/api/v2/spans""))
-            {
-                return true;
-            }
-
             // applicationinsights
             if (originalString.StartsWith(""https://dc.services.visualstudio"") ||
                 originalString.StartsWith(""https://rt.services.visualstudio"") ||","I did a quick manual test with Zipkin, so I removed this filter.",.cs,0,0,1
"@@ -30,5 +30,15 @@ namespace OpenTelemetry.Trace.Sampler
         /// Gets the sampler than never samples.
         /// </summary>
         public static ISampler NeverSample { get; } = new Internal.NeverSampleSampler();
+
+        /// <summary>
+        /// Gets the always on sampling decision.
+        /// </summary>
+        public static Decision AlwaysOnDecision { get; } = new Decision(true);
+
+        /// <summary>
+        /// Gets the always off sampling decision.
+        /// </summary>
+        public static Decision AlwaysOffDecision { get; } = new Decision(false);
     }
 }","nit: this is a single decision, it's not 'AlwaysOn', maybe we can do 'SampledIn'? Or since it's a struct, it't cheap to always do `new Decision(true)` without having static preconfigured value",.cs,1,1,1
"@@ -176,15 +176,10 @@ namespace Nethermind.Synchronization.FastBlocks
                 }
                 else
                 {
-                    Keccak receiptsRoot = new ReceiptTrie(blockInfo.BlockNumber, _specProvider, receipts).RootHash;
-                    if (receiptsRoot != header.ReceiptsRoot)
-                    {
-                        preparedReceipts = null;
-                    }
-                    else
-                    {
-                        preparedReceipts = receipts;
-                    }
+                    IReleaseSpec releaseSpec = _specProvider.GetSpec(blockInfo.BlockNumber);
+                    preparedReceipts = releaseSpec.ValidateReceipts && new ReceiptTrie(releaseSpec, receipts).RootHash != header.ReceiptsRoot 
+                        ? null 
+                        : receipts;
                 }
             }
 ",we cannot simply not validate receipts - very dangerous - can we discuss more,.cs,1,0,0
"@@ -31,7 +31,7 @@
 // THE POSSIBILITY OF SUCH DAMAGE.
 // 
 
-#if !SILVERLIGHT && !NETSTANDARD || NETSTANDARD1_3PLUS
+#if !SILVERLIGHT && !NETSTANDARD
 
 namespace NLog.LayoutRenderers
 {",Isn't this a quick fix? Disabling the code?,.cs,1,0,1
"@@ -19,7 +19,13 @@ namespace Datadog.Trace.ClrProfiler.Managed.Loader
         private static string ResolveManagedProfilerDirectory()
         {
             string tracerFrameworkDirectory = ""netstandard2.0"";
-            var tracerHomeDirectory = Environment.GetEnvironmentVariable(""DD_DOTNET_TRACER_HOME"") ?? string.Empty;
+
+            var tracerHomeDirectory = Environment.GetEnvironmentVariable(""DD_DOTNET_TRACER_HOME"");
+            if (string.IsNullOrWhiteSpace(tracerHomeDirectory))
+            {
+                tracerHomeDirectory = Path.GetDirectoryName(Environment.GetEnvironmentVariable(""DD_INTEGRATIONS"")) ?? string.Empty;
+            }
+
             return Path.Combine(tracerHomeDirectory, tracerFrameworkDirectory);
         }
 ",.NET Core: Fallback to `DD_INTEGRATIONS` if `DD_DOTNET_TRACER_HOME` was not set.,.cs,1,1,1
"@@ -27,7 +27,7 @@ namespace Nethermind.Network.Enr;
 /// </summary>
 public class NodeRecord
 {
-    private int _enrSequence;
+    private long _enrSequence;
 
     private string? _enrString;
 ","Below: return string.Concat(""enr:"", Convert.ToBase64String(rlpData).Replace(""+"", ""-"").Replace(""/"", ""_"").Replace(""="", """")); Better with StringBuilder? Also why do we have GetValue and GetRef doing baiscally the same?",.cs,1,1,1
"@@ -389,6 +389,7 @@ namespace NLog.UnitTests.Config
                 Assert.NotEmpty(fileLocations);
                 Assert.NotNull(fileLocations[0].Key);
                 Assert.NotNull(fileLocations[0].Value); // Primary search location is NLog-assembly
+                Assert.Equal(fileLocations.Length, fileLocations.Select(f => f.Key).Distinct().Count());
 
                 var configuration = CreateConfigurationFromString(@""
 <nlog throwExceptions='true'>","another option is to group-by and check if there aren't duplicate items, isn't?",.cs,1,1,1
"@@ -96,9 +96,10 @@ namespace MvvmCross.Droid.Support.V7.AppCompat
         
         protected virtual void RunAppStart(Bundle bundle)
         {
-            var startup = Mvx.IoCProvider.Resolve<IMvxAppStart>();
-            if (!startup.IsStarted)
+            if (Mvx.IoCProvider.TryResolve(out IMvxAppStart startup) && !startup.IsStarted)
+            {
                 startup.Start(GetAppStartHint(bundle));
+            }
         }
 
         protected virtual object GetAppStartHint(object hint = null)",Why are we using TryResolve here - is it safe for RunAppStart to be invoked when we're not able to resolve IMvxAppStart? Not throwing an exception here isn't as bad as not throwing an exception and not reporting to developer that mvx wasn't able to locate AppStart. Unless I'm missing a scenario where this is valid?,.cs,1,1,1
"@@ -34,8 +34,8 @@ namespace Datadog.Trace.DiagnosticListeners
         private static readonly PropertyFetcher HttpRequestInStopHttpContextFetcher = new PropertyFetcher(""HttpContext"");
         private static readonly PropertyFetcher UnhandledExceptionHttpContextFetcher = new PropertyFetcher(""HttpContext"");
         private static readonly PropertyFetcher UnhandledExceptionExceptionFetcher = new PropertyFetcher(""Exception"");
-        private static readonly PropertyFetcher BeforeActionHttpContextFetcher = new PropertyFetcher(""HttpContext"");
-        private static readonly PropertyFetcher BeforeActionActionDescriptorFetcher = new PropertyFetcher(""ActionDescriptor"");
+        private static readonly PropertyFetcher BeforeActionHttpContextFetcher = new PropertyFetcher(""httpContext"");
+        private static readonly PropertyFetcher BeforeActionActionDescriptorFetcher = new PropertyFetcher(""actionDescriptor"");
 
         private readonly IDatadogTracer _tracer;
         private readonly AspNetCoreDiagnosticOptions _options;","This seems unrelated, what's the deal here? Was this a bug?",.cs,1,1,1
"@@ -24,12 +24,13 @@ public class Program
 
     public static void Main()
     {
-        using var tracerProvider = Sdk.CreateTracerProvider(
+        using var tracerProvider = Sdk.CreateTracerProviderBuilder()
+            .AddActivitySources(
             new string[]
             {
                 ""MyCompany.MyProduct.MyLibrary"",
             })
-            .AddMyExporter();
+            .Build().AddMyExporter();
 
         using (var activity = MyActivitySource.StartActivity(""SayHello""))
         {","I know you can add exporter after build, but hey  ",.cs,1,0,0
"@@ -33,7 +33,7 @@ namespace Microsoft.AspNet.Server.Kestrel
                 }
                 if (Libuv.IsWindows)
                 {
-                    var architecture = IntPtr.Size == 4
+                    var architecture = Environment.Is64BitProcess
                         ? ""x86""
                         : ""amd64"";
 ","This is wrong, it either needs to be `!Environment.Is64BitProcess` or switch x86 and amd64.",.cs,1,1,1
"@@ -0,0 +1,15 @@
+using Nethermind.Int256;
+
+namespace Nethermind.JsonRpc.Modules.Eth
+{
+    public static class EthGasPriceConstants
+    {
+        public const int PercentileOfSortedTxs = 60; //Percentile of sortedTxList indexes to choose as gas price
+        public const int DefaultBlocksLimit = 20; //Limit for how many blocks we check txs in to add to sortedTxList
+        public const int DefaultGasPrice = 1; //Tx price added to sortedTxList for a block that has 0 txs (now adds 1 price)
+        public const int SoftTxLimit = 40; //If a block adds only 1 tx price, the block is not counted towards BlocksLimit if sortedTxList.Count() + blocksLeftToCheck <= SoftTxLimit (after price is added to sortedTxList) 
+        public const int DefaultBaseFee = 200; //Minimum price a transaction sender has to pay
+        public const int TxLimitFromABlock = 3; //Maximum number of tx we can add to sortedTxList from one block
+        public static readonly UInt256 _maxGasPrice = 500; //Maximum gas price we can return
+    }
+}",Why DefaultBaseFee = 200? Why _maxGasPrice = 500? Where did you find these consts?,.cs,1,1,1
"@@ -1,16 +1,16 @@
 //  Copyright (c) 2018 Demerzel Solutions Limited
 //  This file is part of the Nethermind library.
-// 
+//
 //  The Nethermind library is free software: you can redistribute it and/or modify
 //  it under the terms of the GNU Lesser General Public License as published by
 //  the Free Software Foundation, either version 3 of the License, or
 //  (at your option) any later version.
-// 
+//
 //  The Nethermind library is distributed in the hope that it will be useful,
 //  but WITHOUT ANY WARRANTY; without even the implied warranty of
 //  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 //  GNU Lesser General Public License for more details.
-// 
+//
 //  You should have received a copy of the GNU Lesser General Public License
 //  along with the Nethermind. If not, see <http://www.gnu.org/licenses/>.
 ",I guess your IDE automatically edited these files?,.cs,1,0,1
"@@ -370,13 +370,13 @@ namespace Nethermind.Specs.ChainSpecStyle
             chainSpec.Allocations = new Dictionary<Address, ChainSpecAllocation>();
             foreach (KeyValuePair<string, AllocationJson> account in chainSpecJson.Accounts)
             {
-                if (account.Value.BuiltIn != null && account.Value.Balance == UInt256.Zero)
+                if (account.Value.BuiltIn != null && account.Value.Balance == null)
                 {
                     continue;
                 }
                 
                 chainSpec.Allocations[new Address(account.Key)] = new ChainSpecAllocation(
-                    account.Value.Balance,
+                    account.Value.Balance ?? UInt256.Zero,
                     account.Value.Nonce,
                     account.Value.Code,
                     account.Value.Constructor,",Is it necessary to check this at all?,.cs,1,0,1
"@@ -41,7 +41,7 @@ namespace OpenTelemetry.Exporter.Jaeger.Tests.Implementation
         [Fact]
         public async void JaegerThriftIntegrationTest_TAbstractBaseGeneratesConsistentThriftPayload()
         {
-            var validJaegerThriftPayload = Convert.FromBase64String(""goEBCWVtaXRCYXRjaBwcGAx0ZXN0IHByb2Nlc3MZHBgQdGVzdF9wcm9jZXNzX3RhZxUAGAp0ZXN0X3ZhbHVlAAAZHBab5cuG2OehhdwBFuPakI2n2cCVLhbUpdv9yJDPo4EBFpjckNKFzqHOsgEYBE5hbWUZHBUAFpvly4bY56GF3AEW49qQjafZwJUuFpCmrOGWyrWcgwEAFQIWgICz3saWvwUWgJycORl8GAlzdHJpbmdLZXkVABgFdmFsdWUAGAdsb25nS2V5FQZGAgAYCGxvbmdLZXkyFQZGAgAYCWRvdWJsZUtleRUCJwAAAAAAAPA/ABgKZG91YmxlS2V5MhUCJwAAAAAAAPA/ABgHYm9vbEtleRUEMQAYCXNwYW4ua2luZBUAGAZjbGllbnQAGSwWgICz3saWvwUZLBgDa2V5FQAYBXZhbHVlABgLZGVzY3JpcHRpb24VABgGRXZlbnQxAAAWgICz3saWvwUZLBgDa2V5FQAYBXZhbHVlABgLZGVzY3JpcHRpb24VABgGRXZlbnQyAAAAAAA="");
+            var validJaegerThriftPayload = Convert.FromBase64String(""goEBCWVtaXRCYXRjaBwcGAx0ZXN0IHByb2Nlc3MZHBgQdGVzdF9wcm9jZXNzX3RhZxUAGAp0ZXN0X3ZhbHVlAAAZHBab5cuG2OehhdwBFuPakI2n2cCVLhbUpdv9yJDPo4EBFpjckNKFzqHOsgEYBE5hbWUZHBUAFpvly4bY56GF3AEW49qQjafZwJUuFpCmrOGWyrWcgwEAFQIWgICz3saWvwUWgJycORl8GAlzdHJpbmdLZXkVABgFdmFsdWUAGAdsb25nS2V5FQZGAgAYCGxvbmdLZXkyFQZGAgAYCWRvdWJsZUtleRUCJwAAAAAAAPA/ABgKZG91YmxlS2V5MhUCJwAAAAAAAPA/ABgHYm9vbEtleRUEMQAYCXNwYW4ua2luZBUAGAZjbGllbnQAGSwWgICz3saWvwUZLBgDa2V5FQAYBXZhbHVlABgHbWVzc2FnZRUAGAZFdmVudDEAABaAgLPexpa/BRksGANrZXkVABgFdmFsdWUAGAdtZXNzYWdlFQAYBkV2ZW50MgAAAAAA"");
             
             using (var memoryTransport = new InMemoryTransport())
             {",this test case is so wierd. I remember updating it last time =) Hope we will make somthing better eventually,.cs,1,0,1
"@@ -87,8 +87,12 @@ namespace Nethermind.Runner.Ethereum.Steps
                         logger.Error(""Error during jsonRpc runner start"", x.Exception);
                 }, cancellationToken);
 
+                JsonRpcIpcRunner jsonIpcRunner = new(jsonRpcProcessor, _api.ConfigProvider, _api.LogManager);
+                jsonIpcRunner.Start(cancellationToken);
+
 #pragma warning disable 4014
                 _api.DisposeStack.Push(new Reactive.AnonymousDisposable(() => jsonRpcRunner.StopAsync())); // do not await
+                _api.DisposeStack.Push(new Reactive.AnonymousDisposable(() => jsonIpcRunner.Dispose())); // do not await
 #pragma warning restore 4014
             }
             else",IDisposable can be pushed here normally,.cs,1,0,1
"@@ -63,7 +63,11 @@ namespace Microsoft.Cci.Writers.CSharp
             if (property.GetHiddenBaseProperty(_filter) != Dummy.Property)
                 WriteKeyword(""new"");
 
+            if (property.ReturnValueIsByRef)
+                WriteKeyword(""ref"");
+
             WriteTypeName(property.Type);
+
             if (isIndexer)
             {
                 int index = property.Name.Value.LastIndexOf(""."");",I couldn't find the C# spec but is ref supposed to be the thing directly in front of the type?,.cs,1,1,1
"@@ -23,6 +23,9 @@ namespace MvvmCross.Platforms.Uap.Presenters
     {
         protected readonly IMvxWindowsFrame _rootFrame;
 
+        private MvxWindowsContentDialog mDialogView;
+
+
         public MvxWindowsViewPresenter(IMvxWindowsFrame rootFrame)
         {
             _rootFrame = rootFrame;",Can we avoid by any chance holding a strong reference to the dialog view here?,.cs,1,1,1
"@@ -17,6 +17,7 @@
 using System.Diagnostics;
 using Microsoft.Extensions.Logging;
 using OpenTelemetry;
+using OpenTelemetry.Trace;
 
 public class Program
 {","Although this is technically correct, I wonder if we could make it simpler by not requiring this namespace?",.cs,1,1,1
"@@ -23,12 +23,13 @@ namespace OpenTelemetry.Metrics
         private Aggregation aggregation = Aggregation.Histogram;
 
         /// <summary>
-        /// Gets or sets the custom histogram bounds.
+        /// Gets or sets the values representing explicit histogram bucket
+        /// boundary values.
         /// </summary>
         /// <remarks>
         /// The array must be in ascending order with distinct values.
         /// </remarks>
-        public double[] BucketBounds { get; set; }
+        public double[] Boundaries { get; set; }
 
         public override Aggregation Aggregation
         {","Consider changing this class name to `ExplicitBucketHistogramConfiguration` (so that later if we add exponential bucket histogram, we don't expose `Boundaries`).",.cs,1,1,1
"@@ -386,7 +386,10 @@ namespace NLog.Layouts
                         var value = ParseParameterValue(stringReader);
                         if (!string.IsNullOrEmpty(parameterName) || !StringHelpers.IsNullOrWhiteSpace(value))
                         {
-                            // TODO NLog 5.0 Should throw exception when invalid configuration (Check throwConfigExceptions)
+                            if (throwConfigExceptions ?? LogManager.ThrowConfigExceptions == true)
+                            {
+                                throw new NLogConfigurationException(""Unrecognized property '{0}={1}` for ${{{2}}} ({3})"", parameterName, value, name, layoutRenderer?.GetType());
+                            }
                             InternalLogger.Warn(""Skipping unrecognized property '{0}={1}` for ${{{2}}} ({3})"", parameterName, value, name, layoutRenderer?.GetType());
                         }
                     }",Maybe this instead: `if (throwConfigExceptions ?? LogManager.ThrowConfigExceptions ?? LogManager.ThrowExceptions)` ?,.cs,1,0,1
"@@ -59,7 +59,10 @@ namespace Nethermind.Evm
             0, 0, 0, 0, 0, 0, 0, 0
         };
 
+        private readonly byte[] _chainId;
+
         private readonly IBlockhashProvider _blockhashProvider;
+        private readonly ISpecProvider _specProvider;
         private readonly LruCache<Keccak, CodeInfo> _codeCache = new LruCache<Keccak, CodeInfo>(4 * 1024);
         private readonly ILogger _logger;
         private readonly IStateProvider _state;",remove readonly for performance reasons,.cs,1,1,1
"@@ -24,6 +24,8 @@ namespace Nethermind.Consensus
     {
         private readonly UInt256 _constantDifficulty;
 
+        public static readonly IDifficultyCalculator Zero = new ConstantDifficultyCalculator(UInt256.Zero);
+
         public static readonly IDifficultyCalculator One = new ConstantDifficultyCalculator(UInt256.One);
 
         public ConstantDifficultyCalculator(UInt256 constantDifficulty)","rename to ConstantDifficulty instead of ConstantDifficultyCalculator -> or even -> Difficulty.One, Difficulty.Zero",.cs,1,1,1
"@@ -52,10 +52,7 @@ namespace NLog
 
         private static readonly IDictionary<string, object> EmptyDefaultDictionary = new SortHelpers.ReadOnlySingleBucketDictionary<string, object>();
 
-        /// <summary>
-        /// 
-        /// </summary>
-        private class ItemRemover : IDisposable
+        private sealed class ItemRemover : IDisposable
         {
             private readonly string _item;
             private bool _disposed;",note: sealed for keep Sonar stop warning about IDisposable,.cs,0,0,1
"@@ -316,6 +316,11 @@ namespace OpenTelemetry.Instrumentation.AspNetCore.Implementation
         [MethodImpl(MethodImplOptions.AggressiveInlining)]
         private static void AddGrpcAttributes(Activity activity, string grpcMethod, HttpContext context)
         {
+            // The RPC semantic conventions indicate the span name
+            // should not have a leading forward slash.
+            // https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/trace/semantic_conventions/rpc.md#span-name
+            activity.DisplayName = grpcMethod.Trim('/');
+
             activity.SetTag(SemanticConventions.AttributeRpcSystem, GrpcTagHelper.RpcSystemGrpc);
             activity.SetTag(SemanticConventions.AttributeNetPeerIp, context.Connection.RemoteIpAddress.ToString());
             activity.SetTag(SemanticConventions.AttributeNetPeerPort, context.Connection.RemotePort);",`TrimStart` might be slightly faster (if we're only concerned with the leading character).,.cs,1,1,1
"@@ -98,7 +98,8 @@ namespace OpenTelemetry.Instrumentation.Grpc.Tests
 
             // Tags added by the library then removed from the instrumentation
             Assert.Null(activity.GetTagValue(GrpcTagHelper.GrpcMethodTagName));
-            Assert.NotNull(activity.GetTagValue(GrpcTagHelper.GrpcStatusCodeTagName));
+            Assert.Null(activity.GetTagValue(GrpcTagHelper.GrpcStatusCodeTagName));
+            Assert.NotNull(activity.GetTagValue(SemanticConventions.AttributeRpcGrpcStatusCode));
         }
 
         [Theory]","Minor thing, though should be able to make this an `Assert.Equal(0, activity.GetTagValue(SemanticConventions.AttributeRpcGrpcStatusCode))` (I _think_ this test should result in a status code of 0).",.cs,1,1,1
"@@ -34,6 +34,8 @@ namespace Nethermind.Core2.Types
         public static ValidatorIndex None => new ValidatorIndex(ulong.MaxValue);
 
         public static implicit operator ulong(ValidatorIndex validatorIndex) => validatorIndex.Number;
+        
+        public static explicit operator int(ValidatorIndex validatorIndex) => (int)validatorIndex.Number;
 
         public static implicit operator ValidatorIndex(ulong value) => new ValidatorIndex(value);
 ","Suggest that implicit from ValidatorIndex => ulong is okay, but keep the opposite direction explicit. Be consistent across all the types (Slot, Gwei, etc). To avoid situations like: ValidatorIndex index = currentEpoch + maxGwei;",.cs,1,1,1
"@@ -204,7 +204,12 @@ namespace NLog.Config
             {
                 if (!string.IsNullOrEmpty(configItem.Key))
                 {
-                    dict[configItem.Key.Trim()] = configItem.Value;
+                    string key = configItem.Key.Trim();
+                    if (dict.ContainsKey(key))
+                    {
+                        InternalLogger.Debug(""Skipping duplicate value for 'NLog' property {0}. Value={1}"", configItem.Key, dict[key]);
+                    }
+                    dict[key] = configItem.Value;
                 }
             }
 ","This is something else than the refactor, isn't?",.cs,1,0,1
"@@ -60,7 +60,11 @@ namespace Datadog.Trace
         /// <summary>
         /// Gets the service name
         /// </summary>
-        public string ServiceName => _context.ServiceName;
+        public string ServiceName
+        {
+            get { return _context.ServiceName; }
+            internal set { _context.ServiceName = value; }
+        }
 
         /// <summary>
         /// Gets the trace's unique identifier.","I'm late to the party sorry, but why not let the non opentracing tracer change the service name too?",.cs,1,0,1
"@@ -0,0 +1,19 @@
+using System;
+using Datadog.Trace.ClrProfiler.Interfaces;
+using Datadog.Trace.Interfaces;
+
+namespace Datadog.Trace.ClrProfiler.Services
+{
+    internal class ActionBlockSpanDecorator : ISpanDecorator
+    {
+        private readonly Action<ISpan> _block;
+
+        public ActionBlockSpanDecorator(Action<ISpan> block)
+        {
+            _block = block;
+        }
+
+        public void Decorate(ISpan span)
+            => _block(span);
+    }
+}","I'm concerned that using delegates will add overhead that we can easily avoid. Invoking delegates is slower than calling a method directly, and we need to allocate the `Action<T>` objects as well.",.cs,1,1,1
"@@ -1529,8 +1529,11 @@ namespace pwiz.SkylineTestUtil
             // Compare file contents
             var expected = existsInProject ? ReadTextWithNormalizedLineEndings(projectFile) : string.Empty;
             var actual = ReadTextWithNormalizedLineEndings(recordedFile);
-            if (Equals(expected, actual))
+            var diff = Helpers.DiffIgnoringTimeStampsAndGUIDs(expected, actual); // Don't mind any differences in generated GUIDs or timestamps
+            if (string.IsNullOrEmpty(diff))
+            {
                 return;
+            }
 
             if (ForceMzml)
             {","This is unrelated to your change, but I believe ForceMzml is usually and the log files we have checked in all have the .mzML file extension in them. I don't think anyone would notice if this whole block of code were removed.",.cs,0,1,1
"@@ -16,7 +16,10 @@
 
 using System;
 using System.Collections.Generic;
+using System.IO;
+using System.IO.Abstractions;
 using System.Linq;
+using System.Text.Json;
 using System.Threading.Tasks;
 using Microsoft.Extensions.Logging;
 using Microsoft.Extensions.Options;",I assume that this is just a memory store that does not have to be super fast as it is used for testing,.cs,1,1,1
"@@ -3185,6 +3185,8 @@ namespace pwiz.Skyline.Model
                 var result = Document.Settings.GetIonMobilityFilter(nodePep, nodeTranGroup, nodeTran, null, null, 1.2);
                 if (result.HasIonMobilityValue)
                     ionMobility = result.IonMobility.Mobility.Value;
+                if (result.IonMobilityExtractionWindowWidth.HasValue)
+                    windowIM = result.IonMobilityExtractionWindowWidth.Value;
             }
             if (!ionMobility.HasValue)
                 _missingIonMobility.Add(nodeTranGroup.GetLibKey(Document.Settings, nodePep));","Assuming that we want the same window size used in chromatogram extraction ion mobility filtering, this seems correct. I don't know enough about this code are to say if that's a valid assumption, though,",.cs,1,1,1
"@@ -13,7 +13,7 @@ namespace Datadog.Trace
 
         private readonly DateTimeOffset _utcStart = DateTimeOffset.UtcNow;
         private readonly long _timestamp = Stopwatch.GetTimestamp();
-        private readonly List<Span> _spans = new List<Span>();
+        private List<Span> _spans = new List<Span>();
 
         private int _openSpans;
         private SamplingPriority? _samplingPriority;",Doesn't look like we needed to remove the `readonly`.,.cs,1,0,0
"@@ -51,6 +51,11 @@ namespace Nethermind.Network
             long next = 0;
             for (int i = 0; i < specProvider.TransitionBlocks.Length; i++)
             {
+                if (specProvider.TransitionBlocks[i] >= long.MaxValue - 100)
+                {
+                    continue;
+                }
+                
                 long transition = specProvider.TransitionBlocks[i];
                 if (transition > headNumber)
                 {",Why this const? Can we name this const better?,.cs,1,0,1
"@@ -0,0 +1,13 @@
+﻿using System.Composition;
+
+namespace Microsoft.Cci.Differs.Rules
+{
+    internal abstract class DifferenceRule : Microsoft.Cci.Differs.DifferenceRule
+    {
+        [Import]
+        public IDifferenceOperands Operands { get; set; }
+
+        public string Left => Operands?.Left ?? ""contract"";
+        public string Right => Operands?.Right ?? ""implementation"";
+    }
+}",LOL. Too scared to update the base rule and just make it optional?,.cs,1,1,0
"@@ -96,8 +96,8 @@ namespace Examples.Console
                 catch (ArgumentOutOfRangeException e)
                 {
                     // Set status upon error
-                    activity.AddTag(SpanAttributeConstants.StatusCodeKey, SpanHelper.GetCachedCanonicalCodeString(Status.Internal.CanonicalCode));
-                    activity.AddTag(SpanAttributeConstants.StatusDescriptionKey, e.ToString());
+                    activity.SetTag(SpanAttributeConstants.StatusCodeKey, SpanHelper.GetCachedCanonicalCodeString(Status.Internal.CanonicalCode));
+                    activity.SetTag(SpanAttributeConstants.StatusDescriptionKey, e.ToString());
                 }
 
                 // Annotate our activity to capture metadata about our operation",Should we consider changing the return type of `SpanHelper.GetCachedCanonicalCodeString` to int?,.cs,1,0,1
"@@ -629,12 +629,13 @@ namespace pwiz.Skyline.Util.Extensions
             }
             for (int i = 0; i < fields.Length; ++i)
             {
-                FieldNames.Add(fields[i].Trim());
-                FieldDict[fields[i]] = i;
+                var trimmed = fields[i].Trim();
+                FieldNames.Add(trimmed);
+                FieldDict[trimmed] = i;
                 // Check to see if the given column name is actually a synonym for the internal canonical (no spaces, serialized) name
                 if (headerSynonyms != null)
                 {
-                    var key = headerSynonyms.Keys.FirstOrDefault(k => string.Compare(k, fields[i], StringComparison.OrdinalIgnoreCase)==0); // Case insensitive
+                    var key = headerSynonyms.Keys.FirstOrDefault(k => string.Compare(k, trimmed, StringComparison.OrdinalIgnoreCase)==0); // Case insensitive
                     if (!string.IsNullOrEmpty(key))
                     {
                         var syn = headerSynonyms[key];","I would name this variable ""fieldName"" instead of ""trimmed"".",.cs,1,0,1
"@@ -0,0 +1,17 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+// See the LICENSE file in the project root for more information.
+
+using System;
+using System.Net;
+
+namespace Microsoft.DotNet.VersionTools.Automation.GitHubApi
+{
+    public partial class GitHubClient : IGitHubClient, IDisposable
+    {
+        static GitHubClient()
+        {
+            ServicePointManager.SecurityProtocol |= SecurityProtocolType.Tls12;
+        }
+    }
+}","@davidsh When targeting 4.5(.0) is this the right answer, or can/should it be assigned to 0?",.cs,0,1,1
"@@ -594,6 +594,19 @@ namespace MvvmCross.Droid.Views
             return false;
         }
 
+        protected virtual bool CloseFragments()
+        {
+            try
+            {
+                CurrentFragmentManager.PopBackStackImmediate();
+            }
+            catch (System.Exception ex)
+            {
+                MvxTrace.Trace(""Cannot close any fragments"", ex);
+            }
+            return true;
+        }
+
         protected virtual bool CloseFragment(IMvxViewModel viewModel, MvxFragmentPresentationAttribute attribute)
         {
             // try to close nested fragment first",Same here about running the code without try/catch,.cs,0,1,1
"@@ -81,6 +81,7 @@ namespace pwiz.SkylineTestFunctional
             VerifyStringLocalization(""{0:SEttings}"", ""{0:SEttings}"");
 
             var unlocalizedMessageTypes = GetUnlocalizedMessageTypes();
+            var errMsgs = new List<string>();
             if (unlocalizedMessageTypes.Any())
                 Assert.Fail(""The following properties are unlocalized:\n"" + string.Join(""\n"", unlocalizedMessageTypes));
 ",How can adding an empty list as the only change to this file be useful?,.cs,1,1,1
"@@ -1302,7 +1302,7 @@ namespace Microsoft.AspNetCore.Server.Kestrel.FunctionalTests
                 await appFuncCompleted.Task.DefaultTimeout();
             }
 
-            mockKestrelTrace.Verify(t => t.ConnectionStop(It.IsAny<string>()), Times.Once());
+            mockKestrelTrace.Verify(t => t.ConnectionStop(It.IsAny<string>()), Times.AtMostOnce());
         }
 
         [Theory]",Is there a point in checking these at all if we allow 0 and 1? Maybe we should just remove them entirely. I suppose we are making sure ConnectionStop is never called more than once still.,.cs,1,1,1
"@@ -0,0 +1,14 @@
+// Copyright (c) .NET Foundation. All rights reserved.
+// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.
+
+using System;
+
+namespace Microsoft.AspNetCore.Protocols
+{
+    [Flags]
+    public enum TransferFormat
+    {
+        Binary = 0x01,
+        Text = 0x02
+    }
+}","Binary literal? :). I don't really care either way, mostly just trolling.",.cs,1,0,1
"@@ -150,6 +150,7 @@ namespace Datadog.Trace
                 span.SetTag(Tags.AzureAppServicesInstanceName, AzureAppServices.Metadata.InstanceName);
                 span.SetTag(Tags.AzureAppServicesOperatingSystem, AzureAppServices.Metadata.OperatingSystem);
                 span.SetTag(Tags.AzureAppServicesRuntime, AzureAppServices.Metadata.Runtime);
+                span.SetTag(Tags.AzureAppServicesExtensionVersion, AzureAppServices.Metadata.SiteExtensionVersion);
             }
 
             // set the origin tag to the root span of each trace/subtrace","Can this be `null` (e.g. if it's an older version of the extension installed)? If so, is there any value in recording that as a key without a value? This is a more general question of course, for my own understanding  ",.cs,1,1,1
"@@ -23,7 +23,7 @@ namespace OpenTelemetry.Exporter.Prometheus
     /// </summary>
     internal static partial class PrometheusSerializer
     {
-        private static readonly string[] MetricTypes = new string[] { ""untyped"", ""counter"", ""gauge"", ""histogram"", ""summary"" };
+        private static readonly string[] MetricTypes = new string[] { ""untyped"", ""counter"", ""gauge"", ""untyped"", ""histogram"", ""histogram"", ""histogram"", ""histogram"", ""summary"" };
 
         public static int WriteMetric(byte[] buffer, int cursor, Metric metric)
         {",minor: rewrap this line.,.cs,1,1,1
"@@ -151,7 +151,7 @@ namespace Datadog.Trace.DuckTyping
                     }
 
                     // Create a valid type name that can be used as a member of a class. (BenchmarkDotNet fails if is an invalid name)
-                    string proxyTypeName = $""{assembly}.{targetType.FullName.Replace(""."", ""_"").Replace(""+"", ""__"")}.{proxyDefinitionType.FullName.Replace(""."", ""_"").Replace(""+"", ""__"")}"";
+                    string proxyTypeName = $""{assembly}.{targetType.FullName.Replace(""."", ""_"").Replace(""+"", ""__"")}.{proxyDefinitionType.FullName.Replace(""."", ""_"").Replace(""+"", ""__"")}_{++_typeCount}"";
 
                     // Create Type
                     TypeBuilder proxyTypeBuilder = _moduleBuilder.DefineType(",Don't require `Interlocked` because the CreateProxyType method is called only once from a Concurrent Lazy pattern.,.cs,1,1,1
"@@ -18,6 +18,7 @@ using System;
 using System.Collections;
 using System.Collections.Generic;
 using System.Diagnostics;
+using System.Linq;
 
 namespace OpenTelemetry.Trace.Internal
 {",Is this namespace used?,.cs,1,1,1
"@@ -8,13 +8,16 @@ using Microsoft.AspNet.Server.Kestrel.Filter;
 using Microsoft.AspNet.Server.Kestrel.Infrastructure;
 using Microsoft.AspNet.Server.Kestrel.Networking;
 using Microsoft.Extensions.Logging;
+using System.Security.Cryptography.X509Certificates;
 
 namespace Microsoft.AspNet.Server.Kestrel.Http
 {
     public class Connection : ConnectionContext, IConnectionControl
     {
-        private static readonly Action<UvStreamHandle, int, object> _readCallback = ReadCallback;
-        private static readonly Func<UvStreamHandle, int, object, Libuv.uv_buf_t> _allocCallback = AllocCallback;
+        private static readonly Action<UvStreamHandle, int, object> _readCallback = 
+            (handle, status, state) => ReadCallback(handle, status, state);
+        private static readonly Func<UvStreamHandle, int, object, Libuv.uv_buf_t> _allocCallback = 
+            (handle, suggestedsize, state) => AllocCallback(handle, suggestedsize, state);
 
         private static long _lastConnectionId;
 ","Sort usings, System should always be first.",.cs,1,1,1
"@@ -12,7 +12,7 @@ namespace Microsoft.CodeAnalysis.Sarif
     {
         string GetProperty(string propertyName);
         T GetProperty<T>(string propertyName);
-        void SetProperty(string propertyName, string value);
+        void SetProperty<T>(string propertyName, T value);
         IList<string> PropertyNames { get; }
     }
 }",`SetProperty` can now take any type. #Resolved,.cs,1,0,1
"@@ -206,7 +206,10 @@ namespace Microsoft.Cci.Writers.CSharp
                 Write(""throw new "");
                 if (_forCompilationIncludeGlobalprefix)
                     Write(""global::"");
-                Write(""System.PlatformNotSupportedException(); "");
+                if(_platformNotSupportedExceptionMessage == null)
+                    Write(""System.PlatformNotSupportedException();"");
+                else
+                    Write($""System.PlatformNotSupportedException(\""{_platformNotSupportedExceptionMessage}\""); "");
             }
             else if (method.ContainingTypeDefinition.IsValueType && method.IsConstructor)
             {","Can you also provide some syntax pattern for folks specify a resource string? For example, if _platformNotSupportedExceptionMessage starts with some character like `:` or `@` treat the rest of it as code so that folks can do something like `:SR.MyLocalizedResourceMessage`",.cs,1,1,1
"@@ -26,6 +26,7 @@ namespace Datadog.Trace.ClrProfiler.IntegrationTests
 #if DEFAULT_SAMPLES
                 new object[] { string.Empty },
 #else
+#if NETFRAMEWORK
                 new object[] { ""2.0.0"" },
                 new object[] { ""2.0.1"" },
                 new object[] { ""2.0.2"" },","The changes to `MinVersionNetCore` take effect here, where we do not run the XUnit test cases for package versions that are lower than the specified `MinVersionNetCore`",.cs,1,1,1
"@@ -52,10 +52,15 @@ namespace MvvmCross.Forms.Platform.Uap.Core
         {
             get
             {
+                if (!Xamarin.Forms.Forms.IsInitialized)
+                    Xamarin.Forms.Forms.Init(ActivationArguments, GetViewAssemblies());
+
                 if (_formsApplication == null)
                 {
-                    Xamarin.Forms.Forms.Init(ActivationArguments, GetViewAssemblies());
-                    _formsApplication = _formsApplication ?? CreateFormsApplication();
+                    _formsApplication = CreateFormsApplication();
+                }
+                if(Application.Current != _formsApplication) {
+                    Application.Current = _formsApplication;
                 }
                 return _formsApplication;
             }",`{` should be placed in a new line,.cs,1,1,1
"@@ -47,8 +47,9 @@ namespace Nethermind.Runner.JsonRpc
 
         public void ConfigureServices(IServiceCollection services)
         {
-            // ReSharper disable once ASP0000
+            #pragma warning disable ASP0000
             ServiceProvider sp = services.BuildServiceProvider()!;
+            #pragma warning restore ASP0000
             IConfigProvider? configProvider = sp.GetService<IConfigProvider>();
             if (configProvider == null)
             {","ReSharper disables only affect resharper, while `#pragma warning ...` should work for all compilers.",.cs,1,1,1
"@@ -39,6 +39,17 @@ namespace OpenTelemetry.Instrumentation.SqlClient
         private static readonly Regex DataSourceRegex = new Regex(""^(.*?)\\s*(?:[\\\\,]|$)\\s*(.*?)\\s*(?:,|$)\\s*(.*)$"", RegexOptions.Compiled);
         private static readonly ConcurrentDictionary<string, SqlConnectionDetails> ConnectionDetailCache = new ConcurrentDictionary<string, SqlConnectionDetails>(StringComparer.OrdinalIgnoreCase);
 
+        // .NET Framework implementation uses SqlEventSource from which we can't reliably distinguish
+        // StoredProcedures from regular Text sql commands.
+#if NETFRAMEWORK
+
+        /// <summary>
+        /// Gets or sets a value indicating whether or not the <see cref=""SqlClientInstrumentation""/> should
+        /// add the text of the executed Sql commands as the <see cref=""SemanticConventions.AttributeDbStatement""/> tag.
+        /// Default value: True.
+        /// </summary>
+        public bool SetStatementText { get; set; } = true;
+#else
         /// <summary>
         /// Gets or sets a value indicating whether or not the <see cref=""SqlClientInstrumentation""/> should add the names of <see cref=""CommandType.StoredProcedure""/> commands as the <see cref=""SemanticConventions.AttributeDbStatement""/> tag. Default value: True.
         /// </summary>",Lets keep the default `false`. Its a bit risky to collect full sql statement by default.,.cs,1,1,1
"@@ -2119,6 +2119,10 @@ namespace Nethermind.Evm
                         {
                             _state.UpdateStorageRoot(contractAddress, Keccak.EmptyTreeHash);
                         }
+                        else if (_state.IsDeadAccount(contractAddress))
+                        {
+                            _storage.RecreateStorage(contractAddress);
+                        }
 
                         _state.SubtractFromBalance(env.ExecutingAccount, value, spec);
                         ExecutionEnvironment callEnv = new ExecutionEnvironment();",Are we sure this won't create consensus issues on different transactions and blocks?,.cs,1,1,1
"@@ -85,6 +85,6 @@ namespace NLog.Targets
         /// Gets or sets the type of the property.
         /// </summary>
         [DefaultValue(typeof(string))]
-        public Type PropertyType { get; set; } = typeof(string);
+        public Type ParameterType { get; set; } = typeof(string);
     }
 }","I think propertyType is better? It's a target with properties, and not parameters?",.cs,1,1,1
"@@ -6,9 +6,13 @@ using System.Collections.Generic;
 using System.IO;
 using System.Linq;
 using System.Text;
+using System.Threading;
 using System.Threading.Tasks;
+using Microsoft.AspNet.Server.Kestrel.Infrastructure;
 using Microsoft.Framework.Logging;
 using Microsoft.Framework.Primitives;
+using System.Numerics;
+using Microsoft.AspNet.Hosting.Builder;
 
 // ReSharper disable AccessToModifiedClosure
 ",Sort these usings,.cs,1,1,1
"@@ -76,7 +76,7 @@ namespace Datadog.Trace.Logging
                        .MinimumLevel.ControlledBy(LoggingLevelSwitch)
                        .WriteTo.File(
                             managedLogPath,
-                            outputTemplate: ""{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj}{Exception}{Properties}{NewLine}"",
+                            outputTemplate: ""{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj}{Exception} {Properties}{NewLine}"",
                             rollingInterval: RollingInterval.Day,
                             rollOnFileSizeLimit: true,
                             fileSizeLimitBytes: MaxLogFileSize,",In that case shouldn't we add one also before the exception?,.cs,1,1,1
"@@ -9,14 +9,14 @@ using Android.Content;
 using Android.Runtime;
 using Android.Util;
 using MvvmCross.Binding.Attributes;
-using MvvmCross.Droid.Support.V7.RecyclerView.AttributeHelpers;
-using MvvmCross.Droid.Support.V7.RecyclerView.ItemTemplates;
+using MvvmCross.DroidX.RecyclerView.AttributeHelpers;
+using MvvmCross.DroidX.RecyclerView.ItemTemplates;
 using MvvmCross.Platforms.Android.Binding.Views;
 
-namespace MvvmCross.Droid.Support.V7.RecyclerView
+namespace MvvmCross.DroidX.RecyclerView
 {
-    [Register(""mvvmcross.droid.support.v7.recyclerview.MvxRecyclerView"")]
-    public class MvxRecyclerView : Android.Support.V7.Widget.RecyclerView
+    [Register(""mvvmcross.DroidX.recyclerview.MvxRecyclerView"")]
+    public class MvxRecyclerView : AndroidX.RecyclerView.Widget.RecyclerView
     {
         public MvxRecyclerView(Context context, IAttributeSet attrs) :
             this(context, attrs, 0, new MvxRecyclerAdapter())",Another register needs lowercasing,.cs,1,1,1
"@@ -161,6 +161,13 @@ namespace Datadog.Trace.AspNet
                     app.Context.Items[_httpContextScopeKey] is Scope scope)
                 {
                     scope.Span.SetHttpStatusCode(app.Context.Response.StatusCode, isServer: true);
+
+                    if (app.Context.Items[""__Datadog.Trace.ClrProfiler.Managed.AspNetMvcIntegration-aspnet.resourcename""] is string resourceName
+                        && !string.IsNullOrEmpty(resourceName))
+                    {
+                        scope.Span.ResourceName = resourceName;
+                    }
+
                     scope.Dispose();
                 }
             }","[non-blocking] While you're in here, consider renaming `UriHelpers.GetRelativeUrl()` since that is not what it does.",.cs,1,1,1
"@@ -40,7 +40,7 @@ namespace System.Text.RegularExpressions.Tests
     }
 
     /// <summary>Performance tests adapted from https://github.com/mariomka/regex-benchmark</summary>
-    [BenchmarkCategory(Categories.Libraries, Categories.NoWASM)]
+    [BenchmarkCategory(Categories.Libraries, Categories.Regex, Categories.NoWASM)]
     public class Perf_Regex_Industry_Mariomkas
     {
         [Params(","You will need the Regex category for all of the test classes, unless you don't want them included",.cs,1,1,1
"@@ -29,7 +29,7 @@ namespace Nethermind.Network.Benchmarks
         [GlobalSetup]
         public void Setup()
         {
-            _node = new Node(new PublicKey(""0x000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f""), ""127.0.0.1"", 1234);
+            _node = new Node(new PublicKey(""0x000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f""), ""127.0.0.1"", 1234, false);
         }
         
         [Benchmark]",a lot of default 'false' for isStatic cluttering the PR,.cs,0,1,1
"@@ -17,7 +17,7 @@ namespace Datadog.Trace.ClrProfiler
                 DefinitionsId = ""FFAFA5168C4F4718B40CA8788875C2DA"",
 
                 // Autogenerated definitions array
-                Definitions = GetDefinitionsArray(),
+                Definitions = GetDefinitionsList().ToArray(),
             };
         }
 ",@tonyredondo for visibility,.cs,0,0,1
"@@ -17,7 +17,7 @@ namespace Microsoft.CodeAnalysis.Sarif
         internal const string DEFAULT_POLICY_NAME = ""default"";
 
         public PropertyBagDictionary() : base() { }
-
+        //CA1026 Not sure how to fix
         public PropertyBagDictionary(
             PropertyBagDictionary initializer = null,
             IEqualityComparer<string> comparer = null)",Setting constructor null default arguments below this section. Unsure of how to fix EDIT: Will attempt fix according to prior notation,.cs,1,1,1
"@@ -5,12 +5,12 @@
 //
 // Project Lead - Stuart Lodge, @slodge, me@slodge.com
 
+using System;
 using System.Windows.Input;
 
 namespace MvvmCross.Core.ViewModels
 {
-    public interface IMvxCommand
-        : ICommand
+    public interface IMvxCommand : ICommand
     {
         void RaiseCanExecuteChanged();
 ",Should this not inherit `IMvxCommand` instead of `ICommand`?,.cs,1,1,1
"@@ -219,6 +219,13 @@ namespace MvvmCross.Droid.FullFragging.Caching
 			{
 				(fragInfo.CachedFragment as Fragment).Arguments.Clear();
 				(fragInfo.CachedFragment as Fragment).Arguments.PutAll(bundle);
+
+                var childViewModelCache = Mvx.GetSingleton<IMvxChildViewModelCache>();
+                if (childViewModelCache.Exists(fragInfo.CachedFragment.ViewModel.GetType()))
+                {
+                    fragInfo.CachedFragment.ViewModel = childViewModelCache.Get(fragInfo.CachedFragment.ViewModel.GetType());
+                    childViewModelCache.Remove(fragInfo.CachedFragment.ViewModel.GetType());
+                }
 			}
 			else
 			{",Again: evaluate `fragInfo.CachedFragment.ViewModel.GetType()` once.,.cs,1,0,1
"@@ -689,7 +689,15 @@ namespace pwiz.SkylineTestUtil
                     {
                         // Grab some details in case of eventual failure
                         var formCloseClassName = System.ComponentModel.TypeDescriptor.GetClassName(formClose);
-                        var formCloseText = formClose.Text;
+                        string formCloseText;
+                        try
+                        {
+                            formCloseText = formClose.Text;
+                        }
+                        catch
+                        {
+                            formCloseText = ""@@ERROR@@"";
+                        }
                         formDetail = string.Format(""(form class={0}, form text=\""{1}\"")"", 
                             string.IsNullOrEmpty(formCloseClassName) ? @""?"" : formCloseClassName,
                             string.IsNullOrEmpty(formCloseText) ? @""?"" : formCloseText);","Seems a bit dramatic? Maybe just ""@@(could not retrieve form text)@@""",.cs,1,1,1
"@@ -34,7 +34,7 @@ func TestConvertAWSMachine(t *testing.T) {
 				Spec: infrav1alpha3.AWSMachineSpec{
 					CloudInit: infrav1alpha3.CloudInit{
 						InsecureSkipSecretsManager: true,
-						SecretARN:                  ""something"",
+						SecretPrefix:               ""something/"",
 					},
 				},
 			}",Any particular reason for adding the `/` here? Should this be something we automatically do in the naming (adding a separator between the secret prefix and the chunk number)?,go,1,1,1
"@@ -75,7 +75,10 @@ func Setup(ctx context.Context, config *config.Node, proxy proxy.Proxy) error {
 
 	endpoint, _ := client.CoreV1().Endpoints(""default"").Get(ctx, ""kubernetes"", metav1.GetOptions{})
 	if endpoint != nil {
-		proxy.Update(getAddresses(endpoint))
+		addresses := getAddresses(endpoint)
+		if len(addresses) > 0 {
+			proxy.Update(getAddresses(endpoint))
+		}
 	}
 
 	disconnect := map[string]context.CancelFunc{}","Does the `proxy.Update` implementation fail for a zero-length and/or nil slice of addresses? If so, we should fix it there. My only other guess is you needed to set a breakpoint while debugging.",go,1,1,1
"@@ -87,10 +87,19 @@ var creatablesMigration = []string{
 	`ALTER TABLE assetcreators ADD COLUMN ctype INTEGER DEFAULT 0`,
 }
 
+var createOnlineAccountIndex = []string{
+	`ALTER TABLE accountbase
+		ADD COLUMN normalizedonlinebalance INTEGER`,
+	`CREATE INDEX IF NOT EXISTS onlineaccountbals
+		ON accountbase ( normalizedonlinebalance, address, data )
+		WHERE normalizedonlinebalance>0`,
+}
+
 var accountsResetExprs = []string{
 	`DROP TABLE IF EXISTS acctrounds`,
 	`DROP TABLE IF EXISTS accounttotals`,
 	`DROP TABLE IF EXISTS accountbase`,
+	`DROP TABLE IF EXISTS onlineaccountbase`,
 	`DROP TABLE IF EXISTS assetcreators`,
 	`DROP TABLE IF EXISTS storedcatchpoints`,
 	`DROP TABLE IF EXISTS catchpointstate`,","this line can be dropped, right ?",go,1,0,1
"@@ -62,15 +62,15 @@ func NewOutbound(urlStr string, opts ...AgentOption) *Outbound {
 	urlTemplate, hp := parseURL(urlStr)
 
 	peerID := hostport.PeerIdentifier(hp)
-	peerList := list.NewSingle(peerID, agent)
+	peerChooser := list.NewSingle(peerID, agent)
 
-	err := peerList.Start()
+	err := peerChooser.Start()
 	if err != nil {
 		// This should never happen, single shouldn't return an error here
 		panic(fmt.Sprintf(""could not start single peerlist, err: %s"", err))
 	}
 
-	return NewPeerListOutbound(peerList, urlTemplate)
+	return NewChooserOutbound(peerChooser, urlTemplate)
 }
 
 func parseURL(urlStr string) (*url.URL, string) {","nit - in this context, it might be enough to just call the variable `chooser`.",go,1,1,1
"@@ -0,0 +1,3 @@
+package filesystem_mock
+
+//go:generate mockgen -source ../../../../pkg/agent/plugin/workloadattestor/k8s/filesystem.go -destination filesystem.go -package filesystem_mock",what's the motivation to have custom package name? it would be good to keep the names consistent (most of the others here have the default package name),go,1,1,1
"@@ -1,6 +1,7 @@
 package libflux
 
-// #include ""influxdata/flux.h""
+// #cgo CFLAGS: -I${SRCDIR}/../../include/influxdata
+// #include <flux.h>
 // #include <stdlib.h>
 import ""C""
 ","For some reason, `/`s inside of `include` don't work, but `/`s inside of `cgo CFLAGS` _do_ work.",go,1,1,1
"@@ -166,10 +166,11 @@ type CertificateSpec struct {
 	// revisions will not be garbage collected. Default value is `nil`.
 	RevisionHistoryLimit *int32
 
-	// AdditionalOutputFormats allows for requests of additional output formats
-	// of the private key and the certificate to be written to the secret.
-	// This is an Alpha Feature and should be enabled with --feature-gates option.
-	AdditionalOutputFormats []AdditionalOutputFormat
+	// AdditionalOutputFormats defines extra output formats of the private key
+	// and signed certificate chain to be written to this Certificate's target
+	// Secret. This is an Alpha Feature and is only enabled with the
+	// `--feature-gates=AdditionalCertificateOutputFormats=true` option.
+	AdditionalOutputFormats []CertificateAdditionalOutputFormat `json:""additionalOutputFormats,omitempty""`
 }
 
 // CertificatePrivateKey contains configuration options for private keys",Internal type shouldn't have json tags,go,1,1,1
"@@ -2,10 +2,10 @@ package app
 
 import (
 	""fmt""
+	""github.com/kubeedge/kubeedge/pkg/util""
 	""os""
 
 	""github.com/spf13/cobra""
-	utilerrors ""k8s.io/apimachinery/pkg/util/errors""
 	""k8s.io/apiserver/pkg/util/term""
 	cliflag ""k8s.io/component-base/cli/flag""
 	""k8s.io/component-base/cli/globalflag""",Move this line to the category of kubeedge below L14 :),go,1,1,1
"@@ -260,9 +260,9 @@ func (d decoder) MapLen() (int, bool) {
 	return len(d.av.M), true
 }
 
-func (d decoder) DecodeMap(f func(key string, vd driver.Decoder) bool) {
+func (d decoder) DecodeMap(f func(key string, vd driver.Decoder, exactMatch bool) bool) {
 	for k, av := range d.av.M {
-		if !f(k, decoder{av}) {
+		if !f(k, decoder{av}, true) {
 			break
 		}
 	}",why not use `exactMatch` here?,go,1,0,1
"@@ -155,11 +155,11 @@ func (r *DeliveryReporter) reportEventProcessingTime(ctx context.Context, end ti
 }
 
 func filterTypeValue(v string) string {
-	if v != """" {
-		return v
+	if v == """" {
+		// the default value if the filter attributes are empty.
+		return unspecifiedFilterType
 	}
-	// the default value if the filter attributes are empty.
-	return ""any""
+	return EventTypeMetricValue(v)
 }
 
 func (r *DeliveryReporter) AddTags(ctx context.Context) (context.Context, error) {",It shouldn't be necessary to transform the filter type since the cardinality is already limited by the cardinality of triggers.,go,1,1,1
"@@ -62,6 +62,11 @@ func (t TraceID) MarshalJSON() ([]byte, error) {
 	return json.Marshal(hex.EncodeToString(t[:]))
 }
 
+// Stringer Implementation of String() returns the string form of a TraceID
+func (t TraceID) String() string {
+	return string(t[:])
+}
+
 // SpanID is a unique identify of a span in a trace.
 type SpanID [8]byte
 ",please use hex.EncodeToString() here as well.,go,1,1,1
"@@ -33,6 +33,7 @@ type Header struct {
 	Type         protocol.PacketType
 	IsLongHeader bool
 	KeyPhase     int
+	PayloadLen   protocol.ByteCount
 
 	// only needed for logging
 	isPublicHeader bool",Maybe it's worth splitting the long header and short header? Or have a substruct with only the long header / short header specific fields?,go,1,1,1
"@@ -39,6 +39,11 @@ type BuildResult struct {
         // The directory of the main package. This is useful for testing as the test
         // binary must be run in the directory of the tested package.
         MainDir string
+
+        // ImportPath is the import path of the main package. This is useful for
+        // correctly printing test results: the import path isn't always the same as
+        // the path listed on the command line.
+        ImportPath string
 }
 
 // packageAction is the struct that is serialized to JSON and hashed, to work as",I needed exactly this. :star:,go,1,0,1
"@@ -236,6 +236,10 @@ func ReadConfigFiles(filenames []string, profiles []string) (*Configuration, err
 		config.Sandbox.Tool = config.Build.PleaseSandboxTool
 	}
 
+	if config.Sandbox.Namespace == """" && (config.Sandbox.Build || config.Sandbox.Test) {
+		config.Sandbox.Namespace = ""true""
+	}
+
 	// We can only verify options by reflection (we need struct tags) so run them quickly through this.
 	return config, config.ApplyOverrides(map[string]string{
 		""build.hashfunction"": config.Build.HashFunction,","This is kinda lame. We need 3 state logic: Not set, set to false, set to true. Will probably change this up: ""always"", ""sandbox"", ""never"" where it defaults to ""never"" to work with the default `please_sandbox` tool.",go,1,1,1
"@@ -101,9 +101,9 @@ func TestWebAppStatus_Describe(t *testing.T) {
 			},
 			mockcwSvc: func(m *mocks.MockalarmStatusGetter) {
 				m.EXPECT().GetAlarmsWithTags(map[string]string{
-					""ecs-project"":     ""mockProject"",
-					""ecs-environment"": ""mockEnv"",
-					""ecs-application"": ""mockApp"",
+					""copilot-application"": ""mockProject"",
+					""copilot-environment"": ""mockEnv"",
+					""copilot-service"":     ""mockApp"",
 				}).Return(nil, mockError)
 			},
 			mockWebAppDescriber: func(m *mocks.MockserviceArnGetter) {","Can we change all the mockApp stuff to mockService, and the mockProject text to mockApp?",go,1,1,1
"@@ -154,6 +154,8 @@ func (manager *connectionManager) startConnection(consumerID identity.Identity,
 		return err
 	}
 
+	cancel = append(cancel, func() { session.RequestSessionDestroy(dialog, sessionID) })
+
 	// set the session info for future use
 	manager.sessionInfo = SessionInfo{
 		SessionID:  sessionID,","Since we're not handling the errors here, we'd either need to add logging to the function itself, or handle errors here properly. Things might start failing and we would not know about it.",go,1,1,1
"@@ -227,7 +227,9 @@ func (d *DNSServer) handleRecursive(client *dns.Client, defaultMaxResponseSize i
 		}
 
 		for _, server := range d.upstream.Servers {
-			response, _, err := client.Exchange(req, fmt.Sprintf(""%s:%s"", server, d.upstream.Port))
+			reqCopy := *req
+			reqCopy.Id = dns.Id()
+			response, _, err := client.Exchange(&reqCopy, fmt.Sprintf(""%s:%s"", server, d.upstream.Port))
 			if err != nil || response == nil {
 				d.ns.debugf(""error trying %s: %v"", server, err)
 				continue",There is a `Copy()` method for messages...,go,1,1,1
"@@ -903,6 +903,10 @@ receivers:
 		return errors.Wrap(err, ""base config from Secret could not be parsed"")
 	}
 
+	if err := checkAlertmanagerRootConfig(ctx, baseConfig); err != nil {
+		return errors.Wrap(err, ""base config check failed"")
+	}
+
 	amVersion := operator.StringValOrDefault(am.Spec.Version, operator.DefaultAlertmanagerVersion)
 	version, err := semver.ParseTolerant(amVersion)
 	if err != nil {",could be delegated to `loadCfg` (which would be good to have renamed BTW)?,go,1,1,1
"@@ -800,6 +800,8 @@ func (k *k8sOrchestrator) createControllerDeployment(volProProfile volProfile.Vo
 		return nil, err
 	}
 
+	pvc := vol.Labels.K8sPersistentVolumeClaim
+
 	if clusterIP == """" {
 		return nil, fmt.Errorf(""Volume cluster IP is required to create controller for volume 'name: %s'"", vsm)
 	}",Why do we need this change for the replica deployment?,go,1,1,1
"@@ -18,6 +18,7 @@ type DifferenceOpSpec struct {
 	NonNegative bool     `json:""nonNegative""`
 	Columns     []string `json:""columns""`
 	KeepFirst   bool     `json:""keepFirst""`
+	InitialZero bool     `json:""initialZero""`
 }
 
 func init() {",Are we going to have this value be a boolean or a customizable value?,go,1,1,1
"@@ -22,6 +22,7 @@ import (
 type Provider interface {
         Type() string
         // RunQuery runs the given query against the log provider,
-        // and then checks if there is at least one error log..
-        RunQuery(ctx context.Context, query string) (result bool, err error)
+        // and then checks if there is at least one error log.
+        // Returns the result reason if non-error occurred.
+        RunQuery(ctx context.Context, query string) (result bool, reason string, err error)
 }",Looks like now it should be `Evaluate` instead of `RunQuery`. But that is not in this PR scope.,go,0,1,1
"@@ -1584,14 +1584,13 @@ func (s *matchingEngineSuite) TestTaskExpiryAndCompletion() {
         s.matchingEngine.config.MaxTaskDeleteBatchSize = dynamicconfig.GetIntPropertyFilteredByTaskQueueInfo(2)
         // set idle timer check to a really small value to assert that we don't accidentally drop tasks while blocking
         // on enqueuing a task to task buffer
-        s.matchingEngine.config.IdleTaskqueueCheckInterval = dynamicconfig.GetDurationPropertyFnFilteredByTaskQueueInfo(time.Microsecond)
+        s.matchingEngine.config.IdleTaskqueueCheckInterval = dynamicconfig.GetDurationPropertyFnFilteredByTaskQueueInfo(time.Millisecond)
 
         testCases := []struct {
-                batchSize          int
                 maxTimeBtwnDeletes time.Duration
         }{
-                {2, time.Minute},       // test taskGC deleting due to size threshold
-                {100, time.Nanosecond}, // test taskGC deleting due to time condition
+                {time.Minute},     // test taskGC deleting due to size threshold
+                {time.Nanosecond}, // test taskGC deleting due to time condition
         }
 
         for _, tc := range testCases {",S -> ms? just check this is intentional?,go,1,1,0
"@@ -1,8 +1,15 @@
 package net
 
 import (
+        ""context""
+        ""fmt""
+        ""sort""
+
         ma ""gx/ipfs/QmNTCey11oxhb1AxDnQBRHtdhap6Ctud872NjAYPYYXPuc/go-multiaddr""
         ""gx/ipfs/QmTu65MVbemtUxJEWgsTtzv9Zv9P8rvmqNA4eG9TrTRGYc/go-libp2p-peer""
+        ""gx/ipfs/QmU7iTrsNaJfu1Rf5DrvaJLH9wJtQwmP4Dj8oPduprAU68/go-libp2p-swarm""
+        ""gx/ipfs/QmVmDhyTTUcQXFD1rRQ64fGLMSAoaQvNH3hwuaCFAPq2hy/errors""
+        routing ""gx/ipfs/QmWaDSNoSdSXU9b6udyaq9T8y6LkzMwqWxECznFqvtcTsk/go-libp2p-routing""
         ""gx/ipfs/QmZZseAa9xcK6tT3YpaShNUAEpyRAoWmUL5ojH3uGNepAc/go-libp2p-metrics""
         ""gx/ipfs/QmcNGX5RaxPPCYwa6yGXM1EcUbrreTTinixLcYGmMwf1sx/go-libp2p/p2p/protocol/ping""
         ""gx/ipfs/Qmd52WKRSwrBK5gUaJKawryZQ5by6UbNB8KVW2Zy6JtbyW/go-libp2p-host""","Blocking: hey @anorth, this works for me but you blocked this when I first did it so wanted to run it by you to make sure you are on board.",go,0,0,1
"@@ -198,6 +198,7 @@ func (node *Node) cancelBlockSubscription() {
 // Stop initiates the shutdown of the node.
 func (node *Node) Stop() {
 	node.cancelBlockSubscription()
+	node.ChainMgr.BestBlockPubSub.Shutdown()
 
 	if err := node.Host.Close(); err != nil {
 		fmt.Printf(""error closing host: %s\n"", err)","Seems like the chainmgr should shut itself down, rather than the node reaching inside of it. So maybe just have a shutdown or similar on the chainmgr?",go,1,1,1
"@@ -203,14 +203,15 @@ func run(o *Options) error {
 		v4Enabled := config.IsIPv4Enabled(nodeConfig, networkConfig.TrafficEncapMode)
 		v6Enabled := config.IsIPv6Enabled(nodeConfig, networkConfig.TrafficEncapMode)
 		proxyAll := o.config.AntreaProxy.ProxyAll
+		skipServices := o.config.AntreaProxy.SkipServices
 
 		switch {
 		case v4Enabled && v6Enabled:
-			proxier = proxy.NewDualStackProxier(nodeConfig.Name, informerFactory, ofClient, routeClient, nodePortAddressesIPv4, nodePortAddressesIPv6, proxyAll)
+			proxier = proxy.NewDualStackProxier(nodeConfig.Name, informerFactory, ofClient, routeClient, nodePortAddressesIPv4, nodePortAddressesIPv6, proxyAll, skipServices)
 		case v4Enabled:
-			proxier = proxy.NewProxier(nodeConfig.Name, informerFactory, ofClient, false, routeClient, nodePortAddressesIPv4, proxyAll)
+			proxier = proxy.NewProxier(nodeConfig.Name, informerFactory, ofClient, false, routeClient, nodePortAddressesIPv4, proxyAll, skipServices)
 		case v6Enabled:
-			proxier = proxy.NewProxier(nodeConfig.Name, informerFactory, ofClient, true, routeClient, nodePortAddressesIPv6, proxyAll)
+			proxier = proxy.NewProxier(nodeConfig.Name, informerFactory, ofClient, true, routeClient, nodePortAddressesIPv6, proxyAll, skipServices)
 		default:
 			return fmt.Errorf(""at least one of IPv4 or IPv6 should be enabled"")
 		}",should there be a check in options.go with a warning if AntreaProxy is disabled by `len(skipServices) > 0`?,go,1,1,1
"@@ -47,7 +47,7 @@ func GetProjectID(mgce domain.MetadataGCEInterface, projectFlag string) (string,
 
 func populateScratchBucketGcsPath(scratchBucketGcsPath *string, zone string, mgce domain.MetadataGCEInterface,
 	scratchBucketCreator domain.ScratchBucketCreatorInterface, file string, project *string,
-	storageClient domain.StorageClientInterface) (string, error) {
+	storageClient domain.StorageClientInterface, cleanupSharedScratch bool) (string, error) {
 
 	scratchBucketRegion := """"
 	if *scratchBucketGcsPath == """" {","cleanupSharedScratch sounds like the whole scratch bucket is deleted. It also sounds like no other criteria is used to perform this operation, while in reality current project has to be a mismatch for scratch bucket project. Maybe: cleanupFileOnMismatchedProject?",go,1,1,1
"@@ -22,7 +22,7 @@ import (
 
 func injectFoo() Foo {
 	// This non-call statement makes this an invalid injector.
-	 _ = 42
+	_ = 42
 	panic(wire.Build(provideFoo))
 }
 ","Note to reviewers: sorry, this is a random change from running `gofmt`.",go,0,0,1
"@@ -92,13 +92,13 @@ type Image struct {
 // ImageWithHealthcheck represents a container image with health check.
 type ImageWithHealthcheck struct {
 	Image       `yaml:"",inline""`
-	HealthCheck *ContainerHealthCheck `yaml:""healthcheck""`
+	HealthCheck *ContainerHealthCheck `yaml:""healthcheck""` // This is used as a pointer so that we can use `{{- if .ContainerHealthCheck}}` for manifest rendering.
 }
 
 // ImageWithPortAndHealthcheck represents a container image with an exposed port and health check.
 type ImageWithPortAndHealthcheck struct {
 	ImageWithPort `yaml:"",inline""`
-	HealthCheck   *ContainerHealthCheck `yaml:""healthcheck""`
+	HealthCheck   *ContainerHealthCheck `yaml:""healthcheck""` // This is used as a pointer so that we can use `{{- if .ContainerHealthCheck}}` for manifest rendering.
 }
 
 // ImageWithPort represents a container image with an exposed port.",Can we do `{{- if not .ImageConfig.HealthCheck.IsEmpty}}` instead?,go,1,1,1
"@@ -60,8 +60,8 @@ var (
         Default = Config{
                 NodeType: FullNodeType,
                 Network: Network{
-                        Host:                                ""127.0.0.1"",
-                        Port:                                4689,
+                        Host: ""127.0.0.1"",
+                        Port: 4689,
                         MsgLogsCleaningInterval:             2 * time.Second,
                         MsgLogRetention:                     5 * time.Second,
                         HealthCheckInterval:                 time.Second,",File is not `goimports`-ed,go,0,1,1
"@@ -0,0 +1,17 @@
+package webhook
+
+import (
+	""k8s.io/apimachinery/pkg/runtime""
+
+	""github.com/jetstack/cert-manager/pkg/apis/certmanager/v1alpha1""
+	""github.com/jetstack/cert-manager/pkg/internal/apis/certmanager/install""
+)
+
+var (
+	Scheme = runtime.NewScheme()
+)
+
+func init() {
+	v1alpha1.AddToScheme(Scheme)
+	install.Install(Scheme)
+}",I've introduced a dedicated scheme for the webhook instead of `pkg/api` - this scheme has the internal API group registered as well as defaulting and conversion functions registered against `v1alpha1` via `github.com/jetstack/cert-manager/pkg/internal/apis/certmanager/install`,go,1,1,1
"@@ -78,7 +78,7 @@ func (collector *Metrics) Describe(d chan<- *prometheus.Desc) {
 
 func (collector *Metrics) descsByDevice(d chan<- *prometheus.Desc, device *wgtypes.Device) {
         if device == nil {
-                collector.logCtx.Error(""BUG: called descsByDevice with nil device"")
+                collector.logCtx.Debug(""BUG: called descsByDevice with nil device"")
                 return
         }
 ",This one seems like a real error to me,go,0,1,1
"@@ -233,7 +233,15 @@ func (oc *OCSPMonitor) run() {
         quitCh := s.quitCh
         s.mu.Unlock()
 
-        defer s.grWG.Done()
+        var doShutdown bool
+        defer func() {
+                // Need to decrement before shuting down, otherwise shutdown
+                // would be stuck waiting on grWG to go down to 0.
+                s.grWG.Done()
+                if doShutdown {
+                        s.Shutdown()
+                }
+        }()
 
         oc.mu.Lock()
         shutdownOnRevoke := oc.shutdownOnRevoke","@wallyqs @variadico Could you please review this part: what was happening is that when run() decides to call s.Shutdown(), this go routine would be blocked because Shutdown() would be waiting on grWG.Wait() that would never be done because this go routine itself had not yet called s.grWG.Done(). Can you think of if this would have been user-visible? And if so, what would be the symptoms? If not user-visible, this is just a fix that will help make sure that there are not left-over go routines when a test completes.",go,0,1,0
"@@ -41,8 +41,8 @@ func (s *Symlink) Attr(ctx context.Context, a *fuse.Attr) (err error) {
 		return err
 	}
 
-	s.parent.folder.fillAttrWithUIDAndWritePerm(ctx, &de, a)
-	a.Mode = os.ModeSymlink | 0777
+	s.parent.folder.fillAttrWithUIDAndWritePerm(ctx, s.parent.node, &de, a)
+	a.Mode = os.ModeSymlink | a.Mode | 0400
 	return nil
 }
 ",Did you intend to clear the execution bit as well?,go,1,1,1
"@@ -135,9 +135,8 @@ func keyregTxEncode(tx transactions.Transaction, ad transactions.ApplyData) v1.T
 	}
 }
 
-func assetParams(creator basics.Address, params basics.AssetParams) v1.AssetParams {
+func assetParams(creator basics.Address, aidx basics.AssetIndex, params basics.AssetParams) v1.AssetParams {
 	paramsModel := v1.AssetParams{
-		Creator:       creator.String(),
 		Total:         params.Total,
 		DefaultFrozen: params.DefaultFrozen,
 	}",Why pass in `aidx`?,go,1,0,1
"@@ -130,10 +130,11 @@ func (s *Service) deleteVPC() error {
 	_, err := s.scope.EC2.DeleteVpc(input)
 	if err != nil {
 		// Ignore if it's already deleted
-		if code, ok := awserrors.Code(err); code != ""InvalidVpcID.NotFound"" && ok {
-			return errors.Wrapf(err, ""failed to delete vpc %q"", vpc.ID)
+		if code, ok := awserrors.Code(err); code == ""InvalidVpcID.NotFound"" && ok {
+			klog.V(4).Info(""Skipping VPC deletion, VPC not found"")
+			return nil
 		}
-		return err
+		return errors.Wrapf(err, ""failed to delete vpc %q"", vpc.ID)
 	}
 
 	klog.V(2).Infof(""Deleted VPC %q"", vpc.ID)","Nice, +1 on this change. the flow is much easier to read",go,1,0,1
"@@ -69,7 +69,7 @@ var (
 		completeJobCompleted: 9,
 	}
 
-	cancelC chan struct{}
+	cancelC = make(chan struct{})
 )
 
 func initPatch(ctx context.Context) {",why is this change needed?,go,1,0,1
"@@ -464,10 +464,12 @@ func (target *BuildTarget) AllURLs(state *BuildState) []string {
 // resolveDependencies matches up all declared dependencies to the actual build targets.
 // TODO(peterebden,tatskaari): Work out if we really want to have this and how the suite of *Dependencies functions
 //                             below should behave (preferably nicely).
-// TODO(tatskaari): Work out if we can use a channel instead of a callback.
 func (target *BuildTarget) resolveDependencies(graph *BuildGraph, callback func(*BuildTarget) error) error {
 	var g errgroup.Group
-	target.mutex.RLock()
+
+	target.mutex.Lock()
+	defer target.mutex.Unlock()
+
 	for i := range target.dependencies {
 		dep := &target.dependencies[i]
 		if len(dep.deps) > 0 {",Did manage to do this but it wasn't much better because we have to pass the error group back to the caller. Don't think it's really worth changing now.,go,1,1,1
"@@ -35,6 +35,8 @@ var cipherMap = map[string]uint16{
 
 func defaultCipherSuites() []uint16 {
 	return []uint16{
+		tls.TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,
+		tls.TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,
 		tls.TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
 		tls.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
 		tls.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,",I think we should put ECDSA first..,go,1,0,1
"@@ -9,9 +9,9 @@ import (
         ""io/ioutil""
         ""strings""
 
-        ""gopkg.in/editorconfig/editorconfig-core-go.v1""
         ""gopkg.in/macaron.v1""
 
+        ""github.com/editorconfig/editorconfig-core-go/v2""
         ""github.com/gogs/git-module""
 
         ""gogs.io/gogs/internal/db""",This import grouping should be changed.,go,1,0,1
"@@ -24,10 +24,12 @@ type Cleaner struct {
 
 // SessionStorage keeps sessions and allows removing them by proposal id
 type SessionStorage interface {
-	RemoveForService(serviceId string)
+	RemoveForService(serviceID string)
 }
 
 // Cleanup removes sessions of stopped service
-func (cleaner *Cleaner) Cleanup(instance *Instance) {
-	cleaner.SessionStorage.RemoveForService(string(instance.id))
+func (cleaner *Cleaner) Cleanup(event EventPayload) {
+	if event.Status == string(NotRunning) {
+		cleaner.SessionStorage.RemoveForService(event.ID)
+	}
 }","Its probably not a `Cleanup` then, since imho its should be called only once and we don't care about event's state.",go,1,1,1
"@@ -23,13 +23,15 @@ const endpointARNShapeTmplDef = `
 
 		// updateArnableField updates the value of the input field that 
 		// takes an ARN as an input. This method is useful to backfill 
-		// the parsed resource name from ARN into the input member. 
-		func (s *{{ $.ShapeName }}) updateArnableField(v string) error {
+		// the parsed resource name from ARN into the input member.
+		// It returns a pointer to a modified copy of input and an error.
+		// Note that original input is not modified. 
+		func (s {{ $.ShapeName }}) updateArnableField(v string) (interface{}, error) {
 			if s.{{ $name }} == nil {
-				return fmt.Errorf(""member {{ $name }} is nil"")
+				return nil, fmt.Errorf(""member {{ $name }} is nil"")
 			}
 			s.{{ $name }} = aws.String(v)
-			return nil
+			return &s, nil 
 		}
 	{{ end -}}
 {{ end }}","Should this create a copy of `s` before assigning the value, then return the copy?",go,1,1,1
"@@ -503,12 +503,14 @@ type TaskConfig struct {
 }
 
 // TaskPlatform returns the platform for the service.
-func (t *TaskConfig) TaskPlatform() (*string, error) {
-	if t.Platform.PlatformString == nil {
-		return nil, nil
+func (t *TaskConfig) TaskPlatform() *string {
+	if t.Platform.IsEmpty() {
+		return nil
+	}
+	if t.IsWindows() {
+		return aws.String(platformString(OSWindows, t.Platform.Arch()))
 	}
-	val := string(*t.Platform.PlatformString)
-	return &val, nil
+	return aws.String(platformString(t.Platform.OS(), t.Platform.Arch()))
 }
 
 // IsWindows returns whether or not the service is building with a Windows OS.",what if `Arch` is empty? should we instead just return `OSWindows`?,go,1,1,1
"@@ -487,10 +487,17 @@ func (js *jetStream) setupMetaGroup() error {
         // but do not form our own.
         if ln := s.getOpts().LeafNode; len(ln.Remotes) > 0 {
                 sys := s.SystemAccount().GetName()
+        ENDFOR:
                 for _, r := range ln.Remotes {
                         if r.LocalAccount == sys {
+                                for _, denySub := range r.DenyImports {
+                                        if subjectIsSubsetMatch(denySub, ""$NRG.>"") {
+                                                // raft group is denied, hence there won't be anything to observe
+                                                break ENDFOR
+                                        }
+                                }
                                 cfg.Observer = true
-                                break
+                                break ENDFOR
                         }
                 }
         }",Make const that loves in raft.go so we don't break things later on?,go,0,1,1
"@@ -45,8 +45,8 @@ import (
 const (
 	// heartbeatTimeout is the maximum time to wait between heartbeats
 	// without disconnecting
-	heartbeatTimeout = 5 * time.Minute
-	heartbeatJitter  = 3 * time.Minute
+	heartbeatTimeout = 1 * time.Minute
+	heartbeatJitter  = 1 * time.Minute
 
 	inactiveInstanceReconnectDelay = 1 * time.Hour
 ",Why was the jitter removed?,go,1,0,1
"@@ -325,7 +325,7 @@ func (task *Task) initializeVolumes(cfg *config.Config, dockerClient dockerapi.D
 // able to handle such an occurrence appropriately (e.g. behave idempotently).
 func (task *Task) PostUnmarshalTask(cfg *config.Config,
 	credentialsManager credentials.Manager, resourceFields *taskresource.ResourceFields,
-	dockerClient dockerapi.DockerClient, ctx context.Context) error {
+	dockerClient dockerapi.DockerClient, ctx context.Context, options ...Option) error {
 	// TODO, add rudimentary plugin support and call any plugins that want to
 	// hook into this
 	task.adjustForPlatform(cfg)","I like the idea, but call to `PostUnmarshalTask` might become cumbersome with too many options",go,1,1,1
"@@ -7,9 +7,13 @@ package api
 import (
         ""bytes""
         ""errors""
+        ""fmt""
+        ""github.com/ethersphere/bee/pkg/tags""
         ""io""
         ""io/ioutil""
         ""net/http""
+        ""strings""
+        ""time""
 
         ""github.com/ethersphere/bee/pkg/jsonhttp""
         ""github.com/ethersphere/bee/pkg/storage""","Somehow this import is among the stdlib's packages. Not so important, but it would be nice to have it a few lines below within the bee imports. Also noticed in some other places in this pr...",go,0,1,1
"@@ -53,7 +53,7 @@ func (m NoopMetricsClient) RecordDistribution(scope int, timer int, d int) {}
 func (m NoopMetricsClient) UpdateGauge(scope int, gauge int, value float64) {}
 
 func (m NoopMetricsClient) Scope(scope int, tags ...Tag) Scope {
-	return &metricsScope{
+	return &tallyScope{
 		scope:     tally.NoopScope,
 		rootScope: tally.NoopScope,
 	}",It would be great to remove `tally` dependency here. There is `NoopScope` already but it depends on `tally` too. So you will need to create real no-op implementation.,go,1,1,1
"@@ -698,12 +698,15 @@ func (o *Consumer) sendAckReply(subj string) {
 func (o *Consumer) processAck(_ *subscription, _ *client, subject, reply string, msg []byte) {
 	sseq, dseq, dcount, _ := o.ReplyInfo(subject)
 
+	var skipAckReply bool
+
 	switch {
 	case len(msg) == 0, bytes.Equal(msg, AckAck), bytes.Equal(msg, AckOK):
 		o.ackMsg(sseq, dseq, dcount)
 	case bytes.Equal(msg, AckNext):
 		o.ackMsg(sseq, dseq, dcount)
 		o.processNextMsgReq(nil, nil, subject, reply, nil)
+		skipAckReply = true
 	case bytes.Equal(msg, AckNak):
 		o.processNak(sseq, dseq)
 	case bytes.Equal(msg, AckProgress):","I think we should send ack if no new messages can be sent, otherwise just send new message.",go,1,1,1
"@@ -0,0 +1,5 @@
+package xds
+
+type RTDSConfig struct {
+        layerName string
+}",I'm not sure if there's much value in having this be in its own file,go,1,1,1
"@@ -45,8 +45,10 @@ type NetworkPolicySpec struct {
 	// Priority specfies the order of the NetworkPolicy relative to other
 	// NetworkPolicies.
 	Priority float64 `json:""priority""`
-	// Select workloads on which the rules will be applied to.
-	AppliedTo []NetworkPolicyPeer `json:""appliedTo""`
+	// Select workloads on which the rules will be applied to. Cannot be set in
+	// conjunction with AppliedTo in each rule.
+	// +optional
+	AppliedTo []NetworkPolicyPeer `json:""appliedTo,omitempty""`
 	// Set of ingress rules evaluated based on the order in which they are set.
 	// Currently Ingress rule supports setting the `From` field but not the `To`
 	// field within a Rule.",@tnqn do you know of any backwards-compatibility concern when adding `omitempty` to an existing field? I would imagine there isn't one.,go,0,1,1
"@@ -22,7 +22,7 @@ type Dispatcher interface {
 
 // ScheduleFunc is a function that represents work to do.
 // The throughput is the maximum number of messages to process for this scheduling.
-type ScheduleFunc func(throughput int)
+type ScheduleFunc func(ctx context.Context, throughput int)
 
 // poolDispatcher implements Dispatcher using a pool of goroutines.
 type poolDispatcher struct {","For transformations, we carry out the work with this dispatcher which in my understanding is pretty much similar to the executor service we have in Java. When we start to work on a transformation, a span needs to be created to trace this operation. This needs access to the `context.Context` which helps to track the hierarchical structure of the spans.",go,1,1,1
"@@ -60,6 +60,15 @@ func New(st storage.StateStorer, unreserveFunc unreserveFn) (postage.Storer, err
 	return &store{st, cs, rs, unreserveFunc}, nil
 }
 
+func (s *store) GetReserveState() *postage.Reservestate {
+	return &postage.Reservestate{
+		Radius:    s.rs.Radius,
+		Available: s.rs.Available,
+		Outer:     new(big.Int).Set(s.rs.Outer),
+		Inner:     new(big.Int).Set(s.rs.Inner),
+	}
+}
+
 // Get returns a batch from the batchstore with the given ID.
 func (s *store) Get(id []byte) (*postage.Batch, error) {
 	b := &postage.Batch{}",bear in mind you're leaking the package internals here: `Outer` and `Inner` are pointers. It would be prudent to create a copy of them.,go,1,1,1
"@@ -31,7 +31,7 @@ type restBackend struct {
 }
 
 // Open opens the REST backend with the given config.
-func Open(cfg Config, rt http.RoundTripper) (restic.Backend, error) {
+func Open(cfg Config, rt http.RoundTripper) (*restBackend, error) {
 	client := &http.Client{Transport: rt}
 
 	sem, err := backend.NewSemaphore(cfg.Connections)","exported func Open returns unexported type *rest.restBackend, which can be annoying to use",go,1,1,1
"@@ -19,13 +19,13 @@ var SDKVersionUserAgentHandler = request.NamedHandler{
 const execEnvVar = `AWS_EXECUTION_ENV`
 const execEnvUAKey = `exec_env`
 
-// AddHostExecEnvUserAgentHander is a request handler appending the SDK's
+// AddHostExecEnvUserAgentHandler is a request handler appending the SDK's
 // execution environment to the user agent.
 //
 // If the environment variable AWS_EXECUTION_ENV is set, its value will be
 // appended to the user agent string.
-var AddHostExecEnvUserAgentHander = request.NamedHandler{
-	Name: ""core.AddHostExecEnvUserAgentHander"",
+var AddHostExecEnvUserAgentHandler = request.NamedHandler{
+	Name: ""core.AddHostExecEnvUserAgentHandler"",
 	Fn: func(r *request.Request) {
 		v := os.Getenv(execEnvVar)
 		if len(v) == 0 {",Regrettably changing the name of this handler will be a breaking change in the SDK.,go,1,1,1
"@@ -52,7 +52,8 @@ func allowCorsActions(resp http.ResponseWriter, req *http.Request, corsPolicy Co
         allowedOrigin := corsPolicy.AllowedOrigin(requestOrigin)
 
         resp.Header().Set(""Access-Control-Allow-Origin"", allowedOrigin)
-        resp.Header().Set(""Access-Control-Allow-Methods"", ""POST, GET, OPTIONS, PUT, DELETE"")
+        resp.Header().Set(""Access-Control-Allow-Methods"", ""POST, GET, HEAD, OPTIONS, PUT, DELETE"")
+        resp.Header().Set(""Access-Control-Allow-Credentials"", ""true"")
 }
 
 func isPreflightCorsRequest(req *http.Request) bool {",Reason for this?,go,1,0,1
"@@ -72,7 +72,7 @@ var opts struct {
 
 	FeatureFlags struct {
 		NoUpdate           bool    `long:""noupdate"" description:""Disable Please attempting to auto-update itself.""`
-		NoCache            bool    `long:""nocache"" description:""Disable caches (NB. not incrementality)""`
+		NoCache            bool    `long:""nocache"" description:""Deprecated, use plz build --rebuild or plz test --rerun flags instead.""`
 		NoHashVerification bool    `long:""nohash_verification"" description:""Hash verification errors are nonfatal.""`
 		NoLock             bool    `long:""nolock"" description:""Don't attempt to lock the repo exclusively. Use with care.""`
 		KeepWorkdirs       bool    `long:""keep_workdirs"" description:""Don't clean directories in plz-out/tmp after successfully building targets.""`",This is confusingly named. Feature flags are what I'm calling the things that gate breaking changes between releases. Might want to revisit this.,go,1,1,1
"@@ -36,7 +36,7 @@ type Cgroup struct {
 type Resources struct {
 	// If this is true allow access to any kind of device within the container.  If false, allow access only to devices explicitly listed in the allowed_devices list.
 	// Deprecated
-	AllowAllDevices bool `json:""allow_all_devices,omitempty""`
+	AllowAllDevices *bool `json:""allow_all_devices,omitempty""`
 	// Deprecated
 	AllowedDevices []*Device `json:""allowed_devices,omitempty""`
 	// Deprecated",Why did you drop the `omitempty` tag? That is meant to qualify if a field is optional or not.,go,1,1,1
"@@ -144,6 +144,17 @@ func blockGetCert(tx *sql.Tx, rnd basics.Round) (blk bookkeeping.Block, cert agr
 	return
 }
 
+func blockReplaceIfExists(tx *sql.Tx, blk bookkeeping.Block, cert agreement.Certificate) error {
+	_, err := tx.Exec(""UPDATE blocks SET proto=?, hdrdata=?, blkdata=?, certdata=? WHERE rnd=?"",
+		blk.CurrentProtocol,
+		protocol.Encode(&blk.BlockHeader),
+		protocol.Encode(&blk),
+		protocol.Encode(&cert),
+		blk.Round(),
+	)
+	return err
+}
+
 func blockPut(tx *sql.Tx, blk bookkeeping.Block, cert agreement.Certificate) error {
 	var max sql.NullInt64
 	err := tx.QueryRow(""SELECT MAX(rnd) FROM blocks"").Scan(&max)","Can you examine the result and return bool which indicates if the row was updated or not ? ( and it case it was updated, write an info line to the log file )",go,1,1,1
"@@ -40,6 +40,7 @@ type (
 	// disable them.
 	host struct{}
 
+	// stringDetector is a Detector that provides information about the
 	stringDetector struct {
 		schemaURL string
 		K         attribute.Key",This is an incomplete sentence. Maybe something got cutoff?,go,1,1,1
"@@ -66,6 +66,12 @@ func (i *interpreter) LoadBuiltins(filename string, contents []byte, statements
 		return err
 	} else if len(contents) != 0 {
 		stmts, err := i.parser.ParseData(contents, filename)
+		for _, stmt := range stmts {
+			if stmt.FuncDef != nil {
+				stmt.FuncDef.KeywordsOnly = !whitelistedKwargs(stmt.FuncDef.Name, filename)
+				stmt.FuncDef.IsBuiltin = true
+			}
+		}
 		return i.loadBuiltinStatements(s, stmts, err)
 	}
 	stmts, err := i.parser.parse(filename)",This got lost in the embedding switchover - moving the code to here so we only do this to the actual builtins (to mimic previous behaviour),go,1,1,1
"@@ -563,6 +563,7 @@ func makeStatefulSetSpec(p monitoringv1.Prometheus, c *Config, ruleConfigMapName
 		},
 	}
 
+	promVolumeMounts = append(promVolumeMounts, p.Spec.VolumeMounts...)
 	for _, name := range ruleConfigMapNames {
 		promVolumeMounts = append(promVolumeMounts, v1.VolumeMount{
 			Name:      name,",I am guessing this won't interfere with the merge patch we do?,go,0,1,1
"@@ -49,6 +49,8 @@ const (
 	DeviceETUpdatedSuffix = ""/updated""
 	// DeviceETStateUpdateSuffix the topic suffix for device state update event
 	DeviceETStateUpdateSuffix = ""/state/update""
+	// DeviceETStateUpdateResultSuffix the topic suffix for device state update result event
+	DeviceETStateUpdateResultSuffix = ""/state/update/result""
 	// DeviceETStateGetSuffix the topic suffix for device state get event
 	DeviceETStateGetSuffix = ""/state/get""
 ","there're some codes that also can be replaced by this new topic in edge/test/integration/device/device_test.go, we can modify those also.",go,1,1,1
"@@ -88,6 +88,16 @@ type BareRootMetadataV3 struct {
 	// of writing to the given folder.
 	FinalizedInfo *tlf.HandleExtension `codec:""fi,omitempty""`
 
+	// The sequence number of the global Keybase Merkle tree at the
+	// time this update was created (from the writer's perspective).
+	// This field was added to V3 after it was live for a while, and
+	// older clients that don't know about this field yet might copy
+	// it into new updates via the unknown fields copier. Which means
+	// new MD updates might end up referring to older Merkle roots.
+	// That's ok since this is just a hint anyway, and shouldn't be
+	// fully trusted when checking MD updates against the Merkle tree.
+	KBMerkleSeqNo MerkleSeqNo `codec:""msn,omitempty""`
+
 	codec.UnknownFieldSetHandler
 }
 ",What are the implication of this once we start checking merkle tree in KBFS clients? Does this make verification more expensive?,go,1,1,1
"@@ -18,7 +18,7 @@ import (
 	""net/http""
 	""time""
 
-	""istio.io/fortio/log""
+	""fortio.org/fortio/log""
 	""istio.io/tools/isotope/convert/pkg/graph/svc""
 	""istio.io/tools/isotope/convert/pkg/graph/svctype""
 	""istio.io/tools/isotope/service/pkg/srv/prometheus""",File is not `goimports`-ed (from `goimports`),go,0,1,1
"@@ -65,6 +65,10 @@ type Harness interface {
         // MaxBatchSizes returns the maximum size of SendBatch/Send(Na|A)cks, or 0
         // if there's no max.
         MaxBatchSizes() (int, int)
+
+        // SupportsMultipleSubscriptions returns true iff the provider supports
+        // multiple subscriptions for the same topic.
+        SupportsMultipleSubscriptions() bool
 }
 
 // HarnessMaker describes functions that construct a harness for running tests.",s/returns true iff/reports whether/,go,1,1,0
"@@ -262,7 +262,7 @@ func acceptedEncodings(r *http.Request) []string {
                 return []string{}
         }
 
-        var prefs []encodingPreference
+        prefs := []encodingPreference{}
 
         for _, accepted := range strings.Split(acceptEncHeader, "","") {
                 parts := strings.Split(accepted, "";"")","_sniff_ Is this the smell of... bikeshedding? :laughing: Or is this an actual lint warning? If so, why? (Personally I prefer the `var` syntax to explicitly make the definition a zero initialization)",go,1,1,1
"@@ -607,7 +607,7 @@ func (sm *Miner) submitPoSt(start, end *types.BlockHeight, inputs []generatePost
 		return
 	}
 	if len(faults) != 0 {
-		log.Errorf(""some faults when generating PoSt: %v"", faults)
+		log.Warningf(""some faults when generating PoSt: %v"", faults)
 		// TODO: proper fault handling
 	}
 ",As per the CONTRIBUTING.md doc: > Error: a truly unexpected condition that should not happen in Real Life and that a dev should go look at I don't think that a PoSt fault should cause a developer to go scrambling. I think you made the right choice to change this log entry to be a warning.,go,1,1,1
"@@ -255,7 +255,7 @@ func (s *Service) getAPIServerClassicELBSpec() (*infrav1.ClassicELB, error) {
 			},
 		},
 		HealthCheck: &infrav1.ClassicELBHealthCheck{
-			Target:             fmt.Sprintf(""%v:%d"", infrav1.ClassicELBProtocolSSL, 6443),
+			Target:             fmt.Sprintf(""%v:%d"", infrav1.ClassicELBProtocolTCP, 6443),
 			Interval:           10 * time.Second,
 			Timeout:            5 * time.Second,
 			HealthyThreshold:   5,","I'd rather update the listeners/health checks to use custom order/set of SSL ciphers. If not possible, we might want to compare our list with the ELB one cc @randomvariable",go,0,1,1
"@@ -160,7 +160,12 @@ func RemoveContainers(isEdgeNode bool, execer utilsexec.Interface) error {
 }
 
 func cleanDirectories(isEdgeNode bool) error {
-	var dirToClean = []string{""/var/lib/edged"", ""/etc/kubeedge""}
+	var dirToClean = []string{
+		""/var/lib/edged"",
+		""/etc/kubeedge"",
+		""/var/lib/kubeedge"",
+		""/var/log/kubeedge"",
+	}
 
 	if isEdgeNode {
 		dirToClean = append(dirToClean, ""/var/lib/dockershim"", ""/var/run/kubernetes"", ""/var/lib/cni"")",try use existed const in keadm,go,1,0,1
"@@ -315,6 +315,10 @@ func assetTransferTxEncode(tx transactions.Transaction, ad transactions.ApplyDat
 		xfer.CloseTo = tx.AssetTransferTxnFields.AssetCloseTo.String()
 	}
 
+	if ad.AssetClosingAmount != 0 {
+		xfer.CloseToAmount = ad.AssetClosingAmount
+	}
+
 	return v1.Transaction{
 		AssetTransfer: &xfer,
 	}",why do we care about v1?,go,1,0,1
"@@ -19,6 +19,7 @@ import (
 
 // mspPlumbing is the subset of the plumbing.API that MinerSetPrice uses.
 type mspPlumbing interface {
+	MessagePreview(ctx context.Context, from, to address.Address, method string, params ...interface{}) (types.GasUnits, error)
 	MessageSend(ctx context.Context, from, to address.Address, value *types.AttoFIL, gasPrice types.AttoFIL, gasLimit types.GasUnits, method string, params ...interface{}) (cid.Cid, error)
 	MessageWait(ctx context.Context, msgCid cid.Cid, cb func(*types.Block, *types.SignedMessage, *types.MessageReceipt) error) error
 	ConfigSet(dottedKey string, jsonString string) error",`PreviewMinerSetPrice` should define its own plumbing that replaces `MessageSend` with `MessagePreview`.,go,1,1,1
"@@ -67,14 +67,14 @@ TLS certificates from various issuing sources.
 It will ensure certificates are valid and up to date periodically, and attempt
 to renew certificates at an appropriate time before expiry.`,
 
-		// TODO: Refactor this function from this package
-		Run: func(cmd *cobra.Command, args []string) {
+		RunE: func(cmd *cobra.Command, args []string) error {
 			if err := o.Validate(args); err != nil {
-				logf.Log.Error(err, ""error validating options"")
+				return fmt.Errorf(""error validating options: %s"", err)
 			}
 
 			logf.Log.Info(""starting controller"", ""version"", util.AppVersion, ""git-commit"", util.AppGitCommit)
 			o.RunCertManagerController(stopCh)
+			return nil
 		},
 	}
 ","How does RunE handle displaying errors to users? Would we be better to use `Run` as before so that we can control the output format? Don't think it's a big deal, but I'm just uncertain how RunE actually works  ",go,1,1,1
"@@ -111,8 +111,9 @@ func (m *manager) updatePodStatus() {
 		err := m.metaClient.PodStatus(pod.Namespace).Update(pod.Name, edgeapi.PodStatusRequest{UID: pod.UID, Name: pod.Name, Status: s})
 		if err != nil {
 			klog.Errorf(""Update pod status failed err :%v"", err)
+			return
 		}
-		klog.Infof(""Status for pod %s updated successfully: %+v"", pod.Name, podStatus)
+		klog.V(4).Infof(""Status for pod %s updated successfully"", pod.Name)
 		m.apiStatusVersions[pod.UID] = podStatus.DeepCopy()
 	}
 }",We should return here instead of adding the else. :),go,1,1,1
"@@ -267,6 +267,13 @@ func (c *{{ .API.StructName }}) {{ .ExportedName }}Request(` +
 	{{- end }}
 
 	{{- if .EndpointDiscovery }}
+		
+		// if a custom endpoint is provided for the request, 
+        // we skip endpoint discovery workflow
+		if req.Config.Endpoint != nil {
+			return
+		}
+
 		{{- if not .EndpointDiscovery.Required }}
 			if aws.BoolValue(req.Config.EnableEndpointDiscovery) {
 		{{- end }}","Nit spacing. also this if statement should wrap the endpoint discovery generated logic, instead of exit early.",go,1,1,1
"@@ -113,6 +113,7 @@ NETWORK COMMANDS
   go-filecoin id                     - Show info about the network peers
   go-filecoin ping <peer ID>...      - Send echo request packets to p2p network members
   go-filecoin swarm                  - Interact with the swarm
+  go-filecoin stats                  - Monitor statistics on your network usage
 
 ACTOR COMMANDS
   go-filecoin actor                  - Interact with actors. Actors are built-in smart contracts.",nit: this maybe fits better under the tools heading,go,1,1,1
"@@ -80,6 +80,12 @@ func TestIssuingController(t *testing.T) {
 		secretName               = ""test-crt-tls""
 	)
 
+	// Create Namespace
+	_, err := kubeClient.CoreV1().Namespaces().Create(context.TODO(), &corev1.Namespace{ObjectMeta: metav1.ObjectMeta{Name: namespace}}, metav1.CreateOptions{})
+	if err != nil {
+		t.Fatal(err)
+	}
+
 	// Create a new private key
 	sk, err := utilpki.GenerateRSAPrivateKey(2048)
 	if err != nil {",Where were these namespaces coming before? Why are they now being created here now?,go,1,1,1
"@@ -189,13 +189,13 @@ func (c *Operator) Run(stopc <-chan struct{}) error {
 	go func() {
 		v, err := c.kclient.Discovery().ServerVersion()
 		if err != nil {
-			errChan <- fmt.Errorf(""communicating with server failed: %s"", err)
+			errChan <- errors.Wrap(err, ""communicating with server failed"")
 			return
 		}
 		c.logger.Log(""msg"", ""connection established"", ""cluster-version"", v)
 
 		if err := c.createTPRs(); err != nil {
-			errChan <- err
+			errChan <- errors.Wrap(err, ""creating TPRs failed"")
 			return
 		}
 		errChan <- nil",Is this function rather a candidate for `sync/errgroup` as well?,go,1,1,1
"@@ -243,6 +243,7 @@ func buildControllerContext(ctx context.Context, stopCh <-chan struct{}, opts *o
 		Client:                    cl,
 		CMClient:                  intcl,
 		GWClient:                  gwcl,
+		Discovery:                 cl.Discovery(),
 		Recorder:                  recorder,
 		KubeSharedInformerFactory: kubeSharedInformerFactory,
 		SharedInformerFactory:     sharedInformerFactory,",nit: should this be `DiscoveryClient`?,go,1,0,1
"@@ -29,6 +29,13 @@ import (
 	""sigs.k8s.io/controller-runtime/pkg/client""
 )
 
+const (
+	// AnnotationCleanFinalizer key
+	AnnotationCleanFinalizer = `chaos-mesh/cleanFinalizer`
+	// AnnotationCleanFinalizerForced value
+	AnnotationCleanFinalizerForced = `forced`
+)
+
 // Reconciler for common chaos
 type Reconciler struct {
 	reconciler.InnerReconciler",It seems we should define the annotation key prefix for chaos-mesh. What about `chaosmesh.pingcap.com/` @zhouqiang-cl @cwen0,go,0,1,1
"@@ -453,7 +453,8 @@ var buildFunctions = map[string]func() bool{
                                         config.Cache.RPCURL = """"
                                         config.Cache.HTTPURL = """"
                                 }
-                                clean.Clean(config, newCache(config), !opts.Clean.NoBackground)
+                                state := core.NewBuildState(1, nil, 4, config)
+                                clean.Clean(config, newCache(state), !opts.Clean.NoBackground)
                                 return true
                         }
                         opts.Clean.Args.Targets = core.WholeGraph",This feels a bit odd too - what are these magic numbers?,go,1,1,1
"@@ -347,6 +347,8 @@ func Main() int {
 		}
 	}
 
+	// todo - I wonder can these go away because of
+	// https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#admission-webhook-metrics
 	validationTriggeredCounter := prometheus.NewCounter(prometheus.CounterOpts{
 		Name: ""prometheus_operator_rule_validation_triggered_total"",
 		Help: ""Number of times a prometheusRule object triggered validation"",","It would be worth checking. Reading the docs, I'm not sure how the metrics look like when `failurePolicy` is `None`.",go,1,1,1
"@@ -17,3 +17,5 @@ var (
         GenerateCommonBinPrefixes = generateCommonBinPrefixes
         PeerPingPollTime          = &peerPingPollTime
 )
+
+type PeerFilterFunc = peerFilterFunc",is this used anywhere?,go,1,0,1
"@@ -107,6 +107,7 @@ func (b *bucket) Attributes(ctx context.Context, key string) (driver.Attributes,
 	}
 	return driver.Attributes{
 		ContentType: xa.ContentType,
+		Metadata:    xa.Metadata,
 		ModTime:     info.ModTime(),
 		Size:        info.Size(),
 	}, nil",This is missing a pass to lowercase all the keys.,go,1,1,1
"@@ -186,7 +186,8 @@ func CIDRFromCalicoNet(ipNet calinet.IPNet) CIDR {
 
 func CIDRFromIPNet(ipNet *net.IPNet) CIDR {
 	ones, _ := ipNet.Mask.Size()
-	ip := FromNetIP(ipNet.IP)
+	// Mask the IP before creating the CIDR so that we have it in canonical format.
+	ip := FromNetIP(getMaskedIp(ipNet))
 	if ip.Version() == 4 {
 		return V4CIDR{
 			addr:   ip.(V4Addr),","I think the stdlib's `net.IP` has a `Mask()` method, does that do what we need?",go,1,1,1
"@@ -57,7 +57,7 @@ func (c *Controller) CreateStoragePool(spcGot *apis.StoragePoolClaim, reSync boo
 		glog.Errorf(""Could not acquire lease on spc object:%v"", err)
 		return err
 	}
-	glog.Info(""Lease acquired successfully on storagepoolclaim %s "", spcGot.Name)
+	glog.Infof(""Lease acquired successfully on storagepoolclaim %s "", spcGot.Name)
 
 	defer newSpcLease.Release()
 ","Formatting directive present, `glog.Infof` should be used instead.",go,1,1,1
"@@ -26,6 +26,12 @@ var (
 	// Timers
 	amTimer = metrics.NewTimerMs(""consensus/apply_message"", ""Duration of message application in milliseconds"", msgMethodKey)
 	pbTimer = metrics.NewTimerMs(""consensus/process_block"", ""Duration of block processing in milliseconds"")
+	ptTimer = metrics.NewTimerMs(""consensus/process_tipset"", ""Duration of tipset processing in milliseconds"")
+
+	// Sizes
+	pbSize = metrics.NewInt64ByteBucket(""consensus/block_size"", ""The size in bytes of a block"")
+	amSize = metrics.NewInt64ByteBucket(""consensus/message_size"", ""The size in bytes of a message"", msgMethodKey)
+	tsSize = metrics.NewInt64ByteBucket(""consensus/tipset_size"", ""The size in bytes of a tipset"")
 )
 
 // BlockRewarder applies all rewards due to the miner's owner for processing a block including block reward and gas",IMO these names are too brief now there are so many.,go,1,1,1
"@@ -701,6 +701,8 @@ func (r *ReconcileClusterDeployment) startNewProvision(
                 }
         }
 
+        extraEnvVars := getInstallLogEnvVars(cd.Name)
+
         podSpec, err := install.InstallerPodSpec(
                 cd,
                 provisionName,",Are we retiring the PVC creating code right above here as part of this PR?,go,0,1,1
"@@ -43,13 +43,13 @@ func addTestingTsfBlocks(bc Blockchain) error {
         tsf0, _ := action.NewTransfer(
                 1,
                 big.NewInt(3000000000),
-                Gen.CreatorAddr(config.Default.Chain.ID),
+                Gen.CreatorAddr(),
                 ta.Addrinfo[""producer""].Bech32(),
                 []byte{}, uint64(100000),
                 big.NewInt(10),
         )
         pubk, _ := keypair.DecodePublicKey(Gen.CreatorPubKey)
-        sig, _ := hex.DecodeString(""b14516e888e78e8dcba9af59607c8deea404f52c3df706a0bb6e1fadfda58113983b9201400ff75202fe486363a2e99052b3866595be932542bc0b860278b0753ab3fd2c66764a01"")
+        sig, _ := hex.DecodeString(""3584fe777dd090e1a7a825896f532485ea2cc35d7c300c6c56f0e2e78b51c6ded33f7d0069f4f6f6b6762306466fcff6f261bb30d9e1550f2f8be4f988e740903fd734209cb60101"")
         bd := &action.EnvelopeBuilder{}
         elp := bd.SetAction(tsf0).
                 SetDestinationAddress(ta.Addrinfo[""producer""].Bech32()).",line is 175 characters (from `lll`),go,1,0,1
"@@ -242,7 +242,7 @@ returns a spiffeid->registration entries map
 This map is used generated CSR for non-base SVIDs and update the agent cache entries
 */
 func (a *Agent) attest() (map[string]*common.RegistrationEntry, error) {
-        a.config.Log.Info(""Preparing to attest against %s"", a.config.ServerAddress.String())
+        a.config.Log.Info(""Preparing to attest against"", a.config.ServerAddress.String())
 
         plugins := a.Catalog.NodeAttestors()
         if len(plugins) != 1 {",Do we need a space at the end like the one below?,go,1,1,1
"@@ -35,6 +35,10 @@ type ConfigRunner struct {
 
 	// Must not be nil if using default subnets.
 	VPCGetter VPCGetter
+
+	// Platform configuration
+	OS   string
+	Arch string
 }
 
 // Run runs tasks given subnets, security groups and the cluster, and returns the tasks.",Is `Arch` used anywhere? (Same for env_runner.go),go,1,1,1
"@@ -649,6 +649,8 @@ func (k *KeybaseServiceBase) GetTLFCryptKeys(ctx context.Context,
 		return keybase1.GetTLFCryptKeysRes{}, err
 	}
 
+	ctx = context.WithValue(ctx, CtxNoAddToFavoriteKey{}, true)
+
 	tlfHandle, err := k.getHandleFromFolderName(ctx, query.TlfName, false)
 	if err != nil {
 		return res, err","`true` seems weird, since setting it to `false` doesn't do the opposite. Maybe just set it to `struct{}{}`?",go,1,1,1
"@@ -161,12 +161,9 @@ func (a *ACME) Sign(ctx context.Context, cr *v1alpha2.CertificateRequest, issuer
 
         // If the acme order has failed then so too does the CertificateRequest meet the same fate.
         if acme.IsFailureState(order.Status.State) {
-                message := fmt.Sprintf(""Failed to wait for order resource %s/%s to become ready"",
-                        expectedOrder.Namespace, expectedOrder.Name)
-                err := fmt.Errorf(""order is in %q state"", order.Status.State)
-
+                message := fmt.Sprintf(""Failed to wait for order resource %q to become ready"", expectedOrder.Name)
+                err := fmt.Errorf(""order is in %q state: %s"", order.Status.State, order.Status.Reason)
                 a.reporter.Failed(cr, err, ""OrderFailed"", message)
-
                 return nil, nil
         }
 ","In the PR description you say that this extra event information will also show up in `kubectl describe certificate`, but I only the error message being associated with a `cr` resource...a `CertificateRequest` Or does the reporter also find the associated Certificate and Order resources and add events for those too?",go,1,1,0
"@@ -1276,6 +1276,7 @@ func (api *Server) getLogsInBlock(filter *LogFilter, start, count uint64) ([]*io
 	return logs, nil
 }
 
+// TODO: Since GasConsumed on the receipt may not be enough for the gas limit, we use binary search for the gas estimate. Need a better way to address it later.
 func (api *Server) estimateActionGasConsumptionForExecution(exec *iotextypes.Execution, sender string) (*iotexapi.EstimateActionGasConsumptionResponse, error) {
 	sc := &action.Execution{}
 	if err := sc.LoadProto(exec); err != nil {",line is 160 characters (from `lll`),go,1,0,1
"@@ -106,6 +106,8 @@ type ServerConfig struct {
 	AlertsFilterDeleter alerts.FilterDeleter
 	// StoragePolicy Manager
 	StoragePolicy policy.PolicyManager
+	// StoragePoolServer is the interface to manage storage pools in the cluster
+	StoragePoolServer api.OpenStoragePoolServer
 	// Security configuration
 	Security *SecurityConfig
 	// ServerExtensions allows you to extend the SDK gRPC server","There should be a 'fake' in-memory pool server handler added to OpenStorage so that it can be served in the mock-sdk-server. If this is too difficult, then the server must handler a `nil` pool server handler.",go,1,1,1
"@@ -212,8 +212,8 @@ func (s *engine2Suite) TestRecordWorkflowTaskStartedSuccessStickyExpired() {
 	expectedResponse := historyservice.RecordWorkflowTaskStartedResponse{}
 	expectedResponse.WorkflowType = msBuilder.GetWorkflowType()
 	executionInfo = msBuilder.GetExecutionInfo()
-	if executionInfo.LastProcessedEvent != common.EmptyEventID {
-		expectedResponse.PreviousStartedEventId = executionInfo.LastProcessedEvent
+	if executionInfo.LastWorkflowTaskCompleteId != common.EmptyEventID {
+		expectedResponse.PreviousStartedEventId = executionInfo.LastWorkflowTaskCompleteId
 	}
 	expectedResponse.ScheduledEventId = di.ScheduleID
 	expectedResponse.ScheduledTime = di.ScheduledTime","is LastProcessedEvent always be WFT completed event? Could it be ActivityTaskCompleted or anything else? Here what is the PreviousStartedEventId? It does not sound right that you set a ""StartedEventId"" as WFTCompleted event id.",go,1,1,1
"@@ -4,6 +4,7 @@ import (
 	""github.com/rancher/k3s/pkg/version""
 	""github.com/rancher/spur/cli""
 	""github.com/rancher/spur/cli/altsrc""
+	""time""
 )
 
 const (",Can you move this to where the stdlib imports are?,go,1,1,1
"@@ -17,15 +17,12 @@ import (
 
 // V1 is a singleton and defines V1 address metadata
 var V1 = v1{
-	AddressLength: 21,
-	Version:       1,
+	AddressLength: 20,
 }
 
 type v1 struct {
 	// AddressLength indicates the byte length of an address
 	AddressLength int
-	// Version indicates the version number
-	Version uint8
 }
 
 // New constructs an address struct",Do we need AddressLength then?,go,1,0,1
"@@ -21,7 +21,6 @@ type idCacheKey struct {
 // internally by just their block ID (since blocks are immutable and
 // content-addressable).
 type BlockCacheStandard struct {
-        config             Config
         cleanBytesCapacity uint64
 
         ids *lru.Cache",Looks like we don't need this anymore,go,1,0,1
"@@ -28,12 +28,12 @@ import (
 // marshalling. See the following issue for details:
 // https://github.com/prometheus/alertmanager/issues/1985
 type alertmanagerConfig struct {
-	Global            *globalConfig      `yaml:""global,omitempty"" json:""global,omitempty""`
-	Route             *route             `yaml:""route,omitempty"" json:""route,omitempty""`
-	InhibitRules      []*inhibitRule     `yaml:""inhibit_rules,omitempty"" json:""inhibit_rules,omitempty""`
-	Receivers         []*receiver        `yaml:""receivers,omitempty"" json:""receivers,omitempty""`
-	MuteTimeIntervals []muteTimeInterval `yaml:""mute_time_intervals,omitempty"" json:""mute_time_intervals,omitempty""`
-	Templates         []string           `yaml:""templates"" json:""templates""`
+	Global            *globalConfig       `yaml:""global,omitempty"" json:""global,omitempty""`
+	Route             *route              `yaml:""route,omitempty"" json:""route,omitempty""`
+	InhibitRules      []*inhibitRule      `yaml:""inhibit_rules,omitempty"" json:""inhibit_rules,omitempty""`
+	Receivers         []*receiver         `yaml:""receivers,omitempty"" json:""receivers,omitempty""`
+	MuteTimeIntervals []*muteTimeInterval `yaml:""mute_time_intervals,omitempty"" json:""mute_time_intervals,omitempty""`
+	Templates         []string            `yaml:""templates"" json:""templates""`
 }
 
 type globalConfig struct {",Why changing to a slice of pointers?,go,1,0,1
"@@ -296,5 +296,7 @@ func logCollectedErrors(stderr io.Reader) {
 	if err != nil {
 		log.Println(err)
 	}
-	log.Println(""Error extracting modules:\n\t"", strings.Join(errors, ""\n\t""))
+	if len(errors) > 0 {
+		log.Println(""Error extracting modules:\n\t"", strings.Join(errors, ""\n\t""))
+	}
 }",Are format strings supported for Println (not printf)?,go,1,1,1
"@@ -452,11 +452,12 @@ func (c *Controller) addNodeRoute(nodeName string, node *v1.Node) error {
 	}
 	peerGatewayIP := ip.NextIP(peerPodCIDRAddr)
 
+	ipsecTunOFPort := int32(0)
 	if c.networkConfig.EnableIPSecTunnel {
 		// Create a separate tunnel port for the Node, as OVS IPSec monitor needs to
 		// read PSK and remote IP from the Node's tunnel interface to create IPSec
 		// security policies.
-		if err = c.createIPSecTunnelPort(nodeName, peerNodeIP); err != nil {
+		if ipsecTunOFPort, err = c.createIPSecTunnelPort(nodeName, peerNodeIP); err != nil {
 			return err
 		}
 	}",you use an `int32` here but it seems that the rest of the code uses `uint32` pretty consistently (at least the OF client code does)?,go,1,1,1
"@@ -165,7 +165,7 @@ func newVRequest(cert *x509.Certificate) *certificate.Request {
 	req.CustomFields = []certificate.CustomField{
 		{
 			Type:  certificate.CustomFieldOrigin,
-			Value: ""Jetstack cert-manager"",
+			Value: ""cert-manager"",
 		},
 	}
 	return req",Maybe use `util.CertManagerUserAgent` here too?,go,1,1,1
"@@ -49,10 +49,11 @@ const (
 	rootURL           = ""https://www.jottacloud.com/jfs/""
 	apiURL            = ""https://api.jottacloud.com/""
 	baseURL           = ""https://www.jottacloud.com/""
-	tokenURL          = ""https://id.jottacloud.com/auth/realms/jottacloud/protocol/openid-connect/token""
+	defaultTokenURL   = ""https://id.jottacloud.com/auth/realms/jottacloud/protocol/openid-connect/token""
 	cachePrefix       = ""rclone-jcmd5-""
 	configDevice      = ""device""
 	configMountpoint  = ""mountpoint""
+	configTokenURL    = ""tokenURL""
 	configVersion     = 1
 )
 ",`configAuthURL` is unused (from `deadcode`),go,1,1,1
"@@ -234,7 +234,8 @@ func (g *gen) inject(pos token.Pos, name string, sig *types.Signature, set *Prov
                         }
                         if g.values[c.valueExpr] == """" {
                                 t := c.valueTypeInfo.TypeOf(c.valueExpr)
-                                name := disambiguate(""_wire""+export(typeVariableName(t))+""Value"", g.nameInFileScope)
+
+                                name := typeVariableName(t, """", func(name string) string { return ""_wire"" + export(name) + ""Value"" }, g.nameInFileScope)
                                 g.values[c.valueExpr] = name
                                 pendingVars = append(pendingVars, pendingVar{
                                         name:     name,",It was surprising to me that this default is the empty string. I realize root cause and remarked below.,go,0,0,1
"@@ -158,7 +158,7 @@ func consumerConnectFlow(t *testing.T, tequilapi *tequilapi_client.Client, consu
 	assert.Equal(t, ""New"", se.Status)
 
 	// Wait some time for session to collect stats.
-	time.Sleep(2 * time.Second)
+	time.Sleep(4 * time.Second)
 
 	err = tequilapi.ConnectionDestroy()
 	assert.NoError(t, err)","Lets do ""eventually"" approach here instead of constant timeout increase",go,1,1,1
"@@ -349,6 +349,17 @@ func (f *Folder) isWriter(ctx context.Context) (bool, error) {
 	}
 	f.handleMu.RLock()
 	defer f.handleMu.RUnlock()
+	if f.h.Type() == tlf.SingleTeam {
+		tid, err := f.h.FirstResolvedWriter().AsTeam()
+		if err != nil {
+			return false, err
+		}
+		isWriter, err := f.fs.config.KBPKI().IsTeamWriter(ctx, tid, session.UID)
+		if err != nil {
+			return false, err
+		}
+		return isWriter, nil
+	}
 	return f.h.IsWriter(session.UID), nil
 }
 ",It seems this will be called pretty often. Do we need a short TTL cache in `libkbfs`?,go,1,1,1
"@@ -448,8 +448,14 @@ func (node *Node) setupMining(ctx context.Context) error {
 	}
 	node.SectorStore = sstore
 
+	// configure the underlying sector store, defaulting to the non-test version
+	sectorStoreType := proofs.Live
+	if os.Getenv(""FIL_USE_SMALL_SECTORS"") == ""true"" {
+		sectorStoreType = proofs.ProofTest
+	}
+
 	// initialize a sector builder
-	sectorBuilder, err := initSectorBuilderForNode(ctx, node)
+	sectorBuilder, err := initSectorBuilderForNode(ctx, node, sectorStoreType)
 	if err != nil {
 		return errors.Wrap(err, ""failed to initialize sector builder"")
 	}",Is this a change in default behavior? eg is the nightly cluster going to start taking much longer to seal? cc @gmasgras @frrist We should ensure the test/nightly cluster has the kind of sectors we want. I think we want it to seal quickly. Follow up with frrist/gmasgras?,go,0,1,1
"@@ -75,7 +75,7 @@ func (o *Operator) createOrUpdateRuleConfigMaps(t *monitoringv1.ThanosRuler) ([]
 		level.Debug(o.logger).Log(
 			""msg"", ""no PrometheusRule changes"",
 			""namespace"", t.Namespace,
-			""prometheus"", t.Name,
+			""thanos"", t.Name,
 		)
 		currentConfigMapNames := []string{}
 		for _, cm := range currentConfigMaps {","Not sure, but which one is better `thanos` or `thanos ruler`?",go,1,1,1
"@@ -72,6 +72,9 @@ func (f MigrateRepo) ParseRemoteAddr(user *db.User) (string, error) {
 		if len(f.AuthUsername)+len(f.AuthPassword) > 0 {
 			u.User = url.UserPassword(f.AuthUsername, f.AuthPassword)
 		}
+		if u.Scheme == ""git"" && u.Port() != """" && (strings.Contains(remoteAddr, ""%0d"") || strings.Contains(remoteAddr, ""%0a"")) {
+			return """", db.ErrInvalidCloneAddr{IsURLError: true}
+		}
 		remoteAddr = u.String()
 	} else if !user.CanImportLocal() {
 		return """", db.ErrInvalidCloneAddr{IsPermissionDenied: true}",Why is checking `u.Scheme` and `u.Port()` necessary? Shouldn't we disallow malicious chars in all cases?,go,1,1,1
"@@ -208,7 +208,7 @@ func (arch *Archiver) loadSubtree(ctx context.Context, node *restic.Node) *resti
 
 // SaveDir stores a directory in the repo and returns the node. snPath is the
 // path within the current snapshot.
-func (arch *Archiver) SaveDir(ctx context.Context, snPath string, fi os.FileInfo, dir string, previous *restic.Tree) (d FutureTree, err error) {
+func (arch *Archiver) SaveDir(ctx context.Context, snPath string, fi os.FileInfo, dir string, previous *restic.Tree, complete CompleteFunc) (d FutureTree, err error) {
 	debug.Log(""%v %v"", snPath, dir)
 
 	treeNode, err := arch.nodeFromFileInfo(dir, fi)",Could the callback be a field on the Archiver instead?,go,1,1,1
"@@ -894,12 +894,17 @@ var (
         RollupGasPriceOracleAddressFlag = cli.StringFlag{
                 Name:   ""rollup.gaspriceoracleaddress"",
                 Usage:  ""Address of the rollup gas price oracle"",
-                Value:  ""0x"",
+                Value:  ""0x0000000000000000000000000000000000000000"",
                 EnvVar: ""ROLLUP_GAS_PRICE_ORACLE_ADDRESS"",
         }
         RollupEnableL2GasPollingFlag = cli.BoolFlag{
                 Name:   ""rollup.enablel2gaspolling"",
-                Usage:  """",
+                Usage:  ""Poll for the L2 gas price from the L2 state"",
+                EnvVar: ""ROLLUP_ENABLE_L2_GAS_POLLING"",
+        }
+        RollupEnforceFeesFlag = cli.BoolFlag{
+                Name:   ""rollup.enforcefeesflag"",
+                Usage:  ""Disable transactions with 0 gas price"",
                 EnvVar: ""ROLLUP_ENABLE_L2_GAS_POLLING"",
         }
 )",Fix this env var,go,1,0,0
"@@ -53,6 +53,16 @@ func mustSpanIDFromHex(s string) (t trace.SpanID) {
 	return
 }
 
+func TestBytesMapCarrier(t *testing.T) {
+	carrier := make(propagation.BytesMapCarrier)
+	carrier.Set(""foo"", ""bar"")
+	carrier.Set(""baz"", ""qux"")
+
+	assert.Equal(t, carrier.Get(""foo""), ""bar"")
+	assert.Equal(t, carrier.Get(""baz""), ""qux"")
+	assert.Equal(t, carrier.Keys(), []string{""foo"", ""baz""})
+}
+
 type outOfThinAirPropagator struct {
 	t *testing.T
 }","Map iteration order isn't guaranteed, so the result will need to be sorted or another set of checks devised. You could assert it's length 2 and contains both ""foo"" and ""bar"".",go,1,1,1
"@@ -389,6 +389,17 @@ func (c *client) parse(buf []byte) error {
 				if err := c.processPub(arg); err != nil {
 					return err
 				}
+				// Check if we have and account mappings or tees or filters.
+				// FIXME(dlc) - Probably better way to do this.
+				// Could add in cache but will be tricky since results based on pub subject are dynamic
+				// due to wildcard matching and weight sets.
+				if c.kind == CLIENT && c.in.flags.isSet(hasMappings) {
+					old := c.pa.subject
+					changed := c.selectMappedSubject()
+					if trace && changed {
+						c.traceInOp(""MAPPING"", []byte(fmt.Sprintf(""%s -> %s"", old, c.pa.subject)))
+					}
+				}
 				c.drop, c.as, c.state = 0, i+1, MSG_PAYLOAD
 				// If we don't have a saved buffer then jump ahead with
 				// the index. If this overruns what is left we fall out",other way would be for selectMappedSubject() to return a boolean to indicate that an actual mapping took place.,go,1,1,1
"@@ -3176,10 +3176,10 @@ func (m *MockpipelineStatusDescriber) EXPECT() *MockpipelineStatusDescriberMockR
 }
 
 // Describe mocks base method
-func (m *MockpipelineStatusDescriber) Describe() (*describe.PipelineStatusDesc, error) {
+func (m *MockpipelineStatusDescriber) Describe() (*describe.PipelineStatus, error) {
 	m.ctrl.T.Helper()
 	ret := m.ctrl.Call(m, ""Describe"")
-	ret0, _ := ret[0].(*describe.PipelineStatusDesc)
+	ret0, _ := ret[0].(*describe.PipelineStatus)
 	ret1, _ := ret[1].(error)
 	return ret0, ret1
 }",You'll need to regenerate the mocks to get rid of this now that you've removed the interfaces from `cli/interfaces.go`,go,1,1,1
"@@ -274,6 +274,12 @@ func (k *K8sClient) GetKCS() *kubernetes.Clientset {
 	return k.cs
 }
 
+// GetUCS is a getter method for fetching upgrade clientset as
+// the upgrade clientset is not exported.
+func (k *K8sClient) GetUCS() *upgrade.Clientset {
+	return k.upgradecs
+}
+
 // scOps is a utility function that provides a instance capable of
 // executing various K8s StorageClass related operations
 func (k *K8sClient) storageV1SCOps() typed_storage_v1.StorageClassInterface {",This package should not be used. This is old package.,go,1,1,1
"@@ -683,6 +683,11 @@ func loadConfigFromDatastore(
 		Name:      ""node."" + hostname,
 		Namespace: """",
 	}, """")
+	n, err := client.Get(ctx, model.ResourceKey{
+		Kind:      apiv2.KindNode,
+		Name:      hostname,
+		Namespace: """",
+	}, """")
 	if _, ok := err.(errors2.ErrorResourceDoesNotExist); err != nil && !ok {
 		return
 	}",Should be checking for error here,go,1,1,1
"@@ -37,6 +37,9 @@ type AWSMachineProviderSpec struct {
 	// AMI is the reference to the AMI from which to create the machine instance.
 	AMI AWSResourceReference `json:""ami,omitempty""`
 
+	// ImageLookupOrg is the AWS Organization ID to use for image lookup if AMI is not set.
+	ImageLookupOrg string `json:""imageLookupOrg,omitempty""`
+
 	// InstanceType is the type of instance to create. Example: m4.xlarge
 	InstanceType string `json:""instanceType,omitempty""`
 ","Nit, ImageLookupOrg could be `ImageLookupOrgID`",go,1,1,1
"@@ -38,7 +38,8 @@ func (p *diskInspectionProcessor) process(pd persistentDisk,
 
         ir, err := p.inspectDisk(pd.uri)
         if err != nil {
-                return pd, err
+                // Don't directly return err to avoid terminating the import.
+                return pd, nil
         }
 
         isDualBoot := ir.UEFIBootable && ir.BIOSBootableWithHybridMBROrProtectiveMBR",Log the error?,go,1,0,1
"@@ -61,8 +61,7 @@ runs on edge nodes and manages containerized applications.`,
 			gis.Start(beehiveContext.Done())
 			registerModules(config)
 			// start all modules
-			core.StartModules()
-			core.GracefulShutdown()
+			core.Run()
 		},
 	}
 	fs := cmd.Flags()",It might be clearer to split it into two calls? I'm not sure.,go,1,1,1
"@@ -300,6 +300,10 @@ func (a *FakeWebAPI) GetApplication(ctx context.Context, req *webservice.GetAppl
 	}, nil
 }
 
+func (a *FakeWebAPI) GenerateApplicationSealedSecret(ctx context.Context, req *webservice.GenerateApplicationSealedSecretRequest) (*webservice.GenerateApplicationSealedSecretResponse, error) {
+	return &webservice.GenerateApplicationSealedSecretResponse{}, nil
+}
+
 func (a *FakeWebAPI) ListDeployments(ctx context.Context, req *webservice.ListDeploymentsRequest) (*webservice.ListDeploymentsResponse, error) {
 	now := time.Now()
 	deploymentTime := now",`ctx` is unused in GenerateApplicationSealedSecret,go,1,1,1
"@@ -86,6 +86,7 @@ func (d *RDWebServiceDescriber) Describe() (HumanJSONStringer, error) {
 			Port:        service.Port,
 			CPU:         service.CPU,
 			Memory:      service.Memory,
+			Platform:    ""LINUX/X86_64"",
 		})
 
 		for _, v := range service.EnvironmentVariables {","An alternative to defaulting a platform string would be to not show the column at all if we do not have the information   For RD web service, I feel like user wouldn't be interested in the platform information anyway since they should have known that the only valid platform is ""linux/x86_64"" if they have tried to use any other platform for the service.",go,1,1,1
"@@ -138,7 +138,7 @@ func TestPaymentChannelRedeemSuccess(t *testing.T) {
 func TestPaymentChannelReclaimSuccess(t *testing.T) {
 	payer := &address.TestAddress
 	target := &address.TestAddress2
-	eol := types.NewBlockHeight(5)
+	eol := types.NewBlockHeight(20)
 	amt := types.NewTokenAmount(10000)
 
 	daemonTestWithPaymentChannel(t, payer, target, amt, eol, func(d *TestDaemon, channelID *types.ChannelID) {",This is suuuper ghetto. We're going to have to think about how to write this kind of test now that `mine once` means (and I think we want it to continue to mean) _mine until you get a block_. @acruikshank,go,0,1,1
"@@ -108,11 +108,11 @@ func (c *controller) Run(workers int, stopCh <-chan struct{}) error {
 	var wg sync.WaitGroup
 	for i := 0; i < workers; i++ {
 		wg.Add(1)
-		// TODO (@munnerz): make time.Second duration configurable
-		go wait.Until(func() {
+		go func() {
 			defer wg.Done()
-			c.worker(ctx)
-		}, time.Second, stopCh)
+			// TODO (@munnerz): make time.Second duration configurable
+			wait.Until(func() { c.worker(ctx) }, time.Second, stopCh)
+		}()
 	}
 
 	for _, f := range c.runFirstFuncs {",Can we remove this `TODO`? I can't think of a use case that would justify to make this configurable. The 1 second here is just the delay before re-launching the worker after it has (mysteriously) stopped.,go,1,1,1
"@@ -16,6 +16,9 @@
 package config
 
 import (
+	""fmt""
+	""github.com/aws/amazon-ecs-agent/agent/statemanager/dependencies""
+	""github.com/pkg/errors""
 	""os""
 	""strings""
 	""syscall""",nit: imports should be grouped. please run `go imports` and/or see other files to check import formatting.,go,1,1,1
"@@ -18,10 +18,11 @@ type Window struct {
 // and normalizes the offset to a small positive duration.
 // It also validates that the durations are valid when
 // used within a window.
-func NewWindow(every, period, offset Duration) (Window, error) {
-	// Normalize the offset to a small positive duration
-	offset = offset.Normalize(every)
-
+func NewWindow(every, period, offset Duration, months bool) (Window, error) {
+	if !months {
+		// Normalize nanosecond offsets to a small positive duration
+		offset = offset.Normalize(every)
+	}
 	w := Window{
 		Every:  every,
 		Period: period,",@jlapacik we need to know if we're working with nanoseconds or not so that we can know whether to scale durations here or not.,go,0,1,1
"@@ -181,10 +181,13 @@ func (pool *MessagePool) timeoutMessages(ctx context.Context, store chain.BlockP
 		}
 	}
 
+	pool.lk.Lock()
+	defer pool.lk.Unlock()
+
 	// remove all messages added before minimumHeight
 	for cid, msg := range pool.pending {
 		if msg.addedAt < minimumHeight {
-			pool.Remove(cid)
+			delete(pool.pending, cid)
 		}
 	}
 ","This misses the metric update in `Remove()`. It is unfortunate that `timeoutMessages` uses the pool's private API, which makes errors like this all too easy (not your fault). I think a better fix here is to use the exported `Pending()` at line 188 then stick with `Remove` here (and no need for the extra lock).",go,1,1,1
"@@ -15,6 +15,7 @@ type Datastore interface {
 	// can either force it, or just do hopeful type checks. Not all datastores
 	// implement every feature.
 	datastore.Batching
+	Close() error
 }
 
 // Repo is a representation of all persistent data in a filecoin node.","If we are adding the `Close` method, we should probably be also calling it when shutting down the node",go,1,1,1
"@@ -256,6 +256,17 @@ type CloudBackupCreateRequest struct {
 	Full bool
 }
 
+type CloudBackupGroupCreateRequest struct {
+	// GroupID indicates backup request for a volumegroup with this group id
+	GroupID string
+	// Labels indicates backup request for a volume group with these labels
+	Labels map[string]string
+	// CredentialUUID is cloud credential to be used for backup
+	CredentialUUID string
+	// Full indicates if full backup is desired even though incremental is possible
+	Full bool
+}
+
 type CloudBackupRestoreRequest struct {
 	// ID is the backup ID being restored
 	ID string",This is either GroupID or Labels. What happens if they are both set?,go,1,1,1
"@@ -138,12 +138,10 @@ func environmentCheck() error {
 	}
 
 	for _, process := range processes {
-		// if kubelet is running, return error
-		if process.Executable() == ""kubelet"" {
+		switch process.Executable() {
+		case ""kubelet"": // if kubelet is running, return error
 			return errors.New(""kubelet should not running on edge node when running edgecore"")
-		}
-		// if kube-proxy is running, return error
-		if process.Executable() == ""kube-proxy"" {
+		case ""kube-proxy"": // if kube-proxy is running, return error
 			return errors.New(""kube-proxy should not running on edge node when running edgecore"")
 		}
 	}","There are only these two situations, I think there is no need to use `switch` to extend the judgment.",go,1,1,1
"@@ -1044,7 +1044,7 @@ func NewBuildState(config *Configuration) *BuildState {
 			""crc64"":  fs.NewPathHasher(RepoRoot, config.Build.Xattrs, newCRC64, ""crc64""),
 			""blake3"": fs.NewPathHasher(RepoRoot, config.Build.Xattrs, newBlake3, ""blake3""),
 		},
-		ProcessExecutor: process.New(sandboxTool),
+		ProcessExecutor: process.New(sandboxTool != """"),
 		StartTime:       startTime,
 		Config:          config,
 		VerifyHashes:    true,","I think we may still want a way of honouring the sandbox tool if that's set. Maybe it should basically go through the old method if it is - but we make the default `""""` from here on and deprecate that field in future.",go,1,1,1
"@@ -87,6 +87,8 @@ func run(o *Options) error {
 		appliedToGroupStore,
 		networkPolicyStore)
 
+	endpointQueryReplier := networkpolicy.NewEndpointQueryReplier(networkPolicyController)
+
 	controllerQuerier := querier.NewControllerQuerier(networkPolicyController, o.config.APIPort)
 
 	controllerMonitor := monitor.NewControllerMonitor(crdClient, nodeInformer, controllerQuerier)","It seems it doesn't really need a concrete instance here, all consumers just need the interface, right? Maybe you could use interface here, so the struct name can be simplified as the lower case of the interface, i.e. endpointQuerier?",go,1,1,1
"@@ -45,3 +45,9 @@ func SetDefaultTaskListKind(f *enumspb.TaskListKind) {
 		*f = enumspb.TASK_LIST_KIND_NORMAL
 	}
 }
+
+func SetDefaultParentClosePolicy(f *enumspb.ParentClosePolicy) {
+	if *f == enumspb.PARENT_CLOSE_POLICY_UNSPECIFIED {
+		*f = enumspb.PARENT_CLOSE_POLICY_ABANDON
+	}
+}",The default should be TERMINATE. How do I determine default looking at the proto definition?,go,1,1,1
"@@ -81,6 +81,10 @@ const (
 	// IsRelay when set causes the the daemon to provide libp2p relay
 	// services allowing other filecoin nodes behind NATs to talk directly.
 	IsRelay = ""is-relay""
+
+	// CatchupSyncTestMode places the daemon in a spcial catchup mode for testing
+	// TODO remove this when we stop using test daemon.
+	CatchupSyncTestMode = ""catchup-sync-test-mode""
 )
 
 // command object for the local cli","nit: special, also file an issue and add that issue number to the TODO",go,1,1,1
"@@ -87,7 +87,8 @@ func (m *mounter) Unmount() (err error) {
 			_, err = exec.Command(
 				""/usr/sbin/diskutil"", ""unmountDisk"", ""force"", dir).Output()
 		case ""linux"":
-			_, err = exec.Command(""fusermount"", ""-ul"", dir).Output()
+			// Lazy unmount; will unmount when KBFS is no longer in use
+			_, err = exec.Command(""fusermount"", ""-u"", ""-z"", dir).Output()
 		default:
 			err = errors.New(""Forced unmount is not supported on this platform yet"")
 		}","@taruti is this ok? my fusermount(1) shows the option is `-z`, which is pretty confusing since `umount` uses `-l`. hopefully it isn't os-dependent",go,0,1,1
"@@ -358,7 +358,12 @@ func (r *replacer) getSubstitution(key string) string {
 		if r.responseRecorder == nil {
 			return r.emptyValue
 		}
-		return roundDuration(time.Since(r.responseRecorder.start)).String()
+		elapsedDuration := time.Since(r.responseRecorder.start)
+
+		if elapsedDuration == 0 {
+			return ""0ms""
+		}
+		return roundDuration(elapsedDuration).String()
 	case ""{latency_ms}"":
 		if r.responseRecorder == nil {
 			return r.emptyValue","time.Since returns a duration value, which has accuracy to the nanosecond, I believe. So while 0ms is technically true in that case, the likelihood of getting an actual value of 0 is extremely low, I think. Is there a test that exhibits this behavior?",go,1,1,1
"@@ -167,6 +167,10 @@ func (m *UnifiedManager) Destroy() error {
 	if m.Cgroups.Paths != nil {
 		return nil
 	}
+	dirPath, err := m.GetUnifiedPath()
+	if err != nil {
+		return err
+	}
 	m.mu.Lock()
 	defer m.mu.Unlock()
 ","@kolyshkin I think we may not need `StopUnit` method. Because if the init process has been exited, the cgroup path will be deleted by systemd automatically. WDYT",go,0,1,1
"@@ -36,6 +36,9 @@ const (
 	blockRead blockReqType = iota
 	// A block write request.
 	blockWrite
+	// A block read request that is happening from a different
+	// goroutine than the blockLock rlock holder, using the same lState.
+	blockReadParallel
 )
 
 type mdToCleanIfUnused struct {","Does that mean that if all n children goroutines use the same `lState`? If so, that seems incorrect, as an `lState` is meant to only apply for a single 'execution flow', which means a single goroutine or a serial sequence of goroutines. Probably should enforce something like a nil lState exactly when using blockReadParallel.",go,1,1,1
"@@ -132,6 +132,12 @@ func run(o *Options) error {
 	if err != nil {
 		return fmt.Errorf(""error creating API server: %v"", err)
 	}
+
+	err = apiserver.CleanupDeprecatedAPIServices(aggregatorClient)
+	if err != nil {
+		return fmt.Errorf(""failed to clean up the deprecated APIServices: %v"", err)
+	}
+
 	// Set up signal capture: the first SIGTERM / SIGINT signal is handled gracefully and will
 	// cause the stopCh channel to be closed; if another signal is received before the program
 	// exits, we will force exit.",I didn't think of it too much but does the order matter here? should we remove deprecated APIServices before installing the new ones?,go,1,1,1
"@@ -3611,10 +3611,12 @@ func (c *client) processMsgResults(acc *Account, r *SublistResult, msg, deliver,
 			ql := _ql[:0]
 			for i := 0; i < len(qsubs); i++ {
 				sub = qsubs[i]
-				if sub.client.kind == CLIENT {
+				if sub.client.kind == LEAF || sub.client.kind == ROUTER || sub.client.kind == GATEWAY {
+					if rsub == nil {
+						rsub = sub
+					}
+				} else {
 					ql = append(ql, sub)
-				} else if rsub == nil {
-					rsub = sub
 				}
 			}
 			qsubs = ql","Since for gateways interest is not stored in the account sublist (but stored in gateway struct), sub.client.kind will never be GATEWAY.",go,1,1,1
"@@ -20,10 +20,17 @@ import (
 
 	""github.com/aws/aws-sdk-go/aws/credentials""
 	""github.com/aws/aws-sdk-go/aws/signer/v4""
+	""github.com/cihub/seelog""
+	""github.com/pkg/errors""
 )
 
 // SignHTTPRequest signs an http.Request struct with authv4 using the given region, service, and credentials.
-func SignHTTPRequest(req *http.Request, region, service string, creds *credentials.Credentials, body io.ReadSeeker) {
+func SignHTTPRequest(req *http.Request, region, service string, creds *credentials.Credentials, body io.ReadSeeker) error {
 	signer := v4.NewSigner(creds)
-	signer.Sign(req, body, service, region, time.Now())
+	_, err := signer.Sign(req, body, service, region, time.Now())
+	if err != nil {
+		seelog.Warnf(""Signing HTTP request failed: %v"", err)
+		return errors.Wrap(err, ""aws sdk http signer: failed to sign http request"")
+	}
+	return nil
 }",nit: `errors.Wrap()` should suffice here.,go,1,1,1
"@@ -461,6 +461,7 @@ func (c *linuxContainer) commandTemplate(p *Process, childPipe *os.File) (*exec.
 	if cmd.SysProcAttr == nil {
 		cmd.SysProcAttr = &syscall.SysProcAttr{}
 	}
+	cmd.Env = append(cmd.Env, fmt.Sprintf(""GOMAXPROCS=%s"", os.Getenv(""GOMAXPROCS"")))
 	cmd.ExtraFiles = append(cmd.ExtraFiles, p.ExtraFiles...)
 	if p.ConsoleSocket != nil {
 		cmd.ExtraFiles = append(cmd.ExtraFiles, p.ConsoleSocket)",Won't this result in `GOMAXPROCS=` in the normal case of `runc` was called without `GOMAXPROCS` set?,go,1,1,1
"@@ -10,12 +10,12 @@ import (
         ""time""
 
         ""github.com/facebookgo/clock""
-        fsm ""github.com/iotexproject/go-fsm""
+        ""github.com/iotexproject/go-fsm""
         ""go.uber.org/zap""
 
         ""github.com/iotexproject/iotex-core/blockchain/block""
         ""github.com/iotexproject/iotex-core/endorsement""
-        ""github.com/iotexproject/iotex-core/iotxaddress""
+        ""github.com/iotexproject/iotex-core/pkg/keypair""
         ""github.com/iotexproject/iotex-core/pkg/log""
         ""github.com/iotexproject/iotex-core/proto""
 )",other declaration of fsm (from `typecheck`),go,1,0,0
"@@ -142,12 +142,15 @@ func (v *Vault) Sign(csrPEM []byte, duration time.Duration) (cert []byte, ca []b
 		return nil, nil, fmt.Errorf(""unable to convert certificate bundle to PEM bundle: %s"", err.Error())
 	}
 
-	var caPem []byte = nil
+	var caPem []byte
 	if len(bundle.CAChain) > 0 {
-		caPem = []byte(bundle.CAChain[0])
+		caPem = []byte(bundle.CAChain[len(bundle.CAChain)-1])
 	}
 
-	return []byte(bundle.ToPEMBundle()), caPem, nil
+	crtPems := []string{bundle.Certificate}
+	crtPems = append(crtPems, bundle.CAChain[0:len(bundle.CAChain)-1]...)
+
+	return []byte(strings.Join(crtPems, ""\n"")), caPem, nil
 }
 
 func (v *Vault) setToken(client Client) error {","Can `bundle.CAChain` ever have a length of 0? If so, this will cause a panic  ",go,1,1,1
"@@ -29,6 +29,7 @@ const (
 
 // OptionsDiscovery describes possible parameters of discovery configuration
 type OptionsDiscovery struct {
-	Type    DiscoveryType
-	Address string
+	Type                    DiscoveryType
+	Address                 string
+	DisableProposalsFetcher bool
 }",-> `ProposalFetcherEnabled` 1. It should be consistent with other bool flags 2. It is easier to understand options without negation,go,1,1,1
"@@ -9,7 +9,10 @@ package state
 import (
 	""math/big""
 
+	""github.com/golang/protobuf/proto""
+
 	""github.com/iotexproject/iotex-core/pkg/hash""
+	""github.com/iotexproject/iotex-core/proto""
 )
 
 // Account is the canonical representation of an account.",File is not `goimports`-ed,go,0,1,1
"@@ -146,6 +146,17 @@ type HugetlbStats struct {
 	Failcnt uint64 `json:""failcnt""`
 }
 
+type RdmaEntry struct {
+	Device     string `json:""device,omitempty""`
+	HcaHandles uint32 `json:""hca_handles,omitempty""`
+	HcaObjects uint32 `json:""hca_objects,omitempty""`
+}
+
+type RdmaStats struct {
+	RdmaLimit   []RdmaEntry `json:""rdma_limit,omitempty""`
+	RdmaCurrent []RdmaEntry `json:""rdma_current,omitempty""`
+}
+
 type Stats struct {
 	CpuStats    CpuStats    `json:""cpu_stats,omitempty""`
 	CPUSetStats CPUSetStats `json:""cpuset_stats,omitempty""`",Should these all be `RDMAEntry` and `HCAHandles` (capital RDMA and HCA)?,go,1,1,1
"@@ -47,7 +47,7 @@ func (t *Tracer) Start(ctx context.Context, name string, opts ...trace.SpanOptio
 		tracer:     t,
 		startTime:  startTime,
 		attributes: make(map[label.Key]label.Value),
-		links:      make(map[trace.SpanContext][]label.KeyValue),
+		links:      make([]trace.Link, 0),
 		spanKind:   c.SpanKind,
 	}
 ",nit: can this be `nil` or `[]trace.Link{}` instead of a `make()` statement?,go,1,1,1
"@@ -464,12 +464,11 @@ func (target *BuildTarget) AllURLs(state *BuildState) []string {
 // resolveDependencies matches up all declared dependencies to the actual build targets.
 // TODO(peterebden,tatskaari): Work out if we really want to have this and how the suite of *Dependencies functions
 //                             below should behave (preferably nicely).
-// TODO(tatskaari): Work out if we can use a channel instead of a callback.
 func (target *BuildTarget) resolveDependencies(graph *BuildGraph, callback func(*BuildTarget) error) error {
 	var g errgroup.Group
-	target.mutex.RLock()
+
 	for i := range target.dependencies {
-		dep := &target.dependencies[i]
+		dep := &target.dependencies[i] // avoid using a loop variable here as it mutates each iteration
 		if len(dep.deps) > 0 {
 			continue // already done
 		}","Think we should keep this in as a Lock / Unlock (since we're iterating over the slice itself which is shared, but the work on it happens within the waitgroup)",go,1,1,1
"@@ -18,6 +18,8 @@ import (
 	""encoding/json""
 	""testing""
 	""time""
+	""github.com/jmcvetta/randutil""
+	""reflect""
 )
 
 func TestSleepCommand_UnmarshalJSON(t *testing.T) {",File is not `gofmt`-ed with `-s` (from `gofmt`),go,0,1,1
"@@ -39,6 +39,8 @@ func defaultCipherSuites() []uint16 {
 		tls.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
 		tls.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,
 		tls.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,
+		tls.TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,
+		tls.TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,
 	}
 }
 ","What is default for 1.8 if not configured at all? I think they put ChaCha first because of its performance gains, even over AES..",go,1,1,1
"@@ -129,6 +129,7 @@ func (r *runtime) evalHandle(ctx context.Context, h *libflux.ASTPkg, opts ...Sco
 	// Execute the interpreter over the package.
 	itrp := interpreter.NewInterpreter(nil)
 	sideEffects, err := itrp.Eval(ctx, semPkg, scope, importer)
+	semPkg.Free()
 	if err != nil {
 		return nil, nil, err
 	}","I think `defer semPkg.Free()` would be appropriate here: if there is a panic somewhere during evaluation, we still want the free to happen. Deferred function calls will still happen if a panic occurs.",go,1,1,1
"@@ -36,14 +36,14 @@ import (
 
 // pullBaggage pulls the context headers from the given transport.Headers,
 // deleting them from the original headers map.
-func pullBaggage(headers transport.Headers) transport.Headers {
-	ctxHeaders := make(transport.Headers)
+func pullBaggage(headers transport.Headers) map[string]string {
+	ctxHeaders := make(map[string]string)
 	prefix := strings.ToLower(BaggageHeaderPrefix)
 	prefixLen := len(prefix)
-	for k, v := range headers {
+	for k, v := range headers.Items() {
 		if strings.HasPrefix(k, prefix) {
 			key := k[prefixLen:]
-			ctxHeaders.Set(key, v)
+			ctxHeaders[key] = v
 			headers.Del(k)
 		}
 	}",Can you explain why you're using `map[string]string` here (and in several other places) instead of a defined type?,go,1,1,1
"@@ -25,7 +25,13 @@ import (
         ""github.com/labstack/echo/v4""
 )
 
+// URLAuthPrefix is the echo formatted url/path param which can be used for supplying an API token.
+const URLAuthPrefix = ""/urlAuth/:"" + TokenPathParam
 const urlAuthFormatter = ""/urlAuth/%s""
+// InvalidTokenMessage is the message set when an invalid / missing token is found.
+const InvalidTokenMessage = ""Invalid API Token""
+// TokenPathParam is the name of the path parameter used by URLAuthPrefix
+const TokenPathParam = ""token""
 
 // AuthMiddleware provides some data to the handler.
 type AuthMiddleware struct {",It took me a moment to realize this works because the Go compiler is smart; I was expecting to need this declared before it's used a few lines above.,go,1,1,1
"@@ -263,9 +263,10 @@ type EventName string
 // Define names for the various events
 const (
 	StartupEvent         EventName = ""startup""
-	ShutdownEvent        EventName = ""shutdown""
-	CertRenewEvent       EventName = ""certrenew""
-	InstanceStartupEvent EventName = ""instancestartup""
+	ShutdownEvent                  = ""shutdown""
+	CertRenewEvent                 = ""certrenew""
+	InstanceStartupEvent           = ""instancestartup""
+	InstanceRestartEvent           = ""instancerestart""
 )
 
 // EventHook is a type which holds information about a startup hook plugin.","Can we make the string consistent with the name? ""instancerestart""?",go,1,1,1
"@@ -17,16 +17,16 @@ import (
         ""github.com/syndtr/goleveldb/leveldb/util""
 )
 
-var _ storage.StateStorer = (*store)(nil)
+var _ storage.StateStorer = (*Store)(nil)
 
 // Store uses LevelDB to store values.
-type store struct {
+type Store struct {
         db     *leveldb.DB
         logger logging.Logger
 }
 
 // New creates a new persistent state storage.
-func NewStateStore(path string, l logging.Logger) (storage.StateStorer, error) {
+func NewStateStore(path string, l logging.Logger) (*Store, error) {
         db, err := leveldb.OpenFile(path, nil)
         if err != nil {
                 if !ldberr.IsCorrupted(err) {",why the export?,go,1,0,1
"@@ -38,14 +38,14 @@ import (
 func setupAWS(ctx context.Context, flags *cliFlags) (*application, func(), error) {
 	// This will be filled in by Wire with providers from the provider sets in
 	// wire.Build.
-
-	panic(wire.Build(
+	wire.Build(
 		awscloud.AWS,
 		applicationSet,
 		awsBucket,
 		awsMOTDVar,
 		awsSQLParams,
-	))
+	)
+	return nil, func() {}, nil
 }
 
 // awsBucket is a Wire provider function that returns the S3 bucket based on the",All of these can be `nil` (here and below).,go,1,1,1
"@@ -32,7 +32,7 @@ func ValidateValue(valueType string, value string) error {
 			return errors.New(""the bool value must be true or false"")
 		}
 		return nil
-	case ""deleted"":
+	case TypeDeleted:
 		return nil
 	default:
 		return errors.New(""the value type is not allowed"")","Why only add the `TypeDeleted` here? :) And the original code is also confusing, the operation type mixed with value type...",go,1,1,1
"@@ -0,0 +1,19 @@
+// +build !linux
+
+package landlock
+
+import (
+	""errors""
+
+	""github.com/opencontainers/runc/libcontainer/configs""
+)
+
+var ErrLandlockNotSupported = errors.New(""land: config provided but Landlock not supported"")
+
+// InitLandlock does nothing because Landlock is not supported.
+func InitSLandlock(config *configs.Landlock) error {
+	if config != nil {
+		return ErrLandlockNotSupported
+	}
+	return nil
+}","runc is linux-only, I guess you can drop this entirely (as well as `_linux` suffix from all the other files).",go,1,1,1
"@@ -224,7 +224,7 @@ var _ fs.Node = (*Root)(nil)
 
 // Attr implements the fs.Node interface for Root.
 func (*Root) Attr(ctx context.Context, a *fuse.Attr) error {
-	a.Mode = os.ModeDir | 0755
+	a.Mode = os.ModeDir | 0555
 	return nil
 }
 ","`FolderList.Attr` should be fixed in the same way, I think, right?",go,1,1,1
"@@ -112,7 +112,5 @@ func (l *Logger) Debugf(format string, v ...interface{}) {
 }
 
 func (l *Logger) Tracef(format string, v ...interface{}) {
-	if l.trace == true {
-		l.logger.Printf(l.traceLabel+format, v...)
-	}
+	l.logger.Printf(l.traceLabel+format, v...)
 }","I believe this check is safe to remove since AFAICT all of the calls to this already assume tracing is enabled, either globally or per-client.",go,1,1,1
"@@ -37,6 +37,8 @@ type ControlPlaneSpec struct {
 	Filestore ControlPlaneFileStore `json:""filestore""`
 	// The configuration of cache for control plane.
 	Cache ControlPlaneCache `json:""cache""`
+	// The configuration of insight collector
+	InsightCollectorConfig ControlPlaneInsightCollector `json:""insightCollector""`
 	// List of debugging/quickstart projects defined in Control Plane configuration.
 	// Please note that do not use this to configure the projects running in the production.
 	Projects []ControlPlaneProject `json:""projects""`",nit: `InsightCollector ControlPlaneInsightCollector`,go,1,1,1
"@@ -28,6 +28,7 @@ import (
 	""strings""
 
 	""kythe.io/kythe/go/platform/kzip""
+	apb ""kythe.io/kythe/proto/analysis_go_proto""
 
 	""bitbucket.org/creachadair/stringset""
 )",Conventionally we group protobuf imports separately below the others.,go,1,1,1
"@@ -21,6 +21,9 @@ import (
         ""testing""
         ""time""
 
+        containerresource ""github.com/aws/amazon-ecs-agent/agent/containerresource""
+        ""github.com/aws/amazon-ecs-agent/agent/containerresource/containerstatus""
+
         apicontainerstatus ""github.com/aws/amazon-ecs-agent/agent/api/container/status""
         resourcestatus ""github.com/aws/amazon-ecs-agent/agent/taskresource/status""
 ",not blocking: extra line here too and other files too,go,0,1,1
"@@ -38,7 +38,8 @@ type containerState interface {
 }
 
 func destroy(c *linuxContainer) error {
-	if !c.config.Namespaces.Contains(configs.NEWPID) {
+	if !c.config.Namespaces.Contains(configs.NEWPID) ||
+		c.config.Namespaces.PathOf(configs.NEWPID) != """" {
 		if err := signalAllProcesses(c.cgroupManager, unix.SIGKILL); err != nil {
 			logrus.Warn(err)
 		}",Killing PID 1 in a PID namespace kills the other processes in the PID namespace.,go,1,1,1
"@@ -81,11 +81,12 @@ func newServer(cfg config.Config, testing bool) (*Server, error) {
 	cs.ActionPool().
 		AddActionValidators(
 			actpool.NewGenericValidator(cs.Blockchain()), account.NewProtocol(),
-			vote.NewProtocol(cs.Blockchain()), execution.NewProtocol(),
+			vote.NewProtocol(cs.Blockchain()), execution.NewProtocol(cs.Blockchain()),
 		)
 	// Install protocols
 	mainChainProtocol := mainchain.NewProtocol(cs.Blockchain())
 	cs.AddProtocols(mainChainProtocol)
+	cs.AddProtocols(execution.NewProtocol(cs.Blockchain()))
 	if cs.Explorer() != nil {
 		cs.Explorer().SetMainChainProtocol(mainChainProtocol)
 	}",You don't need to add execution protocol here because L89 bellow,go,1,1,1
"@@ -130,7 +130,7 @@ func verifyBlockSignature(ctx context.Context, view FaultStateView, blk block.Bl
 	if err != nil {
 		panic(errors.Wrapf(err, ""failed to inspect miner addresses""))
 	}
-	err = state.NewSignatureValidator(view).ValidateSignature(ctx, blk.SignatureData(), worker, blk.BlockSig)
+	err = state.NewSignatureValidator(view).ValidateSignature(ctx, blk.SignatureData(), worker, *blk.BlockSig)
 	if err != nil {
 		return errors.Wrapf(err, ""no consensus fault: block %s signature invalid"", blk.Cid())
 	}",`*blk.BlockSig` will panic if nil. Is this guaranteed not to be?,go,1,1,1
"@@ -71,13 +71,13 @@ import (
 	""github.com/algorand/go-algorand/daemon/algod/api/server/lib/middlewares""
 	""github.com/algorand/go-algorand/daemon/algod/api/server/v1/routes""
 	""github.com/algorand/go-algorand/daemon/algod/api/server/v2""
-	""github.com/algorand/go-algorand/daemon/algod/api/server/v2/generated""
 	""github.com/algorand/go-algorand/logging""
 	""github.com/algorand/go-algorand/node""
+	""github.com/algorand/go-algorand/util/tokens""
 )
 
 const (
-	apiV1Tag = ""v1""
+	apiV1Tag = ""/v1""
 )
 
 // wrapCtx passes a common context to each request without a global variable.",It's a bit weird that the tag has a `/` in it,go,1,1,1
"@@ -73,8 +73,8 @@ func New(impl Interface, opts ...<$thrift>.RegisterOption) []<$transport>.Regist
 	h := handler{impl}
 	service := <$thrift>.Service{
 		Name: ""<.Service.Name>"",
-		Methods: map[string]<$thrift>.Handler{
-			<range .Service.Functions>""<.ThriftName>"": <$thrift>.HandlerFunc(h.<.Name>),
+		Methods: map[string]<$thrift>.UnaryHandler{
+			<range .Service.Functions><if not .OneWay>""<.ThriftName>"": <$thrift>.UnaryHandlerFunc(h.<.Name>),<end>
 		<end>},
 	}
 	return <$thrift>.BuildRegistrants(service, opts...)",Technically an unrelated change but it should be fine. Make sure that the glide.yaml depends on thriftrw 0.4 otherwise this won't work.,go,1,1,1
"@@ -93,7 +93,10 @@ func (m *memKVStore) Batch() KVStoreBatch {
 	return NewMemKVStoreBatch(&m.data)
 }
 
-const fileMode = 0600
+const (
+	fileMode = 0600
+	quota    = 3
+)
 
 // boltDB is KVStore implementation based bolt DB
 type boltDB struct {",quota -> numRetries And can we make it configurable?,go,1,1,1
"@@ -20,11 +20,13 @@ import (
 	""context""
 	""encoding/json""
 	""fmt""
-	""github.com/jetstack/cert-manager/pkg/acme""
 	""hash/fnv""
 
+	""github.com/jetstack/cert-manager/pkg/api/util""
+
 	metav1 ""k8s.io/apimachinery/pkg/apis/meta/v1""
 
+	""github.com/jetstack/cert-manager/pkg/acme""
 	acmecl ""github.com/jetstack/cert-manager/pkg/acme/client""
 	cmacme ""github.com/jetstack/cert-manager/pkg/apis/acme/v1""
 	cmapi ""github.com/jetstack/cert-manager/pkg/apis/certmanager/v1""",nit: This import should be grouped with the other cert-manager imports,go,1,1,1
"@@ -37,7 +37,7 @@ func Bootstrap() {
 	)
 
 	market.RegisterPaymentMethodUnserializer(
-		pingpong.DefaultPaymentMethod.Type,
+		pingpong.NewPaymentMethod(0, 0).Type,
 		func(rawDefinition *json.RawMessage) (market.PaymentMethod, error) {
 			var method pingpong.PaymentMethod
 			err := json.Unmarshal(*rawDefinition, &method)",Type constant should be here,go,1,1,1
"@@ -108,10 +108,6 @@ func NewAccounting(
 		return nil, fmt.Errorf(""tolerance plus threshold too big: %w"", ErrOverflow)
 	}
 
-	if PaymentTolerance > PaymentThreshold/2 {
-		return nil, ErrInvalidPaymentTolerance
-	}
-
 	return &Accounting{
 		accountingPeers:  make(map[string]*accountingPeer),
 		paymentThreshold: PaymentThreshold,",is this error still used somewhere else? If not should probably remove it on top,go,1,1,1
"@@ -30,7 +30,8 @@ const seewayLogXmlConfig = `
 </seelog>
 `
 
-func init() {
+// Bootstrap loads seelog package into the overall system
+func Bootstrap() {
 	newLogger, err := seelog.LoggerFromConfigAsString(seewayLogXmlConfig)
 	if err != nil {
 		seelog.Warn(""Error parsing seelog configuration"", err)",why explicit Bootstrap calling is better when previous init() way? Init is guaranteed to be called only once per whole program. Bootstrap can be called in multiple places by different packages - and introduce very interesting side effects if not carefully used.,go,1,1,1
"@@ -20,6 +20,12 @@ import (
 // Topic is the network pubsub topic identifier on which new messages are announced.
 const Topic = ""/fil/msgs""
 
+// Abstracts over a store of blockchain state.
+type chainState interface {
+	// LatestState returns the latest chain state.
+	LatestState(ctx context.Context) (state.Tree, error)
+}
+
 // PublishFunc is a function the Sender calls to publish a message to the network.
 type PublishFunc func(topic string, data []byte) error
 ",@acruikshank in a follow-up I suggest removing the blocktimer from message pool in favour of this one. While the chain store ends up providing both `chainState` and `core.blockTimer` it's very useful in testing that they're separate interfaces here.,go,0,1,1
"@@ -16,8 +16,9 @@ import (
 
 var (
 	// ConfigDir is the directory to store config file
-	ConfigDir      string
-	configFileName string
+	ConfigDir         string
+	// DefaultConfigFile is the default config file name
+	DefaultConfigFile string
 )
 
 // ConfigCmd represents the config command",`ConfigDir` is a global variable (from `gochecknoglobals`),go,1,1,1
"@@ -176,7 +176,7 @@ func TestTooManyAcksForASingleBatchGoIntoMultipleBatches(t *testing.T) {
 
 func TestAckDoesNotBlock(t *testing.T) {
 	ctx, cancel := context.WithCancel(context.Background())
-	m := &driver.Message{}
+	m := &driver.Message{AckID: 0}
 	ds := &ackingDriverSub{
 		q: []*driver.Message{m},
 		sendAcks: func(_ context.Context, ackIDs []driver.AckID) error {",What does this have to do with removing ackIDBox?,go,1,1,1
"@@ -3,9 +3,16 @@
 package selector
 
 import (
+	""fmt""
+	""strings""
+
 	""github.com/spiffe/spire/proto/spire/common""
 )
 
+// Type and Value are delimited by a colon (:)
+// e.g. ""unix:uid:1000""
+const Delimiter = "":""
+
 type Selector struct {
 	Type  string
 	Value string","After this PR is merged, I will create another PR to use this constant in the SPIRE code.",go,0,1,1
"@@ -263,7 +263,11 @@ func TestSpirePlugin_SubmitValidCSR(t *testing.T) {
 	csr, pubKey, err := util.NewCSRTemplate(validSpiffeID)
 	require.NoError(t, err)
 
-	resp, err := m.MintX509CA(ctx, &upstreamauthority.MintX509CARequest{Csr: csr})
+	stream, err := m.MintX509CA(ctx, &upstreamauthority.MintX509CARequest{Csr: csr})
+	require.NoError(t, err)
+	require.NotNil(t, stream)
+
+	resp, err := stream.Recv()
 	require.NoError(t, err)
 	require.NotNil(t, resp)
 ",We should add an additional call to Recv() somewhere after here that we assert returns io.EOF.,go,1,1,1
"@@ -515,7 +515,9 @@ func (agent *ecsAgent) registerContainerInstance(
 // from a check point.
 func (agent *ecsAgent) reregisterContainerInstance(client api.ECSClient,
 	capabilities []*ecs.Attribute, tags []*ecs.Tag, registrationToken string) error {
-	_, _, err := client.RegisterContainerInstance(agent.containerInstanceARN, capabilities, tags, registrationToken)
+	_, availabilityZone, err := client.RegisterContainerInstance(agent.containerInstanceARN, capabilities, tags, registrationToken)
+	//set az to agent
+	agent.availabilityZone = availabilityZone
 
 	if err == nil {
 		return nil",do we need to call stateManager save here?,go,1,1,1
"@@ -47,6 +47,7 @@ type serverConfig struct {
 	BindPort            int                `hcl:""bind_port""`
 	CASubject           *caSubjectConfig   `hcl:""ca_subject""`
 	CATTL               string             `hcl:""ca_ttl""`
+	JWTIssuer           string             `hcl:""jwt_issuer""`
 	DataDir             string             `hcl:""data_dir""`
 	Experimental        experimentalConfig `hcl:""experimental""`
 	LogFile             string             `hcl:""log_file""`",nit: alphabetical ordering?,go,1,1,1
"@@ -37,6 +37,18 @@ func (f *CreateRepoForm) Validate(ctx *macaron.Context, errs binding.Errors) bin
         return validate(errs, ctx.Data, f, ctx.Locale)
 }
 
+type ConvertRepoForm struct {
+        Uid         int64  `binding:""Required""`
+        RepoId      int64  `binding:""Required""`
+        RepoName    string `binding:""Required;AlphaDashDot;MaxSize(100)""`
+        Private     bool
+        Description string `binding:""MaxSize(255)""`
+}
+
+func (f *ConvertRepoForm) Validate(ctx *macaron.Context, errs binding.Errors) binding.Errors {
+        return validate(errs, ctx.Data, f, ctx.Locale)
+}
+
 type MigrateRepoForm struct {
         CloneAddr    string `json:""clone_addr"" binding:""Required""`
         AuthUsername string `json:""auth_username""`",Why do you need this?,go,1,0,1
"@@ -152,6 +152,12 @@ func (v *Venafi) Sign(csrPEM []byte, duration time.Duration, customFields []inte
 
 func newVRequest(cert *x509.Certificate) *certificate.Request {
 	req := certificate.NewRequest(cert)
+
+	if len(cert.Subject.Organization) == 0 {
+		// Venafi TPP errors on an empty DN
+		// this applies the pre-0.15 default again if no other DN field is set
+		cert.Subject.Organization = []string{""cert-manager""}
+	}
 	// overwrite entire Subject block
 	req.Subject = cert.Subject
 	return req","Hm, how does Venafi like it if we specify `cert.Subject.Organization[0] = """"` (i.e. a slice with length '1' but the first element has length '0')?",go,1,1,1
"@@ -38,6 +38,10 @@ const (
 
 	v1CredentialsEndpointRelativeURIFormat = ""%s?"" + CredentialsIDQueryParameterName + ""=%s""
 	v2CredentialsEndpointRelativeURIFormat = ""%s/%s""
+
+	// The role types specified in the credentials payload msg from the backend
+	ApplicationRoleType = ""TaskApplication""
+	ExecutionRoleType   = ""TaskExecution""
 )
 
 // IAMRoleCredentials is used to save credentials sent by ACS","should be `""// ApplicationRoleType specifies ...""`",go,1,1,1
"@@ -38,6 +38,8 @@ type KVStore interface {
 	Delete(string, []byte) error
 	// Commit commits a batch
 	Commit(KVStoreBatch) error
+	// DeleteBucket delete a Bucket
+	DeleteBucket(key []byte) error
 }
 
 const (","Can we avoid adding a new api. Instead, `Delete(string, []byte) error` means delete a whole bucket if the second param is not given",go,1,1,1
"@@ -574,7 +574,7 @@ spec:
     Calculate the replica count
     Add as many poolUid to resources as there is replica count
     */}}
-    {{- $poolUids := keys .ListItems.cvolPoolList.pools }}
+    {{- $poolUids := keys .ListItems.cvolPoolList.pools | randomize }}
     {{- $replicaCount := .Config.ReplicaCount.value | int64 -}}
     repeatWith:
       resources:",Can we make sure that we take only `Healthy` replicas ? We might not want to take those pools which are not `Healthy`?,go,1,1,1
"@@ -28,7 +28,7 @@ import (
 // TODO(#866) Delete hard-coded brokercell once we can dynamically assign brokercell to brokers.
 const DefaultBrokerCellName = ""default""
 
-func CreateBrokerCell(b *v1beta1.Broker) *inteventsv1alpha1.BrokerCell {
+func CreateBrokerCell(_ *v1beta1.Broker) *inteventsv1alpha1.BrokerCell {
 	// TODO(#866) Get brokercell from the label (or annotation) from the broker.
 	return &inteventsv1alpha1.BrokerCell{
 		ObjectMeta: metav1.ObjectMeta{","This might be unexpectedly complex, but should we also change this to sth like: `CreateBrokerCell(_ *CellTenant)`, just in case in the future we want multiple brokercell support.?",go,1,1,1
"@@ -51,8 +51,8 @@ import (
 	""github.com/kubeedge/kubeedge/pkg/util""
 )
 
-//GPUInfoQueryTool sets information monitoring tool location for GPU
-var GPUInfoQueryTool = ""/var/IEF/nvidia/bin/nvidia-smi""
+//IEFGPUInfoQueryTool sets information monitoring tool location for GPU
+var IEFGPUInfoQueryTool = ""/var/IEF/nvidia/bin/nvidia-smi""
 var initNode v1.Node
 var reservationMemory = resource.MustParse(fmt.Sprintf(""%dMi"", 100))
 ",We should remove ief related codes here if possible.,go,1,1,1
"@@ -246,6 +246,7 @@ func GenerateChain(config *params.ChainConfig, parent *types.Block, engine conse
 		config = params.TestChainConfig
 	}
 	headers, blocks, receipts := make([]*types.Header, n), make(types.Blocks, n), make([]types.Receipts, n)
+	types.SetHeaderSealFlag(config.IsHeaderWithSeal())
 	chainreader := &FakeChainReader{Cfg: config, current: parent}
 	tx, errBegin := db.BeginRw(context.Background())
 	if errBegin != nil {","""global variable"" will affect other tests which running in parallel? `go test -p 8 --count=40 -race --trimpath -run='TestHeader' ./core` doesn't complain?",go,1,1,1
"@@ -111,7 +111,12 @@ be 2, 1 hour would be 120, and 1 day would be 2880.
 		cmdkit.StringArg(""ask"", true, false, ""ID of ask for which to propose a deal""),
 		cmdkit.StringArg(""duration"", true, false, ""Time in blocks (about 30 seconds per block) to store data""),
 	},
+	Options: []cmdkit.Option{
+		cmdkit.BoolOption(""allow-duplicates"", ""allows duplicate proposals to be created""),
+	},
 	Run: func(req *cmds.Request, re cmds.ResponseEmitter, env cmds.Environment) error {
+		allowDuplicates, _ := req.Options[""allow-duplicates""].(bool)
+
 		miner, err := address.NewFromString(req.Arguments[0])
 		if err != nil {
 			return err","can you add some more description here? eg ""unless this flag is set you will not be able to make a deal for the same piece with the same miner. this protection forces the client to be aware of duplicate deals with the same miner""",go,1,1,1
"@@ -214,13 +214,16 @@ func (c *historyCache) getOrCreateWorkflowExecutionInternal(
 	//  Consider revisiting this if it causes too much GC activity
 	releaseFunc := c.makeReleaseFunc(key, workflowCtx, forceClearContext)
 
+	lockAcquireTimer := c.metricsClient.StartTimer(scope, metrics.AcqureWorkflowContextLocklatency)
 	if err := workflowCtx.lock(ctx); err != nil {
+		lockAcquireTimer.Stop()
 		// ctx is done before lock can be acquired
 		c.Release(key)
 		c.metricsClient.IncCounter(scope, metrics.CacheFailures)
 		c.metricsClient.IncCounter(scope, metrics.AcquireLockFailedCounter)
 		return nil, nil, err
 	}
+	lockAcquireTimer.Stop()
 	return workflowCtx, releaseFunc, nil
 }
 ",line 167 - 170 already recorded the time,go,1,0,1
"@@ -391,9 +391,8 @@ func (m *DWH) watchMarketEvents() error {
 			}
 			m.processBlockBoundary(event)
 			dispatcher.Add(event)
-			if eventsCount < m.cfg.NumWorkers {
-				eventsCount++
-			} else {
+			eventsCount++
+			if eventsCount >= m.cfg.NumWorkers {
 				m.processEvents(dispatcher)
 				eventsCount, dispatcher = 0, newEventDispatcher(m.logger)
 			}","With this change exactly `m.cfg.NumWorkers` events can be processed in parallel (not `m.cfg.NumWorkers + 1`, as in the old version).",go,1,1,1
"@@ -2317,7 +2317,9 @@ func (e *historyEngineImpl) ResetWorkflowExecution(
 		request.GetWorkflowTaskFinishEventId() >= baseMutableState.GetNextEventID() {
 		return nil, serviceerror.NewInvalidArgument(""Workflow task finish ID must be > 1 && <= workflow next event ID."")
 	}
-
+	if baseRunID == """" {
+		baseRunID = baseMutableState.GetExecutionInfo().RunID
+	}
 	// also load the current run of the workflow, it can be different from the base runID
 	resp, err := e.executionManager.GetCurrentExecution(&persistence.GetCurrentExecutionRequest{
 		NamespaceID: namespaceID,",Why do we need this when the code that follows already loads the runID?,go,1,1,1
"@@ -62,6 +62,8 @@ func (f *Filter) toMap() map[string]interface{} {
 	return fMap
 }
 
+const zeroTime = ""0001-01-01 00:00:00""
+
 func (f *Filter) ConstructQueryArgs() (string, []interface{}) {
 	fMap, query, args := f.toMap(), make([]string, 0), make([]interface{}, 0)
 ",do we need to use this to initialize `Start` and `End` in `Filter`?,go,1,1,1
"@@ -13,4 +13,5 @@
 
 package model
 
-//go:generate go run ../../gogenerate/awssdk.go -typesOnly=false
+// codegen tag required by AWS SDK generators
+//go:generate go run -tags codegen ../../gogenerate/awssdk.go -typesOnly=false",Where is the `codegen` tag being used?,go,1,1,1
"@@ -378,8 +378,12 @@ func TestImageWithSameNameAndDifferentID(t *testing.T) {
 	imageState2.PulledAt = imageState2.PulledAt.Add(-19 * time.Minute)
 	imageState3.PulledAt = imageState3.PulledAt.Add(-18 * time.Minute)
 
-	// Verify Task is stopped
-	verifyTaskIsStopped(taskEvents, task1, task2, task3)
+	go discardEvents(taskEvents)
+	// Wait for task to be stopped
+	waitForTaskStoppedByCheckStatus(task1)
+	waitForTaskStoppedByCheckStatus(task2)
+	waitForTaskStoppedByCheckStatus(task3)
+
 	task1.SetSentStatus(api.TaskStopped)
 	task2.SetSentStatus(api.TaskStopped)
 	task3.SetSentStatus(api.TaskStopped)","Can we do this everywhere? Basically, get rid of `verifyTaskIsStopped()` altogether?",go,1,1,1
"@@ -8,11 +8,11 @@ package account
 
 import (
 	""fmt""
-	""syscall""
+
+	""github.com/iotexproject/iotex-core/cli/ioctl/util""
 
 	""github.com/spf13/cobra""
 	""go.uber.org/zap""
-	""golang.org/x/crypto/ssh/terminal""
 
 	""github.com/iotexproject/iotex-core/cli/ioctl/cmd/alias""
 	""github.com/iotexproject/iotex-core/pkg/log""",wrong import group,go,1,0,1
"@@ -106,7 +106,7 @@ func TestProtoForCron(t *testing.T) {
 					ConcurrencyPolicy:       v1beta1.AllowConcurrent,
 					Schedule:                ""5 4 * * *"",
 					Suspend:                 &[]bool{true}[0],
-					StartingDeadlineSeconds: &[]int64{69}[0],
+					StartingDeadlineSeconds: &[]int64{60}[0],
 				},
 				Status: v1beta1.CronJobStatus{
 					Active: []v1.ObjectReference{{}, {}},",Is this just fixing a typo?,go,1,0,1
"@@ -34,6 +34,12 @@ import (
 	""github.com/jetstack/cert-manager/pkg/util/pki""
 )
 
+// The amount of time after the LastFailureTime of a Certificate
+// before the request should be retried.
+// In future this should be replaced with a more dynamic exponential
+// back-off algorithm.
+const RetryAfterLastFailure = time.Hour
+
 // PrivateKeyMatchesSpec returns an error if the private key bit size
 // doesn't match the provided spec. RSA, Ed25519 and ECDSA are supported.
 // If any error is returned, a list of violations will also be returned.",We should look at having the Certificate duration being a variable to the backoff function. A failed 1 hour cert will always have downtime here.,go,1,1,1
"@@ -29,11 +29,11 @@ const (
 )
 
 var (
-	validArgs       = []string{""endpoint"", ""wallet"", ""explorer"", ""defaultacc""}
-	validGetArgs    = []string{""endpoint"", ""wallet"", ""explorer"", ""defaultacc"", ""all""}
-	validExpl       = []string{""iotexscan"", ""iotxplorer""}
-	urlCompile      = regexp.MustCompile(urlPattern)
-	endpointCompile = regexp.MustCompile(""^"" + endpointPattern + ""$"")
+	supportedLanguage = []string{""English"", ""Chinese""}
+	validArgs         = []string{""endpoint"", ""wallet"", ""explorer"", ""defaultacc"", ""language""}
+	validGetArgs      = []string{""endpoint"", ""wallet"", ""explorer"", ""defaultacc"", ""language"", ""all""}
+	validExpl         = []string{""iotexscan"", ""iotxplorer""}
+	endpointCompile   = regexp.MustCompile(""^"" + endpointPattern + ""$"")
 )
 
 // configGetCmd represents the config get command","` supportedLanguage = []string{""English"", """"}`",go,1,1,1
"@@ -235,9 +235,11 @@ func TestProtocol_ClaimReward(t *testing.T) {
                 unclaimedBalance, _, err := p.UnclaimedBalance(ctx, sm, claimActionCtx.Caller)
                 require.NoError(t, err)
                 assert.Equal(t, big.NewInt(5), unclaimedBalance)
+                claimActionCtx.Caller = identityset.Address(28)
+
                 primAcc, err := accountutil.LoadAccount(sm, hash.BytesToHash160(claimActionCtx.Caller.Bytes()))
                 require.NoError(t, err)
-                assert.Equal(t, big.NewInt(1000005), primAcc.Balance)
+                assert.Equal(t, big.NewInt(980), primAcc.Balance)
 
                 // Claim negative amount of token will fail
                 _, err = p.Claim(claimCtx, sm, big.NewInt(-5))","i think we need to find out the root-cause? as mentioned in #2521, this test can pass in `make test`, but only fails when running as a separate test. must be sth like testConfig() or a local variable used by earlier test but changes when running separately. the proper fix is to understand why it happened that way and find out the exact root-cause",go,0,1,1
"@@ -170,6 +170,13 @@ const (
 	// {{ .Volume.isRestoreVol }}
 	IsRestoreVolumePropertyVTP VolumeTLPProperty = ""isRestoreVol""
 
+	// IsPatchVolumePropertyVTP indicates if the volume is being
+	// created with patch enabled.
+	//NOTE:
+	// The Corresponding value will be accessed as
+	// {{ .Volume.isPatch }}
+	IsPatchVolumePropertyVTP VolumeTLPProperty = ""isPatch""
+
 	// StorageClassVTP is the StorageClass of the volume
 	//
 	// NOTE:",Please avoid changing this file. Remove this constant.,go,1,1,1
"@@ -24,7 +24,12 @@ import (
 	""github.com/iotexproject/iotex-core/state/factory""
 )
 
-const testnetActionPath = ""testnet_actions.yaml""
+const (
+	testnetActionPath = ""testnet_actions.yaml""
+	// TODO: Gensis block producer's keypair should be a config. Note genesis block producer is not the creator
+	genesisProducerPublicKey  = ""0444b7ac782c60e90b1aa263fe4d61dbe73bf8260d3e773ce9f4f0dbc181e8e5f2e3b6f6d4cf47f1d53af95cf24b88b92037125c7bf6f63b55bebbb8579b3a9b24""
+	genesisProducerPrivateKey = ""bace9b2435db45b119e1570b4ea9c57993b2311e0c408d743d87cd22838ae892""
+)
 
 // Genesis defines the Genesis default settings
 type Genesis struct {",line is 161 characters (from `lll`),go,1,0,1
"@@ -169,6 +169,7 @@ type Transaction struct {
 	// To add another one, create a struct with XXXTransactionType and embed it here.
 	// To prevent extraneous fields, all must have the ""omitempty"" tag.
 	Payment *PaymentTransactionType `json:""payment,omitempty""`
+	Keyreg  *KeyregTransactionType  `json:""keyreg,omitempty""`
 
 	// FromRewards is the amount of pending rewards applied to the From
 	// account as part of this transaction.","While we're at it, can you swagger annotate both the `Payment` and `Keyreg` fields with a description, and `required: false`?",go,1,1,1
"@@ -149,15 +149,6 @@ func setLogCode(s *scope, name string, f func(format string, args ...interface{}
 // new objects to the build graph.
 func buildRule(s *scope, args []pyObject) pyObject {
         s.NAssert(s.pkg == nil, ""Cannot create new build rules in this context"")
-        // We need to set various defaults from config here; it is useful to put it on the rule but not often so
-        // because most rules pass them through anyway.
-        // TODO(peterebden): when we get rid of the old parser, put these defaults on all the build rules and
-        //                   get rid of this.
-        args[11] = defaultFromConfig(s.config, args[11], ""DEFAULT_VISIBILITY"")
-        args[15] = defaultFromConfig(s.config, args[15], ""DEFAULT_TESTONLY"")
-        args[30] = defaultFromConfig(s.config, args[30], ""DEFAULT_LICENCES"")
-        args[20] = defaultFromConfig(s.config, args[20], ""BUILD_SANDBOX"")
-        args[21] = defaultFromConfig(s.config, args[21], ""TEST_SANDBOX"")
         target := createTarget(s, args)
         s.Assert(s.pkg.Target(target.Label.Name) == nil, ""Duplicate build target in %s: %s"", s.pkg.Name, target.Label.Name)
         populateTarget(s, target, args)",you sure this is safe? did we put the defaults in everywhere they're needed?,go,1,1,0
"@@ -0,0 +1,18 @@
+// +build windows
+
+// Copyright 2014-2016 Amazon.com, Inc. or its affiliates. All Rights Reserved.
+//
+// Licensed under the Apache License, Version 2.0 (the ""License""). You may
+// not use this file except in compliance with the License. A copy of the
+// License is located at
+//
+//	http://aws.amazon.com/apache2.0/
+//
+// or in the ""license"" file accompanying this file. This file is distributed
+// on an ""AS IS"" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
+// express or implied. See the License for the specific language governing
+// permissions and limitations under the License.
+
+package api
+
+const OSType = ""windows""",Is this mainly used for task annotation purposes ?,go,1,1,1
"@@ -1379,3 +1379,8 @@ func (k *SimpleFS) SimpleFSFolderEditHistory(
 	// Now get the edit history.
 	return k.config.KBFSOps().GetEditHistory(ctx, node.GetFolderBranch())
 }
+
+func (k *SimpleFS) SimpleFSSuppressNotifications(ctx context.Context, nextSuppressIn int) error {
+	k.config.Reporter().SuppressNotifications(ctx, time.Second*time.Duration(nextSuppressIn))
+	return nil
+}","I don't understand this formula. If `nextSuppressIn` is supposed to be in seconds, shouldn't this be just `time.Second*nextSuppressIn`?",go,1,1,1
"@@ -2107,6 +2107,17 @@ func (wh *WorkflowHandler) ResetWorkflowExecution(ctx context.Context, request *
 		return nil, err
 	}
 
+	switch request.GetResetReapplyType() {
+	case enumspb.RESET_REAPPLY_TYPE_UNSPECIFIED:
+		request.ResetReapplyType = enumspb.RESET_REAPPLY_TYPE_ALL
+	case enumspb.RESET_REAPPLY_TYPE_ALL:
+		// noop
+	case enumspb.RESET_REAPPLY_TYPE_NONE:
+		// noop
+	default:
+		return nil, serviceerror.NewInternal(""unknown reset type"")
+	}
+
 	namespaceID, err := wh.GetNamespaceCache().GetNamespaceID(request.GetNamespace())
 	if err != nil {
 		return nil, err",I moved all default to `enums/defaults.go` file.,go,1,1,1
"@@ -59,7 +59,7 @@ type initPipelineVars struct {
 	environments      []string
 	githubOwner       string
 	githubRepo        string
-	githubURL         string
+	URL               string
 	githubAccessToken string
 	gitBranch         string
 }","changing this from `githubURL` to `URL` has the side effect of exporting only this struct member, which may not be desired behavior. Can we change it to `providerURL` or just `url`? I know that typically we want to render acronyms in all caps but this warrants an exception.",go,1,1,1
"@@ -30,7 +30,7 @@ import (
 	""github.com/hashicorp/vault/sdk/helper/certutil""
 	corelisters ""k8s.io/client-go/listers/core/v1""
 
-	""github.com/jetstack/cert-manager/pkg/apis/certmanager/v1""
+	v1 ""github.com/jetstack/cert-manager/pkg/apis/certmanager/v1""
 	""github.com/jetstack/cert-manager/pkg/util/pki""
 )
 ",we should rename this to `cmapi` if you mind changing that in the rest of the code too?,go,1,1,1
"@@ -3129,6 +3129,14 @@ func (s *Server) jsConsumerCreate(sub *subscription, c *client, a *Account, subj
 	// Make sure we have sane defaults.
 	setConsumerConfigDefaults(&req.Config)
 
+	// Check if we have a BackOff defined that MaxDeliver is within range etc.
+	if lbo := len(req.Config.BackOff); lbo > 0 && req.Config.MaxDeliver <= lbo {
+		err := errors.New(""max deliver required to be > length backoff values"")
+		resp.Error = NewJSConsumerCreateError(err, Unless(err))
+		s.sendAPIErrResponse(ci, acc, subject, reply, string(msg), s.jsonResponse(&resp))
+		return
+	}
+
 	// Determine if we should proceed here when we are in clustered mode.
 	if s.JetStreamIsClustered() {
 		if req.Config.Direct {","Remove this, and then have `resp.Error = NewJS...` that you will get adding the new error.",go,1,1,1
"@@ -637,11 +637,14 @@ func (t *tierValidator) deleteValidate(oldObj interface{}, userInfo authenticati
 }
 
 // validateAntreaGroupSelectors ensures that an IPBlock is not set along with namespaceSelector and/or a
-// podSelector.
+// podSelector. Similarly, ExternalEntitySelector cannot be set with PodSelector.
 func validateAntreaGroupSelectors(s corev1a2.GroupSpec) (string, bool) {
-	podSelector, serviceRef, ipBlock := 0, 0, 0
-	if s.NamespaceSelector != nil || s.PodSelector != nil {
-		podSelector = 1
+	selector, serviceRef, ipBlock := 0, 0, 0
+	if s.NamespaceSelector != nil || s.ExternalEntitySelector != nil || s.PodSelector != nil {
+		selector = 1
+	}
+	if s.PodSelector != nil && s.ExternalEntitySelector != nil {
+		selector = 2
 	}
 	if s.IPBlock != nil {
 		ipBlock = 1",nit: make it first cond and return early?,go,1,1,1
"@@ -152,14 +152,10 @@ func (c *Client) buildTestCommand(target *core.BuildTarget) (*pb.Command, error)
 // getCommand returns the appropriate command to use for a target.
 func (c *Client) getCommand(target *core.BuildTarget) string {
         if target.IsRemoteFile {
-                // TODO(peterebden): we should handle this using the Remote Fetch API once that's available.
-                urls := make([]string, len(target.Sources))
-                for i, s := range target.Sources {
-                        urls[i] = ""curl -fsSLo $OUT "" + s.String()
-                }
-                cmd := strings.Join(urls, "" || "")
+                // This isn't a real command, but it suits us to construct a pseudo-version of one.
+                cmd := ""fetch "" + strings.Join(target.AllURLs(c.state.Config), "" "") + "" & verify "" + strings.Join(target.Hashes, "" "")
                 if target.IsBinary {
-                        return ""("" + cmd + "") && chmod +x $OUT""
+                        return cmd + "" binary""
                 }
                 return cmd
         }",How does this work?,go,1,0,1
"@@ -65,7 +65,12 @@ func (e *encoder) EncodeMap(n int) driver.Encoder {
 	return &mapEncoder{m: m}
 }
 
-var typeOfGoTime = reflect.TypeOf(time.Time{})
+var (
+	typeOfGoTime    = reflect.TypeOf(time.Time{})
+	typeOfBinarySet = reflect.TypeOf([][]byte{})
+	typeOfStringSet = reflect.TypeOf([]string{})
+	typeOfNumberSet = reflect.TypeOf([]float64{})
+)
 
 // EncodeSpecial encodes time.Time specially.
 func (e *encoder) EncodeSpecial(v reflect.Value) (bool, error) {","I think we said that _decoding_ any of the set types would fail, but I think we should support _encoding_ of `[]int`, `[]string` and `[][]byte` as arrays. I don't think there's any risk of data loss or corruption if we do that.",go,1,1,1
"@@ -110,8 +110,14 @@ type CASTemplateSpec struct {
 	// Defaults are a list of default configurations that may be applied
 	// during provisioning of a CAS volume
 	Defaults []Config `json:""defaultConfig""`
+	// TaskNamespace is the namespace where the tasks
+	// are expected to be found
+	TaskNamespace string `json:""taskNamespace""`
 	// RunTasks refers to a set of tasks to be run
 	RunTasks RunTasks `json:""run""`
+	// OutputTask is the task that has the CAS template result's output
+	// format
+	OutputTask string `json:""output""`
 }
 
 // CASUpdateSpec is the specification to update a CAS volume","would it be ever possible that the all runtasks don't run in the same namespace? If yes, then we should probably make namespace updatable by having it in runtask also.",go,1,1,1
"@@ -21,6 +21,7 @@ import (
 
 	go_dockerclient ""github.com/fsouza/go-dockerclient""
 	gomock ""github.com/golang/mock/gomock""
+	""github.com/aws/amazon-ecs-agent/agent/api""
 )
 
 // Mock of Manager interface","I think the convention is to order import statements as: 1) native go packages, 2) packages from the same repo, 3) other packages, with an empty line between each group. So this new line should be in 21?",go,1,1,1
"@@ -2567,6 +2567,8 @@ sendToRoutesOrLeafs:
 		kind := rt.sub.client.kind
 		mh := c.msgb[:msgHeadProtoLen]
 		if kind == ROUTER {
+			// Router (and Gateway) nodes are RMSG. Set here since leafnodes may rewrite.
+			mh[0] = 'R'
 			mh = append(mh, acc.Name...)
 			mh = append(mh, ' ')
 		} else {",Can we do that also in the other place we use this buffer? That would be gateway.go:2202 (from master)?,go,1,1,1
"@@ -17,5 +17,5 @@ type ContainerDependency struct {
 	SatisfiedStatus ContainerStatus `json:""SatisfiedStatus""`
 	// DependentStatus defines the status that cannot be reached until the
 	// resource satisfies the dependency
-	DependentStatus ContainerStatus `json:""DependentStatus""`
+	DependentStatus ContainerStatus `json:""DependentStatus,omitempty""`
 }",Is adding `omitempty` absolutely necessary here? Are there conditions in which it could break the JSON marshaling/unmarshaling logic? I'd rather not add this if it's only giving us marginal gains.,go,1,1,1
"@@ -15,4 +15,5 @@ type execVars struct {
 	taskID           string
 	containerName    string
 	skipConfirmation bool
+	yes              *bool
 }","I wonder if we should make this flag more descriptive, like `ssmPlugin` or `updateSSM` or something?",go,1,1,1
"@@ -171,12 +171,15 @@ type OutputInfo struct {
         FailureMessageWithoutPrivacyInfo string `json:""failure_message_without_privacy_info,omitempty""`
 }
 
-func (i *InputParams) updateParams(p *string) {
-        if p == nil {
+func (i *InputParams) updateParams(projectPointer *string) {
+        logParamsMutex.Lock()
+        defer logParamsMutex.Unlock()
+
+        if projectPointer == nil {
                 return
         }
 
-        project := *p
+        project := *projectPointer
         obfuscatedProject := Hash(project)
 
         if i.ImageImportParams != nil {",project is enough as it's obvious it's pointer from the type,go,1,1,1
"@@ -191,7 +191,11 @@ func MakeOfflineNode(t *testing.T) *Node {
 // DefaultTestingConfig returns default configuration for testing
 func DefaultTestingConfig() []ConfigOpt {
         return []ConfigOpt{
-                VerifierConfigOption(verification.NewFakeVerifier(true, nil)),
+                VerifierConfigOption(verification.NewFakeVerifier(verification.FakeVerifierConfig{
+                        VerifyPoStValid:                true,
+                        VerifyPieceInclusionProofValid: true,
+                        VerifySealValid:                true,
+                })),
         }
 }
 ","In my branch, the tests pass with this option removed. I believe we're only using this config for testing init and message propagation (which shouldn't touch proofs). Is this necessary?",go,1,1,1
"@@ -55,7 +55,7 @@ func TestChainValidationMessageSuite(t *testing.T) {
 
 func TestChainValidationTipSetSuite(t *testing.T) {
         f := NewFactories(&ValidationConfig{
-                trackGas:         true,
+                trackGas:         false,
                 checkExitCode:    true,
                 checkReturnValue: true,
         })",Do not merge this.,go,0,0,0
"@@ -272,8 +272,8 @@ func newSyntheticOpenContext() *openContext {
 func (f *FS) CreateFile(ctx context.Context, fi *dokan.FileInfo, cd *dokan.CreateData) (dokan.File, bool, error) {
 	// Only allow the current user access
 	if !fi.IsRequestorUserSidEqualTo(currentUserSID) {
-		f.log.Errorf(""Refusing access: SID match error"")
-		return nil, false, dokan.ErrAccessDenied
+		f.log.Errorf(""FS CreateFile - Refusing real access: SID match error"")
+		return openFakeRoot(ctx, f, fi)
 	}
 	f.logEnter(ctx, ""FS CreateFile"")
 	return f.openRaw(ctx, fi, cd)","We're always guaranteed on Windows that the root will get a `CreateFile` call first on an empty string, before file listing is allowed or any other specific files can be looked up?",go,1,1,1
"@@ -191,7 +191,7 @@ func makeErrorCookie(value string) *http.Cookie {
 		MaxAge:   defaultErrorCookieMaxAge,
 		Path:     rootPath,
 		Secure:   true,
-		HttpOnly: true,
+		HttpOnly: false,
 		SameSite: http.SameSiteLaxMode,
 	}
 }",I changed this value to read the error message from JavaScript.,go,1,1,1
"@@ -218,6 +218,19 @@ func validateAlertManagerRoutes(r *monitoringv1alpha1.Route, receivers map[strin
 		return errors.Errorf(""receiver %q not found"", r.Receiver)
 	}
 
+	if groupLen := len(r.GroupBy); groupLen > 0 {
+		groupedBy := make(map[string]struct{}, groupLen)
+		for _, str := range r.GroupBy {
+			if _, found := groupedBy[str]; found {
+				return errors.Errorf(""duplicate values not permitted in route 'groupBy': %v"", r.GroupBy)
+			}
+			groupedBy[str] = struct{}{}
+		}
+		if _, found := groupedBy[""...""]; found && groupLen > 1 {
+			return errors.Errorf(""'...' must be a sole value in route 'groupBy': %v"", r.GroupBy)
+		}
+	}
+
 	children, err := r.ChildRoutes()
 	if err != nil {
 		return err","For my understanding, what is the reason for using both the OpenAPI validation and implementing our own operator-side validation?",go,1,1,1
"@@ -1332,7 +1332,7 @@ func getWorkflowStatus(statusStr string) executionpb.WorkflowExecutionStatus {
 }
 
 func getWorkflowIDReusePolicy(value int) commonpb.WorkflowIdReusePolicy {
-	if value >= 0 && value <= len(commonpb.WorkflowIdReusePolicy_value) {
+	if value > 0 && value < len(commonpb.WorkflowIdReusePolicy_value) {
 		return commonpb.WorkflowIdReusePolicy(value)
 	}
 	// At this point, the policy should return if the value is valid","Gah, we force customers to pass integer here - WIll log issue",go,1,1,1
"@@ -18,9 +18,14 @@
 package cmd
 
 import (
+        ""encoding/json""
         ""path/filepath""
         ""time""
 
+        ""github.com/mysteriumnetwork/node/nat/traversal/config""
+
+        ""github.com/mysteriumnetwork/node/nat/traversal""
+
         ""github.com/asaskevich/EventBus""
         log ""github.com/cihub/seelog""
         ""github.com/ethereum/go-ethereum/accounts/keystore""",Something wrong with import blocks.,go,1,0,0
"@@ -104,7 +104,12 @@ func (o *initAppOpts) Validate() error {
 
 // Ask prompts the user for any required arguments that they didn't provide.
 func (o *initAppOpts) Ask() error {
-	if ok, _ := o.isSessionFromEnvVars(); ok { // Ignore the error, we do not want to crash for a warning.
+	ok, err := o.isSessionFromEnvVars()
+	if err != nil {
+		return err
+	}
+
+	if ok {
 		log.Warningln(`Looks like you're creating an application using credentials set by environment variables.
 Copilot will store your application metadata in this account.
 We recommend using credentials from named profiles. To learn more:",awesome find! (and sorry for the bug :disappear:),go,1,0,1
"@@ -28,10 +28,10 @@ const defaultEnvironmentName = ""test""
 // InitAppOpts holds the fields to bootstrap a new application.
 type InitAppOpts struct {
 	// User provided fields
-	Project string `survey:""project""` // namespace that this application belongs to.
-	Name    string `survey:""name""`    // unique identifier to logically group AWS resources together.
-	Type    string `survey:""Type""`    // type of application you're trying to build (LoadBalanced, Backend, etc.)
-
+	Project          string `survey:""project""` // namespace that this application belongs to.
+	Name             string `survey:""name""`    // unique identifier to logically group AWS resources together.
+	Type             string `survey:""Type""`    // type of application you're trying to build (LoadBalanced, Backend, etc.)
+	SkipDeploy       bool   // whether to skip asking if we should deploy a test environment.
 	existingProjects []string
 
 	projStore archer.ProjectStore","Will there be other places where non-interactive prompt is needed? If that's the case, maybe we should have a consistent ""--non-interactive"" flag instead?",go,1,1,1
"@@ -29,8 +29,8 @@ const (
 	// ECSBridgeNetworkName is the name of the HNS network used as ecs-bridge.
 	ECSBridgeNetworkName = ""nat""
 	// Constants for creating backoff while retrying setupNS.
-	setupNSBackoffMin      = time.Second * 2
-	setupNSBackoffMax      = time.Second * 6
+	setupNSBackoffMin      = time.Second * 4
+	setupNSBackoffMax      = time.Minute
 	setupNSBackoffJitter   = 0.2
 	setupNSBackoffMultiple = 1.3
 	setupNSMaxRetryCount   = 3",How did you come up with these values?,go,1,1,1
"@@ -47,7 +47,7 @@ func TestCreateNewChunkOnFirstWrite(t *testing.T) {
 
 	data := []byte(""This is a sample data to write"")
 
-	buf := NewBufferedWriter(ctx, bufferSize, workerNum, mockGcsClient, oauth, prefix, bkt, obj)
+	buf := NewBufferedWriter(ctx, bufferSize, workerNum, mockGcsClient, oauth, prefix, bkt, obj, ""GCEExport"")
 	_, err := buf.Write(data)
 	assert.Nil(t, err)
 	assert.Equal(t, 1, buf.part)","The overview mentioned that you're changing the prefix: ""Fixed by allowing setting proper err log prefix."", but here it looks like it's still `GCEExport`. Which prefix were you hoping to use?",go,1,1,1
"@@ -0,0 +1,12 @@
+package grpcutil
+
+import (
+	""log""
+
+	""github.com/sirupsen/logrus""
+)
+
+func LoggerFromFieldLogger(fl logrus.FieldLogger) *log.Logger {
+	errWriter := fl.WithFields(logrus.Fields{}).WriterLevel(logrus.ErrorLevel)
+	return log.New(errWriter, """", 0)
+}",nit: Should this return logrus.StdLogger instead?,go,1,1,1
"@@ -25,6 +25,16 @@ import (
 	""github.com/mysteriumnetwork/node/session""
 )
 
+// SessionStatus represents list of possible session statuses
+type SessionStatus int
+
+const (
+	// SessionStatusNew means that newly created session object is written to storage
+	SessionStatusNew = SessionStatus(0)
+	// SessionStatusCompleted means that session object is updated on connection disconnect event
+	SessionStatusCompleted = SessionStatus(1)
+)
+
 // Session holds structure for saving session history
 type Session struct {
 	SessionID       session.ID `storm:""id""`","If it updated on disconnect event, maybe we should call it `Finished`?",go,1,1,1
"@@ -95,6 +95,10 @@ func (c *Controller) syncHandler(key string) error {
 	// TODO: Deep-copy only when needed.
 	cspcGot := cspc.DeepCopy()
 	err = c.syncCSPC(cspcGot)
+	if err != nil {
+		return err
+	}
+	err = cleanupCSPIResources(cspcGot)
 	return err
 }
 ",In the next PR's we can generate an event instead of returning an error. The event will be more visible to the user.,go,1,1,1
"@@ -11,9 +11,11 @@ import (
 
 	""github.com/ethersphere/bee/pkg/logging""
 	""github.com/ethersphere/bee/pkg/statestore/leveldb""
-	""github.com/ethersphere/bee/pkg/statestore/mock""
 	""github.com/ethersphere/bee/pkg/storage""
 	""github.com/ethersphere/bee/pkg/swarm""
+
+	ldb ""github.com/syndtr/goleveldb/leveldb""
+	ldbs ""github.com/syndtr/goleveldb/leveldb/storage""
 )
 
 // InitStateStore will initialize the stateStore with the given path to the",is it not possible to move this whole block into the `statestore/leveldb` implementation?,go,1,1,1
"@@ -19,13 +19,14 @@ func TestTruncate(t *testing.T) {
 		{""foo"", 0, """"},
 		{""foo"", -1, """"},
 		{""Löwen"", 4, ""Löwe""},
-		{""あああああああああ/data"", 10, ""あああああ""},
-		{""あああああああああ/data"", 11, ""あああああ""},
+		{""あああああ/data"", 7, ""あああ""},
+		{""あああああ/data"", 10, ""あああああ""},
+		{""あああああ/data"", 11, ""あああああ/""},
 	}
 
 	for _, test := range tests {
 		t.Run("""", func(t *testing.T) {
-			out := truncate(test.input, test.width)
+			out := Truncate(test.input, test.width)
 			if out != test.output {
 				t.Fatalf(""wrong output for input %v, width %d: want %q, got %q"",
 					test.input, test.width, test.output, out)","I think we should also keep this test, which checks that a unicode character is not split in half.",go,1,1,1
"@@ -23,10 +23,10 @@ func New(key *ecdsa.PrivateKey, pub *ecdsa.PublicKey, salt []byte, padding int,
 	return encryption.New(sk, padding, 0, hashfunc), nil
 }
 
-// NewEncrypter constructs an El-Gamal encryptor
+// NewEncryptor constructs an El-Gamal encryptor
 // this involves generating an ephemeral key pair the public part of which is returned
 // as it is needed for the counterparty to decrypt
-func NewEncrypter(pub *ecdsa.PublicKey, salt []byte, padding int, hashfunc func() hash.Hash) (encryption.Encrypter, *ecdsa.PublicKey, error) {
+func NewEncryptor(pub *ecdsa.PublicKey, salt []byte, padding int, hashfunc func() hash.Hash) (encryption.Encrypter, *ecdsa.PublicKey, error) {
 	privKey, err := crypto.GenerateSecp256k1Key()
 	if err != nil {
 		return nil, nil, err",why renaming to `Encryptor`? can we please have `Encrypter`?,go,1,1,1
"@@ -402,9 +402,10 @@ func printTaskStart(cmd *cobra.Command, start *pb.StartTaskReply) {
 func printBalanceInfo(cmd *cobra.Command, reply *pb.BalanceReply) {
 	side := reply.GetSideBalance().ToPriceString()
 	live := reply.GetLiveBalance().ToPriceString()
+	eth := reply.GetLiveEthBalance().ToPriceString()
 
 	if isSimpleFormat() {
-		cmd.Printf(""On Ethereum: %s SNM\n"", live)
+		cmd.Printf(""On Ethereum: %s SNM | %s Eth\n"", live, eth)
 		cmd.Printf(""On SONM:     %s SNM\n"", side)
 	} else {
 		showJSON(cmd, map[string]map[string]string{""balance"": {",I'd rather named it as `ethLive`. Just for clarity.,go,1,1,1
"@@ -804,9 +804,7 @@ func TestConnectionIsClosedOnIdle(t *testing.T) {
 		_heartbeatJitter:     10 * time.Millisecond,
 	}
 	go func() {
-		timer := newDisconnectionTimer(mockWsClient, acsSession.heartbeatTimeout(), acsSession.heartbeatJitter())
-		defer timer.Stop()
-		acsSession.startACSSession(mockWsClient, timer)
+		acsSession.startACSSession(mockWsClient)
 	}()
 
 	// Wait for connection to be closed. If the connection is not closed",nit: remove the function wrapper `go acsSession.startACSSession(mockWsClient)`,go,1,1,1
"@@ -21,7 +21,10 @@ func setupGetAncestorTests(require *require.Assertions) (context.Context, *th.Te
 // requireGrowChain grows the given store numBlocks single block tipsets from
 // its head.
 func requireGrowChain(ctx context.Context, require *require.Assertions, blockSource *th.TestFetcher, chainStore chain.Store, numBlocks int) {
-	link := chainStore.Head()
+	head := chainStore.GetHead()
+	headTipSetAndState, err := chainStore.GetTipSetAndState(ctx, head)
+	require.NoError(err)
+	link := headTipSetAndState.TipSet
 
 	signer, ki := types.NewMockSignersAndKeyInfo(1)
 	mockSignerPubKey := ki[0].PublicKey()",these three lines are repeated a zillion times if you want to make a helper out of 'em. up to you.,go,1,1,1
"@@ -63,8 +63,10 @@ type generatedAccount struct {
 func init() {
         accountCreateCmd.Flags().UintVarP(&numAccounts, ""num"", ""n"", 1,
                 config.TranslateInLang(flagNumUsages, config.UILanguage))
+
         accountCreateCmd.Flags().BoolVar(&CryptoSm2, ""sm2"", false,
                 config.TranslateInLang(flagSm2Usage, config.UILanguage))
+        accountCreateCmd.Flags().MarkHidden(""sm2"")
 }
 
 func accountCreate() error {",I thought we agree to delete these,go,0,0,1
"@@ -84,7 +84,7 @@ func StartSession(params *TelemetrySessionParams, statsEngine stats.Engine) erro
 			seelog.Info(""TCS Websocket connection closed for a valid reason"")
 			backoff.Reset()
 		} else {
-			seelog.Infof(""Error from tcs; backing off: %v"", tcsError)
+			seelog.Errorf(""Error: lost websocket connection with ECS Telemetry service (TCS): %v"", tcsError)
 			params.time().Sleep(backoff.Duration())
 		}
 	}","Can this be warn instead of errorf, customers look at these logs and think that something is wrong with the Agent when essentially it is not sending metrics to tcs.",go,1,1,1
"@@ -206,6 +206,10 @@ type Provisioning struct {
 	// Defaults to openshift-install if none specified.
 	// +optional
 	InstallStrategy *InstallStrategy `json:""installStrategy,omitempty""`
+
+	// ServiceAccountIssuerKeySecretRef refers to a Secret that contains a 'bound-service-account-signing-key.key' data key pointing to the private key that will be used to sign ServiceAccount objects. Primarily used to provision AWS clusters to use Amazon's Security Token Service.
+	// +optional
+	ServiceAccountIssuerKeySecretRef *corev1.LocalObjectReference `json:""serviceAccountIssuerKeySecretRef,omitempty""`
 }
 
 // ClusterImageSetReference is a reference to a ClusterImageSet",Would this be better named BoundServiceAccountSigningKeySecretRef to match the installer filename? Also why am I not seeing the change in top level apis/ ? Only the vendored version?,go,1,1,1
"@@ -54,6 +54,9 @@ const (
 //              b. Notify dirty rules
 //
 type Controller struct {
+	// antreaPolicyEnabled indicates whether Antrea NetworkPolicy and
+	// ClusterNetworkPolicy are enabled.
+	antreaPolicyEnabled bool
 	// antreaClientProvider provides interfaces to get antreaClient, which can be
 	// used to watch Antrea AddressGroups, AppliedToGroups, and NetworkPolicies.
 	// We need to get antreaClient dynamically because the apiserver cert can be",btw why not use features.DefaultFeatureGate.Enabled() to determine?,go,1,1,1
"@@ -74,7 +74,7 @@ func accountDelete(args []string) string {
 	for _, v := range ks.Accounts() {
 		if bytes.Equal(account.Bytes(), v.Address.Bytes()) {
 			fmt.Printf(""Enter password #%s:\n"", name)
-			bytePassword, err := terminal.ReadPassword(syscall.Stdin)
+			bytePassword, err := terminal.ReadPassword(int(syscall.Stdin))
 			if err != nil {
 				log.L().Error(""fail to get password"", zap.Error(err))
 				return err.Error()",unnecessary conversion (from `unconvert`),go,1,0,1
"@@ -14,7 +14,7 @@ func init() {
 
 // Block is a block in the blockchain.
 type Block struct {
-	Parent *cid.Cid `json:""parent""`
+	Parents SortedCidSet `json:""parents""`
 
 	// Height is the chain height of this block.
 	Height uint64 `json:""height""`","Shouldn't this be `*SortedCidSet`, or is there a specific reason you are using the value here?",go,1,1,1
"@@ -714,8 +714,8 @@ func (fs *FS) Chtimes(name string, atime time.Time, mtime time.Time) (
 	return fs.config.KBFSOps().SetMtime(fs.ctx, n, &mtime)
 }
 
-// Chroot implements the billy.Filesystem interface for FS.
-func (fs *FS) Chroot(p string) (newFS billy.Filesystem, err error) {
+// Chrute returns a *FS whose root is p.
+func (fs *FS) Chrute(p string) (newFS *FS, err error) {
 	fs.log.CDebugf(fs.ctx, ""Chroot %s"", p)
 	defer func() {
 		fs.deferLog.CDebugf(fs.ctx, ""Chroot done: %+v"", err)",I don't really get this function name. Maybe `ChrootAsLibFS()`?,go,1,1,1
"@@ -305,16 +305,11 @@ func (s *syncInstrument) RecordOne(ctx context.Context, number api.Number, kvs [
 // processor will call Collect() when it receives a request to scrape
 // current metric values.  A push-based processor should configure its
 // own periodic collection.
-func NewAccumulator(processor export.Processor, opts ...Option) *Accumulator {
-	c := &Config{}
-	for _, opt := range opts {
-		opt.Apply(c)
-	}
-
+func NewAccumulator(processor export.Processor, resource *resource.Resource) *Accumulator {
 	return &Accumulator{
 		processor:        processor,
 		asyncInstruments: internal.NewAsyncInstrumentState(),
-		resource:         c.Resource,
+		resource:         resource,
 	}
 }
 ","In the tracing SDK the resource is associated at the Provider level. Is the idea that this will come from the provider, but allows this to be configured for testing?",go,1,1,1
"@@ -328,11 +328,13 @@ func (r *Base) GetOrCreateReceiveAdapter(ctx context.Context, desired *appsv1.De
 	existing, err := r.getReceiveAdapter(ctx, ps)
 	if err != nil && !apierrors.IsNotFound(err) {
 		logging.FromContext(ctx).Desugar().Error(""Unable to get an existing Receive Adapter"", zap.Error(err))
+		ps.Status.MarkDeployedUnknown(""Error getting an existing Receive Adapter"", err.Error())
 		return nil, err
 	}
 	if existing == nil {
 		existing, err = r.KubeClientSet.AppsV1().Deployments(ps.Namespace).Create(desired)
 		if err != nil {
+			ps.Status.MarkDeployedFailed(""Error creating an Receive Adapter"", err.Error())
 			logging.FromContext(ctx).Desugar().Error(""Error creating Receive Adapter"", zap.Error(err))
 			return nil, err
 		}","nit: ""Error create the Receive Adapter""",go,1,1,1
"@@ -28,6 +28,8 @@ var statesaver statemanager.Saver = statemanager.NewNoopStateManager()
 
 func HandleEngineEvents(taskEngine engine.TaskEngine, client api.ECSClient, saver statemanager.Saver) {
 	statesaver = saver
+	handler := NewTaskHandler()
+
 	for {
 		taskEvents, containerEvents := taskEngine.TaskEvents()
 ",It looks like now you have two separate `taskHandler`s: one here and one in `agent/acs/handler/payload_handler.go`. Is that intentional?,go,1,1,1
"@@ -2,6 +2,9 @@
 // Use of this source code is governed by a BSD-style
 // license that can be found in the LICENSE file.
 
+// Package debugapi exposes the debug API used to
+// control and analyze low-level features and functionalities
+// of Bee.
 package debugapi
 
 import (","Not just low-level, I would say the runtime state.",go,1,1,1
"@@ -639,8 +639,9 @@ func (km *KeyManagerStandard) Rekey(ctx context.Context, md *RootMetadata, promp
 	if !isWriter {
 		if len(newReaderUsers) > 0 || addNewWriterDevice || incKeyGen {
 			// If we're a reader but we haven't completed all the work, return
-			// RekeyIncompleteError
-			return false, nil, RekeyIncompleteError{}
+			// RekeyIncompleteError.
+			rekeyDone := len(newReaderUsers) > 0
+			return rekeyDone, nil, RekeyIncompleteError{}
 		}
 		// Otherwise, there's nothing left to do!
 		return true, nil, nil",Why does this mean it rekeyed anything?,go,1,0,0
"@@ -27,10 +27,11 @@ type Interface interface {
 }
 
 type ipset struct {
+	refCount
 }
 
 func New() Interface {
-	return &ipset{}
+	return &ipset{refCount: newRefCount()}
 }
 
 func (i *ipset) Create(ipsetName Name, ipsetType Type) error {",Is it possible for `Destroy` to be called twice with the same `ipsetName`?,go,1,1,1
"@@ -14,7 +14,7 @@ import (
 	""strconv""
 
 	""github.com/golang/protobuf/proto""
-	grpc_prometheus ""github.com/grpc-ecosystem/go-grpc-prometheus""
+	""github.com/grpc-ecosystem/go-grpc-prometheus""
 	""github.com/pkg/errors""
 	""go.uber.org/zap""
 	""google.golang.org/grpc""",File is not `goimports`-ed (from `goimports`),go,1,1,1
"@@ -90,8 +90,7 @@ func TestFormatWithCommentsParens(t *testing.T) {
 		t.Fatal(err)
 	}
 
-	if want := `
-// comment\n(1 * 1)`; want != got {
+	if want := `// comment\n(1 * 1)`; want != got {
 		t.Errorf(""unexpected formatted file -want/+got:\n\t- %q\n\t+ %q"", want, got)
 	}
 }",Is this a change that was added to the formatter or just a go format change?,go,1,1,1
"@@ -16,6 +16,7 @@ type Connection interface {
 	BreakTie(Connection) ConnectionTieBreak
 	RemoteTCPAddr() string
 	Established() bool
+	Outbound() bool
 	Shutdown(error)
 	Log(args ...interface{})
 }","Suggested order: Local, Remote, RemoteTCPAddr, Outbound, Established, BreakTie, Shutdown, Log.",go,1,1,1
"@@ -39,6 +39,7 @@ func TestGenerateConfig(t *testing.T) {
 		baseConfig alertmanagerConfig
 		amConfigs  map[string]*monitoringv1alpha1.AlertmanagerConfig
 		expected   string
+		ctx        context.Context
 	}
 
 	globalSlackAPIURL, err := url.Parse(""http://slack.example.com"")","I think it would make more sense to have the context global to the test function. I don't think we need to test different contexts in the cases, it should remain the same for each of them.",go,1,1,1
"@@ -106,6 +106,13 @@ func TestValidateSecurityWithMaskPaths(t *testing.T) {
 				{Type: configs.NEWNS},
 			},
 		),
+		// Required to pass mount validation.
+		Mounts: []*configs.Mount{
+			{Destination: ""/proc""},
+			{Destination: ""/sys""},
+			{Destination: ""/dev/shm""},
+			{Destination: ""/dev/pts""},
+		},
 	}
 
 	validator := validate.New()",One more test to make it failed with invalid mount info?,go,1,1,1
"@@ -37,8 +37,8 @@ const (
 	Streaming
 )
 
-// HandlerSpec holds either a UnaryTransportHandler or StreamTransportHandler.
-type HandlerSpec struct {
+// TransportHandlerSpec holds either a UnaryTransportHandler or StreamTransportHandler.
+type TransportHandlerSpec struct {
 	t Type
 
 	unaryHandler  UnaryTransportHandler","Let's avoid interleaving types and methods. With few exceptions, a type declaration should be followed by all of its methods. It might even be okay to rename this to transport.go and add encoding.go or similar with the mirror world types and methods.",go,1,1,1
"@@ -40,6 +40,18 @@ func (z ChannelID) MarshalJSON() ([]byte, error) {
 	return json.Marshal(z.val)
 }
 
+// MarshalBinary converts a ChannelID to bytes
+func (z *ChannelID) MarshalBinary() ([]byte, error) {
+	return z.Bytes(), nil
+}
+
+// UnmarshalBinary converts bytes to a ChannelID
+func (z *ChannelID) UnmarshalBinary(b []byte) error {
+	chID := NewChannelIDFromBytes(b)
+	*z = *chID
+	return nil
+}
+
 // An ChannelID is a signed multi-precision integer.
 type ChannelID struct{ val *big.Int }
 ",the idea was for this structures to implement `Encode/Decode` which can be then use with multiple encoders.,go,1,1,1
"@@ -230,7 +230,7 @@ var TxnTypeNames = []string{
 }
 
 // map TxnTypeName to its enum index, for `txn TypeEnum`
-var txnTypeIndexes map[string]int
+var txnTypeIndexes map[string]uint64
 
 // map symbolic name to uint64 for assembleInt
 var txnTypeConstToUint64 map[string]uint64","why uint64? these are indexes in an array, and no plans to have 2^64 long arrays",go,1,1,1
"@@ -17,12 +17,18 @@ limitations under the License.
 package main
 
 import (
-	""github.com/google/knative-gcp/pkg/broker/ingress""
 	""go.uber.org/zap""
+
+	""github.com/google/knative-gcp/pkg/broker/ingress""
 	""knative.dev/pkg/logging""
 	""knative.dev/pkg/signals""
 )
 
+// main creates and starts an ingress handler using default options.
+// 1. It listens on port 8080
+// 2. It reads ""GOOGLE_CLOUD_PROJECT"" env var for pubsub project. If the env var is empty, it retrieves project ID from
+//    GCE metadata.
+// 3. It expects broker configmap mounted at ""/var/run/cloud-run-events/broker/targets""
 func main() {
 	// Since we pass nil, a default config with no error will be returned.
 	cfg, _ := logging.NewConfigFromMap(nil)",We've previously used `PROJECT_ID` for this env var in other receive adapters. We should be consistent here.,go,1,1,1
"@@ -1103,6 +1103,7 @@ func TransferOwnership(u *User, newOwnerName string, repo *Repository) error {
 
 	wikiPath := WikiPath(owner.Name, repo.Name)
 	if com.IsExist(wikiPath) {
+		RemoveAllWithNotice(""Delete repository wiki local copy"", repo.LocalWikiPath())
 		if err = os.Rename(wikiPath, WikiPath(newOwner.Name, repo.Name)); err != nil {
 			return fmt.Errorf(""rename repository wiki: %v"", err)
 		}",~~All part from line 1104 to 1110 could be replaced by the newly added line.~~,go,1,1,1
"@@ -403,7 +403,15 @@ func (b *bucket) ListPaged(ctx context.Context, opts *driver.ListOptions) (*driv
 func (b *bucket) As(i interface{}) bool { return false }
 
 // As implements driver.ErrorAs.
-func (b *bucket) ErrorAs(err error, i interface{}) bool { return false }
+func (b *bucket) ErrorAs(err error, i interface{}) bool {
+	if perr, ok := err.(*os.PathError); ok {
+		if p, ok := i.(**os.PathError); ok {
+			*p = perr
+			return true
+		}
+	}
+	return false
+}
 
 // Attributes implements driver.Attributes.
 func (b *bucket) Attributes(ctx context.Context, key string) (driver.Attributes, error) {",Please also update the package godoc for As.,go,1,1,1
"@@ -146,9 +146,14 @@ func (manager *basicStateManager) writeFile(data []byte) error {
 		seelog.Errorf(""Failed to save the data file path: %v"", err)
 		return err
 	}
+	if oldFile == """" {
+		return nil
+	}
+
 	err = deps.fs.Remove(oldFile)
 	if err != nil {
 		seelog.Errorf(""Error removing old file %s; err %v"", oldFile, err)
+		return err
 	}
 	return nil
 }",i think you still need `return nil` here.,go,1,0,1
"@@ -13,9 +13,9 @@ import (
 	""sync""
 	""time""
 
+	""github.com/iotexproject/go-fsm""
 	""github.com/pkg/errors""
 	""github.com/prometheus/client_golang/prometheus""
-	""github.com/zjshen14/go-fsm""
 	""go.uber.org/zap""
 
 	""github.com/iotexproject/iotex-core/crypto""",File is not `goimports`-ed (from `goimports`),go,0,1,1
"@@ -42,10 +42,11 @@ var (
 		""sles-12-byol"":        ""suse/translate_sles_12_byol.wf.json"",
 		""sles-15-byol"":        ""suse/translate_sles_15_byol.wf.json"",
 		""rhel-6"":              ""enterprise_linux/translate_rhel_6_licensed.wf.json"",
-		""rhel-6-byol"":         ""enterprise_linux/translate_rhel_6_byol.wf.json"",
 		""rhel-7"":              ""enterprise_linux/translate_rhel_7_licensed.wf.json"",
 		""rhel-8"":              ""enterprise_linux/translate_rhel_8_licensed.wf.json"",
+		""rhel-6-byol"":         ""enterprise_linux/translate_rhel_6_byol.wf.json"",
 		""rhel-7-byol"":         ""enterprise_linux/translate_rhel_7_byol.wf.json"",
+		""rhel-8-byol"":         ""enterprise_linux/translate_rhel_8_byol.wf.json"",
 		""ubuntu-1404"":         ""ubuntu/translate_ubuntu_1404.wf.json"",
 		""ubuntu-1604"":         ""ubuntu/translate_ubuntu_1604.wf.json"",
 		""ubuntu-1804"":         ""ubuntu/translate_ubuntu_1804.wf.json"",",@zmarano -- Any thoughts on the name of the user-facing OS name? (`rhel-8-byol` vs `rhel-8-byos`),go,0,1,1
"@@ -73,7 +73,7 @@ func AdminShowWorkflow(c *cli.Context) {
 	serializer := serialization.NewSerializer()
 	var history []*commonpb.DataBlob
 	if len(tid) != 0 {
-		histV2 := cassandra.NewHistoryV2PersistenceFromSession(session, log.NewNoopLogger())
+		histV2 := cassandra.NewWorkflowStore(-1, session, log.NewNoopLogger())
 		resp, err := histV2.ReadHistoryBranch(&persistence.InternalReadHistoryBranchRequest{
 			TreeID:    tid,
 			BranchID:  bid,","this is weird, can we try to put shard ID as part of request? instead of internal var of execution / workflow store",go,1,1,1
"@@ -57,9 +57,9 @@ type Actor struct{}
 type State struct {
 	Miners cid.Cid `refmt:"",omitempty""`
 
-	// TotalCommitedStorage is the number of sectors that are currently committed
-	// in the whole network.
-	TotalCommittedStorage *big.Int
+	// TODO: Determine correct unit of measure. Could be denominated in the
+	// smallest sector size supported by the network.
+	TotalCommittedStorage *types.BytesAmount
 
 	ProofsMode types.ProofsMode
 }","Would you mind linking an existing github issue in this TODO, or making a new one and linking it if one does not already exist?",go,1,1,1
"@@ -25,13 +25,15 @@ func TestTotal(t *testing.T) {
 
 	ctx := context.Background()
 
-	power := uint64(19)
-	bs, _, st := requireMinerWithPower(ctx, t, power)
+	numCommittedSectors := uint64(19)
+	bs, _, st := requireMinerWithPower(ctx, t, numCommittedSectors)
 
 	actual, err := (&consensus.MarketView{}).Total(ctx, st, bs)
 	require.NoError(t, err)
 
-	assert.Equal(t, power, actual)
+	expected := types.OneKiBSectorSize.Mul(types.NewBytesAmount(numCommittedSectors))
+
+	assert.Equal(t, expected.Uint64(), actual.Uint64())
 }
 
 func TestMiner(t *testing.T) {",This function name is now a bit misleading about the uint value.,go,1,1,1
"@@ -143,3 +143,7 @@ type wsProjectManager interface {
 type artifactPutter interface {
 	PutArtifact(bucket, fileName string, data io.Reader) (string, error)
 }
+
+type port interface {
+	Set(number int) error
+}",Is this interface used anywhere?,go,1,0,1
"@@ -1270,6 +1270,9 @@ func (s *Server) StartProfiler() {
 	s.profilingServer = srv
 	s.mu.Unlock()
 
+	// Enable blocking profile
+	runtime.SetBlockProfileRate(1)
+
 	go func() {
 		// if this errors out, it's probably because the server is being shutdown
 		err := srv.Serve(l)","I am thinking this was part of a test, no?",go,1,0,1
"@@ -1182,7 +1182,7 @@ func TestGetHostPublicIPv4AddressFromEC2MetadataFailWithError(t *testing.T) {
 	assert.Empty(t, agent.getHostPublicIPv4AddressFromEC2Metadata())
 }
 
-func TestSpotTerminationTimeCheck_Yes(t *testing.T) {
+func TestSpotInstanceActionCheck_Terminate(t *testing.T) {
 	ctrl := gomock.NewController(t)
 	defer ctrl.Finish()
 ",all these unit tests could be made table-driven.,go,1,1,1
"@@ -1,8 +1,13 @@
 package plugin
 
-import ""github.com/sirupsen/logrus""
+import (
+	""io/ioutil""
 
-// Log provides a plugin logger to version shim implementations.
-type Log struct {
-	logrus.FieldLogger
+	""github.com/sirupsen/logrus""
+)
+
+func NullLogger() logrus.FieldLogger {
+	logger := logrus.New()
+	logger.Out = ioutil.Discard
+	return logger
 }",I think we should be able to use `io.Discard` now that we are on Go 1.16.,go,1,1,1
"@@ -0,0 +1,16 @@
+package tequilapi
+
+import (
+	""github.com/stretchr/testify/assert""
+	""testing""
+)
+
+func TestLocalApiServerPortIsAsExpected(t *testing.T) {
+	server, err := NewServer("""", 31337, nil)
+	assert.Nil(t, err)
+
+	assert.Equal(t, 31337, server.Port())
+
+	server.Stop()
+	server.Wait()
+}","You dont need a getter method, because You are testing in same package",go,1,1,1
"@@ -14,14 +14,13 @@ import (
 	""github.com/aws/copilot-cli/internal/pkg/aws/aas""
 	""github.com/aws/copilot-cli/internal/pkg/aws/cloudwatch""
 	""github.com/aws/copilot-cli/internal/pkg/aws/ecs""
-	rg ""github.com/aws/copilot-cli/internal/pkg/aws/resourcegroups""
 	""github.com/aws/copilot-cli/internal/pkg/aws/sessions""
 	""github.com/aws/copilot-cli/internal/pkg/deploy""
+	copiEcs ""github.com/aws/copilot-cli/internal/pkg/ecs""
 	""github.com/aws/copilot-cli/internal/pkg/term/color""
 )
 
 const (
-	ecsServiceResourceType    = ""ecs:service""
 	maxAlarmStatusColumnWidth = 30
 )
 ","nit: I'd instead rename the `aws/ecs` to `awsECS`. Reading ""copiEcs"" is kinda odd :P",go,1,1,1
"@@ -25,7 +25,13 @@ type ScheduleItem struct {
 	Workflow *WorkflowSpec `json:""workflow,omitempty""`
 }
 
-func (in EmbedChaos) Validate(chaosType string) field.ErrorList {
+func (in EmbedChaos) Validate(path *field.Path, chaosType string) field.ErrorList {
+	var allErrors field.ErrorList
 	gw.Default(&in)
-	return gw.Validate(&in)
+	root, err := in.SpawnNewObject(TemplateType(chaosType))
+	if err != nil {
+		allErrors = append(allErrors, field.Invalid(path, in, err.Error()))
+		return allErrors
+	}
+	return gw.Validate(root)
 }","The `Default` also has a `root` parameter, which could cause potential error.",go,1,1,1
"@@ -53,15 +53,13 @@ func fastcgiParse(c *caddy.Controller) ([]Rule, error) {
 	var rules []Rule
 
 	for c.Next() {
-		var rule Rule
-
 		args := c.RemainingArgs()
 
 		if len(args) < 2 || len(args) > 3 {
 			return rules, c.ArgErr()
 		}
 
-		rule.Path = args[0]
+		rule := Rule{Path: args[0], ReadTimeout: 60 * time.Second}
 		upstreams := []string{args[1]}
 
 		if len(args) == 3 {",I know that 60 seconds is a lot of time but this change can actually break existing configurations. I'm not really sure what value should be used as default. Suggestions @mholt ?,go,0,1,1
"@@ -285,7 +285,7 @@ func CheckNetWork(IP string, timeout int, cloudhubServer string, edgecoreServer
 	if config != """" {
 		edgeConfig, err := util.ParseEdgecoreConfig(config)
 		if err != nil {
-			err = fmt.Errorf(""parse Edgecore config failed"")
+			return fmt.Errorf(""parse Edgecore config failed"")
 		} else {
 			if cloudhubServer == """" {
 				cloudhubServer = edgeConfig.Modules.EdgeHub.WebSocket.Server",I think the else can't be deleted.The variable cloudhubServer need to be set a default value if it's not assigned.,go,1,1,1
"@@ -43,8 +43,9 @@ const (
 	ServiceHeaderKey = ""$rpc$-service""
 	// ApplicationErrorNameHeaderKey is the response header key for the application error name.
 	ApplicationErrorNameHeaderKey = ""$rpc$-application-error-name""
-	// ApplicationErrorMessageHeaderKey is the response header key for the application error messages.
-	ApplicationErrorMessageHeaderKey = ""$rpc$-application-error-message""
+	// ApplicationErrorDetailsHeaderKey is the response header key for the
+	// application error details string.
+	ApplicationErrorDetailsHeaderKey = ""$rpc$-application-error-details""
 	// ApplicationErrorCodeHeaderKey is the response header key for the application error code.
 	ApplicationErrorCodeHeaderKey = ""$rpc$-application-error-code""
 )","Same as above, what is the implication of this change? this is a public method, are you sure that nobody is using this?",go,1,1,1
"@@ -65,13 +65,10 @@ const (
 
 // SPI on the Trinket M0.
 var (
-	SPI0 = SPI{Bus: sam.SERCOM0_SPI,
-		SCK:     SPI0_SCK_PIN,
-		MOSI:    SPI0_MOSI_PIN,
-		MISO:    SPI0_MISO_PIN,
-		DOpad:   spiTXPad2SCK3,
-		DIpad:   sercomRXPad0,
-		PinMode: PinSERCOMAlt}
+	SPI0 = SPI{
+		Bus:    sam.SERCOM0_SPI,
+		SERCOM: 0,
+	}
 )
 
 // I2C pins",I think this should have been `sercomRXPad1` as well.,go,1,1,1
"@@ -16,6 +16,15 @@ import (
 )
 
 func SpawnHashStateStage(s *StageState, db ethdb.Database, tmpdir string, quit <-chan struct{}) error {
+	
+	go func() {
+		// we block until we can read something from the channel and then we reset hash state
+		<-quit
+		if err := ResetHashState(db); err != nil {
+			fmt.Errorf(""Unable to reset hashstate %v"", err)
+		}
+	}()
+
 	to, err := s.ExecutionAt(db)
 	if err != nil {
 		return err",%w is used for formatting errors,go,1,1,1
"@@ -74,6 +74,9 @@ func (s *CloudBackupServer) Create(
 		Labels:         req.GetLabels(),
 	})
 	if err != nil {
+		if err == volume.ErrInvalidName {
+			return nil, status.Errorf(codes.AlreadyExists, ""Failed to create backup: %v"", err)
+		}
 		return nil, status.Errorf(codes.Internal, ""Failed to create backup: %v"", err)
 	}
 ","Instead of using the same message, it should be something like ""Backup already exists or invalid name""...",go,1,1,1
"@@ -62,6 +62,14 @@ type blockJournal struct {
 	j          diskJournal
 	refs       map[BlockID]blockRefMap
 	isShutdown bool
+
+	// Tracks the total size of on-disk blocks that will be put to the
+	// server (i.e., does not count reference adds).  It is only
+	// accurate for users of this journal that properly flush entries;
+	// in particular, direct calls to `removeReferences` can cause
+	// this count to deviate from the actual disk usage of the
+	// journal.
+	blockBytes int64
 }
 
 type bserverOpName string","A better name might be `bytesToFlush`, to emphasize that it only matters when flushing.",go,1,1,1
"@@ -982,6 +982,10 @@ func (fbm *folderBlockManager) isQRNecessary(
 		fbm.log.CWarningf(ctx, ""Couldn't get the current session: %+v"", err)
 		return false
 	}
+	// It's ok to treat both MDs written by this process on this
+	// device, and MDs written by other processes (e.g., kbgit) in the
+	// same way.  Other processes are likely to be short-lived, and
+	// probably won't do their own QR, so a conflict is unlikely here.
 	selfWroteHead := session.VerifyingKey == head.LastModifyingWriterVerifyingKey()
 
 	// Don't do reclamation if the head isn't old enough and it wasn't","If the unlikely happen, does it just mean a more expensive operation, but not affect correctness?",go,1,1,1
"@@ -978,7 +978,7 @@ func (mset *Stream) Snapshot(deadline time.Duration, checkMsgs, includeConsumers
 		o.writeState()
 	}
 
-	return store.Snapshot(deadline, checkMsgs, includeConsumers)
+	return store.Snapshot(deadline, includeConsumers, checkMsgs)
 }
 
 const snapsDir = ""__snapshots__""","argument order in stream.Snapshot is different from store.Snapshot, I left as is and just fixed the bug but can fix - probably should",go,1,1,1
"@@ -354,10 +354,17 @@ type Rule struct {
 	// +optional
 	From []NetworkPolicyPeer `json:""from""`
 	// Rule is matched if traffic is intended for workloads selected by
-	// this field. If this field is empty or missing, this rule matches all
-	// destinations.
+	// this field. This field can't be used with ToServices. If this field
+	// and ToServices are both empty or missing this rule matches all destinations.
 	// +optional
 	To []NetworkPolicyPeer `json:""to""`
+	// Rule is matched if traffic is intended for a Service listed in this field.
+	// Currently only ClusterIP types Services are supported in this field. This field
+	// can only be used when AntreaProxy is enabled. This field can't be used with To
+	// or Ports. If this field and To are both empty or missing, this rule matches all
+	// destinations.
+	// +optional
+	ToServices []ServiceReference `json:""toServices""`
 	// Name describes the intention of this rule.
 	// Name should be unique within the policy.
 	// +optional","This is ambiguous IMO. We should use `Rule is matched if traffic is intended for a Service listed in this field`. The current phrasing *kind of* implies that we would enforce the policy when accessing endpoints directly, which is not the case.",go,1,1,1
"@@ -19,7 +19,7 @@ package participation
 import (
         ""path/filepath""
         ""testing""
-
+        ""runtime"" 
         ""github.com/stretchr/testify/require""
 
         ""github.com/algorand/go-algorand/config""",add an empty line after this entry,go,0,0,1
"@@ -351,6 +351,7 @@ func (brq *blockRetrievalQueue) Request(ctx context.Context,
 			}
 		}
 		br.reqMtx.Lock()
+		defer br.reqMtx.Unlock()
 		br.requests = append(br.requests, &blockRetrievalRequest{
 			block:  block,
 			doneCh: ch,",I needed to move this so that the assignment of `br.priority` below is protected by the lock.,go,1,1,1
"@@ -74,7 +74,7 @@ public interface BAToolsConfig extends Config
 	@ConfigItem(
 		keyName = ""healerMenuOption"",
 		name = ""Healer menu options"",
-		description = ""asd""
+		description = ""Healer menu options""
 	)
 	default boolean healerMenuOption()
 	{",This is not really a descriptive description,java,1,0,1
"@@ -28,6 +28,8 @@ public enum FireBirdFieldType {
         TIME(13, Types.TIME, DBPDataKind.DATETIME, ""TIME""),
         CHAR(14, Types.CHAR, DBPDataKind.STRING, ""CHAR""),
         BIGINT(16, Types.BIGINT, DBPDataKind.NUMERIC, ""BIGINT""),
+    NUMERIC(16, Types.NUMERIC, DBPDataKind.NUMERIC, ""NUMERIC""), // Equal id, but another subtype - 1
+    DECIMAL(16, Types.DECIMAL, DBPDataKind.NUMERIC, ""DECIMAL""), // Equal id, but another subtype - 2
     BOOLEAN(23, Types.BOOLEAN, DBPDataKind.BOOLEAN, ""BOOLEAN""),
         DOUBLE_PRECISION(27, Types.DOUBLE, DBPDataKind.NUMERIC, ""DOUBLE PRECISION""),
         TIMESTAMP(35, Types.TIMESTAMP, DBPDataKind.DATETIME, ""TIMESTAMP""),","Mixed tabs and spaces, you can reformat this file entirely",java,1,1,1
"@@ -19,7 +19,7 @@ import net.sourceforge.pmd.lang.java.qname.JavaTypeQualifiedName;
  *
  * </pre>
  */
-public class ASTEnumConstant extends AbstractJavaNode implements JavaQualifiableNode {
+public class ASTEnumConstant extends AbstractJavaTypeNode implements JavaQualifiableNode {
 
     private JavaTypeQualifiedName qualifiedName;
 ","I'm not sure how this interacts with pmd 7 - I think enum constants have the type of their enum type (not an anonymous class), but the AnonymousClass node, if any, will have a different type... Something to keep in mind when merging into pmd 7",java,1,1,1
"@@ -58,6 +58,8 @@ public abstract class AbstractAzkabanServlet extends HttpServlet {
   private static final String AZKABAN_FAILURE_MESSAGE =
       ""azkaban.failure.message"";
   private static final long serialVersionUID = -1;
+
+  protected String passwordPlaceholder;
   private AzkabanServer application;
   private String name;
   private String label;",Why passwordPlaceholder is added in AbstractAzkabanServlet instead of LoginAbstractAzkabanServlet?,java,1,0,1
"@@ -104,6 +104,8 @@ public final class UserDictionary implements Dictionary {
     long ord = 0;
     
     for (String[] values : featureEntries) {
+      String surface = values[0].replaceAll("" "", """");
+      String concatenatedSegment = values[1].replaceAll("" "", """");
       String[] segmentation = values[1].replaceAll(""  *"", "" "").split("" "");
       String[] readings = values[2].replaceAll(""  *"", "" "").split("" "");
       String pos = values[3];",maybe replace all white space here (ie including tabs) by using \s?,java,1,0,1
"@@ -73,6 +73,9 @@ final class FilterComparator implements Comparator<Filter>, Serializable {
                 filterToOrder.put(
                         ""org.springframework.security.oauth2.client.web.OAuth2AuthorizationRequestRedirectFilter"",
                                 order.next());
+                filterToOrder.put(
+                                ""org.springframework.security.saml2.provider.service.servlet.filter.SamlServiceProviderMetadataFilter"",
+                                order.next());
                 filterToOrder.put(
                                 ""org.springframework.security.saml2.provider.service.servlet.filter.Saml2WebSsoAuthenticationRequestFilter"",
                                 order.next());",I think this needs to be changed to match the changes made to `Saml2MetadataFilter`'s name and location.,java,1,1,1
"@@ -485,10 +485,16 @@ public class Transaction implements org.hyperledger.besu.plugin.data.Transaction
     }
 
     final BigInteger recId = BigInteger.valueOf(signature.getRecId());
-    if (chainId.isEmpty()) {
-      return recId.add(REPLAY_UNPROTECTED_V_BASE);
+
+    if (transactionType != null && transactionType != TransactionType.FRONTIER) {
+      // EIP-2718 typed transaction, return yParity:
+      return recId;
     } else {
-      return recId.add(REPLAY_PROTECTED_V_BASE).add(TWO.multiply(chainId.get()));
+      if (chainId.isEmpty()) {
+        return recId.add(REPLAY_UNPROTECTED_V_BASE);
+      } else {
+        return recId.add(REPLAY_PROTECTED_V_BASE).add(TWO.multiply(chainId.get()));
+      }
     }
   }
 ",Is it really transaction envelope or EIP1559 transactions ?,java,1,1,1
"@@ -1050,10 +1050,14 @@ public class JDBCConnection implements ObjectStoreConnection {
             ps.setString(2, roleName);
             try (ResultSet rs = executeQuery(ps, caller)) {
                 if (rs.next()) {
-                    return new Role().setName(ZMSUtils.roleResourceName(domainName, roleName))
-                            .setModified(Timestamp.fromMillis(rs.getTimestamp(ZMSConsts.DB_COLUMN_MODIFIED).getTime()))
-                            .setTrust(saveValue(rs.getString(ZMSConsts.DB_COLUMN_TRUST)))
-                            .setAuditEnabled(rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED));
+                    Role r = new Role();
+                    r.setName(ZMSUtils.roleResourceName(domainName, roleName))
+                     .setModified(Timestamp.fromMillis(rs.getTimestamp(ZMSConsts.DB_COLUMN_MODIFIED).getTime()))
+                     .setTrust(saveValue(rs.getString(ZMSConsts.DB_COLUMN_TRUST)));
+                    if (rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED)) {
+                        r.setAuditEnabled(rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED));
+                    }
+                     return r;
                 }
             }
         } catch (SQLException ex) {","I'd like to propose a slightly different implementation to make our intentions clear. I would keep the original code but replace the last line: .setAuditEnabled(rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED)); with .setAuditEnabled(nullIfDefaultValue(rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED), false)); and then have: Boolean nullIfDefaultValue(boolean flag, boolean defaultValue) { return flag == defaultValue ? null : flag; } this way a reader would know that our intentions is to use null when we have the default value as opposed to trying to understand why we're not setting the value false.",java,1,1,0
"@@ -113,6 +113,7 @@ abstract class Bucket<T> implements Transform<T, Integer> {
             predicate.op(), name, apply(predicate.literal().value()));
 //      case IN:
 //        return Expressions.predicate();
+      case STARTS_WITH:
       default:
         // comparison predicates can't be projected, notEq can't be projected
         // TODO: small ranges can be projected.","I am not sure if a `startsWith` predicate makes sense in case of `Bucket` transforms. Hence, leaving it to be handled by the `default` case. WDYT?",java,1,1,1
"@@ -26,6 +26,7 @@ public class NodeJSSampleTypeNameConverter implements SampleTypeNameConverter {
   /** A map from primitive types in proto to NodeJS counterparts. */
   private static final ImmutableMap<Field.Kind, String> PRIMITIVE_TYPE_MAP =
       ImmutableMap.<Field.Kind, String>builder()
+          .put(Field.Kind.TYPE_UNKNOWN, ""Object"")
           .put(Field.Kind.TYPE_BOOL, ""boolean"")
           .put(Field.Kind.TYPE_INT32, ""number"")
           .put(Field.Kind.TYPE_INT64, ""number"")","Currently PRIMITIVE_TYPE_MAP is used by getTypeNameForElementType, but IIUC this is only used by getTypeName, which I think uses it incorrectly, since Javascript arrays are untyped. I'm thinking neither PRIMITIVE_TYPE_MAP nor getTypeNameForElementType may be necessary.",java,1,1,1
"@@ -132,7 +132,7 @@ public final class DumpVisitor implements VoidVisitor<Object> {
 		}
 
 		public void printLn() {
-			buf.append(""\n"");
+			buf.append(System.getProperty(""line.separator""));
 			indented = false;
 		}
 ","Looks good, Java 7 has System.lineSeparator but I think it is the best we can do with our JDK 6 constraint",java,1,1,1
"@@ -145,6 +145,10 @@ public class TemporaryFilesystem {
   }
 
   public boolean deleteBaseDir() {
-    return baseDir.delete();
+    boolean wasDeleted = baseDir.delete();
+    if (wasDeleted) {
+      Runtime.getRuntime().removeShutdownHook(shutdownHook);
+    }
+    return wasDeleted;
   }
 }","I don't think we need to necessarily check if that returned true or not, we should just remove the shutdown hook. Since nothing would check or do anything with this flag anyways.",java,1,1,1
"@@ -245,12 +245,12 @@ public class ManifestEvaluator {
     }
 
     @Override
-    public <T> Boolean in(BoundReference<T> ref, Literal<T> lit) {
+    public <T> Boolean in(BoundReference<T> ref, LiteralSet<T> literalSet) {
       return ROWS_MIGHT_MATCH;
     }
 
     @Override
-    public <T> Boolean notIn(BoundReference<T> ref, Literal<T> lit) {
+    public <T> Boolean notIn(BoundReference<T> ref, LiteralSet<T> literalSet) {
       return ROWS_MIGHT_MATCH;
     }
   }","Since we can translate an `in` predicate to equality predicates or'ed together, this should call `eq` and or the results together.",java,1,1,1
"@@ -71,6 +71,9 @@ public class DynamicLangApiMethodTransformer {
       apiMethod.pageStreamingView(
           pageStreamingTransformer.generateDescriptor(
               context.getSurfaceInterfaceContext(), method));
+    } else if (context.getMethodConfig().isLongRunningOperation()) {
+      apiMethod.longRunningView(lroTransformer.generateDetailView(context));
+      apiMethod.type(ClientMethodType.OperationOptionalArrayMethod);
     } else {
       apiMethod.type(ClientMethodType.OptionalArrayMethod);
     }","One thing I was chatting to Michael B about, and which is independent of this but may diminish confusion: At the moment, some of the client method type enum values seem to be used in the same way (AFAICT) in different languages even though they we use distinct values. It might be desirable to use the same values across languages when they have the same semantics. This would be analogous to, but independent of, using the same calling form enum value (once we create the enum type) across different languages, where applicable.",java,0,1,0
"@@ -52,5 +52,17 @@ namespace AutoRest.Swagger.Validation
         ///     The severity of this message (ie, debug/info/warning/error/fatal, etc)
         /// </summary>
         public override Category Severity => Category.Warning;
+
+        /// <summary>
+        /// What kind of open api document type this rule should be applied to
+        /// </summary>
+        public override ServiceDefinitionDocumentType ServiceDefinitionDocumentType => ServiceDefinitionDocumentType.ARM;
+
+        /// <summary>
+        /// When to apply the validation rule, before or after it has been merged as a part of 
+        /// its merged document as specified in the corresponding '.md' file
+        /// By default consider all rules to be applied for After only
+        /// </summary>
+        public override ServiceDefinitionDocumentState ValidationRuleMergeState => ServiceDefinitionDocumentState.Individual;
     }
 }",why not consider data-plane here?,java,1,0,1
"@@ -102,10 +102,6 @@ public class CertFailedRefreshNotificationTask implements NotificationTask {
         // certificateRecords := <certificate-entry>[|<certificate-entry]*
         // certificate-entry := <Service Name>;<Provider>;<InstanceID>;<Last refresh time>;<Expiration time>;<Hostname>;
 
-        if (certRecords == null || certRecords.isEmpty()) {
-            return details;
-        }
-
         StringBuilder certDetails = new StringBuilder(256);
         for (X509CertRecord certRecord : certRecords) {
             if (certDetails.length() != 0) {",Going over the tests I realized that it is not possible for certRecords to be null at this point.,java,1,1,1
"@@ -45,6 +45,7 @@ public class Constants {
   public static final int MEMORY_CHECK_RETRY_LIMIT = 720;
   public static final int DEFAULT_PORT_NUMBER = 8081;
   public static final int DEFAULT_SSL_PORT_NUMBER = 8443;
+  public static final int DEFAULT_THREAD_NUMBER = 20;
 
   public static class ConfigurationKeys {
     // These properties are configurable through azkaban.properties",Can we make the name more explicit? It seems too general to me.,java,1,1,1
"@@ -57,12 +57,13 @@ public class FastDownloaderFactory {
 
     final Path fastSyncDataDirectory = dataDirectory.resolve(FAST_SYNC_FOLDER);
     final FastSyncStateStorage fastSyncStateStorage =
-        new FastSyncStateStorage(fastSyncDataDirectory);
+        new FastSyncStateStorage(fastSyncDataDirectory, protocolSchedule);
 
     if (syncConfig.getSyncMode() != SyncMode.FAST) {
       if (fastSyncStateStorage.isFastSyncInProgress()) {
         throw new IllegalStateException(
-            ""Unable to change the sync mode when fast sync is incomplete, please restart with fast sync mode"");
+            ""Unable to change the sync mode when fast sync is incomplete, please restart with fast""
+                + "" sync mode"");
       } else {
         return Optional.empty();
       }",Is it necessary to split these strings into 120 column bits? It increases the line count in an already large PR.,java,1,1,1
"@@ -49,7 +49,12 @@ class PruneColumns extends ParquetTypeVisitor<Type> {
       Type field = fields.get(i);
       Integer fieldId = getId(originalField);
       if (fieldId != null && selectedIds.contains(fieldId)) {
-        builder.addField(originalField);
+        if (field != null) {
+          hasChange = true;
+          builder.addField(field);
+        } else {
+          builder.addField(originalField);
+        }
         fieldCount += 1;
       } else if (field != null) {
         builder.addField(field);",Should I do the empty message only thing here as well? where we copy the struct to be empty?,java,1,1,1
"@@ -97,12 +97,7 @@ public class ExecutorHealthChecker {
       final Optional<Executor> executorOption = entry.getKey();
       if (!executorOption.isPresent()) {
         final String finalizeReason = ""Executor id of this execution doesn't exist."";
-        for (final ExecutableFlow flow : entry.getValue()) {
-          logger.warn(
-              String.format(""Finalizing execution %s, %s"", flow.getExecutionId(), finalizeReason));
-          ExecutionControllerUtils
-              .finalizeFlow(this.executorLoader, this.alerterHolder, flow, finalizeReason, null);
-        }
+        finalizeFlows(entry.getValue(), finalizeReason);
         continue;
       }
 ",I feel the function renaming is long overdue: finalizeFlowsIfExecutorIsUnhealthy() will better reflect what the function does. Also - midway in this function there is a ToDo from Jamie requesting a metric for Http response times? Do you know what is that for?,java,1,1,1
"@@ -28,7 +28,9 @@ import org.springframework.util.StringUtils;
 public class MicroserviceConfigLoader extends YAMLConfigLoader {
   private static final Logger LOGGER = LoggerFactory.getLogger(MicroserviceConfigLoader.class);
 
-  private static final String ADDITIONAL_CONFIG_URL = ""cse.configurationSource.additionalUrls"";
+  private static final String ADDITIONAL_CONFIG_URL = ""servicecomb.configurationSource.additionalUrls"";
+
+  private static final String DEFAULT_FILE_NAME = ""servicecomb.configurationSource.defaultFileName"";
 
   /**
    * Default configuration file name to be used by default constructor. This file should","not compatible? because we only copy config items in configuration source, not in system.property?",java,1,1,1
"@@ -16,9 +16,4 @@ package com.google.api.codegen.transformer.nodejs;
 
 import com.google.api.codegen.transformer.FeatureConfig;
 
-public class NodeJSFeatureConfig extends FeatureConfig {
-  @Override
-  public boolean enableGrpcStreaming() {
-    return true;
-  }
-}
+public class NodeJSFeatureConfig extends FeatureConfig {}",We can rename `FeatureConfig` to `DefaultFeatureConfig` so the languages use default values will not need to create an empty subclass.,java,1,1,1
"@@ -37,6 +37,11 @@ static CommentConfig comment_config = {
 };
 
 namespace csharp {
+struct FieldInfo {
+  std::string name;
+  int array_length;
+};
+
 class CSharpGenerator : public BaseGenerator {
  public:
   CSharpGenerator(const Parser &parser, const std::string &path,",These names are way to generic.. call this `FieldArrayLength` or something. Stick it inside `CsharpGenerator`,java,1,1,1
"@@ -4,12 +4,11 @@
 
 package net.sourceforge.pmd.lang.plsql.ast;
 
-import net.sourceforge.pmd.lang.ast.Node;
-import net.sourceforge.pmd.lang.ast.NodeStream;
+import net.sourceforge.pmd.lang.ast.impl.javacc.JjtreeNode;
 import net.sourceforge.pmd.lang.symboltable.Scope;
 import net.sourceforge.pmd.lang.symboltable.ScopedNode;
 
-public interface PLSQLNode extends Node, ScopedNode {
+public interface PLSQLNode extends ScopedNode, JjtreeNode<PLSQLNode> {
 
     /** Accept the visitor. **/
     Object jjtAccept(PLSQLParserVisitor visitor, Object data);","hm...yes, these methods are not ideal, too generic like ""getImage"". but this time on plsql...",java,1,0,1
"@@ -29,13 +29,13 @@ import java.util.Map;
  * Iteration order is not specified.
  * @lucene.internal
  */
-final class Multiset<T> extends AbstractCollection<T> {
+public final class Multiset<T> extends AbstractCollection<T> {
 
   private final Map<T, Integer> map = new HashMap<>();
   private int size;
 
   /** Create an empty {@link Multiset}. */
-  Multiset() {
+  public Multiset() {
     super();
   }
 ",This is used in o.a.l.sandbox.search.CoveringQuery.,java,1,0,1
"@@ -170,6 +170,6 @@ public class TableProperties {
   public static final String MERGE_MODE = ""write.merge.mode"";
   public static final String MERGE_MODE_DEFAULT = ""copy-on-write"";
 
-  public static final String MERGE_WRITE_CARDINALITY_CHECK = ""write.merge.cardinality-check.enabled"";
-  public static final boolean MERGE_WRITE_CARDINALITY_CHECK_DEFAULT = true;
+  public static final String MERGE_CARDINALITY_CHECK_ENABLED = ""write.merge.cardinality-check.enabled"";
+  public static final boolean MERGE_CARDINALITY_CHECK_ENABLED_DEFAULT = true;
 }",To match the property name above.,java,0,0,1
"@@ -317,6 +317,11 @@ public class JsonGenesisConfigOptions implements GenesisConfigOptions {
     return getOptionalLong(""thanosblock"");
   }
 
+  @Override
+  public OptionalLong getMagnetoBlockNumber() {
+    return getOptionalLong(""magnetoBlock"");
+  }
+
   @Override
   public OptionalLong getEcip1049BlockNumber() {
     return getOptionalLong(""ecip1049block"");",Should be lowercase.,java,1,0,1
"@@ -162,14 +162,6 @@ public class QueueFragment extends Fragment {
                 recyclerAdapter.notifyDataSetChanged();
                 break;
             case MOVED:
-                int from = FeedItemUtil.indexOfItemWithId(queue, event.item.getId());
-                int to = event.position;
-                if(from != to) {
-                    queue.add(to, queue.remove(from));
-                    recyclerAdapter.notifyItemMoved(from, to);
-                } else {
-                    // QueueFragment itself sent the event and already moved the item
-                }
                 break;
         }
         onFragmentLoaded();","perhaps I'm daft, how do we handle this case now?",java,1,0,1
"@@ -24,7 +24,6 @@ import org.apache.http.protocol.HttpContext;
 import org.camunda.bpm.client.impl.EngineClientLogger;
 import org.camunda.bpm.client.impl.ExternalTaskClientLogger;
 import org.camunda.bpm.client.interceptor.ClientRequestInterceptor;
-
 import java.io.IOException;
 import java.util.List;
 import java.util.Map;","I think you can revert all changes of this class, so the commit for the PR is clean in the end.",java,1,1,1
"@@ -197,11 +197,16 @@ public class Nutriments implements Serializable {
     private boolean containsMinerals;
 
     public Nutriment get(String nutrimentName){
-        if (!additionalProperties.containsKey(nutrimentName)) {
+        if (nutrimentName.isEmpty() || !additionalProperties.containsKey(nutrimentName)) {
             return null;
         }
 
-        return new Nutriment(additionalProperties.get(nutrimentName).toString(), get100g(nutrimentName), getServing(nutrimentName), getUnit(nutrimentName));
+        try{
+            return new Nutriment(additionalProperties.get(nutrimentName).toString(), get100g(nutrimentName), getServing(nutrimentName), getUnit(nutrimentName));
+        }catch (NullPointerException e){
+        // In case one of the getters was unable to get data as string
+        }
+        return null;
     }
 
     public String getUnit(String nutrimentName){",You should print something to the log here for troubleshooting issues. Even `e.printStackTrace()` would be fine.,java,1,1,1
"@@ -290,7 +290,7 @@ public class IngredientsProductFragment extends BaseFragment implements IIngredi
 
         List<String> allergens = getAllergens();
 
-        if (mState != null && product.getIngredientsText() != null) {
+        if (mState != null && product.getIngredientsText() != null && !product.getIngredientsText().isEmpty()) {
             textIngredientProductCardView.setVisibility(View.VISIBLE);
             SpannableStringBuilder txtIngredients = new SpannableStringBuilder(product.getIngredientsText().replace(""_"", """"));
             txtIngredients = setSpanBoldBetweenTokens(txtIngredients, allergens);",Cant we just have `if (mState != null && !product.getIngredientsText().isEmpty())`,java,1,1,1
"@@ -322,14 +322,14 @@ public class GraphiteReporter extends ScheduledReporter {
     }
 
     private void sendIfEnabled(MetricAttribute type, String name, double value, long timestamp) throws IOException {
-        if (getDisabledMetricAttributes().contains(type)){
+        if (isMetricAttributeDisabled(type)){
             return;
         }
         graphite.send(prefix(name, type.getCode()), format(value), timestamp);
     }
 
     private void sendIfEnabled(MetricAttribute type, String name, long value, long timestamp) throws IOException {
-        if (getDisabledMetricAttributes().contains(type)){
+        if (isMetricAttributeDisabled(type)){
             return;
         }
         graphite.send(prefix(name, type.getCode()), format(value), timestamp);",Let's avoid changes in the classes not directly targeted by this pull request.,java,1,1,1
"@@ -139,14 +139,9 @@ public class ClusterStatus {
       if (collectionVsAliases.containsKey(name) && !collectionVsAliases.get(name).isEmpty()) {
         collectionStatus.put(""aliases"", collectionVsAliases.get(name));
       }
-      try {
-        String configName = zkStateReader.readConfigName(name);
-        collectionStatus.put(""configName"", configName);
-        collectionProps.add(name, collectionStatus);
-      } catch (KeeperException.NoNodeException ex) {
-        // skip this collection because the configset's znode has been deleted
-        // which can happen during aggressive collection removal, see SOLR-10720
-      }
+      String configName = message.getStr(ZkStateReader.COLLECTION_CONFIG_PROP, clusterStateCollection.getConfigName());
+      collectionStatus.put(ZkStateReader.CONFIGNAME_PROP, configName);
+      collectionProps.add(name, collectionStatus);
     }
 
     List<String> liveNodes = zkStateReader.getZkClient().getChildren(ZkStateReader.LIVE_NODES_ZKNODE, null, true);",The message didn't have this before (I assume?); does it now?,java,1,0,1
"@@ -107,6 +107,13 @@ import javax.ws.rs.WebApplicationException;
 import javax.ws.rs.core.Response;
 import static javax.ws.rs.core.Response.Status.BAD_REQUEST;
 import javax.ws.rs.core.StreamingOutput;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
 
 /*
     Custom API exceptions [NOT YET IMPLEMENTED]",Looks like glassfish went a bit nuts doing a refactor,java,1,0,0
"@@ -23,6 +23,8 @@ import javax.annotation.Nullable;
  */
 @AutoValue
 public abstract class InitFieldConfig {
+  private static String randomValueToken = ""$RANDOM"";
+
   public abstract String fieldPath();
 
   @Nullable",Should this be final?,java,1,0,1
"@@ -51,6 +51,7 @@ public class TiConfiguration implements Serializable {
   private static final boolean DEF_WRITE_WITHOUT_LOCK_TABLE = false;
   private static final int DEF_TIKV_REGION_SPLIT_SIZE_IN_MB = 96;
   private static final boolean DEF_USE_TIFLASH = false;
+  private static final int DEF_PARTITION_PER_SPLIT = 10;
 
   private int timeout = DEF_TIMEOUT;
   private TimeUnit timeoutUnit = DEF_TIMEOUT_UNIT;",i'm curious why choose `10`?,java,1,1,1
"@@ -1497,7 +1497,8 @@ public class MessageCompose extends K9Activity implements OnClickListener,
                 message.setUid(mMessageReference.getUid());
             }
 
-            boolean saveRemotely = recipientPresenter.isAllowSavingDraftRemotely();
+            // TODO more appropriate logic here? not sure
+            boolean saveRemotely = !recipientPresenter.getCurrentCryptoStatus().shouldUsePgpMessageBuilder();
             new SaveMessageTask(getApplicationContext(), mAccount, mContacts, mHandler,
                     message, mDraftId, saveRemotely).execute();
             if (mFinishAfterDraftSaved) {","Maybe CryptoStatus can have a 'willBeEncrypted()'? That's what you're really after, right?",java,1,1,1
"@@ -627,6 +627,7 @@ class ResultSetPersister {
         @Override
         protected IStatus run(DBRProgressMonitor monitor) {
             model.setUpdateInProgress(this);
+            UIUtils.syncExec(viewer::fireResultSetChange); // Update ""save"" and ""cancel"" buttons
             updateStats = new DBCStatistics();
             insertStats = new DBCStatistics();
             deleteStats = new DBCStatistics();","Can we fire this event outside the `DataUpdaterJob` job, so we can avoid using `syncExec` here?",java,1,1,1
"@@ -57,7 +57,7 @@ class Java16ValidatorTest {
     class Record {
 
         @Nested
-        class RecordAsIdentifierForbidden {
+        class RecordAsIdentifierSometimesForbidden {
             @Test
             void recordUsedAsClassName() {
                 String s = ""public class record {}"";",Please keep the tests within the `Java16ValidatorTest` consistent with the ones within the Java14/15 preview validator tests. I fear I misled you within the issue -- my mistake. Perhaps rename this to `RecordAsTypeIdentifierForbidden`?,java,1,1,1
"@@ -162,9 +162,15 @@ public class InitCodeTransformer {
       }
     }
     if (context.getMethodConfig().isPageStreaming()) {
+      // Initialize one resource element if it is page-streaming.
       PageStreamingConfig config = context.getMethodConfig().getPageStreaming();
       fields.add(config.getResourcesField().getSimpleName() + ""[0]"");
     }
+    if (context.getMethodConfig().isBundling()) {
+      // Initialize one bundling element if it is bundling.
+      fields.add(
+          context.getMethodConfig().getBundling().getSubresponseField().getSimpleName() + ""[0]"");
+    }
     Map<String, Object> initFieldStructure =
         FieldStructureParser.parseFields(fields, createInitValueMap(context));
     return initFieldStructure;","Why don't we just initialize the whole object tree, and including at least one element of every list?",java,1,1,1
"@@ -90,6 +90,14 @@ public class PageStreamingTransformer {
 
     desc.requestTokenSetFunction(
         namer.getFieldSetFunctionName(pageStreaming.getRequestTokenField()));
+    desc.requestPageSizeSetFunction(
+        pageStreaming.hasPageSizeField()
+            ? namer.getFieldSetFunctionName(pageStreaming.getPageSizeField())
+            : null);
+    desc.requestPageSizeGetFunction(
+        pageStreaming.hasPageSizeField()
+            ? namer.getFieldGetFunctionName(pageStreaming.getPageSizeField())
+            : null);
     desc.responseTokenGetFunction(
         namer.getFieldGetFunctionName(pageStreaming.getResponseTokenField()));
     desc.resourcesFieldGetFunction(",It would be more readable if you do: if (pageStreaming.hasPageSizeField()) { desc.requestPageSizeSetFunction(namer.getFieldSetFunctionName(pageStreaming.getPageSizeField()) },java,1,1,1
"@@ -64,7 +64,7 @@ abstract class MergingSnapshotProducer<ThisT> extends SnapshotProducer<ThisT> {
   private static final Set<String> VALIDATE_DATA_FILES_EXIST_SKIP_DELETE_OPERATIONS =
       ImmutableSet.of(DataOperations.OVERWRITE, DataOperations.REPLACE);
   // delete files can be added in ""overwrite"" or ""delete"" operations
-  private static final Set<String> VALIDATE_REPLACED_DATA_FILES_OPERATIONS =
+  private static final Set<String> VALIDATE_ADDED_DELETE_FILES_OPERATIONS =
       ImmutableSet.of(DataOperations.OVERWRITE, DataOperations.DELETE);
 
   private final String tableName;",I renamed it to match `VALIDATE_ADDED_FILES_OPERATIONS `.,java,1,0,1
"@@ -420,14 +420,15 @@ public final class TreeMap<K, V> implements SortedMap<K, V>, Serializable {
         return createTreeMap(entries.comparator(), iterator().dropWhile(predicate));
     }
 
+    @SuppressWarnings(""unchecked"")
     @Override
-    public boolean containsKey(K key) {
+    public boolean containsKey(Object key) {
         final V ignored = null;
-        return entries.contains(new Tuple2<>(key, ignored));
+        return entries.contains(new Tuple2<>((K) key, ignored));
     }
 
     @Override
-    public boolean containsValue(V value) {
+    public boolean containsValue(Object value) {
         return iterator().map(Tuple2::_2).contains(value);
     }
 ",cast `(K) key` is unsafe,java,1,0,1
"@@ -1698,7 +1698,9 @@ public class MessageList extends K9Activity implements MessageListFragmentListen
 
         List<String> folderServerIds = search.getFolderServerIds();
         singleFolderMode = singleAccountMode && folderServerIds.size() == 1;
-        if (singleFolderMode) {
+        if (drawer == null) {
+            return;
+        } else if (singleFolderMode) {
             drawer.selectFolder(folderServerIds.get(0));
         } else if (search.getId().equals(SearchAccount.UNIFIED_INBOX)) {
             drawer.selectUnifiedInbox();",This skips the last line of the method that seems unrelated to the drawer. My suggestion is to extract the drawer-related code to a separate method and do the `null` check there.,java,1,1,1
"@@ -231,7 +231,9 @@ abstract class SnapshotProducer<ThisT> implements SnapshotUpdate<ThisT> {
             Snapshot newSnapshot = apply();
             newSnapshotId.set(newSnapshot.snapshotId());
             TableMetadata updated = base.replaceCurrentSnapshot(newSnapshot);
-            taskOps.commit(base, updated);
+            // if the table UUID is missing, add it here. the UUID will be re-created each time this operation retries
+            // to ensure that if a concurrent operation assigns the UUID, this operation will not fail.
+            taskOps.commit(base, updated.withUUID());
           });
 
     } catch (RuntimeException e) {","Just to make sure I understand: table UUID isn't supposed to change once assigned and cannot be set back to null, right?",java,1,1,1
"@@ -67,6 +67,10 @@ public class TextBody implements Body {
         }
     }
 
+    public String getEncoding() {
+        return encoding;
+    }
+
     public void setEncoding(String encoding) {
         mEncoding = encoding;
     }",Does this code compile? Isn't the member variable `mEncoding`?,java,1,1,1
"@@ -33,6 +33,18 @@ public class TransactionPoolOptions
   private static final String ETH65_TX_ANNOUNCED_BUFFERING_PERIOD_FLAG =
       ""--Xeth65-tx-announced-buffering-period-milliseconds"";
 
+  private static final String STRICT_TX_REPLAY_PROTECTION_ENABLED_FLAG =
+      ""--strict-tx-replay-protection-enabled"";
+
+  @CommandLine.Option(
+      names = {STRICT_TX_REPLAY_PROTECTION_ENABLED_FLAG},
+      paramLabel = ""<Boolean>"",
+      description =
+          ""Require transactions submitted via JSON-RPC to use replay protection in accordance with EIP-155 (default: ${DEFAULT-VALUE})"",
+      fallbackValue = ""true"",
+      arity = ""0..1"")
+  private Boolean strictTxReplayProtectionEnabled = false;
+
   @CommandLine.Option(
       names = {TX_MESSAGE_KEEP_ALIVE_SEC_FLAG},
       paramLabel = ""<INTEGER>"",","Ah, so it IS unstable already. Cool, lets prefix with X.",java,1,0,0
"@@ -229,7 +229,7 @@ public class VectorPropertyTest {
                 Seq<Tuple2<Seq<Object>, Vector<Object>>> history = Array.empty();
 
                 if (percent(random) < 20) {
-                    expected = Array.ofAll(Vector(randomValues(random, 100)).filter(v -> v instanceof Integer));
+                    expected = Array.ofAll(Vector(randomValues(random, 100)).filter(v -> ((Object) v) instanceof Integer));
                     actual = (percent(random) < 30) ? Vector.narrow(Vector.ofAll(ArrayType.<int[]> asPrimitives(int.class, expected))) : Vector.ofAll(expected);
                     assertAreEqual(expected, actual);
                     history = history.append(Tuple(expected, actual));",did not compile (any more!?) without that cast,java,1,1,0
"@@ -14,6 +14,7 @@
 package zipkin.storage.elasticsearch.http;
 
 import java.io.IOException;
+import java.util.*;
 import java.util.concurrent.TimeUnit;
 import okhttp3.mockwebserver.MockResponse;
 import okhttp3.mockwebserver.MockWebServer;",nit: no wildcards,java,1,0,1
"@@ -32,6 +32,12 @@ import azkaban.utils.JSONUtils;
 import azkaban.utils.Pair;
 import azkaban.utils.Props;
 import com.google.common.collect.Lists;
+import org.apache.commons.lang.StringUtils;
+import org.apache.log4j.Logger;
+import org.joda.time.DateTime;
+
+import javax.inject.Inject;
+import javax.inject.Singleton;
 import java.io.File;
 import java.io.IOException;
 import java.lang.Thread.State;",Is it possible to gradually move away from joda time to java8's time apis?,java,1,1,1
"@@ -89,6 +89,8 @@ public abstract class StaticLangApiMethodView implements ApiMethodView {
   @Nullable
   public abstract LongRunningOperationDetailView operationMethod();
 
+  public abstract String releaseAnnotation();
+
   public abstract Builder toBuilder();
 
   public static Builder newBuilder() {",I think `releaseLevelAnnotation` would be clearer.,java,1,1,1
"@@ -159,7 +159,15 @@ public abstract class GapicProductConfig implements ProductConfig {
             .put(document.name(), DiscoGapicInterfaceConfig.createInterfaceConfig(document))
             .build();
     // TODO actually load data
-    return createDummyInstance(interfaceConfigMap, """", """", null);
+
+    LanguageSettingsProto settings =
+        configProto.getLanguageSettings().get(configProto.getLanguage());
+    if (settings == null) {
+      settings = LanguageSettingsProto.getDefaultInstance();
+    }
+
+    // TODO (end copy from above method)
+    return createDummyInstance(interfaceConfigMap, settings.getPackageName(), """", null);
   }
 
   /** Creates an GapicProductConfig with no content. Exposed for testing. */",Can we get rid of this TODO?,java,1,0,1
"@@ -72,6 +72,7 @@ public class TestMineBlocks implements JsonRpcMethod {
             Functions.identity(),
             context.getEthHashSolver(),
             Wei.ZERO,
+            0.0,
             blockchain.getChainHeadHeader());
     final Block block = blockCreator.createBlock(retesethClock.instant().getEpochSecond());
 ",Is the ratio at 0 normal in this case?,java,1,1,1
"@@ -86,12 +86,11 @@ public class CloudConfigSetService extends ConfigSetService {
 
     // The configSet is read from ZK and populated.  Ignore CD's pre-existing configSet; only populated in standalone
     final String configSetName;
-    try {
-      configSetName = zkController.getZkStateReader().readConfigName(colName);
-      cd.setConfigSet(configSetName);
-    } catch (KeeperException ex) {
-      throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR, ""Trouble resolving configSet for collection "" + colName + "": "" + ex.getMessage());
+    configSetName = zkController.getZkStateReader().getClusterState().getCollection(colName).getConfigName();
+    if (configSetName == null) {
+      throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, ""configName is missing"");
     }
+    cd.setConfigSet(configSetName);
 
     return new ZkSolrResourceLoader(cd.getInstanceDir(), configSetName, parentLoader.getClassLoader(), zkController);
   }","I think we can have getConfigName never return null? That would be ideal, any way.",java,1,1,1
"@@ -37,6 +37,12 @@ module Selenium
         def bridge_class
           Bridge
         end
+
+        def print_page(**options)
+          options[:page_ranges] &&= Array(options[:page_ranges])
+
+          bridge.print_page(options)
+        end
       end # Driver
     end # Firefox
   end # WebDriver",Same here. and all others.,java,0,0,1
"@@ -318,7 +318,7 @@ abstract class BaseTableScan implements TableScan {
     return schema;
   }
 
-  private static String formatTimestampMillis(long millis) {
+  protected static String formatTimestampMillis(long millis) {
     return DATE_FORMAT.format(LocalDateTime.ofInstant(Instant.ofEpochMilli(millis), ZoneId.systemDefault()));
   }
 }",This isn't used. Could you revert this change?,java,1,1,1
"@@ -117,6 +117,9 @@ public abstract class Folder<T extends Message> {
     public void expunge() throws MessagingException
         {}
 
+    public void expungeMessages(List<? extends Message> messages) throws MessagingException {
+    }
+
     /**
      * Populate a list of messages based upon a FetchProfile.  See {@link FetchProfile} for the things that can
      * be fetched.","probably added by accident? \\ edit oh, it's a superclass. derp, nvm.",java,1,0,1
"@@ -486,10 +486,10 @@ public class BlockchainQueries {
    */
   public List<LogWithMetadata> matchingLogs(
       final long fromBlockNumber, final long toBlockNumber, final LogsQuery query) {
-    return LongStream.rangeClosed(fromBlockNumber, toBlockNumber)
-        .mapToObj(blockchain::getBlockHashByNumber)
-        .takeWhile(Optional::isPresent)
-        .flatMap(Optional::stream)
+    return LongStream.rangeClosed(fromBlockNumber, Math.min(toBlockNumber, headBlockNumber()))
+        .mapToObj(blockchain::getBlockHeader)
+        .filter(header -> header.isPresent() && query.couldMatch(header.get().getLogsBloom()))
+        .map(header -> header.get().getHash())
         .flatMap(hash -> matchingLogs(hash, query).stream())
         .collect(Collectors.toList());
   }","Interesting interaction here, if we use a `takeWhile` instead of the `Math.min`, we can actually return more logs in the case where a new block was added while the processing of the rpc call is happening because Java Streams are pull based. I lean towards the `takeWhile` approach because if the user asks for a block that's slightly too high, this could make the difference between them seeing most of what they wanted and everything they wanted (in the case where a block is stored in time for the end of the stream to be reached).",java,1,1,0
"@@ -1990,6 +1990,19 @@ class CSharpGenerator : public BaseGenerator {
           ""Newtonsoft.Json.Formatting.Indented);\n"";
       code += ""  }\n"";
     }
+    if (parser_.root_struct_def_ == &struct_def) {
+      code += ""  public static "" + class_name +
+              "" DeserializeFromFlatBuffers(byte[] fbBuffer) {\n"";
+      code += ""    return "" + struct_def.name + "".GetRootAs"" + struct_def.name +
+              ""(new ByteBuffer(fbBuffer)).UnPack();\n"";
+      code += ""  }\n"";
+      code += ""  public byte[] SerializeToFlatBuffers() {\n"";
+      code += ""    var fbb = new FlatBufferBuilder(1);\n"";
+      code +=
+          ""    fbb.Finish("" + struct_def.name + "".Pack(fbb, this).Value);\n"";
+      code += ""    return fbb.DataBuffer.ToSizedArray();\n"";
+      code += ""  }\n"";
+    }
     code += ""}\n\n"";
   }
 ","1 byte is a really bad default size, it is going to spend a lot of time re-allocating buffers this way. Probably anywhere from 4 to 64 K would be entirely reasonable given that this is very temporary.",java,1,1,1
"@@ -146,6 +146,7 @@ public class AzkabanWebServer extends AzkabanServer implements IMBeanRegistrable
   private final FlowTriggerScheduler scheduler;
   private final FlowTriggerService flowTriggerService;
   private Map<String, TriggerPlugin> triggerPlugins;
+  private final ExecutionLogsCleaner executionLogsCleaner;
 
   @Inject
   public AzkabanWebServer(final Props props,",Does it matter that we are changing the Ctor signature?,java,1,1,1
"@@ -21,9 +21,9 @@ import org.apache.tuweni.bytes.Bytes32;
 
 public class StorageEntriesCollector<V> implements TrieIterator.LeafHandler<V> {
 
-  private final Bytes32 startKeyHash;
-  private final int limit;
-  private final Map<Bytes32, V> values = new TreeMap<>();
+  protected final Bytes32 startKeyHash;
+  protected int limit = 0;
+  protected final Map<Bytes32, V> values = new TreeMap<>();
 
   public StorageEntriesCollector(final Bytes32 startKeyHash, final int limit) {
     this.startKeyHash = startKeyHash;",Why initialize and remove final?,java,1,1,1
"@@ -0,0 +1,10 @@
+package com.github.javaparser.ast.nodeTypes;
+
+import com.github.javaparser.ast.Node;
+import com.github.javaparser.ast.expr.Expression;
+
+public interface NodeWithExpression<N extends Node> {
+    Expression getExpression();
+
+    N setExpression(Expression expression);
+}",What are those nodes with Expressions? Are Expressions wrapping other expressions? Any sort of node containing one single expression?,java,1,1,1
"@@ -31,6 +31,14 @@ import org.apache.iceberg.io.OutputFile;
  */
 public interface EncryptedOutputFile {
 
+  /**
+   * Use flat filestream encryption (default) or pushdown to native format encryption
+   */
+  default boolean useNativeEncryption() {
+    return false;
+  }
+
+
   /**
    * An OutputFile instance that encrypts the bytes that are written to its output streams.
    */",Nit: an extra empty line,java,1,1,1
"@@ -234,6 +234,8 @@ class ModifyingSuggester {
   }
 
   private void tryRemovingChar(String word) {
+    if (word.length() == 1) return;
+
     for (int i = 0; i < word.length(); i++) {
       trySuggestion(word.substring(0, i) + word.substring(i + 1));
     }",We don't accept empty words for lookup anymore,java,1,1,1
"@@ -210,7 +210,6 @@ public final class BaselineErrorProne implements Plugin<Project> {
             // Errorprone 2.3.4 isn't officially compatible with Java13 either
             // https://github.com/google/error-prone/issues/1106
             errorProneOptions.check(""TypeParameterUnusedInFormals"", CheckSeverity.OFF);
-            errorProneOptions.check(""PreferCollectionConstructors"", CheckSeverity.OFF);
         }
 
         if (javaCompile.equals(compileRefaster)) {",calling out that I re-enabled this because it uses the safe qualify method now.,java,1,1,1
"@@ -19,7 +19,10 @@ package org.openqa.selenium.grid.graphql;
 
 import graphql.schema.DataFetcher;
 import graphql.schema.DataFetchingEnvironment;
+
+import org.openqa.selenium.SessionNotCreatedException;
 import org.openqa.selenium.grid.distributor.Distributor;
+import org.openqa.selenium.grid.sessionmap.SessionMap;
 import org.openqa.selenium.internal.Require;
 
 import java.net.URI;",You can safely revert changes to this file.,java,1,0,1
"@@ -64,7 +64,8 @@ public class RlpBlockImporter {
    * @throws IOException On Failure
    */
   public <C> RlpBlockImporter.ImportResult importBlockchain(
-      final Path blocks, final BesuController<C> besuController) throws IOException {
+      final Path blocks, final BesuController<C> besuController, final boolean skipPowValidation)
+      throws IOException {
     final ProtocolSchedule<C> protocolSchedule = besuController.getProtocolSchedule();
     final ProtocolContext<C> context = besuController.getProtocolContext();
     final MutableBlockchain blockchain = context.getBlockchain();",Do you think it's worth it to just have this take a `HeaderValidationMode` instead of the boolean? Same number of args but with a lot more flexibility.,java,1,1,1
"@@ -42,7 +42,7 @@ public class StructProjection implements StructLike {
    */
   public static StructProjection create(Schema schema, Set<Integer> ids) {
     StructType structType = schema.asStruct();
-    return new StructProjection(structType, TypeUtil.select(structType, ids));
+    return new StructProjection(structType, TypeUtil.project(structType, ids));
   }
 
   /**","Looks like there aren't any uses of this call, which is good. I agree that we probably want this to use `project` instead of `select`.",java,1,1,1
"@@ -18,9 +18,9 @@ import net.sourceforge.pmd.lang.java.ast.ASTMemberValuePair;
 import net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration;
 import net.sourceforge.pmd.lang.java.ast.ASTName;
 import net.sourceforge.pmd.lang.java.ast.ASTResultType;
-import net.sourceforge.pmd.lang.java.rule.AbstractLombokAwareRule;
+import net.sourceforge.pmd.lang.java.rule.AbstractJavaRule;
 
-public class UseUtilityClassRule extends AbstractLombokAwareRule {
+public class UseUtilityClassRule extends AbstractJavaRule {
 
     @Override
     public Object visit(ASTClassOrInterfaceBody decl, Object data) {",shouldn't we just extend `AbstractIgnoredAnnotationRule` and default it to `lombok.NoArgsConstructor`?,java,1,1,1
"@@ -251,12 +251,12 @@ public class HiveCatalog extends BaseMetastoreCatalog implements SupportsNamespa
             namespace);
 
     } catch (TException e) {
-      throw new RuntimeException(""Failed to create namespace "" + namespace + "" in Hive MataStore"", e);
+      throw new RuntimeException(""Failed to create namespace "" + namespace + "" in Hive MetaStore"", e);
 
     } catch (InterruptedException e) {
       Thread.currentThread().interrupt();
       throw new RuntimeException(
-          ""Interrupted in call to createDatabase(name) "" + namespace + "" in Hive MataStore"", e);
+          ""Interrupted in call to createDatabase(name) "" + namespace + "" in Hive MetaStore"", e);
     }
   }
 ","Out of curiosity, how do Hive folks prefer to write it? `MetaStore` or `Metastore`?",java,0,0,1
"@@ -121,7 +121,7 @@ public abstract class LoginAbstractAzkabanServlet extends AbstractAzkabanServlet
 
       handleGet(req, resp, session);
     } else {
-      if (hasParam(req, ""ajax"")) {
+      if (isAjaxCall(req)) {
         final HashMap<String, String> retVal = new HashMap<>();
         retVal.put(""error"", ""session"");
         this.writeJSON(resp, retVal);","I agree that it's better this way, but this is a breaking change on our api: anyone using our apis outside the website without specifying the header 'X-Requested-With' (not enforced) in POST requests will start getting json instead of html as a response when session expires which can happen often. Api versioning is the way to conduct these type of changes but unfortunately we haven't planned for that yet. I don't know what the impact of this change is but I prefer not to risk it.",java,1,1,0
"@@ -77,7 +77,7 @@ public class SignatureDeclareThrowsExceptionRule extends AbstractJavaRule {
             }
         }
         if (node.jjtGetNumChildren() != 0 && node.jjtGetChild(0) instanceof ASTExtendsList) {
-            ASTClassOrInterfaceType type = (ASTClassOrInterfaceType) node.jjtGetChild(0).jjtGetChild(0);
+            ASTClassOrInterfaceType type = node.jjtGetChild(0).getFirstChildOfType(ASTClassOrInterfaceType.class);
             if (isJUnitTest(type)) {
                 junitImported = true;
                 return super.visit(node, data);",This block and the one checking the interfaces (above) could be simplified using the methods `getSuperInterfacesTypeNodes` and `getSuperClassTypeNode` of `ASTClassOrInterfaceDeclaration`,java,1,1,1
"@@ -40,6 +40,10 @@ public abstract class DateTimeUtils {
     }
   }
 
+  public static String withTimezone(Date date) {
+      return DATE_FORMAT_WITH_TIMEZONE.format(date);
+  }
+
   public static Date updateTime(Date now, Date newTime) {
     Calendar c = Calendar.getInstance();
     c.setTime(now);","I would also call this method in the `return` statement of the `withTimezone(String dateString)` method above (line 37), so we don't have duplicate methods.",java,1,1,1
"@@ -17,7 +17,9 @@
 
 package org.apache.servicecomb.common.rest.codec.param;
 
+import java.io.UnsupportedEncodingException;
 import java.lang.reflect.Type;
+import java.net.URLDecoder;
 import java.util.Map;
 
 import javax.servlet.http.HttpServletRequest;",remove unused import,java,1,1,1
"@@ -49,8 +49,10 @@ public class IndexKey extends Key {
     for (int i = 0; i < indexColumns.size(); i++) {
       TiIndexColumn col = indexColumns.get(i);
       DataType colTp = tableInfo.getColumn(col.getOffset()).getType();
+      // using convertToTiDBType implicitly since the get method does not convert
+      Object convertedValue = colTp.convertToTiDBType(row.get(col.getOffset(), colTp));
       // truncate index's if necessary
-      Key key = TypedKey.toTypedKey(row.get(col.getOffset(), colTp), colTp, (int) col.getLength());
+      Key key = TypedKey.toTypedKey(convertedValue, colTp, (int) col.getLength());
       keys[i] = key;
     }
     return keys;","I feel like conversion should be done at the upper level. At this stage, row is already converted. Please correct me if my understanding is not quite right.",java,1,1,1
"@@ -121,6 +121,15 @@ public class SparkSessionCatalog<T extends TableCatalog & SupportsNamespaces>
     }
   }
 
+  @Override
+  public void invalidateTable(Identifier ident) {
+    if (icebergCatalog.tableExists(ident)) {
+      icebergCatalog.invalidateTable(ident);
+    } else {
+      getSessionCatalog().invalidateTable(ident);
+    }
+  }
+
   @Override
   public Table createTable(Identifier ident, StructType schema, Transform[] partitions,
                            Map<String, String> properties)",Do you need to check for Identififer cases whether is null or is it done by TableExists?,java,1,1,1
"@@ -3773,11 +3773,7 @@ public class MessagingController {
             return false;
         }
 
-        if (account.isNotifyContactsMailOnly() && !contacts.isAnyInContacts(message.getFrom())) {
-            return false;
-        }
-
-        return true;
+        return !account.isNotifyContactsMailOnly() || contacts.isAnyInContacts(message.getFrom());
     }
 
     public void deleteAccount(Account account) {",I find the old way makes this easier to read.,java,1,1,1
"@@ -1,4 +1,4 @@
-/* Copyright 2018 Google LLC
+/* Copyright 2016 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the ""License"");
  * you may not use this file except in compliance with the License.",Why is the year changing here?,java,1,1,1
"@@ -128,11 +128,13 @@ class GenericReaders {
     }
 
     @Override
+    @SuppressWarnings(""checkstyle:hiddenField"")
     protected Object get(Record struct, int pos) {
       return struct.get(pos);
     }
 
     @Override
+    @SuppressWarnings(""checkstyle:hiddenField"")
     protected void set(Record struct, int pos, Object value) {
       struct.set(pos, value);
     }","I know this rule is a bit controversial but I think it is better to follow it everywhere or ignore it globally. In this particular case, it seems appropriate to follow and, maybe, give another name to the field. It is not really clear the difference between the field and passed object.",java,1,1,1
"@@ -31,6 +31,11 @@ public class NodeSmartContractPermissioningConditions {
     return new WaitForTrueResponse(transactions.isNodeAllowed(address, node));
   }
 
+  public Condition enodeURLIsAllowed(
+      final String address, final String enodeURL, final Node executorNode) {
+    return new WaitForTrueResponse(transactions.isEnodeURLAllowed(address, enodeURL, executorNode));
+  }
+
   public Condition nodeIsForbidden(final String address, final Node node) {
     return new WaitForFalseResponse(transactions.isNodeAllowed(address, node));
   }",s/URL/Url for consistency,java,1,1,1
"@@ -102,11 +102,10 @@ public class SecurityActivity extends ThemedActivity {
                         swActiveSecurity.setChecked(true);
                         SP.putBoolean(getString(R.string.preference_use_password), true);
                         toggleEnabledChild(true);
-                    }
-                    else
-                    setPasswordDialog();
-                }
-                else {
+                        Snackbar.make(findViewById(android.R.id.content), ""Password Set"", Snackbar.LENGTH_SHORT)
+                                .show();
+                    } else setPasswordDialog();
+                } else {
                     editor.putBoolean(getString(R.string.preference_use_password), false);
                     editor.commit();
                     toggleEnabledChild(false);","Cant you use SanckBar Handler here as it is used throughout the code. Also put ""password set"" string into strings.xml instead of hardcoding",java,1,1,1
"@@ -395,6 +395,12 @@ public abstract class AbstractRule extends AbstractPropertySource implements Rul
                 this, node, message, args);
     }
 
+    public void addViolationWithAutoFixerClass(Object data, Node node, String message, Class autoFixerClass) {
+        final RuleContext ruleContext = (RuleContext) data;
+        ruleContext.getLanguageVersion().getLanguageVersionHandler().getRuleViolationFactory()
+                .addViolationWithAutoFixer(ruleContext, this, node, message, autoFixerClass);
+    }
+
     /**
      * Rules are equal if:
      * <ol>",why use raw types?,java,1,1,1
"@@ -40,6 +40,12 @@ public abstract class MethodDescriptorView {
 
   public abstract List<HeaderRequestParamView> headerRequestParams();
 
+  @Nullable
+  public abstract String requestFormatterName();
+
+  @Nullable
+  public abstract String responseFormatterName();
+
   public boolean hasHeaderRequestParams() {
     return headerRequestParams() != null && !headerRequestParams().isEmpty();
   }","These names aren't needed any more, right?",java,1,0,1
"@@ -62,11 +62,6 @@ public class BinPacking {
     private final Function<T, Long> weightFunc;
     private final boolean largestBinFirst;
 
-    public PackingIterable(Iterable<T> iterable, long targetWeight, int lookback,
-                           Function<T, Long> weightFunc) {
-      this(iterable, targetWeight, lookback, weightFunc, false);
-    }
-
     public PackingIterable(Iterable<T> iterable, long targetWeight, int lookback,
                            Function<T, Long> weightFunc, boolean largestBinFirst) {
       Preconditions.checkArgument(lookback > 0,","Please revert this change. Even if this isn't used, the class is public and we don't need to make unnecessary breaking changes.",java,1,1,1
"@@ -113,7 +113,7 @@ public abstract class SyncTargetManager {
   protected abstract CompletableFuture<Optional<EthPeer>> selectBestAvailableSyncTarget();
 
   private CompletableFuture<SyncTarget> waitForPeerAndThenSetSyncTarget() {
-    return waitForNewPeer().handle((r, t) -> r).thenCompose((r) -> selectNewSyncTarget());
+    return waitForNewPeer().thenCompose(__ -> selectNewSyncTarget());
   }
 
   private CompletableFuture<?> waitForNewPeer() {",So this is the main change? the rest are all style adjustments?,java,1,1,1
"@@ -69,6 +69,6 @@ public final class PreconditionsConstantMessage extends BugChecker implements Bu
         }
 
         return buildDescription(tree).setMessage(
-                ""Preconditions.checkX() statement uses a non-constant message"").build();
+                ""Preconditions.checkX() statement uses a non-constant message. Consider using a template string"").build();
     }
 }",`Consider using a template string with '%s'.`,java,1,1,1
"@@ -56,10 +56,10 @@ public class Emailer extends AbstractMailer implements Alerter {
     this.mailSender = props.getString(""mail.sender"", """");
     this.tls = props.getString(""mail.tls"", ""false"");
 
-    final int mailTimeout = props.getInt(""mail.timeout.millis"", 10000);
+    final int mailTimeout = props.getInt(""mail.timeout.millis"", 30000);
     EmailMessage.setTimeout(mailTimeout);
     final int connectionTimeout =
-        props.getInt(""mail.connection.timeout.millis"", 10000);
+        props.getInt(""mail.connection.timeout.millis"", 30000);
     EmailMessage.setConnectionTimeout(connectionTimeout);
 
     EmailMessage.setTotalAttachmentMaxSize(getAttachmentMaxSize());",Does this number matter much? I remember the exception message like `can not connect..`,java,1,1,1
"@@ -36,7 +36,7 @@ public class AzDBTestUtility {
 
     public EmbeddedH2BasicDataSource() {
       super();
-      final String url = ""jdbc:h2:mem:test"";
+      final String url = ""jdbc:h2:mem:test;IGNORECASE=TRUE"";
       setDriverClassName(""org.h2.Driver"");
       setUrl(url);
     }",Does H2 DB not use the DB schema definition files?,java,1,1,1
"@@ -2382,6 +2382,11 @@ CheckedError Parser::DoParse(const char *source, const char **include_paths,
     } else if (IsIdent(""include"") || (opts.proto_mode && IsIdent(""import""))) {
       NEXT();
       if (opts.proto_mode && attribute_ == ""public"") NEXT();
+#ifdef FLATBUFFERS_PLATFORM_NO_FILE_SUPPORT
+      auto name = attribute_;
+      // Early return if platform has no file support
+      return Error(""unable to load include file: "" + name);
+#endif  // FLATBUFFERS_PLATFORM_NO_FILE_SUPPORT
       auto name = flatbuffers::PosixPath(attribute_.c_str());
       EXPECT(kTokenStringConstant);
       // Look for the file in include_paths.",why is this named differently from the define above?,java,1,1,1
"@@ -709,7 +709,7 @@ public final class BlockTreeTermsWriter extends FieldsConsumer {
 
           PendingTerm term = (PendingTerm) ent;
 
-          assert StringHelper.startsWith(term.termBytes, prefix): ""term.term="" + term.termBytes + "" prefix="" + prefix;
+          assert StringHelper.startsWith(term.termBytes, prefix): term + "" prefix="" + prefix;
           BlockTermState state = term.state;
           final int suffix = term.termBytes.length - prefixLength;
           //if (DEBUG2) {",that 'term' class (PendingTerm) actually has a perfectly fine toString method... why not just remove termBytes and let it do its job?,java,1,1,1
"@@ -54,6 +54,8 @@ public class JobTypeManager {
   private final Props globalProperties;
   private final ClusterRouter clusterRouter;
   private JobTypePluginSet pluginSet;
+  // Only used to load keyStore.
+  private Props keyStoreLoadProps = null;
 
   @VisibleForTesting
   public JobTypeManager(final String jobtypePluginDir, final Props globalProperties,",No need to assign null.,java,1,1,1
"@@ -148,6 +148,16 @@ public class ParquetDictionaryRowGroupFilter {
       return ROWS_MIGHT_MATCH;
     }
 
+    @Override
+    public <T> Boolean isNaN(BoundReference<T> ref) {
+      return ROWS_MIGHT_MATCH;
+    }
+
+    @Override
+    public <T> Boolean notNaN(BoundReference<T> ref) {
+      return ROWS_MIGHT_MATCH;
+    }
+
     @Override
     public <T> Boolean lt(BoundReference<T> ref, Literal<T> lit) {
       int id = ref.fieldId();","If there is a NaN value, then it would be in the Parquet dictionary. I think that we can implement this for Parquet.",java,1,1,1
"@@ -124,7 +124,7 @@ public class DataSourceUtils {
 		private MySQLBasicDataSource(String host, int port, String dbName, String user, String password, int numConnections) {
 			super();
 			
-			String url = ""jdbc:mysql://"" + (host + "":"" + port + ""/"" + dbName);
+			String url = ""jdbc:mysql://"" + (host + "":"" + port + ""/"" + dbName+""?useUnicode=yes&characterEncoding=UTF-8"");
 			setDriverClassName(""com.mysql.jdbc.Driver"");
 			setUsername(user);
 			setPassword(password);","Please add a space before and after the +, to be consistent with the rest of the file.",java,1,1,1
"@@ -32,7 +32,6 @@ namespace AutoRest.Extensions.Azure
         public const string AzureResourceExtension = ""x-ms-azure-resource"";
         public const string ODataExtension = ""x-ms-odata"";
         public const string ClientRequestIdExtension = ""x-ms-client-request-id"";
-        public const string ExternalExtension = ""x-ms-external"";
 
         //TODO: Ideally this would be the same extension as the ClientRequestIdExtension and have it specified on the response headers,
         //TODO: But the response headers aren't currently used at all so we put an extension on the operation for now",Nothing else was using this?,java,0,0,1
"@@ -266,6 +266,16 @@ public class FilterManager extends AbstractVerticle {
     return logs;
   }
 
+  public BlockParameter getToBlock(final String filterId) {
+    final LogFilter filter = filterRepository.getFilter(filterId, LogFilter.class).orElse(null);
+    if (filter == null) {
+      return null;
+    } else {
+      filter.resetExpireTime();
+      return filter.getToBlock();
+    }
+  }
+
   public List<LogWithMetadata> logs(final String filterId) {
     final LogFilter filter = filterRepository.getFilter(filterId, LogFilter.class).orElse(null);
     if (filter == null) {",Why do we need to reset the expire time here?,java,1,1,1
"@@ -72,6 +72,12 @@ public abstract class AbstractAzkabanServlet extends HttpServlet {
   private String label;
   private String color;
 
+  /*
+   * The variable switchToPanelPage is in charge of switching on retired schedulePanelDeprecated.vm (old UI)
+   * or the new schedulePanel.vm (new UI). We can configure it in conf for this binary change.
+   */
+  private String switchToPanelPage;
+
   private List<ViewerPlugin> viewerPlugins;
   private List<TriggerPlugin> triggerPlugins;
 ","Rename to ""SchedulePanelPageName"" ? Even better, make it ""enableNewSchedulerUi"" and make it a boolean type?",java,1,1,1
"@@ -89,6 +89,7 @@ public abstract class AbstractHadoopSecurityManager extends HadoopSecurityManage
   protected final ConcurrentMap<String, UserGroupInformation> userUgiMap;
   protected boolean shouldProxy;
   protected boolean securityEnabled;
+  protected final Props props;
   public static final String CHOWN = ""chown"";
   public static final String CHMOD = ""chmod"";
 ","Please remind me: why did we decide to put it here and not in ~~either~~ `KSudoHadoopSecurityManager` (bottom of the hierarchy, would not require any changes to OSS Azkaban) ~~*or* `HadoopSecurityManager` (all the way to the top of the class hierarchy)~~? Why is this in the middle?",java,1,1,1
"@@ -318,7 +318,14 @@ public class ExecutionControllerUtils {
       jobLinkUrl = url.toString();
     } else {
       // If RM job link is invalid or has expired, fetch the job link from JHS or SHS.
-      if (exFlow.getExecutableNode(jobId).getType().equals(SPARK_JOB_TYPE)) {
+      final ExecutableNode node = exFlow.getExecutableNodePath(jobId);
+      if (node == null) {
+        logger.error(
+            ""Invalid job link. Job "" + jobId + "" doesn't exist in "" + exFlow.getExecutionId());
+        return null;
+      }
+
+      if (node.getType().equals(SPARK_JOB_TYPE)) {
         jobLinkUrl =
             azkProps.get(ConfigurationKeys.SPARK_HISTORY_SERVER_JOB_URL).replace
                 (APPLICATION_ID, applicationId);",In which scenario this is a possibility?,java,1,0,1
"@@ -20,15 +20,19 @@ import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.Collections;
+import java.util.HashMap;
 import java.util.List;
 import java.util.Locale;
+import java.util.Map;
 import java.util.Map.Entry;
 import java.util.Optional;
+import java.util.Set;
 import java.util.stream.Collectors;
 
 import org.apache.solr.client.solrj.SolrRequest;
 import org.apache.solr.client.solrj.impl.CloudSolrClient;
 import org.apache.solr.client.solrj.impl.CloudSolrClient.Builder;
+import org.apache.solr.client.solrj.impl.ClusterStateProvider;
 import org.apache.solr.client.solrj.io.SolrClientCache;
 import org.apache.solr.client.solrj.io.Tuple;
 import org.apache.solr.client.solrj.io.comp.ComparatorOrder;","This source file did not adhere to the community code format so I reformatted it. It's bad practice in general, but since my PR was getting dinged for format issues, I chose to fix globally in this file vs. piecemeal.",java,1,1,1
"@@ -73,7 +73,7 @@ public interface RuneLiteConfig extends Config
 	)
 	default boolean enablePlugins()
 	{
-		return true;
+		return false;
 	}
 
 	@ConfigItem(","Not needed, just make hide externals by default in plugin sorter.",java,1,1,1
"@@ -57,7 +57,8 @@ public class BaselineErrorProneExtension {
             ""ArrayEquals"",
             ""MissingOverride"",
             ""UnnecessaryParentheses"",
-            ""PreferJavaTimeOverload"");
+            ""PreferJavaTimeOverload"",
+            ""UnnecessaryLambda"");
 
     private final ListProperty<String> patchChecks;
 ","I recall this creating code that didn't compile, might want to test it on something large and internal (or atlas) first",java,1,1,1
"@@ -117,13 +117,16 @@ public class ImageVersion extends BaseModel {
    * table. DEPRECATED - An image type version which is no longer in use is marked as DEPRECATED
    * TEST - This is to represent a TEST version of the image and once the version is tested it can
    * be marked as NEW.
+   * STABLE - When an image version is marked as ACTIVE, the other ACTIVE version(s) are marked as
+   * STABLE as there can be only 1 ACTIVE version at a time.
    */
   public enum State {
     NEW(""new""),
     ACTIVE(""active""),
     UNSTABLE(""unstable""),
     DEPRECATED(""deprecated""),
-    TEST(""test"");
+    TEST(""test""),
+    STABLE(""stable"");
     private final String stateValue;
 
     private State(final String stateValue) {",Let's see if we can use better name for this.,java,1,1,1
"@@ -24,12 +24,14 @@ import java.util.Collections;
 import java.util.HashMap;
 import java.util.HashSet;
 import java.util.List;
+import java.util.Locale;
 import java.util.Map;
 import java.util.Set;
 import java.util.TreeMap;
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.TimeUnit;
 import java.util.concurrent.atomic.AtomicLong;
+import java.util.Locale;
 
 import org.apache.solr.client.solrj.cloud.SolrCloudManager;
 import org.apache.solr.client.solrj.cloud.autoscaling.ReplicaInfo;",is this being used?,java,1,0,1
"@@ -968,6 +968,16 @@ public abstract class AbstractTraversableTest extends AbstractValueTest {
         assertThat(of(BigDecimal.ZERO, BigDecimal.ONE).max()).isEqualTo(Option.some(BigDecimal.ONE));
     }
 
+    @Test(expected = NullPointerException.class)
+    public void shouldThrowNPEWhenMaxOfNullAndInt() {
+        System.out.println(of(null, 1).max());
+    }
+
+    @Test(expected = NullPointerException.class)
+    public void shouldThrowNPEWhenMaxOfIntAndNull() {
+        System.out.println(of(1, null).max());
+    }
+
     // -- maxBy(Comparator)
 
     @Test(expected = NullPointerException.class)",I think you can get rid of the `System.out.println`,java,1,1,1
"@@ -89,9 +89,11 @@ public enum Kind {
   TS_CONFIG(""ts_config"", LanguageClass.TYPESCRIPT, RuleType.BINARY),
   DART_PROTO_LIBRARY(""dart_proto_library"", LanguageClass.DART, RuleType.LIBRARY),
   DART_LIBRARY(""_dart_library"", LanguageClass.DART, RuleType.LIBRARY),
-  KOTLIN_LIBRARY(""kotlin_library"", LanguageClass.KOTLIN, RuleType.LIBRARY),
-  KOTLIN_BINARY(""kotlin_binary"", LanguageClass.KOTLIN, RuleType.BINARY),
-  KOTLIN_TEST(""kotlin_test"", LanguageClass.KOTLIN, RuleType.TEST),
+  KT_JVM_LIBRARY(""kt_jvm_library"", LanguageClass.KOTLIN, RuleType.LIBRARY),
+  KT_JVM_BINARY(""kt_jvm_binary"", LanguageClass.KOTLIN, RuleType.BINARY),
+  KT_JVM_TEST(""kt_jvm_test"", LanguageClass.KOTLIN, RuleType.TEST),
+  KT_JVM_IMPORT(""kt_jvm_import"", LanguageClass.KOTLIN, RuleType.UNKNOWN),
+  KOTLIN_STDLIB(""kotlin_stdlib"", LanguageClass.KOTLIN, RuleType.UNKNOWN),
 
   // any rule exposing java_common.provider which isn't specifically recognized
   GENERIC_JAVA_PROVIDER(""generic_java"", LanguageClass.JAVA, RuleType.UNKNOWN),",Why not `RuleType.LIBRARY`?,java,1,1,1
"@@ -101,10 +101,11 @@ public final class Configuration {
         PROP_ROOT + PROP_RULE_STRATEGY_NAME);
   }
 
-  public int getSessionTimeoutInSeconds() {
+  public int getSessionTimeoutInSeconds(String microservice) {
     final int defaultValue = 30;
     // do not support MicroService level now
     String p = getStringProperty(""30"",
+        PROP_ROOT + microservice + ""."" + SESSION_TIMEOUT_IN_SECONDS,
         PROP_ROOT + SESSION_TIMEOUT_IN_SECONDS);
     try {
       return Integer.parseInt(p); // can be negative",this annotation can be deleted.,java,1,1,1
"@@ -148,8 +148,8 @@ public class DBOpenHelper extends SQLiteOpenHelper {
 		dataDir = context.getApplicationInfo().dataDir;
 	}
 
-	 protected void loadLibs(Context context) {
-        SQLiteDatabase.loadLibs(context);
+    protected void loadLibs(Context context) {
+        new SqliteLibraryLoader().loadSqlCipher(context);
     }
 
 	@Override",Use `static` call. There's no need to instantiate this util class every time.,java,1,1,1
"@@ -76,7 +76,10 @@ public class FieldStructureParser {
               .get(fieldConfig.fieldPath())
               .withInitialCollectionValue(fieldConfig.entityName(), fieldConfig.value());
     } else if (fieldConfig.hasSimpleInitValue()) {
-      valueConfig = InitValueConfig.createWithValue(stripQuotes(fieldConfig.value()));
+      InitValue initValue = fieldConfig.value();
+      valueConfig =
+          InitValueConfig.createWithValue(
+              InitValue.create(stripQuotes(initValue.getValue()), initValue.getType()));
     } else if (initValueConfigMap.containsKey(fieldConfig.fieldPath())) {
       valueConfig = initValueConfigMap.get(fieldConfig.fieldPath());
     }",would it make sense for InitValue to do the quote stripping?,java,1,1,1
"@@ -79,7 +79,7 @@ public interface CheckedFunction1<T1, R> extends λ<R> {
      * @return a function that applies arguments to the given {@code partialFunction} and returns {@code Some(result)}
      *         if the function is defined for the given arguments, and {@code None} otherwise.
      */
-    static <T1, R> Function1<T1, Option<R>> lift(CheckedFunction1<T1, R> partialFunction) {
+    static <T1, R> Function1<T1, Option<R>> lift(CheckedFunction1<? super T1, R> partialFunction) {
         return t1 -> Try.of(() -> partialFunction.apply(t1)).getOption();
     }
 ","I think we will also need to widen the result type R: `? extends R` for al occurrences (lift, liftTry, recover). Could you also widen the parameters (`? super`for args and `? extends` for return type) for the method `of(...)` of CheckedFunction and Function?",java,1,1,1
"@@ -64,8 +64,6 @@ public class ExtendedBolus implements Interval, DataPointWithLabelInterface {
 
     @DatabaseField
     public int insulinInterfaceID = InsulinInterface.OREF_RAPID_ACTING;
-    @DatabaseField
-    public double dia = Constants.defaultDIA;
 
     @Deprecated
     public ExtendedBolus() {",well changing database fields has lof of sideffects it should be done along with increasing buildnumber and leads to braking backward compatibility,java,1,1,1
"@@ -48,10 +48,15 @@ public class ApexDocRule extends AbstractApexRule {
             booleanProperty(""reportMissingDescription"")
                 .desc(""Report missing @description"").defaultValue(true).build();
 
+    private static final PropertyDescriptor<Boolean> REPORT_MISSING_PROPERTY_DESCRIPTOR =
+            booleanProperty(""reportMissingProperty"")
+                .desc(""Report missing properties"").defaultValue(true).build();
+
     public ApexDocRule() {
         definePropertyDescriptor(REPORT_PRIVATE_DESCRIPTOR);
         definePropertyDescriptor(REPORT_PROTECTED_DESCRIPTOR);
         definePropertyDescriptor(REPORT_MISSING_DESCRIPTION_DESCRIPTOR);
+        definePropertyDescriptor(REPORT_MISSING_PROPERTY_DESCRIPTOR);
 
         addRuleChainVisit(ASTUserClass.class);
         addRuleChainVisit(ASTUserInterface.class);","I'll rename this property to be ""reportProperty"" - to be more aligned with ""reportPrivate"" and ""reportProtected"". I first thought it is similar like ""reportMissingDescription"" - but it is not...",java,1,1,1
"@@ -42,6 +42,9 @@ public class SparkReadOptions {
   // Overrides the table's read.split.open-file-cost
   public static final String FILE_OPEN_COST = ""file-open-cost"";
 
+  // Overrides the table's read.split.by-partition
+  public static final String BY_PARTITION = ""by-partition"";
+
   // Overrides the table's read.split.open-file-cost
   public static final String VECTORIZATION_ENABLED = ""vectorization-enabled"";
 ",Is this useful for a user-facing setting? I don't know when a user would want to set this by hand.,java,1,1,1
"@@ -29,7 +29,6 @@ import org.apache.iceberg.Table;
 import org.apache.iceberg.TableMetadata;
 import org.apache.iceberg.TableOperations;
 import org.apache.iceberg.actions.BaseExpireSnapshotsActionResult;
-import org.apache.iceberg.actions.BaseSparkAction;
 import org.apache.iceberg.actions.ExpireSnapshots;
 import org.apache.iceberg.exceptions.NotFoundException;
 import org.apache.iceberg.exceptions.ValidationException;",Unrelated to this PR? Not a big deal might as well get it in though.,java,0,0,1
"@@ -164,6 +164,7 @@ public class SalesforceSDKManager {
     private boolean browserLoginEnabled;
     private boolean idpLoginFlowEnabled;
     private String idpAppURIScheme;
+    private boolean idpAppLoginFlowActive;
 
     /**
      * PasscodeManager object lock.",Flag to indicate if IDP login flow is active that helps components decide whether to switch user or not.,java,1,1,1
"@@ -112,7 +112,7 @@ public final class OidcIdTokenValidator implements OAuth2TokenValidator<Jwt> {
 		// that it is the same value as the one that was sent in the Authentication Request.
 		// The Client SHOULD check the nonce value for replay attacks.
 		// The precise method for detecting replay attacks is Client specific.
-		// TODO Depends on gh-4442
+		// gh-4442 implemented elsewhere
 
 		if (!invalidClaims.isEmpty()) {
 			return OAuth2TokenValidatorResult.failure(invalidIdToken(invalidClaims));",Let's remove the notes on `nonce`,java,1,1,1
"@@ -32,9 +32,9 @@ public final class LinkedHashSet<T> implements Kind1<LinkedHashSet<?>, T>, Set<T
 
     private static final LinkedHashSet<?> EMPTY = new LinkedHashSet<>(LinkedHashMap.empty());
 
-    private final LinkedHashMap<T, T> map;
+    private final LinkedHashMap<T, Object> map;
 
-    private LinkedHashSet(LinkedHashMap<T, T> map) {
+    private LinkedHashSet(LinkedHashMap<T, Object> map) {
         this.map = map;
     }
 ","would `<T, ?>` also work, or just `<T, Object>`?",java,1,1,1
"@@ -109,7 +109,7 @@ public interface CatalogLoader extends Serializable {
 
     @Override
     public Catalog loadCatalog() {
-      return new HiveCatalog(catalogName, uri, warehouse, clientPoolSize, hadoopConf.get(), properties);
+      return CatalogUtil.loadCatalog(HiveCatalog.class.getName(), catalogName, properties, hadoopConf.get());
     }
 
     @Override",Question: Shall we use a constant in `CatalogUtil` for this? What way should we promote? Static import for the constant may make the line a bit shorter.,java,1,1,1
"@@ -114,6 +114,10 @@ public class HiveIcebergMetaHook implements HiveMetaHook {
       hmsTable.getParameters().put(InputFormatConfig.EXTERNAL_TABLE_PURGE, ""TRUE"");
     }
 
+    // For a table created by Hive DDL to be readable by Impala, we need the Input and OutputFormat set explicitly
+    hmsTable.getSd().setInputFormat(HiveIcebergInputFormat.class.getCanonicalName());
+    hmsTable.getSd().setOutputFormat(HiveIcebergOutputFormat.class.getCanonicalName());
+
     // If the table is not managed by Hive catalog then the location should be set
     if (!Catalogs.hiveCatalog(conf)) {
       Preconditions.checkArgument(hmsTable.getSd() != null && hmsTable.getSd().getLocation() != null,","These are going to be overwritten by `HiveTableOperations` depending on whether Hive is enabled. I think the right fix is to set the property to enable Hive on the table when creating an Iceberg table with the meta hook. @pvary, what do you think?",java,0,1,1
"@@ -36,6 +36,7 @@ public class UserAuthority implements Authority {
     private static final Logger LOG = LoggerFactory.getLogger(UserAuthority.class);
     static final String ATHENZ_PROP_PAM_SERVICE_NAME = ""athenz.auth.user.pam_service_name"";
 
+    final String userDomain = System.getProperty(""athenz.user_domain"", ""user"");
     final String serviceName = System.getProperty(ATHENZ_PROP_PAM_SERVICE_NAME, ""login"");
     private PAM pam = null;
     ",Not sure what is the reason for this? Is there is a reason why you want to configure the domain name? Most likely you need to define your own authority as oppose to changing the default user authority.,java,1,1,1
"@@ -61,11 +61,11 @@ public class TestBodyProcessor {
   Buffer outputBodyBuffer;
 
   private void createProcessor(Class<?> type) {
-    processor = new BodyProcessor(TypeFactory.defaultInstance().constructType(type));
+    processor = new BodyProcessor(TypeFactory.defaultInstance().constructType(type), false);
   }
 
   private void createRawJsonProcessor() {
-    processor = new RawJsonBodyProcessor(TypeFactory.defaultInstance().constructType(String.class));
+    processor = new RawJsonBodyProcessor(TypeFactory.defaultInstance().constructType(String.class), false);
   }
 
   private void createClientRequest() {",We must not change a test case if it is required. And here should equivalent to true,java,1,1,1
"@@ -0,0 +1,10 @@
+package org.hyperledger.besu.crypto;
+
+public class EllipticCurveSignatureFactory {
+
+    private static final EllipticCurveSignature instance = new SECP256K1();
+
+    public static EllipticCurveSignature getInstance() {
+        return instance;
+    }
+}",I'm presuming this is a placeholder for future work to add `secp256r1`. How will the choice of curve be determined?,java,1,1,1
"@@ -148,11 +148,11 @@ public class UiSetupWizardImplementation implements SetupWizard {
     @Override
     public Void presentation(String programName, String programEditor, String applicationHomepage,
             String scriptorName) {
-        final String htmlToShow = ""<body>"" + tr(""This wizard will help you install {0} on your computer"", programName)
-                + "".<br><br>"" + tr(""This program was created by: {0}"", programEditor) + ""<br><br>""
+        final String htmlToShow = ""<body>"" + tr(""Installation Wizard for {0}"", programName)
+                + "".<br><br>"" + tr(""Installation Script by {0}"", programEditor) + ""<br><br>""
                 + tr(""For more information about this program, visit:"")
                 + String.format(""<br><a href=\""%1$s\"">%1$s</a><br><br>"", applicationHomepage)
-                + tr(""This installation program is provided by: {0}"", scriptorName) + ""<br><br>"" + ""<br><br>""
+                + tr(""Installation Script by {0}"", scriptorName) + ""<br><br>"" + ""<br><br>""
                 + tr(""{0} will be installed in: {1}"", programName, applicationUserRoot) + ""<br><br>""
                 + tr(""{0} is not responsible for anything that might happen as a result of using these scripts."",
                         applicationName)",Why uppercase wizard and script?,java,1,1,1
"@@ -200,4 +200,17 @@ public interface ProjectLoader {
       throws ProjectManagerException;
 
   void updateProjectSettings(Project project) throws ProjectManagerException;
+
+  /**
+   * Uploads flow file.
+   */
+  void uploadFlowFile(int projectId, int projectVersion, int flowVersion, File flowFile)
+      throws ProjectManagerException;
+
+  /**
+   * Gets flow file that's uploaded.
+   */
+  File getUploadedFlowFile(int projectId, int projectVersion, int flowVersion, String flowName)
+      throws ProjectManagerException;
+
 }",same here about the argument order.,java,1,0,1
"@@ -464,6 +464,10 @@ public class QpsControllerManagerTest {
     ArchaiusUtils.setProperty(key, value);
   }
 
+  public static void deleteConfig(String key) {
+    ArchaiusUtils.setProperty(key, null);
+  }
+
   private static void setConfigWithDefaultPrefix(boolean isProvider, String key, int value) {
     String configKey = Config.CONSUMER_LIMIT_KEY_PREFIX + key;
     if (isProvider) {",This method never used,java,1,0,1
"@@ -25,6 +25,7 @@ import org.jasig.cas.client.util.CommonUtils;
 
 import org.springframework.beans.factory.InitializingBean;
 import org.springframework.security.cas.ServiceProperties;
+import org.springframework.security.cas.authentication.TriggerCasGatewayException;
 import org.springframework.security.core.AuthenticationException;
 import org.springframework.security.web.AuthenticationEntryPoint;
 import org.springframework.util.Assert;","Among other tangles, this introduces a tangle between between `org.springframework.security.cas.authentication` and `org.springframework.security.cas.web`. In general, authentication package should not rely on web.",java,1,1,1
"@@ -97,6 +97,8 @@ public class SparkCatalog extends BaseCatalog {
     Configuration conf = SparkSession.active().sessionState().newHadoopConf();
     Map<String, String> optionsMap = new TreeMap<>(String.CASE_INSENSITIVE_ORDER);
     optionsMap.putAll(options);
+    optionsMap.put(""app-id"", SparkSession.active().sparkContext().applicationId());
+    optionsMap.put(""user"", SparkSession.active().sparkContext().sparkUser());
     return CatalogUtil.buildIcebergCatalog(name, optionsMap, conf);
   }
 ",Should these keys be defined in `CatalogProperties`?,java,1,1,1
"@@ -156,7 +156,7 @@ public class UiSetupWizardImplementation implements SetupWizard {
                 + tr(""{0} will be installed in: {1}"", programName, applicationUserRoot) + ""<br><br>""
                 + tr(""{0} is not responsible for anything that might happen as a result of using these scripts."",
                         applicationName)
-                + ""<br><br>"" + tr(""Click \""Next\"" to start."") + ""</body>"";
+                + ""<br><br>"" + tr(""Click Next to start."") + ""</body>"";
         return messageSender.runAndWait(message -> setupUi.showHtmlPresentationStep(message, htmlToShow));
     }
 ","Why did you remove the """" here?",java,1,1,1
"@@ -115,7 +115,10 @@ class RemoveSnapshots implements ExpireSnapshots {
         .onlyRetryOn(CommitFailedException.class)
         .run(item -> {
           TableMetadata updated = internalApply();
-          ops.commit(base, updated);
+          // only commit the updated metadata if at least one snapshot was removed
+          if (updated.snapshots().size() != base.snapshots().size()) {
+            ops.commit(base, updated);
+          }
         });
 
     LOG.info(""Committed snapshot changes; cleaning up expired manifests and data files."");",Would it be more precise to check for `if (updated.snapshots().size() < base.snapshots().size())`?,java,1,1,1
"@@ -34,6 +34,8 @@ public class CommonMetrics {
   private final MetricsManager metricsManager;
   private Meter dbConnectionMeter;
   private Meter flowFailMeter;
+  private Meter dispatchFailMeter;
+  private Meter dispatchSuccessMeter;
 
   @Inject
   public CommonMetrics(final MetricsManager metricsManager) {","I think we should have a better way of organizing metrics. Keeping all metrics together in one class seems like putting apples and oranges in one basket. Also, such organization of metrics hints that metrics events can be declared from anywhere else in the code. However, dispatch fail / success should only be controlled by the `ExecutorManager`. Thoughts?",java,1,1,1
"@@ -72,7 +72,7 @@ public class ImageTypeDaoImpl implements ImageTypeDao {
       // insert image type record
       // Passing timestamp from the code base and can be formatted accordingly based on timezone
       final Timestamp currentTimestamp = Timestamp.valueOf(LocalDateTime.now());
-      transOperator.update(INSERT_IMAGE_TYPE, imageType.getName().toLowerCase(),
+      transOperator.update(INSERT_IMAGE_TYPE, imageType.getName(),
           imageType.getDescription(), true, imageType.getDeployable().getName(),
           imageType.getCreatedBy(), currentTimestamp, imageType.getModifiedBy(), currentTimestamp);
       final int imageTypeId = Long.valueOf(transOperator.getLastInsertId()).intValue();","Looks like imageType.getName().toLowerCase() is removed. lowercase is added so that all the image types stored will be in lowercase and the same convention is followed throughout. I think hadoopJava might be causing problem. May be we can keep the original job types name as is, but while processing or passing across different part of the codebase we can use lowercase. Else someone is passing as HadoopJava instead of hadoopJava then then it will not be able to find in the database. So we can follow lowercase lookup and processing to avoid these kind of issues. So while comparing we can do lowercase comparison and we can store in database as is. In that case lowercase removal is fine. I have done changes regarding this and it will be part of the new PR. So no need to change anything here.",java,1,1,0
"@@ -102,12 +102,9 @@ public class LizardmenShamanPlugin extends Plugin
 	@Subscribe
 	public void onChatMessage(ChatMessage event)
 	{
-		if (this.notifyOnSpawn)
+		if (this.notifyOnSpawn && event.getMessage().contains(MESSAGE))
 		{
-			if (event.getMessage().contains(MESSAGE))
-			{
-				notifier.notify(MESSAGE);
-			}
+			notifier.notify(MESSAGE);
 		}
 	}
 ","I think checking messagetype as well may be a bit faster, if you do that before checking the message",java,1,1,1
"@@ -60,13 +60,10 @@ public class MetricsManager {
   }
 
   /**
-   * A {@link Meter} measures the rate of events over time (e.g., “requests per second”). Here we
-   * track 1-minute moving averages.
+   * A {@link Meter} measures the rate of events over time (e.g., “requests per second”).
    */
   public Meter addMeter(final String name) {
-    final Meter curr = this.registry.meter(name);
-    this.registry.register(name + ""-gauge"", (Gauge<Double>) curr::getOneMinuteRate);
-    return curr;
+    return this.registry.meter(name);
   }
 
   /**",Removing duplicated info: 1 minute rate values are already emitted by the meter,java,1,1,1
"@@ -1007,6 +1007,14 @@ public class ParsingFieldUpdateProcessorsTest extends UpdateProcessorTestBase {
     assertParsedDate(""Friday Oct 7 13:14:15 2005"", Date.from(inst20051007131415()), ""parse-date-patterns-default-config"");
   }
 
+  public void testRfc2616() throws Exception {
+    assertParsedDate(""Fri Oct 7 13:14:15 2005"" , Date.from(inst20051007131415()), ""parse-date-patterns-default-config"");
+  }
+
+  public void testRfc2616Leniency() throws Exception {
+    assertParsedDate(""Fri Oct 07 13:14:15 2005"" , Date.from(inst20051007131415()), ""parse-date-patterns-default-config"");
+  }
+
   public void testParseQuotedDate() throws IOException {
     // also using 2 digit day
     assertParsedDate(""'Fri, 14 Oct 2005 13:14:15 GMT'"",","Should be named testAsctime since that's the format of this input you are testing. When I mentioned RFC2616, that is a spec that in turn refers to multiple formats (including asctime). Also, like I pointed out, need to test with 2 spaces left of a single digit day.",java,1,1,1
"@@ -188,6 +188,11 @@ public class LocalServiceRegistryClientImpl implements ServiceRegistryClient {
     return microserviceIdMap.get(microserviceId);
   }
 
+  @Override
+  public Microservice getAggregatedMicroservice(String microserviceId) {
+    return microserviceIdMap.get(microserviceId);
+  }
+
   @Override
   public String registerMicroserviceInstance(MicroserviceInstance instance) {
     Map<String, MicroserviceInstance> instanceMap = microserviceInstanceMap.get(instance.getServiceId());",do not copy code just invoke getMicroservice,java,1,1,1
"@@ -166,8 +166,8 @@ public class TestHiveMetastore {
         .processor(new TSetIpAddressProcessor<>(handler))
         .transportFactory(new TTransportFactory())
         .protocolFactory(new TBinaryProtocol.Factory())
-        .minWorkerThreads(3)
-        .maxWorkerThreads(5);
+        .minWorkerThreads(5)
+        .maxWorkerThreads(15);
 
     return new TThreadPoolServer(args);
   }","I don't think we should change these values for the majority of Hive tests, or at least Hive Metastore tests, because this has helped us track down connection leaks. It sounds like we should change these for HiveRunner tests, where we have less control of the connections. If Hive itself doesn't pool or close connections, then we would need to bump this up. Could you make this configurable so that we can set it for the tests that need it?",java,1,1,1
"@@ -249,7 +249,9 @@ public class ExecutionControllerUtils {
       exFlow.setEndTime(time);
     }
 
-    exFlow.setStatus(Status.FAILED);
+    if (exFlow.getStatus() != Status.POD_FAILED) {
+      exFlow.setStatus(Status.FAILED);
+    }
   }
 
   /**",Perhaps make this check more generic and switch the status to FAILED if the previous status is already a final one ? Something like `if (!isStatusFinised(exFlow.getStatus())`,java,1,1,1
"@@ -62,6 +62,9 @@ public class TableProperties {
   public static final String SPLIT_LOOKBACK = ""read.split.planning-lookback"";
   public static final int SPLIT_LOOKBACK_DEFAULT = 10;
 
+  public static final String SPLIT_MIN_FILE_WEIGHT = ""read.split.min-file-weight"";
+  public static final long SPLIT_MIN_FILE_WEIGHT_DEFAULT = 4 * 1024 * 1024; // 4MB
+
   public static final String OBJECT_STORE_ENABLED = ""write.object-storage.enabled"";
   public static final boolean OBJECT_STORE_ENABLED_DEFAULT = false;
 ","Weight is called ""size"" in `read.split.target-size`, so I think we should make this similar. How about `read.split.min-size`?",java,1,1,1
"@@ -24,8 +24,8 @@ import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Locale;
-import java.util.Map;
 import java.util.Map.Entry;
+import java.util.function.Supplier;
 import java.util.stream.Collectors;
 
 import org.apache.solr.client.solrj.io.comp.ComparatorOrder;","Why the use of the Supplier? Is this a cosmetic change or is there some functionality here that I'm not seeing? I'm not against a cosmetic change but changes to StreamFactory are going to slow down landing this patch quite a bit because it's such an important class for Streaming Expressions. So if it's purely cosmetic and we want to land the other changes faster, let's do this in another ticket.",java,1,1,1
"@@ -93,7 +93,7 @@ public class Docker {
       throw new WebDriverException(""Unable to pull container: "" + name);
     }
 
-    LOG.info(String.format(""Pull of %s:%s complete"", name, tag));
+    LOG.fine(String.format(""Pull of %s:%s complete"", name, tag));
 
     return findImage(new ImageNamePredicate(name, tag))
         .orElseThrow(() -> new DockerException(",Waiting for the pull takes a long time. This message informs the user that at least one of the images being pulled is available. Please leave.,java,1,1,1
"@@ -349,11 +349,7 @@ public interface Future<T> extends Value<T> {
      * @throws NullPointerException if unit is null.
      */
     static Future<Void> run(CheckedRunnable unit) {
-        Objects.requireNonNull(unit, ""unit is null"");
-        return Future.of(DEFAULT_EXECUTOR_SERVICE, () -> {
-            unit.run();
-            return null;
-        });
+        return run(DEFAULT_EXECUTOR_SERVICE, unit);
     }
 
     /**",only deleted code is good code :-),java,1,0,0
"@@ -59,7 +59,7 @@ public class GoImportSectionTransformer implements ImportSectionTransformer {
   private boolean isStandardImport(String importPath) {
     // TODO(pongad): Some packages in standard library have slashes,
     // we might have to special case them.
-    if (importPath.equals(""net/http"")) {
+    if (importPath.equals(""net/http"") || importPath.equals(""net/url"")) {
       return true;
     }
     return !importPath.contains(""/"");","I think I found a better way to detect this. We can probably look for a ""."" in the path, so that we'll catch ""github.com/foo/bar"", but not stdlib.",java,1,1,1
"@@ -0,0 +1,13 @@
+package de.danoeh.antennapod.core.sync;
+
+public interface SynchronizationSharedPreferenceKeys {
+    String SELECTED_SYNC_PROVIDER = ""selected_sync_provider"";
+    String IS_SYNC_PROVIDER_CONNECTED = ""provider_is_connected"";
+    String LAST_SUBSCRIPTION_SYNC_TIMESTAMP = ""last_sync_timestamp"";
+    String LAST_EPISODE_ACTIONS_SYNC_TIMESTAMP = ""last_episode_actions_sync_timestamp"";
+    String QUEUED_FEEDS_ADDED = ""sync_added"";
+    String QUEUED_FEEDS_REMOVED = ""sync_removed"";
+    String QUEUED_EPISODE_ACTIONS = ""sync_queued_episode_actions"";
+    String LAST_SYNC_ATTEMPT_TIMESTAMP = ""last_sync_attempt_timestamp"";
+    String LAST_SYNC_ATTEMPT_SUCCESS = ""last_sync_attempt_success"";
+}","Now that you have dedicated classes for getting/setting the preferences, the constants don't need to be accessed from outside these classes, don't they? They can be moved to the classes and made private, then.",java,1,1,1
"@@ -250,7 +250,8 @@ public class PythonGapicContext extends GapicContext {
 
     // parameter types
     contentBuilder.append(""Args:\n"");
-    for (Field field : this.messages().flattenedFields(method.getInputType())) {
+    for (Field field :
+        removePageTokenFromFields(this.messages().flattenedFields(method.getInputType()), config)) {
       String name = pythonCommon.wrapIfKeywordOrBuiltIn(field.getSimpleName());
       if (config.isPageStreaming()
           && field.equals((config.getPageStreaming().getPageSizeField()))) {",I don't think the call to flattenedFields is necessary here,java,1,1,1
"@@ -25,7 +25,8 @@ namespace Microsoft.Rest.Generator.CSharp.Azure
 
         public AzureCSharpCodeGenerator(Settings settings) : base(settings)
         {
-            _namer = new AzureCSharpCodeNamer();
+
+            _namer = new AzureCSharpCodeNamer(settings);
             IsSingleFileGenerationSupported = true;
             pageClasses = new Dictionary<KeyValuePair<string, string>, string>();
         }",Why an empty line,java,1,0,1
"@@ -56,7 +56,7 @@ public class CloudUtil {
   public static final int DEFAULT_TIMEOUT = 90;
 
   /**
-   * See if coreNodeName has been taken over by another baseUrl and unload core
+   * See if replicaName has been taken over by another baseUrl and unload core
    * + throw exception if it has been.
    */
   public static void checkSharedFSFailoverReplaced(CoreContainer cc, CoreDescriptor desc) {","Update the log on line 80, and the variable name ""cnn"" as well",java,1,1,1
"@@ -153,7 +153,7 @@ public class HomeFragment extends NavigationBaseFragment implements CustomTabAct
         super.onResume();
 
         int productCount = sp.getInt(""productCount"", 0);
-        apiClient.getTotalProductCount()
+        apiClient.getTotalProductCount(getString(R.string.app_name) + "" "" + Utils.getUserAgent(""OTHERS""))
             .subscribeOn(Schedulers.io())
             .observeOn(AndroidSchedulers.mainThread())
             .subscribe(new SingleObserver<Search>() {","We should use a common way to build the header. For instance in openfoodfacts.github.scrachx.openfood.network.OpenFoodAPIService#getProductByBarcodeSingle we use only this info: `client.getProductByBarcodeSingle(product.getCode(), fields, Utils.getUserAgent(Utils.HEADER_USER_AGENT_SEARCH))` I suggest to remove `getString(R.string.app_name) + "" ""` and change Utils.getUserAgent to add a prefix if needed.",java,1,1,0
"@@ -186,6 +186,9 @@ public class TestHiveShell {
     // Tez configuration
     hiveConf.setBoolean(""tez.local.mode"", true);
 
+    // Disable vectorization for HiveIcebergInputFormat
+    hiveConf.setBoolVar(HiveConf.ConfVars.HIVE_VECTORIZATION_ENABLED, false);
+
     return hiveConf;
   }
 }","I think this is fine, but I'm curious: do we plan to add vectorized writes? Or is this not something that we think is important?",java,1,1,1
"@@ -14,4 +14,6 @@ public interface User extends RoleAssignee, Serializable {
 
     public boolean isSuperuser();
 
+    public boolean isDisabled();
+
 }","fyi, it is now possible to add a default implementation of the method and so not have to override in subclasses if they use the default.",java,1,1,1
"@@ -37,9 +37,7 @@ public class MaxScoreCollector extends SimpleCollector {
 
   @Override
   public ScoreMode scoreMode() {
-    // Should be TOP_SCORES but this would wrap the scorer unnecessarily since
-    // this collector is only used in a MultiCollector.
-    return ScoreMode.COMPLETE;
+    return ScoreMode.TOP_SCORES;
   }
 
   @Override",why can we make this change?,java,1,0,1
"@@ -30,7 +30,7 @@ import org.junit.Test;
 public class PacketTest {
 
   private static final String VALID_PONG_PACKET =
-      ""53cec0d27af44bdc0471d34c4eb631f74b502df7b5513a80a054f0d619f0417d6ba4fd4d6fb83994b95c6d0ae8b175b068a6bffc397e2b408e797069b9370ce47b153dd884b60108e686546a775ed5f85e71059a9c5791e266bd949d0dcfba380102f83bcb84b4b57a1a82040182765fa046896547d3b4259aa1a67bd26e7ec58ab4be650c5552ef0360caf9dae489d53b845b872dc8880000000000000003"";
+      ""3b3d56e4fcdcf714d6c29b0d521e9f4ec0dd50c73c0bbb9b44758a0a7e416ff30a3ea99de3e78a5cff82ad0a0b82030f78c6eff5a1b2a030276277b6e9b6ad7c35db1a6d5f83586a203b4537d82edc6b2820849a485e55aa06cfc680dc63c22d0002f3cb84b4b57a1a82040182765fa046896547d3b4259aa1a67bd26e7ec58ab4be650c5552ef0360caf9dae489d53b8460e5e7b603"";
   private static final String INVALID_SIGNATURE_PACKET =
       ""43f91d11b3338b4dbdf16db4f9fa25d7b4e2db81e6fd63f8f6884dfaea851e106f8f692c77169b387bde7c38832cf2d37a9b97b1553d07587ebe251ee21ee36e0ed54fd9218e3feea3bd13ca6982b25c204d5186e7ec5373ea664c91d42467b30102f3cb842f3ee37b82040e82765fa04139782abaccbc8fd290a7fde1ff138943fa9659f7bd67f97c97b09893d1ee8a84607806e108"";
 ","Hmm, why is the whole packet different? I was expecting it to just be the last bytes.",java,1,1,1
"@@ -196,7 +196,6 @@ public abstract class SyncTarget {
                 smartStore.beginTransaction();
                 for (int i = 0; i < records.length(); i++) {
                     JSONObject record = new JSONObject(records.getJSONObject(i).toString());
-                    cleanRecord(record);
                     cleanAndSaveInSmartStore(syncManager.getSmartStore(), soupName, record, false);
                 }
                 smartStore.setTransactionSuccessful();",The next method called (cleanAndSaveInSmartStore) does a cleanRecord,java,1,0,1
"@@ -9,8 +9,8 @@ import java.lang.annotation.Retention;
 import java.lang.annotation.RetentionPolicy;
 import java.lang.annotation.Target;
 
-import net.sourceforge.pmd.lang.ast.AbstractNode;
 import net.sourceforge.pmd.lang.ast.Node;
+import net.sourceforge.pmd.lang.ast.impl.AbstractNode;
 
 /**
  * Filters out some methods from the XPath attributes of a node.","In theory, AbstractNode should be irrelevant in this context - AbstractNode should only help to implement the Node API, but should not add to the API... (so no additional methods). Maybe we don't need the NoAttrScope at all? If a intermediate (abstract) class adds a public method, it is public API... so why not expose it as XPath attribute?",java,1,1,1
"@@ -14,4 +14,6 @@
  */
 package com.google.api.codegen.viewmodel;
 
-public interface ApiMethodView {}
+public interface ApiMethodView {
+  String name();
+}",we use the `getX()` naming pattern in general - view models are the exception.,java,1,1,1
"@@ -31,7 +31,7 @@ import org.apache.tuweni.bytes.MutableBytes;
  *
  * <h3>Message structure</h3>
  *
- * The following describes the message structure:
+ * <p>The following describes the message structure:
  *
  * <pre>
  *   authRecipient -&gt; E(remote-pubk,","Seems unrelated, but ok.",java,1,0,1
"@@ -56,6 +56,8 @@ public class TestNamespaceSQL extends SparkCatalogTestBase {
 
   @Test
   public void testCreateNamespace() {
+    // Nessie namespaces are explicit and do not need to be explicitly managed
+    Assume.assumeFalse(catalogName.endsWith(""testnessie""));
     Assert.assertFalse(""Namespace should not already exist"", validationNamespaceCatalog.namespaceExists(NS));
 
     sql(""CREATE NAMESPACE %s"", fullNamespace);",The concept of a namespace is implicit in Nessie and are therefore not managed through the normal `SupportsNamespaces` interface. We skip tests of this interface when the catalog is a `NessieCatalog`.,java,1,1,1
"@@ -32,10 +32,10 @@ import org.openqa.selenium.remote.tracing.HttpTracing;
 import org.openqa.selenium.remote.tracing.Tracer;
 
 import java.net.URL;
+import java.util.Objects;
 import java.util.UUID;
 import java.util.logging.Logger;
 
-import static org.openqa.selenium.net.Urls.fromUri;
 import static org.openqa.selenium.remote.http.Contents.asJson;
 import static org.openqa.selenium.remote.http.HttpMethod.DELETE;
 import static org.openqa.selenium.remote.http.HttpMethod.GET;",We can get rid of this import then.,java,1,1,1
"@@ -69,7 +69,8 @@ public class Table {
 
   protected static int __offset(int vtable_offset, int offset, ByteBuffer bb) {
     int vtable = bb.array().length - offset;
-    return bb.getShort(vtable + vtable_offset - bb.getInt(vtable)) + vtable;
+    return bb.getShort(vtable + vtable_offset - bb.getShort(vtable)) != 0  ?
+      bb.getShort(vtable + vtable_offset - bb.getShort(vtable)) + vtable : 0;
   }
 
   /**",Should `bb.array().length` not be `bb.limit()` to be totally correct? Just in case the backing array isn't fully used?,java,1,1,1
"@@ -349,9 +349,13 @@ public class Camera2 extends android.support.v4.app.Fragment {
                 		Camera.Parameters parameters = preview.mCamera.getParameters();
                 		switch (HDR_STATE){
                     			case HDR_OFF:
-                        			HDR_STATE = HDR_ON;
-                        			camera_hdr.setImageResource(R.drawable.ic_hdr_on_white_24dp);
-                        			parameters.setSceneMode(SCENE_MODE_HDR);
+                        			if (preview.getSupportSceneModes().contains(SCENE_MODE_HDR)) {
+                                        HDR_STATE = HDR_ON;
+                                        camera_hdr.setImageResource(R.drawable.ic_hdr_on_white_24dp);
+                                        parameters.setSceneMode(SCENE_MODE_HDR);
+                                    }else {
+                                        Toast.makeText(ctx, R.string.hdr_unsupported_error,Toast.LENGTH_SHORT).show();
+                                    }
                         			break;
                     			case HDR_ON:
                         			HDR_STATE = HDR_OFF;",Properly intend the code pls.,java,1,0,1
"@@ -71,9 +71,9 @@ public class IDPRequestHandler {
         this.spConfig = spConfig;
         this.userAccount = userAccount;
         basicValidation();
-        loginUrl = spConfig.getLoginUrl();
+        loginUrl = userAccount.getLoginServer();
         if (TextUtils.isEmpty(loginUrl)) {
-            loginUrl = userAccount.getLoginServer();
+            loginUrl = spConfig.getLoginUrl();
         }
         buildRestClient();
     }",This one fixes a corner case bug when you swizzle out to the IDP and then decide to change login hosts.,java,1,1,1
"@@ -143,4 +143,8 @@ public class EVM {
       return operation;
     }
   }
+
+  public OperationRegistry getOperations() {
+    return operations;
+  }
 }",Exposed so it can be spied upon.,java,1,1,1
"@@ -275,10 +275,15 @@ public class HiveTableOperations extends BaseMetastoreTableOperations {
       throw new AlreadyExistsException(""Table already exists: %s.%s"", database, tableName);
 
     } catch (TException | UnknownHostException e) {
-      if (e.getMessage() != null && e.getMessage().contains(""Table/View 'HIVE_LOCKS' does not exist"")) {
-        throw new RuntimeException(""Failed to acquire locks from metastore because 'HIVE_LOCKS' doesn't "" +
-            ""exist, this probably happened when using embedded metastore or doesn't create a "" +
-            ""transactional meta table. To fix this, use an alternative metastore"", e);
+      if (e.getMessage() != null) {
+        if (e.getMessage().contains(""Table/View 'HIVE_LOCKS' does not exist"")) {
+          throw new RuntimeException(""Failed to acquire locks from metastore because 'HIVE_LOCKS' doesn't "" +
+              ""exist, this probably happened when using embedded metastore or doesn't create a "" +
+              ""transactional meta table. To fix this, use an alternative metastore"", e);
+        } else if (e.getMessage().contains(""java.net.SocketTimeoutException: Read timed out"")) {
+          commitStatus = CommitStatus.UNKNOWN;
+          throw new CommitStateUnknownException(e);
+        }
       }
 
       throw new RuntimeException(String.format(""Metastore operation failed for %s.%s"", database, tableName), e);","Could we just check for the `cause` field instead of the message string? Or we are in a same situation as with the MetaExceptions, where there is only a string available? Thanks, Peter",java,1,1,1
"@@ -36,7 +36,7 @@ import io.prometheus.client.exporter.HTTPServer;
 
 @Component
 public class MetricsPublisher implements ApplicationListener<ApplicationEvent> {
-  private static final Logger LOGGER = LoggerFactory.getLogger(MetricsPublisher.class);
+  private static final Logger logger = LoggerFactory.getLogger(MetricsPublisher.class);
 
   private static final String METRICS_PROMETHEUS_PORT = ""servicecomb.metrics.prometheus.port"";
 ","why changed to logger? for static final varibles, use upper case, see this code below(METRICS_PROMETHEUS_PORT).",java,1,1,1
"@@ -145,9 +145,9 @@ public final class Node<V> {
       for (Map.Entry<Long, Long> entry : idToParent.entrySet()) {
         Node<V> node = idToNode.get(entry.getKey());
         Node<V> parent = idToNode.get(entry.getValue());
-        if (parent == null && rootNode == null) { // handle headless trace
-          rootNode = node;
-        } else if (parent == null) { // attribute missing parents to root
+        if (parent == null) { // handle headless trace
+          if (rootNode == null)
+            rootNode = new Node<>();
           rootNode.addChild(node);
         } else {
           parent.addChild(node);","rootNode = Node.MISSING_ROOT ^^ something like this makes the code more obvious, plus you can search references for Node.MISSING_ROOT, where you can't search references for null",java,1,1,1
"@@ -38,6 +38,7 @@ public class PrettyPrinterConfiguration {
     private String indent = ""    "";
     private String endOfLineCharacter = EOL;
     private Function<PrettyPrinterConfiguration, PrettyPrintVisitor> visitorFactory = PrettyPrintVisitor::new;
+    private int maxEnumConstantsToAlignHorizontally = 5;
 
     public String getIndent() {
         return indent;",We could add a public static constant named `DEFAULT_MAX_ENUM_CONSTANTS_TO_ALIGN_HORIZONTALLY-,java,1,1,1
"@@ -154,6 +154,17 @@ public final class BaselineErrorProne implements Plugin<Project> {
                                 errorProneOptions.check(""PreferSafeLoggingPreconditions"", CheckSeverity.OFF);
                                 errorProneOptions.check(""PreconditionsConstantMessage"", CheckSeverity.OFF);
                             }));
+
+            project.getTasks().withType(JavaCompile.class).configureEach(javaCompile -> {
+                ((ExtensionAware) javaCompile.getOptions())
+                        .getExtensions()
+                        .configure(ErrorProneOptions.class, errorProneOptions -> {
+                            // Relax some checks for test code
+                            if (errorProneOptions.isCompilingTestOnlyCode()) {
+                                errorProneOptions.check(""UnnecessaryLambda"", CheckSeverity.OFF);
+                            }
+                        });
+            });
         });
 
         // In case of java 8 we need to add errorprone javac compiler to bootstrap classpath of tasks that perform","is this intentionally only disabled for people that use `java-gradle-plugin`? It feels a little odd to disable it in such a specific case. If we think this UnnecessaryLambda is genuinely not great signal, why not just turn it off for all test code?",java,1,1,1
"@@ -370,7 +370,7 @@ public class TestIcebergInputFormats {
     testInputFormat.create(builder.conf()).validate(expectedRecords);
   }
 
-  private abstract static class TestInputFormat<T> {
+  public abstract static class TestInputFormat<T> {
 
     private final List<IcebergSplit> splits;
     private final List<T> records;",Why was this changed to `public`?,java,1,1,1
"@@ -44,12 +44,10 @@ import org.tikv.kvproto.Metapb.Store;
 public class Snapshot {
   private final TiTimestamp timestamp;
   private final TiSession session;
-  private final TiConfiguration conf;
 
   public Snapshot(TiTimestamp timestamp, TiSession session) {
     this.timestamp = timestamp;
     this.session = session;
-    this.conf = session.getConf();
   }
 
   public TiSession getSession() {",why delete this conf?,java,1,0,1
"@@ -0,0 +1,11 @@
+package com.fsck.k9;
+
+
+public class SputnikTest {
+    public   void sputnikTest(){
+        int x= 2+1;
+
+
+        return;
+    }
+}",[Checkstyle] ERROR: '{' is not preceded with whitespace.,java,1,1,1
"@@ -39,7 +39,7 @@ public class Java14PreviewValidator extends Java14Validator {
         {
             // first preview within Java 14 - https://openjdk.java.net/jeps/359
             remove(noRecordDeclaration);
-            add(recordAsTypeIdentifierNotAllowed);
+            add(recordAsClassAndInterfaceIdentifierNotAllowed);
             add(recordDeclarationValidator);
         }
 ",Please revert this back to `TypeIdentifier` - `record` is not permitted e.g. as an enum`s identifier either.,java,1,1,1
"@@ -40,6 +40,7 @@ public class WebSocketConfiguration {
   private String authenticationCredentialsFile;
   private List<String> hostsAllowlist = Arrays.asList(""localhost"", ""127.0.0.1"");
   private File authenticationPublicKeyFile;
+  private String authenticationAlgorithm = ""RS256"";
   private long timeoutSec;
   private int maxActiveConnections;
 ",again can we use the JwtAlgorithm type for this,java,1,1,1
"@@ -140,6 +140,19 @@ public class TestTableUpdatePartitionSpec extends TableTestBase {
 
     Assert.assertEquals(""should match evolved spec"", evolvedSpec, table.spec());
     Assert.assertEquals(1002, table.spec().lastAssignedFieldId());
+
+    table.updateSpec()
+        .renameField(""id_bucket_8"", ""id_partition"")
+        .commit();
+
+    evolvedSpec = PartitionSpec.builderFor(table.schema())
+        .withSpecId(3)
+        .bucket(""data"", 16, ""data_bucket"")
+        .bucket(""id"", 8, ""id_partition"")
+        .truncate(""id"", 4, ""id_trunc_4"")
+        .build();
+    Assert.assertEquals(""should match evolved spec"", evolvedSpec, table.spec());
+    Assert.assertEquals(1002, table.spec().lastAssignedFieldId());
   }
 
   @Test",This seems like it should be its own test case. Could you move it?,java,1,1,1
"@@ -361,7 +361,9 @@ public class FunctionQParser extends QParser {
         ((FunctionQParser)subParser).setParseMultipleSources(true);
       }
       Query subQuery = subParser.getQuery();
-      if (subQuery instanceof FunctionQuery) {
+      if (subQuery == null) {
+        valueSource = new DoubleConstValueSource(0.0f);
+      } else if (subQuery instanceof FunctionQuery) {
         valueSource = ((FunctionQuery) subQuery).getValueSource();
       } else {
         valueSource = new QueryValueSource(subQuery, 0.0f);",Why a Double?,java,1,0,1
"@@ -311,4 +311,13 @@ public class Constants {
     public static final String START_TIME = ""startTime"";
     public static final String TRIGGER_INSTANCE_ID = ""triggerInstanceId"";
   }
+
+
+  public static class DefaultValue {
+
+    public static final int PROJECT_DIR_CLEANUP_START_THRESHOLD = 90;
+    public static final int PROJECT_DIR_CLEANUP_STOP_THRESHOLD = 60;
+    //128G
+    public static final long PROJECT_DIR_MAX_SIZE = 12800;
+  }
 }",Is it in MB? Should it be 128_000 then?,java,1,1,1
"@@ -142,12 +142,9 @@ namespace AutoRest.Core.Model
         /// <returns>true if the specified object is functionally equal to this object; otherwise, false.</returns>
         public virtual bool StructurallyEquals(IModelType other)
         {
-            if (ReferenceEquals(other, null))
-            {
-                return false;
-            }
-
-            return GetType() == other.GetType() && Name.Equals(other.Name);
+            var ta = JsonConvert.SerializeObject(this);
+            var tb = JsonConvert.SerializeObject(other);
+            return ta == tb;
         }
 
         /// <summary>","Ouch! Some considerations: - this uses the default serialization rules where circular references will throw an exception. We overcome this in the `CodeModel` stuff by generating `$id` and `$ref` fields to allow multiple references to the same object to resolve correctly. - even if you used the serializer settings, two structurally identical objects may not be literally identical, if dictionaries are involved, and the references aren't generated in exactly the same order (since, the first reference shows the entire object, and the second will get a `$ref` to the `$id` of the first.)",java,1,1,0
"@@ -91,11 +91,7 @@ class MetricsHttpService implements MetricsService {
     router.route(""/"").method(HttpMethod.GET).handler(this::handleEmptyRequest);
 
     // Endpoint for Prometheus metrics monitoring.
-    router
-        .route(""/metrics"")
-        .method(HttpMethod.GET)
-        .produces(TextFormat.CONTENT_TYPE_004)
-        .handler(this::metricsRequest);
+    router.route(""/metrics"").method(HttpMethod.GET).handler(this::metricsRequest);
 
     final CompletableFuture<?> resultFuture = new CompletableFuture<>();
     httpServer","Maybe just check for `""text/plain""` instead of completely dropping Prometheus' very specific version?",java,1,1,1
"@@ -952,5 +952,19 @@ public abstract class TestExpireSnapshotsAction extends SparkTestBase {
 
     checkExpirationResults(1, 1, 1, result);
   }
+
+  @Test
+  public void testExpireOnEmptyTable() {
+
+    Set<String> deletedFiles = Sets.newHashSet();
+
+    // table has no data, testing ExpireSnapshots should not fail with no snapshot
+    ExpireSnapshotsActionResult result = Actions.forTable(table).expireSnapshots()
+            .expireOlderThan(System.currentTimeMillis())
+            .deleteWith(deletedFiles::add)
+            .execute();
+
+    checkExpirationResults(0, 0, 0, result);
+  }
 }
 ",nit: let's remove this extra empty line at the beginning,java,1,1,1
"@@ -122,6 +122,8 @@ public class TestSetChainParams implements JsonRpcMethod {
     maybeMoveToNumber(params, ""istanbulForkBlock"", config, ""istanbulBlock"");
     maybeMoveToNumber(params, ""muirGlacierForkBlock"", config, ""muirGlacierBlock"");
     maybeMoveToNumber(params, ""berlinForkBlock"", config, ""berlinBlock"");
+    maybeMoveToNumber(params, ""londonForkBlock"", config, ""londonBlock"");
+    maybeMoveToNumber(params, ""muirGlacierForkBlock"", config, ""muirGlacierBlock"");
     maybeMoveToNumber(params, ""chainID"", config, ""chainId"", 1);
 
     maybeMove(genesis, ""author"", chainParamsJson, ""coinbase"");",this needs to be arrowGlacier.,java,1,1,1
"@@ -28,8 +28,7 @@ public class InstrumentedHttpClients {
                                            HttpClientMetricNameStrategy metricNameStrategy) {
         return HttpClientBuilder.create()
                 .setRequestExecutor(new InstrumentedHttpRequestExecutor(metricRegistry, metricNameStrategy))
-                .setConnectionManager(new InstrumentedHttpClientConnectionManager(metricRegistry));
+                .setConnectionManager(InstrumentedHttpClientConnectionManager.builder(metricRegistry).build());
     }
 
-
 }","This change doesn't seem to be very useful, at the end we invoke the same constructor anyway...",java,1,1,1
"@@ -47,6 +47,7 @@ public class SnapshotSummary {
   public static final String PUBLISHED_WAP_ID_PROP = ""published-wap-id"";
   public static final String SOURCE_SNAPSHOT_ID_PROP = ""source-snapshot-id"";
   public static final String REPLACE_PARTITIONS_PROP = ""replace-partitions"";
+  public static final String EXTRA_METADATA_PREFIX = ""extra-metadata."";
 
   private SnapshotSummary() {
   }",happy to change if a different prefix string would be more suitable,java,1,1,1
"@@ -1341,7 +1341,7 @@ public class CharSeqTest {
 
     @Test
     public void shouldStartsNilOfNilWithOffsetCalculate() {
-        assertThat(empty().startsWith(empty(), 1)).isFalse();
+        assertThat(empty().startsWith(empty(), 1)).isTrue();
     }
 
     @Test","I think this test was wrong before, other `seq`s have the value `true` here",java,1,1,1
"@@ -74,12 +74,12 @@ public class BeanMembersShouldSerializeRule extends AbstractJavaRule {
 
         Map<VariableNameDeclaration, List<NameOccurrence>> vars = node.getScope()
                 .getDeclarations(VariableNameDeclaration.class);
-        for (VariableNameDeclaration decl : vars.keySet()) {
-            AccessNode accessNodeParent = decl.getAccessNodeParent();
-            if (vars.get(decl).isEmpty() || accessNodeParent.isTransient() || accessNodeParent.isStatic()) {
+        for (Map.Entry<VariableNameDeclaration, List<NameOccurrence>> entry : vars.entrySet()) {
+            AccessNode accessNodeParent = entry.getKey().getAccessNodeParent();
+            if (entry.getValue().isEmpty() || accessNodeParent.isTransient() || accessNodeParent.isStatic()) {
                 continue;
             }
-            String varName = trimIfPrefix(decl.getImage());
+            String varName = trimIfPrefix(entry.getKey().getImage());
             varName = varName.substring(0, 1).toUpperCase() + varName.substring(1, varName.length());
             boolean hasGetMethod = Arrays.binarySearch(methNameArray, ""get"" + varName) >= 0
                     || Arrays.binarySearch(methNameArray, ""is"" + varName) >= 0;",I'd add a `VariableNameDeclaration decl = entry.getKey();` here for readability,java,1,1,1
"@@ -88,7 +88,6 @@ public class LoginActivity extends AccountAuthenticatorActivity implements OAuth
 
 		// Setup the WebView.
 		WebView webView = (WebView) findViewById(salesforceR.idLoginWebView());
-		webView.getSettings().setSavePassword(false);
 		EventsObservable.get().notifyEvent(EventType.AuthWebViewCreateComplete, webView);
 		webviewHelper = getOAuthWebviewHelper(this, loginOptions, webView, savedInstanceState);
 		","The ability to save passwords in the `WebView` has been taken away, so this method does nothing anymore.",java,1,1,1
"@@ -60,7 +60,7 @@ public class PhpSurfaceNamer extends SurfaceNamer {
 
   @Override
   public String getClientConfigPath(Interface service) {
-    return ""./resources/""
+    return ""/resources/""
         + Name.upperCamel(service.getSimpleName()).join(""client_config"").toLowerUnderscore()
         + "".json"";
   }",I would prefer this to not have the leading slash so that it doesn't imply an absolute path.,java,1,1,1
"@@ -69,8 +69,14 @@ public class LinkedHashMapTest extends AbstractMapTest {
 
     @Test
     public void shouldKeepOrder() {
-        CharSeq actual = LinkedHashMap.<Integer, Character> empty().put(3, 'a').put(2, 'b').put(1, 'c').foldLeft(CharSeq.empty(), (s, t) -> s.append(t._2));
-        assertThat(actual).isEqualTo(CharSeq.of(""abc""));
+        List<Character> actual = LinkedHashMap.<Integer, Character> empty().put(3, 'a').put(2, 'b').put(1, 'c').foldLeft(List.empty(), (s, t) -> s.append(t._2));
+        Assertions.assertThat(actual).isEqualTo(List.of('a', 'b', 'c'));
+    }
+
+    @Test
+    public void shouldKeepValuesOrder() {
+        List<Character> actual = LinkedHashMap.<Integer, Character> empty().put(3, 'a').put(2, 'b').put(1, 'c').values().foldLeft(List.empty(), List::append);
+        Assertions.assertThat(actual).isEqualTo(List.of('a', 'b', 'c'));
     }
 
     // -- static narrow","It was a big mistake to override `assers*` methods. They don't check ordering of iterables. It is sufficient for `Map`, but very dangerous for other cases.",java,1,1,1
"@@ -29,8 +29,11 @@ import org.apache.solr.common.params.CommonParams;
 import org.apache.solr.common.params.ModifiableSolrParams;
 import org.apache.solr.common.util.NamedList;
 import org.apache.solr.SolrTestCaseJ4.SuppressPointFields;
+import org.junit.Assert;
 import org.junit.Test;
 
+import static org.hamcrest.CoreMatchers.containsString;
+
 /**
  * TODO? perhaps use:
  *  http://docs.codehaus.org/display/JETTY/ServletTester",I think we don't need this import. All test cases extend `Assert`,java,1,1,1
"@@ -114,7 +114,7 @@ public class CorePushPull {
      * @param newMetadataSuffix suffix of the new core.metadata file to be created as part of this push
      */
     public BlobCoreMetadata pushToBlobStore(String currentMetadataSuffix, String newMetadataSuffix) throws Exception {
-      long startTimeMs = System.nanoTime();
+      long startTimeMs = System.nanoTime() / 1000000;
       SolrCore solrCore = container.getCore(pushPullData.getCoreName());
       if (solrCore == null) {
         throw new Exception(""Can't find core "" + pushPullData.getCoreName());",I'd consider making System.nanoTime() / 1000000 a util method in BlobStoreUtils,java,1,1,1
"@@ -23,12 +23,18 @@ import com.google.api.codegen.discovery.Schema.Format;
 import com.google.api.codegen.discovery.Schema.Type;
 import com.google.api.codegen.transformer.ImportTypeTable;
 import com.google.api.codegen.util.Name;
+import com.google.api.codegen.util.SymbolTable;
 import com.google.api.codegen.util.TypeName;
 import com.google.api.tools.framework.model.Oneof;
 import com.google.api.tools.framework.model.TypeRef.Cardinality;
 import com.google.common.base.Preconditions;
+import com.google.common.base.Strings;
 import com.google.common.collect.ImmutableList;
+import java.util.AbstractMap;
+import java.util.Comparator;
 import java.util.List;
+import java.util.Map;
+import java.util.TreeMap;
 import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 import javax.annotation.Nullable;",Shouldn't this be unique per-package (namespace)?,java,1,1,1
"@@ -85,7 +85,15 @@ final public class Automata {
     a.finishState();
     return a;
   }
-  
+
+  /**
+   * Returns a new (deterministic) automaton that accepts all binary terms except
+   * the empty string.
+   */
+  public static Automaton makeAnyBinaryExceptEmpty() {
+    return makeCharRange(0, 255);
+  }
+
   /**
    * Returns a new (deterministic) automaton that accepts any single codepoint.
    */",I don't think this is right since this only accepts strings of length 1.,java,1,1,1
"@@ -35,6 +35,7 @@ import org.apache.lucene.util.fst.IntsRefFSTEnum;
 
 import static org.apache.lucene.analysis.ja.dict.BinaryDictionary.ResourceScheme;
 
+//nocommit
 /**
  * Tests of TokenInfoDictionary build tools; run using ant test-tools
  */","""test-tools"" shouldn't be a task. I don't know what it was doing but it should be a regular test, perhaps grouped under a test group (and enabled by a property).",java,1,1,1
"@@ -67,7 +67,6 @@ import java.util.HashMap;
 import java.util.HashSet;
 import java.util.List;
 import java.util.Map;
-import java.util.Optional;
 import java.util.Set;
 import java.util.stream.Collectors;
 ",There is no need to change this file since it is a test. Please revert this change.,java,1,1,1
"@@ -263,6 +263,7 @@ public abstract class AbstractServiceRegistry implements ServiceRegistry {
 
   @Override
   // TODO: this is for 3rd party invocation, and a better way can be provided
+  // TODO:  microserviceManager.getVersionsByName() can not be used, will delete this in SCB-1949
   public void registerMicroserviceMapping(String microserviceName, String version,
       List<MicroserviceInstance> instances, Class<?> schemaIntfCls) {
     MicroserviceNameParser parser = new MicroserviceNameParser(microservice.getAppId(), microserviceName);",3rd party is a good mechanism must not delete it.,java,1,1,1
"@@ -25,7 +25,6 @@ import com.google.common.collect.ImmutableList;
 import com.google.common.collect.ImmutableSet;
 import com.google.common.collect.Range;
 import com.google.protobuf.ByteString;
-import com.pingcap.tikv.codec.KeyUtils;
 import com.pingcap.tikv.expression.ColumnRef;
 import com.pingcap.tikv.expression.Constant;
 import com.pingcap.tikv.expression.Expression;",can we check unsued import in checkstyle?,java,1,1,1
"@@ -19,7 +19,8 @@ package org.apache.lucene.search;
 
 import org.apache.lucene.util.PriorityQueue;
 
-final class HitQueue extends PriorityQueue<ScoreDoc> {
+/** Expert: Priority queue containing hit docs */
+public final class HitQueue extends PriorityQueue<ScoreDoc> {
 
   /**
    * Creates a new instance with <code>size</code> elements. If",This is used in o.a.l.sandbox.search.LargeNumHitsTopDocsCollector.,java,1,0,1
"@@ -76,8 +76,9 @@ public class Actions {
    * Note that the modifier key is <b>never</b> released implicitly - either
    * <i>keyUp(theKey)</i> or <i>sendKeys(Keys.NULL)</i>
    * must be called to release the modifier.
-   * @param theKey Either {@link Keys#SHIFT}, {@link Keys#ALT} or {@link Keys#CONTROL}. If the
-   * provided key is none of those, {@link IllegalArgumentException} is thrown.
+   * @param theKey Either {@link Keys#SHIFT}, {@link Keys#ALT}, {@link Keys#CONTROL}
+   * or {@link Keys#COMMAND}. If the provided key is none of those, 
+   * {@link IllegalArgumentException} is thrown.
    * @return A self reference.
    */
   public Actions keyDown(Keys theKey) {",Keys.COMMAND seems to be an alias to Keys.META. That isn't mentioned?,java,1,1,1
"@@ -52,7 +52,7 @@ public class ValidationServiceClient {
       template.postForObject(urlPrefix + ""/validate"", model, ValidationModel.class);
       TestMgr.check(false, true);
     } catch (InvocationException e) {
-      TestMgr.check(e.getErrorData().toString().contains(""age""), true);
+      TestMgr.check(e.getErrorData().toString().contains(""propertyPath=errorCode.request.age""), true);
     }
 
     try {",It's better to add error code check.,java,1,1,1
"@@ -104,6 +104,14 @@ public final class BoostQuery extends Query {
     return super.rewrite(reader);
   }
 
+  @Override
+  public void visit(QueryVisitor visitor) {
+    QueryVisitor v = visitor.getSubVisitor(BooleanClause.Occur.MUST, this);
+    if (v != null) {
+      query.visit(v);
+    }
+  }
+
   @Override
   public String toString(String field) {
     StringBuilder builder = new StringBuilder();",should you rather check for empty visitor here now? I guess we can assume that getSubVisitor never returns null?,java,1,1,1
"@@ -298,6 +298,9 @@ class RustGenerator : public BaseGenerator {
 
     assert(!cur_name_space_);
 
+    // Generate global namespace imports.
+    GenNamespaceImports();
+
     // Generate all code in their namespaces, once, because Rust does not
     // permit re-opening modules.
     //","Please describe why we do this twice, for future maintainers.",java,1,1,1
"@@ -134,12 +134,16 @@ public class LinguisticNamingRule extends AbstractJavaRule {
         }
     }
 
+    private boolean isBooleanType(String typeImage) {
+        return ""boolean"".equalsIgnoreCase(typeImage) || ""AtomicBoolean"".equals(typeImage);
+    }
+
     private void checkBooleanMethods(ASTMethodDeclaration node, Object data, String nameOfMethod) {
         ASTResultType resultType = node.getResultType();
         ASTType t = node.getResultType().getFirstChildOfType(ASTType.class);
         if (!resultType.isVoid() && t != null) {
             for (String prefix : getProperty(BOOLEAN_METHOD_PREFIXES_PROPERTY)) {
-                if (hasPrefix(nameOfMethod, prefix) && !""boolean"".equalsIgnoreCase(t.getTypeImage())) {
+                if (hasPrefix(nameOfMethod, prefix) && !isBooleanType(t.getTypeImage())) {
                     addViolationWithMessage(data, node, ""Linguistics Antipattern - The method ''{0}'' indicates linguistically it returns a boolean, but it returns ''{1}''"",
                             new Object[] { nameOfMethod, t.getTypeImage() });
                 }",we should probably use typeresolution here just in case...,java,1,1,1
"@@ -9,14 +9,10 @@ public class ASTDeclaration extends AbstractJspNode {
 
     private String name;
 
-    public ASTDeclaration(int id) {
+    ASTDeclaration(int id) {
         super(id);
     }
 
-    public ASTDeclaration(JspParser p, int id) {
-        super(p, id);
-    }
-
     /**
      * @return Returns the name.
      */",`setName()` can be package-private as well,java,1,0,1
"@@ -295,7 +295,7 @@ public class SmartStoreReactBridge extends ReactContextBaseJavaModule {
 			final IndexSpec[] indexSpecs = IndexSpec.fromJSON(indexesJson);
 
             // Get soup spec if available.
-            final ReadableMap soupSpecObj = args.getMap(SOUP_SPEC);
+            final ReadableMap soupSpecObj = (args.hasKey(SOUP_SPEC) ? args.getMap(SOUP_SPEC) : null);
             if (soupSpecObj != null) {
 
                 // Get soup name.",getMap throws an exception if key doesn't exist,java,1,0,1
"@@ -210,7 +210,7 @@ public class ExportWriter implements SolrCore.RawWriter, Closeable {
     // That causes the totalHits and export entries in the context to _not_ get set.
     // The only time that really matters is when we search against an _empty_ set. That's too obscure
     // a condition to handle as part of this patch, if someone wants to pursue it it can be reproduced with:
-    // ant test  -Dtestcase=StreamingTest -Dtests.method=testAllValidExportTypes -Dtests.seed=10F13879D0D1D6AD -Dtests.slow=true -Dtests.locale=es-PA -Dtests.timezone=America/Bahia_Banderas -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1
+    // gradlew test  --tests *testAllValidExportTypes* -Ptests.seed=10F13879D0D1D6AD -Ptests.slow=true -Ptests.locale=es-PA -Ptests.timezone=America/Bahia_Banderas -Ptests.asserts=true -Ptests.file.encoding=ISO-8859-1
     // You'll have to uncomment the if below to hit the null pointer exception.
     // This is such an unusual case (i.e. an empty index) that catching this concdition here is probably OK.
     // This came to light in the very artifical case of indexing a single doc to Cloud.",I think this should be a qualified class.method reference (much like I showed above).,java,1,1,1
"@@ -52,6 +52,14 @@ public class TableMetadata {
                                                PartitionSpec spec,
                                                String location,
                                                Map<String, String> properties) {
+    return newTableMetadata(schema, spec, location, properties, DEFAULT_TABLE_FORMAT_VERSION);
+  }
+
+  static TableMetadata newTableMetadata(Schema schema,
+                                        PartitionSpec spec,
+                                        String location,
+                                        Map<String, String> properties,
+                                        int formatVersion) {
     // reassign all column ids to ensure consistency
     AtomicInteger lastColumnId = new AtomicInteger(0);
     Schema freshSchema = TypeUtil.assignFreshIds(schema, lastColumnId::incrementAndGet);",This is needed to create v2 tables in tests. It isn't public.,java,1,1,1
"@@ -2191,6 +2191,17 @@ public class ZTSImpl implements KeyStore, ZTSHandler {
             return false;
         }
 
+        // validate uriHostname in request matches the uriHostname in cert
+        if (!validateUriHostname(certReq.getUriHostname(), cert)) {
+            return false;
+        }
+
+        // validate InstanceID in request matches the instanceid in the cert
+        if (!validateInstanceId(certReq.getInstanceId(), cert)) {
+            // Todo: minitor the logs, and make this a hard failure in later iteration
+            LOGGER.error(""unable to match request id: {} with cert id: {}"", certReq.getInstanceId(), X509CertUtils.extractRequestInstanceId(cert));
+        }
+
         // validate the ip address if any provided
 
         return verifyCertRequestIP ? certReq.validateIPAddress(cert, ip) : true;",we should not return true here. otherwise we're skipping the last check.,java,1,1,1
"@@ -44,7 +44,7 @@ public class RangeSetBuilder<C extends Comparable> extends DefaultVisitor<RangeS
    * @param loose If prefix length is specified, then filter is loose, so is the range.
    * @return a range set.
    */
-  protected RangeSet<C> comparisonBinaryExprVisit(
+  RangeSet<C> comparisonBinaryExprVisit(
       ComparisonBinaryExpression node, Void context, C literal, boolean loose) {
     NormalizedPredicate predicate = node.normalize();
     RangeSet<C> ranges = TreeRangeSet.create();",naming rule should be verb+noun for a method,java,1,1,1
"@@ -340,6 +340,10 @@ public class NavigationURLBar extends FrameLayout {
             if (!hasProtocol && !urlText.contains("" "") && UrlUtils.isDomain(urlText)) {
                 urlText = ""https://"" + urlText;
                 hasProtocol = true;
+            } else if (!hasProtocol && !urlText.contains("" "") && UrlUtils.isIPUri(urlText)) {
+                String protocol = UrlUtils.isLocalIP(urlText) ? ""http://"" : ""https://"";
+                urlText = protocol + urlText;
+                hasProtocol = true;
             }
             if (hasProtocol) {
                 URL url = new URL(urlText);",I was thinking about ways we could degrade from https:// to http:// in FxR so we always try secure first.,java,1,1,1
"@@ -800,5 +800,13 @@ public class EnginePersistenceLogger extends ProcessEngineLogger {
         preconditionMessage,
         failedOperation.toString());
   }
+  
+  public void logTaskAlreadyFetched(String workerId, Throwable cause) {
+	  logWarn(""091"",
+			  ""Execution Null. External task {}  was already fetched by worker thread {} {}"", 
+			  workerId, 
+			  cause.getMessage(), 
+			  cause);
+  }
 
 }","In the case of optimistic lokcing exception on the task itself, we currently do not log anything. In that sense, I would be ok to also not log anything in this case. If we do want to log though, it should be on level `DEBUG` as this is an expected condition in high concurrency scenarios and doesn't pose a problem that someone must take care of.",java,1,1,1
"@@ -192,7 +192,7 @@ public class ItunesSearchFragment extends Fragment {
         progressBar.setVisibility(View.VISIBLE);
 
         ItunesTopListLoader loader = new ItunesTopListLoader(getContext());
-        disposable = loader.loadToplist(25)
+        disposable = loader.loadToplist(100)
                 .subscribe(podcasts -> {
                     progressBar.setVisibility(View.GONE);
                     topList = podcasts;","I think something like this should be discussed in #3788. We already cause quite a lot of traffic to iTunes and I want to keep it to a minimum, so we do not get locked out one day.",java,0,1,1
"@@ -40,7 +40,7 @@ class AvroFileAppender<D> implements FileAppender<D> {
   AvroFileAppender(Schema schema, OutputFile file,
                    Function<Schema, DatumWriter<?>> createWriterFunc,
                    CodecFactory codec, Map<String, String> metadata) throws IOException {
-    this.stream = file.create();
+    this.stream = file.createOrOverwrite();
     this.writer = newAvroWriter(schema, stream, createWriterFunc, codec, metadata);
   }
 ",This will affect writes for all data and metadata files. Is it safe to do this everywhere?,java,1,1,1
"@@ -398,7 +398,6 @@ public class UserAccountManager {
 		final String userId = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_USER_ID));
 		final String username = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_USERNAME));
 		final String accountName = accountManager.getUserData(account, AccountManager.KEY_ACCOUNT_NAME);
-		final String clientId = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_CLIENT_ID));
 		final String lastName = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_LAST_NAME));
 		final String email = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_EMAIL));
 		final String encFirstName =  accountManager.getUserData(account, AuthenticatorService.KEY_FIRST_NAME);",Unrelated - wasn't being used.,java,0,0,1
"@@ -380,14 +380,7 @@ public class AuthenticationServiceBean {
         }
         if (tokens.size() == 1) {
             // Normal case - one token that may or may not have expired
-            ApiToken token = tokens.get(0);
-            if (token.getExpireTime().before(latest)) {
-                // Don't return an expired token which is unusable, delete it instead
-                em.remove(token);
-                return null;
-            } else {
-                return tokens.get(0);
-            }
+            return tokens.get(0);
         } else {
             // We have more than one due to https://github.com/IQSS/dataverse/issues/6389 or
             // similar, so we should delete all but one token.",so the idea is this will just return the expired token and it weon't work but user will then no to reset it?,java,1,1,1
"@@ -570,6 +570,12 @@ public class ChatMessageManager
 			return;
 		}
 
+		//guard case for google MoreObjects#firstNonNull
+		if (message.getValue() == null && message.getRuneLiteFormattedMessage() == null)
+		{
+			return;
+		}
+
 		// this updates chat cycle
 		client.addChatMessage(
 			message.getType(),",use two separate if statements as an OR,java,1,1,1
"@@ -60,10 +60,10 @@ public final class PMDCommandLineInterface {
     public static String buildUsageText(JCommander jcommander) {
         StringBuilder usage = new StringBuilder();
 
-        String allCommandsDescription = null;
+        StringBuilder allCommandsDescription = null;
         if (jcommander != null && jcommander.getCommands() != null) {
             for (String command : jcommander.getCommands().keySet()) {
-                allCommandsDescription += jcommander.getCommandDescription(command) + PMD.EOL;
+                allCommandsDescription.append(jcommander.getCommandDescription(command)).append(PMD.EOL);
             }
         }
 ",@XenoAmess This introduces a NPE.,java,0,1,1
"@@ -185,6 +185,10 @@ final class UnzippingBytesRequestConverter implements RequestConverterFunction {
     }
 
     if (content.isEmpty()) ZipkinHttpCollector.maybeLog(""Empty POST body"", ctx, request);
+    if (content.length() == 2 && ""[]"".equals(content.toStringAscii())) {
+      ZipkinHttpCollector.maybeLog(""Empty JSON list POST body"", ctx, request);
+      content = HttpData.EMPTY_DATA;
+    }
 
     byte[] result = content.array();
     ZipkinHttpCollector.metrics.incrementBytes(result.length);",found a bug while doing this!!,java,1,1,1
"@@ -66,6 +66,17 @@ public interface TableScan {
    */
   TableScan project(Schema schema);
 
+  /**
+   * Create a new {@link TableScan} from this that, if data columns where selected
+   * via {@link #select(java.util.Collection)}, controls whether the match to the schema will be done
+   * with case sensitivity.
+   *
+   * MUST be called before {@link #select(java.util.Collection)}!
+   *
+   * @return a new scan based on this with case sensitivity as stated
+   */
+  TableScan caseSensitive(boolean caseSensitive);
+
   /**
    * Create a new {@link TableScan} from this that will read the given data columns. This produces
    * an expected schema that includes all fields that are either selected or used by this scan's",This seems like a problem to me. Can we do everything lazily so that it doesn't matter what order refinement calls are made in?,java,1,0,0
"@@ -61,6 +61,9 @@ public abstract class StaticLangApiView {
 
   public abstract boolean hasLongRunningOperations();
 
+  @Nullable // Used in Java
+  public abstract String stubInterfaceName();
+
   public static Builder newBuilder() {
     return new AutoValue_StaticLangApiView.Builder();
   }","Nullable feels a little icky. I generally think ""NOT IMPLEMENTED"" string is better. Looks like you'll have to change all LanguageTransformers though... Up to you.",java,1,1,1
"@@ -221,7 +221,7 @@ public class VRBrowserActivity extends PlatformActivity implements WidgetManager
     void loadFromIntent(final Intent intent) {
         final Uri uri = intent.getData();
         if (SessionStore.get().getCurrentSession() == null) {
-            String url = (uri != null ? uri.toString() : SessionStore.DEFAULT_URL);
+            String url = (uri != null ? uri.toString() : SessionStore.get().getHomeUri());
             int id = SessionStore.get().createSession();
             SessionStore.get().setCurrentSession(id);
             SessionStore.get().loadUri(url);",I thought about just changing `SessionStore#loadUri` to accept a null `uri` and keeping the conditional logic in that method. would make things a tad more DRY. thoughts?,java,1,1,1
"@@ -112,9 +112,9 @@ public class BlockJoinSelector {
    *  one value per parent among its {@code children} using the configured
    *  {@code selection} type. */
   public static SortedDocValues wrap(final SortedDocValues values, Type selection, BitSet parents, DocIdSetIterator children) {
-    if (values.docID() != -1) {
-      throw new IllegalArgumentException(""values iterator was already consumed: values.docID="" + values.docID());
-    }
+    //if (values.docID() != -1) {
+    //  throw new IllegalArgumentException(""values iterator was already consumed: values.docID="" + values.docID());
+    //}
     return ToParentDocValues.wrap(values, selection, parents, children);
   }
 ","Would be discussed later, if all other issues resolved.",java,1,0,1
"@@ -107,10 +107,14 @@ public class AvroSchemaUtil {
 
   public static boolean isTimestamptz(Schema schema) {
     LogicalType logicalType = schema.getLogicalType();
-    if (logicalType != null && logicalType instanceof LogicalTypes.TimestampMicros) {
+    if (logicalType instanceof LogicalTypes.TimestampMillis || logicalType instanceof LogicalTypes.TimestampMicros) {
       // timestamptz is adjusted to UTC
       Object value = schema.getObjectProp(ADJUST_TO_UTC_PROP);
-      if (value instanceof Boolean) {
+
+      if (value == null) {
+        // not all avro timestamp logical types will have the adjust_to_utc prop, default to not timestamptz
+        return false;
+      } else if (value instanceof Boolean) {
         return (Boolean) value;
       } else if (value instanceof String) {
         return Boolean.parseBoolean((String) value);","How about ""default to timestamp"" or ""default to timestamp without time zone""?",java,1,1,1
"@@ -307,4 +307,19 @@ public class OAuth2AuthorizationRequestTests {
 						""response_type=code&client_id=client-id&state=state&"" +
 						""redirect_uri=https://example.com/authorize/oauth2/code/registration-id"");
 	}
+
+	@Test
+	public void buildWhenAuthorizationUriIncludesEscapedQueryParameterThenAuthorizationRequestUrlIncludesIt() {
+		OAuth2AuthorizationRequest authorizationRequest =
+				TestOAuth2AuthorizationRequests.request()
+						.authorizationUri(AUTHORIZATION_URI +
+								""?claims=%7B%22userinfo%22%3A%7B%22email_verified%22%3A%7B%22essential%22%3Atrue%7D%7D%7D"").build();
+
+		assertThat(authorizationRequest.getAuthorizationRequestUri()).isNotNull();
+		assertThat(authorizationRequest.getAuthorizationRequestUri())
+				.isEqualTo(""https://provider.com/oauth2/authorize?"" +
+						""claims=%7B%22userinfo%22%3A%7B%22email_verified%22%3A%7B%22essential%22%3Atrue%7D%7D%7D&"" +
+						""response_type=code&client_id=client-id&state=state&"" +
+						""redirect_uri=https://example.com/authorize/oauth2/code/registration-id"");
+	}
 }",Can you also add some `additionalParameters` that require encoding.,java,1,1,1
"@@ -820,7 +820,10 @@ public class BlockchainQueries {
                         .orElseThrow(
                             () -> new IllegalStateException(""Could not retrieve block #"" + l)))
             .flatMap(Collection::stream)
-            .mapToLong(t -> t.getGasPrice().toLong())
+            // TODO: currently we omit 1559 transactions from this calculation, what should
+            //       gasPrice() return for this endpoint post-London? (substitute effective gas?)
+            .filter(t -> t.getGasPrice().isPresent())
+            .mapToLong(t -> t.getGasPrice().get().toLong())
             .sorted()
             .toArray();
     return (gasCollection == null || gasCollection.length == 0)","Just a sanity check. Was this TODO supposed to be here? I mean, did we forget to do something or is this a reminder for a future change?",java,1,1,1
"@@ -65,7 +65,17 @@ public enum Varbits
 	/**
 	 * Grand Exchange
 	 */
+	GRAND_EXCHANGE_ITEM_QUANTITY(4396),
+
+	/**
+	 * Type of GE offer currently being created
+	 * 0 = buy
+	 * 1 = sell
+	 */
+	GE_OFFER_CREATION_TYPE(4397),
+
 	GRAND_EXCHANGE_PRICE_PER_ITEM(4398),
+	GRAND_EXCHANGE_SELECTED_SLOT(4439),
 
 	/**
 	 * Runepouch",why? (that goes for all these varbit changes),java,0,0,0
"@@ -37,10 +37,11 @@ import org.junit.Test;
 import org.junit.rules.TemporaryFolder;
 
 public abstract class TestReadProjection {
+
   protected abstract Record writeAndRead(String desc,
-                                         Schema writeSchema,
-                                         Schema readSchema,
-                                         Record record) throws IOException;
+      Schema writeSchema,
+      Schema readSchema,
+      Record record) throws IOException;
 
   @Rule
   public TemporaryFolder temp = new TemporaryFolder();",Can you revert the non-functional changes here? This one and the whitespace one above.,java,1,1,1
"@@ -211,11 +211,16 @@ public final class Helper {
 
     static boolean isSystemLevelClass(ASTUserClass node) {
         List<TypeRef> interfaces = node.getNode().getDefiningType().getCodeUnitDetails().getInterfaceTypeRefs();
+
+        boolean hasWhitelistedInterfaces = false;
         for (TypeRef intObject : interfaces) {
-            return isWhitelisted(intObject.getNames());
+            if (isWhitelisted(intObject.getNames())) {
+                hasWhitelistedInterfaces = true;
+                break;
+            }
         }
 
-        return false;
+        return hasWhitelistedInterfaces;
     }
 
     private static boolean isWhitelisted(List<Identifier> ids) {",`return true` would be cleaner... or am I missing the point of the rule ?,java,1,1,1
"@@ -65,7 +65,10 @@ public class HANAStructureAssistant extends JDBCStructureAssistant<JDBCExecution
         GenericSchema parentSchema = parentObject instanceof GenericSchema ? (GenericSchema) parentObject : null;
 
         if (objectType == RelationalObjectType.TYPE_TABLE)
-            findTablesByMask(session, parentSchema, objectNameMask, caseSensitive, maxResults, result);
+        	/* 
+        	 * A TYPE_TABLE is requested in any kind of select statement. Hence it should return tables, views and (public) synonyms
+        	 */
+        	findObjectsByMask(session, parentSchema, objectNameMask, caseSensitive, maxResults, result);
         if (objectType == RelationalObjectType.TYPE_VIEW)
             findViewsByMask(session, parentSchema, objectNameMask, caseSensitive, maxResults, result);
         if (objectType == RelationalObjectType.TYPE_PROCEDURE)","The object types are choosen in the 'DB metadata' search dialog, so here should not find other types. If searching without schema might be ok to include synonyms with correct target object type in the result. A completely different solution would be adding 'Synonym' as searchable object type.",java,1,1,1
"@@ -0,0 +1,14 @@
+/**
+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html
+ */
+
+package net.sourceforge.pmd.util.fxdesigner.model;
+
+/** Exception during XPath evaluation. */
+public class XPathEvaluationException extends RuntimeException {
+
+    XPathEvaluationException(Throwable cause) {
+        super(cause);
+    }
+
+}",is package-private the intended visibility? or you just missed the access modifier?,java,1,1,1
"@@ -1115,6 +1115,19 @@ public class Crypto {
         return extractX509CertSubjectField(x509Cert, BCStyle.O);
     }
 
+    public static boolean isRestrictedCertificate(X509Certificate x509Cert, GlobStringsMatcher globStringsMatcher) {
+        if (globStringsMatcher == null) {
+            LOG.error(""isRestrictedCertificate: Required argument globStringsMatcher is null. Returning true."");
+            return true;
+        }
+        if (x509Cert == null) {
+            LOG.error(""isRestrictedCertificate: Required argument x509Cert is null. Returning true."");
+            return true;
+        }
+        String x509Ou = extractX509CertSubjectOUField(x509Cert);
+        return globStringsMatcher.isMatch(x509Ou);
+    }
+
     private static List<String> extractX509CertSANField(X509Certificate x509Cert, int tagNo) {
         Collection<List<?>> altNames = null;
         try {","we should optimize the use of this function. If I don't have a restricted set, the code parses and gets the ou field anyway and then just does nothing. before doing this we should check if there are any values in our strings matcher and if it's empty, then return false right away without doing anything.",java,1,1,1
"@@ -243,6 +243,12 @@ public class AddProductActivity extends AppCompatActivity {
         final State state = (State) getIntent().getSerializableExtra(""state"");
         offlineSavedProduct = (OfflineSavedProduct) getIntent().getSerializableExtra(""edit_offline_product"");
         Product mEditProduct = (Product) getIntent().getSerializableExtra(""edit_product"");
+
+        if(getIntent().getBooleanExtra(""perform_ocr"",false)) {
+            this.onPageSelected(1);
+            this.performOCR(mEditProduct.getCode(), ""ingredients_"" + mEditProduct.getLang());
+        }
+
         if (state != null) {
             mProduct = state.getProduct();
             // Search if the barcode already exists in the OfflineSavedProducts db",Always include a screenshot when a PR makes visual changes.,java,1,1,1
"@@ -180,6 +180,8 @@ public class SalesforceSDKManagerWithSmartStore extends SalesforceSDKManager {
     		if (userAccount != null && hasSmartStore(userAccount)) {
     			DBOpenHelper.deleteDatabase(getAppContext(), userAccount);
     		}
+    	} else {
+    		DBOpenHelper.deleteAllDatabases(getAppContext());
     	}
 
         /*",Cleaning up everything in the `Forgot Passcode` use case.,java,1,1,1
"@@ -230,4 +230,4 @@ public class Login {
 			return 1; // L: 1317
 		}
 	}
-}
+}",Revert this file,java,1,0,1
"@@ -173,7 +173,7 @@ public class BrowserActivity extends Activity implements SessionStore.SessionCha
             final MyGeckoViewPermission permission = new MyGeckoViewPermission();
             permission.androidPermissionRequestCode = REQUEST_PERMISSIONS;
             mGeckoSession.setPermissionDelegate(permission);
-            uriValue = (uri != null ? uri.toString() : SessionStore.DEFAULT_URL);
+            uriValue = (uri != null ? uri.toString() : SessionStore.get().getHomeUri());
             Log.e(LOGTAG, ""BrowserActivity create session and load URI from intent: "" + uriValue);
             mGeckoSession.loadUri(uriValue);
             mGeckoView.setSession(mGeckoSession);","Yep, we will never get a region upon first run after install unless we use something like postMessage. You will get updated region info after the geolocation request finishes in subsequest home reloads/app launches though (after adding the setRegion call to onGeolocationRequestSuccess)",java,1,1,1
"@@ -29,12 +29,18 @@ import java.util.Collection;
 import java.util.Collections;
 import java.util.Set;
 import java.util.concurrent.ConcurrentHashMap;
+import java.util.concurrent.ExecutorService;
+import java.util.concurrent.LinkedBlockingDeque;
+import java.util.concurrent.ThreadPoolExecutor;
 import java.util.concurrent.TimeUnit;
-import java.util.concurrent.locks.ReentrantLock;
+import java.util.concurrent.locks.Lock;
+import java.util.concurrent.locks.ReadWriteLock;
+import java.util.concurrent.locks.ReentrantReadWriteLock;
 import java.util.function.Function;
 
 import com.google.common.annotations.VisibleForTesting;
 import com.google.common.base.Stopwatch;
+import com.google.common.util.concurrent.ThreadFactoryBuilder;
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 import org.apache.tuweni.bytes.Bytes;","Experimentally determined a while ago. Since the rocks db default lock timeout is 1000ms, I aimed for a flush size that was as big as possible that completes in under 500ms",java,1,0,1
"@@ -220,7 +220,7 @@ class JsGenerator : public BaseGenerator {
        it != sorted_namespaces.end(); it++) {
     if (lang_.language == IDLOptions::kTs) {
       if (it->find('.') == std::string::npos) {
-        code += ""import { flatbuffers } from \""./flatbuffers\""\n"";
+        code += ""import { flatbuffers } from \""flatbuffers\""\n"";
         break;
       }
     } else {",Why is this? What effect will this have on other users? @krojew @JoshGalvin,java,0,0,0
"@@ -21,7 +21,11 @@ import java.util.Collection;
 
 /**
  * Provides relevant data for producing metrics on the status of a Proof of Authority (PoA) node.
+ *
+ * @deprecated This interface has been replaced by {@link
+ *     org.hyperledger.besu.plugin.services.query.PoaQueryService}
  */
+@Deprecated
 public interface PoAMetricsService {
 
   /**","nit: Can we check if we're using `PoA` or `Poa` to make sure these new APIs match. I think `Poa` is strictly right according to the style guide but looks really weird to me - I'd expect `PoA`. I can live with it either way, just want to minimise inconsistency.",java,1,1,1
"@@ -43,7 +43,8 @@ public class PolyglotScriptEngine implements PhoenicisScriptEngine {
         this.language = language;
         this.context = Context.newBuilder(language)
                 .allowExperimentalOptions(true)
-                .options(options).allowHostAccess(true).build();
+                .allowHostAccess(true)
+                .options(options).build();
     }
 
     @Override",I tried to replace by `allowHostAccess(true)` by something else because it seems to be deprecated but I couldn't find a working replacement operation.,java,1,0,1
"@@ -76,7 +76,7 @@ class DeleteFileIndex {
     ImmutableMap.Builder<Integer, Types.StructType> builder = ImmutableMap.builder();
     specsById.forEach((specId, spec) -> builder.put(specId, spec.partitionType()));
     this.partitionTypeById = builder.build();
-    this.wrapperById = Maps.newHashMap();
+    this.wrapperById = Maps.newConcurrentMap();
     this.globalSeqs = globalSeqs;
     this.globalDeletes = globalDeletes;
     this.sortedDeletesByPartition = sortedDeletesByPartition;","My only question on this PR is whether we should switch to using a Caffeine loading cache here? I just notice in some places we do that, and in others we just use the concurrent map.",java,1,1,1
"@@ -25,7 +25,7 @@ public interface ValidatorManager {
    * of {@link ValidationReport} with the key being the validator's name and the value being the
    * {@link ValidationReport} generated by that validator.
    */
-  Map<String, ValidationReport> validate(Project project, File projectDir);
+  Map<String, ValidationReport> validate(Project project, File projectDir, String azkabanFlowVersion);
 
   /**
    * The ValidatorManager should have a default validator which checks for the most essential",How do you plan to discover and update all the users of this interface?,java,1,1,1
"@@ -18,17 +18,7 @@ package org.apache.solr.handler;
 
 import java.io.IOException;
 import java.lang.invoke.MethodHandles;
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.Collection;
-import java.util.Collections;
-import java.util.HashMap;
-import java.util.HashSet;
-import java.util.LinkedHashMap;
-import java.util.List;
-import java.util.Locale;
-import java.util.Map;
-import java.util.Set;
+import java.util.*;
 import java.util.concurrent.Callable;
 import java.util.concurrent.ExecutionException;
 import java.util.concurrent.ExecutorService;","I've had this happen recently with IntelliJ, was this intentional?",java,0,0,1
"@@ -324,7 +324,7 @@ class SimpleClusterAbstractionsImpl {
       return new Pair<>(replicas, leader);
     }
 
-    private ReplicaImpl(String replicaName, Shard shard, org.apache.solr.common.cloud.Replica sliceReplica) {
+    ReplicaImpl(String replicaName, Shard shard, org.apache.solr.common.cloud.Replica sliceReplica) {
       this.replicaName = replicaName;
       this.coreName = sliceReplica.getCoreName();
       this.shard = shard;",Why are these no longer `private`?,java,1,1,1
"@@ -551,7 +551,8 @@ class CppGenerator : public BaseGenerator {
       if (opts_.generate_object_based_api) {
         // A convenient root unpack function.
         auto native_name =
-            NativeName(WrapInNameSpace(struct_def), &struct_def, opts_);
+            WrapInNameSpace(struct_def.defined_namespace,
+                            NativeName(Name(struct_def), &struct_def, opts_));
         code_.SetValue(""UNPACK_RETURN"",
                        GenTypeNativePtr(native_name, nullptr, false));
         code_.SetValue(""UNPACK_TYPE"",","This construction `WrapInNameSpace(ns, NativeName(Name(),...)` repeated 4 times. It would be better to add a shortcut for it.",java,1,1,1
"@@ -78,6 +78,13 @@ public class BftBlockHashing {
             bftExtraDataCodec));
   }
 
+  public Hash calculateHashOfBftBlockForCmsSignature(final BlockHeader header) {
+    final BftExtraData bftExtraData = bftExtraDataCodec.decode(header);
+    return Hash.hash(
+        serializeHeader(
+            header, () -> bftExtraDataCodec.encodeForProposal(bftExtraData), bftExtraDataCodec));
+  }
+
   /**
    * Recovers the {@link Address} for each validator that contributed a committed seal to the block.
    *","Don't think this belongs on the generic BftBlockHashing class, this is quite to specific to the QBFT PKI implementation",java,1,1,1
"@@ -0,0 +1,17 @@
+/**
+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html
+ */
+
+package net.sourceforge.pmd.lang.plsql.ast;
+
+import org.junit.Test;
+
+import net.sourceforge.pmd.lang.plsql.AbstractPLSQLParserTst;
+
+public class ParsingExclusionTest extends AbstractPLSQLParserTst {
+
+    @Test
+    public void parseParsingExclusion() {
+        plsql.parseResource(""ParsingExclusion.sql"");
+    }
+}","I think, we should somehow verify that the AST doesn't contain the excluded elements. In the future, we might improve the parser, so that it can parse scalar subqueries in where conditions.... maybe it's easier to just write really invalid SQL that will be skipped by PMD to verify, it is indeed being skipped....",java,1,1,1
"@@ -65,6 +65,7 @@ public abstract class BaseRewriteDataFilesAction<ThisT>
   private Expression filter;
   private long targetSizeInBytes;
   private int splitLookback;
+  private int itemsPerBin;
   private long splitOpenFileCost;
 
   protected BaseRewriteDataFilesAction(Table table) {",Looks like this is only modifying the old rewrite path and not the new path. We should probably fix it in both places,java,1,1,1
"@@ -705,7 +705,8 @@ public class AzkabanWebServer extends AzkabanServer {
 
   private void startWebMetrics() throws Exception {
 
-    final MetricRegistry registry = MetricsManager.INSTANCE.getRegistry();
+    final MetricRegistry registry = SERVICE_PROVIDER.getInstance(MetricsManager.class)
+        .getRegistry();
 
     // The number of idle threads in Jetty thread pool
     MetricsUtility",Why not just get the MetricsRegistry directly?,java,1,1,1
"@@ -1,5 +1,4 @@
 import { enqueueRender } from './component';
-
 export let i = 0;
 
 /**","Nit: It may be just me, but I feel like having at least one empty line after imports is easier to scan.",js,1,1,1
"@@ -118,6 +118,7 @@ class ConfigScreenComponent extends BaseScreenComponent {
 					const files = await shim.fsDriver().readDirStats(Setting.value('resourceDir'));
 
 					for (const file of files) {
+						if (file.path == 'pluginAssets') continue;
 						const source = `${Setting.value('resourceDir')}/${file.path}`;
 						const dest = `${this.state.profileExportPath}/resources/${file.path}`;
 						reg.logger().info(`Copying profile: ${source} => ${dest}`);",A better fix would be to recursively copy all files and folders. I think there's an option on readDirStats for that,js,1,1,1
"@@ -48,6 +48,7 @@ describe( 'Plugin Activation Notice', () => {
 		await activateSiteKit();
 
 		await page.waitForSelector( '.googlesitekit-activation' );
+		await page.waitForSelector( 'h3.googlesitekit-activation__title' );
 
 		await expect( page ).toMatchElement( 'h3.googlesitekit-activation__title', { text: 'Congratulations, the Site Kit plugin is now activated.' } );
 ",Let's remove the `h3` from this selector (and below) and rely on the class only. The specific element isn't really important and will make the test fail unnecessarily should that change in the future.,js,1,1,1
"@@ -42,17 +42,6 @@ function missingRequiredChildren(virtualNode, role, required, ownedRoles) {
 
   // combobox exceptions
   if (isCombobox) {
-    // remove 'textbox' from missing roles if combobox is a native
-    // text-type input or owns a 'searchbox'
-    const textTypeInputs = ['text', 'search', 'email', 'url', 'tel'];
-    if (
-      (virtualNode.props.nodeName === 'input' &&
-        textTypeInputs.includes(virtualNode.props.type)) ||
-      ownedRoles.includes('searchbox')
-    ) {
-      required = required.filter(requiredRole => requiredRole !== 'textbox');
-    }
-
     // combobox only needs one of [listbox, tree, grid, dialog] and
     // only the type that matches the aria-popup value. remove
     // all the other popup roles from the list of required",All of this special case should probably be removed. We don't want to check for required owned elements.,js,1,1,1
"@@ -47,6 +47,7 @@ public interface CapabilityType {
   String ELEMENT_SCROLL_BEHAVIOR = ""elementScrollBehavior"";
   String HAS_TOUCHSCREEN = ""hasTouchScreen"";
   String OVERLAPPING_CHECK_DISABLED = ""overlappingCheckDisabled"";
+  String ENABLE_DOWNLOADING = ""chromium:enableDownloading"";
 
   String LOGGING_PREFS = ""loggingPrefs"";
 ",The name `enableDownloading` implies this is a boolean capability. How about `downloadDir`?,js,1,1,1
"@@ -0,0 +1,8 @@
+'use strict';
+function getDefaultOptionSetter(type) {
+  return function setDefaultOption(optionName, value) {
+    type.defaultOptions[optionName] = value;
+  };
+}
+
+module.exports = getDefaultOptionSetter;",Why is this function necessary? Seems like a lot of work to avoid copying a one-liner. Especially since you could just define `set()` as a function on SchemaType.prototype.,js,1,1,1
"@@ -30,7 +30,12 @@ const start = (buildConfig = config.defaultBuildConfig, options) => {
   }
 
   if (process.platform === 'darwin') {
-    util.run(path.join(config.outputDir, 'Brave.app', 'Contents', 'MacOS', 'Brave'), braveArgs, cmdOptions)
+    let product_name = 'Brave-Browser'
+    if (config.channel) {
+      // Capitalize channel name and append it to make product name like Brave-Browser-Beta
+      product_name = product_name + '-' + config.channel.charAt(0).toUpperCase() + config.channel.slice(1)
+    }
+    util.run(path.join(config.outputDir, product_name + '.app', 'Contents', 'MacOS', product_name), braveArgs, cmdOptions)
   } else if (process.platform === 'win32') {
     util.run(path.join(config.outputDir, 'brave.exe'), braveArgs, cmdOptions)
   } else {","this is fine to merge, but I think it probably makes sense to move this logic to config.js",js,1,1,1
"@@ -123,7 +123,8 @@ class SearchScreenComponent extends BaseScreenComponent {
 
 		if (!this.isMounted_) return;
 
-		const parsedQuery = await SearchEngine.instance().parseQuery(query);
+		// ignore brackets when finding words to highlight
+		const parsedQuery = await SearchEngine.instance().parseQuery(query.replace(/[()]/g, ' '));
 		const highlightedWords = SearchEngine.instance().allParsedQueryTerms(parsedQuery);
 
 		this.props.dispatch({","This regex shows up 4 times in the code. Instead, could you create a specific function that returns what you need. I can't think of any good name for it, but maybe even ""parseQueryNoBrackets"" would be better. Then this of course would call `parseQuery` internally.",js,1,1,1
"@@ -360,6 +360,8 @@ function addNodeToGrid(grid, vNode) {
     const endRow = ((y + rect.height) / gridSize) | 0;
     const endCol = ((x + rect.width) / gridSize) | 0;
 
+    grid._numCols = Math.max(grid._numCols ?? 0, endCol);
+
     for (let row = startRow; row <= endRow; row++) {
       grid.cells[row] = grid.cells[row] || [];
 ","This feels a little off. If `_numCols` needs to be different, it should be fixed where that value is set. If it doesn't need to be changed, this should probably just be a local variable.",js,1,1,1
"@@ -1577,7 +1577,7 @@ describe('Insert', function () {
         var collection = db.collection('bson_types_insert_1');
 
         var document = {
-          symbol: new BSONSymbol('abcdefghijkl'),
+          string: 'abcdefghijkl',
           objid: new ObjectId('abcdefghijkl'),
           double: new Double(1),
           binary: new Binary(Buffer.from('hello world')),",BSONExt supports deserializing but not serializing this type (which is acceptable for deprecated types). So to make the bson-ext tests pass I've updated this to a string.,js,1,1,1
"@@ -139,7 +139,9 @@ var Cursor = function(bson, ns, cmd, options, topology, topologyOptions) {
     // Promise library
     promiseLibrary: promiseLibrary,
     // Current doc
-    currentDoc: null
+    currentDoc: null,
+    // Optional ClientSession
+    session: options.session || null
   };
 
   // Translate correctly","Do we specifically need `null` here, or can we just let it be `undefined`?",js,1,1,1
"@@ -1654,9 +1654,10 @@ class TargetLocator {
    *     when the driver has changed focus to the specified window.
    */
   window(nameOrHandle) {
+    let paramName = this.driver_.getExecutor().w3c ? 'handle' : 'name';
     return this.driver_.schedule(
         new command.Command(command.Name.SWITCH_TO_WINDOW).
-            setParameter('name', nameOrHandle),
+            setParameter(paramName, nameOrHandle),
         'WebDriver.switchTo().window(' + nameOrHandle + ')');
   }
 ",I'd rather just send the parameter twice than break encapsulation here. There's already precedence with webelement IDs,js,1,1,1
"@@ -286,7 +286,7 @@ class TextEditor extends BaseEditor {
     // TD is outside of the viewport.
     if (!this.TD) {
       if (!force) {
-        this.close();
+        this.close(); // TODO shouldn't it be this.finishEditing() ?
       }
 
       return;","I guess these issues are related: #3557, #3656 and definitely to do on a separated branch.",js,0,1,1
"@@ -281,7 +281,7 @@ class Event {
 
       priv.dblClickTimeout[1] = setTimeout(() => {
         priv.dblClickOrigin[1] = null;
-      }, 500);
+      }, 1000);
     }
   }
 ","`1s` as a delay for double click for some users can be a huge difference. Especially when some of them have set (in the OS settings) short delays between clicks. In that case, the table can be perceived as standing out in behavior from the other components or so - which is bad. I wouldn't change that delay. Maybe rewriting it to use the native `dblclick` event could resolve the problem with the delay. Then the touch event could be supported differently? CC @wojciechczerniak",js,0,1,0
"@@ -24,7 +24,9 @@ describe('mongodb+srv', function () {
         test[1].comment = test[0];
       }
 
-      it(test[1].comment, {
+      // TODO: Remove with NODE-3011
+      const maybeIt = test[1].comment.includes('loadBalanced') ? it.skip : it.only;
+      maybeIt(test[1].comment, {
         metadata: { requires: { topology: ['single'] } },
         test: function (done) {
           try {",is .only actually what we want here? not just plain `it`?,js,1,1,0
"@@ -93,6 +93,10 @@ function setup(logs) {
                 },
         });
 
+       process.on('SIGUSR2', function () {
+               log.reopenFileStreams();
+       });
+
         module.exports.logger = logger;
 }
 ","Check the linting is failing, `log` is not defined. you can run locally `npm run lint` to double check.",js,1,1,1
"@@ -133,6 +133,15 @@ storiesOf( 'Tag Manager Module/Settings', module )
 
 		return <Settings isOpen={ true } isEditing={ true } registry={ registry } />;
 	} )
+	.add( 'Edit, with ""Set up a new container""', ( registry ) => {
+		const webContainerVersion = fixtures.liveContainerVersions.web.gaWithVariable;
+		const accountID = webContainerVersion.accountId; // eslint-disable-line sitekit/camelcase-acronyms
+
+		registry.dispatch( STORE_NAME ).receiveGetAccounts( fixtures.accounts );
+		registry.dispatch( STORE_NAME ).receiveGetContainers( [], { accountID } );
+
+		return <Settings isOpen={ true } isEditing={ true } registry={ registry } />;
+	} )
 	.add( 'Edit, with all settings, with existing tag (with access)', ( registry ) => {
 		// eslint-disable-next-line sitekit/camelcase-acronyms
 		const accountID = fixtures.accounts[ 0 ].accountId;","Hah, just noticed that here (and elsewhere in this file) we're using `isOpen={ true }` rather than just `isOpen`. Hardly a big deal, but I'm surprised ESLint didn't warn us-I thought a lot of ESLint rules prefer boolean props to omit the `={ true }` part.  ",js,1,1,1
"@@ -0,0 +1,11 @@
+const fs = require(""fs"")
+
+const filePath = process.cwd()
+
+fs.appendFile(
+  `${filePath}/app/types.ts`,
+  ""declare module 'react' { interface StyleHTMLAttributes<T> extends React.HTMLAttributes<T> { jsx?: boolean; global?: boolean }}"",
+  function (err) {
+    if (err) throw err
+  },
+)","Is there a reason why it's a script? I mean, could we have a function, e.g. `const appendModuleDeclaration = () => {...}` and call it from within the test?",js,1,1,1
"@@ -12,12 +12,12 @@ var MongooseError = require('../error.js');
  */
 
 function MissingSchemaError (name) {
-  var msg = 'Schema hasn\'t been registered for model ""' + name + '"".\n'
-          + 'Use mongoose.model(name, schema)';
+  var msg = 'Schema hasn\'t been registered for document.\n'
+          + 'Use mongoose.Document(name, schema)';
   MongooseError.call(this, msg);
   Error.captureStackTrace && Error.captureStackTrace(this, arguments.callee);
   this.name = 'MissingSchemaError';
-};
+}
 
 /*!
  * Inherits from MongooseError.",Error message will be confusing on nodejs side. Perhaps we need a separate MissingSchemaError for client side.,js,1,1,1
"@@ -52,7 +52,9 @@
         var isMultipleSelection = !(selected[0] === selected[2] && selected[1] === selected[3]);
         if ((ctrlDown && !isMultipleSelection) || event.altKey) { //if ctrl+enter or alt+enter, add new line
           if(that.isOpened()){
-            that.val(that.val() + '\n');
+            var caretPosition = that.wtDom.getCaretPosition(that.TEXTAREA);
+            that.val(that.val().substr(0, caretPosition) + '\n' + that.val().substr(caretPosition));
+            that.wtDom.setCaretPosition(that.TEXTAREA, caretPosition + 1);
             that.focus();
           } else {
             that.beginEditing(that.originalValue + '\n')",don't you have to remove this line (58) too?,js,1,0,1
"@@ -237,10 +237,6 @@ define([""appSettings"", ""browser"", ""events"", ""htmlMediaHelper"", ""webSettings""], f
             features.push(""voiceinput"");
         }
 
-        if (!browser.tv && !browser.xboxOne) {
-            browser.ps4;
-        }
-
         if (supportsHtmlMediaAutoplay()) {
             features.push(""htmlaudioautoplay"");
             features.push(""htmlvideoautoplay"");",What was this even doing?,js,1,0,0
"@@ -747,8 +747,9 @@
        * @param {Grid} grid grid object
        * @param {GridColumn} column the column we want to aggregate
        * @param {string} aggregationType of the recognised types from uiGridGroupingConstants or one of the custom aggregations from gridOptions
+       * @param {string} aggregationLabel to be used instead of the default label. If empty string is passed, label is omitted
        */
-      aggregateColumn: function( grid, column, aggregationType) {
+      aggregateColumn: function( grid, column, aggregationType, aggregationLabel ) {
         if (typeof(column.grouping) !== 'undefined' && typeof(column.grouping.groupPriority) !== 'undefined' && column.grouping.groupPriority >= 0) {
           service.ungroupColumn( grid, column );
         }","I couldn't help but notice that you said that ""[i]f empty string is passed, label is omitted"", Is the point of this to add a way for users to be able to hide the label on the aggregate column by passing an empty string?",js,1,1,1
"@@ -56,7 +56,7 @@ TemplateUtils.loadTemplates = async function(filePath) {
 		});
 	}
 
-	return templates;
+	return templates.sort((a, b) => { return a.label.localeCompare(b.label); });
 };
 
 module.exports = TemplateUtils;",Shouldn't we sort in a case insensitive way? (not sure if localeCompare does this),js,1,1,1
"@@ -33,13 +33,13 @@ export function createComponent(Ctor, props, context) {
 		inst;
 
 	if (Ctor.prototype && Ctor.prototype.render) {
-		inst = new Ctor(props, context);
+		inst = new /** @type {(props, context) => void} */(Ctor)(props, context);
 		Component.call(inst, props, context);
 	}
 	else {
 		inst = new Component(props, context);
 		inst.constructor = Ctor;
-		inst.render = doRender;
+		inst['render'] = doRender;
 	}
 
 ",This seems strange to me. @rbiggs Can you elaborate on the thinking behind it?,js,0,0,1
"@@ -113,6 +113,10 @@ class FsDriverRN extends FsDriverBase {
 		return RNFS.readFile(path, encoding);
 	}
 
+	async readDir(path) {
+		return RNFS.readDir(path).map(e => e.name);
+	}
+
 	// Always overwrite destination
 	async copy(source, dest) {
 		let retry = false;","As `readDirStats` can be used, we won't need this function anymore.",js,1,1,1
"@@ -43,6 +43,11 @@ color.propTypes = {
   ...bgColor.propTypes,
 }
 
+export const opacity = responsiveStyle({
+  prop: 'opacity',
+  alias: 'o',
+})
+
 // typography
 export const fontFamily = style({
   prop: 'fontFamily',","I think the shorthand should be removed; the existing shorthands are mostly meant for backwards compatibility, and I can't imagine `opacity` being used nearly enough to warrant a new shorthand",js,1,1,1
"@@ -106,7 +106,7 @@ public class BaseServer<T extends BaseServer> implements Server<T> {
       FilterHolder
           filterHolder = servletContextHandler.addFilter(CrossOriginFilter.class, ""/*"", EnumSet
           .of(DispatcherType.REQUEST));
-      filterHolder.setInitParameter(""allowedOrigins"", ""*"");
+      filterHolder.setInitParameter(""allowedMethods"", ""GET,POST,PUT,DELETE,HEAD"");
 
       // Warning user
       LOG.warning(""You have enabled CORS requests from any host. ""","Because the default value of allowedOrigins is * (all origins), so it isn't necessary to set again at all.",js,1,1,1
"@@ -225,7 +225,7 @@ class ColumnSorting extends BasePlugin {
 
     if (sortPossible) {
       const translateColumnToPhysical = ({ column: visualColumn, ...restOfProperties }) =>
-        ({ column: this.hot.toPhysicalColumn(visualColumn), ...restOfProperties });
+        ({ column: this.hot.renderedToPhysicalColumn(visualColumn), ...restOfProperties });
       const internalSortStates = arrayMap(destinationSortConfigs, columnSortConfig => translateColumnToPhysical(columnSortConfig));
 
       this.columnStatesManager.setSortStates(internalSortStates);","I don't see why this should be translated from `rendered` indexes. `sortConfig` should be consistent with any other public API and use visual indexes. Even if some columns are hidden they can be sorted from API, or sorted prior to hiding them.",js,1,1,1
"@@ -51,8 +51,11 @@
       };
     }
 
+    // IE 10 doesn’t support console.debug
+    var consoleDebug = console.debug || console.log
+
     console.log = customLog(console.log.bind(console), document.getElementById(""console-log""));
-    console.debug = customLog(console.log.bind(console), document.getElementById(""console-log""));
+    console.debug = customLog(consoleDebug.bind(console), document.getElementById(""console-log""));
     console.warn = customLog(console.warn.bind(console), document.getElementById(""console-log""));
     console.error = customLog(console.error.bind(console), document.getElementById(""console-log""));
   </script>","I guess we don't need `console.log =` here then, because `.debug` calls `.log` when needed? But it's a minor detail, it's not hurting anything.",js,1,1,1
"@@ -2,12 +2,14 @@ const http = require('http');
 const cluster = require('cluster');
 const formidable = require('formidable');
 const os = require('os');
+const fs = require('fs');
 const countlyConfig = require('./config', 'dont-enclose');
 const plugins = require('../plugins/pluginManager.js');
 const jobs = require('./parts/jobs');
 const log = require('./utils/log.js')('core:api');
 const common = require('./utils/common.js');
 const {processRequest} = require('./utils/requestProcessor');
+const versionInfo = require('../frontend/express/version.info');
 
 var t = [""countly:"", ""api""];  
 ","This is not a Promise, no need to reject, just log error",js,1,1,1
"@@ -46,6 +46,18 @@ function virtualDOMfromNode(node, shadowId) {
 				);
 			}
 			return vNodeCache._tabbableElements;
+		},
+
+		// abstract Node and Element APIs so we can run axe in DOM-less
+		// environments. these are static properties in the assumption
+		// that axe does not change any of them while it runs.
+		elementNodeType: node.nodeType,
+		elementNodeName: node.nodeName,
+		elementClassName: node.className,
+		elementId: node.id,
+
+		elementGetAttribute(attrName) {
+			return node.getAttribute(attrName);
 		}
 	};
 	axe._cache.get('nodeMap').set(node, vNode);","I think we should normalise this, do a `.toLowerCase()` here.",js,1,1,1
"@@ -27,7 +27,7 @@ import org.openqa.selenium.internal.Locatable;
  */
 public abstract class SingleKeyAction extends KeysRelatedAction {
   protected final Keys key;
-  private static final Keys[] MODIFIER_KEYS = {Keys.SHIFT, Keys.CONTROL, Keys.ALT};
+  private static final Keys[] MODIFIER_KEYS = {Keys.SHIFT, Keys.CONTROL, Keys.ALT, Keys.META, Keys.COMMAND, Keys.LEFT_ALT, Keys.LEFT_CONTROL, Keys.LEFT_SHIFT};
 
   protected SingleKeyAction(Keyboard keyboard, Mouse mouse, Keys key) {
     this(keyboard, mouse, null, key);","LEFT_ALT, LEFT_CONTROL, and LEFT_SHIFT should already be aliases. META could be an alias for ALT but probably isn't yet.",js,1,1,1
"@@ -52,7 +52,8 @@ describe('preconditions', function() {
       $.checkArgumentType(1, PrivateKey);
     } catch (e) {
       error = e;
-      e.message.should.equal('Invalid Argument for (unknown name), expected PrivateKey but got number');
+      var fail = !(~e.message.indexOf('Invalid Argument for (unknown name)'));
+      fail.should.equal(false);
     }
     should.exist(error);
   });",what is `e.message` in other browsers? I'm worried this assertion is failing there,js,1,1,1
"@@ -5,7 +5,7 @@ if (ariaHeadingLevel !== null) {
 	return true;
 }
 
-var headingLevel = node.tagName.match(/H(\d)/);
+var headingLevel = node.nodeName.match(/H(\d)/);
 
 if (headingLevel) {
 	this.data(parseInt(headingLevel[1], 10));",do you need `toUpperCase()` here?,js,1,0,1
"@@ -19848,4 +19848,4 @@ var reactDom = ReactDOM$3.default || ReactDOM$3;
 
 return reactDom;
 
-})));
+})));",Why would this file have changed?,js,1,0,1
"@@ -55,6 +55,10 @@ var serverAccounting = false;
 var servers = {};
 var BSON = retrieveBSON();
 
+function topologyId(server) {
+  return server.s.parent == null ? server.id : server.s.parent.id;
+}
+
 /**
  * Creates a new Server instance
  * @class","is there ever a chance that `server.s` is null? Mu guess is no, but idk.",js,1,1,0
"@@ -32,7 +32,7 @@ const getFixer = () => {
  * The function `buildDependencyGetter` is the best place to care about that.
  *
  * @param {string} version The current selected documentation version.
- * @returns {function({dependency:string}):[string,string[],string]} [jsUrl, dependentVars[]?, cssUrl?].
+ * @returns {Function}
  */
 const buildDependencyGetter = (version) => {
   const { handsontableJs, handsontableCss, languagesJs } = getHotUrls(version);",Why this was changes? AFAIK it was correct,js,1,0,1
"@@ -52,10 +52,12 @@ function DashboardClicksWidget() {
 		const isDomainProperty = select( STORE_NAME ).isDomainProperty();
 		const referenceSiteURL = untrailingslashit( select( CORE_SITE ).getReferenceSiteURL() );
 
+		const dateRange = select( CORE_USER ).getDateRangeDates( { compare: true, offsetDays: 1 } );
 		const args = {
 			dimensions: 'date',
-			compareDateRanges: true,
-			dateRange: select( CORE_USER ).getDateRange(),
+			// Combine both date ranges into one single date range.
+			startDate: dateRange.compareStartDate,
+			endDate: dateRange.endDate,
 		};
 		const serviceBaseURLArgs = {
 			resource_id: propertyID,","Can you add a `DATE_RANGE_OFFSET` constant to `assets/js/modules/search-console/datastore/constants.js` and use that in all these locations? This way we put the offset for this module in one place, similarly how it was done for AdSense and Analytics in #2459.",js,0,1,1
"@@ -45,7 +45,10 @@ describe('Operation (Promises)', function() {
         var db = client.db(configuration.db);
         // LINE var MongoClient = require('mongodb').MongoClient,
         // LINE   test = require('assert');
-        // LINE MongoClient.connect('mongodb://localhost:27017/test', function(err, client) {
+        // LINE const client = new MongoClient('mongodb://localhost:27017/test');
+        // LINE client.connect().then(() => {
+        // LINE const client = new MongoClient('mongodb://localhost:27017/test');
+        // LINE client.connect().then(() => {
         // LINE   var db = client.db('test);
         // REPLACE configuration.writeConcernMax() WITH {w:1}
         // REMOVE-LINE done();",do you also need this repeated here?,js,1,0,1
"@@ -41,7 +41,7 @@ class MergedCellsCollection {
    * @return {String}
    */
   static IS_OVERLAPPING_WARNING(newMergedCell) {
-    return toSingleLine`The merged cell declared at [${newMergedCell.row}, ${newMergedCell.col}] overlaps with the other declared merged 
+    return toSingleLine`The merged cell declared at [${newMergedCell.row}, ${newMergedCell.col}] overlaps with the other declared merged
       cell. The overlapping merged cell was not added to the table, please fix your setup.`;
   }
 ","The space between ""merged"" and ""cell"" shouldn't be removed, after this change the warning contains merged words. `The merged cell declared at [29, 1] overlaps with the other declared mergedcell. The overlapping merged cell was not added to the table, please fix your setup.`",js,1,1,1
"@@ -74,7 +74,7 @@ function DateRangeSelector() {
 	const handleMenuItemSelect = useCallback( ( index ) => {
 		setDateRange( Object.values( ranges )[ index ].slug );
 		setMenuOpen( false );
-	}, [ handleMenu ] );
+	}, [ ranges, setDateRange ] );
 
 	const currentDateRangeLabel = ranges[ dateRange ]?.label;
 	const menuItems = Object.values( ranges ).map( ( range ) => range.label );","Shame, I'd have expected it to know the dispatch functions (eg `setDateRange`) shouldn't ever change. Maybe it's only smart enough to do that with actual Redux and not WP Data. But it's no biggie!  ",js,1,1,1
"@@ -0,0 +1,11 @@
+const path = require('path');
+
+module.exports = {
+	mode: 'development',
+  watch: true,
+	entry: './lib/index.js',
+	output: {
+		path: path.resolve(__dirname, 'dist'),
+		filename: 'axe.js'
+	}
+};","Please feel free to suggest / write a better Webpack config, I'm still new to it.",js,0,0,1
"@@ -0,0 +1,15 @@
+/* global axe */
+/**
+ * Convenience function to extract primary language subtag from a given value
+ * @method getBaseLang
+ * @memberof axe.utils
+ * @instance
+ * @param {String} value value specified as lang or xml:lang attribute
+ * @return {String}
+ */
+axe.utils.getBaseLang = function getBaseLang(lang) {
+	return lang
+		.trim()
+		.split('-')[0]
+		.toLowerCase();
+};","This should be on axe.commons, not on `axe.utils`. `axe.utils` is reserved for things necessary in core.",js,1,1,1
"@@ -231,3 +231,6 @@ export UtilityIcon from './utilities/utility-icon';
 
 export SLDSTree from './tree';
 export Tree from './tree';
+
+// Library utilities
+export log from '../utilities/log';",what is this export used for?,js,1,1,1
"@@ -68,7 +68,9 @@ describe('Server Selection (spec)', function () {
         describe(subType, function () {
           specTests[topologyType][subType].forEach(test => {
             // NOTE: node does not support PossiblePrimary
-            const maybeIt = test.name.match(/Possible/) ? it.skip : it;
+            // TODO: Re-enable LoadBalanced in NODE-3011
+            const maybeIt =
+              test.name.match(/Possible/) || topologyType === 'LoadBalanced' ? it.skip : it;
 
             maybeIt(test.name, function (done) {
               executeServerSelectionTest(test, { checkLatencyWindow: false }, done);",Will re-enable these as part of NODE-3011,js,1,0,1
"@@ -123,6 +123,17 @@ exports.utils = require('./utils.js');
  */
 exports.Document = DocumentProvider();
 
+/**
+ * function stub for model
+ *
+ * @method model
+ * @api public
+ * @return {object} an empty object
+ */
+exports.model = function() {
+  return {};
+};
+
 /*!
  * Module exports.
  */",Why not `return null` or something like that? I'm hesitant to just return an empty object because then it will have an inconsistent and incompatible return type vs `model()` in server land.,js,1,1,1
"@@ -9,6 +9,8 @@ const Note = require('lib/models/Note.js');
 const Resource = require('lib/models/Resource.js');
 const urlValidator = require('valid-url');
 const { _ } = require('lib/locale.js');
+const http = require('http');
+const https = require('https');
 
 function shimInit() {
 	shim.fsDriver = () => {",These 2 lines can only be run when not on on mobile.,js,1,0,1
"@@ -7,11 +7,13 @@ import { diff, mounts, diffLevel, flushMounts, recollectNodeTree, removeChildren
 import { createComponent, collectComponent } from './component-recycler';
 import { removeNode } from '../dom/index';
 
-/** Set a component's `props` (generally derived from JSX attributes).
- *	@param {Object} props
- *	@param {Object} [opts]
- *	@param {boolean} [opts.renderSync=false]	If `true` and {@link options.syncComponentUpdates} is `true`, triggers synchronous rendering.
- *	@param {boolean} [opts.render=true]			If `false`, no render will be triggered.
+/**
+ * Set a component's `props` and possibly re-render the component
+ * @param {import('../component').Component} component The Component to set props on
+ * @param {object} props The new props
+ * @param {number} opts Render options - specifies how to re-render the component
+ * @param {object} context The new context
+ * @param {boolean} mountAll Whether or not to immediately mount all components
  */
 export function setComponentProps(component, props, opts, context, mountAll) {
 	if (component._disable) return;",Makes we wonder if we should rename `opts` to something like `render mode` or something similar.,js,1,1,1
"@@ -580,6 +580,18 @@ Blockly.Blocks.defaultToolbox = '<xml id=""toolbox-categories"" style=""display: no
         '</shadow>'+
       '</value>'+
     '</block>'+
+    '<block type=""operator_contains"" id=""operator_contains"">'+
+      '<value name=""STRING1"">'+
+        '<shadow type=""text"">'+
+          '<field name=""TEXT"">hello world</field>'+
+        '</shadow>'+
+      '</value>'+
+      '<value name=""STRING2"">'+
+        '<shadow type=""text"">'+
+          '<field name=""TEXT"">hello</field>'+
+        '</shadow>'+
+      '</value>'+
+    '</block>'+
     '<block type=""operator_mod"" id=""operator_mod"">'+
       '<value name=""NUM1"">'+
         '<shadow type=""math_number"">'+","After looking at this in detail, I think we should switch this to `hello` and change the default for `STRING2` to `world` as this boolean reporter looks too long in the category menu.",js,1,1,1
"@@ -156,6 +156,12 @@ class FsDriverRN extends FsDriverBase {
 		handle.offset += length;
 		return output ? output : null;
 	}
+
+	async fileSize(filePath) {
+		const stats = await RNFetchBlob.fs.stat(filePath);
+		return stats.size;
+	}
+
 }
 
 module.exports.FsDriverRN = FsDriverRN;","Same, you don't need to create a new method, you can simply use the existing `stat()` method.",js,0,1,1
"@@ -837,7 +837,18 @@ class WebDriver(object):
             del png
         return True
 
-    save_screenshot = get_screenshot_as_file
+    def save_screenshot(self, filename):
+        """"""
+        Gets the screenshot of the current window. Returns False if there is
+           any IOError, else returns True. Use full paths in your filename.
+
+        :Args:
+         - filename: The full path you wish to save your screenshot to.
+
+        :Usage:
+            driver.save_screenshot('/Screenshots/foo.png')
+        """"""
+        return self.get_screenshot_as_file(self, filename)
 
     def get_screenshot_as_png(self):
         """"""",This needs to be just return self.get_screenshot_as_file(filename),js,1,1,1
"@@ -435,7 +435,7 @@ describe('ReadConcern', function() {
   });
 
   it('Should set majority readConcern aggregate command but ignore due to out', {
-    metadata: { requires: { topology: 'replicaset', mongodb: '>= 3.2' } },
+    metadata: { requires: { topology: 'replicaset', mongodb: '>= 3.2 < 4.1' } },
 
     test: function(done) {
       var listener = require('../..').instrument(function(err) {",I didn't realize we could do this!,js,1,0,1
"@@ -52,7 +52,7 @@
     }
 
     console.log = customLog(console.log.bind(console), document.getElementById(""console-log""));
-    console.debug = customLog(console.log.bind(console), document.getElementById(""console-log""));
+    console.debug = customLog(console.debug.bind(console), document.getElementById(""console-log""));
     console.warn = customLog(console.warn.bind(console), document.getElementById(""console-log""));
     console.error = customLog(console.error.bind(console), document.getElementById(""console-log""));
   </script>",I think this used console.log for compatibility with IE,js,1,1,1
"@@ -607,8 +607,8 @@ function decorateWithCollation(command, target, options) {
  * @param {object} command the command on which to apply the read concern
  * @param {Collection} coll the parent collection of the operation calling this method
  */
-function decorateWithReadConcern(command, coll) {
-  let readConcern = Object.assign({}, command.readConcern || {});
+function decorateWithReadConcern(command, coll, options) {
+  let readConcern = Object.assign({}, command.readConcern || (options ? options.readConcern : {}));
   if (coll.s.readConcern) {
     Object.assign(readConcern, coll.s.readConcern);
   }",I think you can just do `options ? options.readConcern : undefined` to reduce the extra needless allocation,js,1,1,1
"@@ -88,7 +88,7 @@ class Uploader {
         this._paused = true
         if (this.tus) {
           const shouldTerminate = !!this.tus.url
-          this.tus.abort(shouldTerminate)
+          this.tus.abort(shouldTerminate).catch(() => {})
         }
         this.cleanUp()
       })","The `abort` function now returns a Promise. And if `shouldTerminate` is true, this Promise can be rejected. So, to avoid a unhandled promise rejection, I added a dummy handler. Since a possible error also wasn't handled before, I think it's OK to not handle it in this case as well.",js,1,1,1
"@@ -0,0 +1,14 @@
+/**
+ * External dependencies
+ */
+import { storiesOf } from '@storybook/react';
+
+/**
+ * Internal dependencies
+ */
+import UserInputApp from '../assets/js/components/user-input/UserInputApp';
+
+storiesOf( 'User Input', module )
+	.add( 'User Input Page', () => {
+		return <UserInputApp />;
+	} );","While this component doesn't use the datastore yet since it's just scaffolded, let's already wrap this in a `WithDataRegistry` component, to which we can pass a default registry created via `createTestRegistry()`.",js,1,1,1
"@@ -1,8 +1,12 @@
 import { options, Fragment, Component } from 'preact';
 
 export function initDevTools() {
-	if (typeof window != 'undefined' && window.__PREACT_DEVTOOLS__) {
-		window.__PREACT_DEVTOOLS__.attachPreact('10.4.1', options, {
+	const hook =
+		typeof window != 'undefined' &&
+		(window.__PREACT_DEVTOOLS__ || window.parent.__PREACT_DEVTOOLS__);
+
+	if (hook) {
+		hook.attachPreact('10.4.1', options, {
 			Fragment,
 			Component
 		});","kinda wondering if we could import the version from `package.json` and then inline during build, but not relevant for this PR",js,0,1,1
"@@ -5,7 +5,7 @@ describe('color-contrast code highlighting test', function() {
   function run(done) {
     axe.run(
       '#fixture',
-      { runOnly: { type: 'rule', values: ['color-contrast'] } },
+      { runOnly: { type: 'rule', values: ['color-contrast-enhanced', 'color-contrast'] } },
       function(err, r) {
         assert.isNull(err);
         results = r;","For clarity, I prefer we give color-contrast-enhanced its own set of integration tests, focused specifically on showing the higher contrast values are properly applied. This PR has no test that shows that a test with 6:1 fails this rule for example.",js,0,1,1
"@@ -35,7 +35,7 @@ export function render(vnode, parent, callback) {
 	preactRender(vnode, parent);
 	if (typeof callback == 'function') callback();
 
-	return vnode ? vnode._component : null;
+	return vnode ? parent._children._component : null;
 }
 
 export function hydrate(vnode, parent, callback) {",I think this is erroneous atm since we'll be returning the fragment,js,1,1,1
"@@ -19,4 +19,6 @@ exports.Date = require('./date');
 
 exports.ObjectId = require('./objectid');
 
+exports.ObjectId = require('./dbref');
+
 exports.Mixed = require('./mixed');",Should be `exports.DBRef` i guess.,js,1,0,1
"@@ -91,7 +91,7 @@ export default function AdsConversionIDTextField() {
 			</TextField>
 
 			<p>
-				{ __( 'Insert your Ads Conversion ID here if you want Site Kit to place the snippet on your site', 'google-site-kit' ) }
+				{ __( 'If you’re using Google Ads, insert your Ads conversion ID if you’d like Site Kit to place the snippet on your site', 'google-site-kit' ) }
 			</p>
 		</div>
 	);","@felixarntz looks like maybe a good place to add a ""Learn more"" link - what do you think?",js,0,1,1
"@@ -1,2 +1,3 @@
 var parent = axe.commons.dom.getComposedParent(node);
-return parent.nodeName.toUpperCase() === 'DL';
+return parent.nodeName.toUpperCase() === 'DL' && !parent.getAttribute('role');
+","Should this allow `<dl role=""list"">`?",js,1,1,1
"@@ -0,0 +1,2 @@
+var mains = document.querySelectorAll('main,[role=main]');
+return mains.length<=1;","As above, use `axe.utils.querySelectorAll` instead, so you can query shadow DOM trees.",js,1,1,1
"@@ -0,0 +1,12 @@
+/**
+ * Restores var names transformed by babel's let block scoping
+ */
+export default (file, api) => {
+	let j = api.jscodeshift;
+	let code = j(file.source);
+
+	code.findVariableDeclarators().filter(d => /^_i/.test(d.value.id.name)).renameTo('i');
+	code.findVariableDeclarators('_key').renameTo('key');
+
+	return code.toSource({ quote: 'single' });
+};","Slight chance this might collide with other variables, right? It's okay if it does, just wasn't sure if it was doing scope analysis to avoid it.",js,1,1,1
"@@ -95,7 +95,7 @@ class Uppy {
       meta: Object.assign({}, this.opts.meta),
       info: {
         isHidden: true,
-        type: '',
+        type: 'info',
         msg: ''
       }
     }",This property name was changed to `message` further down but not here,js,1,1,1
"@@ -19,6 +19,10 @@ function splitString (str, splitIndex) {
 	return [str.substring(0, splitIndex), str.substring(splitIndex)];
 }
 
+function trimRight (str) {
+	return str.replace(/\s+$/, '')
+}
+
 /**
  * Take a relative or absolute URL and pull it into it's indivisual pieces
  *",Use prototype methods - `.trimRight()` or `.trimEnd()`? Need IE Support?,js,1,1,1
"@@ -24,12 +24,16 @@ const test = (suite, buildConfig = config.defaultBuildConfig, options) => {
   config.update(options)
 
   const braveArgs = [
-    '--enable-logging'
+    '--enable-logging=stderr'
   ]
 
   // Android doesn't support --v
   if (config.targetOS !== 'android') {
     braveArgs.push('--v=' + options.v)
+
+    if (options.vmodule) {
+      braveArgs.push('--vmodule=' + options.vmodule)
+    } 
   }
 
   if (options.filter) {",logs are only exposed if test fails,js,1,0,1
"@@ -1122,6 +1122,7 @@ define([""playbackManager"", ""dom"", ""inputManager"", ""datetime"", ""itemHelper"", ""med
                     }
                     break;
                 case ""k"":
+                case ""Space"":
                     playbackManager.playPause(currentPlayer);
                     showOsd();
                     break;","Not directly related to this PR, but why is this K instead of something sensible like P ? (I get that JKL are homerow, next to each other and all, but for discovery by most users, K makes no sense)",js,0,1,1
"@@ -52,12 +52,8 @@ addFilter(
 	fillFilterWithComponent( DashboardZeroData )
 );
 
-let isAdBlockerActive = () => {};
-
 export const registerStore = ( registry ) => {
 	registerDatastore( registry );
-	// TODO: fix hack
-	isAdBlockerActive = () => registry.__experimentalResolveSelect( STORE_NAME ).isAdBlockerActive();
 };
 
 export const registerModule = ( modules ) => {",The `registerStore` function can be re-exported directly from `datastore` now rather than aliasing to add this hack. See other stores for how this looks like.,js,1,1,1
"@@ -43,13 +43,12 @@ describe('valid-lang', function () {
 			assert.deepEqual(checkContext._data, ['lang=""en-FOO""']);
 		});
 
-		it('should return true (and not throw) when given no options', function () {
+		it('should return false (and not throw) when given no options', function () {
 			var node = document.createElement('div');
 			node.setAttribute('lang', 'en-US');
 			fixture.appendChild(node);
 
-			assert.isTrue(checks['valid-lang'].evaluate.call(checkContext, node));
-			assert.deepEqual(checkContext._data, ['lang=""en-US""']);
+			assert.isFalse(checks['valid-lang'].evaluate.call(checkContext, node));
 		});
 
 		it('should return true if the language is badly formatted', function () {",How come the return values changed here?,js,1,1,1
"@@ -1,3 +1,5 @@
+export const root = typeof window === 'undefined' ? global : window;
+
 /** Copy own-properties from `props` onto `obj`.
  *	@returns obj
  *	@private","I was getting ""window is undefined"" errors. I couldn't see a convention around this in the source, though.",js,1,1,1
"@@ -48,9 +48,9 @@ import { Cell, Row } from '../../material-components';
 import { trackEvent } from '../../util';
 const { useSelect, useDispatch } = Data;
 
-export default function UserInputQuestionnaire() {
-	const steps = [ ...USER_INPUT_QUESTIONS_LIST, 'preview' ];
+const steps = [ ...USER_INPUT_QUESTIONS_LIST, 'preview' ];
 
+export default function UserInputQuestionnaire() {
 	const [ activeSlug, setActiveSlug ] = useQueryArg( 'question', steps[ 0 ] );
 	const [ shouldScrollToActiveQuestion, setShouldScrollToActiveQuestion ] = useState( false );
 	const [ redirectURL ] = useQueryArg( 'redirect_url' );",move out of component so does not become a dynamic dependency,js,1,1,1
"@@ -415,7 +415,7 @@ exports[""should correctly connect to mongodb using domain socket""] = {
   // The actual test we wish to run
   test: function(configuration, test) {
     var MongoClient = configuration.require.MongoClient;
-    MongoClient.connect('mongodb:///tmp/mongodb-27017.sock/test', function(err, client) {
+    MongoClient.connect('mongodb://%2Ftmp%2Fmongodb-27017.sock/test', function(err, client) {
       test.equal(null, err);
       test.done();
     });","what's going on here? I don't think its correct that we require users to escape their own local domain socket paths, are you saying it doesn't pass the connection string tests to do so? We might need to file a spec ticket against that then",js,1,1,1
"@@ -190,6 +190,16 @@ Blockly.WorkspaceSvg.prototype.startScrollY = 0;
  */
 Blockly.WorkspaceSvg.prototype.dragDeltaXY_ = null;
 
+/***
+ * Distance to scroll when a mouse wheel event is received and
+ * its delta mode is line (0x1) instead of pixel (0x0). In these
+ * cases, a single ""scroll"" has a delta of 1, which makes the
+ * workspace scroll very slowly (just one pixel). To compensate,
+ * that delta is multiplied by this value.
+ * @type {number}
+ */
+Blockly.WorkspaceSvg.prototype.lineScrollMultiplier = 15;
+
 /**
  * Current scale.
  * @type {number}","Is there a better place to put this constant, or is putting it here right?",js,1,1,1
"@@ -36,7 +36,7 @@ export default AbstractEditController.extend({
 
     showDeleteItem(item) {
       let i18n = get(this, 'i18n');
-      let message = i18n.t('incident.messages.deleteItem');
+      let message = i18n.t('messages.delete_singular', { name: 'item' });
       let title = i18n.t('incident.titles.deleteItem');
       this.displayConfirm(title, message, 'deleteItem', Ember.Object.create({
         itemToDelete: item",This code is passing a non localized string when it should be passing in a localized string or it should use the name of the item being deleted.,js,1,1,1
"@@ -228,6 +228,18 @@ var request = require(""request"");
         options.db.collection(""long_tasks"").findOne({_id:options.id}, callback);
     };
     
+    /**
+    * Edit specific task
+    * @param {object} options - options for the task
+    * @param {object} options.db - database connection
+    * @param {object} options.task_id - ID of the target task 
+    * @param {string} options.data - data of the task want to modify
+    */
+    taskmanager.editTask = function(options, callback){
+        options.db = options.db || common.db;
+        options.db.collection(""long_tasks"").update({_id: options.task_id}, {$set: options.data}, callback);
+    };
+    
     /**
     * Check task's status
     * @param {object} options - options for the task","Let's keep parameter naming consistent with other methods, like `saveResult`, so not task_id, but id, etc",js,1,1,1
"@@ -446,15 +446,14 @@ const reducer = (state = defaultState, action) => {
 			}
 			break;
 
-			// Replace all the notes with the provided array
 		case 'NOTE_UPDATE_ALL':
 			newState = Object.assign({}, state);
 			newState.notes = action.notes;
 			newState.notesSource = action.notesSource;
 			break;
 
-			// Insert the note into the note list if it's new, or
-			// update it within the note array if it already exists.
+		// Insert the note into the note list if it's new, or
+		// update it within the note array if it already exists.
 		case 'NOTE_UPDATE_ONE':
 			{
 				const modNote = action.note;",Also please remove this file.,js,1,0,1
"@@ -154,7 +154,7 @@ module.exports = class Tus extends Plugin {
       }
 
       optsTus.onSuccess = () => {
-        this.uppy.emit('upload-success', file, upload, upload.url)
+        this.uppy.emit('upload-success', file, null, upload.url)
 
         if (upload.url) {
           this.uppy.log('Download ' + upload.file.name + ' from ' + upload.url)",we can drop the upload.urls here and instead pass an object that contains the `uploadURL` like in xhrupload,js,1,1,1
"@@ -574,8 +574,15 @@ define(['appSettings', 'userSettings', 'playbackManager', 'connectionManager', '
 
             events.trigger(instance, ""playbackstop"", [state]);
 
+            var state = instance.lastPlayerData.PlayState || {};
+            var volume = state.VolumeLevel;
+            var mute = state.IsMuted;
+
             // Reset this so the next query doesn't make it appear like content is playing.
             instance.lastPlayerData = {};
+            instance.lastPlayerData.PlayState = {};
+            instance.lastPlayerData.PlayState.VolumeLevel = volume;
+            instance.lastPlayerData.PlayState.IsMuted = mute;
         });
 
         events.on(instance._castPlayer, ""playbackprogress"", function (e, data) {",should we add a default like `|| 0.5`?.. and `false` to `mute`?,js,1,1,1
"@@ -24,7 +24,7 @@ class ChromiumService(service.Service):
     """"""
 
     def __init__(self, executable_path, port=0, service_args=None,
-                 log_path=None, env=None, start_error_message=None):
+                 log_path=None, env=None, start_error_message=None, create_no_window=False):
         """"""
         Creates a new instance of the Service
 ",This would be better served as a method/property that is set when people don't want to a window.,js,1,1,1
"@@ -86,7 +86,7 @@ Mongoose.prototype.STATES = STATES;
  * Currently supported options are:
  * - 'debug': prints the operations mongoose sends to MongoDB to the console
  * - 'bufferCommands': enable/disable mongoose's buffering mechanism for all connections and models
- * - 'useFindAndModify': true by default. Set to `false` to make `findOneAndUpdate()` and `findOneAndRemove()` use native `findOneAndUpdate()` rather than `findAndModify()`.
+ * - 'useFindAndModify': false by default. Set to `true` to make `findOneAndUpdate()` and `findOneAndRemove()` use legacy `findAndModify()` rather than native methods`.
  * - 'cloneSchemas': false by default. Set to `true` to `clone()` all schemas before compiling into a model.
  * - 'applyPluginsToDiscriminators': false by default. Set to true to apply global plugins to discriminator schemas. This typically isn't necessary because plugins are applied to the base schema and discriminators copy all middleware, methods, statics, and properties from the base schema.
  * - 'objectIdGetter': true by default. Mongoose adds a getter to MongoDB ObjectId's called `_id` that returns `this` for convenience with populate. Set this to false to remove the getter.","I'm wary of changing `useFindAndModify` to false by default in a minor release, especially in light of the issue with `overwrite: true` that you found. I was not aware of that difference, which makes me wonder if there are other compatibility concerns that we're missing.",js,1,1,1
"@@ -22,6 +22,7 @@ from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
 
 
 class Options(object):
+    KEY = ""goog:chromeOptions""
 
     def __init__(self):
         self._binary_location = ''",nice touch since Google likes to change things every now and then.,js,1,0,1
"@@ -287,6 +287,10 @@ function operand (self, where, delta, data, val, op) {
   // disabled versioning?
   if (false === self.schema.options.versionKey) return;
 
+  // path excluded from versioning
+  var notVersionedPaths = self.schema.options.notVersionedPaths;
+  if (notVersionedPaths && notVersionedPaths.indexOf(data.path) >= 0) return;
+
   // already marked for versioning?
   if (VERSION_ALL === (VERSION_ALL & self.$__.version)) return;
 ","IMO `notVersionedPaths` should be stored as a map, no sense in storing it as an array if you only use it for lookups",js,1,1,1
"@@ -24,6 +24,8 @@ import isPlainObject from 'lodash/isPlainObject';
 // Export codes and reasons.
 export const ERROR_CODE_MISSING_REQUIRED_SCOPE = 'missing_required_scopes'; // When scopes are missing.
 export const ERROR_REASON_INSUFFICIENT_PERMISSIONS = 'insufficientPermissions';
+export const ERROR_CODE_INSUFFICIENT_MODULE_DEPENDENCIES = 'insufficient_module_dependencies';
+export const ERROR_CODE_ADBLOCKER_ACTIVE = 'adblocker_active';
 
 /**
  * Checks if the provided object is an instance of WP_Error class.","I think it'd be more appropriate to define these in the areas where they're used. The first one could go into `assets/js/googlesitekit/modules/datastore/constants.js`, the latter into a new `assets/js/modules/adsense/constants.js`?",js,1,1,1
"@@ -420,13 +420,12 @@ describe('MongoClient', function() {
       var configuration = this.configuration;
       var MongoClient = configuration.require.MongoClient;
 
-      try {
-        MongoClient.connect('user:password@localhost:27017/test', function(err, client) {
-          client.close();
-        });
-      } catch (err) {
+      MongoClient.connect('user:password@localhost:27017/test', function(err, client) {
+        test.notEqual(err, null);
+        test.notEqual(err, undefined);
         done();
-      }
+        client.close();
+      });
     }
   });
 ",Should `client.close();` happen before `done()`?,js,1,1,1
"@@ -163,4 +163,16 @@ describe('Key', function() {
     });
   });
 
+  describe('bug in linux', function() {
+    it.only('should assign private key properly', function(){
+      var key = new Key();
+      var hex = '00ee983aa0421869418db3c50646728ce67db5a49d6cd853855854ae63fe7bce';
+      var pk = new Buffer(hex, 'hex');
+      pk.toString('hex').should.equal(hex);
+      key.private = pk;
+      key.private.toString('hex').should.equal(hex);
+
+    });
+  });
+
 });","The description here should probably read ""should assign private key starting with 0 properly""",js,1,1,1
"@@ -0,0 +1,3 @@
+module.exports.spliceURL = function spliceURL() {
+  return Array.from(arguments).reduce((lastResult, current) => lastResult + current).replace(/([^:])(\/)+(.)/g, `$1/$3`);
+};",Why use arguments instead normal parameters?,js,1,1,0
"@@ -90,10 +90,11 @@ export const createInfoStore = ( slug, {
                                 return undefined;
                         }
 
-                        const noSetupQueryArgs = ! requiresSetup ? {
-                                notification: 'authentication_success',
-                                reAuth: undefined,
-                        } : {};
+                        const noSetupQueryArgs = {};
+                        if ( ! requiresSetup && reAuth === true ) {
+                                noSetupQueryArgs.notification = 'authentication_success';
+                                noSetupQueryArgs.reAuth = undefined;
+                        }
 
                         const redirectURL = select( storeName ).getAdminScreenURL( { slug, reAuth, ...noSetupQueryArgs } );
                         if ( redirectURL === undefined ) {","If this fixes something that wasn't working properly, please update `create-info-store.test.js`.",js,1,1,1
"@@ -60,6 +60,8 @@ describe('axe.utils.parseCrossOriginStylesheet', function() {
 	});
 
 	it('rejects when given url to fetch is not found', function(done) {
+		this.timeout(6000);
+
 		var importUrl =
 			'https://make-up-a-website-that-does-not-exist.com/style.css';
 		var options = {",Test needs to pass the `preload.timeout` option,js,1,1,1
"@@ -51,7 +51,10 @@ const getConfigFromEnv = () => {
       },
       zoom: {
         key: process.env.COMPANION_ZOOM_KEY,
-        secret: getSecret('COMPANION_ZOOM_SECRET')
+        secret: getSecret('COMPANION_ZOOM_SECRET'),
+        custom: {
+          verificationToken: getSecret('COMPANION_ZOOM_VERIFICATION_TOKEN')
+        }
       },
       s3: {
         key: process.env.COMPANION_AWS_KEY,","`verificationToken` is a required option, right? can we put it on the `zoom` options object itself instead of inside `custom`?",js,1,1,1
"@@ -1,3 +1,19 @@
+function createContentHidden() {
+	'use strict';
+	var group = document.createElement('div');
+	group.innerHTML = '<label id=""mylabel"">Label</label><input aria-labelledby=""mylabel"" type=""text"" />';
+	return group;
+}
+
+function makeShadowTreeHidden(node) {
+	'use strict';
+	var root = node.attachShadow({mode: 'open'});
+	var div = document.createElement('div');
+	div.className = 'parent';
+	root.appendChild(div);
+	div.appendChild(createContentHidden());
+}
+
 describe('axe.utils.isHidden', function () {
 	'use strict';
 ","What makes this tree hidden? I don't see any special CSS that would hide it, or a closed mode. I do see `display: none` in the test, perhaps it's just a confusing function name?",js,1,1,1
"@@ -47,6 +47,12 @@ module Selenium
           @bridge.send_command(cmd: cmd, params: params)
         end
 
+        def print_page(**options)
+          options[:page_ranges] &&= Array(options[:page_ranges])
+
+          bridge.print_page(options)
+        end
+
         private
 
         def debugger_address",the bridge here isn't defined as an accessor / reader to try mask it better. So you need to directly call the iVar `@bridge` here.,js,1,1,1
"@@ -35,6 +35,12 @@ export default AuthenticatedRoute.extend(styleBody, CurrentUserSettings, Paginat
                 });
             }
 
+            // we need to load the roles into ember cache
+            // invites return role_id only and we do not offer a /role/:id endpoint
+            modelPromises.roles = this.get('store').query('role', {permissions: 'assign'}).then((roles) => {
+                return roles;
+            });
+
             return RSVP.hash(modelPromises);
         });
     },",Is the `{permissions: 'assign'}` needed here? It would be preferable to load all roles so that the role of team members can be displayed even if the current user doesn't have permission to assign those roles to new users.,js,1,1,1
"@@ -76,6 +76,7 @@ storiesOf( 'Analytics Module/Settings', module )
 		decorators: [
 			withRegistry,
 		],
+		padding: 0,
 	} )
 	.add( 'View, open with all settings', ( args, { registry } ) => {
 		registry.dispatch( STORE_NAME ).receiveGetSettings( {",Same with the settings. We need to use the default padding for all settings stories in all modules.,js,1,1,1
"@@ -27,7 +27,11 @@ describe('Sessions', function() {
   });
 
   it('should send endSessions for multiple sessions', {
-    metadata: { requires: { topology: ['single'], mongodb: '>3.6.0-rc0' } },
+    metadata: {
+      requires: { topology: ['single'], mongodb: '>3.6.0-rc0' },
+      // Skipping session leak tests b/c these are explicit sessions
+      sessions: { skipLeakTests: true }
+    },
     test: function(done) {
       var client = this.configuration.newClient({ w: 1 }, { poolSize: 1, auto_reconnect: false });
       client.connect((err, client) => {",what is the second command that's started here?,js,1,1,1
"@@ -64,10 +64,10 @@ function assertArity(args, requiredArity) {
  * @param {object} [validationOptions] Options for the validation itself.
  * @param {Logger} [validationOptions.logger] A logger instance to use if validation fails.
  * @param {string} [validationOptions.optionsValidationLevel] The level at which to validate the providedOptions ('none', 'warn', or 'error').
- * @param {boolean} [warnOnUnknownOptions=false] If true, warn on any option that is not in the schema.
+ * @param {string} [validationOptions.unknownOptionsWarningLevel] The level at which to handle unknown options ('none', 'warn', or 'error').
  * @return {object} returns a frozen object of validated options
  */
-function validate(optionsSchema, providedOptions, validationOptions, warnOnUnknownOptions) {
+function validate(optionsSchema, providedOptions, validationOptions) {
   let optionsValidationLevel = VALIDATION_LEVEL_WARN;
   let logger;
 ",The changes in `options_validator` supersede the changes in #1898. I can separate these changes out into a different PR if that would be better for readability and commit history.,js,0,1,1
"@@ -272,7 +272,7 @@ function* webpackConfig( env, argv ) {
 		},
 		plugins: [
 			new ProvidePlugin( {
-				React: 'react',
+				React: '@wordpress/element',
 			} ),
 			new WebpackBar( {
 				name: 'Module Entry Points',","Is this needed? I removed it and everything still built fine. It's minor, and I know it _is_ needed in the Jest tests and in Storybook, but maybe we should remove it here.",js,1,1,1
"@@ -125,8 +125,8 @@ function generateTopologyTests(testSuites, testContext, filter) {
       describe(suiteName, {
         metadata: { requires },
         test: function () {
-          beforeEach(() => prepareDatabaseForSuite(testSuite, testContext));
-          afterEach(() => testContext.cleanupAfterSuite());
+          // beforeEach(() => );
+          // afterEach();
 
           testSuite.tests.forEach(spec => {
             it(spec.description, function () {","hm this looks wrong, did you meant to revert?",js,1,1,1
"@@ -290,11 +290,11 @@ export default Controller.extend(SettingsMenuMixin, {
          * Action sent by post settings menu view.
          * (#1351)
          */
-        setPublishedAt(userInput) {
+        setPublishedAtUTC(userInput) {
             if (!userInput) {
-                // Clear out the publishedAt field for a draft
+                // Clear out the publishedAtUTC field for a draft
                 if (this.get('model.isDraft')) {
-                    this.set('model.publishedAt', null);
+                    this.set('model.publishedAtUTC', null);
                 }
                 return;
             }","This may be a little confusing as we get date from `parseDateString` that is actually in the blog's timezone, not in UTC. We actually convert it into UTC further down on line 319. I would suggest two variables here, one that holds the blog-timezone value and one that holds the UTC value.",js,1,1,1
"@@ -23,7 +23,7 @@ const resolve = (list, child, node) => {
 		// mark the child as completely resolved by deleting it from ._map.
 		// This is used to figure out when *all* children have been completely
 		// resolved when revealOrder is 'together'.
-		list._map.delete(child);
+		list._map.delete(child._node);
 	}
 
 	// If revealOrder is falsy then we can do an early exit, as the","Something is wrong here, since we'll only delete one and the second one isn't present in the _map (wrong ref?)",js,1,1,1
"@@ -422,8 +422,7 @@ module.exports = class ProviderView {
 
   handleAuth () {
     const authState = btoa(JSON.stringify({ origin: getOrigin() }))
-    // @todo remove this hardcoded version
-    const clientVersion = encodeURIComponent('@uppy/companion-client=1.0.2')
+    const clientVersion = encodeURIComponent(`@uppy/companion-client=${ProviderView.VERSION}`)
     const link = `${this.provider.authUrl()}?state=${authState}&uppyVersions=${clientVersion}`
 
     const authWindow = window.open(link, '_blank')",Hmm this should've been `@uppy/provider-views` I guess! Can we still change it now with back compat or will we just have to suck it up? :P,js,1,1,0
"@@ -281,6 +281,9 @@ class Application extends BaseApplication {
 
 		if (['NOTE_VISIBLE_PANES_TOGGLE', 'NOTE_VISIBLE_PANES_SET'].indexOf(action.type) >= 0) {
 			Setting.setValue('noteVisiblePanes', newState.noteVisiblePanes);
+			const viewer = newState.noteVisiblePanes[0];
+			this.updateMenuItemStates(viewer);
+
 		}
 
 		if (['SIDEBAR_VISIBILITY_TOGGLE', 'SIDEBAR_VISIBILITY_SET'].indexOf(action.type) >= 0) {",unnecessary white space on 286,js,1,1,1
"@@ -198,9 +198,11 @@ export function initDebug() {
 	};
 
 	options.diffed = (vnode) => {
+		if (oldDiffed) oldDiffed(vnode);
+
 		if (vnode._component && vnode._component.__hooks) {
 			let hooks = vnode._component.__hooks;
-			hooks._list.forEach(hook => {
+			(hooks._list || []).forEach(hook => {
 				if (hook._callback && (!hook._args || !Array.isArray(hook._args))) {
 					/* istanbul ignore next */
 					console.warn(",Moving this up top ensures the call for the older one first.,js,1,1,1
"@@ -89,7 +89,14 @@ Query.prototype.bind = function bind (model, op, updateArg) {
   this.op = op;
 
   if (op == 'update' || op == 'findOneAndUpdate') {
-    merge(this._updateArg, updateArg || {});
+    // allow update to be a Document
+    if(updateArg instanceof Document) {
+      updateArg = updateArg.toObject();
+      delete updateArg._id;
+      merge(this._updateArg, updateArg);
+    } else {
+      merge(this._updateArg, updateArg || {});
+    }
   }
 
   return this;",why are we deleting the _id?,js,1,0,1
"@@ -16,9 +16,16 @@ module.exports = function(environment) {
     APP: {
       // Here you can pass flags/options to your application instance
       // when it is created
+    },
+
+    'simple-auth': {
+
+    },
+    'ember-cli-mirage': {
+      enabled: false
     }
   };
-    
+
 ENV.APP.manifest = {
   enabled: true,
   appcacheFile: ""/manifest.appcache"",",remanent of cli mirage.,js,1,0,0
"@@ -294,6 +294,13 @@ Query.prototype.cast = function (model, obj) {
               continue;
             }
 
+            if ('$regex' === $cond) {
+              if ('RegExp' !== nested.constructor.name) {
+                throw new Error(""$type parameter must be RegExp"");
+              }
+              continue;
+            }
+
             if ('$not' === $cond) {
               this.cast(model, nested);
             } else {",we should probably cast strings to regexps here.,js,1,0,1
"@@ -1,5 +1,5 @@
 module.exports = {
-  extends: ['airbnb-base', 'plugin:vue/base'],
+  extends: ['airbnb-base'],
   parser: '@babel/eslint-parser',
   plugins: [
     '@babel',","Plugin `plugin:vue/base` (`eslint-plugin-vue`) looks to be no used anymore, did you uninstall with (--save) it?",js,1,1,1
"@@ -118,13 +118,6 @@ define(['apphost', 'globalize', 'connectionManager', 'itemHelper', 'appRouter',
             });
         }
 
-        if (itemHelper.canConvert(item, user, connectionManager.getApiClient(item))) {
-            commands.push({
-                name: globalize.translate('Convert'),
-                id: 'convert'
-            });
-        }
-
         if (item.CanDelete && options.deleteItem !== false) {
 
             if (item.Type === 'Playlist' || item.Type === 'BoxSet') {","hmm, are you sure we have to remove this?",js,1,0,1
"@@ -142,6 +142,7 @@ module.exports = class DragDrop extends Plugin {
     const restrictions = this.uppy.opts.restrictions
     return (
       <input
+        id={'uppy-input-' + this.id}
         class=""uppy-DragDrop-input""
         type=""file""
         tabindex={-1}",we might want to do `this.uppy.id + this.id` in case someone has two instances of uppy with drag-drop,js,1,1,1
"@@ -201,7 +201,7 @@ TransactionBuilder.prototype._setInputMap = function() {
     var scriptType = scriptPubKey.classify();
 
     if (scriptType === Script.TX_UNKNOWN)
-      throw new Error('unkown output type at:' + i +
+      throw new Error('Unknown script pubkey type at:' + i +
         ' Type:' + scriptPubKey.getRawOutType());
 
     inputMap.push({","I would say 'Unknown scriptPubKey', which is not the same as 'Unkown script pubkey'",js,1,1,1
"@@ -1348,6 +1348,13 @@ Blockly.WorkspaceSvg.prototype.zoomCenter = function(type) {
   var metrics = this.getMetrics();
   var x = metrics.viewWidth / 2;
   var y = metrics.viewHeight / 2;
+  if (this.options.toolboxPosition == Blockly.TOOLBOX_AT_LEFT) {
+    x = x + 250;
+  } else if (this.options.toolboxPosition == Blockly.TOOLBOX_AT_RIHT) {
+    x = x + 250;
+  } else if (this.options.toolboxPosition == Blockly.TOOLBOX_AT_TOP) {
+    y = y + 158;
+  }
   this.zoom(x, y, type);
 };
 ",Looks like there's a typo for `TOOLBOX_AT_RIGHT` here.,js,1,1,1
"@@ -108,10 +108,11 @@ module Selenium
 
         def initialize(source, duration, x, y, element: nil, origin: nil)
           super(source)
+
           @duration = duration * 1000
           @x_offset = x
           @y_offset = y
-          @origin = element || origin
+          @origin = origin || POINTER
         end
 
         def type",Should be `@origin = element || origin || POINTER`,js,1,0,1
"@@ -414,7 +414,7 @@ class Uppy {
       throttledCalculateProgress(data)
     })
 
-    this.on('core:upload-success', (fileID, uploadResp, uploadURL) => {
+    this.on('core:upload-success', (fileID, uploadURL) => {
       const updatedFiles = Object.assign({}, this.getState().files)
       const updatedFile = Object.assign({}, updatedFiles[fileID], {
         progress: Object.assign({}, updatedFiles[fileID].progress, {","I think someone specifically asked for a full response object, and it makes sense. Is this removing uploadResp, or am I missing something?",js,1,1,1
"@@ -1,4 +1,14 @@
-var parent = axe.commons.dom.getComposedParent(node);
-return (['UL', 'OL'].includes(parent.nodeName.toUpperCase()) ||
-    (parent.getAttribute('role') || '').toLowerCase() === 'list');
-  
+const parent = axe.commons.dom.getComposedParent(node);
+
+if (!parent) {
+	return false;
+}
+
+const ALLOWED_TAGS = ['ul', 'ol'];
+const ALLOWED_ROLES = ['list'];
+
+const parentTagName = parent.nodeName.toLowerCase();
+const parentRole = (parent.getAttribute('role') || '').toLowerCase();
+const isListRole = (ALLOWED_ROLES.includes(parentRole));
+
+return ((ALLOWED_TAGS.includes(parentTagName) && (!parentRole || isListRole)) ||isListRole);",filter roles to only accept valid ARIA roles,js,1,1,1
"@@ -46,12 +46,12 @@ describe( 'trackAPIError', () => {
 				code: 'test-error-code',
 			},
 		} );
-		expect( dataLayerPushSpy ).toHaveBeenCalledTimes( 1 );
+		expect( dataLayerPushSpy ).toHaveBeenCalledTimes( 3 );
 		const [
 			event,
 			eventName,
 			eventData,
-		] = dataLayerPushSpy.mock.calls[ 0 ][ 0 ];
+		] = dataLayerPushSpy.mock.calls[ 2 ][ 0 ];
 		expect( event ).toEqual( 'event' );
 		expect( eventName ).toEqual(
 			'test-method:test-type/test-identifier/data/test-datapoint'",@ivankruchkoff this looks unexpected. Why would more events tracked be expected here?,js,0,1,1
"@@ -27,6 +27,16 @@ export function initDebug() {
 			);
 		}
 
+		Object.keys(vnode.props).forEach((key) => {
+			if (key[0]==='o' && key[1]==='n' && typeof vnode.props[key]!=='function') {
+				throw new Error(
+					`Component's ""${key}"" property should be a function,
+					but got [${typeof vnode.props[key]}] instead\n` +
+					serializeVNode(vnode)
+				);
+			}
+		});
+
 		// Check prop-types if available
 		if (typeof vnode.type==='function' && vnode.type.propTypes) {
 			checkPropTypes(vnode.type.propTypes, vnode.props, getDisplayName(vnode), serializeVNode(vnode));","Kind off afraid about the performance impact of this, since `Object.keys` iterates over the object and then we iterate over that created array. If this happens on every rerender...",js,1,1,0
"@@ -38,6 +38,9 @@ try:
 except NameError:
     pass
 
+if sys.version > '3':
+    long = int
+
 
 class WebElement(object):
     """"""Represents a DOM element.",Should be `if sys.version_info[0] > 2:`,js,1,0,1
"@@ -12,6 +12,14 @@ const { _ } = require('lib/locale.js');
 const http = require('http');
 const https = require('https');
 const toRelative = require('relative');
+const { Database } = require('lib/database.js');
+
+let keytar;
+try {
+	keytar = require('keytar');
+} catch (err) {
+	keytar = null;
+}
 
 function shimInit() {
 	shim.fsDriver = () => {",`keytar` is installed and always available so no need for a try/catch block,js,1,1,1
"@@ -35,6 +35,8 @@ import { createElement, Fragment } from '@wordpress/element';
  *
  * @param {Component} NewComponent The new component to append to the filtered component.
  *
+ * @return {ReactElement} Filtered component with appended component.
+ *
  */
 export const createAddToFilter = ( NewComponent ) => {
 	return ( OriginalComponent ) => {","I believe we should be using `WPElement` instead since React is essentially provided through we're using `@wordpress/element`, but I'm not 100% sure about that now that we're using our own bundles. @tofumatt ?",js,1,1,1
"@@ -477,7 +477,7 @@ class Uppy {
   retryAll () {
     const updatedFiles = Object.assign({}, this.getState().files)
     const filesToRetry = Object.keys(updatedFiles).filter(file => {
-      return updatedFiles[file].error
+      return updatedFiles[file].error.message
     })
 
     filesToRetry.forEach((file) => {","Should we be checking if `error.message` exists first? What if string is returned from somewhere? Though I think we have an Eslint rule for that now, an extra check would not be too bad?",js,1,1,1
"@@ -315,7 +315,17 @@ function diffAttributes(dom, attrs, old) {
 	// add new & update changed attributes
 	if (attrs) {
 		for (let name in attrs) {
-			if (name!=='children' && name!=='innerHTML' && (!(name in old) || attrs[name]!==(name==='value' || name==='checked' ? dom[name] : old[name]))) {
+			if (
+				name!=='children' &&  // break if attributeName is children
+				name!=='innerHTML' &&  // break if attributeName is innerHTML
+				(
+					( name=== 'dangerouslySetInnerHTML' ) || // continue if attributeName is dangerouslySetInnerHTML
+					(
+						!(name in old) ||  // continue if attr doesn't exists
+						attrs[name] !== (name==='value' || name==='checked' ? dom[name] : old[name]) // continue if attr is different
+					)
+				)
+			) {
 				setAccessor(dom, name, old[name], old[name] = attrs[name], isSvgMode);
 			}
 		}",This line is the essence of PR #454,js,0,1,1
"@@ -25,3 +25,4 @@ class ChromeRemoteConnection(RemoteConnection):
         self._commands[""launchApp""] = ('POST', '/session/$sessionId/chromium/launch_app')
         self._commands[""setNetworkConditions""] = ('POST', '/session/$sessionId/chromium/network_conditions')
         self._commands[""getNetworkConditions""] = ('GET', '/session/$sessionId/chromium/network_conditions')
+        self._commands['ExecuteCDP'] = ('POST', '/session/$sessionId/goog/cdp/execute')",Should this be camelCase to match the above commands? I am not the expert here so maybe Lucas or David can chime in.,js,0,1,1
"@@ -13,14 +13,16 @@ define(['apphost', 'globalize', 'connectionManager', 'itemHelper', 'appRouter',
             if (options.play !== false) {
                 commands.push({
                     name: globalize.translate('Play'),
-                    id: 'resume'
+                    id: 'resume',
+                    icon: ""play_arrow""
                 });
             }
 
             if (options.playAllFromHere && item.Type !== 'Program' && item.Type !== 'TvChannel') {
                 commands.push({
                     name: globalize.translate('PlayAllFromHere'),
-                    id: 'playallfromhere'
+                    id: 'playallfromhere',
+                    icon: ""play_arrow""
                 });
             }
         }",can we use consistent quotes please (here and in other places)?,js,1,1,1
"@@ -214,6 +214,14 @@ define(['browser'], function (browser) {
                 break;
             case 'avi':
                 supported = browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;
+                // New Samsung TV don't support XviD/DivX
+                if (browser.tizen) {
+                    videoCodecs.push('h264');
+                    if (canPlayH265(videoTestElement, options)) {
+                        videoCodecs.push('h265');
+                        videoCodecs.push('hevc');
+                    }
+                }
                 break;
             case 'mpg':
             case 'mpeg':",Why not just remove Tizen from the `supported` variable?,js,1,1,1
"@@ -119,7 +119,6 @@ const validOptions = require('./operations/connect').validOptions;
  * @param {number} [options.bufferMaxEntries=-1] Sets a cap on how many operations the driver will buffer up before giving up on getting a working connection, default is -1 which is unlimited
  * @param {(ReadPreference|string)} [options.readPreference] The preferred read preference (ReadPreference.PRIMARY, ReadPreference.PRIMARY_PREFERRED, ReadPreference.SECONDARY, ReadPreference.SECONDARY_PREFERRED, ReadPreference.NEAREST)
  * @param {object} [options.pkFactory] A primary key factory object for generation of custom _id keys
- * @param {object} [options.promiseLibrary] A Promise library class the application wishes to use such as Bluebird, must be ES6 compatible
  * @param {object} [options.readConcern] Specify a read concern for the collection (only MongoDB 3.2 or higher supported)
  * @param {ReadConcernLevel} [options.readConcern.level='local'] Specify a read concern level for the collection operations (only MongoDB 3.2 or higher supported)
  * @param {number} [options.maxStalenessSeconds=undefined] The max staleness to secondary reads (values under 10 seconds cannot be guaranteed)","At very least we should throw some warning when users try to do this, otherwise we might silently break user expectations. I think it's probably fine to still support `promiseLibrary` at the `MongoClient` level, and that option just internally sets the ""provided"" Promise",js,1,1,1
"@@ -278,7 +278,7 @@ export const createSettingsStore = ( type, identifier, datapoint, {
 		 * @return {Object} Redux-style action.
 		 */
 		actions[ `set${ pascalCaseSlug }` ] = ( value ) => {
-			invariant( typeof value !== 'undefined', 'value is required.' );
+			invariant( typeof value !== 'undefined', `value is required for calls to set${ pascalCaseSlug }().` );
 
 			return {
 				payload: { value },","I added this to assist in debugging; because these method names are dynamically generated, this makes it a lot easier to discover which method is throwing the error, which at first made narrowing down the `invariant` call cumbersome.",js,1,1,1
"@@ -372,7 +372,7 @@ define([""dom"", ""browser"", ""layoutManager""], function (dom, browser, layoutManage
      */
     function useSmoothScroll() {
 
-        if (browser.tizen) {
+        if (browser.tizen || browser.web0s || browser.firefox || browser.chrome) {
             return true;
         }
 ","I know lots of people don't like smooth scroll, so we can't just enable it everywhere by default.",js,1,1,1
"@@ -1,5 +1,11 @@
 /*global dom */
 
+/**
+ * Finds the first Element with the given attribute
+ * @param {Element} node
+ * @param {String} attr Attribute name
+ * @return {Element}
+ */
 dom.getElementByReference = function (node, attr) {
 	let fragment = node.getAttribute(attr);
 ",not enough of a description to understand what the function is really doing,js,1,1,1
"@@ -107,7 +107,7 @@ define([""globalize"", ""dom"", ""emby-checkbox"", ""emby-select"", ""emby-input""], funct
         if (!plugins.length) return html;
 
         html += '<div class=""metadataFetcher"" data-type=""' + availableTypeOptions.Type + '"">';
-        html += '<h3 class=""checkboxListLabel"">' + globalize.translate(""LabelTypeMetadataDownloaders"", availableTypeOptions.Type) + ""</h3>"";
+        html += '<h3 class=""checkboxListLabel"">' + globalize.translate(""LabelTypeMetadataDownloaders"", globalize.translate(availableTypeOptions.Type)) + ""</h3>"";
         html += '<div class=""checkboxList paperList checkboxList-paperList"">';
         for (var i = 0; i < plugins.length; i++) {
             var plugin = plugins[i];",This does not look right...,js,1,0,1
"@@ -455,6 +455,9 @@ class Realm {
  *   This is not supported for `""list""` properties of object types and `""linkingObjects""` properties.
  * @property {boolean} [indexed] - Signals if this property should be indexed. Only supported for
  *   `""string""`, `""int""`, and `""bool""` properties.
+ * @property {string} [alias] - an alias in JavaScript for the underlying name in the Realm file. If set, this must be
+ *   used when reading/writing the property or making queries against it. Trying to use the internal name will throw
+ *   an exception.
  */
 
 /**","""internal name"" might be a little unclear here. Maybe ""underlying name"" is better.",js,1,1,1
"@@ -165,7 +165,7 @@ Audit.prototype.run = function (context, options, resolve, reject) {
 							result: axe.constants.CANTTELL,
 							description: 'An error occured while running this rule',
 							message: err.message,
-							help: err.stack || err.message,
+							stack: err.stack,
 							error: err
 						});
 						res(errResult);","Does anything depend on `help` being a part of this object, or was that just for manual debugging info?",js,1,1,1
"@@ -0,0 +1,18 @@
+package org.openqa.selenium;
+
+/**
+ * Created by James Reed on 11/04/2016.
+ * Thrown to indicate that a click was attempted on an element but was intercepted by another
+ * element on top of it
+ */
+public class InterceptingElementException extends InvalidElementStateException {
+
+  public InterceptingElementException(String message) {
+    super(message);
+  }
+
+  public InterceptingElementException(String message, Throwable cause) {
+    super(message, cause);
+  }
+
+}",We keep who wrote the code anonymous.,js,1,0,1
"@@ -66,15 +66,9 @@ const groupFunction =
  * @param {Collection~bulkWriteOpCallback} [callback] The command result callback
  */
 function bulkWrite(coll, operations, options, callback) {
-  // Add ignoreUndfined
-  if (coll.s.options.ignoreUndefined) {
-    options = Object.assign({}, options);
-    options.ignoreUndefined = coll.s.options.ignoreUndefined;
-  }
-
   // Create the bulk operation
   const bulk =
-    options.ordered === true || options.ordered == null
+    options.ordered === true
       ? coll.initializeOrderedBulkOp(options)
       : coll.initializeUnorderedBulkOp(options);
 ",Want to double check: this was done b/c we will always have a default value of `ordered: true` unless otherwise specified?,js,1,1,1
"@@ -31,6 +31,12 @@ class DashboardModal extends React.Component {
     } else if (!prevProps.open && this.props.open) {
       this.plugin.openModal()
     }
+
+    for (const key of Object.keys(this.props)) {
+      if (this.props[key] !== prevProps[key] && key in this.plugin.opts) {
+        this.plugin[key] = this.props[key]
+      }
+    }
   }
 
   componentWillUnmount () {",Are we sure we want to do this for everything? This may have unexpected consequences in the future. Perhaps it's better to just explicitly update the value in question.,js,1,1,1
"@@ -84,7 +84,7 @@ class GhostTable {
    * Add a row consisting of the column headers.
    */
   addColumnHeadersRow(samples) {
-    if (this.hot.getColHeader(0) != null) {
+    if (this.hot.getColHeader(0) !== null && this.hot.getColHeader(0) !== void 0) {
       const rowObject = {row: -1};
       this.rows.push(rowObject);
 ","Could you cache result of the `this.hot.getColHeader(0)` method? This prevents firing `""modifyColHeader""` and `""modifyCol""` hooks twice for the same column index.",js,1,1,1
"@@ -1515,6 +1515,13 @@ Collection.prototype.findOneAndReplace = function(filter, replacement, options,
   if (replacement == null || typeof replacement !== 'object')
     throw toError('replacement parameter must be an object');
 
+  // Check that there are no atomic operators
+  const keys = Object.keys(replacement);
+
+  if (keys[0][0] === '$') {
+    throw toError('The replacement document must not contain atomic operators.');
+  }
+
   return executeOperation(this.s.topology, findOneAndReplace, [
     this,
     filter,",if `keys[0][0]` guaranteed to always exist? Won't this throw an exception if someone accidentally passes in an empty object for `replacement`?,js,1,1,1
"@@ -13,7 +13,7 @@ describe('has-visible-text', function() {
   });
 
   it('should return false if there is no visible text', function() {
-    var params = checkSetup('<object id=""target""></object>');
+    var params = checkSetup('<p id=""target""></p>');
     assert.isFalse(
       axe.testUtils
         .getCheckEvaluate('has-visible-text')",Don't know why we did that. Clearly that's wrong.,js,1,1,1
"@@ -20,6 +20,8 @@
  * External dependencies
  */
 import invariant from 'invariant';
+import mapValues from 'lodash/mapValues';
+import memize from 'memize';
 
 /**
  * WordPress dependencies","Note that while `memize` was added to `package.json`, it's already a dependency of `@wordpress/data` so this just makes it safe to use without really adding anything to the bundle.",js,1,1,1
"@@ -118,7 +118,8 @@ export function setProperty(dom, name, value, oldValue, isSvg) {
 			name in dom
 		) {
 			try {
-				dom[name] = value == null ? '' : value;
+				const newValue = value == null ? '' : value;
+				if (dom[name] !== newValue) dom[name] = newValue;
 				// labelled break is 1b smaller here than a return statement (sorry)
 				break o;
 			} catch (e) {}","On a side note, this is a bug fix. I noticed this in my debugging sessions. For whatever reason, preact is setting the class name in dom even though it is identical and that causes a layout shift. This fixes it.",js,1,1,1
"@@ -480,6 +480,12 @@ plugins.setConfigs(""crashes"", {
                                 }];
                                 plugins.dispatch(""/plugins/drill"", {params: params, dbAppUser: dbAppUser, events: events});
 
+                                const hooksData = {
+                                    params: {...params}
+                                };
+                                hooksData.params.qstring.events = events;
+                                plugins.dispatch(""/hooks/incoming_data"", hooksData);
+
 
                                 const processCrash = function(userAll) {
                                     var groupSet = {};","Hello, instead of having a separate event for incoming data, maybe hooks can reuse this event that we already have and all future manual events will use it to write data to drill either way :)",js,1,1,1
"@@ -88,7 +88,7 @@ public class Docker {
 
     findImage(new ImageNamePredicate(name, tag));
 
-    LOG.info(String.format(""Pulling %s:%s"", name, tag));
+    LOG.finest(String.format(""Pulling %s:%s"", name, tag));
 
     HttpRequest request = new HttpRequest(POST, ""/images/create"");
     request.addQueryParameter(""fromImage"", name);",This will always need to be displayed to users.,js,1,1,1
"@@ -271,6 +271,10 @@ class Connection extends EventEmitter {
 
       // Iterate over all buffers and write them in order to the socket
       for (let i = 0; i < buffer.length; i++) {
+        this.socket.on('error', function(){
+          console.log(""CLIENT HAS ERRORED"");
+          break;
+        });
         this.socket.write(buffer[i], 'binary');
       }
 ",This will add an error listener per buffer in the BufferList passed to write and the break on line 276 won't have an effect on the synchronous for loop as the socket can emit the error event at a time later than when the loop is run.,js,1,1,1
"@@ -30,7 +30,7 @@ export const refreshAuthentication = async () => {
 			requiredScopes,
 			grantedScopes,
 			unsatisfiedScopes = [],
-		} = await data.get( TYPE_CORE, 'user', 'authentication', { timestamp: Date.now() } );
+		} = await data.get( TYPE_CORE, 'user', 'authentication' );
 
 		// We should really be using state management. This is terrible.
 		// Hang in there... we're getting to it ;)",This one can't be removed because it doesn't use `siteKitRequest` internally.,js,1,1,1
"@@ -46,8 +46,17 @@ function getFiles (store) {
   })
 }
 
+function probe (event) {
+  sendMessageToAllClients({
+    type: 'uppy/HERE_I_AM'
+  })
+}
+
 self.addEventListener('message', (event) => {
   switch (event.data.type) {
+    case 'uppy/PROBE':
+      probe()
+      break
     case 'uppy/ADD_FILE':
       addFile(event.data.store, event.data.file)
       break","MDN said something about using `clients.get(event.clientId)` to only send the message back to the sender, but `clientId` was undefined for me--i guess that's why we were sending the `uppy/ALL_FILES` message to all clients too.",js,1,1,1
"@@ -2588,7 +2588,7 @@ describe('Operation (Promises)', function () {
    * @example-class Db
    * @example-method collection
    */
-  it('shouldCorrectlyAccessACollectionWithPromises', {
+  it.skip('shouldCorrectlyAccessACollectionWithPromises', {
     metadata: { requires: { topology: ['single'] } },
 
     test: function (done) {",why is this test being skipped?,js,1,0,1
"@@ -230,6 +230,7 @@ const defaultReplacements = [
   [/Chrome/g, 'Brave'],
   [/Google LLC. All rights reserved./g, 'The Brave Authors. All rights reserved.'],
   [/Google/g, 'Brave'],
+  [/Brave Safe Browsing/g, 'Google Safe Browsing'],
   [/You're incognito/g, 'This is a private window'],
   [/an incognito/g, 'a private'],
   [/an Incognito/g, 'a Private'],","This could probably be merged with the previous rule using negative-look-ahead, e.g. `Google(?! Safe Browsing?)`. But it could be argued this way is more readable, so I'm ok with it.",js,1,1,1
"@@ -29,7 +29,17 @@ export function initDebug() {
 		let children = props && props.children;
 
 		if (type===undefined) {
-			throw new Error('Undefined component passed to createElement()\n'+serializeVNode(vnode));
+			throw new Error('Undefined component passed to createElement()\n\n'+
+			'You likely forgot to export your component or might have mixed up default and named imports'+
+			serializeVNode(vnode));
+		}
+		else if (type!=null && typeof type==='object') {
+			if (type._lastDomChild!==undefined && type._dom!==undefined) {
+				let info = 'Did you accidentilly passed a JSX Literal as JSX twice?';
+				throw new Error('Invalid type passed to createElement(): '+type+'\n\n'+info+'\n\n'+serializeVNode(type));
+			}
+
+			throw new Error('Invalid type passed to createElement(): '+(Array.isArray(type) ? 'array' : type));
 		}
 
 		if (",I think this should be `accidentally`,js,1,1,1
"@@ -47,6 +47,10 @@ public interface CapabilityType {
   String HAS_TOUCHSCREEN = ""hasTouchScreen"";
   String OVERLAPPING_CHECK_DISABLED = ""overlappingCheckDisabled"";
   String STRICT_FILE_INTERACTABILITY = ""strictFileInteractability"";
+  String TIMEOUTS = ""timeouts"";
+  String IMPLICIT_TIMEOUT = ""implicit"";
+  String PAGE_LOAD_TIMEOUT = ""pageLoad"";
+  String SCRIPT_TIMEOUT = ""script"";
 
   String LOGGING_PREFS = ""loggingPrefs"";
 ","These are really meant to be the keys in the capabilities, not the keys of values within the capabilities",js,1,1,1
"@@ -401,8 +401,11 @@ function ($timeout, gridUtil, uiGridConstants, uiGridColumnMenuService, $documen
           $scope.hideMenu( true );
 
           if ($scope.col) {
-            //Focus on the menu button
-            gridUtil.focus.bySelector($document, '.ui-grid-header-cell.' + $scope.col.getColClass()+ ' .ui-grid-column-menu-button', $scope.col.grid, false);
+            //Focus on the menu button if this is shown, otherwise focus the column header
+            var elementToFocus = '.ui-grid-header-cell.' + $scope.col.getColClass();
+            elementToFocus += ($scope.grid.options.showColumnMenuButtons && $scope.col.colDef.showColumnMenuButton !== false)? 
+              ' .ui-grid-column-menu-button' : ' .ui-grid-header-cell-primary-focus';
+            gridUtil.focus.bySelector($document, elementToFocus, $scope.col.grid, false);
           }
         }
       });","This is redundant. if $scope.grid.options.showColumnMenuButton returns truthy, then it is obviously different than false. You only need one of these checks.",js,1,1,1
"@@ -13,13 +13,16 @@ import options from './options';
  */
 export function render(vnode, parentDom, replaceNode) {
 	if (options._root) options._root(vnode, parentDom);
-	let oldVNode = parentDom._children;
+	let oldVNode = replaceNode ?
+		replaceNode._children || parentDom._children :
+		parentDom._children;
+
 	vnode = createElement(Fragment, null, [vnode]);
 
 	let mounts = [];
 	diff(
 		parentDom,
-		replaceNode ? vnode : (parentDom._children = vnode),
+		replaceNode ? (replaceNode._children = vnode) : (parentDom._children = vnode),
 		oldVNode || EMPTY_OBJ,
 		EMPTY_OBJ,
 		parentDom.ownerSVGElement !== undefined,","This `||` is needed for the case when we first did `render(x, y, undefined)` and transition to a render with replaceNode. The second is needed for when we use replaceNode twice in a row.",js,1,1,1
"@@ -20,10 +20,10 @@
  * A single module. Keeps track of its own active state and settings.
  */
 
-function Spinner( { isSaving } ) {
+function Spinner( { isSaving, className } ) {
 	return (
 		<span
-			className=""spinner""
+			className={ [ 'spinner', className ].join( ' ' ) }
 			style={ {
 				display: ( isSaving ? 'inline-block' : 'none' ),
 				float: 'none',",Please use the `classnames` package for dynamic class names. We already use it in many places and is our go-to utility for this kind of thing,js,1,1,1
"@@ -181,7 +181,8 @@ export async function getAdSenseAccountStatus( statusUpdateCallback, existingTag
 				for ( let account of accounts ) {
 					const accountId = account.id;
 					const urlchannels = await data.get( 'modules', 'adsense', 'urlchannels', { clientId: accountId } ).then( res => res ).catch( e => e );
-					const matches = urlchannels && urlchannels.length ? filter( urlchannels, { urlPattern: googlesitekit.admin.siteURL } ) : [];
+					const parsedUrl = new URL( googlesitekit.admin.siteURL );
+					const matches = urlchannels && urlchannels.length ? filter( urlchannels, { urlPattern: parsedUrl.hostname } ) : [];
 
 					if ( 0 === matches.length ) {
 						accountStatus  = 'account-pending-review';",Can you provide more background on this change?,js,1,0,1
"@@ -41,8 +41,9 @@ import WidgetCellWrapper from './WidgetCellWrapper';
 import { isInactiveWidgetState } from '../util/is-inactive-widget-state';
 import InViewProvider from '../../../components/InViewProvider';
 const { useSelect } = Data;
+const DEFAULT_CLASS_APPENDIX = '--boxes'
 
-export default function WidgetAreaRenderer( { slug, totalAreas } ) {
+export default function WidgetAreaRenderer( { slug = DEFAULT_CLASS_APPENDIX, totalAreas } ) {
 	const widgetAreaRef = useRef();
 	const intersectionEntry = useIntersection( widgetAreaRef, {
 		rootMargin: '0px',","@shayannosrat I don't think the problem here is related to the `slug` - it's related to the `style` of the widget area. `boxes` is a widget area style, not a widget area slug. We need to investigate why the `style` variable in this component can be `undefined` - it never should be.",js,0,1,1
"@@ -0,0 +1,19 @@
+const uniqueLandmarks = [];
+results.forEach(currentResult => {
+	const findMatch = someResult => {
+		return (
+			currentResult.data.role === someResult.data.role &&
+			currentResult.data.label === someResult.data.label
+		);
+	};
+
+	const foundResultIndex = uniqueLandmarks.findIndex(findMatch);
+	if (foundResultIndex === -1) {
+		uniqueLandmarks.push(currentResult);
+	} else {
+		currentResult.result = false;
+		uniqueLandmarks[foundResultIndex].result = false;
+	}
+});
+
+return results;",We should be adding the information about the currentResult to the matching item as a `relatedNode` that way we only return one fail for each duplicated role and name and we can see the others directly in the result.,js,1,1,1
"@@ -0,0 +1,3 @@
+const isFocusable = virtualNode.isFocusable;
+
+return isFocusable;",Why not just return `virtualNode.isFocusable`?,js,1,0,1
"@@ -0,0 +1,12 @@
+import memory from 'rollup-plugin-memory';
+import rollupConfig from './rollup.config';
+
+export default Object.assign({}, rollupConfig, {
+	plugins: [
+		memory({
+			path: 'src/preact',
+			contents: `import { h } from './preact';export * from './preact';export { h as createElement };`
+		}),
+		...rollupConfig.plugins.slice(1)
+	]
+});","Wondering if it's worth pulling this into a file (`src/aliases.js`?) for visibility. Or if there's anything else we might add in the future, it'd be easier in a file. Thoughts?",js,1,1,1
"@@ -29,7 +29,13 @@
 
 	var fixture = document.getElementById('fixture');
 	Object.keys(tests).forEach(function(ruleId) {
-		describe(ruleId, function() {
+		// don't run deprecated rules
+		var rule = axe._audit.rules.find(function(rule) {
+			return rule.id === ruleId;
+		});
+		var deprecated = rule.tags.indexOf('deprecated') !== -1;
+
+		(deprecated ? describe.skip : describe)(ruleId, function() {
 			tests[ruleId].forEach(function(test) {
 				var testName = test.description || ruleId + ' test';
 				describe(testName, function() {","If `rules.find()` somehow doesn't match, this will throw, since `rule` will be `undefined`. Do we want to guard against this?",js,1,1,1
"@@ -32,6 +32,8 @@ export function Component(props, context) {
 	 */
 	this.props = props;
 
+	this._nextState =
+
 	/**
 	 * @public
 	 * @type {object}",@KevinDoughty Perhaps a bad push?,js,0,0,1
"@@ -53,6 +53,10 @@ export default function UserInputKeywords( { slug, max } ) {
 		values.push( '' );
 	}
 
+	// Store values in local state to prevent
+	// https://github.com/google/site-kit-wp/issues/2900#issuecomment-814843972.
+	const [ localValues, setLocalValues ] = useState( [ '' ] );
+
 	// Need to make sure that dependencies list always has the same number of elements.
 	const dependencies = values.concat( Array( max ) ).slice( 0, max );
 ",Shouldn't the initial state be `values`?,js,1,1,1
"@@ -0,0 +1,12 @@
+let nodeText = axe.commons.text.accessibleText(node);
+let nodeDescripbedBy = axe.commons.aria.ariaDescribedby(node);
+
+let elems = axe.utils.querySelectorAll(axe._tree, 'a[href]');
+return !Array.prototype.slice.call(elems).some(function(element) {
+  return (
+    nodeText === axe.commons.text.accessibleText(element.actualNode) &&
+    nodeDescripbedBy === axe.commons.aria.ariaDescribedby(element.actualNode) &&
+    node.title === element.actualNode.title &&
+    node.href !== element.actualNode.href
+  );
+});","nitpick, spelling mistake - `nodeDescibedBy`",js,1,1,1
"@@ -41,7 +41,11 @@ function getAttributeNameValue(node, at) {
 				return;
 			}
 		} else {
-			atnv = escapeSelector(at.name) + '=""' + node.getAttribute(name) + '""';
+			atnv =
+				escapeSelector(at.name) +
+				'=""' +
+				escapeSelector(node.getAttribute(name)) +
+				'""';
 		}
 	} else {
 		atnv = escapeSelector(name) + '=""' + escapeSelector(at.value) + '""';","At L39 above, is it worth doing `escapeSelector(value)` as well?",js,1,1,1
"@@ -51,12 +51,15 @@ export default function SetupFormGA4Transitional() {
 	const propertyID = useSelect( ( select ) => select( STORE_NAME ).getPropertyID() );
 	const profileID = useSelect( ( select ) => select( STORE_NAME ).getProfileID() );
 
+	const ga4PropertyID = useSelect( ( select ) => select( MODULES_ANALYTICS_4 ).getPropertyID() );
 	const ga4ExistingTag = useSelect( ( select ) => select( MODULES_ANALYTICS_4 ).getExistingTag() );
 	const ga4MeasurementID = useSelect( ( select ) => select( MODULES_ANALYTICS_4 ).getMeasurementID() );
 
 	const { setUseSnippet: uaSetUseSnippet } = useDispatch( STORE_NAME );
 	const { setUseSnippet: ga4SetUseSnippet } = useDispatch( MODULES_ANALYTICS_4 );
 
+	const shouldShowAssociatedPropertyNotice = propertyID || ga4PropertyID;
+
 	useEffect( () => {
 		uaSetUseSnippet( existingTag !== propertyID );
 		ga4SetUseSnippet( ga4ExistingTag !== ga4MeasurementID );","See above, let's make this consistent with the other two scenarios: `accountID && accountID !== ACCOUNT_CREATE && ( propertyID || ga4PropertyID )`",js,1,1,1
"@@ -1,8 +1,11 @@
-/*global dom */
+/* global dom */
 /**
  * Get an element's parent in the composed tree
- * @param   DOMNode   Element
- * @return  DOMNode   Parent element
+ * @method getComposedParent
+ * @memberof axe.commons.dom
+ * @instance
+ * @param {Node} element
+ * @return {Node|null} Parent element or Null for root node
  */
 dom.getComposedParent = function getComposedParent (element)  {
   if (element.assignedSlot) {",I am surprised we did not rename this to `getFlattenedParent`!! Anyhoo - we should at least change the description to read `get an element's parent in the flattened tree`,js,1,1,1
"@@ -64,6 +64,7 @@ class Uppy {
         connectedToInternet: 'Connected to the Internet',
         // Strings for remote providers
         noFilesFound: 'You have no files or folders here',
+        loadMore: 'Load more',
         selectX: {
           0: 'Select %{smart_count}',
           1: 'Select %{smart_count}'",do we still need this?,js,1,0,1
"@@ -206,7 +206,12 @@ function scheduleFlushAfterPaint() {
 if (typeof window !== 'undefined') {
 	afterPaint = (component) => {
 		if (!component._afterPaintQueued && (component._afterPaintQueued = true) && afterPaintEffects.push(component) === 1) {
-			requestAnimationFrame(scheduleFlushAfterPaint);
+			if (options.afterPaint) {
+				options.afterPaint(flushAfterPaintEffects);
+			}
+			else {
+				requestAnimationFrame(scheduleFlushAfterPaint);
+			}
 		}
 	};
 }",Can we change this to `options.requestAnimationFrame`? It should compress better.,js,1,1,1
"@@ -0,0 +1,14 @@
+
+import { wpApiFetch } from './wp-api-fetch';
+
+/**
+ *
+ * @param {*} config
+ */
+export async function setAuthToken( token = 'test-access-token' ) {
+	return await wpApiFetch( {
+		path: 'google-site-kit/v1/e2e/auth/access-token',
+		method: 'post',
+		data: { token },
+	} );
+}",Empty line before and no `Internal dependencies` docblock (mandatory anyway once #217 lands).,js,0,1,1
"@@ -40,7 +40,7 @@ public class BazelBuild {
     if (target == null || """".equals(target)) {
       throw new IllegalStateException(""No targets specified"");
     }
-    log.info(""\nBuilding "" + target + "" ..."");
+    log.finest(""\nBuilding "" + target + "" ..."");
 
     ImmutableList.Builder<String> builder = ImmutableList.builder();
     builder.add(""bazel"", ""build"", target);",This is to let people know that the tooling is doing something during a build. Please leave.,js,1,1,1
"@@ -62,6 +62,18 @@ class AdSensePerformanceWidget extends Component {
 					maxAge: getTimeInSeconds( 'day' ),
 					context: [ 'Single', 'Dashboard' ],
 					callback: ( result ) => {
+
+						// If there are no impressions, the site is not yet displaying ads.
+						if (
+							result && result.totals &&
+							(
+								null === result.totals[2] ||
+								0    === result.totals[2]
+							)
+						) {
+							handleZeroData();
+						}
+
 						this.setState( {
 							twentyEightDays: result,
 						} );","Instead of defining a custom condition here, I think it makes sense to rely on `isDataZeroAdSense()` as well. The current check here only checks for impressions, what if there's other data that is greater than zero (see the `isDataZeroAdSense()` function you created)? Just to clarify, of course, whatever this code here is changed to, should also apply to the below `earning-prev28days` callback logic.",js,1,1,1
"@@ -0,0 +1,17 @@
+/**
+ * Internal dependencies
+ */
+import { switchUserToAdmin, switchUserToTest, visitAdminPage } from '@wordpress/e2e-test-utils';
+
+const PLUGIN_SLUG = 'e2e-tests-reset-plugin';
+
+/**
+ * Reset Site Kit using utility plugin.
+ */
+export async function resetSiteKit() {
+	await switchUserToAdmin();
+	await visitAdminPage( 'plugins.php' );
+	await page.click( `tr[data-slug=""${ PLUGIN_SLUG }""] .activate a` );
+	await page.waitForSelector( `tr[data-slug=""${ PLUGIN_SLUG }""]` );
+	await switchUserToTest();
+}",There's a `activatePlugin` utility that can be used for this. So `resetSiteKit()` basically turns into `await activatePlugin( 'e2e-tests-reset-plugin' )`,js,1,1,1
"@@ -159,9 +159,10 @@ Config.prototype.buildArgs = function () {
     // Minimal symbols for target Linux x86, because ELF32 cannot be > 4GiB
     args.symbol_level = 1
   }
-  
-  if (this.targetArch === 'x64' && process.platform === 'linux') {
-    // Include vaapi support 
+
+  if (this.targetArch === 'x64' && process.platform === 'linux' &&
+    this.targetOS !== 'android') {
+    // Include vaapi support
     args.use_vaapi = true
   }
 ",Why are we ever setting this to true? The docs say that this is only for ChromeOS,js,1,1,1
"@@ -374,7 +374,7 @@ Blockly.Procedures.getPrototypeBlock = function(procCode, workspace) {
 Blockly.Procedures.newProcedureMutation = function() {
   var mutationText = '<xml>' +
       '<mutation' +
-      ' proccode=""block name""' +
+      ' proccode=""' + Blockly.Msg.PROCEDURE_DEFAULT_NAME + '""' +
       ' argumentids=""[]""' +
       ' argumentnames=""[]""' +
       ' argumentdefaults=""[]""' +","To avoid renames with Closure advanced compilation, prefer `Blockly.Msg['PROCEDURE_DEFAULT_NAME']`, unless you're including translation in your compilation sources.",js,1,1,1
"@@ -107,7 +107,7 @@ const webpackConfig = ( mode ) => {
 			output: {
 				filename: '[name].js',
 				path: __dirname + '/dist/assets/js',
-				chunkFilename: '[name]-[chunkhash].js',
+				chunkFilename: '[name].js',
 				publicPath: '',
 			},
 			performance: {","Would this have any side effects regarding browser caching? We used to have tons of issues with blank screens because of partially old resources being loaded alongside new ones, and I'm a bit worried that removing the chunk hash (specifically necessary for `googlesitekit-vendor.js` would bring back some of these problems. What do you think @tofumatt?",js,0,1,1
"@@ -0,0 +1,6 @@
+var role = node.getAttribute('role');
+if (role === null) {
+	return false;
+}
+var roleType = axe.commons.aria.getRoleType(role);
+return roleType === 'widget' || roleType === 'composite';","This check should have tests. Nothing too complicated, just check that it works.",js,1,1,1
"@@ -0,0 +1,18 @@
+/* global axe*/
+
+/**
+ * Get the pass, fail, or incomplete message for a check.
+ * @param {String} checkId The check id
+ * @param {String} type The message type ('pass', 'fail', or 'incomplete')
+ * @param {Object} [data] The check data
+ * @return {String}
+ */
+axe.utils.getCheckMessage = function getCheckMessage(checkId, type, data) {
+	const check = axe._audit.data.checks[checkId];
+
+	if (!check || !check.messages[type]) {
+		return '';
+	}
+
+	return axe.utils.processMessage(check.messages[type], data);
+};",I think it might be better if this just threw an error.,js,1,1,1
"@@ -406,7 +406,8 @@ export function unmount(vnode, parentVNode, skipRemove) {
 	if (options.unmount) options.unmount(vnode);
 
 	if ((r = vnode.ref)) {
-		applyRef(r, null, parentVNode);
+		if (!vnode.ref.current || vnode.ref.current === vnode._dom)
+			applyRef(r, null, parentVNode);
 	}
 
 	let dom;","It seems like we can either drop the `r` assignment altogether, or use it for L409 as well? Also - it seems like we can skip nulling the ref if it's already null? (when `!vnode.ref.current`)",js,1,1,1
"@@ -5,8 +5,15 @@ describe('aria-errormessage', function() {
 	var shadowSupported = axe.testUtils.shadowSupport.v1;
 	var shadowCheckSetup = axe.testUtils.shadowCheckSetup;
 	var checkContext = axe.testUtils.MockCheckContext();
+	var attrData = Object.assign(
+		{},
+		axe.commons.aria.lookupTable.attributes['aria-errormessage']
+	);
 
 	afterEach(function() {
+		axe.commons.aria.lookupTable.attributes[
+			'aria-errormessage'
+		] = Object.assign({}, attrData);
 		fixture.innerHTML = '';
 		checkContext.reset();
 	});",Do we do this object assignment anywhere else? Maybe it makes sense to abstract into a utility that we can reuse?,js,1,1,1
"@@ -30,7 +30,7 @@ describe('cleanupPlugins', function() {
 	it('should throw if no audit is configured', function() {
 		assert.throws(
 			function() {
-				cleanupPlugins(document, {});
+				axe.cleanup(document, {});
 			},
 			Error,
 			/^No audit configured/",I think this file should be renamed to just cleanup.js,js,0,0,1
"@@ -195,7 +195,7 @@
                 var col = filterCols(cols, group)[0];
 
                 var val = $utils.evalProperty(model, group);
-                val = (val === '' || val === null) ? 'null' : val.toString();
+                val = (val === '' || val === null || val === undefined) ? '[empty]' : val.toString();
                 if (!ptr[val]) {
                     ptr[val] = {};
                 }",Why are you changing the 'null' text to '[empty]' here?,js,1,1,1
"@@ -105,7 +105,7 @@ public class RequestHandler implements Comparable<RequestHandler> {
   public void process() {
     switch (request.getRequestType()) {
       case START_SESSION:
-        log.info(""Got a request to create a new session: ""
+        log.finest(""Got a request to create a new session: ""
                  + new DesiredCapabilities(request.getDesiredCapabilities()));
         try {
           registry.addNewSessionRequest(this);",This change is unhelpful to users.,js,1,0,1
"@@ -237,6 +237,8 @@ class WebDriver(RemoteWebDriver):
         Returns identifier of installed addon. This identifier can later
         be used to uninstall addon.
 
+        :param path: Full path to the addon that will be installed.
+
         :Usage:
             driver.install_addon('firebug.xpi')
         """"""",Can you update the `Usage` to be an absolute path as well? Something like `/path/to/firebug.xpi`,js,1,1,1
"@@ -1,4 +1,5 @@
 import { compose, complement, either } from 'ramda';
+import curry2 from 'ramda/src/internal/_curry2';
 
 /* eslint-disable max-len */
 /**",Can we use `curry` or `curryN` instead of internal `curry2`. We only use `curry1` from internals and probably get rid of it in the future and replace it with `curryN` so that we're dependant on internal api or ramda as few as possible.,js,1,1,1
"@@ -19,11 +19,13 @@
 export const STORE_NAME = 'modules/pagespeed-insights';
 export { STORE_NAME as MODULES_PAGESPEED_INSIGHTS };
 
-// Form ID for PageSpeed widget.
-export const FORM_DASH_WIDGET = 'pagespeedDashboardWidget';
 // Report strategies.
 export const STRATEGY_MOBILE = 'mobile';
 export const STRATEGY_DESKTOP = 'desktop';
 // Report data sources.
 export const DATA_SRC_LAB = 'data_lab';
 export const DATA_SRC_FIELD = 'data_field';
+
+// Dashboard widgets using the UI store.
+export const WIDGET_STRATEGY = 'dashboardPageSpeedWidgetStrategy';
+export const WIDGET_DATA_SOURCE = 'dashboardPageSpeedWidgetDataSource';","Let's use a consistent naming format for these key variables across the plugin. I like to keep the constant names short, but maybe we should prefix them to indicate that they are fields for the `core/ui` store. The alternative would be to go with super-verbose names (like what is used for the actual values of these constants), but since these constants are usually not mixed between different components, it should be okay keeping their names short. How about renaming these to `UI_STRATEGY` and `UI_DATA_SOURCE`?",js,1,1,0
"@@ -11,7 +11,10 @@ function ngGridFlexibleHeightPlugin (opts) {
             var gridId = self.grid.gridId;
             var footerPanelSel = '.' + gridId + ' .ngFooterPanel';
             var extraHeight = self.grid.$topPanel.height() + $(footerPanelSel).height();
-            var naturalHeight = self.grid.$canvas.height() + 1;
+            var naturalHeight = self.grid.$canvas.prop('scrollHeight') + 1;
+            if ( self.grid.$topPanel.width() < grid.$canvas.prop('scrollWidth')) {
+                naturalHeight += 15;
+            }
             if (opts != null) {
                 if (opts.minHeight != null && (naturalHeight + extraHeight) < opts.minHeight) {
                     naturalHeight = opts.minHeight - extraHeight - 2;",Does this work for all browsers? i tested one time and came up with 20px on FF on Linux... but i have not tried setting the `naturalHeight` to the `scrollHeight + 1`,js,1,1,1
"@@ -34,7 +34,9 @@ import { isValidStringsOrObjects } from '../../../util/report-validation';
 export function isValidMetrics( metrics ) {
 	return isValidStringsOrObjects( metrics, ( metric ) => {
 		const validExpression = metric.hasOwnProperty( 'expression' ) && typeof metric.expression === 'string';
-		const validAlias = metric.hasOwnProperty( 'alias' ) && typeof metric.alias === 'string';
+
+		// 'alias' is optional; if provided, it must be a string.
+		const validAlias = ! metric.hasOwnProperty( 'alias' ) || typeof metric.alias === 'string';
 		return validExpression && validAlias;
 	} );
 }","  although the doc block should be updated to reflect this as it currently contradicts this: > Objects must have ""expression"" and ""alias"" properties in order to be considered as valid.",js,1,1,1
"@@ -41,7 +41,7 @@ export default Mixin.create({
     notifications: injectService(),
     clock: injectService(),
     slugGenerator: injectService(),
-
+    wordCount: 0,
     cards: [], // for apps
     atoms: [], // for apps
     toolbar: [], // for apps",I think we should be trying to move as much editor-specific code into the `gh-editor` component as possible rather than relying on the controller mixin - I initially thought this was here because the value needs to be carried across the new->edit transition but they are both separate controllers so carrying long-lived state here isn't useful for that. Keeping short-lived editor state in `gh-editor` means that we get automatic cleanup and always know the starting value.,js,1,1,0
"@@ -22,9 +22,9 @@ const plugins = require('../../pluginManager'),
             const dayOfYear = now.dayOfYear();
 
             periods.forEach((p) => {
-                timeList[p] = now.dayOfYear(dayOfYear - p).utc().unix();
+                timeList[p] = now.dayOfYear(dayOfYear - p).utc().unix() * 1000;
                 conditions.push({
-                    ls: {$lt: timeList[p]},
+                    lac: {$lt: timeList[p]},
                 });
             });
 ","I think we also need to change in the view on click action to use `lac` instead of `ls`, when viewing users in user profiles list",js,1,1,1
"@@ -539,7 +539,13 @@ class WebElement(object):
     @property
     def rect(self):
         """"""A dictionary with the size and location of the element.""""""
-        return self._execute(Command.GET_ELEMENT_RECT)['value']
+        if self._w3c:
+            return self._execute(Command.GET_ELEMENT_RECT)['value']
+        else:
+            rect = self.size.copy()
+            rect.update(self.location)
+            return rect
+
 
     @property
     def screenshot_as_base64(self):",flake8 is going to fail on this having 2 lines,js,1,1,1
"@@ -12,6 +12,7 @@ function autocompleteAppropriateEvaluate(node, options, virtualNode) {
   const allowedTypesMap = {
     bday: ['text', 'search', 'date'],
     email: ['text', 'search', 'email'],
+    username: ['email'],
     'street-address': ['text'], // Issue: https://github.com/dequelabs/axe-core/issues/1161
     tel: ['text', 'search', 'tel'],
     'tel-country-code': ['text', 'search', 'tel'],",I believe to fix the test we'll need this to also include `text` and probably `search`. Otherwise it's restricted to just `type=email`.,js,1,1,1
"@@ -40,12 +40,7 @@ function getAttributeNameValue(node, at) {
   if (name.indexOf('href') !== -1 || name.indexOf('src') !== -1) {
     const friendly = getFriendlyUriEnd(node.getAttribute(name));
     if (friendly) {
-      const value = encodeURI(friendly);
-      if (value) {
-        atnv = escapeSelector(at.name) + '$=""' + escapeSelector(value) + '""';
-      } else {
-        return;
-      }
+      atnv = escapeSelector(at.name) + '$=""' + friendly + '""';
     } else {
       atnv =
         escapeSelector(at.name) +",Need to make the same change on line 48,js,1,0,1
"@@ -486,7 +486,9 @@ function init(self, obj, doc, prefix) {
       if (obj[i] === null) {
         doc[i] = null;
       } else if (obj[i] !== undefined) {
-        if (schema) {
+        let intCache = obj[i].$__ || {};
+        let wasPopulated = intCache.wasPopulated || null;
+        if (schema && !wasPopulated) {
           try {
             doc[i] = schema.cast(obj[i], self, true);
           } catch (e) {","You can use `lodash.get` for this in the future, `get(obj[i], '$__.wasPopulated', false)`",js,1,1,1
"@@ -48,6 +48,7 @@ const baseModuleStore = Modules.createModuleStore( 'adsense', {
                 'siteStatus',
                 'accountSetupComplete',
                 'siteSetupComplete',
+                'ownerID',
         ],
         adminPage: 'googlesitekit-module-adsense',
 } );","Thank you, I realize this detail was missed in the IB  ",js,1,0,1
"@@ -24,8 +24,7 @@ import java.io.OutputStream;
 import java.util.Base64;
 
 /**
- * Defines the output type for a screenshot. See org.openqa.selenium.Screenshot for usage and
- * examples.
+ * Defines the output type for a screenshot.
  *
  * @see TakesScreenshot
  * @param <T> Type for the screenshot output.",instead of removing can you reference org.openqa.selenium.TakesScreenshot ?,js,1,1,1
"@@ -22,9 +22,9 @@ define(['viewContainer', 'focusManager', 'queryString', 'layoutManager'], functi
             newView.initComplete = true;
 
             if (typeof options.controllerFactory === 'function') {
-
-                // Use controller method
                 var controller = new options.controllerFactory(newView, eventDetail.detail.params);
+            } else if (options.controllerFactory && typeof options.controllerFactory.default === 'function') {
+                var controller = new options.controllerFactory.default(newView, eventDetail.detail.params);
             }
 
             if (!options.controllerFactory || dispatchPageEvents) {",Maybe move `var controller` out of `if/else`? (_Code Smell_),js,1,1,1
"@@ -5,9 +5,14 @@ import { pageY } from './../../helpers/dom/event';
 import { arrayEach } from './../../helpers/array';
 import { rangeEach } from './../../helpers/number';
 import { registerPlugin } from './../../plugins';
+import { ValueMap } from './../../translations';
 
 // Developer note! Whenever you make a change in this file, make an analogous change in manualRowResize.js
 
+const ROW_HEIGHTS_MAP_NAME = 'rowHeights';
+const PERSISTENT_STATE_KEY = 'manualRowHeights';
+const privatePool = new WeakMap();
+
 /**
  * @description
  * This plugin allows to change rows height. To make rows height persistent the {@link Options#persistentState}",Please change this name to the name of the plugin.,js,1,1,1
"@@ -1,5 +1,14 @@
+import windowIsTopMatches from './window-is-top-matches';
+
 function bypassMatches(node) {
-	return !!node.querySelector('a[href]');
+	// the top level window should have an anchor
+	if (windowIsTopMatches(node)) {
+		return !!node.querySelector('a[href]');
+	}
+
+	// all iframes do not need an anchor but should be checked for bypass
+	// elements (headings, landmarks, etc.)
+	return true;
 }
 
 export default bypassMatches;",I'm kind of confused about what you are trying to accomplish here. I don't see how pages having native links is relevant to whether or not they need a mechanism for bypassing repeating content.,js,1,1,1
"@@ -83,15 +83,16 @@ function HelpMenu( { children } ) {
 					ref={ menuRef }
 					menuOpen={ menuOpen }
 					id=""googlesitekit-help-menu""
+					onSelected={ () => {} }
 				>
 					{ children }
-					<HelpMenuLink href=""https://sitekit.withgoogle.com/documentation/fix-common-issues/"">
+					<HelpMenuLink gaEventLabel=""fix_common_issues"" href=""https://sitekit.withgoogle.com/documentation/fix-common-issues/"">
 						{ __( 'Fix common issues', 'google-site-kit' ) }
 					</HelpMenuLink>
-					<HelpMenuLink href=""https://sitekit.withgoogle.com/documentation/"">
+					<HelpMenuLink gaEventLabel=""documentation"" href=""https://sitekit.withgoogle.com/documentation/"">
 						{ __( 'Read help docs', 'google-site-kit' ) }
 					</HelpMenuLink>
-					<HelpMenuLink href=""https://wordpress.org/support/plugin/google-site-kit/"">
+					<HelpMenuLink gaEventLabel=""support_forum"" href=""https://wordpress.org/support/plugin/google-site-kit/"">
 						{ __( 'Get support', 'google-site-kit' ) }
 					</HelpMenuLink>
 				</Menu>","Instead of adding an empty function here, let's better add it as a default prop in the Menu component itself.",js,1,1,1
"@@ -93,7 +93,7 @@ Blockly.WorkspaceDragSurfaceSvg.prototype.createDom = function() {
     'xmlns:html': Blockly.HTML_NS,
     'xmlns:xlink': 'http://www.w3.org/1999/xlink',
     'version': '1.1',
-    'class': 'blocklyWsDragSurface'
+    'class': 'blocklyWsDragSurface blocklyOverflowVisible'
   }, null);
   this.container_.appendChild(this.SVG_);
 };",To fix an eslint warning (comma-dangle) delete the trailing comma.,js,1,1,1
"@@ -143,8 +143,10 @@ function Cursor(bson, ns, cmd, options, topology, topologyOptions) {
     promiseLibrary: promiseLibrary,
     // Current doc
     currentDoc: null,
+    // expicitlyDoNotUseSession
+    expicitlyDoNotUseSession: options.expicitlyDoNotUseSession,
     // Optional ClientSession
-    session: options.session
+    session: options.explicitlyDoNotUseSession ? undefined : options.session
   };
 
   // Translate correctly",typo: `expicitly` should be `explicitly`,js,1,1,1
"@@ -92,7 +92,9 @@ const webpackConfig = ( mode ) => {
 				// New Modules (Post-JSR).
 				'googlesitekit-api': './assets/js/googlesitekit-api.js',
 				'googlesitekit-data': './assets/js/googlesitekit-data.js',
+				'googlesitekit-datastore-user': './assets/js/googlesitekit-datastore-user.js',
 				'googlesitekit-datastore-site': './assets/js/googlesitekit-datastore-site.js',
+				'googlesitekit-modules-analytics': './assets/js/googlesitekit-modules-analytics.js',
 				'googlesitekit-modules': './assets/js/googlesitekit-modules.js', // TODO: Add external following 1162.
 				// Old Modules
 				'googlesitekit-activation': './assets/js/googlesitekit-activation.js',","Super nitpick, but can we keep alpha-sort here? (i.e. after datastore-site)",js,1,1,1
"@@ -34,15 +34,12 @@ define(['apphost', 'userSettings', 'browser', 'events', 'pluginManager', 'backdr
             id: ""dark"",
             isDefault: true,
             isDefaultServerDashboard: true
-        }, {
-            name: ""Emby"",
-            id: ""emby""
         }, {
             name: ""Light"",
             id: ""light""
         }, {
             name: ""Purple Haze"",
-            id: ""purple-haze""
+            id: ""purplehaze""
         }, {
             name: ""Windows Media Center"",
             id: ""wmc""",why not rename to `emerald`?,js,1,0,1
"@@ -1,9 +1,8 @@
-const { h } = require('preact')
+const { h, Fragment } = require('preact')
 
-// TODO use Fragment when upgrading to preact X
 const Breadcrumb = (props) => {
   return (
-    <span>
+    <Fragment>
       <button
         type=""button""
         className=""uppy-u-reset""",I believe this can be simplified even further by just using `<>` and `</>` instead of having to import Fragment,js,1,1,1
"@@ -38,7 +38,7 @@ module.exports = {
   i18n: i18nConfig,
   plugins: [
     'docusaurus-plugin-sass',
-    isProductionDeployment && ['docusaurus-plugin-sentry', { dsn: 'a7bc89ee3f284570b1d9a47e600e7597' }]
+    isProductionDeployment && ['docusaurus-plugin-sentry', { DSN: 'a7bc89ee3f284570b1d9a47e600e7597' }]
   ].filter(Boolean),
   webpack: {
     jsLoader: (isServer) => ({","hehe, javascript :D and his case sensitive",js,1,0,0
"@@ -580,19 +580,6 @@ module.exports = [
 			},
 		},
 	},
-	{
-		id: 'wordpress--wordpress-activation',
-		kind: 'WordPress',
-		name: 'WordPress Activation',
-		story: 'WordPress Activation',
-		parameters: {
-			fileName: './stories/wp-activation.stories.js',
-			options: {
-				hierarchyRootSeparator: '|',
-				hierarchySeparator: {},
-			},
-		},
-	},
 	{
 		id: 'wordpress--wordpress-dashboard',
 		kind: 'WordPress',",Thanks so much for this fix! I wouldn't have thought to look in that folder to fix the tests!,js,1,0,1
"@@ -330,6 +330,10 @@ var jsonpatch;
             generate(observer);
             clearTimeout(observer.next);
             removeObserverFromMirror(mirror, observer);
+            if (mirror.observers.length === 0)
+            {
+                beforeDict.splice(beforeDict.indexOf(mirror), 1);
+            }
             if (typeof window !== 'undefined') {
                 if (window.removeEventListener) {
                     window.removeEventListener('mousedown', fastCheck);",Incorrect format - braces must be on this same line after the preceding closing brace.,js,1,1,1
"@@ -23,14 +23,13 @@ import Data from 'googlesitekit-data';
 import authentication from './authentication';
 import dateRange from './date-range';
 import disconnect from './disconnect';
+import inputSettings from './input-settings';
 import { createErrorStore } from '../../data/create-error-store';
 import notifications from './notifications';
 import permissions from './permissions';
 import userInfo from './user-info';
 import { STORE_NAME } from './constants';
 
-export { STORE_NAME };
-
 const store = Data.combineStores(
 	Data.commonStore,
 	authentication,","Nitpicking, but let's call this file `user-input-settings.js` since ""User Input"" is kind of a semi-internal codename for this feature. ""input"" on its own therefore isn't as clear here.",js,1,1,1
"@@ -30,7 +30,7 @@ storiesOf( 'Dashboard', module )
 		<DashboardModuleHeader
 			title={ __( 'Module Header', 'google-site-kit' ) }
 			description={ __( 'Description of Module', 'google-site-kit' ) }
-			timePeriod={ __( 'Last 28 Days', 'google-site-kit' ) }
+			timePeriod={ __( 'Last 28 days', 'google-site-kit' ) }
 		/>
 	) )
 	.add( 'All Traffic', () => {",I think we might want to keep title case here.,js,1,1,1
"@@ -2,9 +2,12 @@ if (node.getAttribute('id')) {
 	const root = axe.commons.dom.getRootNode(node);
 	const id = axe.commons.utils.escapeSelector(node.getAttribute('id'));
 	const label = root.querySelector(`label[for=""${id}""]`);
+	const isLabelVisible = label && axe.commons.dom.isVisible(label);
 
-	if (label && !axe.commons.dom.isVisible(label)) {
-		return true;
+	if (isLabelVisible === false) {
+		const name = axe.commons.text.accessibleTextVirtual(virtualNode).trim();
+		const isNameEmpty = name === '';
+		return isNameEmpty;
 	}
 }
 return false;",I think this now fails if there is no label. Should probably just put the if statement back to the way it was.,js,1,1,1
"@@ -77,7 +77,7 @@ const nordStyle = {
 	htmlCodeBorderColor: nord[2],
 	htmlCodeColor: nord[13],
 
-	editorTheme: 'chaos',
+	editorTheme: 'terminal',
 	codeThemeCss: 'atom-one-dark-reasonable.css',
 };
 ","In AceEditor.tsx, you've added the ""tomorrow"" theme, and ""twilight"" was already present, however you didn't add ""terminal"". Isn't it an issue?",js,1,1,1
"@@ -9,3 +9,14 @@ export function assign(obj, props) {
 	for (let i in props) obj[i] = props[i];
 	return /** @type {O & P} */ (obj);
 }
+
+/**
+ * Remove a child node from its parent if attached. This is a workaround for
+ * IE11 which doesn't support `Element.prototype.remove()`. Using this function
+ * is smaller than including a dedicated polyfill.
+ * @param {Node} node The node to remove
+ */
+export function removeNode(node) {
+	let parentNode = node.parentNode;
+	if (parentNode) parentNode.removeChild(node);
+}",This is an opportunity with a module build to remove the additional method via build system transform.,js,1,1,1
"@@ -105,7 +105,7 @@ class SearchConsole extends Component {
 						propertyMatches[ 0 ].siteUrl
 					);
 				} else {
-					errorMessage = __( 'We found no verified accounts, would you like to verify this URL?', 'google-site-kit' );
+					errorMessage = __( 'We did not find a Search Console property for this site, would you like to create one?', 'google-site-kit' );
 				}
 
 				setErrorMessage( errorMessage );","Can you change the message to `Your site has not yet been added to Search Console. Would you like to add it now?` please, which is found in #600?",js,0,1,1
"@@ -32,9 +32,10 @@ describe('createElement(jsx)', () => {
 		expect(<Test />).to.have.property('type', Test);
 	});
 
-	it('should set VNode._self property to prevent json injection', () => {
+	it('should set VNode.constructor property to prevent json injection', () => {
 		const vnode = <span />;
-		expect(vnode._self).to.equal(vnode);
+		// eslint-disable-next-line no-proto
+		expect(vnode.constructor).to.equal(undefined);
 	});
 
 	it('should set VNode#props property', () => {",Guess this one is a left over from the proto approach?,js,1,1,1
"@@ -1,9 +1,9 @@
 'use strict';
 
-const MongoError = require('../core').MongoError;
+const MongoError = require('../core/error').MongoError;
 const Aspect = require('./operation').Aspect;
 const OperationBase = require('./operation').OperationBase;
-const ReadPreference = require('../core').ReadPreference;
+const ReadPreference = require('../core/topologies/read_preference');
 const isRetryableError = require('../core/error').isRetryableError;
 const maxWireVersion = require('../core/utils').maxWireVersion;
 const isUnifiedTopology = require('../core/utils').isUnifiedTopology;",why the diff here?,js,1,0,1
"@@ -9,6 +9,10 @@ const databaseNamespace = require('./shared').databaseNamespace;
 const isTransactionCommand = require('../transactions').isTransactionCommand;
 const applySession = require('../sessions').applySession;
 
+function isClientEncryptionEnabled(server) {
+  return server && server.s && server.s.options && server.s.options.autoEncrypter;
+}
+
 function command(server, ns, cmd, options, callback) {
   if (typeof options === 'function') (callback = options), (options = {});
   options = options || {};","This could be follow-on work, but it would be nice to have `server.autoEncrypter` similar to `collection.readConcern` so we don't have to do this long check here.",js,1,1,1
"@@ -189,8 +189,8 @@ Blockly.Css.CONTENT = [
   '}',
 
   '.blocklyDragging>.blocklyPath {',
-    'fill-opacity: .8;',
-    'stroke-opacity: .8;',
+    // 'fill-opacity: .8;',
+    // 'stroke-opacity: .8;',
   '}',
 
   '.blocklyDisabled>.blocklyPath {',",Can we completely remove this?,js,1,0,1
"@@ -140,6 +140,10 @@ class SearchRunner
             compact('params', 'request', 'runningSearchId')
         );
 
+        if (isset($rawRequest['enabledFacets'])) {
+            $params->retainFacets($rawRequest['enabledFacets']);
+        }
+
         // Attempt to perform the search; if there is a problem, inspect any Solr
         // exceptions to see if we should communicate to the user about them.
         try {","While I don't see any major harm in globally enabling an enabledFacets query parameter, perhaps it would a more targeted fix to put this logic in the setup callback created by GetSideFacets::getFacetResults() instead of the SearchRunner itself.",php,1,1,1
"@@ -38,6 +38,8 @@ namespace VuFind\Sitemap;
  */
 class Sitemap extends AbstractFile
 {
+    const XHTML_NAMESPACE = 'xmlns:xhtml=""http://www.w3.org/1999/xhtml""';
+
     /**
      * Frequency of URL updates (always, daily, weekly, monthly, yearly, never)
      *",We should set this public or protected to keep PHPStan happy when we raise its level in the future.,php,1,1,1
"@@ -22,11 +22,13 @@ class MediaManager extends BaseDocumentManager
     {
         // BC compatibility for $context parameter
         if ($andFlush && is_string($andFlush)) {
+            @trigger_error(sprintf('Since version 2.2.7, passing context in argument 2 for %s() is deprecated and support for it will be removed in 3.0. Use %s::setContext() instead.', __METHOD__, $this->class), E_USER_DEPRECATED);
             $entity->setContext($andFlush);
         }
 
         // BC compatibility for $providerName parameter
         if (3 == func_num_args()) {
+            @trigger_error(sprintf('Since version 2.2.7, passing provider name in argument 3 for %s() is deprecated and support for it will be removed in 3.0. Use %s::setProviderName() instead.', __METHOD__, $this->class), E_USER_DEPRECATED);
             $entity->setProviderName(func_get_arg(2));
         }
 ",please line break this!,php,1,1,0
"@@ -14,7 +14,6 @@ return [
     */
 
     'previous' => '&laquo; Προηγούμενη',
-
     'next'     => 'Επόμενη &raquo;',
 
 ];",Why delete empty lines ?,php,1,1,1
"@@ -110,7 +110,7 @@ array_map(
                 );
                 exit(1);
             }
-        } elseif (substr($arg, 0, 2) === '-' && $arg !== '-' && $arg !== '--') {
+        } elseif (substr($arg, 0, 1) === '-' && $arg !== '-' && $arg !== '--') {
             $arg_name = preg_replace('/=.*$/', '', substr($arg, 1));
 
             if (!in_array($arg_name, $valid_short_options) && !in_array($arg_name . ':', $valid_short_options)) {","The bug fix in this PR was noticed when looking at a check that `in_array()` is always explicitly passed a third argument for $strict. It doesn't matter now, but might matter if `-0` becomes an option, because `'0' == '0e1'` (strings are cast to numbers to compare if both are numeric)",php,1,1,1
"@@ -1227,7 +1227,7 @@ bool CLIENT_STATE::enforce_run_list(vector<RESULT*>& run_list) {
     // and prune those that can't be assigned
     //
     assign_coprocs(run_list);
-    bool scheduled_mt = false;
+    //bool scheduled_mt = false;
 
     // prune jobs that don't fit in RAM or that exceed CPU usage limits.
     // Mark the rest as SCHEDULED",Can this line be removed?,php,1,0,1
"@@ -1,5 +1,6 @@
 <?php namespace Backend\Models;
 
+use BackendAuth;
 use Mail;
 use Event;
 use Backend;",Move the backend auth use statement below the backend use statement please,php,1,0,1
"@@ -50,7 +50,7 @@ class SolrConfigStatus implements StatusProviderInterface
      *
      * @var string
      */
-    const RECOMMENDED_SOLRCONFIG_VERSION = 'tx_solr-4-0-0--20160406';
+    const RECOMMENDED_SOLRCONFIG_VERSION = 'tx_solr-6-0-0--20160725';
 
     /**
      * Compiles a collection of solrconfig version checks against each configured","solrconfig didn't change, did it?",php,1,0,1
"@@ -45,6 +45,7 @@ return [
         ['file' => 'lightbox.js', 'priority' => 320],
         ['file' => 'truncate.js', 'priority' => 330],
         ['file' => 'trigger_print.js', 'priority' => 340],
+        ['file' => 'resultcount.js', 'priority' => 350],
     ],
     'less' => [
         'active' => false,","Now that showCounts is configurable, would it make sense to conditionally load this via searchTabs.phtml when the feature is enabled, rather than always loading the Javascript?",php,1,1,1
"@@ -19,7 +19,7 @@ use const PREG_OFFSET_CAPTURE;
 
 class DocblockParser
 {
-    public static function parse(string $docblock) : ParsedDocblock
+    public static function parse(string $docblock, int $offsetStart) : ParsedDocblock
     {
         // Strip off comments.
         $docblock = trim($docblock);",Mind adding a docblock specifying whether absolute file offset or relative docblock offset is expected here?,php,1,1,1
"@@ -89,7 +89,7 @@ class CartFacadeDeleteOldCartsTest extends TransactionFunctionalTestCase
 
     /**
      * @param int $productId
-     * @return \Shopsys\ShopBundle\Model\Product\Product
+     * @return \Shopsys\FrameworkBundle\Model\Product\Product
      */
     private function getProductById($productId)
     {",symfony extension for new PR ?,php,0,1,1
"@@ -119,7 +119,13 @@ final class VimeoProvider extends BaseVideoProvider
 
     public function getReferenceUrl(MediaInterface $media): string
     {
-        return sprintf('https://vimeo.com/%s', $media->getProviderReference());
+        $providerReference = $media->getProviderReference();
+
+        if (null === $providerReference) {
+            return '';
+        }
+
+        return sprintf('https://vimeo.com/%s', $providerReference);
     }
 
     protected function fixBinaryContent(MediaInterface $media): void",Same thing about references to videos.,php,0,1,1
"@@ -93,6 +93,10 @@ class ForeachAnalyzer
 
         if ($stmt->valueVar instanceof PhpParser\Node\Expr\Variable && is_string($stmt->valueVar->name)) {
             $safe_var_ids['$' . $stmt->valueVar->name] = true;
+            $statements_analyzer->foreach_var_locations['$' . strtolower($stmt->valueVar->name)][] = new CodeLocation(
+                $statements_analyzer,
+                $stmt->valueVar
+            );
         } elseif ($stmt->valueVar instanceof PhpParser\Node\Expr\List_) {
             foreach ($stmt->valueVar->items as $list_item) {
                 if (!$list_item) {",why are you normalising the variable name? Variables in PHP are case-sensitive.,php,1,1,1
"@@ -45,6 +45,7 @@ final class Version20190818160000 extends AbstractErgonodeMigration
             'Ergonode\Workflow\Domain\Event\Workflow\WorkflowStatusRemovedEvent' => 'Deleted status from workflow',
             'Ergonode\Workflow\Domain\Event\Workflow\WorkflowTransitionAddedEvent' => 'Added transition to workflow',
             'Ergonode\Workflow\Domain\Event\Workflow\WorkflowTransitionRemovedEvent' => 'Deleted transition from workflow',
+            'Ergonode\Workflow\Domain\Event\Workflow\WorkflowDeletedEvent' => 'Workflow deleted',
         ]);
     }
 ",There should be also translations for event,php,1,1,1
"@@ -2038,11 +2038,6 @@ class ClassTemplateTest extends TestCase
                         public function __construct(Foo $v) {
                             $this->vector = $v;
                         }
-
-                        public function getIterator(): Iterator
-                        {
-                            yield from $this->vector;
-                        }
                     }',
                 [],
                 ['TooManyTemplateParams']",Why are you removing this? The test isn't testing anything proper without this yield,php,1,1,1
"@@ -557,14 +557,14 @@ class Layout_Blog extends Base_Customizer {
 		);
 
 		if ( empty( $value ) ) {
-			return $allowed;
+			return wp_json_encode( $allowed );
 		}
 
 		$decoded = json_decode( $value, true );
 
 		foreach ( $decoded as $val ) {
 			if ( ! in_array( $val, $allowed, true ) ) {
-				return $allowed;
+				return wp_json_encode( $allowed );
 			}
 		}
 ","Same thing here: the sanitize function should only confirm that the format is proper, not adapt it.",php,1,1,1
"@@ -0,0 +1,9 @@
+<?php
+
+namespace Psalm\Issue;
+
+class InvalidTypeImport extends CodeIssue
+{
+    const ERROR_LEVEL = 7;
+    const SHORTCODE = 233;
+}","Not sure about the level, feel free to adjust.",php,1,0,1
"@@ -17,11 +17,15 @@ use Nette\Utils\Strings;
 class ErgoPrinter extends Printer
 {
     /**
+     * {@inheritdoc}
+     *
      * @var string
      */
     protected $indentation = '    ';
 
     /**
+     * {@inheritdoc}
+     *
      * @var int
      */
     protected $linesBetweenMethods = 1;",Why whithout type?,php,1,0,1
"@@ -13,7 +13,7 @@ class Currency
     const CODE_CZK = 'CZK';
     const CODE_EUR = 'EUR';
 
-    const DEFAULT_EXCHANGE_RATE = 1;
+    const DEFAULT_EXCHANGE_RATE = '1';
 
     /**
      * @var int","to me, it looks more like recasting than fixing typehint, but OK does make sense to join `Currency DEFAULT_EXCHANGE_RATE` into `Currency::$DEFAULT_EXCHANGE_RATE` ?",php,1,1,1
"@@ -82,7 +82,7 @@ class OrderData
     public $country;
 
     /**
-     * @var bool|null
+     * @var bool
      */
     public $deliveryAddressSameAsBillingAddress;
 ","shouldn't we do the same for at least one of these `FrontOrderData`, `ProductFilterData` ?",php,0,1,1
"@@ -456,6 +456,11 @@ func writeDrupal6DdevSettingsFile(settings *DrupalSettings, filePath string) err
 // WriteDrushrc writes out drushrc.php based on passed-in values.
 // This works on Drupal 6 and Drupal 7 or with drush8 and older
 func WriteDrushrc(app *DdevApp, filePath string) error {
+	// Ignore because this is a settings file.
+	if app.DisableSettingsManagement {
+		return nil
+	}
+
 	if fileutil.FileExists(filePath) {
 		// Check if the file is managed by ddev.
 		signatureFound, err := fileutil.FgrepStringInFile(filePath, DdevFileSignature)","This isn't incorrect IMO, but I think it would be better to fix this in drupal7PostStartAction and also in drupal6PostStartAction. It seems to me like those were both somehow neglected on this. Use drupal8PostStartAction as example. Congrats on your first golang PR! Please make sure to test it manually.",php,1,1,1
"@@ -32,8 +32,11 @@ class ActionConfigPass implements ConfigPassInterface
     {
         $backendConfig = $this->processDisabledActions($backendConfig);
         $backendConfig = $this->normalizeActionsConfig($backendConfig);
+        $backendConfig = $this->normalizeBatchActionsConfig($backendConfig);
         $backendConfig = $this->resolveActionInheritance($backendConfig);
+        $backendConfig = $this->resolveBatchActionInheritance($backendConfig);
         $backendConfig = $this->processActionsConfig($backendConfig);
+        $backendConfig = $this->processBatchActionsConfig($backendConfig);
 
         return $backendConfig;
     }","(To facilitate the review) all new code related to this file is a copy-paste of `*ActionsConfig()` methods, removing the `foreach($this->views as $view)` statements and hardcoding the `list` view value.",php,0,1,1
"@@ -10,15 +10,15 @@ return [
         'invalid_file_extension' => 'Extensión de archivo inválida: :invalid. Las extensiones permitidas son: :allowed.',
         'error_deleting' => 'Error borrando el archivo template "":name"". Por favor, revisa los permisos de escritura.',
         'delete_success' => 'Los templates fueron borrados satisfactoriamente: :count.',
-	'file_name_required' => 'Falta el nombre del campo del archivo.',
-	'safe_mode_enabled' => 'Modo seguro esta actualmente activado.'
+    'file_name_required' => 'Falta el nombre del campo del archivo.',
+    'safe_mode_enabled' => 'Modo seguro esta actualmente activado.'
     ],
     'dashboard' => [
         'active_theme' => [
             'widget_title_default' => 'Sitio Web',
             'online' => 'en línea',
             'maintenance' => 'en mantenimiento',
-	    'manage_themes' => 'Gestionar plantilla'
+        'manage_themes' => 'Gestionar plantilla'
         ]
     ],
     'theme' => [","Why was this merged @daftspunk? This isn't even consistent reformatting, it looks automated to me.",php,0,1,1
"@@ -14,7 +14,7 @@ use Symfony\Component\Routing\Generator\UrlGeneratorInterface;
 
 class PersonalDataAccessMail implements MailTypeInterface, MessageFactoryInterface
 {
-    public const VARIABLE_EMAIL = '{e-mail}';
+    public const VARIABLE_EMAIL = '{email}';
     public const VARIABLE_URL = '{url}';
     public const VARIABLE_DOMAIN = '{domain}';
 ",This is a dangerous BC break as current data (email templates in DB) have to be altered. It's really necessary to point it out in the upgrade notes. same applies for `PersonalDataExportMail`,php,1,1,1
"@@ -13,6 +13,9 @@ use Shopsys\FrameworkBundle\Model\Product\Exception\ProductNotFoundException;
 use Shopsys\FrameworkBundle\Model\Product\Product;
 use Shopsys\FrameworkBundle\Model\Product\ProductFacade;
 
+/**
+ * @deprecated Use ProductByUuidResolver instead
+ */
 class ProductResolver implements ResolverInterface, AliasedInterface
 {
     /**",I am missing reason why is this class renamed. It is just obout naming or it has some other reason I do not see now?,php,1,1,1
"@@ -42,7 +42,7 @@ trait PsalmRunnerTrait
             $process->mustRun();
         } else {
             $process->run();
-            $this->assertGreaterThan(0, $process->getExitCode());
+            $this->assertEquals(2, $process->getExitCode());
         }
 
         return [","As Psalm now always return exit code 2 when it detects issues, we expect that when `$shouldFail === true`, and let unexpected exceptions be reported as test failures.",php,1,1,1
"@@ -195,7 +195,9 @@ BEGIN_EVENT_TABLE (CAdvancedFrame, CBOINCBaseFrame)
     EVT_MENU(ID_HELPBOINCMANAGER, CAdvancedFrame::OnHelpBOINC)
     EVT_MENU(ID_HELPBOINCWEBSITE, CAdvancedFrame::OnHelpBOINC)
     EVT_MENU(wxID_ABOUT, CAdvancedFrame::OnHelpAbout)
+#ifdef ENABLE_NEW_VERSION_CHECK
     EVT_MENU(ID_CHECK_VERSION, CAdvancedFrame::OnCheckVersion)
+#endif
     EVT_MENU(ID_REPORT_BUG, CAdvancedFrame::OnReportBug)
     EVT_HELP(wxID_ANY, CAdvancedFrame::OnHelp)
     // Custom Events & Timers","As I told you before, there are two additional OSs we support: Windows and OSX. If you build BOINC Manager for linux to control BOINC client for linux - this works perfect. But if you decide to control BOINC client for Windows or OSX with BOINC Manager for Linux - then you'll have no way to check for a new version of BOINC client for that particular OS. The same if applicable for BOINC Manager for Windows or OSX, I'll have an option to check for a new version that will do basically nothing because this functionality just dropped from the BOINC client for linux.",php,0,1,0
"@@ -96,6 +96,16 @@ class ConfigQuery extends BaseConfigQuery
         return self::read('rewriting_enable') == 1;
     }
 
+    public static function isSeoTransliteratorEnable()
+    {
+        return self::read('enable_seo_transliterator') == 1;
+    }
+
+    public static function isEndingWithHtml()
+    {
+        return self::read('enable_html_ending_in_urls') == 1;
+    }
+
     public static function getPageNotFoundView()
     {
         return self::read('page_not_found_view', '404.html');",`isUrlHtmlEndingEnabled` is better,php,1,0,1
"@@ -77,7 +77,7 @@ static void get_user_agent_string() {
     );
     if (strlen(gstate.client_brand)) {
         char buf[256];
-        snprintf(buf, sizeof(buf), "" (%s)"", gstate.client_brand);
+        snprintf(buf, sizeof(buf), "" (%.80s)"", gstate.client_brand);
         safe_strcat(g_user_agent_string, buf);
     }
 }",Why this is cut to 80 symbols?,php,1,1,1
"@@ -30,7 +30,7 @@ var DBATag = ""v0.2.0""
 var RouterImage = ""drud/nginx-proxy"" // Note that this is overridden by make
 
 // RouterTag defines the tag used for the router.
-var RouterTag = ""v0.3.0"" // Note that this is overridden by make
+var RouterTag = ""router-expose"" // Note that this is overridden by make
 
 // COMMIT is the actual committish, supplied by make
 var COMMIT = ""COMMIT should be overridden""",Update to real tag before pull.,php,1,1,1
"@@ -11,12 +11,16 @@
 
 namespace Sonata\MediaBundle\CDN;
 
+use Symfony\Bundle\FrameworkBundle\Templating\Helper\AssetsHelper;
+
 class Server implements CDNInterface
 {
+    protected $path;
+
     /**
-     * @var string
+     * @var AssetsHelper
      */
-    protected $path;
+    private $assetsHelper;
 
     /**
      * @param string $path",this is a BC break,php,1,0,1
"@@ -123,4 +123,9 @@ interface ProductOnCurrentDomainFacadeInterface
      * @return array
      */
     public function getProductsOnCurrentDomain(int $limit, int $offset, string $orderingModeId): array;
+
+    /**
+     * @return int
+     */
+    public function getProductsCountOnCurrentDomain(): int;
 }",Should it be called `getAllListableProductCount...`?,php,1,1,1
"@@ -35,8 +35,11 @@ class CurlDownloader implements DownloaderInterface
      *
      * @throws DownloaderException
      */
-    public function download(string $url, array $headers = []): string
+    public function download(string $url, array $headers = [], string $acceptedHeaderTypes = null): string
     {
+        if (null !== $acceptedHeaderTypes) {
+            throw new DownloaderException('CurlDownloader not supported param `acceptedHeaderTypes`');
+        }
         $ch = curl_init();
         curl_setopt($ch, CURLOPT_HEADER, 0);
         curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);","IMHO acceptedHeaderTypes should be array not string, or I miss somthing ??",php,1,1,1
"@@ -80,6 +80,7 @@ class Data extends AbstractData {
 
     if (isset($downloadUrl) && !filter_var($downloadUrl, FILTER_VALIDATE_URL)) {
       $resourceIdentifier = $downloadUrl;
+      $ref = NULL; $original = NULL;
       [$ref, $original] = $this->retrieveDownloadUrlFromResourceMapper($resourceIdentifier);
 
       $downloadUrl = isset($original) ? $original : """";",My guess is you added these because Code Climate thinks these are undefined...,php,1,1,1
"@@ -13,7 +13,7 @@
 
 return [
     'accepted'             => 'Pole musi zostać zaakceptowane.',
-    'accepted_if'          => 'This field must be accepted when :other is :value.',
+    'accepted_if'          => 'Pole :attribute musi zostać zaakceptowane gdy :other ma wartość :value.',
     'active_url'           => 'Pole jest nieprawidłowym adresem URL.',
     'after'                => 'Pole musi być datą późniejszą od :date.',
     'after_or_equal'       => 'Pole musi być datą nie wcześniejszą niż :date.',",There is not :attribute tag here,php,1,1,1
"@@ -16,9 +16,7 @@ use Sonata\MediaBundle\Model\MediaInterface;
 interface GeneratorInterface
 {
     /**
-     * @abstract
-     *
-     * @param \Sonata\MediaBundle\Model\MediaInterface $media
+     * @param MediaInterface $media
      *
      * @return string
      */",why removing this? @core23 ping @Soullivaneuh,php,0,0,1
"@@ -237,6 +237,7 @@ class ReturnTypeAnalyzer
             foreach ($inferred_return_type_parts as $inferred_return_type_part) {
                 if ($inferred_return_type_part->isVoid()) {
                     $unsafe_return_type = true;
+                    break;
                 }
             }
         }",Loops that only flags a variable should break as soon as possible to avoid useless iterations.,php,1,1,1
"@@ -1,6 +1,7 @@
 <?php
 namespace Psalm\Tests;
 
+use Person;
 use Psalm\Tests\Traits\InvalidCodeAnalysisTestTrait;
 use Psalm\Tests\Traits\ValidCodeAnalysisTestTrait;
 ","Not sure how that will play out, this is not an existing class",php,1,1,1
"@@ -158,14 +158,6 @@ class Controller extends ControllerBase
          */
         $this->user = BackendAuth::getUser();
 
-        /*
-         * Media Manager widget is available on all back-end pages
-         */
-        if ($this->user && $this->user->hasAccess('media.*')) {
-            $manager = new MediaManager($this, 'ocmediamanager');
-            $manager->bindToController();
-        }
-
         $this->extendableConstruct();
     }
 ",@alxy @bennothommo doesn't this mean that the MediaManager widget is now bound to the controller once for every single instance of a field that uses it? That seems a bit excessive.,php,0,1,1
"@@ -60,8 +60,11 @@ class DbalLogQuery implements LogQueryInterface
     private function getQuery(): QueryBuilder
     {
         return $this->connection->createQueryBuilder()
-            ->select('es.id, event, payload, recorded_at, recorded_by AS author_id, coalesce(u.first_name || \' \' || u.last_name, \'System\') AS author')
-            ->leftJoin('es', 'users', 'u', 'u.id = es.recorded_by')
-            ->from('event_store', 'es');
+            ->select('es.id, payload, recorded_at, recorded_by AS author_id')
+            ->addSelect('coalesce(u.first_name || \' \' || u.last_name, \'System\') AS author')
+            ->addSelect('ese.translation_key as event')
+            ->from('event_store', 'es')
+            ->join('es', 'event_store_event', 'ese', 'es.event = ese.id')
+            ->leftJoin('es', 'users', 'u', 'u.id = es.recorded_by');
     }
 }",It be better if you name event_id instead of event id in name give you information about relation,php,1,1,1
"@@ -1416,13 +1416,12 @@ void process_request(char* code_sign_key) {
             if (config.min_sendwork_interval) {
                 double diff = dtime() - last_rpc_time;
                 if (diff < config.min_sendwork_interval) {
-                    double t_left = config.min_sendwork_interval - diff;
                     ok_to_send_work = false;
                     log_messages.printf(MSG_NORMAL,
-                        ""Not sending work - last request too recent, please wait: %f\n"", t_left
+                        ""Not sending work - last request too recent, please wait: %f\n"", config.min_sendwork_interval
                     );
                     sprintf(buf,
-                        ""Not sending work - last request too recent, please wait: %d sec"", (int)t_left
+                        ""Not sending work - last request too recent, please wait: %d sec"", (int)config.min_sendwork_interval
                     );
                     g_reply->insert_message(buf, ""low"");
 ","This means that user will always see the, let's say, 'default' delay interval even if there is less time left before he can do next request. E.g. There is a default delay of 60 sec. User waits 59 seconds, make another request and see the message that he should wait for 60 seconds more while in fact he had to wait only 1 second before doing next request. Isn't this misleading a little bit?",php,1,1,1
"@@ -51,16 +51,14 @@ class DbalConditionSetQuery implements ConditionSetQueryInterface
     /**
      * @return array
      */
-    public function findNumericConditionRelations(AttributeId $attributeId): array
+    public function findAttributeIdConditionRelations(AttributeId $attributeId): array
     {
         $qb = $this->connection->createQueryBuilder();
 
         $records = $qb->select('id')
             ->from(self::TABLE)
-            ->where($qb->expr()->eq('conditions->0->>\'type\'', ':type'))
-            ->where($qb->expr()->eq('conditions->0->>\'attribute\'', ':attribute_id'))
-            ->setParameter(':type', 'NUMERIC_ATTRIBUTE_VALUE_CONDITION')
-            ->setParameter(':attribute_id', $attributeId->getValue())
+            ->where('conditions::text ILIKE :attribute_id')
+            ->setParameter(':attribute_id', '%'.$attributeId->getValue().'%')
             ->execute()
             ->fetchAll(\PDO::FETCH_COLUMN);
 ",I don't really like the solution. Though unlikely it may occur that there will be text or id assigned to another type of entity matching. What is the reasoning for that?,php,1,1,1
"@@ -25,6 +25,9 @@ func TestWriteDrupalConfig(t *testing.T) {
 	err = WriteDrupalConfig(drupalConfig, file.Name())
 	assert.NoError(t, err)
 
+	os.Chmod(dir, 0755)
+	os.Chmod(file.Name(), 0666)
+
 	err = os.RemoveAll(dir)
 	assert.NoError(t, err)
 }",Please check the return on these.,php,1,1,1
"@@ -561,6 +561,10 @@ class Folio extends AbstractAPI implements
                 $locationData = $this->getLocationData($locationId);
                 $locationName = $locationData['name'];
                 $locationCode = $locationData['code'];
+                $holdingCallNumber = $holding->callNumber ?? '';
+                $holdingCallNumberPrefix = $holding->callNumberPrefix ?? '';
+                $itemCallNumber = $item->itemLevelCallNumber ?? '';
+                $itemCallNumberPrefix = $item->itemLevelCallNumberPrefix ?? '';
                 $items[] = [
                     'id' => $bibId,
                     'item_id' => $item->id,",I think you could actually move the two holding-related variable declarations above the foreach loop that's iterating over items in order to avoid a little bit of redundant work.,php,1,1,1
"@@ -47,8 +47,8 @@ return [
     'in_array'             => 'שדה :attribute לא קיים ב:other.',
     'integer'              => 'שדה :attribute חייב להיות מספר שלם.',
     'ip'                   => 'שדה :attribute חייב להיות כתובת IP תקנית.',
-    'ipv4'                 => 'The :attribute must be a valid IPv4 address.',
-    'ipv6'                 => 'The :attribute must be a valid IPv6 address.',
+    'ipv4'                 => 'שדה :attribute חייב להיות כתובת IPv4 תקנית.',
+    'ipv6'                 => 'The :attribute חייב להיות כתובת IPv6 תקנית.',
     'json'                 => 'שדה :attribute חייב להיות מחרוזת JSON תקנית.',
     'max'                  => [
         'numeric' => 'שדה :attribute אינו יכול להיות גדול מ-:max.',","Hello, you forgot ""The""",php,1,1,1
"@@ -554,7 +554,7 @@ class SimpleAssertionReconciler extends Reconciler
                 if (!$array_atomic_type instanceof TNonEmptyArray
                     || ($array_atomic_type->count < $min_count)
                 ) {
-                    if ($array_atomic_type->getId() === 'array<never, never>') {
+                    if (!$array_atomic_type->isEmptyArray()) {
                         $existing_var_type->removeType('array');
                     } else {
                         $non_empty_array = new TNonEmptyArray(",You inverted the condition here.,php,1,1,1
"@@ -94,8 +94,9 @@ void CLIENT_STATE::check_app(APP& p) {
 }
 
 void CLIENT_STATE::check_file_info(FILE_INFO& p) {
-    if (p.pers_file_xfer) check_pers_file_xfer_pointer(p.pers_file_xfer);
-    if (p.result) check_result_pointer(p.result);
+    if (p.pers_file_xfer) {
+        check_pers_file_xfer_pointer(p.pers_file_xfer);
+    }
     check_project_pointer(p.project);
 }
 ","Last question before merge - it looks like this was a refactor to put parenthesis around the if statement. However, it also removed the line `if (p.result) check_result_pointer(p.result);` was that intended?",php,1,1,1
"@@ -25,12 +25,16 @@ use Thelia\Core\Security\SecurityContext;
 use Thelia\Exception\TheliaProcessException;
 use Thelia\Mailer\MailerFactory;
 use Thelia\Model\AddressQuery;
+use Thelia\Model\Base\ProductDocumentQuery;
 use Thelia\Model\Cart as CartModel;
 use Thelia\Model\ConfigQuery;
 use Thelia\Model\Currency as CurrencyModel;
 use Thelia\Model\Customer as CustomerModel;
 use Thelia\Model\Lang as LangModel;
 use Thelia\Model\Map\OrderTableMap;
+use Thelia\Model\MessageQuery;
+use Thelia\Model\MetaData as MetaDataModel;
+use Thelia\Model\MetaDataQuery;
 use Thelia\Model\Order as ModelOrder;
 use Thelia\Model\OrderAddress;
 use Thelia\Model\OrderProduct;","Be careful, you use the base model",php,1,1,1
"@@ -9,7 +9,7 @@ use Cms\Contracts\CmsObject as CmsObjectContract;
 use ApplicationException;
 use ValidationException;
 use Exception;
-
+use Cms\Classes\Theme;
 /**
  * This is a base class for all CMS objects - content files, pages, partials and layouts.
  * The class implements basic operations with file-based templates.",Why is this necessary? The Theme class exists within this namespace.,php,1,1,1
"@@ -308,7 +308,11 @@ class ProjectAnalyzer
         $file_extensions = $this->config->getFileExtensions();
 
         foreach ($this->config->getProjectDirectories() as $dir_name) {
-            $file_paths = $this->file_provider->getFilesInDir($dir_name, $file_extensions);
+            $file_paths = $this->file_provider->getFilesInDir(
+                $dir_name,
+                $file_extensions,
+                [$this->config, 'isInProjectDirs']
+            );
 
             foreach ($file_paths as $file_path) {
                 if ($this->config->isInProjectDirs($file_path)) {","With the filter pushed down to the iterator, do we still need to check whether the returned file paths are in project / extra dirs?",php,1,1,1
"@@ -54,7 +54,7 @@ class DbalBatchActionQuery implements BatchActionQueryInterface
             $record['all'],
             $record['processed'],
             new \DateTime($record['created_at']),
-            $record['all'] === $record['processed'] ? new \DateTime($record['last_processed_at']) : null
+            $record['all'] === $record['processed'] ? new \DateTime($record['last_processed_at'] ?? $record['created_at']) : null
         );
 
         foreach ($this->getEntries($id, $language) as $entry) {",This seems redundant and not related,php,1,0,1
"@@ -8,7 +8,7 @@
  * @package Neve
  */
 
-define( 'NEVE_VERSION', '2.11.6' );
+define( 'NEVE_VERSION', '3.0.0' );
 define( 'NEVE_INC_DIR', trailingslashit( get_template_directory() ) . 'inc/' );
 define( 'NEVE_ASSETS_URL', trailingslashit( get_template_directory_uri() ) . 'assets/' );
 define( 'NEVE_MAIN_DIR', get_template_directory() . '/' );",Let's make sure this is set to the old version before we merge it,php,1,1,1
"@@ -0,0 +1,17 @@
+<?php
+/**
+ * Copyright © Bold Brand Commerce Sp. z o.o. All rights reserved.
+ * See LICENSE.txt for license details.
+ */
+
+declare(strict_types=1);
+
+namespace Ergonode\Core\Infrastructure\Exception;
+
+class DeserializationException extends SerializerException
+{
+    public function __construct(string $message, \Throwable $previous = null)
+    {
+        parent::__construct($message, $previous);
+    }
+}",I think it should been in `SharedKernel` module.,php,1,0,1
"@@ -535,6 +535,10 @@ class MediaLibrary
     {
         $path = $this->validatePath($path);
 
+        if (Config::get('cms.storage.media.disk') === 'local') {
+            return $this->storagePath . $path;
+        }
+
         $fullPath = $this->storagePath.implode(""/"", array_map(""rawurlencode"", explode(""/"", $path)));
 
         return Url::to($fullPath);",Shouldn't you put the check after this line and return fullPath instead?,php,1,1,1
"@@ -664,6 +664,7 @@ static void handle_acct_mgr_info(GUI_RPC_CONN& grc) {
         || strlen(gstate.acct_mgr_info.authenticator)
     ) {
         grc.mfout.printf(""   <have_credentials/>\n"");
+	grc.mfout.printf(""   <authenticator>%s</authenticator>\n"", gstate.acct_mgr_info.authenticator);
     }
 
     if (gstate.acct_mgr_info.cookie_required) {",Can you replace the tab with spaces so that it properly indents? Thanks!,php,1,1,1
"@@ -96,7 +96,9 @@ class ContentEditController extends BaseController
 
     private function updateFieldFromPost(string $key, $postfield, Content $content): void
     {
-        if (! $field = $content->getField($key)) {
+        if ($content->getField($key)) {
+            $field = $content->getField($key);
+        } else {
             $fields = collect($content->getDefinition()->get('fields'));
             $field = Field::factory($fields->get($key)['type']);
             $field->setName($key);",do we have $content->hasField($key) ?,php,1,1,1
"@@ -22,7 +22,7 @@ use Sonata\MediaBundle\Model\MediaInterface;
 class SimpleResizer implements ResizerInterface
 {
     /**
-     * @var ImagineInterface
+     * @var ImagineInterface.
      */
     protected $adapter;
 ",Please remove the `.`,php,1,1,1
"@@ -33,6 +33,7 @@ class DbalDataSetFactory
         $result->select('*');
         $result->from(sprintf('(%s)', $queryBuilder->getSQL()), 't');
         $result->setParameters($queryBuilder->getParameters(), $queryBuilder->getParameterTypes());
+        $result->distinct();
 
         return new DbalDataSet($result, $this->filterBuilderProvider);
     }",Why distinct in main factory ? IMHO use distinct in this case can by only hiding a problem not a resolving it. Are we sure that fetching duplicated data is not inserting or query problem ??,php,1,1,1
"@@ -1,5 +1,6 @@
 <?php
 
+use Cms\Classes\LayoutCode;
 use Cms\Classes\Page;
 use Cms\Classes\Theme;
 use Cms\Classes\Layout;",I'd prefer the `use` statements were in order,php,1,1,1
"@@ -127,7 +127,8 @@ class ProductPriceCalculation
 
         $minimumPrice = null;
         foreach ($prices as $price) {
-            if ($minimumPrice === null || $price->getPriceWithoutVat() < $minimumPrice->getPriceWithoutVat()) {
+            /** @var \Shopsys\FrameworkBundle\Model\Pricing\Price|null $minimumPrice */
+            if ($minimumPrice === null || $price->getPriceWithoutVat()->isLessThan($minimumPrice->getPriceWithoutVat())) {
                 $minimumPrice = $price;
             }
         }",I think even `Price` should have `isLessThan` method,php,1,1,1
"@@ -215,9 +215,13 @@ class IndexingConfigurationSelectorField {
 			)
 		);
 
-		$selectFieldRenderer = $formEngine = GeneralUtility::makeInstance('TYPO3\\CMS\\Backend\\Form\\FormEngine');
-		if (!method_exists($selectFieldRenderer, 'getSingleField_typeSelect_checkbox')) {
-			if (class_exists('TYPO3\\CMS\Backend\\Form\\Element\\SelectElement')) {
+		$selectFieldRenderer = $formEngine = NULL;
+		if (class_exists('TYPO3\\CMS\\Backend\\Form\\FormEngine')) {
+			$selectFieldRenderer = $formEngine = GeneralUtility::makeInstance('TYPO3\\CMS\\Backend\\Form\\FormEngine');
+		}
+
+		if (!isset($selectFieldRenderer) || !method_exists($selectFieldRenderer, 'getSingleField_typeSelect_checkbox')) {
+			if (class_exists('TYPO3\\CMS\Backend\\Form\\Element\\SelectElement') && isset($formEngine)) {
 				// TYPO3 CMS 7.2
 				$selectFieldRenderer = GeneralUtility::makeInstance('TYPO3\\CMS\Backend\\Form\\Element\\SelectElement', $formEngine);
 			} elseif (class_exists('TYPO3\\CMS\\Backend\\Form\\Element\\SelectCheckBoxElement')) {",There is an Backslash missing `TYPO3\\CMS\Backend...`,php,1,1,1
"@@ -20,7 +20,7 @@ return [
     'alpha_dash'           => 'Este campo pode conter apenas letras, números, traços e o caractere de sublinhado.',
     'alpha_num'            => 'Este campo pode conter apenas letras e números',
     'array'                => 'Este campo deve ser uma matriz.',
-    'attached'             => 'This field is already attached.',
+    'attached'             => 'Este campo já está ligado.',
     'before'               => 'Esta deve ser uma data anterior a :date.',
     'before_or_equal'      => 'Esta deve ser uma data anterior ou igual a :date.',
     'between'              => [",I believe it should be 'Este campo j est anexado.' just like in locales/pt/validation.php,php,1,1,1
"@@ -27,7 +27,7 @@ final class CategoryManager implements CategoryManagerInterface
      */
     private $categoryManager;
 
-    public function __construct(ManagerInterface $categoryManager)
+    public function __construct(?ManagerInterface $categoryManager = null)
     {
         $this->categoryManager = $categoryManager;
     }",why it this change needed?,php,1,0,1
"@@ -853,6 +853,19 @@ class DefaultRecord extends AbstractBase
         return $params;
     }
 
+    /**
+     * Get an alternate display title.
+     *
+     * @return string
+     */
+    public function getAlternateDisplayTitle()
+    {
+        $format = '%s %s';
+        $short = $this->fields['alt_title_short'] ?? '';
+        $sub = $this->fields['alt_title_sub'] ?? '';
+        return sprintf($short, $sub);
+    }
+
     /**
      * Get the OpenURL parameters to represent this record (useful for the
      * title attribute of a COinS span tag).","I did this for convenience but maybe this should be split out into two functions like the corresponding ""normal"" fields are? Or maybe the corresponding fields could be combined into 1 function, e.g. `getDisplayTitle`? I wasn't sure what to do here so I just did something quick and easy. I'm not sure if it's problematic though.",php,0,0,1
"@@ -66,7 +66,7 @@ class StatusGridBuilder implements GridBuilderInterface
                     'method' => Request::METHOD_DELETE,
                 ],
             ]))
-            ->orderBy('code', 'DESC');
+            ->orderBy('index', 'ASC');
 
         return $grid;
     }",Its working without changing in DbalStatusGridQuery:getGridQuery ?,php,1,1,1
"@@ -192,7 +192,17 @@ class MultiBackend extends AbstractBase implements \Zend\Log\LoggerAwareInterfac
     {
         $items = [];
         foreach ($ids as $id) {
-            $items[] = $this->getStatus($id);
+            try {
+                $items[] = $this->getStatus($id);
+            } catch (ILSException $e) {
+                $items[] = [
+                    [
+                        'id' => $id,
+                        'error' => 'An error has occurred',
+                        'availability_message' => 'status_unknown_message'
+                    ]
+                ];
+            }
         }
         return $items;
     }","If you find a way to display the full unknown message above, it may be necessary to devise a different mechanism for filling it in in this situation. Maybe any entry with 'error' set automatically gets 'availability_message' set to unknown.",php,1,1,1
"@@ -39,6 +39,8 @@
 #include <vector>
 #include <string>
 #include <cstring>
+#include <tuple>
+#include <set>
 #endif
 
 #if HAVE_XSS",I'm not sure this is available in VS2010,php,1,1,1
"@@ -11,7 +11,9 @@ use Symfony\Component\Console\Output\OutputInterface;
 
 class DatabaseDumpCommand extends Command
 {
+    /** @access private */
     const ARG_OUTPUT_FILE = 'outputFile';
+    /** @access private */
     const OPT_PGDUMP_BIN = 'pgdump-bin';
 
     /**","Shouldn't argument names be public? I'd guess they might come handy when calling the command programatically or during an extension. As an example, take a look at `ServerStartWithCustomRouterCommand` which would definitely use a `ServerStartCommand::ARG_ROUTER` constant if it were declared (now it uses only the literal string `'router'`). Or did you have some other reason for the private visibility in mind?",php,1,1,0
"@@ -40,8 +40,8 @@ return [
     | or doing any other checks to ensure the service is functional.
     |
     */
-    
-    'preflight' => false,
+
+    'preflight' => true,
 
     /*
     |--------------------------------------------------------------------------","As a compromise, I would say to have preflight set to WP_ENV !== 'production' or something so that by default it's not enabled in production.",php,1,1,1
"@@ -52,7 +52,7 @@ final class Metadata implements MetadataInterface
     ) {
         $this->title = $title;
         $this->description = $description;
-        $this->image = null !== $image ? $image : 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAADnCAYAAADl9EEgAAAXfWlDQ1BJQ0MgUHJvZmlsZQAAWAmtWWVYVU3Xnn0KOBy6u7u7u7sbgUN3NyopUkoISIoggqCCQYmIiCCCiKACBiAhkiqooAjIu0F93ufH9/779nWdvW/W3GvNmlkzs/daAMDQgg8NDUSQAxAUHBluqafJbu/gyE7wFhACKkAHhAEG7xERqmFubgz+57U9AaDDxhcih7b+J+3/bqDw9IrwAAAyh5vdPSM8gmDcAgCizSM0PBIA1KE9rpjI0EOcB2PqcNhBGNceYp/fuOMQu//Gw0cca0stmDMLACEOjw/3AQC3DsvZoz18YDskOAAwlMGefsEAULHDWNXDF+8JAIMbzBEOCgo5xDkw5nf/lx2ff2E83v0fm3i8zz/491hgTbhjbb+I0EB83NEf/5+3oMAoeL6OLlr4jguN1LSEn/TwvNH7RRpYw5gaxuK+Ufo2f7B2vK+13SEXltsHu5uawZgSxp4eEVrwXALYDhQdEGJ0aOeQk+Pppa0DY3hVQCUR0VZ/8ZV4Xy3TPxx7f7zhYcxIYU4HPhxGv/t9FBppfujDoc03wYGmxn/whne47qF9WI7AeEXoWMEY9gHBHBlufSiHfUaIevvpGsAY7hehGRp4tOYOOZbhUZaHY+GGsadXsM1f3QxPvLYRLGeG5WXAGGgBbcAO30NAIPwLB37AE37+lXv8S24F4sFHEAy8QASsccRw9UsJ/4uBLsDD+j5wu8gffc0jiReIhrX2//JG1tvX/+I/Ou7/aOiC90c2/lgQvyq+Ir73l81O9tcvjA5GG6OP0cUI/JXAPf0eRfiRf0bwaLxAFGzLC+77rz//HlXUP4x/S3/PgeWRVgDM8PvbN7A98szvH1tG/8zMn7lA8aIkUTIoTZQKShWlANhRtChGIIKSRsmjNFBqKCW4TeFf8/xH64//IsD7aK6ij7wPAB9gz+FdHekVGwnHCmiFhMaF+/n4RrJrwKeFlzC7QbCHqDC7pLiEBDg8ew45AHy1PDpTINpn/5V5LQOgDK8NotH/yvzPAdDYDwBd1n9lvE7w/hUG4OZzj6jw6N/2UIcPNMACMnilMQBWwAX44fFLAlmgBNSBDjAEZsAaOAAX4AF8YX/DQQw4DpJBOsgGeaAIlIEqcAlcAdfBLdAOusAD8Ag8AaNgHLwFs2ARrIENsA12IQgigEggKogBYoN4ICFIEpKHVCEdyBiyhBwgN8gHCoaioONQKpQNFUBlUDXUAN2E7kAPoEFoDHoNzUEr0BfoJwKJwCGoESwIXoQYQh6hgTBCWCOOIXwQYYh4RBriLKIEUYO4hmhDPEA8QYwjZhFriC0kQBIjaZEcSBGkPFILaYZ0RHojw5EnkVnIYmQNsgnZiRxAvkDOIteROygMigrFjhKBY6mPskF5oMJQJ1E5qDLUFVQbqg/1AjWH2kD9QpOgmdFCaEW0Adoe7YOOQaeji9F16FZ0P3ocvYjexmAwtBg+jBy8fh0w/pgETA6mEtOM6cGMYRYwWwQEBAwEQgQqBGYEeIJIgnSCUoJrBPcJnhMsEvwgJCZkI5Qk1CV0JAwmTCEsJmwk7CZ8TrhEuEtETsRDpEhkRuRJFEeUS1RL1En0jGiRaBdLgeXDqmCtsf7YZGwJtgnbj53CfiUmJuYkViC2IPYjTiIuIb5B/Jh4jngHR4kTxGnhnHFRuLO4elwP7jXuKwkJCS+JOokjSSTJWZIGkockMyQ/SKlIRUkNSD1JE0nLSdtIn5N+IiMi4yHTIHMhiycrJrtN9oxsnZyInJdcixxPfpK8nPwO+ST5FgUVhQSFGUUQRQ5FI8UgxTIlASUvpQ6lJ2Ua5SXKh5QLVEgqLiotKg+qVKpaqn6qRWoMNR+1AbU/dTb1deoR6g0aShppGluaWJpymns0s7RIWl5aA9pA2lzaW7QTtD/pWOg06LzoMuma6J7Tfadnolen96LPom+mH6f/ycDOoMMQwJDP0M4wzYhiFGS0YIxhvMDYz7jORM2kxOTBlMV0i+kNM4JZkNmSOYH5EvMw8xYLK4seSyhLKctDlnVWWlZ1Vn/WQtZu1hU2KjZVNj+2Qrb7bKvsNOwa7IHsJex97BsczBz6HFEc1RwjHLucfJw2nCmczZzTXFgueS5vrkKuXq4NbjZuE+7j3Fe53/AQ8cjz+PKc5xng+c7Lx2vHe5q3nXeZj57PgC+e7yrfFD8Jvxp/GH8N/0sBjIC8QIBApcCoIEJQRtBXsFzwmRBCSFbIT6hSaEwYLawgHCxcIzwpghPREIkWuSoyJ0oraiyaItou+kmMW8xRLF9sQOyXuIx4oHit+FsJSglDiRSJTokvkoKSHpLlki+lSKR0pRKlOqQ2pYWkvaQvSL+SoZIxkTkt0yuzLysnGy7bJLsixy3nJlchNylPLW8unyP/WAGtoKmQqNClsKMoqxipeEvxs5KIUoBSo9KyMp+yl3Kt8oIKpwpepVplVpVd1U31ouqsGocaXq1GbV6dS91TvU59SUNAw1/jmsYnTXHNcM1Wze9ailontHq0kdp62lnaIzqUOjY6ZTozupy6PrpXdTf0ZPQS9Hr00fpG+vn6kwYsBh4GDQYbhnKGJwz7jHBGVkZlRvPGgsbhxp0mCBNDk3MmU6Y8psGm7WbAzMDsnNm0OZ95mPldC4yFuUW5xQdLCcvjlgNWVFauVo1W29aa1rnWb234baJsem3JbJ1tG2y/22nbFdjN2ovZn7B/4sDo4OfQ4UjgaOtY57jlpONU5LToLOOc7jxxjO9Y7LFBF0aXQJd7rmSueNfbbmg3O7dGtz28Gb4Gv+Vu4F7hvuGh5XHeY81T3bPQc8VLxavAa8lbxbvAe9lHxeecz4qvmm+x77qfll+Z36a/vn+V//cAs4D6gINAu8DmIMIgt6A7wZTBAcF9IawhsSFjoUKh6aGzYYphRWEb4UbhdRFQxLGIjkhq+CNvOIo/6lTUXLRqdHn0jxjbmNuxFLHBscNxgnGZcUvxuvGXE1AJHgm9xzmOJx+fO6FxovokdNL9ZG8iV2Ja4mKSXtKVZGxyQPLTFPGUgpRvqXapnWksaUlpC6f0Tl1NJ00PT588rXS6KgOV4ZcxkimVWZr5K8szayhbPLs4ey/HI2fojMSZkjMHZ73PjuTK5l7Iw+QF503kq+VfKaAoiC9YOGdyrq2QvTCr8FuRa9FgsXRx1Xns+ajzsyXGJR2l3KV5pXtlvmXj5ZrlzRXMFZkV3ys9K59fUL/QVMVSlV3186LfxVfVetVtNbw1xZcwl6Ivfai1rR24LH+5oY6xLrtuvz64fvaK5ZW+BrmGhkbmxtyriKtRV1euOV8bva59vaNJpKm6mbY5+wa4EXVj9abbzYlbRrd6b8vfbmrhaalopWrNaoPa4to22n3bZzscOsbuGN7p7VTqbL0rere+i6Or/B7NvdxubHda98H9+PtbPaE96w98Hiz0uva+fWj/8GWfRd9Iv1H/40e6jx4OaAzcf6zyuGtQcfDOkPxQ+xPZJ23DMsOtT2Weto7IjrQ9k3vWMaow2jmmPNb9XO35gxfaLx69NHj5ZNx0fGzCZuLVpPPk7CvPV8uvA19vvol+s/s2aQo9lTVNPl08wzxT807gXfOs7Oy9Oe254Xmr+bcLHgtr7yPe7y2mfSD5ULzEttSwLLnctaK7MrrqtLq4Frq2u57+keJjxSf+Ty2f1T8Pb9hvLG6Gbx58yfnK8LX+m/S33i3zrZntoO3d71k/GH5c2ZHfGfhp93NpN2aPYK9kX2C/85fRr6mDoIODUHw4/uhbAAnfEd7eAHyph3MBBzgHGAUAS/o7NzhiAICEYA6MbSEdhAZSHkWPxmIICcQJHYhSsfdxGBI8aTs5liKQcohahqaCDtAHMIwwyTLnsayxqbPncoxxYbkVeBx4A/iC+J0FNAVZBDeFHgmXigSIqoiRiL0Tb5ZIkrSQ4pD6KH1H5pSshRyz3KJ8k0KsooYSVumFcoWKp6qw6he1dvXjGpqaOM13Wt3ajTqVuvl6J/XxBmqG9IabRsPGTSaVptVmXeYLlmgrBmtGG3JbpO2e3a4DcCRyInUmOYY6tuUy7zrq1oO/7V7nUeqZ5RXn7eNj7avpJ+0vGMARyBBEFowM/hYyHzoadje8NuJsZGJUenRrLCrOK77nODjBe1Ix0SDJKTkq5WxqUVrCKelTC+m5p80zeDKJs0A2IofiDP9Z1VzTPLt8xwLHc/aFtkXWxRbnTUuMSvXKNMtVKxQqpS6IVAleFK82qkm9NHvZoO5a/VoDRSPPVYlrSte1m0ya7W643vS9FXo7puVka0rbqfaMjuw7uZ1Fdyu66u61dPffn+yZfTDR2/zQu4++73F/8aOYAe/HxwbthiyeGA3rPdUfsX4WNnpx7PUL4pdi41oTBpM6r+Rf87whfbPzdnnq1fSDmUvvUmd95mzmTRdM3pstmn0wXFJYplueXclalV6dXbuyHv9R/xPhp4bPep8XNi5txn5x+Wr2zWTLf7v3x+mf7fvaBwd/4i+BRCFXULPoBcwGIZJIFutLXIGbJRUkiyF/RMlAFUf9klaSLoV+mlGGKZ15lJWRzZ49n6OLc4pri3ubZ5X3Kd8l/nABVUFCwZdCVcL+IjIiv0QfiZ0Vt5Ngk1iSbJKKllaRgWT6ZbPkzOSp5CcUShWdlFiUpuBV4KzKoDqpdl7dSYNXY1dzXOumdo6Ol66yHoXeB/0ugyLDaCMvY3cTX9MQsyBzdwszSyUrQWsmG1JbhO223ZL9hMNDxyancuesY/Eufq72btp4MXd6D8hj1XPcq8+71afOt9gvzT8kwCFQPYgvmAReCXOhM2HfIjgiXaNKox/EvIpdiFuP3zlOfIL1JH8iexIm6V1ya0puaniayymbdPvTfhmpmZVZ17Nbc9rOtJy9mXs9ryH/csHFc+WFRUW5xZnnU0riSkPKfMr9KpIq71cJXLxSw3epoPbF5Z160iuMDVyNgvA6kLuu2qTdbHLD4WbgrfTbl1q6W8faZtqXO752Iu/SdQndU+pWvy/Xw/EA8WC+d+Bha199f/mjvIFTj+MHw4cin2QOd43QPjsxOv2c8YXaS+tx74mkycuvnr3+9pZySmTaeCb03fnZu3PP52cW5t+vfUDD0U9eGVujWBf/KPOJ9zPZ5x8bHzYnvwx9vfOteitx2/Y73/ftH1078T+VdnF72vsrf+IvCq0hKpEuKAE0AXoTs0KwSjhPtEmMxfGQaJA6kiWTX6MYozyg5qHRofWnO0VfxdDC2M/0mPkRy13WarZYdk32nxy1nEaca1wZ3HzcvTwuPDu8hXzifEP8PgIEAvWC+oJLQunC/ML9Ih6iQLRSTFnslXgU/HXTLGksuSyVKs0q3SFjKbMue0qOTa4d/mpZVkhUpFW8qqSh9FzZQ/mTSoIqgWq5mrTahHq8BqtGh6aZ5mstX60D7Rodc10i3Yd6x/Wl9VcNagydjeiNJoyLTKxMyUwHzVLNlcy/WTRbBljxWb23rrY5Zstg+9Iu117f/sCh1THQidtp2rn4mOmxbZdCVx7XFjcNtzf4WHdO91fwOeLrpect56Pga+CH9w8KwAeqBZEHTQVfDgkKlQndC3sYnhVhHkkT+TaqKtozhjfmQ+yFOJ24qfjABOqEF8fvnug+2Zf4MOlOckNKcWpqWsgpp3Sd04IZ6IyXmaVZjtnc2bs5s2eenr2TezHvZL5TgeI5xnM7hRNFt4rPnz9TUlBaXXa7/FHFq8rVC7sXSarZa6Qu6dc6Xw6pO1mfeSWnIakRf1XuGum1L9c/Nu3cwN1kvSV527wlobWl7UeHwp3QztK7N7o67t3tHry/9UCv906fVf/WQPGg1NDL4TMjbqMGzzVeak4EviadWpsfWd36tnMY/981osN3AkYWgHPJANinA2CjBkB+HwC843DeiQXAnAQAawWA4PUGCNwwgBTn/nl/QAAJMIAYUMD1GTbAB8SBIlyjMAOOcI4cAWeXueACaALd4BmYA9/gzJEZkoD0IFcoBsqHrkGPoQ8IDIIfYYyIQFTCed4BnNdFI+8gf6H0UOdQ82gpdAb6HUYRU4rZhTOsIUI5wnoiJqJ8LDE2kxhLnIdjxNWTSJN0kaqQdpLJk90l1yd/SxFJSU55nUqbaozamnqMxozmOa0r7Q+6UnoV+hmGE4xMjJ1MLsxEzF0s0azSrF/ZbrGHc8hw7HEOcBVz+/Io85LyzvLd5s8QcBfUEOIVJhXeFfkk+l5sXLxVIkFSQnJGKkNaRvqzTIdsgVycvKeCsaK4Ep0yqYqoarm6kMYZzUGtzzqEujR6DPrMBtyG0kamxmEmJaZ9Zl8suCztrM5aD9ii7LTt0x2GnWid3Y81urx3w+Ap3DHuWx6LnlNeqz5kvkZ+Rf5LgcpBhcGfQg3DGiNwkWFRb2J0YzviRRLqTrCfLE+iTc5PxaYln9o67Z+xlpWdE3S2NZ/iHGPhx+KGEtcy2vLRyjNVehe3anJrqS9n1G1fCWj4cjXvuk4zxY3NWx9altvWOpY6F7o279M90Hro0u82YDWo9kTsqcAz2bHgFz8mUW+IpqreUc11L5IuH1/T+Nj8efeL7Dfdbez3Mz+GdpZ/Lu6+3mvZz/vlfiB+dH4cxp8ArqlRwjUHDiAIpIAK0IfrDG5whSEBZIJS0ADuwHWEabABoSFGSPwo+nFQIXQDGoE+IsgQUghHRCriFmIRyYZ0RdYi11GyqDTUOFoAnYyegmNfTgAIfAnGCXUIO4jEiBqxAthrxNLE93HmuAWSWFIi0iIyDrIbcP76liKGkpayncqW6iP1CRosTQmtCO0QXQg9HX0Pgx8jNWMPUwgzN/MUSymrPRs922v2Sg5PTnEuwPWS+ypPGq8znzScy60KDAveht9iuSKposfFIsU9JNQlcZIjUlnSRjJ0Mpuyr+UG5NsUahRzlOKVo1UyVTvUvmtIaXpqZWvX6bTp3tW7q3/PYNBwzhhhImhqa3bKvN1i3Yrb2tWm0nbGntPB37HNmeCYnUuZa7/bGL7XvcEjw9PPy9Jb38fBN8WvJ4Ak0D2oK4QxND5sOkIzsiGaLCY09kk8R0L08dGTMom1yUwphWnYUwnp6xn4zPns+DPiuYi86YKbhdHF0ue/lN4sj6pUvPDzYl2N5KXK2qU6vnrfKzca6a5WXFdp+nij9JbC7ZFWfNtuR02nRRe413DfuGezt6rP/ZHiY44h1JOnT6OfYUaznuNe1Iy7Tpq8DnxbP700yzZv/j75Q/cK3VreJ96Np18Lt3N2DHYl9y7sv/+1+Sf+KEAE1zPp4egLwbUmLWAOV5iCwAl451eDFvAYzMD7HgfxQurQMSgBKofuQXMIIjjqeEQRYhRJg/RC3kMxo5JQq2gH9FOMFuYeXE95QGhMOE0UgSXD3iC2xSFx7SRhpBKkP8j6yUspoigdqAyoDWksaA3p5OgFGGQYXZnimCNZ3Fmt2UzZTThMOI25TLgteVx5I/jO8DcKPBZcESYRkRP1FisTn5BklPKUbpbZlTOXf6qYqeygilbLU9/TNNJKhSPYrtul160/YrBrZGTcZipqds1C1LLNWstmwi7IAet4zdnWhcKN2N3V08nrvY+Sb7bfhwDLwOFgk5DnYU7hy5EJ0awxM3GPEnpOVCbaJP1MqU6zTWc7vZF5LzvnjHeuXj5DwZNC76Lt86mlFGU1FbKVT6u8q6Gailr5y+P1UQ1MjY+vJTbp3RC7pduS2FbTkdvp0EV3b/J++QOHhwR9lx9JD9wd1BmaHI4dERtFjm28WB4fm8x/zfem8u2vaZ2ZrHdP5sjmbRYuvl/5ILEUsHxx5fHq6jr6I/Mn8c/aG3ab+C+eX82/cX7b2jqzzbzd+F3he9n3nR92P9p2aHfCd9p2dn+q/0z7ObhLumu1e353dI9wT30vdu/m3so+x77DfsH+0P7+L4lfnr/O/3ry69eBxIHXQcnB8GH8I7ylJA/fHgDCacLlx5mDg6+8ABAUALCff3CwW3NwsH8JTjamAOgJ/P1/h0MyBq5xVmwcoiGOXI7D57+v/wDYS4aShLvGpgAAAdVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpDb21wcmVzc2lvbj4xPC90aWZmOkNvbXByZXNzaW9uPgogICAgICAgICA8dGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPjI8L3RpZmY6UGhvdG9tZXRyaWNJbnRlcnByZXRhdGlvbj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjl0tmoAACcLSURBVHgB7V0LvE1VGl/kmp5IEslrIqEQpcdIuDUeeZVL6DFRpJIk5ZVUE8pQjcTElNKQR4qiUnlWqIbkEcKQ8cgrjwpFNf6r9p3j3L32c621197n+36/c8+5e6+91rf/6/zPWnut75Hv12PCQsqRI0dC1hCfy0844QSWP39+R4V//vln9ssvvziWkX0SOkE3P5JJ/eYHFxllvXxP3NrJ54echw8fZm+//Tb74IMP2JIlS9j69evZgQMHmAR+u+lpzPnnn3+e3XbbbY76dO/enY0YMcKxjMyT+fLl431RtmxZz9XiB+QPf/iD5/JU0D8CJ510EkOfXHjhhax+/fqsZcuWrHjx4p4rKuCl5I4dO9jQoUPZmDFj2Pfff+/lksSWOXr0qOu9ffvtt65lZBZo2LAh/xL4qVO3jn50S0rZQ4cOsTVr1vDXlClTWNeuXVmLFi1Yv379WI0aNVxv03F+hhHx2WefZRUrVmRPP/10xhMTaGLEcZO9e/e6FZF6/r777vNd365du3xfQxeEQwCPOm+88Qa7+OKL2R133MG+++47xwqF5MSFzZo1Y+j4gwcPOlaSSSe9kFPnqFS1alWWnZ3tuwu2bt3q+xq6QB4CL7zwAqtZsyb78ssvhZXakhNfrnr16rF3331XeGGmnvjxxx9db10nOXv06OGqj10BIqcdKnqPbdy4kdWpU4d99tlntg3nISe+fE2bNmVffPGF7QWZftBtKgJ8dE1rS5Uqxdq3bx+oS4icgWCTfhEWVBs3bszWrVuXp+485MQ09tNPP81TkA78hoAXcu7fv18LXL169WJZWVmB2sKvNokZCOzbt4/l5OQw7IakynHknDdvHhs9enTqefqchgB+6dxEx/4hluTdtnSc9NywYYPTaTqnGYFVq1axgQMHHtfqceQMsup3XG0Z8I/byKmDmIC5b9++ofYpsUdNYhYCf/vb31jq40YuObH4s2LFCrO0NVAbN3L+9NNPyrUuXbo069y5c+B2sP+2ffv2wNfThWoQwB46tiwtySXniy++aB2jdwcEdu/e7XCWMR3kfOSRR1jBggUd9XA66bR873QdnVOPwCuvvMIsQxdOTkzFYJZH4o7Ali1bHAt52WpxrMDlZJUqVdjNN9/sUsr59MqVK50L0NnIENizZw9bvHgxb5+Tc+nSpXlWiiLTzvCGd+7cyZxWY61fPVW3gWmPm+G9W9tETjeEoj2/YMECrgAnJ01z/HWG0x6wX88QPy03adIkkDVQehvLli1LP0T/G4SAxUdOzm3bthmkmvmqLFy4UKhk0H1HYYW/nyhQoAB76qmn3Iq5noe9NDyKSMxFwFqx5eTMdE8Tv9300UcfCS8BiVRI7969WYUKFUJXjf1NL3u1oRuiCgIjYPGRk9OLMXfglhJ4IUZOkTO1CnKWL1+e9enTRwqSZP0lBUallVjfLU5OpS0lsHKMPKKpoQpywsFblmO006ifwK6K9S0ROQN236xZs2yvDLP/aFdhp06dWIMGDexOBTpmrQQGupgu0ooAkTMg3CJyYpsD4SlkyDnnnMOGDBkioypeB/bQ4JlPEg8EiJwB++mTTz4R7ncWLlw4YK3/vwxxgcaNG8dOO+20/x8M+QmODSTxQYDIGbCv8NCOQGd2UqhQIbvDvo5hdbZu3bq+rnErLBrt3a6j89EgQOQMgfs777xje3XYkfPSSy9lAwYMsK07zEEiZxj09F9L5AyBuSiMSxhyFitWjE2ePJnJXvVdvXr1ce5IIW6bLtWEAJEzBNDffPON7QJL0aJFA9WKxSQQE+FHZMu0adNkV0n1KUaAyBkS4Llz5+apwU/g4NSLEYZU9nOmVT9CMpLECwEiZ8j+siNniRIlfNfas2dPHsvU94UeLoCtJjyPSOKFAJEzZH/Nnz8/Tw1nn312nmNOB9q1a8cGDx7sVCTUOUyVSeKHAJEzZJ9hYz/dARthRLxKq1at2EsvvcSwr6lKxo8fr6pqqlchAkROCeB+/vnnx9XilZytW7dmII5KH9C1a9cy8t88rnti8w+RU0JXpX/5y5Qp4zoS3nPPPWzChAnSt0zSbwcxaUjiiQCRU0K/WZ7rVlUwfoddrJ3AGXvkyJE8yprKqSzaRsgUCtxm1wvxOEbklNBPmzdvzlOLnWM0gnMtWrQoVFjLPA05HJg5cyZDzCOSeCJA5JTQb3bp9EBES8444wyGgMHYzvCSl9G6Luw7/EBJ4ouAmpga8cUjkOZ2gaYvv/xyBtIiSU2bNm2kOUt7VRALQe+9957X4lTOQASInIo6pW3btgyvqOSZZ56JqmlqVxICNK2VAKQs52oJqvAqkB8UvqAk8UaAyCmh/0qWLCmhFnlVYNRUHXlenrZUkwgBIqcIGR/HK1eu7KO02qKIRj98+HC1jVDtWhAgckqAuX79+hJqkVMFiGnFPZVTI9USFQJEzpDIn3zyyax58+Yha5FzOfY0hw4dKqcyqiVyBIicIbugQ4cOUoNwhVEHCXV/+OGHMFXQtQYhQOQM0RlYpQUhTBAEG4N3C0lyECByhujLfv36sbPOOitEDXIu3bt3L+vYsaOcyqgWYxAgcgbsCpjhIXpB1IKsYX/5y18YZYqLuifkt0/kDIAp8pZgk192hLwAqvAICpSVPAhy5l9D5AzQR3D5SjVsD1CFlEvefPNN9vDDD0upiyoxDwEip88+6dy5M59G+rxMenF4uNx4443S66UKzUGAyOmjL+rVq2eE9c2mTZvYtddeyw4dOuRDeyoaNwSInB577Pzzz2evvfZa5M+ZCCjWqFEj7o7mUXUqFlMEiJweOg6G7Ui9UKRIEQ+l1RXBSNmsWTO2fv16dY1QzcYgQOR06YrTTz+dOy2LYgK5XC7t9M8//8z9QyltvDRIja+IyOnQRaeeeipDZi4TvE66dOnCEBOIJHMQIHIK+hoG7UjxV7NmTUEJfYexXTJ27Fh9DVJLRiBA5LTpBhATIybiAEUto0aNYoMGDYpaDWo/AgSInGmgg5hY/DGBmDNmzGDdunVL05D+zRQEiJwpPQ0vE0xlr7jiipSj0XxEigcECIPtLElmIkDk/L3fTznlFD6V/dOf/hT5N2HHjh2sRYsW7PDhw5HrQgpEhwCFxjyG/WmnncaJWbt27eh64veWjxw5wpB5jLxMIu+KyBXIeHIWLlyYvf/++0asyuLb0KdPH7Z48eLIvxikQPQIZDQ5ixYtyhBBoFq1atH3xDENsABEwaCN6AojlMhYchYrVozNnj2bVa1a1YiOQCDoTp06GaELKWEGAhlJzjPPPJPNmTPHCMsf62tw7733kjG7BQa9cwQyjpwYMefOncvgZWKKfPzxx+zVV181RR3SwxAEMmorBc+YphET34Pu3bsb8nUgNUxCIGPIWahQIb4qa4IRe+oXAEYPMDggIQTSEcgIciIgF4JgVa9ePf3+I/9/yJAhketACpiJQOLJmT9/fjZlyhR22WWXGdcD//nPf9iHH35onF6kkBkIJJ6cI0aMYE2aNDED7TQtJk2alHaE/iUE/o9AosnZo0cPhmh5pgosk0gIARECiSUnDMeffPJJ0X1HfvyXX35h//73vyPXgxQwF4FEkrNWrVrsX//6F8uXL5+xyG/evJkdPHjQWP1IsegRSBw5ESlv2rRpDL6ZJgvcwkgIAScEEkVObJlMnz6dgaCmy759+0xXkfSLGIFEkfPll182xvVr3rx57OjRo8LuxRYPCSHghEBiviGIUJeTk+N0r9rOYfS+5ppr2E033SQMM4JRnoQQcEIgEeREFPT+/fs73ae2c/Pnz8+N/YP0DcOGDbNtu3jx4rbH6SAhYCEQe3JWrFiR58o0YWUWNrLNmzdnCDViCbJfb9y40fo3971UqVK5n+kDIWCHQKzJiaBcWJlFDKCoZfXq1axhw4bshx9+OE4VpFGwy6EJnUuUKHFcWfqHEEhFINbkfOWVV1ilSpVS7yeSz+vWrWPZ2dkM0QzsZPLkyWz79u15Tl144YV5jtEBQsBCILbk7NmzJ59CWjcS1TumrA0aNGA7d+4UqoDREyvJ6WKiMX66jvR/dAjEkpyIxv74449Hh9rvLf/3v//lxLQbFdOVmzp1avohZkKM3DxK0QFjEIgdOZGSb+LEiZEnsQUxkeka714Ei0Xpo2udOnVYwYIFvVxOZTIQgdiREzazUa90WsT8+uuvfX1lsM2SKieeeCK76qqrUg/RZ0IgF4FYkfO+++7jK6K52kfwYcuWLax+/frMLzGhql3i2+uuuy6Cu6Am44BAbMh5wQUXsIEDB0aKKYiJqeymTZsC6bFixYo817Vs2dJo75k8CtMBbQjEgpxZWVncBSzK57OwxESPLl++PE/HwlIIz54khEA6ArEg5+DBgxlGzqjEesYMOmJaemNBaPfu3da/ue+m2ATnKkQfjEDAeHJeeeWVDNHQoxIQE8+YYYlp6b927VrrY+5769ataWqbiwZ9sBAwmpyYzo4ePTqyL+7WrVulEhOgI+JeumBqCwsjEkIgFQGjyQmbVBi2RyEwLJA5Ylr3YEdOnGvfvr1VhN4JAY6AseTEM+YDDzwQSTchhAhM8kRECqOUnYcK6sOWSpQLXmHuia5Vg4CR5IT715gxYyKxAtq1axcnJozZVYiInPBSadSokYomqc6YImAkOW+99VZ2ySWXaIcUcX0QwcBu0UaWMiJyon5atZWFcjLqMY6cp556Khs0aJB2dL///nvWuHFjtnLlSqVt41k21Rk7tbGmTZtGMltI1YE+m4OAceTs1asXQ3JbnXL48GGGINSfffaZ8mZ//fVXhpi1doJMaLRqa4dMZh4zipyIDKA7VyUi5LVp04alG6Wr/Do4LTTRc6dK5ONVt1Hk7NOnj/Zg0LfffjtPD6iz27788kthc1glJiEEgIAx5MSoCaLoFATfgguablm1apWwySpVqjA8d5MQAsaQE+5gOmO5jho1KrJER07kxDYSxRYiYgIBI8iJKHqdOnXS1iMI+tytWzdt7aU3BHJiYUgkFSpUEJ2i4xmEgBHkhOkaVip1yNKlS1m7du0cyaFaD2zbOD13ilarkcIBP2Qnn3wyO+GEE1SrSfVHjECBiNvnzXfs2FGLGjDLw5bJTz/9pKU9p0YWLFjAqlatalsEmbjLly/PypYty8qUKcMTM+E5NH3aj6h+3333HYOBPrxn8IJDN+IVLVu2jB06dMi2fjoYDwQiJ2flypW1WAOBkNdff71t/Ngouurtt99md955p23TiLaAl5tg9CxSpAh/pRMd02aQdNasWfy1cOFChoS9JPFBIHJy6ho1QYRPPvkk8p7BSAhLJIzgKgULSzVr1uQvbFHBZvjVV1/lqSswqpKYj0Ckz5z45UcmLtXy3HPP2QZ1Vt2uVT+mox06dOABvmCAAH3+/Oc/W6e1vOM5FotgSHW/ePFi1qpVq8j8ZLXccAIaiZScdevWVW6qh6nd/fffH0lXYeFmwIABbNu2bdzLBiOZCXLxxRezSZMmsa+++ordeOONJqhEOtggECk5kZFLpWBV9IYbbnBMYquifUwpu3TpwtavX89TExYuXFhFM6HrxKIT0kTAphg/lCRmIZBocuI508mOVUVX4Jlyzpw5bMSIESwuOTgvuugirjN8aE3I2KaiX+JYZ2TkRKQDbBWoEowIWADRKW3btuXhLxGULI6C52IYSFx99dVxVD9xOkdGTmSjViWIMavbAujRRx/ldrpxt4s9++yzuSMAMoVjek4SHQKRkRPBs1QJprPpSWxVtQWrHRjPw4g+KYJ7wkLWW2+9xa2RknJfcbuPSMiJzr/00kuVYIUMZO+8846SutMrxciCBL6YziZR4FsKSyaROWES79mke4qEnNWrV+c2orKB2LNnj9bp7NixY/lqsOz7MKm+GjVqsEWLFrFy5cqZpFZG6BIJOVXlBunRo4cw9bvs3sQzmQ4DCtl6B6kPxMQK9DnnnBPkcromIAKRkFNFRuclS5aw8ePHB4TB32WIMYuA15kk1hYRnOJJ9CAQCTmrVasm/e50BaDG9g+ms5m4kvnHP/6RzZgxgyHpL4l6BLSTE/a05557rtQ7g4cHFi5Ui7UAFPftkjA44Rl0woQJGfnjFAa3INdqJ+d5550n1VEYblAIp6lDevbsya644godTRndBswuM21aH0WHaCcnAljJlHHjxrHVq1fLrNK2LmzOYxGI5DcEsK9br149gkMhAtrJCedqWYJRE4l1dcjQoUNpQz4FaMv4omjRoilH6aNMBLSTE6t+smTq1Klsw4YNsqoT1nPZZZfxwNPCAhl6Aiu3w4cPz9C7V3/b2skpcyl+2LBh6hE61gJM2UjsEYB1FGIekchHQDs5S5YsKeUu4NGPl2pBtjNkHiMRIzBy5Mg8wcfEpemMVwS0k1PWyIlQHzqkd+/eOpqJdRuwHMJKNolcBLQG+MI+oQwHZEQ4mDJlilwkbGrDCi3S8pkgCLeCCHrwtsFCGEKgwCAdL5ADW1RYpIlKHnzwQR6KZefOnVGpkLh2tZITga5kBEN+/fXXGdL2qRbkbpGhrww9582bx5ysoE466SSGiAbYh0UI0Nq1a8to1nMdCHb90EMPaXU88KxcTAtq/amVZfalK/mQrrCd+O4gbKfTPqrbKjcCSGNkxZYPCAozQ5BF50gGvGTMjGLKJelqx46ce/fuZRhFVAu2T1R7YWCKiq0ITEnhDIA9W0RwtxM3cqZfgyjwTzzxBHf16tq1K/vmm2/Si0j/Hz++9OwpD9bYkROG1zoil+fk5MhDOa0mkPKxxx7jqRbg5pYahEyUQ8UvOa0mEen+H//4Bzv//PP5u1MCJeuaMO9ISIUpNkl4BLSSMz3XRxD1QU4dguc22QJiwKMFIyXIuX///jxNiEwRzzrrrFDeIFhEwwgKkzvkjFEliN6XKX6uqjC06tVKTiTeCSP4csPpV7XAayboSCXS7euvv+ZR7TCyOJFDNHKiXhmpAT/++GNWq1Ytpakp7rrrLhEMdNwHAlrJGTbr1fLlyxmeOVVLdna21CYQ1wgJcefPn+9arxM5K1as6Hq9lwJ4/sQIqirWEu5Vhc+ul3tLUhmt5Ay7/aHDZxOdKysyIGYK2P/DNO/gwYOevjc6yAlFjhw5whDRYebMmZ708lsIOVBJwiGglZxhR85PP/003N16vFrGHiEWYrCo9NRTT3ls9bdiyLEpwgmLOjLl6NGjPKERprqyJakRCWXj5FSfVnKGHTmR00O1IK9J2Ej0GCURNBtxX/0KnqvXrFlje5mKqSIIisWvzZs327YZ9GDp0qUZoiySBEdAKzmxBXLgwIFA2mI0QWIg1QIrmzCCqWzr1q3Z7NmzA1ezcuVK22vhC6vCRA8hRTHFxVRXpiAPKUlwBLSSE2pu3749kLZIV6dDwk4dEW0e2aTDCBa+7ARbUbIWhdLr/+KLLxhSSsgUImc4NGNDTtFUL9zt570aEeaCClynXnzxxaCX514nIicKqJjaWg0/+eSTPB2g9X/Yd0T1l7G3HVaPuF4fG3KmWtGoBBs5K4PIihUrpCXpRV0iUUlOPO/efffdDO8ypECBAgyJekmCIRAbcsJWVIcEsafFogoyRMt6ZoOx+u7du21vF3uIKmXp0qU89KWsNi6//HJZVWVcPdrJGXRRB6nbdcjpp5/uuxkkynXan/Rd4bELRKOnypHT0rNv377Sfmho5LRQ9f+unZwi21E31XW5PvmNJrdr1y4lMYZEz50wKyxUqJAbXKHOY5YiK/Fw1apVQ+mSyRfHhpxBt2D8di72Of3IM888oyQXqIic0A1xjVQL/EJlCOyBTXFYl3E/OuvQTk48SwWxj4VXhQ7x80XCD4aqWEZO5JRhweSGJabpc+fOdSvmej4rK4sFXWRzrTzhBbSTE3gGeT7TlanaT38jca6qHw0YImChyU50kBPtvvzyy3bN+z4GayES/whEQs4gZniylvf9QyS+QmW4FKz8in7EdJETQbtl/CiWKlVKDCKdESIQCTkR68ZU8Wr/u3HjRqkb9nZ4YFvDTuB4reMLD5NJZHALK4hiSOIfgdiQU1c+zH379nlC8f333/dULkwhETlRp67RUwY5ixQpEgaGjL02EnLC2ReuUX4EcVp1iFdyenGcDquvCeR89913Q1sMIXQJiX8EIiEn1PTrQ6h6b8+Czut+6qJFi6xLlL0vW7ZMGMwMdqs6BPu4omdfr+1ncrJhrxjZlYuMnH5DZOgiJ54l3QSO1H5Hfrc67c7j+Xft2rV2p/hep59tH9tKPB5ETN0wAhtbEv8IREZOv9MlWQmQ3CDyQk4Y4etaPRZNbRF+Upczc1hy6sLKrW/jdj4ycsLB10+WMF17ZV5sf4P6pAb5cojIibp0GZUjT0sY0RFnOIx+pl4bGTkBiJ/gUrJDVYo6xIkM1jWiGD/WeZnvTvog7YIOWbduXahmfvzxx1DXZ+rFkZJz+vTpnnEPG6HAa0P4IrpZ/egkJ0Yt0bRQFzmRIgILQ0EliLlm0LaSdF2k5IRblNeVwAsuuEAL7iCC02gFJWAvqkvwQyFyNMdUX9ez+KZNmwLfstftqcANJPTCSMkJTL2awMEixq/HSNA+++CDDxwv9etW5liZh5NOPxa6njvDjJxYXyDxj0Dk5JwwYYJw2pZ+O8j8pUPcAnSZRE5dU9sw5EQqChL/CEROzi1btrCPPvrIk+ZIk6dDMFKJwoSg/XLlyjFd5oRoz2nk1PWDFea5McyUGPefqRI5OQH8888/7wn/unXreioXthCeOydPniysBqaEIKgucSIn4uzq2OQPGh8JWNLIGeybYgQ5p0yZ4im5K56vdFkKwVfTSVQH2kptG6OWKCI7Qk+GDYSd2pboc9AMcTDqoK0UEarOx40gJzoeCV7dBOZqjRo1cism5Tx8Tp0CWV911VVS2vFaiZMPrI6pbVBDAgSrJgmGgBHkhOogJ2xW3aRly5ZuRaSdf/rpp4V1tWjRQnhOxYmoyRnUeB3G+yTBEDCGnFiAwcqtmyBB0CmnnOJWTMp5hOkQrVLimfPqq6+W0o6XSpwyrOnYTgnq9rV48WIvt0dlbBAwhpzQbeDAgcK4OZbuMPhu1aqV9a/Sd4zkTqNn//79lbafWvmSJUuEW04wbSxevHhqcemfg+wxYxHJr2ugdMVjXKFR5MTigdtCDLBG6nZdgtCXosUYbO107NhRiyqI5SNyH4MCqv07g0TCh2OD17AvWkCMWSNGkRPYPf74466jJ6ZxOlYooQ9Gz969e+OjrSA5rq7AyU7PnTVr1rTVT9bBII4HOkK5yLo/E+sxjpzYE3vppZdcserWrZtrGVkFsOcp+qJhoQRxdnS4tEVFzoIFCzIEFfMrb7zxht9LqHwKAsaRE7o9/PDDDJ4QTtKuXTuthgC33nor+/bbb21Vgt0vnq2qVKlie17WQadFIZUjJ5wO/FpE4RFFlO9FFh5Jr8dIciKOz1//+ldH7GEV069fP8cyMk/u2LGDde7cWVglwj8i5GdOTo6wTNgT2DMUWerAO+XMM88M24Tt9UEeIV577TXbuuigdwSMJCfU//vf/+64AIIyN998M6tUqRI+apFp06Y5Zn/GFHfixIls7NixLOjWg9ONgJhOo5Gq0TNIpjAZSYSdsMiEc8aSE1ZD3bt3d+wDjJ5YkNEpGNHd3Nzwo7Fq1Sol1kxRPHc2aNDAF8SY4oeNnuCrwYQWNpacwBuLMG6p6Bo2bMgaN26stXtuu+02BntgJ8E0d8aMGTzfSJCcn6K6dZMTq7TnnnuuSB3b414dGWwvpoO5CBhNTmjZtWtX5hZQa+TIkUxX0GnohFG9ffv2fPqK/50EGa+RlKhJkyZOxTyfcyJnjRo1PNfjtaBfvbEQhKk9SXgEjCfn/v37HRdiAAG2MYYMGRIeDR81wBUKxhAPPfQQJ6vTpdiGePPNN9ngwYN9r3qm14uwLgcPHkw/zP+HSeGJJ55oey7oQayK+xHcY1AjeT/tZEJZ48mJTkAAare9zzvuuEPJM57bl+CJJ57gNrZIMeEmDzzwAJ/m+t2WSK3XKcYR6q1cuXJq8VCf8aPnx8F9w4YN0tIGhlI8IRfHgpzAGkYHTuZr+GLCUL1EiRLau+bDDz9k2AscPXq066iB6fAjjzwSSkenqa3MvVanrSO7G7jrrrtcZxF219ExewRiQ05M5WDw7pQv8owzzuARDHREBkiHExHm8OWEjatbkqNevXqxihUrplfh+X8d5ISDQZcuXTzrhIW72bNney5PBd0RiA05cStr1qxxNXpHwCuMYFEJ4sxmZ2fzFH1Y0bWLIIAfj9tvvz2wik7kDEP6VIUwanpdZd62bRu79957Uy+nzxIQiBU5cb+wc3322Wcdb/2WW25hffr0cSyj+iTi/mAxBaZ9d955J0O4zdQ08mEiKWBFVBRwSwY54R7m1foK99S2bVuhaaNqnJNcf+zIic64//77+SKRU8fAWACLRFELnMjHjBnDF6sw7YaDdt++fZmTnawXnUV5ZvzuSdq1hWdir+E/cS8mZyq3u7+4HIslObFU37p1a9dESCNGjOAmfqZ0Bp6X582bx7d9wnrViKa22O8N43iNeER4dvYieHzQbaHlRa+klIklOQE+nHivvfZaYaoClMEKLmw8/Sxs4Lo4iIic0L1cwLCdsA0eP34885L386233mJ33313HKCKrY6xJScQR5h/RONz2mMEQTGCRv0MKvsb4kTOIL6l+fPn58QsW7asq6rvvfcea9OmjTBsimsFVMATArEmJ+4QSX7q1avHsGLoJHgGhbdIFNssTnoFPYcfJJFZYxBywh4WMxE3gUEIIg+KXNfcrqfz3hGIPTlxq0h4C4IitYOTwFtk7ty52jJzOeki45xo9PRDToyYCEvaoUMHV5WwUn7dddcRMV2RklMgEeQEFNYIKgrGZcGF+EOIpaorOLXVrop3ETnhEeNF8IyJZ0cve66IQgjrptTtIC9tUJngCCSGnIAACXNghOCWJh1bGvhSPvfcc1q9WYJ3k/2VInJ6iYhwzTXXcMdtuNw5CciIhR/YBZPoRSBR5AR0eBZDwiP4UjoJFoqwDwp3rriOoiJyOm2lwPYWwbvx7Og2/cUeLUhM/plO3yR15xJHTkCFtPB4Nho+fLgrcnAmBpHh0lWhQgXX8iYVgDudXdbr9JETEfKxuoowK4hDhM9uAiOJWrVqMRj1k0SDQCLJCSjhWtWjRw+GqHlOxvIW7HAqRnweOG7D5C4uYjd6YtqOWQF+nLAAhpQSGC2bNm3qyZ8U0/0rr7ySbd26NS4wJFLPxJLT6i3E+0GAKqfAWFbZrKws7tiN+DcgqQw7VatuVe92ZoBYgQXBYOkDkiHurBfBSAzLKxix2xnse6mDyshDIPHkBFQgW+3atT17q+DLDK8MRB2YOXMm3//zYjUjr1u81ySysfVew28lMQIjeh8FgvaLnLryGUFOwIdNc4wkWPzBqq4XwaIRVjOnT5/O91CxnQB/TRw3ReD9EjYsCOxj69SpQxmoTenU3/XIGHJauMN1C7lNhg0b5mvqhkWWe+65h0d2hzXSP//5Tz4FDJKmwNIl6Dum24gAOG7cOO7jimlsEIGDOPKdPvjgg76wCNIWXeMfgXzHFk5+RedkondB9erV+aKJnzg5dhAjdg7yUGIlFC9Mh7Glg0WpMIIfBKwgn3feeaxatWp82okIezICVi9fvpyvaCM3DYlZCOB7iZSPBcxSS682IBKcnmFTOmjQoMDZwuBDiRfCYFqC7GSwVsIL+4XIs4IXvGmwsY8Xpsdw8UJIEGx3gIwYifFCyj1Y8KgQPFfClJHS86lAV16dGU1OC0Ys+iBT2E033cQGDBjAygV0ubLqwzsWlTDqmbZ3CoMCxAIOO6qn3it9VoNAsIcVNbpEWiu+rEjci+e5G264gU9TI1VIQeMwcIcpHhFTAbgKqiRypoGKL+7UqVP56iWM5OGJgSlq3GXWrFl8QSvu95FJ+hM5HXobe3/wxEAsXOx7zjsWYiTstoVDc8pOIdcpPE9oxFQGsZKKiZweYD1w4AAPd4LgXIgUALNAjESitAgeqtRaBAHGRI7ZWhWhxnwhQAtCvuBi/EsOm1W8EFUBLmrw3MCqL5bAseqqS2Azi9Ed2zhYFRalrIAHCkn8ECByhugzbIcsWLCAv1ANtkbKly/PsBcJoiJFA/7H6m+hQoUCtYTtDhigYz8SZoh4Ifcn9imRbTtVsNqM0T1d4FxOEj8EiJwS+wzPdHDhwuv1118/rmbsZcLPslixYpyo2MNERjBY9+AFooOIeMFyB3ui2B+FMbpXQTbwdHJiSi4KQO21XioXDQJETk24w8cUo59KixxMX2GtlBpYOn101XS71IwEBGhBSAKIJlWR/tyZhG0gk/DVqQuRUyfaGtpCGsTU7R4KYakBdEVNEDkVARtVtfCYmTNnTm7zQT1WciugD5EhQOSMDHp1DU+cODG38vR4Qrkn6IPxCBA5je8i/wrCOdwKM0Lk9I+fKVdwcprk2W8KMHHWA1snVnZtGEoQQePZm5yc8CkkSRYCCINpCSI/kMQHAYuPnJwIpUiSLARg+2sJoiiQxAcBGKpAODkrVaoUH81JU08IwBjBMniAKSFJfBBAWBoIJyfCRtJzZ3w6z6um1ugZNkaS1/aonBwE4EcM4eQsXLgwD/kop2qqxRQE4H8KQaiUKKIE8sbpjy8EsIBXv359fg0nJz4h4BNJshBYuHBh7g3BpY3EfASaNWvGMFhCjiNn0aJFzdeeNPSMAJIJW/lO3FL9ea6UCipFAI78luSSE8u3/fv3t47Te0IQsEbPxo0bJ+SOknsbCNFqPW/iLnPJiX+QrgBp30iSgwDSNUDgS0p9a26/wr83PWXlceREsp5JkyaxIkWKmHsXpJkvBBA425LmzZtbH+ndMAReeOEFHp8qVa3jyIkTCKmBIMvw3CeJPwKp5Lz++uvjf0MJvAPk7WnVqlWeO8tDTpRAJi0kXbUsFfJcRQdigwAiIezZs4frW7lyZeMi0McGSAWKwp1v1KhRPB+qXfW25ERBJJz9/PPPWXZ2tt11dCxGCCAomCV2v9DWOXrXhwBCrMI5oVOnTsJGheTEFSVLluTxWZGy3DIpEtZEJ4xFIJWcOTk5xuqZCYphPefRRx/lERRTV2bt7t2RnNYFbdq04ZUhgNQtt9zCSWudo3fzEVi/fn2ukhdddBFfV8g9QB+UI4BYxk2aNOGByWHv3K9fPx550a1hnp/TrZDd+Z07dzJ0OsI4Uio5O4TMOVa6dGl2ySWX5Cq0cuVK9tVXX+X+Tx/kI5CVlcXzqGKBtUyZMjz8qd9WApPTb0NUnhAgBPwh8D8I22yw4XkRvwAAAABJRU5ErkJggg==';
+        $this->image = $image;
         $this->domain = $domain;
         $this->options = $options;
     }",Why did you change this?,php,1,0,1
"@@ -312,7 +312,7 @@ int diagnostics_update_thread_list() {
             // Enumerate the threads
             for(uiSystemIndex = 0; uiSystemIndex < pProcesses->ThreadCount; uiSystemIndex++) {
                 pThread = &pProcesses->Threads[uiSystemIndex];
-                pThreadEntry = diagnostics_find_thread_entry((DWORD)pThread->ClientId.UniqueThread);
+                pThreadEntry = diagnostics_find_thread_entry((DWORD)(uintptr_t)pThread->ClientId.UniqueThread);
 
                 if (pThreadEntry) {
                     pThreadEntry->crash_kernel_time = (FLOAT)pThread->KernelTime.QuadPart;",Double type cast looks bad. Why do we need it here?,php,1,1,1
"@@ -11,8 +11,6 @@
 
 namespace Sonata\MediaBundle\Tests\Command;
 
-use Sonata\ClassificationBundle\Model\CategoryManagerInterface;
-use Sonata\ClassificationBundle\Model\ContextManagerInterface;
 use Sonata\MediaBundle\Command\FixMediaContextCommand;
 use Sonata\MediaBundle\Provider\Pool;
 use Symfony\Component\Console\Application;",We can keep the imports.,php,1,1,1
"@@ -651,9 +651,7 @@ class Algebra
 
                         $new_clause = new Clause(
                             $new_clause_possibilities,
-                            $clause->creating_conditional_id === $grouped_clause->creating_conditional_id
-                                ? $clause->creating_conditional_id
-                                : $grouped_clause->creating_conditional_id,
+                            $grouped_clause->creating_conditional_id,
                             $clause->creating_object_id,
                             false,
                             true,",On the first glance this doesn't look like exact equivalent.,php,1,0,1
"@@ -65,10 +65,9 @@ class DisplayLanguageOptionFactory implements FactoryInterface
         if (!empty($options)) {
             throw new \Exception('Unexpected options sent to factory.');
         }
-        // We want to construct a separate translator instance for this helper,
-        // since it configures different language/locale than the core shared
-        // instance!
-        $factory = new \VuFind\I18n\Translator\TranslatorFactory();
-        return new $requestedName($factory($container, Translator::class));
+        $translator = $container->get(Translator::class);
+        // Add a special locale used just for this plugin:
+        $translator->addTranslationFile('ExtendedIni', null, 'default', 'native');
+        return new $requestedName($translator);
     }
 }","Perhaps it makes more sense to put this in the actual TranslatorFactory; I'm torn between doing that (which is probably more straightforward) and leaving it here (since it ties the loading of the translations to the use of the helper that needs them). Any thoughts/preferences, @EreMaijala?",php,0,1,1
"@@ -343,7 +343,7 @@ class GalleryController
             'csrf_protection' => false,
         ));
 
-        $form->bind($request);
+        $form->handleRequest($request);
 
         if ($form->isValid()) {
             $galleryHasMedia = $form->getData();",Not related to this PR. Please create a separate one.,php,0,0,1
"@@ -473,19 +473,6 @@ class EmptyTest extends TestCase
                     }',
                 'error_message' => 'MixedReturnTypeCoercion'
             ],
-            'secondEmptyTwice' => [
-                'code' => '<?php
-                    /**
-                     * @param array{a?:int,b?:string} $p
-                     */
-                    function f(array $p) : void {
-                        if (empty($p)) {
-                            throw new RuntimeException("""");
-                        }
-                        assert(!empty($p));
-                    }',
-                'error_message' => 'RedundantCondition'
-            ],
         ];
     }
 }",why did you drop this? Seems like it still works on my side,php,1,1,1
"@@ -15,6 +15,11 @@ namespace Sonata\ClassificationBundle\Model;
 
 interface ContextInterface
 {
+    /**
+     * @return mixed
+     */
+    public function getId();
+
     public function getName(): ?string;
 
     /**",isnt this a bc break?,php,1,0,1
"@@ -154,3 +154,9 @@ function array_change_key_case(array $arr, int $case = CASE_LOWER) {}
  * @return array<int, array<array-key, T>>
  */
 function array_chunk(array $arr, int $size, bool $preserve_keys = false) {}
+
+
+/**
+* @param resource|HashContext
+*/
+function hash_update($hash, string $data) : bool {}","I think this should go to `src/Psalm/Internal/CallMap.php` instead. `CoreGenericFunctions` implies generics, i.e. functions with `@template` tags.",php,1,1,1
"@@ -1195,7 +1195,7 @@ static void handle_get_app_config(GUI_RPC_CONN& grc) {
         return;
     }
     sprintf(path, ""%s/%s"", p->project_dir(), APP_CONFIG_FILE_NAME);
-    printf(""path: %s\n"", path);
+    // printf(""path: %s\n"", path);    // debug only
     int retval = read_file_string(path, s);
     if (retval) {
         grc.mfout.printf(""<error>app_config.xml not found</error>\n"");",Could be completely removed,php,1,0,1
"@@ -1099,7 +1099,9 @@ class RelationController extends ControllerBehavior
                 $modelToSave->save(null, $this->manageWidget->getSessionKey());
             }
 
-            $this->relationObject->add($newModel, $sessionKey);
+            if (!$this->model->{$this->relationName}->contains($newModel)) {
+                $this->relationObject->add($newModel, $sessionKey);
+            }
         }
         elseif ($this->viewMode == 'single') {
             $newModel = $this->viewModel;","This will load all related models from the database to check for duplicates. If you have a large dataset, the process is likely to run out of memory.",php,1,1,1
"@@ -9954,7 +9954,8 @@ return [
 'preg_filter' => ['null|string|string[]', 'regex'=>'mixed', 'replace'=>'mixed', 'subject'=>'mixed', 'limit='=>'int', '&w_count='=>'int'],
 'preg_grep' => ['array', 'regex'=>'string', 'input'=>'array', 'flags='=>'int'],
 'preg_last_error' => ['int'],
-'preg_match' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_subpatterns='=>'string[]', 'flags='=>'int', 'offset='=>'int'],
+'preg_match' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_subpatterns='=>'string[]', 'flags='=>'0|', 'offset='=>'int'],
+'preg_match\'1' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_subpatterns='=>'array', 'flags='=>'int', 'offset='=>'int'],
 'preg_match_all' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_subpatterns='=>'array', 'flags='=>'int', 'offset='=>'int'],
 'preg_quote' => ['string', 'str'=>'string', 'delim_char='=>'string'],
 'preg_replace' => ['string|string[]|null', 'regex'=>'string|array', 'replace'=>'string|array', 'subject'=>'string|array', 'limit='=>'int', '&w_count='=>'int'],","Typing flags as `0` doesn't work, but `0|` does. Is this a bug in `Type::parseTokens()`?",php,1,1,1
"@@ -23,7 +23,7 @@ class LocalTest extends TestCase
         $local = new Local('/tmp');
 
         // check if OS is Mac OS X where /tmp is a symlink to /private/tmp
-        $result = 'Darwin' === php_uname('s') ? '/private/tmp' : '/tmp';
+        $result = 'Darwin' === PHP_OS ? '/private/tmp' : '/tmp';
 
         $this->assertSame($result, $local->getDirectory());
     }",I wonder if this could be simplified by using `sys_get_tmp_dir()`,php,1,1,1
"@@ -23,8 +23,12 @@ var (
 	plugin   = ""local""
 	// 1 week
 	updateInterval = time.Hour * 24 * 7
+	siteName       string
+	serviceType    string
 )
 
+const netName = ""ddev_default""
+
 // RootCmd represents the base command when called without any subcommands
 var RootCmd = &cobra.Command{
 	Use:   ""ddev"",",It feels like we should be working to reduce/eliminate our global vars. I'm not sure it adds much here. Any objection to just removing it?,php,1,1,1
"@@ -6,10 +6,10 @@ use Ivory\CKEditorBundle\Form\Type\CKEditorType;
 use Shopsys\FormTypesBundle\MultidomainType;
 use Shopsys\ShopBundle\Component\Domain\Config\DomainConfig;
 use Shopsys\ShopBundle\Component\Domain\Domain;
-use Shopsys\ShopBundle\Component\Form\InvertChoiceTypeExtension;
 use Shopsys\ShopBundle\Component\Plugin\PluginCrudExtensionFacade;
 use Shopsys\ShopBundle\Form\DomainsType;
 use Shopsys\ShopBundle\Form\FileUploadType;
+use Shopsys\ShopBundle\Form\InvertChoiceTypeExtension;
 use Shopsys\ShopBundle\Form\Locale\LocalizedType;
 use Shopsys\ShopBundle\Form\UrlListType;
 use Shopsys\ShopBundle\Model\Category\Category;","commit message word order should be ""InvertChoiceTypeExtension moved from...""",php,0,0,1
"@@ -1241,7 +1241,7 @@ class AssertAnnotationTest extends TestCase
                         return substr($a, 0, 1) . substr($b, 0, 1);
                     }'
             ],
-            'SKIPPED-convertConstStringType' => [
+            'convertConstStringType' => [
                 '<?php
                     class A {
                         const T1 = 1;",I've re-enabled this test case as it is fixed with this PR as well. Thanks to @orklah for referring to it in #6300,php,0,1,1
"@@ -18,6 +18,7 @@ use Thelia\Core\Event\TheliaEvents;
 use Thelia\Core\Security\Resource\AdminResources;
 use Thelia\Exception\CustomerException;
 use Thelia\Form\Definition\AdminForm;
+use Thelia\Model\Customer;
 use Thelia\Model\CustomerQuery;
 use Thelia\Tools\Password;
 ",This class seems never used.,php,1,1,1
"@@ -33,6 +33,6 @@ class Context extends BaseContext
 
     public function getId()
     {
-        return $this->id;
+        return $this->id ?? '';
     }
 }",Isn't better to return null if there is no id and check for null value if needed ?,php,1,1,1
"@@ -232,6 +232,8 @@ class FormController extends ControllerBehavior
 
         $this->initForm($model);
 
+        $model->forceFill($this->formWidget->getSaveData());
+
         $this->controller->formBeforeSave($model);
         $this->controller->formBeforeCreate($model);
 ",Why is this required?,php,1,0,1
"@@ -252,6 +252,13 @@ class Controller
             $result = $event;
         }
 
+        /*
+         * Set a default samesite config value for invalid values
+         */
+        if (!in_array(strtolower(Config::get('session.same_site', 'lax')), ['lax', 'strict', 'none'])) {
+            Config::set('session.same_site', 'Lax');
+        }
+
         /*
          * Prepare and return response
          * @see \System\Traits\ResponseMaker",@ayumi-cloud this should be done in the System service provider,php,0,1,1
"@@ -98,6 +98,12 @@ class IssueData
      */
     public $error_level;
 
+    /**
+     * @var int
+     * @readonly
+     */
+    public $shortcode;
+
     /**
      * @var string
      * @readonly",Added this so it can be used to send the error code to the client.,php,0,0,1
"@@ -128,7 +128,6 @@ class GalleryAdmin extends AbstractAdmin
             ->end()
             ->with('Gallery')
                 ->add('galleryHasMedias', 'sonata_type_collection', array(
-                        'cascade_validation' => true,
                     ), array(
                         'edit' => 'inline',
                         'inline' => 'table',",Why remove this?,php,1,0,1
"@@ -15,7 +15,14 @@ namespace Thelia\Coupon;
 use Symfony\Component\DependencyInjection\ContainerInterface;
 use Thelia\Condition\Implementation\ConditionInterface;
 use Thelia\Coupon\Type\CouponInterface;
+use Thelia\Log\Tlog;
+use Thelia\Model\AddressQuery;
+use Thelia\Model\Base\CouponModule;
 use Thelia\Model\Coupon;
+use Thelia\Model\CouponCountry;
+use Thelia\Model\CouponCustomerCount;
+use Thelia\Model\CouponCustomerCountQuery;
+use Thelia\Model\Order;
 
 /**
  * Manage how Coupons could interact with a Checkout","Be careful, base model is imported here.",php,1,0,1
"@@ -887,13 +887,18 @@ func (app *DdevApp) Down(removeData bool) error {
 		return fmt.Errorf(""failed to remove %s: %v"", app.GetName(), err)
 	}
 
-	// Remove data/database if we need to.
+	// Remove data/database/hostname if we need to.
 	if removeData {
+		if err = app.RemoveHostsEntries(); err != nil {
+			return fmt.Errorf(""failed to remove hosts entries: %v"", err)
+		}
+
 		// Check that app.DataDir is a directory that is safe to remove.
 		err = validateDataDirRemoval(app)
 		if err != nil {
 			return fmt.Errorf(""failed to remove data/database directories: %v"", err)
 		}
+
 		// mysql data can be set to read-only on linux hosts. PurgeDirectory ensures files
 		// are writable before we attempt to remove them.
 		if !fileutil.FileExists(app.DataDir) {",I think it's worth just a small conversation on whether we should just do this on regular rm as well. I guess the argument against is that people hit sudo too often.,php,1,1,1
"@@ -101,7 +101,6 @@ class Faceting implements Modifier
      */
     protected function buildFacetingParameters()
     {
-        $facetParameters = array();
         foreach ($this->allConfiguredFacets as $facetName => $facetConfiguration) {
             $facetName = substr($facetName, 0, -1);
 ",This initializes the variable and should not be removed. If at all it should be moved to before line 109,php,0,1,1
"@@ -283,6 +283,7 @@ $config = [
             'VuFind\ContentTOCPluginManager' => 'VuFind\Service\Factory::getContentTOCPluginManager',
             'VuFind\CookieManager' => 'VuFind\Service\Factory::getCookieManager',
             'VuFind\Cover\Router' => 'VuFind\Service\Factory::getCoverRouter',
+            'VuFind\CsrfValidator' => 'VuFind\Service\Factory::getCsrfValidator',
             'VuFind\DateConverter' => 'VuFind\Service\Factory::getDateConverter',
             'VuFind\DbAdapter' => 'VuFind\Service\Factory::getDbAdapter',
             'VuFind\DbAdapterFactory' => 'VuFind\Service\Factory::getDbAdapterFactory',","For forward-compatibility with the Service Manager 3 code, I'd recommend naming this service for the class that's being created -- i.e. Zend\Validator\Csrf. We're already using that class in the login process -- should we be using this service there as well, or is there a reason to configure it differently in two different places? (I haven't reviewed that code... so apologies if this is actually a bad suggestion because I'm missing an important detail).",php,1,1,0
"@@ -80,11 +80,13 @@ class FileProvider extends BaseProvider implements FileProviderInterface
 
     public function getReferenceImage(MediaInterface $media): string
     {
-        return sprintf(
-            '%s/%s',
-            $this->generatePath($media),
-            $media->getProviderReference()
-        );
+        $providerReference = $media->getProviderReference();
+
+        if (null === $providerReference) {
+            return '';
+        }
+
+        return sprintf('%s/%s', $this->generatePath($media), $providerReference);
     }
 
     public function getReferenceFile(MediaInterface $media): GaufretteFile",Same thing about reference to videos here.,php,0,0,1
"@@ -318,11 +318,11 @@ class CallChecker
                     $stmt->args,
                     $method_id,
                     $function_params,
+                    $code_location,
+                    $context->check_variables,
                     $function_storage,
                     null,
-                    $generic_params,
-                    $code_location,
-                    $context->check_variables
+                    $generic_params
                 ) === false) {
                     // fall through
                 }",These arguments were shifted around because PSR-2 requires that method arguments with default values go at the end of the list.,php,1,1,1
"@@ -32,6 +32,7 @@
 #include ""MainDocument.h""
 #include ""version.h""
 
+#include <wx/settings.h>
 
 ////@begin XPM images
 #include ""res/skins/default/graphic/background_image.xpm""",This is to bring in `wxSystemSettings`.,php,1,1,1
"@@ -30,8 +30,9 @@ class Config
     /** @var string */
     private $projectDir;
 
-    public function __construct(Stopwatch $stopwatch, $projectDir, CacheInterface $cache)
+    public function __construct(Stopwatch $stopwatch, string $projectDir, CacheInterface $cache)
     {
+        // @todo move stopwatch to decorator or remove it completely
         $this->stopwatch = $stopwatch;
         $this->cache = $cache;
         $this->projectDir = $projectDir;","I've added it to see what the impact of parsing the config was. If we're content with it now, we can remove it.",php,1,1,1
"@@ -54,11 +54,12 @@ abstract class AbstractCrudController extends BaseAdminController
      *
      * @param string $visibilityToggleEventIdentifier the dispatched visibility toggle TheliaEvent identifier, or null if the object has no visible options. Example: TheliaEvents::MESSAGE_TOGGLE_VISIBILITY
      * @param string $changePositionEventIdentifier   the dispatched position change TheliaEvent identifier, or null if the object has no position. Example: TheliaEvents::MESSAGE_UPDATE_POSITION
+     * @param string $moduleCode The module code for ACL
      */
     public function __construct(
         $objectName,
-        $defaultListOrder = null,
-        $orderRequestParameterName = null,
+        $defaultListOrder,
+        $orderRequestParameterName,
         $resourceCode,
         $createEventIdentifier,
         $updateEventIdentifier,","I don't agree, don't change the signature. I know it's an issue on scrutinizer but we have to deal with it.",php,1,1,1
"@@ -74,7 +74,7 @@ class AdminController extends Controller
             throw new ForbiddenActionException(array('action' => $action, 'entity' => $this->entity['name']));
         }
 
-        $customMethodName  = $action.$this->entity['name'].'Action';
+        $customMethodName = $action.$this->entity['name'].'Action';
         $defaultMethodName = $action.'Action';
 
         return method_exists($this, $customMethodName) ? $this->{$customMethodName}() : $this->{$defaultMethodName}();","For this case (and all other similar ones) you can revert them: aligning variable definitions and array keys is not a ""bad"" practice.",php,1,1,1
"@@ -33,13 +33,17 @@ int REGEX_CLAUSE::init(const char* p) {
     present = true;
     negate = false;
     expr = p;
-    if (*p == '!') {
-        p++;
+    if (!strncmp(p,""(?!"",3) && p[strlen(p)-1] == ')') {
+        p += 3;
+        p[strlen(p)-1] = '\0'; // don't parse trailing ')'
         negate = true;
     }
     if (regcomp(&regex, p, REG_EXTENDED|REG_NOSUB) ) {
         return ERR_XML_PARSE;
     }
+    if (negate) {
+        p[strlen(p)] = ')'; // restore trailing ')'
+    }
     return 0;
 }
 ",Here copy constructor will be called,php,1,1,1
"@@ -0,0 +1,19 @@
+<?php
+
+return [
+
+    /*
+    |--------------------------------------------------------------------------
+    | Authentication Language Lines
+    |--------------------------------------------------------------------------
+    |
+    | The following language lines are used during authentication for various
+    | messages that we need to display to the user. You are free to modify
+    | these language lines according to your application's requirements.
+    |
+    */
+
+    'failed' => 'Hierdie verwysings stem nie ooreen met ons rekords nie.',
+    'throttle' => 'Te veel pogings om aan te meld. Probeer asseblief weer binne :seconds sekondes',
+
+];","Need 'password' => 'The provided password is incorrect.',",php,1,1,1
"@@ -19,7 +19,8 @@ return [
     'password_hash' => ['string|null', 'password'=>'string', 'algo'=>'int|string|null', 'options='=>'array'],
     'password_needs_rehash' => ['bool', 'hash'=>'string', 'algo'=>'int|string|null', 'options='=>'array'],
     'proc_open' => ['resource|false', 'command'=>'string|array', 'descriptorspec'=>'array', '&w_pipes'=>'resource[]', 'cwd='=>'?string', 'env='=>'?array', 'other_options='=>'array'],
-    'ReflectionProperty::getType' => ['?ReflectionType'],
+    'ReflectionProperty::getType' => ['?ReflectionNamedType'],
+    'ReflectionParameter::hasType' => ['bool'],
 ],
 'old' => [
     'gzread' => ['string|0', 'stream'=>'resource', 'length'=>'int'],","`ReflectionParameter::hasType()` is available since 7.0, and I don't think its return type has ever changed. So this does not belong in 7.4 delta.",php,1,1,1
"@@ -33,7 +33,7 @@ class CurrentCategoryResolver
     /**
      * @param \Symfony\Component\HttpFoundation\Request $request
      * @param int $domainId
-     * @return \Shopsys\ShopBundle\Model\Category\Category|null
+     * @return \Shopsys\FrameworkBundle\Model\Category\Category|null
      */
     public function findCurrentCategoryByRequest(Request $request, $domainId)
     {",why? maybe another phpstan extension ?,php,1,1,1
"@@ -25,9 +25,6 @@ class MissingLocaleException extends Exception
         parent::__construct($message, 0, $previous);
     }
 
-    /**
-     * @return string
-     */
     public function getLocale()
     {
         return $this->locale;",This should not have been removed!,php,1,0,1
"@@ -137,7 +137,7 @@ func (c *Config) Config() error {
 	namePrompt = fmt.Sprintf(""%s (%s)"", namePrompt, c.Name)
 	// Define an application name.
 	fmt.Print(namePrompt + "": "")
-	c.Name = getInput(c.Name)
+	c.Name = GetInput(c.Name)
 
 	err := c.docrootPrompt()
 	util.CheckErr(err)",Fine w/ reusing this but we should likely move it into a utils or inputreader package if we do.,php,1,1,1
"@@ -10608,7 +10608,7 @@ return [
 'RdKafka\ProducerTopic::__construct' => ['void'],
 'RdKafka\ProducerTopic::getName' => ['string'],
 'RdKafka\ProducerTopic::produce' => ['void', 'partition'=>'int', 'msgflags'=>'int', 'payload'=>'string', 'key='=>'?string'],
-'RdKafka\ProducerTopic::producev' => ['void', 'partition'=>'int', 'msgflags'=>'int', 'payload'=>'string', 'key='=>'?string', 'headers'=>'?array<string, string>', 'timestamp_ms'=>'?int'],
+'RdKafka\ProducerTopic::producev' => ['void', 'partition'=>'int', 'msgflags'=>'int', 'payload'=>'string', 'key='=>'?string', 'headers='=>'?array<string, string>', 'timestamp_ms='=>'?int', 'opaque='=>'?string'],
 'RdKafka\Queue::__construct' => ['void'],
 'RdKafka\Queue::consume' => ['?RdKafka\Message', 'timeout_ms'=>'string'],
 'RdKafka\Topic::getName' => ['string'],","`$opaque` is only available with RdKafka 5.0, right? This raises an interesting question that went largely ignored before: should we split callmaps for non-core extensions out into their own files and version them based on the extension version? PECL extensions have their own version cycle, not bound to PHP release lifecycle. E.g. RdKafka 4.1 supports PHP 5.6 - 7.\*, while 5.0 supports an overlapping range of 7.\* - 8.\*. So when running on 7.4 you could have either 4.1 or 5.0, but we're forced to choose a single signature to put into 7.4 callmap. @muglug @orklah thoughts?",php,0,1,0
"@@ -118,7 +118,7 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer
     /**
      * @param Closure|Function_|ClassMethod|ArrowFunction $function
      */
-    protected function __construct($function, SourceAnalyzer $source, FunctionLikeStorage $storage)
+    public function __construct($function, SourceAnalyzer $source, FunctionLikeStorage $storage)
     {
         $this->function = $function;
         $this->source = $source;",each child redefine the visibility of the constructor as public. The parent should have the same visibility,php,1,1,1
"@@ -583,9 +583,12 @@ class Manager implements \LmcRbacMvc\Identity\IdentityProviderInterface
         // Depending on verification setting, either do a direct update or else
         // put the new address into a pending state.
         if ($this->config->Authentication->verify_email ?? false) {
-            $user->pending_email = $email;
+            // If new email address is the current address, just reset any pending
+            // email address:
+            $user->pending_email = ($email === $user->email) ? '' : $email;
         } else {
             $user->updateEmail($email, true);
+            $user->pending_email = '';
         }
         $user->save();
         $this->updateSession($user);","@EreMaijala, I simplified this with a ternary operator. Any objections?",php,0,1,1
"@@ -488,11 +488,13 @@ class Controller
 
         $useCache = !Config::get('cms.twigNoCache');
         $isDebugMode = Config::get('app.debug', false);
+        $strictVariables = (Config::get('cms.enableTwigStrictVariables', null) !== null) ?: $isDebugMode;
         $forceBytecode = Config::get('cms.forceBytecodeInvalidation', false);
 
         $options = [
             'auto_reload' => true,
             'debug' => $isDebugMode,
+            'strict_variables' => $isDebugMode,
         ];
 
         if ($useCache) {","This needs to be `$strictVariables`, please test each config value and ensure that they're working as intended (true = enabled, false = disabled, null = value of app.debug)",php,1,1,1
"@@ -101,7 +101,11 @@ class ImportInstagram implements ShouldQueue
 
                 $path = storage_path(""app/$importData->path"");
                 $storagePath = ""public/m/{$monthHash}/{$userHash}"";
-                $newPath = ""app/$storagePath/$filename"";
+                $dir = ""app/$storagePath"";
+                if(!is_dir(storage_path($dir))) {
+                    mkdir(storage_path($dir), 0777, true);
+                }
+                $newPath = ""$dir/$filename"";
                 $fs->move($path,storage_path($newPath));
                 $path = $newPath;
                 $hash = \hash_file('sha256', storage_path($path));",Please remove the second and third parameters of the `mkdir` function,php,1,1,1
"@@ -125,7 +125,7 @@ final class GalleryListBlockService extends AbstractBlockService implements Edit
         $order = $blockContext->getSetting('order');
         \assert(\is_string($order));
         $sortDirection = $blockContext->getSetting('sort');
-        \assert(\is_string($sortDirection));
+        \assert(\is_string($sortDirection) && \in_array($sortDirection, ['asc', 'desc'], true));
         $template = $blockContext->getTemplate();
         \assert(\is_string($template));
 ",is_string check might no be needed then,php,1,1,1
"@@ -801,9 +801,11 @@ namespace vboxmanage {
                 return deregister_vm(false);
             } else {
                 command  = ""closemedium dvd \"""" + virtual_machine_slot_directory + ""/"" + iso_image_filename + ""\"" "";
+                // coverity[CHECKED_RETURN]
                 vbm_popen(command, output, ""remove virtual ISO 9660 disk"", false);
                 if (enable_cache_disk) {
                      command  = ""closemedium disk \"""" + virtual_machine_slot_directory + ""/"" + cache_disk_filename + ""\"" "";
+                     // coverity[CHECKED_RETURN]
                      vbm_popen(command, output, ""remove virtual cache disk"", false);
                 }
             }","@ChristianBeer, Personally I don't like stuff like this. Are these checks so critical and important that we need to say to coverity that we are ok with this? As far as I know, we don't have a mission to achieve 0 messages from any static analyzer, so why do we need this?",php,0,1,1
"@@ -214,10 +214,17 @@ class QueryController implements ContainerInjectionInterface {
   }
 
   /**
-   * Add the header row.
+   * Add the header row, from specified properties, if any, or the schema.
    */
   private function addHeaderRow(array &$data) {
-    $header_row = array_keys(reset($data['schema'])['fields']);
+
+    if (!empty($data['query']['properties'])) {
+      $header_row = $data['query']['properties'];
+    }
+    else {
+      $header_row = array_keys(reset($data['schema'])['fields']);
+    }
+
     if (is_array($header_row)) {
       array_unshift($data['results'], $header_row);
     }",@thierrydallacroce possible to provide test coverage for this condition?,php,0,1,1
"@@ -50,7 +50,7 @@ interface MediaProviderInterface
     /**
      * return the format settings.
      *
-     * @return array<string, mixed>|false the format settings
+     * @return array|false the format settings
      *
      * @phpstan-return FormatOptions|false
      */",you could have kept the precision,php,1,1,1
"@@ -76,6 +76,7 @@ class ServiceProvider extends ModuleServiceProvider
             $combiner->registerBundle('~/modules/backend/formwidgets/fileupload/assets/less/fileupload.less');
             $combiner->registerBundle('~/modules/backend/formwidgets/nestedform/assets/less/nestedform.less');
             $combiner->registerBundle('~/modules/backend/formwidgets/richeditor/assets/js/build-plugins.js');
+            $combiner->registerBundle('~/modules/backend/formwidgets/colorpicker/assets/less/colorpicker.less');
 
             /*
              * Rich Editor is protected by DRM",@w20k widget assets are recompiled when they're registered like this and then `php artisan october:util compile` is run.,php,0,1,1
"@@ -12,6 +12,12 @@ $config = [
             'SearchApi' => 'VuFindApi\Controller\SearchApiController',
         ],
     ],
+    'service_manager' => [
+        'allow_override' => true,
+        'factories' => [
+            'VuFindApi\Formatter\RecordFormatter' => 'VuFindApi\Formatter\RecordFormatterFactory',
+        ],
+    ],
     'router' => [
         'routes' => [
             'apiHome' => [",Do you need this allow_override setting here? Won't it be inherited from the main VuFind module?,php,1,1,1
"@@ -1157,10 +1157,8 @@ class RelationController extends ControllerBehavior
             }
         }
         elseif ($this->viewMode == 'single') {
-            $this->viewModel = $this->manageWidget->model;
-
             $this->viewWidget->setFormValues($saveData);
-            $this->viewModel->save(null, $this->manageWidget->getSessionKey());
+            $this->viewWidget->model->save(null, $this->manageWidget->getSessionKey());
         }
 
         return $this->relationRefresh();",Why wouldn't you just change this line to `$this->viewWidget->model`?,php,1,1,1
"@@ -57,7 +57,7 @@ class IdUserProvider implements UserProviderInterface
     /**
      * {@inheritdoc}
      */
-    public function refreshUser(UserInterface $user): User
+    public function refreshUser(UserInterface $user): UserInterface
     {
         return $this->loadUserByUsername($user->getUsername());
     }",PHPStan claims it's incorrect? It's legit by PHP...,php,1,1,1
"@@ -27,11 +27,11 @@ interface CategoryManagerInterface
     public function getRootCategory($context);
 
     /**
-     * @param bool|true $loadChildren
+     * @param bool $loadChildren
      *
      * @return CategoryInterface[]
      */
-    public function getRootCategories($loadChildren);
+    public function getRootCategories($loadChildren = true);
 
     /**
      * @param int $categoryId","this is a BC break, we should add an UPGRADE note",php,1,1,1
"@@ -653,8 +653,7 @@ func drupalEnsureWritePerms(app *DdevApp) error {
 
 	for _, o := range makeWritable {
 		stat, err := os.Stat(o)
-		// If the file doesn't exist, don't try to set the permissions.
-		if os.IsNotExist(err) {
+		if err != nil {
 			continue
 		}
 ","I'm pretty sure this should emit a util.Warning*(), since we're skipping by here and never hitting anything that will give them a warning about what's happened.",php,1,1,1
"@@ -93,6 +93,19 @@ return [
 
     'backendSkin' => 'Backend\Skins\Standard',
 
+    /*
+    |--------------------------------------------------------------------------
+    | Automatically run migrations on login
+    |--------------------------------------------------------------------------
+    |
+    | If value is true, UpdateMananger will be run on logging in to the backend.
+    | It's recommended to set this value to 'false' in production enviroments
+    | because it clears the cache every time a user logs in to the backend.
+    |
+    */
+
+    'runMigrationsOnLogin' => true,
+
     /*
     |--------------------------------------------------------------------------
     | Determines which modules to load","@bennothommo I wonder if we should have this set to null by default to represent pulling its value from the value of app.debug (debug enabled this enabled, debug disabled this disabled). Thoughts? Are users still able to have migrations run when installing new plugins or plugin updates through the backend when debug (i.e. this) is disabled in that case?",php,0,1,1
"@@ -89,9 +89,7 @@ final class CropResizer implements ResizerInterface
     }
 
     /**
-     * @param array<string, int> $settings
-     *
-     * @phpstan-param array{width: int, height: int} $settings
+     * @param array<string, mixed> $settings
      */
     private function createTargetBox(array $settings): Box
     {",Why losing this ?,php,1,0,1
"@@ -0,0 +1,18 @@
+<?php
+use October\Rain\Database\Schema\Blueprint;
+use October\Rain\Database\Updates\Migration;
+class DbSystemMailLayoutsInlineCss extends Migration
+{
+    public function up()
+    {
+        Schema::table('system_mail_layouts', function (Blueprint $table) {
+            $table->boolean('inline_css')->default(true);
+        });
+    }
+    public function down()
+    {
+        Schema::table('system_mail_layouts', function (Blueprint $table) {
+           $table->dropColumn('inlince_css');
+        });
+    }
+}",Think this should be `inline_css`,php,1,1,1
"@@ -12,8 +12,9 @@ interface ProductFactoryInterface
 
     /**
      * @param \Shopsys\FrameworkBundle\Model\Product\ProductData $data
+     * @param \Shopsys\FrameworkBundle\Model\Product\Product $mainProduct
      * @param \Shopsys\FrameworkBundle\Model\Product\Product[] $variants
      * @return \Shopsys\FrameworkBundle\Model\Product\Product
      */
-    public function createMainVariant(ProductData $data, array $variants): Product;
+    public function createMainVariant(ProductData $data, Product $mainProduct, array $variants): Product;
 }",docs do not mention the change of `createMainVariant` interface - I believe they should,php,1,1,1
"@@ -99,7 +99,7 @@ class SonataMediaExtension extends Extension implements PrependExtensionInterfac
         $loader->load('serializer.xml');
         $loader->load('command.xml');
 
-        if (!in_array(strtolower($config['db_driver']), ['doctrine_orm', 'doctrine_mongodb', 'doctrine_phpcr'])) {
+        if (!in_array(strtolower($config['db_driver']), ['doctrine_orm', 'doctrine_mongodb', 'doctrine_phpcr', 'no_driver'])) {
             throw new \InvalidArgumentException(sprintf('SonataMediaBundle - Invalid db driver ""%s"".', $config['db_driver']));
         }
 ","can we extract this array into a `const` maybe, what do @sonata-project/contributors think?",php,0,1,1
"@@ -4,17 +4,13 @@ namespace EasyCorp\Bundle\EasyAdminBundle\Search;
 
 use Doctrine\ORM\Query as DoctrineQuery;
 use Doctrine\ORM\QueryBuilder as DoctrineQueryBuilder;
-use Doctrine\ORM\Tools\Pagination\CountWalker;
-use Pagerfanta\Adapter\DoctrineORMAdapter;
-use Pagerfanta\Pagerfanta;
 
 /**
+ * @deprecated Use EasyCorp\Bundle\EasyAdminBundle\Search\QueryPaginator
  * @author Javier Eguiluz <javier.eguiluz@gmail.com>
  */
 class Paginator
 {
-    private const MAX_ITEMS = 15;
-
     /**
      * Creates a Doctrine ORM paginator for the given query builder.
      *","This is a BC break too, peoples overriding this method will expect an instance of `Pagerfanta`, but since the new one contains the same methods I guess can it be ignored?",php,1,1,1
"@@ -24,14 +24,14 @@ return [
         ],
         'access_denied' => [
             'label' => 'Hozzáférés megtagadva',
-            'help' => 'Ön nem rendelkezik a szükséges engedélyekkel ennek a lapnak a megtekintéséhez.',
+            'help' => 'Nem rendelkezik a szükséges engedélyekkel ennek a lapnak a megtekintéséhez.',
             'cms_link' => 'Vissza a látogatói oldalra'
         ],
         'no_database' => [
             'label' => 'Az adatbázis nem elérhető',
             'help' => 'Kérjük ellenőrizze a hozzáférési adatok helyességét majd próbálja újra betölteni az oldalt.',
             'cms_link' => 'Vissza a weboldalra'
-        ],
+        ]
     ],
     'partial' => [
         'not_found_name' => ""A(z) ':name' részlap nem található."",","All array elements should have a trailing comma in the language files, this makes it much easier to update them in the future. I'm not going to force people to add them but I do draw the line at them being removed @gergo85   (@w20k @bennothommo FYI)",php,0,1,1
"@@ -89,9 +89,7 @@ class ScalarTypeComparator
         }
 
         if ($container_type_part instanceof TNonspecificLiteralString
-            && ($input_type_part instanceof TLiteralString
-                || $input_type_part instanceof TNonspecificLiteralString
-                || $input_type_part instanceof TNonEmptyNonspecificLiteralString)
+            && ($input_type_part instanceof TLiteralString || $input_type_part instanceof TNonspecificLiteralString)
         ) {
             return true;
         }",TNonEmptyNonspecificLiteralString is a child of TNonspecificLiteralString just above,php,1,0,1
"@@ -115,7 +115,7 @@ abstract class BaseMediaAdmin extends AbstractAdmin
                     );
                 } else {
                     $media->setProviderName(
-                        $this->getRequest()->get($uniqid['providerName'])
+                        $this->getRequest()->get($uniqid)['providerName']
                     );
                 }
             } else {","Function array dereferencing does not work on old versions of php, you will have to change that (that's why the build fails)",php,1,1,1
"@@ -65,4 +65,14 @@ class Search2recordController extends AbstractRecord
         return isset($config->Record->next_prev_navigation)
             && $config->Record->next_prev_navigation;
     }
+
+    /**
+     * Get the Hierarchy Type (false if none)
+     *
+     * @return string|bool
+     */
+    public function getHierarchyType()
+    {
+        return 'Search2';
+    }
 }",Does this method do anything? I'm not seeing any getHierarchyType method used/defined in the core code's controllers -- this seems to be a record driver mechanism.,php,1,1,1
"@@ -23,4 +23,9 @@ interface AccountQueryInterface
      * @return UserId[]
      */
     public function findUserIdByRoleId(RoleId $roleId): array;
+
+    /**
+     * @return array
+     */
+    public function getUsers(): array;
 }",This brings nothing to the table. Can you specify a type perhaps?,php,1,1,1
"@@ -178,7 +178,12 @@ class MailManager
 
         $css = MailBrandSetting::renderCss();
 
+        $disableInlineCss = false;
+
         if ($template->layout) {
+
+            $disableInlineCss = array_get($template->layout->options, 'disable_inline_css', $disableInlineCss);
+
             $html = $this->renderTwig($template->layout->content_html, [
                 'content' => $html,
                 'css' => $template->layout->content_css,","Would it not be more appropiate to name this ""$disableCssToInline""? Because we are not someohow preventing the layout to have inline styles, we are just toggling whether or not we want defined css classes converted to inline css.",php,1,1,1
"@@ -193,7 +193,7 @@ int FILE_INFO::verify_file(
     //
     if (download_gzipped && !boinc_file_exists(pathname)) {
         char gzpath[MAXPATHLEN];
-        snprintf(gzpath, sizeof(gzpath), ""%s.gz"", pathname);
+        snprintf(gzpath, sizeof(gzpath), ""%.2048s.gz"", pathname);
         if (boinc_file_exists(gzpath) ) {
             if (allow_async && nbytes > ASYNC_FILE_THRESHOLD) {
                 ASYNC_VERIFY* avp = new ASYNC_VERIFY;","`pathname` is 4096 symbols long. `gzpath` too. Maybe it worth to change this: `""%.2048s.gz"", pathname` to this: `""%.*s.gz"", sizeof(gzpath)-3, pathname` ?",php,1,1,1
"@@ -985,10 +985,14 @@ class MediaManager extends WidgetBase
 
             $path = Input::get('path');
             $path = MediaLibrary::validatePath($path);
-
+            
+            $realpath = empty(trim($uploadedFile->getRealPath())) 
+                            ? $uploadedFile->getPath().DIRECTORY_SEPARATOR.$uploadedFile->getFileName() 
+                            : $uploadedFile->getRealPath()
+                        ;
             MediaLibrary::instance()->put(
                 $path.'/'.$fileName,
-                File::get($uploadedFile->getRealPath())
+                File::get($realpath))
             );
 
             die('success');",You have an extra `)` in `File::get($realpath))`. Please remove it.,php,1,1,1
"@@ -0,0 +1,5 @@
+<?php
+
+if (file_exists(__DIR__.'/../var/cache/dev/Bolt_KernelDevDebugContainer.preload.php')) {
+    require __DIR__.'/../var/cache/dev/Bolt_KernelDevDebugContainer.preload.php';
+}","This file is not needed. I don't know where it came from, but I occasionally see it popping up on my end as well. Regardless, we can remove it here.",php,1,1,1
"@@ -124,6 +124,12 @@ class ContentTypesParser extends BaseParser
             $contentType['singleton'] = false;
         }
 
+        if ($contentType['singleton']) {
+            $contentType['listing_records'] = 1;
+        } elseif (isset($contentType['listing_records']) === false) {
+            $contentType['listing_records'] = 6;
+        }
+
         if (! isset($contentType['locales'])) {
             $contentType['locales'] = [];
         } elseif (is_string($contentType['locales'])) {",shouldn't it default to what is set in main config?,php,1,1,1
"@@ -10273,7 +10273,7 @@ return [
 'preg_filter' => ['null|string|string[]', 'pattern'=>'mixed', 'replacement'=>'mixed', 'subject'=>'mixed', 'limit='=>'int', '&w_count='=>'int'],
 'preg_grep' => ['array|false', 'pattern'=>'string', 'array'=>'array', 'flags='=>'int'],
 'preg_last_error' => ['int'],
-'preg_match' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_matches='=>'string[]', 'flags='=>'0|', 'offset='=>'int'],
+'preg_match' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_matches='=>'string[]', 'flags='=>'0', 'offset='=>'int'],
 'preg_match\'1' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_matches='=>'array', 'flags='=>'int', 'offset='=>'int'],
 'preg_match_all' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_matches='=>'array', 'flags='=>'int', 'offset='=>'int'],
 'preg_quote' => ['string', 'str'=>'string', 'delimiter='=>'string'],",Why flags are 0 here?,php,1,1,1
"@@ -55,6 +55,7 @@ final class ThumbnailCompilerPassTest extends TestCase
 
 final class TestUncallableAddResizerMethod
 {
+    // @phpstan-ignore-next-line
     private function addResizer(): void
     {
     }",Can you explain why ?,php,1,0,1
"@@ -3,7 +3,6 @@
 namespace Shopsys\FrameworkBundle\Controller\Admin;
 
 use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
-use Shopsys\FrameworkBundle\Component\Controller\AdminBaseController;
 use Shopsys\FrameworkBundle\Model\Mail\MailTemplateFacade;
 use Shopsys\FrameworkBundle\Model\Statistics\StatisticsFacade;
 use Shopsys\FrameworkBundle\Model\Statistics\StatisticsProcessingFacade;","the blank line should not be here. Also, there is a typo in commit message - ""jut"" instead of ""just""",php,1,1,1
"@@ -86,10 +86,10 @@ class OrderItemFacade
         $product = $this->productRepository->getById($productId);
         $orderDomainConfig = $this->domain->getDomainConfigById($order->getDomainId());
 
-        $productPrice = $this->productPriceCalculationForUser->calculatePriceForUserAndDomainId(
+        $productPrice = $this->productPriceCalculationForUser->calculatePriceForCustomerUserAndDomainId(
             $product,
             $order->getDomainId(),
-            $order->getCustomer()
+            $order->getCustomerUser()
         );
 
         $orderProduct = $this->orderItemFactory->createProduct(",Maybe `ProductPriceCalculationForUser` should be also renamed to `productPriceCalculationForCustomerUser`,php,1,1,1
"@@ -34,6 +34,17 @@ class Configuration implements ConfigurationInterface
             ->children()
                 ->scalarNode('db_driver')->isRequired()->end()
                 ->scalarNode('default_context')->isRequired()->end()
+                ->arrayNode('admin_format')
+                    ->info('Configures the thumbnail preview for the admin')
+                    ->addDefaultsIfNotSet()
+                    ->children()
+                        ->scalarNode('width')->defaultValue(200)->end()
+                        ->scalarNode('height')->defaultValue(false)->end()
+                        ->scalarNode('quality')->defaultValue(90)->end()
+                        ->scalarNode('format')->defaultValue('jpg')->end()
+                        ->scalarNode('constraint')->defaultValue(true)->end()
+                    ->end()
+                ->end()
             ->end()
         ;
 ",maybe `->info()` would be great for what this is used,php,1,1,1
"@@ -109,8 +109,12 @@ class ArrayAnalyzer
         }
 
         if ($array_creation_info->all_list) {
-            $array_type = new Type\Atomic\TNonEmptyList($item_value_type ?: Type::getMixed());
-            $array_type->count = count($stmt->items);
+            if (empty($array_creation_info->item_key_atomic_types)) {
+                $array_type = new Type\Atomic\TList($item_value_type ?: Type::getMixed());
+            } else {
+                $array_type = new Type\Atomic\TNonEmptyList($item_value_type ?: Type::getMixed());
+                $array_type->count = count($array_creation_info->property_types);
+            }
 
             $stmt_type = new Type\Union([
                 $array_type,","Not sure if this is correct, but I'm also not sure what would be correct. `count($stmt->items)` is clearly wrong with unpacked arrays. Should `count` be renamed to `min_count` as well?",php,1,1,1
"@@ -848,9 +848,9 @@ return [
 'closelog' => ['bool'],
 'Closure::bind' => ['Closure', 'old'=>'Closure', 'to'=>'object|null', 'scope='=>'object|string'],
 'Closure::bindTo' => ['Closure', 'new'=>'object|null', 'newscope='=>'object|string'],
-'Closure::call' => ['Closure', 'to'=>'object', 'parameter='=>'', '...='=>''],
+'Closure::call' => ['mixed', 'to'=>'object', 'parameter='=>'mixed', '...='=>'mixed'],
 'Closure::__construct' => [''],
-'Closure::__invoke' => ['', '...=' => ''],
+'Closure::__invoke' => ['mixed', '...=' => 'mixed'],
 'Closure::fromCallable' => ['Closure', 'callable'=>'callable'],
 'Collator::asort' => ['bool', 'arr'=>'array', 'sort_flag='=>'int'],
 'collator_asort' => ['bool', 'coll='=>'collator', 'arr'=>'array', 'sort_flag='=>'int'],","for brevity, `''` means `mixed`, so you can remove the *other* changes here",php,1,1,1
"@@ -1,8 +1,11 @@
 <?php namespace Cms\Controllers;
 
+use File;
+use Lang;
 use Backend;
 use BackendMenu;
 use ApplicationException;
+use Cms\Classes\Theme;
 use Cms\Models\ThemeData;
 use Cms\Classes\Theme as CmsTheme;
 use System\Classes\SettingsManager;",These extra import statements shouldn't be required anymore,php,1,1,1
"@@ -102,18 +102,9 @@ return [
 
             return $contents;
         },
-        function ($filePath, $prefix, $contents) {
-            $ret = str_replace(
-                $prefix . '\Psalm\Plugin\\',
-                'Psalm\Plugin\\',
-                $contents
-            );
-            return $ret;
-        },
     ],
     'whitelist' => [
         \Composer\Autoload\ClassLoader::class,
-        'Psalm\Plugin\*',
     ],
     'files-whitelist' => [
         'src/Psalm/Internal/PropertyMap.php',",Wouldn't these changes cause problems running plugins with phar-packaged Psalm?,php,1,1,1
"@@ -23,8 +23,13 @@
 
 namespace Thelia\Model;
 
+use Propel\Runtime\Propel;
 use Thelia\Model\Base\Coupon as BaseCoupon;
+use Thelia\Model\Base\CouponCountryQuery;
+use Thelia\Model\Base\CouponModuleQuery;
 use Thelia\Model\Exception\InvalidArgumentException;
+use Thelia\Model\Map\CouponTableMap;
+use Thelia\Model\Tools\ModelEventDispatcherTrait;
 
 /**
  * Used to provide an effect (mostly a discount)",Base model is imported here.,php,1,0,1
"@@ -66,7 +66,7 @@ class UserDataFixture extends AbstractReferenceFixture implements DependentFixtu
         $customersData = $this->loaderService->getCustomersDataByDomainId(Domain::FIRST_DOMAIN_ID);
 
         foreach ($customersData as $customerData) {
-            $customerData->userData->createdAt = $this->faker->dateTimeBetween('-1 week', 'now');
+            $customerData->userData->createdAt = $this->faker->dateTimeBetween('-2 week', 'now');
 
             $customer = $this->customerFacade->create($customerData);
 ",so you would need to regenerate demodata regularly to have the same statistics.....,php,1,0,1
"@@ -199,7 +199,6 @@ class UserDataFixtureLoader
         } else {
             $customerData->deliveryAddressData = $this->deliveryAddressDataFactory->create();
         }
-        $userData->domainId = $domainId;
 
         $customerData->userData = $userData;
         $customerData->billingAddressData = $billingAddressData;",commit message: should be the dash part on the new line with one empty line ? or is it intentional ?,php,1,1,1
"@@ -66,6 +66,13 @@ abstract class Results
      */
     protected $startRecordOverride = null;
 
+    /**
+     * Offset override (only for use in very rare cases)
+     *
+     * @var string
+     */
+    protected $startRecordOffset = null;
+
     /**
      * Array of results (represented as Record Driver objects) retrieved on latest
      * search","I find this all a bit confusing; I wonder if it would be better to implement this entirely within the Solr/Results.php, and just go ahead and call it CursorMark. We can refactor it to something more generic in future if we find a common use case... but I think it might be premature to try to find a generic approach to something this specific in function.",php,1,1,1
"@@ -136,6 +136,17 @@ class User extends UserBase
     public function afterLogin()
     {
         parent::afterLogin();
+        /**
+         * @event backend.user.login
+         * Provides an opportunity to interact with the Backend User model after the user has logged in
+         *
+         * Example usage:
+         *
+         *     Event::listen('backend.user.login', function ((\Backend\Models\User) $user) {
+         *         Flash::success(sprintf('Welcome %s!', $user->getFullNameAttribute()));
+         *     });
+         *
+         */
         Event::fire('backend.user.login', [$this]);
     }
 ",extra line of whitespace before the start of the docblock please,php,1,1,1
"@@ -295,13 +295,14 @@ class NonDivArithmeticOpAnalyzer
             && $right_type_part instanceof TLiteralInt
             && ($left instanceof PhpParser\Node\Scalar
                 || $left instanceof PhpParser\Node\Expr\ConstFetch
-                || $left instanceof PhpParser\Node\Expr\ClassConstFetch)
+                || $left instanceof PhpParser\Node\Expr\ClassConstFetch
+                || $left instanceof PhpParser\Node\Expr\BinaryOp)
             && ($right instanceof PhpParser\Node\Scalar
                 || $right instanceof PhpParser\Node\Expr\ConstFetch
-                || $right instanceof PhpParser\Node\Expr\ClassConstFetch)
+                || $right instanceof PhpParser\Node\Expr\ClassConstFetch
+                || $right instanceof PhpParser\Node\Expr\BinaryOp)
         ) {
             // time for some arithmetic!
-
             $calculated_type = null;
 
             if ($parent instanceof PhpParser\Node\Expr\BinaryOp\Plus) {","Shouldn't this be any expression really? E.g. `(true ? 1 : 2) | 22` would not have `$left` as binary op, but it still can be calculated, I suppose.",php,1,1,1
"@@ -251,11 +251,11 @@ const ConfigInstructions = `
 # These values specify the destination directory for ddev ssh and the
 # directory in which commands passed into ddev exec are run.
 
-# omit_containers: [""dba"", ""ddev-ssh-agent""]
-# would omit the dba (phpMyAdmin) and ddev-ssh-agent containers. Currently
-# only those two containers can be omitted here.
-# Note that these containers can also be omitted globally in the
-# ~/.ddev/global_config.yaml or with the ""ddev config global"" command.
+# omit_containers: [""db"", dba"", ""ddev-ssh-agent""]
+# Currently only these containers are supported. Some containers can also be
+# omitted globally in the ~/.ddev/global_config.yaml. Note that if you omit
+# the ""db"" container, several standard features of ddev that access the
+# database container will be unusuable.
 
 # nfs_mount_enabled: false
 # Great performance improvement but requires host configuration first.","Sorry, typo s/unusuable/unusable/",php,1,1,1
"@@ -114,8 +114,9 @@ abstract class BaseMediaAdmin extends AbstractAdmin
                         $this->getRequest()->get(sprintf('%s[providerName]', $uniqid), null, true)
                     );
                 } else {
+                    $provider = $this->getRequest()->get($uniqid);
                     $media->setProviderName(
-                        $this->getRequest()->get($uniqid['providerName'])
+                        $provider['providerName']
                     );
                 }
             } else {",Now it can be single line.,php,1,1,1
"@@ -74,8 +74,8 @@ class ExtensionConfigurationTest extends UnitTest
             ['useConfigurationMonitorTables' => 'pages, tt_content']
         );
         $expectedResult = [
-            'pages' => true,
-            'tt_content' => true
+            'pages' => 0,
+            'tt_content' => 1
         ];
         $this->assertEquals($expectedResult, $configurationUseConfigurationTrackRecordsOutsideSiteroot->getIsUseConfigurationMonitorTables());
     }",Is this really a wanted change? Becuase pages should also be 1 from my thinking and also we change the values from boolean to int?,php,1,1,1
"@@ -0,0 +1,16 @@
+<?php
+
+declare(strict_types=1);
+
+namespace Bolt\Widget;
+
+use Psr\SimpleCache\CacheInterface;
+
+/**
+ * Interface CacheAware - Widgets that make use of caching need to implement
+ * this interface, in order to have their contents cached.
+ */
+interface CacheAware extends WidgetInterface
+{
+    public function setCacheInterface(CacheInterface $config): void;
+}",setCache* or setCacheAdapter*,php,1,0,0
"@@ -14,6 +14,7 @@ class TArray extends \Psalm\Type\Atomic
 
     /**
      * @var array{\Psalm\Type\Union, \Psalm\Type\Union}
+     * @psalm-suppress NonInvariantPropertyType
      */
     public $type_params;
 ",Maybe this and similar properties can be deleted from the code and we can just use the properties declared in the parent classes?,php,1,1,1
"@@ -521,7 +521,7 @@ class BaseModule extends ContainerAware implements BaseModuleInterface
      * @param string $newVersion the new module version, as defined in the module.xml file
      * @param ConnectionInterface $con
      */
-    public function update($currentVersion, $newVersion, ConnectionInterface $con)
+    public function update($currentVersion, $newVersion, ConnectionInterface $con = null)
     {
         // Override this method to do something useful.
     }","By adding the default ""null"" to $con parameter, you're breaking the compatibility with exiting modules which uses the signature without the default 'null' value, which was valid until now. Please remove this 'null' default.",php,1,1,1
"@@ -67,17 +67,7 @@ class ControllerListener
             return;
         }
 
-        $customController = $entity['controller'];
-        $controllerMethod = $currentController[1];
-
-        // build the full controller name depending on its type
-        if (class_exists($customController)) {
-            // 'class::method' syntax for normal controllers
-            $customController .= '::'.$controllerMethod;
-        } else {
-            // 'service:method' syntax for controllers as services
-            $customController .= ':'.$controllerMethod;
-        }
+        $customController = $entity['controller'].'::'.$currentController[1];
 
         $request->attributes->set('_controller', $customController);
         $newController = $this->resolver->getController($request);",This must probably still take into account the installed version of the HttpKernel component. IIRC EasyAdminBundle is compatible with older versions that don't allow the syntax with two colons for controller services.,php,1,1,1
"@@ -227,7 +227,7 @@ function roots_nice_search_redirect() {
 
   $search_base = $wp_rewrite->search_base;
   if (is_search() && !is_admin() && strpos($_SERVER['REQUEST_URI'], ""/{$search_base}/"") === false) {
-    wp_redirect(home_url(""/{$search_base}/"" . urlencode(get_query_var('s'))));
+	  wp_redirect(esc_url_raw(home_url(""/{$search_base}/"" . get_query_var('s'))));
     exit();
   }
 }","woops? (spacing) just remembered this file is in soil now, anyway. could you submit a PR over there for this one?",php,1,1,1
"@@ -401,7 +401,10 @@ class FileProvider extends BaseProvider
             $media->setProviderReference($this->generateReferenceName($media));
         }
 
-        if ($media->getBinaryContent() instanceof File) {
+        if ($media->getBinaryContent() instanceof UploadedFile) {
+            $media->setContentType($media->getBinaryContent()->getClientMimeType());
+            $media->setSize($media->getBinaryContent()->getSize());
+        } elseif ($media->getBinaryContent() instanceof File) {
             $media->setContentType($media->getBinaryContent()->getMimeType());
             $media->setSize($media->getBinaryContent()->getSize());
         }",Can the client mimetype be null?,php,1,1,1
"@@ -669,6 +669,12 @@ func TestDdevXdebugEnabled(t *testing.T) {
 	runTime := util.TimeTrack(time.Now(), fmt.Sprintf(""%s %s"", site.Name, t.Name()))
 
 	phpVersions := nodeps.ValidPHPVersions
+
+	// arm64 builds from deb.sury.org do not have xdebug in php5.6
+	if runtime.GOARCH == ""arm64"" {
+		t.Log(""Skipping php5.6 test on arm64 because deb.sury.org packages do not include it currently"")
+		delete(phpVersions, ""5.6"")
+	}
 	phpKeys := make([]string, 0, len(phpVersions))
 	for k := range phpVersions {
 		phpKeys = append(phpKeys, k)","Silly me. This shouldn't be done in the tests, but instead in the actual definition of ValidPHPVersions on arm64. Same with Mysql and MariaDB.",php,0,1,1
"@@ -14,8 +14,10 @@ var (
 	DdevBin      = ""ddev""
 	DevTestSites = []testcommon.TestSite{
 		{
-			Name:        ""drupal8"",
-			DownloadURL: ""https://github.com/drud/drupal8/archive/v0.2.2.tar.gz"",
+			Name:      ""drupal8"",
+			SourceURL: ""https://github.com/drud/drupal8/archive/v0.2.2.tar.gz"",
+			FileURL:   ""https://github.com/drud/drupal8/releases/download/v0.2.2/files.tar.gz"",
+			DBURL:     ""https://github.com/drud/drupal8/releases/download/v0.2.2/db.tar.gz"",
 		},
 	}
 )",This is currently a db.tar.gz with just one .sql file in it. It might be worth another test (or maybe I'll find one) that has more than one sql file in it.,php,1,1,1
"@@ -132,7 +132,8 @@ if (TYPO3_MODE == 'BE') {
         'solr::clearSolrConnectionCache',
         'ApacheSolrForTypo3\\Solr\\ConnectionManager->updateConnections'
     );
-
+}
+if ((TYPO3_MODE == 'BE') || ((TYPO3_MODE == 'FE') && isset($_POST['TSFE_EDIT']))) {
     // the order of registering the garbage collector and the record monitor is important!
     // for certain scenarios items must be removed by GC first, and then be re-added to to Index Queue
 ",Can you make two changes here: 1) You don't need the braces around `TYPO3_MODE == 'FE'` 2) Please use triple equal signs for comparison `===`,php,1,1,1
"@@ -26,7 +26,7 @@ return [
         'se' => 'Swedish',
         'sk' => 'Slovak (Slovakia)',
         'tr' => 'Turkish',
-        'zh-cn' => 'Chinese (China)',
+        'zh-cn' => '简体中文',
         'el' => 'Greek'
     ],
     'directory' => [","This should be the word ""Chinese"" in English",php,1,1,1
"@@ -66,8 +66,14 @@ class AdminController extends Controller
             return $forbiddenActionResponse;
         }
 
+        $entity = $request->query->get('entity');
+        if (isset($this->entity['role']) &&
+            !$this->get('security.context')->isGranted($this->entity['role'])) {
+                throw $this->createAccessDeniedException();
+        }
+
         // for now, the homepage redirects to the 'list' action and view of the first entity
-        if (null === $request->query->get('entity')) {
+        if (null === $entity) {
             return $this->redirect($this->generateUrl('admin', array(
                 'action' => $action,
                 'entity' => $this->getNameOfTheFirstConfiguredEntity(),","This would need a bridge/alternative to fit to SF2.7+, because the `security.context` is going to disappear",php,1,1,1
"@@ -15,7 +15,8 @@ namespace Sonata\MediaBundle\Security;
 
 use Sonata\MediaBundle\Model\MediaInterface;
 use Symfony\Component\HttpFoundation\Request;
-use Symfony\Component\Translation\TranslatorInterface;
+use Symfony\Component\Translation\TranslatorInterface as LegacyTranslatorInterface;
+use Symfony\Contracts\Translation\TranslatorInterface;
 
 /**
  * @final since sonata-project/media-bundle 3.21.0","We usually use references to the argument number instead its name. Additionally, we use the term ""argument"" instead of ""parameter"".",php,1,1,1
"@@ -17,7 +17,9 @@
 
 from abc import ABCMeta, abstractmethod
 import os
+from typing import Optional
 from selenium.webdriver.common.utils import keys_to_typing
+from selenium.types import AnyKey
 
 
 class FileDetector(metaclass=ABCMeta):","just realised... This breaks things since there is not selenium types module, is there a PR for this?",py,0,1,1
"@@ -93,7 +93,7 @@ CMPS = [""="", ""-"", ""+""]
 
 
 # py3k has no more cmp builtin
-def cmp(a, b):  # pylint: disable=redefined-builtin
+def cmp(a, b):
     return (a > b) - (a < b)
 
 ",This was useless since pylint 2.0,py,1,0,1
"@@ -82,6 +82,9 @@ class KMSScannerTest(unittest_utils.ForsetiTestCase):
 
             crypto_key.data = fake_kms_scanner_data.NON_ROTATED_CRYPTO_KEY_DATA
 
+            crypto_key.data = (
+                fake_kms_scanner_data.NON_ROTATED_CRYPTO_KEY_STATE_DATA)
+
             session.commit()
 
     def setUp(self):",why do we set the crypto_key.data twice? (here and two lines above),py,1,1,1
"@@ -360,6 +360,10 @@ DATA = collections.OrderedDict([
          SettingValue(typ.Bool(), 'false'),
          ""Hide the tabbar if only one tab is open.""),
 
+        ('perm-hide',
+         SettingValue(typ.Bool(), 'false'),
+         ""Hide permanently.""),
+
         ('wrap',
          SettingValue(typ.Bool(), 'true'),
          ""Whether to wrap when changing tabs.""),","I think `perm-` is a bit confusing. I'd prefer `always-hide`. Alternatively, renaming `auto-hide` to `hide-auto` and `perm-hide` to `hide-always` would sort them correctly. What's your opinion on this?",py,1,1,1
"@@ -30,6 +30,11 @@ try:
 except ImportError:
     something = None
 
+try:
+    from collections import something
+except ModuleNotFoundError:
+    something = None
+
 try:
     from collections import anything # [no-name-in-module]
 except ValueError:",Could you recheck some of these tests? Some are non-sensical (such as this one) in that they never occur in actual runtime `python`. Since `collections` can be found this will/should never raise a `ModuleNotFoundError` and only raise a `ImportError`. I think we shouldn't bloat our tests with unfeasible examples.,py,1,1,1
"@@ -1062,11 +1062,13 @@ class DynamicMap(HoloMap):
         self[key] = val
 
 
-    def map(self, map_fn, specs=None, clone=True):
+    def map(self, map_fn, specs=None, clone=True, link_inputs=True):
         """"""
         Recursively replaces elements using a map function when the
         specification applies. Extends regular map with functionality
-        to dynamically apply functions.
+        to dynamically apply functions. By default all streams are
+        still linked to the mapped object, to disable linked streams
+        set linked_inputs=False.
         """"""
         deep_mapped = super(DynamicMap, self).map(map_fn, specs, clone)
         if isinstance(deep_mapped, type(self)):",Seems useful though I just want to check this feature is unrelated to the rest of the PR...,py,0,0,0
"@@ -841,6 +841,11 @@ def data(readonly=False):
              ""required to exactly match the requested domain.\n\n""
              ""Local domains are always exempt from hostblocking.""),
 
+            ('enable-pdfjs', SettingValue(typ.Bool(), 'true'),
+             ""Enable pdf.js to view PDF files in the browser.\n\n""
+             ""Note that the files can still be downloaded by clicking""
+             "" the download button in the pdf.js viewer.""),
+
             readonly=readonly
         )),
 ",I'd prefer if this was `false` by default - I think many people prefer to opt-in to pdfjs than to opt-out of it :wink:,py,1,1,1
"@@ -1987,6 +1987,10 @@ class NameChecker(_BasicChecker):
                     self._check_name(""variable"", node.name, node)
         elif isinstance(frame, astroid.ClassDef):
             if not list(frame.local_attr_ancestors(node.name)):
+                for ancestor in frame.ancestors():
+                    if ancestor.name == ""Enum"" and ancestor.root().name == ""enum"":
+                        self._check_name(""const"", node.name, node)
+                        return
                 self._check_name(""class_attribute"", node.name, node)
 
     def _recursive_check_names(self, args, node):",I would prefer a simple break statement here instead of return. What do you think about it?,py,1,1,1
"@@ -119,6 +119,7 @@ install_requires = [
     ""invenio-documents>=0.1.0.post2"",
     ""invenio-upgrader>=0.1.0"",
     ""invenio-unapi>=0.1.0"",
+    ""invenio-jsonschemas>=0.0.0"",
     ""itsdangerous>=0.24"",
     ""jellyfish>=0.3.2"",
     ""Jinja2>=2.7"",",it's not required dependency,py,1,0,1
"@@ -0,0 +1,15 @@
+# Licensed under the GPL: https://www.gnu.org/licenses/old-licenses/gpl-2.0.html
+# For details: https://github.com/PyCQA/pylint/blob/main/LICENSE
+
+import sys
+
+from pylint.reporters import BaseReporter
+
+
+def test_deprecation_set_output(recwarn):
+    """"""TODO remove in 3.0""""""  # pylint: disable=fixme
+    reporter = BaseReporter()
+    reporter.set_output(sys.stdout)
+    warning = recwarn.pop()
+    assert ""set_output' will be removed in 3.0"" in str(warning)
+    assert reporter.out == sys.stdout",Is this file at the right place? I would have expected this test in ``tests/unittest_reporting.py``.,py,1,1,1
"@@ -45,6 +45,7 @@ import sys
 import time
 
 import pkg_resources
+from prometheus_client import CONTENT_TYPE_LATEST
 import tornado.httpserver
 import tornado.ioloop
 import tornado.netutil","This breaks because we are missing `prometheus_client` as a dependency in `setup.py`. So instead of pulling the dependency, we can hardcode the string.",py,1,1,1
"@@ -8,14 +8,14 @@
 Bluetooth layers, sockets and send/receive functions.
 """"""
 
+import ctypes
 import socket
 import struct
 import array
-from ctypes import *
 from select import select
 
 from scapy.config import conf
-from scapy.data import DLT_BLUETOOTH_HCI_H4
+from scapy.data import DLT_BLUETOOTH_HCI_H4, DLT_BLUETOOTH_HCI_H4_WITH_PHDR
 from scapy.packet import *
 from scapy.fields import *
 from scapy.supersocket import SuperSocket","This is some cleanup: previously importing scapy ==> import all types from ctypes, because of its usage in bluetooth.py",py,1,1,1
"@@ -471,6 +471,9 @@ class RemoteConnection(object):
             request.add_header('Accept', 'application/json')
             request.add_header('Content-Type', 'application/json;charset=UTF-8')
 
+            base64string = base64.b64encode('%s:%s' % (parsed_url.username, parsed_url.password))
+            request.add_header(""Authorization"", ""Basic %s"" % base64string)
+
             if password_manager:
                 opener = url_request.build_opener(url_request.HTTPRedirectHandler(),
                                                   HttpErrorHandler(),","This will always add the authorization header to the request object. Is this the right scope for these two lines? If username/password are not defined, it will encode 'Basic :'",py,1,1,1
"@@ -390,6 +390,8 @@ class Similar:
 
     def run(self) -> None:
         """"""start looking for similarities and display results on stdout""""""
+        if self.min_lines == 0:
+            sys.exit(0)
         self._display_sims(self._compute_sims())
 
     def _compute_sims(self) -> List[Tuple[int, Set[LinesChunkLimits_T]]]:","Here, it won't work! Use `return` instead.",py,1,1,0
"@@ -170,7 +170,11 @@ class UIATextRangeAttributeValueFetcher(object):
 		self.textRange=textRange
 
 	def getValue(self,ID,ignoreMixedValues=False):
-		val=self.textRange.getAttributeValue(ID)
+		try:
+			val=self.textRange.getAttributeValue(ID)
+		except COMError:
+			# #7124: some text attributes are not supported in  older Operating Systems 
+			return UIAHandler.handler.reservedNotSupportedValue
 		if not ignoreMixedValues and val==UIAHandler.handler.ReservedMixedAttributeValue:
 			raise UIAMixedAttributeError
 		return val","Is this something that would be helpful to log? Would that cause a lot of noise in the log? I'm considering a case where we are investigating why something does not work in a particular OS for instance. What happens when `reservedNotSupportedValue` is returned, is this handled gracefully in all cases?",py,1,1,1
"@@ -52,6 +52,8 @@ class ApiritifNoseExecutor(SubprocessedExecutor):
     def __init__(self):
         super(ApiritifNoseExecutor, self).__init__()
         self._tailer = FileReader(file_opener=lambda _: None, parent_logger=self.log)
+        self._iteration_number = None
+        self._iteration_start = None
 
     def reporting_setup(self, prefix=None, suffix=None):
         if not self.reported:",Why store these fields at all? Why not just make iteration listener to receive `iteration_started(time)` and `iteration_ended(time)` so it decides itself what to store and do?,py,1,1,1
"@@ -10,7 +10,11 @@ SQLALCHEMY_DATABASE_URI = os.environ['SQLALCHEMY_DATABASE_URI']
 REGISTRY_URL = os.environ['REGISTRY_URL']
 CATALOG_HOST = os.environ['CATALOG_HOST']
 
-CATALOG_URL = 'https://%s' % CATALOG_HOST
+CATALOG_URL = os.environ.get('CATALOG_URL', 'https://%s' % CATALOG_HOST)
+if not CATALOG_URL.startswith(""https""):
+    print(""WARNING: INSECURE CONNECTION TO CATALOG"")
+    # require verbose environment variable to be defined
+    ALLOW_INSECURE_CATALOG_ACCESS = os.environ['ALLOW_INSECURE_CATALOG_ACCESS']
 
 PACKAGE_BUCKET_NAME = os.environ['PACKAGE_BUCKET_NAME']
 ",I'm fine with `CATALOG_URL` - but we should then drop `CATALOG_HOST`. No point in having two of them,py,1,1,1
"@@ -248,12 +248,12 @@ def snmpwalk(dst, oid=""1"", community=""public""):
     try:
         while True:
             r = sr1(IP(dst=dst)/UDP(sport=RandShort())/SNMP(community=community, PDU=SNMPnext(varbindlist=[SNMPvarbind(oid=oid)])),timeout=2, chainCC=1, verbose=0, retry=2)
-            if ICMP in r:
-                print(repr(r))
-                break
             if r is None:
                 print(""No answers"")
                 break
+            if ICMP in r:
+                print(repr(r))
+                break
             print(""%-40s: %r"" % (r[SNMPvarbind].oid.val,r[SNMPvarbind].value))
             oid = r[SNMPvarbind].oid
             ",How about `r.show()`,py,1,0,1
"@@ -133,10 +133,12 @@ def process_proxy_options(parser, options):
 
     if options.clientcerts:
         options.clientcerts = os.path.expanduser(options.clientcerts)
-        if not os.path.exists(options.clientcerts) or not os.path.isdir(options.clientcerts):
+        if not (os.path.exists(options.clientcerts) or
+                os.path.isdir(options.clientcerts) or
+                os.path.isfile(options.clientcerts)):
             return parser.error(
-                ""Client certificate directory does not exist or is not a directory: %s"" %
-                options.clientcerts
+                ""Client certificate argument is not a file or directory, ""
+                ""or does not exist: %s"" % options.clientcerts
             )
 
     if options.auth_nonanonymous or options.auth_singleuser or options.auth_htpasswd:","This condition doesn't make much sense, `isdir/isfile` always imply `exists`. I think just checking for `.exists()` is good enough.",py,1,1,1
"@@ -4,7 +4,6 @@
 #See the file COPYING for more details.
 
 from baseObject import AutoPropertyObject, ScriptableObject
-from scriptHandler import isScriptWaiting
 import config
 import textInfos
 import speech",I think you can do the same with `speech`,py,1,0,1
"@@ -344,6 +344,14 @@ def run(cmd, *args, win_id, env, verbose=False):
     if user_agent is not None:
         env['QUTE_USER_AGENT'] = user_agent
     cmd = os.path.expanduser(cmd)
+
+    # check if userscript is in absolute path or in $XDG_DATA_DIRS
+    if not os.path.isabs(cmd):
+        log.misc.debug(""{} is no absoulte path"".format(cmd))
+        c = os.path.join(standarddir.data(), ""userscripts"", cmd)
+        if os.path.isfile(c):
+            cmd = c
+
     runner.run(cmd, *args, env=env, verbose=verbose)
     runner.finished.connect(commandrunner.deleteLater)
     runner.finished.connect(runner.deleteLater)",That command doesn't seem accurate anymore - `$XDG_DATA_DIRS` is not checked.,py,1,1,1
"@@ -269,6 +269,14 @@ class Stream(param.Parameterized):
         return repr(self)
 
 
+class Next(Stream):
+    """"""
+    Example of an empty stream that can be used to trigger generators or
+    callbacks that take no arguments.
+    """"""
+    pass
+
+
 class Counter(Stream):
     """"""
     Simple stream that automatically increments an integer counter",Not strictly necessary as you could use ``Stream``. Another possible name could be ``Trigger``.,py,1,1,1
"@@ -8,12 +8,13 @@ to multiple files in parallel.
 import random
 import sys
 from mitmproxy import io, http
+import typing  # noqa
 
 
 class Writer:
     def __init__(self, path: str) -> None:
         if path == ""-"":
-            f = sys.stdout  # type: io.TextIO
+            f = sys.stdout  # type: typing.IO[typing.Any]
         else:
             f = open(path, ""wb"")
         self.w = io.FlowWriter(f)","The FlowWriter only writes bytes, so this should really be `typing.IO[bytes]`. If that raises errors, that's a strong indicator that the code here does not work as intended. I'd be fine with removing the `if path == ""-"":` special case altogether.",py,1,1,1
"@@ -103,6 +103,10 @@ class ElementOperation(Operation):
        first component is a Normalization.ranges list and the second
        component is Normalization.keys. """""")
 
+    link_inputs = param.Boolean(default=False, doc=""""""
+         Whether a plot created from the output of this operation
+         should be linked to the inputs of this operation."""""")
+
     streams = param.List(default=[], doc=""""""
         List of streams that are applied if dynamic=True, allowing
         for dynamic interaction with the plot."""""")","Needs a *lot* more explanation as almost none of the required concepts exist at this level: 1. An operation doesn't create plots, it generates a data-structure. 2. Specifically, linking is about streams which relates to DynamicMap so this should say something about when the operation is dynamic. 3. Linked streams only exist for specific backends. As a very rough suggestion, it should be something along the lines of: > 'If the operation is dynamic, this switch specifies whether or not linked streams should be defined from the operation inputs. Only applies when rendering the output with backends that support linked streams. For example ... '",py,1,1,0
"@@ -145,3 +145,14 @@ def init():
     objreg.register('command-history', command_history)
     save_manager.add_saveable('command-history', command_history.save,
                               command_history.changed)
+
+
+def init_fprompt():
+    """"""Initialize the LimitLineParser storing the history.""""""
+    save_manager = objreg.get('save-manager')
+    fprompt_history = lineparser.LimitLineParser(
+        standarddir.data(), 'fprompt-history',
+        limit='completion.fprompt_history_max_items')
+    objreg.register('fprompt-history', fprompt_history)
+    save_manager.add_saveable('fprompt-history', fprompt_history.save,
+                              fprompt_history.changed)",No need to have a separate init function for this.,py,1,0,1
"@@ -0,0 +1,8 @@
+import pydantic
+from typing import List
+
+
+class NewReleasesStat(pydantic.BaseModel):
+    type: str
+    user_name: str
+    data: List",Maybe add a docstring/docs for what will be in the list?,py,1,1,1
"@@ -1095,7 +1095,7 @@ class Resource:
                         send_alert(self.request, message, url)
                     operator = COMPARISON.LT
 
-                if value == """":
+                if value == """" or (not isinstance(value, int) and not isinstance(value, str)):
                     raise_invalid(self.request, **error_details)
 
                 filters.append(Filter(self.model.modified_field, value, operator))",`isinstance()` can take a tuple as a second argument,py,1,1,1
"@@ -19,7 +19,7 @@ from databricks.koalas.testing.utils import ReusedSQLTestCase
 
 
 class ReprTests(ReusedSQLTestCase):
-    max_display_count = 123
+    max_display_count = 23
 
     @classmethod
     def setUpClass(cls):","pandas' `display.max_rows` value is 60 by default. So, lowering then that will test the changes correctly.",py,1,1,1
"@@ -15,12 +15,12 @@
 """"""Scanner for Enabled APIs.""""""
 
 import json
-import sys
 
 from google.cloud.forseti.common.gcp_type.project import Project
 from google.cloud.forseti.common.util import logger
 from google.cloud.forseti.scanner.audit import enabled_apis_rules_engine
 from google.cloud.forseti.scanner.scanners import base_scanner
+from google.cloud.forseti.common.util import errors as util_errors
 
 LOGGER = logger.get_logger(__name__)
 ",Can you please alpha-sort this import?,py,1,0,1
"@@ -212,3 +212,12 @@ class ExtraPropertiesValidationTest(BaseWebTestWithSchema, unittest.TestCase):
         self.app.patch_json(record_url,
                             {'data': record},
                             headers=self.headers)
+
+    def test_additional_properties_are_rejected(self):
+        record_id = '5443d83f-852a-481a-8e9d-5aa804b05b08'
+        record = VALID_RECORD.copy()
+        record['extra'] = 'blah!'
+        self.app.put_json('%s/%s' % (RECORDS_URL, record_id),
+                          {'data': record},
+                          headers=self.headers,
+                          status=400)",I would also validate that the error message give enough feedback for the user to solve the issue.,py,1,1,1
"@@ -133,7 +133,7 @@ def makePgettext(translations):
 				return message
 	else:
 		def pgettext(context, message):
-			return unicode(message)
+			return message
 	return pgettext
 
 def getWindowsLanguage():","Why do we have this else statement? Shouldn't this fail if translations is not an instance of gettext.GNUTranslations? If not, what else do we expect and how should that be handled?",py,1,1,1
"@@ -71,3 +71,14 @@ class Good(object):
 def does_not_crash_on_range_without_args():
     for elem in range():
         print(elem)
+
+# False negative described in #3657
+class MyClass(object):
+    def __init__(self):
+        self.my_list = []
+
+my_obj = MyClass()
+def my_function(instance: MyClass):
+    for i in range(len(instance.my_list)):  # [consider-using-enumerate]
+        var = instance.my_list[i]
+        print(var)",Can you add a link to the Github issue here as well?,py,0,1,1
"@@ -470,8 +470,10 @@ class BacktrackingTM(ConsolePrinterMixin, Serializable):
     proto.lrnIterationIdx = self.lrnIterationIdx
     proto.iterationIdx = self.iterationIdx
     proto.segID = self.segID
-    if self.currentOutput is not None:
-      proto.currentOutput = self.currentOutput.tolist()
+    if self.currentOutput is None:
+      proto.currentOutput.none = None
+    else:
+      proto.currentOutput.list = self.currentOutput.tolist()
     proto.pamCounter = self.pamCounter
     proto.collectSequenceStats = self.collectSequenceStats
     proto.resetCalled = self.resetCalled",I don't understand this. Is it a workaround to allow a proto to contain a null value? I see this pattern in several other places.,py,1,1,1
"@@ -30,6 +30,8 @@ from scapy.modules.six.moves import range, zip
 
 class PacketList(BasePacketList, _CanvasDumpExtended):
     __slots__ = [""stats"", ""res"", ""listname""]
+    read_allowed_exceptions = ()  # emulate SuperSocket
+    nonblocking_socket = True
 
     def __init__(self, res=None, name=""PacketList"", stats=None):
         """"""create a packet list from a list of packets",Could you explain why you are making this a (fake) socket ?,py,1,1,1
"@@ -304,7 +304,7 @@ public class DefaultGridRegistry extends BaseGridRegistry implements GridRegistr
     if (proxy == null) {
       return;
     }
-    LOG.info(""Registered a node "" + proxy);
+    LOG.finest(""Registered a node "" + proxy);
     try {
       lock.lock();
 ",This is wildly unhelpful to users --- they need to know when a proxy has been registered.,py,1,1,1
"@@ -140,6 +140,11 @@ def main():
     inspect_p.add_argument(""package"", type=str, help=HANDLE)
     inspect_p.set_defaults(func=command.inspect)
 
+    rm_p = subparsers.add_parser(""rm"")
+    rm_p.add_argument(""package"", type=str, help=HANDLE)
+    rm_p.add_argument(""-f"", ""--force"", action=""store_true"", help=""Remove without prompting"")
+    rm_p.set_defaults(func=command.rm)
+
     args = parser.parse_args()
 
     # Convert argparse.Namespace into dict and clean it up.","Given a single name, are we sure about ""rm"" vs ""uninstall"" which makes it clear that this is local. Sorry for the late question... quilt rm/del/delete is ambiguous whether it applies server-side, client-side or both... also, if you intend to someday add metadata-delete-only, you might want to spec this out now, so the syntax won't be awkward...",py,1,1,0
"@@ -689,8 +689,15 @@ class YOLACTProtonet(BaseModule):
         prototypes = prototypes.permute(0, 2, 3, 1).contiguous()
 
         num_imgs = x.size(0)
-        # Training state
-        if self.training:
+
+        # The reason for not using self.is_training is that
+        # val workflow will have a dimension mismatch error.
+        # Note that this writing method is very tricky.
+        # Fix https://github.com/open-mmlab/mmdetection/issues/5978
+        is_train_or_val_workflow = (coeff_pred[0].dim() == 4)
+
+        # Train or val workflow
+        if is_train_or_val_workflow:
             coeff_pred_list = []
             for coeff_pred_per_level in coeff_pred:
                 coeff_pred_per_level = \",self.is_training or self.training?,py,1,0,1
"@@ -8,8 +8,8 @@ from enum import Enum
 import re
 
 PUBLIC = 'public' # This username is blocked by Quilt signup
-VALID_NAME_RE = re.compile(r'^[a-zA-Z]\w*$')
-EMAILREGEX = re.compile(r'^([^\s@]+)@([^\s@]+)$')
+VALID_NAME_RE = re.compile(r'^[a-zA-Z]\w*$', re.UNICODE)
+VALID_EMAIL_RE = re.compile(r'^([^\s@]+)@([^\s@]+)$')
 
 class PaymentPlan(Enum):
     FREE = 'free'",This shouldn't change - usernames can't actually have non-ascii characters.,py,1,1,1
"@@ -140,6 +140,10 @@ class DocumentWithTableNavigation(TextContainerObject,ScriptableObject):
 				destCol+=1 if movement==""next"" else -1
 		raise LookupError
 
+	lastTableSelection = None
+	lastTableAxis = None
+	lastTableCoordinate = None
+	lastTableCoordinateSpan = None
 	def _tableMovementScriptHelper(self, movement=""next"", axis=None):
 		if isScriptWaiting():
 			return","Have you considered using four variables here, lastRow, lastRowSpan, lastCol and lastCOlSpan? While it adds two extra variables, I think it makes things a bit easier to follow. Also, please make these private variables, i.e. add add an underscore prefix",py,1,1,1
"@@ -521,7 +521,7 @@ class Package(object):
         return cls._browse(name=name, registry=registry, top_hash=top_hash)
 
     @classmethod
-    def _browse(cls, name, registry, top_hash):
+    def _browse(cls, name, registry=None, top_hash=None):
         validate_package_name(name)
         if registry is None:
             registry = get_from_config('default_local_registry')",Is this change needed for the fix?,py,1,0,1
"@@ -486,6 +486,9 @@ class FirewallRules(object):
           InvalidFirewallRuleError: One or more rules failed validation.
         """"""
         for rule in rules:
+            if not isinstance(rule, dict):
+                raise InvalidFirewallRuleError(
+                    'Invalid rule type. Found %s expected %s', type(rule), dict)
             self.add_rule(rule, network_name=network_name)
 
     def add_rule(self, rule, network_name=None):","I believe the check should be before this for loop, i.e. make sure we are getting a list of rules.",py,1,1,1
"@@ -215,10 +215,15 @@ class WordDocumentTextInfo(UIATextInfo):
 				self.setEndPoint(docInfo,""endToEnd"")
 
 	def getTextWithFields(self,formatConfig=None):
-		if self.isCollapsed:
-			# #7652: We cannot fetch fields on collapsed ranges otherwise we end up with repeating controlFields in braille (such as list list list). 
-			return []
-		fields=super(WordDocumentTextInfo,self).getTextWithFields(formatConfig=formatConfig)
+		fields = None
+		if not self.isCollapsed:
+			rawText = self._rangeObj.GetText(2)
+			if not rawText or rawText == '\x07':
+				r = self.copy()
+				r.end = r.start
+				fields = super(WordDocumentTextInfo, r).getTextWithFields(formatConfig=formatConfig)
+		if fields is None:
+			fields = super(WordDocumentTextInfo, self).getTextWithFields(formatConfig=formatConfig)
 		if len(fields)==0: 
 			# Nothing to do... was probably a collapsed range.
 			return fields",What does `'\x07'` represent in this instance? Could it be replaced by a named constant?,py,1,1,1
"@@ -33,8 +33,8 @@ from nupic.encoders import MultiEncoder
 
 _VERBOSITY = 0  # how chatty the demo should be
 _SEED = 1956  # the random seed used throughout
-_DATA_PATH = ""extra/hotgym/rec-center-hourly.csv""
-_OUTPUT_PATH = ""test_output.csv""
+_DATA_PATH = ""../prediction/data/extra/hotgym/rec-center-hourly.csv""
+_OUTPUT_PATH = ""network-demo-output.csv""
 _NUM_RECORDS = 2000
 
 # Config field for SPRegion","You should not have to do this. Please undo this change. If it doesn't work, you may need to set `NTA_DATA_PATH` but it should default correctly.",py,1,1,1
"@@ -24,7 +24,7 @@
 Some unit tests for the AutoscaleConnection
 """"""
 
-import unittest
+from __future__ import print_function
 import time
 from boto.ec2.autoscale import AutoScaleConnection
 from boto.ec2.autoscale.activity import Activity","`print_function` is not required for `print('some string')` to work since we support Python 2.6+, it is only required for more complex invocations of the print function (like passing keyword args). You can remove this import.",py,1,1,1
"@@ -21,8 +21,11 @@ def main(argv):
         .filter(Instance.keywords_tsv.is_(None))
     )
 
-    for instance, owner, name in rows:
+    for idx, (instance, owner, name) in enumerate(rows):
+        print(""%s/%s/%s"" % (owner, name, instance.hash))
         instance.keywords_tsv = keywords_tsvector(owner, name, instance.contents)
+        if (idx + 1) % 100 == 0:
+            db.session.commit()
 
     db.session.commit()
     print(""Done!"")",extremely minor: if you use `%s/%s:%s` it will be consistent with install syntax. i guess we won't need to install from the logs.,py,1,1,1
"@@ -2,6 +2,12 @@ import urllib
 import netlib.http
 from textwrap import dedent
 
+import sys, re
+if (sys.version_info > (3, 0)):
+    from urllib.parse import urlparse
+else:
+    import urlparse
+
 
 def curl_command(flow):
     data = ""curl """,@mhils started using `six` for py2/3 compatible imports in recent commits to master. Maybe you could try to adopt it here as well?,py,0,1,1
"@@ -73,6 +73,17 @@ def init():
     download_manager.install(webenginesettings.private_profile)
     objreg.register('webengine-download-manager', download_manager)
 
+    # Clear visited links on web history clear
+    hist = objreg.get('web-history')
+    hist.history_cleared.connect(
+        webenginesettings.default_profile.clearAllVisitedLinks)
+    hist.history_cleared.connect(
+        webenginesettings.private_profile.clearAllVisitedLinks)
+    hist.url_cleared.connect(
+        lambda url: webenginesettings.default_profile.clearVisitedLinks([url]))
+    hist.url_cleared.connect(
+        lambda url: webenginesettings.private_profile.clearVisitedLinks([url]))
+
 
 # Mapping worlds from usertypes.JsWorld to QWebEngineScript world IDs.
 _JS_WORLD_MAP = {","No strong feelings on this one, but might be worth making it a for-loop maybe? (`for profile in [webenginesettings.default_profile, webenginesettings.private_profile]: ...`)",py,1,1,1
"@@ -62,9 +62,9 @@ class SDRCategoryEncoder(Encoder):
     # enable certain experiments.
     #
     # ""5"" is arbitrary -- this is just to catch bad parameter choices
-    #if self.w >= self.n - 4:
-    #  raise RuntimeError(""Number of bits in SDR (%d) must be much smaller than ""
-    #                     ""the output width (%d)"" % (self.w, self.n))
+    if (self.n/self.w) < 2: # w is 50% of total len
+      raise RuntimeError(""Number of ON bits in SDR (%d) must be much smaller than ""
+                         ""the output width (%d)"" % (self.w, self.n))
 
     # Another arbitrary cutoff to catch likely mistakes
     if self.w < 3:",This check is probably a little more reasonable for category encoders.,py,1,1,1
"@@ -185,6 +185,16 @@ def filter_rules_by_network(rules, network):
     return filtered_rules
 
 
+def _rule_update_can_patch(rule_from, rule_to):
+    if not rule_to or not rule_from:
+        raise ValueError('from and to must both exist for checking replace vs patch.')
+    if 'allowed' in rule_from and 'denied' in rule_to:
+        return False # Patch fails to update allowed -> denied
+    if 'denied' in rule_from and 'allowed' in rule_to:
+        return False # Patch fails to update denied -> allowed
+    return True
+
+
 class FirewallRules(object):
     """"""A collection of validated firewall rules.""""""
 ",It would be nice to see unit tests for this.,py,0,1,1
"@@ -22,6 +22,7 @@ from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
 
 
 class Options(object):
+    KEY = ""goog:chromeOptions""
 
     def __init__(self):
         self._binary_location = ''",nice touch since Google likes to change things every now and then.,py,1,0,0
"@@ -389,11 +389,13 @@ class Configuration(object):
         configVar = os.environ['NTA_CONF_DIR']
         # Return as a list of paths
         configPaths = configVar.split(':')
-      elif os.path.exists(os.path.join(
-          nupic.rootDir, 'conf', 'site', 'default')):
-        configPaths = [os.path.join(nupic.rootDir, 'conf', 'site', 'default')]
-      else:
+      elif (
+          not os.path.exists(os.path.join(
+              nupic.rootDir, 'conf', 'site', 'default')) and
+          os.path.exists(os.path.join(nupic.rootDir, 'conf', 'default'))):
         configPaths = [os.path.join(nupic.rootDir, 'conf', 'default')]
+      else:
+        configPaths = [os.path.join(nupic.rootDir, 'conf', 'site', 'default')]
         
       return configPaths
 ","@scottpurdy : os.path.join(nupic.rootDir, 'conf', 'site', 'default') was the intended location of the site-specific defaults. Why are we allowing for non-determinism in this new logic? The tests used to work fine with the intended location.",py,0,1,1
"@@ -73,12 +73,12 @@ class MPLRendererTest(ComparisonTestCase):
     def test_get_size_row_plot(self):
         plot = self.renderer.get_plot(self.image1+self.image2)
         w, h = self.renderer.get_size(plot)
-        self.assertEqual((w, h), (576, 258))
+        self.assertEqual((w, h), (576, 255))
 
     def test_get_size_column_plot(self):
         plot = self.renderer.get_plot((self.image1+self.image2).cols(1))
         w, h = self.renderer.get_size(plot)
-        self.assertEqual((w, h), (288, 510))
+        self.assertEqual((w, h), (288, 505))
 
     def test_get_size_grid_plot(self):
         grid = GridSpace({(i, j): self.image1 for i in range(3) for j in range(3)})",At least the changes here are small...,py,0,0,1
"@@ -132,6 +132,13 @@ def restart(disableAddons=False, debugLogging=False):
 		sys.argv.remove(""--ease-of-access"")
 	except ValueError:
 		pass
+	if globalVars.appArgs.cmdLineLanguage:
+		import config
+		# We should better compare here with the saved value if not saveOnExit.
+		if config.conf[""general""][""language""] != globalVars.appArgs.cmdLineLanguage:
+			for i, arg in list(enumerate(sys.argv)):
+				if arg.startswith(""--lang=""):
+					del sys.argv[i]
 	shellapi.ShellExecute(None, None,
 		sys.executable,
 		subprocess.list2cmdline(sys.argv + options),","I think cmdLanguage can just be language. globalVars.appArgs already implies that we're dealing with a command line argument here. Having said that, I note that some magic is happening with the configPath, but that could be considered confusing.",py,1,1,1
"@@ -359,7 +359,17 @@ class Interface(param.Parameterized):
         else:
             return data.dtype
 
-
+    @classmethod
+    def replace_value(cls, data, nodata):
+        """"""
+        Replace `nodata` value in data with NaN
+        """"""
+        data = data.astype('float64')
+        mask = data != nodata
+        if hasattr(data, 'where'):
+            return data.where(mask, np.NaN)
+        return np.where(mask, data, np.NaN)
+        
     @classmethod
     def select_mask(cls, dataset, selection):
         """"""",I guess this duplicates `apply_nodata._replace_value` in `plotting.util` a bit but that is probably ok...,py,1,1,1
"@@ -755,11 +755,12 @@ class Storage(StorageBase, MigratorMixin):
                 # However, it does support Postgres arrays of any
                 # type. Assume that the referenced field is a JSON
                 # array and convert it to a Postgres array.
-                # N.B. This won't work on JSON objects and will never match.
                 data_as_array = '''
                 (SELECT array_agg(elems) FROM jsonb_array_elements({}) elems)
-                '''.format(sql_field)
+                '''.format(sql_field, sql_field)
                 cond = '{} && (:{})::jsonb[]'.format(data_as_array, value_holder)
+                # In case the field is not a sequence, we ignore the record.
+                conditions.append(""jsonb_typeof({}) = 'array'"".format(sql_field))
 
             elif value != MISSING:
                 # Safely escape value. MISSINGs get handled below.",nit: nicer with `{field}` in the string and `.format(field=sql_field)`,py,1,1,1
"@@ -126,11 +126,14 @@ class ClassBalancedDataset(object):
             no oversampling. For categories with ``f_c < oversample_thr``, the
             degree of oversampling following the square-root inverse frequency
             heuristic above.
+        include_bkg (bool): Whether to include pure background images as an
+            independent category during autobalancing. Default: False.
     """"""
 
-    def __init__(self, dataset, oversample_thr):
+    def __init__(self, dataset, oversample_thr, include_bkg=False):
         self.dataset = dataset
         self.oversample_thr = oversample_thr
+        self.include_bkg = include_bkg
         self.CLASSES = dataset.CLASSES
 
         repeat_factors = self._get_repeat_factors(dataset, oversample_thr)",How about `include_empty` or just `include_background`? `bkg` is a little bit hard to guess.,py,1,1,1
"@@ -181,7 +181,9 @@ class DataFrameConversionTest(ReusedSQLTestCase, SQLTestUtils, TestUtils):
         self.assert_eq(kdf.to_latex(sparsify=False), pdf.to_latex(sparsify=False))
         self.assert_eq(kdf.to_latex(index_names=False), pdf.to_latex(index_names=False))
         self.assert_eq(kdf.to_latex(bold_rows=True), pdf.to_latex(bold_rows=True))
-        self.assert_eq(kdf.to_latex(encoding='ascii'), pdf.to_latex(encoding='ascii'))
+        # TODO: error in pandas >= 1.0.0:
+        # `ValueError: buf is not a file name and encoding is specified.`
+        # self.assert_eq(kdf.to_latex(encoding='ascii'), pdf.to_latex(encoding='ascii'))
         self.assert_eq(kdf.to_latex(decimal=','), pdf.to_latex(decimal=','))
 
     def test_to_records(self):",Can we fix this case to match with pandas 1.0.0?,py,1,0,1
"@@ -47,9 +47,10 @@ class RemoteScheduler(Scheduler):
     Scheduler proxy object. Talks to a RemoteSchedulerResponder.
     """"""
 
-    def __init__(self, host='localhost', port=8082, connect_timeout=None):
+    def __init__(self, host='localhost', port=8082, url_prefix='', connect_timeout=None):
         self._host = host
         self._port = port
+        self._url_prefix = url_prefix
 
         config = configuration.get_config()
 ",Can you put the `url_prefix argument` after `connect_timeout` to be backward compatible.,py,1,1,1
"@@ -1,8 +1,13 @@
 from random import random
 
+<<<<<<< HEAD
+=======
+from bzt.utils import to_json
 from tests import BZTestCase, r
 
+>>>>>>> cba72f5388bd3647b636c773e6893428e37da306
 from bzt.modules.aggregator import ConsolidatingAggregator, DataPoint, KPISet, AggregatorListener
+from tests import BZTestCase, r
 from tests.mocks import MockReader
 
 ","This is unintentional, obviously",py,1,0,1
"@@ -24,6 +24,9 @@ import cPickle as pickle
 import numpy
 import unittest2 as unittest
 
+from nupic.support.unittesthelpers.alogrithm_test_helpers \
+     import getNumpyRandomGenerator
+
 from nupic.bindings.algorithms import FlatSpatialPooler as CPPFlatSpatialPooler
 from nupic.bindings.math import GetNTAReal, Random
 from nupic.research.flat_spatial_pooler import (",Nit: PEP 8 says to prefer using parentheses for implicit line continuations rather than backslashes. Up to you.,py,1,1,1
"@@ -99,7 +99,7 @@ test_cfg = dict(
 )
 # dataset settings
 dataset_type = 'CocoDataset'
-data_root = 'data/coco/'
+data_root = '/data1/home/zhez/data_local/coco/'
 img_norm_cfg = dict(
     mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
 data = dict(",This change is unnecessary.,py,1,0,1
"@@ -128,13 +128,14 @@ class GroupNode(Node):
         store = None
         hash_list = []
         stack = [self]
+        alldfs = True
         while stack:
             node = stack.pop()
             if isinstance(node, GroupNode):
                 stack.extend(child for _, child in sorted(node._items(), reverse=True))
             else:
                 if not isinstance(node._node, core.TableNode):
-                    raise ValueError(""Group contains non-dataframe nodes"")
+                    alldfs = False
                 if not node._node.hashes:
                     msg = ""Can only merge built dataframes. Build this package and try again.""
                     raise NotImplementedError(msg)","You probably need to check for `node._node is None` now, too (same as in the previous PR)",py,0,1,1
"@@ -126,7 +126,9 @@ def _get_instance():
         with DagsterInstance.get() as instance:
             yield instance
     else:
-        with tempfile.TemporaryDirectory() as tempdir:
+        # make the temp dir in the cwd since default temp dir roots
+        # have issues with FS notif based event log watching
+        with tempfile.TemporaryDirectory(dir=os.getcwd()) as tempdir:
             click.echo(
                 f""Using temporary directory {tempdir} for storage. This will be removed when dagit exits.\n""
                 ""To persist information across sessions, set the environment variable DAGSTER_HOME to a directory to use.\n""",does this have any cleanup issues if dagit crashes or something?,py,1,1,1
"@@ -21,4 +21,6 @@
 
 from nupic.frameworks.viz.graphviz_renderer import GraphVizRenderer
 from nupic.frameworks.viz.networkx_renderer import NetworkXRenderer
+from nupic.frameworks.viz.dot_renderer import DotRenderer
 from nupic.frameworks.viz.network_visualization import NetworkVisualizer
+",put import in alpha order,py,1,1,1
"@@ -68,6 +68,7 @@ class NamespaceTest(ReusedSQLTestCase, SQLTestUtils):
 
     def test_concat_index_axis(self):
         pdf = pd.DataFrame({""A"": [0, 2, 4], ""B"": [1, 3, 5], ""C"": [6, 7, 8]})
+        # TODO: pdf.columns.names = [""ABC""]
         kdf = ks.from_pandas(pdf)
 
         ignore_indexes = [True, False]",Let me address this later.,py,0,0,1
"@@ -64,6 +64,8 @@ def test_start(proc, qtbot, message_mock, py_proc):
     assert not message_mock.messages
     assert qutescheme.spawn_output == expected
     assert proc.exit_status() == QProcess.NormalExit
+    assert proc.final_stdout().strip() == ""test"", proc.final_stdout()
+    assert proc.final_stderr().strip() == """", proc.final_stderr()
 
 
 def test_start_verbose(proc, qtbot, message_mock, py_proc):",Maybe those would fit better in `test_start_output_message` which also tests various combinations of stdout/stderr being set or unset?,py,1,1,1
"@@ -87,6 +87,6 @@ class ForsetiClientInstaller(ForsetiInstaller):
             'FORSETI_BUCKET': bucket_name[len('gs://'):],
             'BUCKET_LOCATION': self.config.bucket_location,
             'GCP_CLIENT_SERVICE_ACCOUNT': self.gcp_service_acct_email,
-            'BRANCH_OR_RELEASE': 'branch-name: ""{}""'.format(self.branch),
+            'FORSETI_TARGET': 'forseti-target: ""{}""'.format(self.branch),
             'FORSETI_SERVER_ZONE': self.server_zone
         }","Now that I see this here, is there any reason why `forseti-target` attribute is defined here, rather in the yaml.in files?",py,1,1,1
"@@ -380,7 +380,7 @@ public class Actions {
 
     // Of course, this is the offset from the centre of the element. We have no idea what the width
     // and height are once we execute this method.
-    LOG.info(""When using the W3C Action commands, offsets are from the center of element"");
+    LOG.finest(""When using the W3C Action commands, offsets are from the center of element"");
     return moveInTicks(target, xOffset, yOffset);
   }
 ","Again, the existing level is correct --- we're letting users know about something that might cause there tests to fail.",py,1,1,1
"@@ -1139,18 +1139,7 @@ class GlobalCommands(ScriptableObject):
 			try:
 				c = ord(info.text)
 			except TypeError:
-				# This might be a character taking multiple code points.
-				# If it is a 32 bit character, encode it to UTF-32 and calculate the ord manually.
-				# In Python 3, this is no longer necessary.
-				try:
-					encoded = info.text.encode(""utf_32_le"")
-				except UnicodeEncodeError:
-					c = None
-				else:
-					if len(encoded)==4:
-						c = sum(ord(cp)<<i*8 for i, cp in enumerate(encoded))
-					else:
-						c = None
+				c = None
 			if c is not None:
 				speech.speakMessage(""%d,"" % c)
 				speech.speakSpelling(hex(c))","In python 3, a character in a string is always one code point. Therefore this code is now obsolete.",py,1,1,1
"@@ -112,7 +112,7 @@ class AbstractServiceConfig(object):
         raise NotImplementedError()
 
 
-class AbstractInventoryConfig(dict):
+class AbstractInventoryConfig(object):
     """"""Abstract base class for service configuration. This class
     is used to implement dependency injection for the gRPC services.""""""
 ",Will this break other part of the code? if it's not a dictionary you can no longer access using the .get(key) method.,py,1,1,1
"@@ -23,12 +23,6 @@ Usage:
       --rules <rules path> \\
       --engine_name <rule engine name> \\
       --output_path <output path (optional)> \\
-      --db_host <Cloud SQL database hostname/IP> \\
-      --db_user <Cloud SQL database user> \\
-      --db_name <Cloud SQL database name (required)> \\
-      --sendgrid_api_key <API key to auth SendGrid email service> \\
-      --email_sender <email address of the email sender> \\
-      --email_recipient <email address of the email recipient>
 """"""
 
 ",Do we need to list the config arg here?,py,1,1,1
"@@ -25,6 +25,7 @@ from qutebrowser.config import config, configdata
 from qutebrowser.models import basecompletion
 from qutebrowser.utils import log, qtutils, objreg
 from qutebrowser.commands import cmdutils
+from qutebrowser.browser import quickmarks
 
 
 class SettingSectionCompletionModel(basecompletion.BaseCompletionModel):",You can remove this import now after 74839d7affdaabd4899311c64e9f50a430a6ea3d,py,0,1,1
"@@ -249,9 +249,9 @@ class JUnitTester(JavaTestRunner, HavingInstallableTools):
                 props.write(""target_%s=%s\n"" % (index, item.replace(os.path.sep, '/')))
 
         class_path = os.pathsep.join(self.base_class_path)
-        junit_command_line = [""java"", ""-cp"", class_path, ""taurusjunit.CustomRunner"", self.props_file]
+        junit_cmd_line = [""java"", ""-cp"", class_path, ""-Djna.nosys=true"", ""taurusjunit.CustomRunner"", self.props_file]
 
-        self._start_subprocess(junit_command_line)
+        self._start_subprocess(junit_cmd_line)
 
 
 class TestNGTester(JavaTestRunner, HavingInstallableTools):","If it's for Windows only, maybe add it conditionally?",py,1,1,1
"@@ -0,0 +1,19 @@
+# -*- coding: UTF-8 -*-
+#A part of NonVisual Desktop Access (NVDA)
+#Copyright (C) 2016 NV Access Limited
+#This file is covered by the GNU General Public License.
+#See the file COPYING for more details.
+
+""""""
+Contains upgrade steps for the NVDA configuration files. These steps are run to ensure that a configuration file
+complies with the latest schema (@see configSpec.py).
+
+To add a new step (after modifying the schema and incrementing the schema version number) add a new method to this
+module. The method name should be in the form ""upgradeConfigFrom_X_to_Y"" where X is the previous schema version, and Y
+is the current schema version. The argument profile will be a configobj.ConfigObj object. The function should ensure 
+that no information is lost, while updating the ConfigObj to meet the requirements of the new schema.
+""""""
+
+from logHandler import log
+
+# add upgrade steps here.",Please provide a docstring here which explains what this module is and how to add steps.,py,1,1,1
"@@ -346,6 +346,8 @@ def tree_attribute(identifier):
     These custom attributes start with a capitalized character when
     applicable (not applicable to underscore or certain unicode characters)
     """"""
+    if not identifier:
+        return True
     if identifier[0].upper().isupper() is False and identifier[0] != '_':
         return True
     else:","This would match anything that is falsey even though it should only ever match the empty string. I would prefer to be explicit, i.e.: `if identifier=='':`",py,1,1,1
"@@ -262,15 +262,13 @@ class DynamicOutput(
         )
 
 
-MetadataValues = Union[str, float, int, Dict, EventMetadataEntry]
-
-
 @whitelist_for_serdes
 class AssetObservation(
     NamedTuple(
         ""_AssetObservation"",
         [
             (""asset_key"", AssetKey),
+            (""description"", Optional[str]),
             (""metadata_entries"", List[EventMetadataEntry]),
             (""partition"", Optional[str]),
         ],",maybe these core changes should be part of a separate diff than the frontend/graphql changes?,py,1,1,1
"@@ -452,6 +452,10 @@ class Series(Frame, IndexOpsMixin, Generic[T]):
     def add(self, other) -> ""Series"":
         return self + other
 
+    def __add__(self, other):
+        other = ks.Index(other, name=self.name) if isinstance(other, (list, tuple)) else other
+        return IndexOpsMixin.__add__(self, other)
+
     add.__doc__ = _flex_doc_SERIES.format(
         desc=""Addition"",
         op_name=""+"",",- Why do we create Index to compare instead of Series? - Looks like Index support this too. Can't we move this into `base.py`?,py,1,1,1
"@@ -12,7 +12,7 @@ from .package import Package, PackageException
 from .util import BASE_DIR
 
 # start with alpha (_ may clobber attrs), continue with alphanumeric or _
-VALID_NAME_RE = re.compile(r'^[a-zA-Z]\w*$')
+VALID_NAME_RE = re.compile(r'^[a-zA-Z]\w*(:[a-zA-Z]\w*)?$')
 CHUNK_SIZE = 4096
 
 # Helper function to return the default package store path","Technically the prefix is the optional part, not the suffix. Just a nitpick",py,1,1,1
"@@ -180,8 +180,12 @@ class MetastoreClient(HiveClient):
     def table_location(self, table, database='default', partition=None):
         with HiveThriftContext() as client:
             if partition is not None:
-                partition_str = self.partition_spec(partition)
-                thrift_table = client.get_partition_by_name(database, table, partition_str)
+                try:
+                    import hive_metastore.ttypes
+                    partition_str = self.partition_spec(partition)
+                    thrift_table = client.get_partition_by_name(database, table, partition_str)
+                except hive_metastore.ttypes.NoSuchObjectException as e:
+                    return ''
             else:
                 thrift_table = client.get_table(database, table)
             return thrift_table.sd.location",can you fix this flake8 issue? `./luigi/contrib/hive.py:187:71: F841 local variable 'e' is assigned to but never used` (btw you can run `tox -e flake8` locally to test),py,0,1,1
"@@ -178,6 +178,7 @@ confspec = ConfigObj(StringIO(
 	reportPage = boolean(default=true)
 	reportLineNumber = boolean(default=False)
 	reportLineIndentation = boolean(default=False)
+	reportToneIndentation = boolean(default=False)
 	reportParagraphIndentation = boolean(default=False)
 	reportTables = boolean(default=true)
 	includeLayoutTables = boolean(default=False)","I think we should rename this to `reportLineIndentationWithTones` or `lineIndentationTones`, since it isn't clear that this is related to line indentation (as opposed to paragraph indentation).",py,1,1,1
"@@ -34,6 +34,7 @@ class BasicAuthAuthenticationPolicy(base_auth.BasicAuthAuthenticationPolicy):
                 return
 
             hmac_secret = settings[""userid_hmac_secret""]
+            # Unsure how to use fstring with *args
             credentials = ""{}:{}"".format(*credentials)
             userid = utils.hmac_digest(hmac_secret, credentials)
             return userid","I would say that `f""{credentials[0]}:{credentials[1]""` is fine. Or leave the format() call",py,1,1,1
"@@ -6,6 +6,8 @@ from kinto.core.schema import (Any, HeaderField, QueryField, HeaderQuotedInteger
                                FieldList, TimeStamp, URL)
 from kinto.core.utils import native_value
 
+POSTGRESQL_MAX_INTEGER_VALUE = 9223372036854775807
+
 
 class TimeStamp(TimeStamp):
     """"""This schema is deprecated, you shoud use `kinto.core.schema.TimeStamp` instead.""""""",`2**64 / 2`,py,0,0,0
"@@ -169,6 +169,9 @@ class MainWindow(QWidget):
         objreg.register('message-bridge', message_bridge, scope='window',
                         window=self.win_id)
 
+        if config.val.window.hide_decoration:
+            window_flags = Qt.CustomizeWindowHint | Qt.NoDropShadowWindowHint
+            self.setWindowFlags(Qt.Window | window_flags)
         self.setWindowTitle('qutebrowser')
         self._vbox = QVBoxLayout(self)
         self._vbox.setContentsMargins(0, 0, 0, 0)",This should be handled in `_on_config_changed` too if possible so it can be set without requiring a restart. Not sure if it's possible to just change the flags after the window has been shown though - but maybe a `self.hide()` and `self.show()` helps.,py,1,1,1
"@@ -595,9 +595,9 @@ class Params(Stream):
         if parameters is None:
             parameters = [p for p in parameterized.params() if p != 'name']
         super(Params, self).__init__(parameterized=parameterized, parameters=parameters, **params)
+        self._memoize = True
         if watch:
-            for p in self.parameters:
-                self.parameterized.param.watch(self._listener, p)
+            self.parameterized.param.watch(self._listener, self.parameters)
 
     def _validate_rename(self, mapping):
         for k, v in mapping.items():","Little bit confused as the the `watch` argument: it doesn't seem to be state (either an attribute or a parameter) but is set through the constructor. Are there cases where you expect users to set `watch=False` even if watch could be supported by the param version? If not, I would remove this argument so that the param version check is sufficient to know whether watch is being used or not (something you need to determine in `Dynamic` later...)",py,1,1,0
"@@ -46,11 +46,7 @@ class TestEndpointLoading(unittest.TestCase):
 
     def test_load_endpoint_json(self):
         endpoints = load_endpoint_json(boto.ENDPOINTS_PATH)
-        self.assertTrue('ec2' in endpoints)
-        self.assertEqual(
-            endpoints['ec2']['us-east-1'],
-            'ec2.us-east-1.amazonaws.com'
-        )
+        self.assertTrue('partitions' in endpoints)
 
     def test_merge_endpoints(self):
         defaults = {",Would this be a breaking change to have partitions as the top layered key?,py,1,1,1
"@@ -246,7 +246,10 @@ def _parse_keystring(keystr):
                 yield '>'
                 assert not key, key
         elif c == '<':
-            special = True
+            if special:
+                key += c
+            else:
+                special = True
         elif special:
             key += c
         else:","This seems to somewhat fix `<alt-less>` (I need to bind `<alt-shift-less>` to get this to work, I wonder why that needs `shift` but a plain `<` dosen't), but it dosen't fix `<alt-greater>` so it's not a full fix. I'm also not sure if this will change any error messages. I don't really like this whole parsing logic, it needs a proper grammar instead of consuming keys like this (in my opinion). We could special-case `> ` right after `+` or `-`, but that feels really hacky to me.",py,1,1,0
"@@ -173,7 +173,7 @@ public class DefaultConditionRunner implements ConditionRunner {
     }
 
     protected void log(String message) {
-      logger.info(new Date() + "" - "" + message);
+      logger.finest(new Date() + "" - "" + message);
     }
 
   }",This method is designed to allow the condition runner to tell users something interesting. The current `INFO` log level is correct.,py,1,1,1
"@@ -356,6 +356,12 @@ MSGS = {
         ""Emitted when a dict key is not hashable ""
         ""(i.e. doesn't define __hash__ method)."",
     ),
+    ""E1141"": (
+        ""Dict is not iterable"",
+        ""dict-iter-missing-items"",
+        ""Emitted when trying to iterate through""
+        ""a dict without calling .items()"",
+    ),
     ""W1113"": (
         ""Keyword argument before variable positional arguments list ""
         ""in the definition of %s function"",","Let's add a bit more context here, since the dictionary is actually iterable, but it's going to raise an error if we don't call `items()` on it. So maybe something along the lines of `Unpacking a dictionary in iteration without calling .items()`?",py,1,1,1
"@@ -72,7 +72,11 @@ class Anomaly(object):
   _supportedModes = (MODE_PURE, MODE_LIKELIHOOD, MODE_WEIGHTED)
 
 
-  def __init__(self, slidingWindowSize=None, mode=MODE_PURE, binaryAnomalyThreshold=None):
+  def __init__(self, 
+               slidingWindowSize=None,
+               mode=MODE_PURE,
+               binaryAnomalyThreshold=None,
+               claBurnInPeriod=300):
     """"""
     @param slidingWindowSize (optional) - how many elements are summed up;
         enables moving average on final anomaly score; int >= 0",So I can specify `claBurnInPeriod=0` and get the previous behavior?,py,1,1,1
"@@ -180,6 +180,7 @@ class BaseKeyParser(QObject):
 
         count, cmd_input = self._split_count()
 
+        print(count, cmd_input)
         if not cmd_input:
             # Only a count, no command yet, but we handled it
             return self.Match.other","That should probably be removed now, or replaced by a debug log command :wink:",py,1,1,1
"@@ -363,6 +363,8 @@ class ConfigManager(QObject):
             _get_value_transformer({'false': 'none', 'true': 'debug'}),
         ('ui', 'keyhint-blacklist'):
             _get_value_transformer({'false': '*', 'true': ''}),
+        ('hints', 'auto-follow'):
+            _get_value_transformer({'false': 'never', 'true': 'unique-match'}),
     }
 
     changed = pyqtSignal(str, str)","I think `full-match` would be closer to the current `true` behaviour, right? On the other hand, probably `unique-match` makes more sense as the new default.",py,1,1,1
"@@ -932,6 +932,9 @@ class UserResource:
                 'description': 'Invalid value for {}'.format(param)
             }
 
+            if value == '':
+                raise_invalid(self.request, **error_details)
+
             # Ignore specific fields
             if param.startswith('_') and param not in ('_since',
                                                        '_to',",I guess this test is not only for `_since` and for other fields it might be useful to be able to search for an empty value.,py,1,1,1
"@@ -47,6 +47,7 @@ VIOLATION_RESOURCES = {
     'LOCATION_VIOLATION': 'location_violations',
     'LOG_SINK_VIOLATION': 'log_sink_violations',
     'RETENTION_VIOLATION': 'retention_violations',
+    'ROLE_VIOLATION': 'custom_role_violations',
     'SERVICE_ACCOUNT_KEY_VIOLATION': (
         'service_account_key_violations'),
     'EXTERNAL_PROJECT_ACCESS_VIOLATION': 'external_project_access_violations'","Change this to either `'CUSTOM_ROLE_VIOLATION': 'custom_role_violations',` or `'ROLE_VIOLATION': 'role_violations',` So that is matches the pattern of other violations.",py,1,1,1
"@@ -94,13 +94,15 @@ def get_window(via_ipc, force_window=False, force_tab=False,
     return window.win_id
 
 
-def raise_window(window):
+def raise_window(window, alert=False):
     """"""Raise the given MainWindow object.""""""
     window.setWindowState(window.windowState() & ~Qt.WindowMinimized)
     window.setWindowState(window.windowState() | Qt.WindowActive)
     window.raise_()
     window.activateWindow()
-    QApplication.instance().alert(window)
+
+    if alert:
+        QApplication.instance().alert(window)
 
 
 # WORKAROUND for https://github.com/PyCQA/pylint/issues/1770","I think you meant to say `alert=True` here, to make all existing usages keep the old behavior",py,1,1,1
"@@ -7,6 +7,8 @@ from mitmproxy.net import tcp
 # We redefine these here for now to avoid importing Urwid-related guff on
 # platforms that don't support it, and circular imports. We can do better using
 # a lazy checker down the track.
+from mitmproxy.optmanager import Path
+
 console_palettes = [
     ""lowlight"",
     ""lowdark"",","We already import `optmanager`, so let's just use `optmanager.Path` below.",py,1,1,1
"@@ -239,12 +239,15 @@ class FSAFHead(RetinaHead):
             labels_list,
             list(range(len(losses_cls))),
             min_levels=argmin)
-        # Clamp num_pos to 1e-3 to prevent 0/0
-        num_pos = torch.cat(pos_inds, 0).sum().float().clamp(min=1e-3)
+        num_pos = torch.cat(pos_inds, 0).sum().float()
         acc = self.calculate_accuracy(cls_scores, labels_list, pos_inds)
         for i in range(len(losses_cls)):
-            losses_cls[i] /= num_pos
-            losses_bbox[i] /= num_pos
+            if num_pos == 0:
+                avg_factor = num_pos + float(num_total_neg)
+            else:
+                avg_factor = num_pos
+            losses_cls[i] /= avg_factor
+            losses_bbox[i] /= avg_factor
         return dict(
             loss_cls=losses_cls,
             loss_bbox=losses_bbox,",The computation of `avg_factor` can be moved out of the for-loop.,py,1,1,1
"@@ -67,11 +67,11 @@ public abstract class AbstractWebDriverEventListener implements WebDriverEventLi
     // Do nothing.
   }
 
-  public void beforeChangeValueOf(WebElement element, WebDriver driver) {
+  public void beforeChangeValueOf(WebElement element, WebDriver driver, CharSequence[] value) {
     // Do nothing.
   }
 
-  public void afterChangeValueOf(WebElement element, WebDriver driver) {
+  public void afterChangeValueOf(WebElement element, WebDriver driver, CharSequence[] value) {
     // Do nothing.
   }
 ","change 'value' to keysToSend, here and in other references in this commit. 'value' implies the user is getting the value of the element, rather than just the keys we're sending to it.",py,1,1,1
"@@ -16,7 +16,10 @@ import param
 from .dimension import Dimension, Dimensioned, ViewableElement
 from .ndmapping import OrderedDict, NdMapping, UniformNdMapping
 from .tree import AttrTree
-from .util import (unique_array, get_path, make_path_unique, int_to_roman)
+from .util import (
+    unique_array, get_path, make_path_unique, int_to_roman,
+    unique_iterator
+)
 from . import traversal
 
 ",At this point isn't it better to use ``util`` as a qualified namespace?,py,1,1,1
"@@ -195,15 +195,12 @@ class SecurityCenterClient(object):
         response = self.repository.findings.list(parent=source_id)
         return response
 
-    def update_finding(self, finding, finding_id, state, event_time,
-                       source_id=None):
+    # pylint: disable=inconsistent-return-statements
+    def update_finding(self, finding, finding_id, source_id=None):
         """"""Updates a finding in CSCC.
 
         Args:
             finding (dict): Forseti violation in CSCC format.
-            name (str): Name of the CSCC finding.
-            state (str): State of the CSCC finding.
-            event_time (str): Event time of the the CSCC finding.
             source_id (str): Unique ID assigned by CSCC, to the organization
                 that the violations are originating from.
             finding_id (str): id hash of the CSCC finding.",You should have the return statement on line 213 return an empty dict and not override the pylint.,py,1,1,1
"@@ -61,6 +61,13 @@ class PermissionsUnauthenticatedViewTest(BaseWebTest, unittest.TestCase):
             'resource_name': 'bucket',
             'uri': '/buckets'})
 
+    def test_can_paginate(self):
+        """"""kinto_http.js uses this sort of request when listing permissions""""""
+        resp = self.app.get('/permissions?_sort=id&_limit=1', headers=self.everyone_headers)
+        while 'Next-Page' in resp.headers:
+            next_url = resp.headers['Next-Page'][len('http://localhost/v1'):]
+            resp = self.app.get(next_url, headers=self.everyone_headers)
+
     def test_object_details_are_provided(self):
         resp = self.app.get('/permissions', headers=self.everyone_headers)
         entries = resp.json['data']","Ideally, I'd like the `/buckets` perm to come out first, could you please check that? (I never know whether `None` comes first or not)",py,1,1,1
"@@ -195,7 +195,10 @@ def main():
         if args.eval:
             eval_kwargs = cfg.get('evaluation', {}).copy()
             # hard-code way to remove EvalHook args
-            for key in ['interval', 'tmpdir', 'start', 'gpu_collect']:
+            for key in [
+                    'interval', 'tmpdir', 'start', 'gpu_collect', 'save_best',
+                    'key_indicator', 'rule'
+            ]:
                 eval_kwargs.pop(key, None)
             eval_kwargs.update(dict(metric=args.eval, **kwargs))
             print(dataset.evaluate(outputs, **eval_kwargs))",Other scripts such as `benchmark.py` may also be affected.,py,0,0,1
"@@ -19,3 +19,8 @@
 
 import pytest_bdd as bdd
 bdd.scenarios('tabs.feature')
+
+
+@bdd.when(""I wait for a prompt"")
+def wait_for_prompt(quteproc):
+    quteproc.wait_for(message='Asking question *')","You can simply do `And I wait for ""Asking question *"" in the log` in the `feature` file (though you might want to include some portion of the question text as well)",py,1,1,1
"@@ -0,0 +1,13 @@
+""""""Molecule Application Module.""""""
+from ansible_compat.runtime import Runtime
+
+
+class App:
+    """"""App class that keep runtime status.""""""
+
+    def __init__(self) -> None:
+        """"""Create a new app instance.""""""
+        self.runtime = Runtime(isolated=True)
+
+
+app = App()",Is this an attempt to make a mutable singleton? Why not initialize it during the startup sequence and then pass around DI-style?,py,1,1,1
"@@ -19,8 +19,7 @@
 # http://numenta.org/licenses/
 # ----------------------------------------------------------------------
 
-from collections import defaultdict, namedtuple
-
+from collections import defaultdict
 
 
 class SynapseData(object):","I think we want 3 blank lines above this, not 2. ""Separate top level functions and classes by three blank lines.""",py,1,1,1
"@@ -8,6 +8,14 @@ from pylint import checkers
 from pylint.lint import PyLinter
 from pylint.testutils import MinimalTestReporter
 
+TOP = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
+PYLINTRC = os.path.join(TOP, ""pylintrc"")
+
+
+@pytest.fixture(autouse=True)
+def pylintrc():
+    os.environ[""PYLINTRC""] = PYLINTRC
+
 
 @pytest.fixture
 def linter(checker, register, enable, disable, reporter):",I don't see the point in adding those lines. Can you explain a little bit please?,py,0,1,1
"@@ -28,10 +28,10 @@ def get_python_path(filepath: str) -> str:
             return os.getcwd()
 
 
-def _basename_in_ignore_list_re(base_name, ignore_list_re):
-    """"""Determines if the basename is matched in a regex ignorelist
+def _is_in_ignore_list_re(element, ignore_list_re):
+    """"""Determines if the element is matched in a regex ignore-list
 
-    :param str base_name: The basename of the file
+    :param str element: The element to be checked.
     :param list ignore_list_re: A collection of regex patterns to match against.
         Successful matches are ignored.
 ","Could you add the typing and remove the docstring that became useless, please. Since this MR we've removed python 3.5 and trying to add typing on modified functions :)",py,1,1,1
"@@ -37,9 +37,9 @@ class FunctionHooker(object):
 	def __init__(self,targetDll,importDll,funcName,newFunction):
 		hook=NVDAHelper.localLib.dllImportTableHooks_hookSingle(targetDll,importDll,funcName,newFunction)
 		if hook:
-			print ""hooked %s""%funcName
+			print(""hooked %s""%funcName)
 		else:
-			print ""could not hook %s""%funcName
+			print(""could not hook %s""%funcName)
 			raise RuntimeError(""could not hook %s""%funcName)
 
 	def __del__(self):","Actually, the print statements in this file should have always been log.debug calls. Currently they are just noise going to stdout.",py,1,1,1
"@@ -144,11 +144,9 @@ class TimescaleListenStore(ListenStore):
             t0 = time.monotonic()
             min_ts = self._select_single_timestamp(True, user_name)
             max_ts = self._select_single_timestamp(False, user_name)
+            cache.set(REDIS_USER_TIMESTAMPS + user_name, ""%d,%d"" % (min_ts, max_ts), time=0)
             # intended for production monitoring
             self.log.info(""timestamps %s %.2fs"" % (user_name, time.monotonic() - t0))
-            if min_ts and max_ts:
-                cache.set(REDIS_USER_TIMESTAMPS + user_name,
-                          ""%d,%d"" % (min_ts, max_ts), time=0)
 
         return min_ts, max_ts
 ",can we add to the docstring of select_single_timestamp to say that it returns a sentinel 0 in the case that they user has no listens?,py,1,1,1
"@@ -83,7 +83,8 @@ class YamlConfig:
     def __init__(self):
         self._filename = os.path.join(standarddir.config(auto=True),
                                       'autoconfig.yml')
-        self.values = {}
+        self._values = {}
+        self._changed = None
 
     def init_save_manager(self, save_manager):
         """"""Make sure the config gets saved properly.","FWIW I'd prefer this to be called `self._dirty` as it's called that in other places, and when we add a `changed` signal, it's harder to mix those two up. Also, why set it to `None` here and not `False`?",py,1,1,1
"@@ -38,6 +38,7 @@ VIOLATION_RESOURCES = {
     'FIREWALL_WHITELIST_VIOLATION': 'firewall_rule_violations',
     'GROUP_VIOLATION': 'groups_violations',
     'KE_VERSION_VIOLATION': 'ke_version_violations',
+    'KE_JMESPATH_VIOLATION': 'ke_jmespath_violations',
     'IAM_POLICY_VIOLATION': 'iam_policy_violations',
     'IAP_VIOLATION': 'iap_violations',
     'INSTANCE_NETWORK_INTERFACE_VIOLATION': (",Can we just name this as `KE_VIOLATION`? jmespath is just what we used to evaluate for the violation.,py,1,1,1
"@@ -0,0 +1,6 @@
+# -*- coding: UTF-8 -*-
+# A part of NonVisual Desktop Access (NVDA)
+# Copyright (C) 2018 NV Access Limited, Łukasz Golonka
+# This file may be used under the terms of the GNU General Public License, version 2 or later.
+# For more details see: https://www.gnu.org/licenses/gpl-2.0.html
+from mplayerc import *",Could you please add an empty line before and after this line?,py,1,1,1
"@@ -176,8 +176,8 @@ def _get_mapped_solids_dict(
     with user_code_error_boundary(
         DagsterConfigMappingFunctionError, _get_error_lambda(current_stack)
     ):
-        mapped_solids_config = graph_def.config_mapping.config_fn(
-            config_mapped_solid_config.value.get(""config"", {})
+        mapped_solids_config = graph_def.config_mapping.resolve(
+            config_mapped_solid_config.value.get(""config"", {}), config_has_been_validated=True
         )
 
     # Dynamically construct the type that the output of the config mapping function will",how do we handle enums in composite descent? is it under test at all?,py,1,1,1
"@@ -18,6 +18,7 @@ from __future__ import absolute_import
 from __future__ import division
 from __future__ import print_function
 
+import threading
 import concurrent.futures
 from google.apputils import datelib
 ","nit: threading is part of the standard library, so it should be with __future__ section.",py,1,1,1
"@@ -416,9 +416,9 @@ This initializes all modules such as audio, IAccessible, keyboard, mouse, and GU
 		log.warning(""Java Access Bridge not available"")
 	except:
 		log.error(""Error initializing Java Access Bridge support"", exc_info=True)
-	import winConsoleHandler
-	log.debug(""Initializing winConsole support"")
-	winConsoleHandler.initialize()
+	import winConsoleHandlerLegacy
+	log.debug(""Initializing legacy winConsole support"")
+	winConsoleHandlerLegacy.initialize()
 	import UIAHandler
 	log.debug(""Initializing UIA support"")
 	try:",Why did you rename this as well?,py,1,1,1
"@@ -2042,12 +2042,10 @@ defaultdict(<class 'list'>, {'col..., 'col...})]
         2     0     0     0
         3    10    13    17
         4    20    23    27
-
         """"""
         applied = []
         for column in self._internal.data_columns:
             applied.append(self[column].shift(periods, fill_value))
-
         sdf = self._sdf.select(
             self._internal.index_scols + [c._scol for c in applied])
         internal = self._internal.copy(sdf=sdf, data_columns=[c.name for c in applied])",Can you remove unrelated changes here?,py,1,1,1
"@@ -0,0 +1,12 @@
+from __future__ import absolute_import, print_function, division
+
+from mitmproxy import ctxmanager
+
+_flow = None
+_log = None
+_master = None
+
+
+flow = ctxmanager.Facade(lambda: _flow)
+log = ctxmanager.Facade(lambda: _log)
+master = ctxmanager.Facade(lambda: _master)",Can we avoid the whole Facade dance and just assign to `ctx.flow` etc. in `handlecontext`?,py,1,1,1
"@@ -694,7 +694,13 @@ class ColorbarPlot(ElementPlot):
             self._cbar_extend = 'max'
 
         # Define special out-of-range colors on colormap
-        cmap = copy.copy(plt.cm.get_cmap(opts.get('cmap')))
+        cmap = opts.get('cmap')
+        if isinstance(cmap, list):
+            cmap = mpl_colors.ListedColormap(cmap)
+        elif isinstance(cmap, util.basestring):
+            cmap = copy.copy(plt.cm.get_cmap(cmap))
+        else:
+            cmap = copy.copy(cmap)
         colors = {}
         for k, val in self.clipping_colors.items():
             if isinstance(val, tuple):",What is all the copying about?,py,1,0,1
"@@ -174,6 +174,9 @@ class ElementPlot(BokehPlot, GenericElementPlot):
         default=None, class_=(util.basestring, TickFormatter, FunctionType), doc=""""""
         Formatter for ticks along the x-axis."""""")
 
+    x2rotation = param.Integer(default=None, bounds=(0, 360), doc=""""""
+        Rotation angle of the xticks."""""")
+
     _categorical = False
 
     # Declare which styles cannot be mapped to a non-scalar dimension",Rotation angle of _which_ xticks?,py,1,0,1
"@@ -268,6 +268,7 @@ def _load_skill(path, course):
 
     return Skill(
         name=name,
+        filename=str(path)[len(course.course_dir)+1:],
         id=skill_id,
         words=words,
         phrases=phrases,",why `str(path)` instead of just `path`?,py,1,1,1
"@@ -0,0 +1,12 @@
+import sys
+import csv
+
+import psycopg2
+
+import config
+
+
+# NOT IMPLEMENTED
+
+def test_pairs():
+    pass",should we remove this file?,py,1,0,1
"@@ -5202,6 +5202,15 @@ class DataFrameTest(ReusedSQLTestCase, SQLTestUtils):
         kdf = ks.Series([]).to_frame()
         self.assert_eq(pdf.last_valid_index(), kdf.last_valid_index())
 
+    def test_last(self):
+        from pandas.tseries.offsets import DateOffset
+
+        index = pd.date_range(""2018-04-09"", periods=4, freq=""2D"")
+        pdf = pd.DataFrame([1, 2, 3, 4], index=index)
+        kdf = ks.from_pandas(pdf)
+        self.assert_eq(pdf.last(""1D""), kdf.last(""1D""))
+        self.assert_eq(pdf.last(DateOffset(days=1)), kdf.last(DateOffset(days=1)))
+
     def test_first_valid_index(self):
         pdf = pd.DataFrame(
             {""a"": [None, 2, 3, 2], ""b"": [None, 2.0, 3.0, 1.0], ""c"": [None, 200, 400, 200]},",You can import it at the import block at the header of this file.,py,1,1,1
"@@ -27,6 +27,10 @@ import queueHandler
 import speechDictHandler
 import characterProcessing
 import languageHandler
+import extensionPoints
+
+# inform those who want to know that there is new speech
+preSpeech = extensionPoints.Action()
 
 speechMode_off=0
 speechMode_beeps=1","Also, this might have to be pre_speech according to the conventions.",py,1,1,1
"@@ -1310,3 +1310,14 @@ class IndexesTest(ReusedSQLTestCase, TestUtils):
 
         for lv, output in zip(level_names, outputs):
             self.assertEqual(output, kdf.index._get_level_number(lv))
+
+    def test_abs(self):
+        pidx = pd.Index([-2, -1, 0, 1])
+        kidx = ks.from_pandas(pidx)
+
+        self.assert_eq(abs(pidx), abs(kidx))
+        self.assert_eq(np.abs(pidx), np.abs(kidx))
+
+        kidx = ks.from_pandas(pd.MultiIndex.from_tuples([(1, 2)], names=[""level1"", ""level2""]))
+        with self.assertRaisesRegexp(TypeError, ""perform __abs__ with this index""):
+            abs(kidx)",nit: we have `ks.MultiIndex.from_tuples`.,py,1,0,1
"@@ -247,6 +247,8 @@ class BrailleDisplayDriver(braille.BrailleDisplayDriver,ScriptableObject):
 			""kb:control+end"" : (""br(freedomScientific):dot4+dot5+dot6+brailleSpaceBar"",),
 			""kb:alt"" : (""br(freedomScientific):dot1+dot3+dot4+brailleSpaceBar"",),
 			""kb:alt+tab"" : (""br(freedomScientific):dot2+dot3+dot4+dot5+brailleSpaceBar"",),
+			""kb:alt+shift+tab"" : (""br(freedomScientific):dot1+dot2+dot5+dot6+brailleSpaceBar"",),
+			""kb:win+tab"" : (""br(freedomScientific):dot2+dot3+dot4+brailleSpaceBar"",),
 			""kb:escape"" : (""br(freedomScientific):dot1+dot5+brailleSpaceBar"",),
 			""kb:windows"" : (""br(freedomScientific):dot2+dot4+dot5+dot6+brailleSpaceBar"",),
 			""kb:windows+d"" : (""br(freedomScientific):dot1+dot2+dot3+dot4+dot5+dot6+brailleSpaceBar"",),","This one is wrong and breaks the driver currently. it should be windows, not win. @Oliver2213: Could you provide a pr that fixes this?",py,0,1,1
"@@ -293,9 +293,8 @@ class OptionsManagerMixIn:
             msg = ""No config file found, using default configuration""
         print(msg, file=sys.stderr)
 
-    @staticmethod
     def _parse_toml(
-        config_file: Union[Path, str], parser: configparser.ConfigParser
+        self, config_file: Union[Path, str], parser: configparser.ConfigParser
     ) -> None:
         """"""Parse and handle errors of a toml configuration file.""""""
         with open(config_file, encoding=""utf-8"") as fp:",Might want to add an explanation for why we get here. Can we get the incorrect item from the ValueError message? If so we might be able to pass it as an `args`.,py,1,1,1
"@@ -7710,9 +7710,9 @@ defaultdict(<class 'list'>, {'col..., 'col...})]
 
         Examples
         --------
-        >>> df = ks.DataFrame({'A': {0: 'a', 1: 'b', 2: 'c'},
-        ...                    'B': {0: 1, 1: 3, 2: 5},
-        ...                    'C': {0: 2, 1: 4, 2: 6}},
+        >>> df = ks.DataFrame({'A': {'0': 'a', '1': 'b', '2': 'c'},
+        ...                    'B': {'0': '1', '1': '3', '2': '5'},
+        ...                    'C': {'0': '2', '1': '4', '2': '6'}},
         ...                   columns=['A', 'B', 'C'])
         >>> df
            A  B  C",Why changed here? Seems not related?,py,1,0,0
"@@ -5,6 +5,14 @@ from os import path
 from bzt.modules.siege import SiegeExecutor, DataLogReader
 from tests import BZTestCase
 from tests.mocks import EngineEmul
+from bzt.utils import is_windows
+
+
+def tool_name():
+    if is_windows():
+        return 'siege.bat'
+    else:
+        return 'siege.sh'
 
 
 def get_res_path(resource):",Look how it's done everywhere with utils.EXE_SUFFIX constant.,py,1,1,1
"@@ -21,7 +21,7 @@ from pathlib import Path
 
 import astroid
 import pytest
-from unittest_pyreverse_writer import Config, get_project
+from unittest_pyreverse_writer import _DEFAULTS, Config, get_project
 
 from pylint.pyreverse.diadefslib import (
     ClassDiadefGenerator,",Shouldn't this be defined in ``conftest.py`` and used as a pytest fixtures?,py,1,1,1
"@@ -407,6 +407,8 @@ class HttpLayer(base.Layer):
                 self.channel.ask(""responseheaders"", f)
 
             self.log(""response"", ""debug"", [repr(f.response)])
+            if hasattr(self, 'has_tailers') and self.has_tailers:
+                f.trailers = self.read_trailers_headers()
             self.channel.ask(""response"", f)
 
             if not f.response.stream:","Is `has_tailers` necessary? Shouldn't `flow.trailers == None` be the same information? If we really need `has_tailers`, please make it a first-class citizen of the Response object (instead of checking if it has been set during runtime), so it also serializes properly, and we can remove the `hasattr` checks.",py,1,1,1
"@@ -34,6 +34,15 @@ class CocoDataset(CustomDataset):
                'vase', 'scissors', 'teddy bear', 'hair drier', 'toothbrush')
 
     def load_annotations(self, ann_file):
+        """"""Load annotation from COCO style annotation file
+
+        Args:
+            ann_file (str): Path of annotation file.
+
+        Returns:
+            list[dict]: Annotation info from COCO api.
+        """"""
+
         self.coco = COCO(ann_file)
         self.cat_ids = self.coco.get_cat_ids(cat_names=self.CLASSES)
         self.cat2label = {cat_id: i for i, cat_id in enumerate(self.cat_ids)}",Missing the last `.`,py,1,0,1
"@@ -117,6 +117,10 @@ public class DistributorStatus {
       return up;
     }
 
+    public boolean isDocker() {
+      return up;
+    }
+
     public int getMaxSessionCount() {
       return maxSessionCount;
     }",Prefer a human-readable string rather than querying specific technologies. How would I indicate a session is running on BrowserStack? Or some custom thing?,py,1,1,1
"@@ -30,7 +30,7 @@ WE_POST = r'''
 
 
 def makeJunitXML(inFileName, outFileName):
-	with open(inFileName, 'rt', encoding='UTF-8') as flake8In:
+	with open(inFileName, 'rt', encoding='ANSI', errors='replace') as flake8In:
 		errorText = flake8In.read()
 	if len(errorText) > 0:
 		# make ""with error"" xml content","@feerrenrut Do you think we might reconsider this line now that Flake8 runs in UTF-8 Mode as of #11108? `errors='replace'` is probably still a good strategy, though.",py,0,1,1
"@@ -41,6 +41,13 @@ class ImportTest(QuiltTestCase):
         assert set(dataframes._group_keys()) == set()
         assert set(dataframes._data_keys()) == {'csv', 'nulls'}
 
+        # this should contain elements
+        for node in package:
+            assert node
+        # iter over an empty GroupNode
+        for node in dataframes:
+            assert not node
+
         assert isinstance(README(), string_types)
         assert isinstance(README._data(), string_types)
         assert isinstance(dataframes.csv(), pd.DataFrame)",This doesn't actually check that package contains elements; it won't run at all if the iterator doesn't return anything. Do something like `assert list(package)` instead.,py,1,1,1
"@@ -956,6 +956,13 @@ def package_preview(owner, package_name, package_hash):
     (instance, is_public, is_team) = result
     assert isinstance(instance.contents, RootNode)
 
+    log_count = (
+        db.session.query(
+            sa.func.count(Log.instance_id)
+        )
+        .filter(Log.instance_id==instance.id)
+    ).first()[0]
+
     readme = instance.contents.children.get(README)
     if isinstance(readme, FileNode):
         assert len(readme.hashes) == 1","Don't think this does what you want: this will count how many times a given hash has been updated (which means, no-op or metadata-only updates). I'd assume you want the count for the package?",py,1,1,1
"@@ -172,7 +172,7 @@ class ViewHex(View):
     def _format(data):
         for offset, hexa, s in strutils.hexdump(data):
             yield [
-                (""offset"", offset + "" ""),
+                (""offset"", offset + b"" ""),
                 (""text"", hexa + ""   ""),
                 (""text"", s)
             ]","This should just be `"" ""`? strutils.hexdump returns `native()`.",py,1,1,1
"@@ -1,5 +1,5 @@
 from functools import update_wrapper
-from typing import Any, Callable, Dict, List, Optional, Sequence, Set, Union
+from typing import TYPE_CHECKING, Any, Callable, Dict, List, Optional, Sequence, Set, Union
 
 from dagster import check
 from dagster.core.decorator_utils import format_docstring_for_description","Oops, I'm going to move these changes that don't have anything to do with asset defs to a separate PR.",py,0,0,1
"@@ -259,6 +259,10 @@ class ElectrumWindow(QMainWindow):
     def load_wallet(self, wallet):
         import electrum
         self.wallet = wallet
+        self.blockchain = self.wallet.verifier.blockchain
+        test_height_store = self.wallet.storage.get('blockht')
+        if test_height_store and not self.network.is_connected():
+            self.blockchain.local_height = self.wallet.storage.get('blockht')
         self.accounts_expanded = self.wallet.storage.get('accounts_expanded',{})
         self.current_account = self.wallet.storage.get(""current_account"", None)
 ","When loading the offline wallet, rather than somehow transporting the 20MB blockchain headers file, I stored the most recent height in the offline sync data. It reads here if it exists in the wallet, and if it is offline. This is to allow offline wallets that for some reason go online to update height via internet and not interfere. (I wasn't sure if it would)",py,1,1,1
"@@ -1207,6 +1207,8 @@ class Frame(object, metaclass=ABCMeta):
         >>> df['b'].sum(min_count=3)
         nan
         """"""
+        axis = validate_axis(axis)
+        numeric_only = None if axis == 1 else numeric_only
 
         def sum(spark_column, spark_type):
             if isinstance(spark_type, BooleanType):",`numeric_only = None if axis == 1 and numeric_only is True else numeric_only`?,py,1,1,1
"@@ -0,0 +1,14 @@
+# A part of NonVisual Desktop Access (NVDA)
+# Copyright (C) 2021 NV Access Limited
+# This file is covered by the GNU General Public License.
+# See the file COPYING for more details.
+
+
+def applyMonkeyPatches():
+	# Apply several monkey patches to comtypes
+	# F401 - imported but unused: Patches are applied during import
+	from . import comtypesMonkeyPatches  # noqa: F401
+
+	# Apply patches to Enum, prevent cyclic references on ValueError during construction
+	from . import enumPatches
+	enumPatches.replace__new__()",Since you're grouping all monkey patches in one package can our monkey patches for `wx` be moved to it from `gui.initialize`?,py,1,1,1
"@@ -1277,6 +1277,10 @@ class DictionaryEntryDialog(wx.Dialog):
                 return DictionaryEntryDialog.TYPE_LABELS_ORDERING[typeRadioValue]
 
         def onOk(self,evt):
+                if not self.patternTextCtrl.GetValue():
+                        # Translators: This is an error message to let the user know that the pattern field in the dictionary entry is not valid.
+                        gui.messageBox(_(""A pattern is required.""), _(""Dictionary Entry Error""), wx.OK|wx.ICON_WARNING, self)
+                        return 
                 try:
                         self.dictEntry=speechDictHandler.SpeechDictEntry(self.patternTextCtrl.GetValue(),self.replacementTextCtrl.GetValue(),self.commentTextCtrl.GetValue(),bool(self.caseSensitiveCheckBox.GetValue()),self.getType())
                 except Exception as e:",Would it be a better user experience to disable the OK button when there is no text in the pattern field?,py,1,1,1
"@@ -45,6 +45,12 @@ class ResponseData(HttpEvent):
         self.data = data
 
 
+@dataclass
+class ResponseTrailers(HttpEvent):
+    trailers: http.Headers
+    end_stream: bool = True
+
+
 @dataclass
 class RequestEndOfMessage(HttpEvent):
     def __init__(self, stream_id: int):",Don't ResponseTrailers always imply `end_stream`? We can probably remove the attribute here and end the stream unconditionally.,py,1,1,1
"@@ -95,6 +95,11 @@ CORS_HEADERS = [
     'Access-Control-Request-Headers', 'Access-Control-Request-Method'
 ]
 
+LOCATION_CONSTRAINT_VALID_REGION = ['af-south-1', 'ap-east-1', 'ap-northeast-1', 'ap-northeast-2', 'ap-northeast-3',
+    'ap-south-1', 'ap-southeast-1', 'ap-southeast-2', 'ca-central-1', 'cn-north-1', 'cn-northwest-1, EU',
+    'eu-central-1', 'eu-north-1', 'eu-south-1', 'eu-west-1', 'eu-west-2', 'eu-west-3', 'me-south-1', 'sa-east-1',
+    'us-east-2', 'us-gov-east-1', 'us-gov-west-1', 'us-west-1', 'us-west-2']
+
 
 def event_type_matches(events, action, api_method):
     """""" check whether any of the event types in `events` matches the","nit: Looks like a typo in string `'cn-northwest-1, EU'`. Also, I think we should probably rather match for `us-east-1` (rather than matching against all the other regions here) - to my knowledge `us-east-1` is literally the only region that is an exception when it comes to `LocationConstraint`.",py,1,1,1
"@@ -34,6 +34,7 @@ from qutebrowser.keyinput import keyutils
 val = None
 instance = None
 key_instance = None
+configcache = None
 
 # Keeping track of all change filters to validate them later.
 change_filters = []","hmm, `configcache` or `config_cache`? Or even just `cache` since we access it via the module, i.e. `config.cache['foo']`?",py,1,1,1
"@@ -14,7 +14,7 @@ def evaluateTarget(requestContext, target):
     return result
 
 
-def evaluateTokens(requestContext, tokens, replacements=None):
+def evaluateTokens(requestContext, tokens, replacements=None, pipedArg=None):
   if tokens.template:
     arglist = dict()
     if tokens.template.kwargs:",Could you please elaborate how pipedArg is passed here?,py,1,1,1
"@@ -16,7 +16,7 @@ from select import select, error as select_error
 import subprocess
 import time
 import types
-
+import socket
 from scapy.consts import DARWIN, FREEBSD, OPENBSD, WINDOWS
 from scapy.compat import plain_str
 from scapy.data import ETH_P_ALL, MTU",Also please move it to its right alphabetical place in the imports (above: native modules). Below is reserved for scapy modules,py,1,1,1
"@@ -376,7 +376,16 @@ class PackageStore(object):
         objfiles = [self.object_path(h) for h in hash_list]
         dataset = ParquetDataset(objfiles)
         table = dataset.read(nthreads=4)
-        dataframe = table.to_pandas()
+        try:
+            dataframe = table.to_pandas()
+        except:
+            # Try again to convert the table after removing
+            # the possibly buggy Pandas-specific metadata.
+            meta = table.schema.metadata.copy()
+            meta.pop(b'pandas')
+            newtable = table.replace_schema_metadata(meta)
+            dataframe = newtable.to_pandas()
+
         return dataframe
 
     def _read_parquet_spark(self, hash_list):","Catch a more specific exception - `AssertionError`, `Exception`, etc..; you don't want to catch things like `KeyboardInterrupt` or `SystemExit`.",py,1,1,1
"@@ -46,7 +46,9 @@ public class HTMLTestResults {
   private final HTMLSuiteResult suite;
 
   private static final String HEADER = ""<html>\n"" +
-      ""<head><style type='text/css'>\n"" +
+      ""<head>\n""+
+      ""<meta charset=\""UTF-8\"">\n""+
+      ""<style type='text/css'>\n"" +
       ""body, table {\n"" +
       ""    font-family: Verdana, Arial, sans-serif;\n"" +
       ""    font-size: 12;\n"" +","Is there a recommended quote style for attributes? I see single and double here, double further down.",py,1,1,1
"@@ -119,6 +119,7 @@ exec 2>&1
 # Ubuntu update.
 sudo apt-get update -y
 sudo apt-get upgrade -y
+sudo apt-get update && sudo apt-get --assume-yes install google-cloud-sdk
 
 USER_HOME=/home/ubuntu
 ","Can we separate this change into another PR, since it's not directly related to switching to the image version? Generally speaking, it's good practice to do this separation so that any problems are easier to troubleshoot and find.",py,0,1,1
"@@ -19,3 +19,7 @@
 # http://numenta.org/licenses/
 # ----------------------------------------------------------------------
 __version__ = ""0.3.0.dev0""
+
+import os
+NUPIC_ROOT = os.environ.get('NUPIC', os.path.dirname(os.path.realpath(__file__)))
+",Have you tried get the absolute path of `__file__` and so discard $NUPIC completely?,py,1,1,1
"@@ -32,9 +32,9 @@ import csv
 import json
 import os
 import math
+from pkg_resources import resource_filename
 
 from nupic.algorithms.anomaly import computeRawAnomalyScore
-from nupic.data.datasethelpers import findDataset
 from nupic.data.file_record_stream import FileRecordStream
 from nupic.engine import Network
 from nupic.encoders import MultiEncoder","nit: put blank line before pkg_resources, it is a third-party lib",py,1,1,1
"@@ -35,15 +35,10 @@ def parse_args():
         help='whether not to evaluate the checkpoint during training')
     group_gpus = parser.add_mutually_exclusive_group()
     group_gpus.add_argument(
-        '--gpus',
+        '--gpu-id',
         type=int,
-        help='number of gpus to use '
-        '(only applicable to non-distributed training)')
-    group_gpus.add_argument(
-        '--gpu-ids',
-        type=int,
-        nargs='+',
-        help='ids of gpus to use '
+        default=0,
+        help='id of gpu to use '
         '(only applicable to non-distributed training)')
     parser.add_argument('--seed', type=int, default=None, help='random seed')
     parser.add_argument(",We should add deprecation warning of --gpu-ids and --gpus to indicate users that they are deprecated and useless. We should not delete them immediately.,py,1,1,1
"@@ -42,7 +42,11 @@ from .objects import (
 
 
 def start_inprocess_executor(
-    pipeline_context, execution_plan, intermediates_manager, step_keys_to_execute=None
+    pipeline_context,
+    execution_plan,
+    intermediates_manager,
+    step_keys_to_execute=None,
+    emit_skips=True,
 ):
     check.inst_param(pipeline_context, 'pipeline_context', SystemPipelineExecutionContext)
     check.inst_param(execution_plan, 'execution_plan', ExecutionPlan)",why have a toggle for this? I would wait to add this til we have a case that needs it.,py,1,1,1
"@@ -42,7 +42,7 @@ def _check_tcpdump():
         return False
 
     # On some systems, --version does not exist on tcpdump
-    return proc.returncode == 0 or output.startswith(b'Usage: tcpdump ')
+    return proc.returncode == 0 or output.startswith(b'Usage: tcpdump ') or output.startswith(b'tcpdump: unrecognized option')
 
 
 # This won't be used on Windows",This line is longer than 79 characters. Please split it.,py,1,1,1
"@@ -24,6 +24,10 @@ from datetime import datetime
 from functools import wraps
 from os.path import splitext, basename
 
+from django.conf import settings
+from django.utils.timezone import make_aware
+from graphite.logger import log
+
 try:
   import cPickle as pickle
   USING_CPICKLE = True",eliminate unneeded try/except,py,0,1,1
"@@ -276,7 +276,7 @@ def in_nested_list(nested_list, obj):
 
 def _get_break_loop_node(break_node):
     """"""
-    Returns the loop node that holds the break node in arguments.
+    Returns the loop node that holds the break or return node in arguments.
 
     Args:
         break_node (astroid.Break): the break node of interest.",Can the code that uses this be changed to use `checkers.utils.get_node_first_ancestor_of_type`? This function is basically doing the same I believe.,py,1,1,1
"@@ -1444,7 +1444,8 @@ class CommandDispatcher:
         else:
             qnam = tab.networkaccessmanager()
             download_manager.get(self._current_url(), user_agent=user_agent,
-                                 qnam=qnam, target=target)
+                                 qnam=qnam, target=target,
+                                 title=self._current_title())
 
     @cmdutils.register(instance='command-dispatcher', scope='window')
     def view_source(self):","I think passing a title here makes `get_request` needlessly complicated for only this single use case. Instead, you should be able to construct a `downloads.FileDownloadTarget` here (similar to what's done above when `--dest` is given), and pass that to `.get()` instead. Then there shouldn't be any changes in `qtnetworkdownloads.py` needed at all.",py,1,1,1
"@@ -23,7 +23,11 @@ class AnchorHead(BaseDenseHead, BBoxTestMixin):
         anchor_generator (dict): Config dict for anchor generator
         bbox_coder (dict): Config of bounding box coder.
         reg_decoded_bbox (bool): If true, the regression loss would be
-            applied on decoded bounding boxes. Default: False
+            applied directly on decoded bounding boxes, meaning both the
+            predicted boxes and regression targets are with absolute
+            coordinates format. Default False. It should be set to
+            `True` when using `IoULoss`, `GIoULoss`, or `DIoULoss`
+            in the bbox head.
         loss_cls (dict): Config of classification loss.
         loss_bbox (dict): Config of localization loss.
         train_cfg (dict): Training config of anchor head.",`meaning both the predicted boxes and regression targets are with absolute` -> `converting both the predicted boxes and regression targets to absolute xxx`,py,1,1,1
"@@ -29,6 +29,13 @@ from pyspark.sql import Column
 from pyspark.sql.functions import pandas_udf
 import pyspark.sql.types as types
 
+from databricks import koalas as ks  # For running doctests and reference resolution in PyCharm.
+
+
+__all__ = ['Col', '_make_fun', 'pandas_wrap', 'as_spark_type',
+           'as_python_type', 'infer_pd_series_spark_type']
+
+
 T = typing.TypeVar(""T"")
 
 ",I think `__all__` usually doesn't include `_*` functions.,py,1,1,1
"@@ -4546,6 +4546,17 @@ class DataFrameTest(ReusedSQLTestCase, SQLTestUtils):
         finally:
             sys.stdout = prev
 
+    def test_repartition(self):
+        kdf = ks.DataFrame({""age"": [5, 5, 2, 2], ""name"": [""Bob"", ""Bob"", ""Alice"", ""Alice""]})
+
+        new_kdf = kdf.spark.repartition(7)
+        self.assertEqual(new_kdf.to_spark().rdd.getNumPartitions(), 7)
+
+        kdf = kdf.set_index(""age"")
+        new_kdf = kdf.spark.repartition(5)
+        self.assertEqual(new_kdf.to_spark().rdd.getNumPartitions(), 5)
+        self.assertEqual(kdf.index.name, new_kdf.index.name)
+
     def test_mad(self):
         pdf = pd.DataFrame(
             {","Shall we also test `self.assert_eq(kdf.sort_index(), new_kdf.sort_index())`?",py,1,1,1
"@@ -154,13 +154,15 @@ class CustomWindow(AutoPropertyObject):
 	def _get__wClass(cls):
 		return WNDCLASSEXW(
 			cbSize=ctypes.sizeof(WNDCLASSEXW),
-			lpfnWndProc=cls._rawWindowProc,
+			lpfnWndProc=_rawWindowProc,
 			hInstance=appInstance,
 			lpszClassName=cls.className,
 		)
 
 	_abstract_className = True
 
+	className: str
+
 	@classmethod
 	def _get_className(cls) -> str:
 		""""""The class name of this window.""""""",I think the `cls.` part of this line suggests that this is intentional.,py,1,1,1
"@@ -21,6 +21,8 @@
 
 import itertools
 
+import random as r
+
 import numpy
 from nupic.bindings.math import (SM32 as SparseMatrix,
                                  SM_01_32_32 as SparseBinaryMatrix,","Yikes - we can't do this. We need to use the same random generator as used in the C code, i.e. NupicRandom. This is initialized as the member variable _random. Search for that to see how it's used.",py,1,1,1
"@@ -135,7 +135,7 @@ class ResamplingOperation(Operation):
 
         xtype = 'numeric'
         if isinstance(xstart, datetime_types) or isinstance(xend, datetime_types):
-            xstart, xend = dt_to_int(xstart), dt_to_int(xend)
+            xstart, xend = dt_to_int(xstart, 'ns'), dt_to_int(xend, 'ns')
             xtype = 'datetime'
         elif not np.isfinite(xstart) and not np.isfinite(xend):
             if element.get_dimension_type(x) in datetime_types:","Wondering if life might be easier/ less error-prone if instead of ``dt_to_int(x, 'ns')`` and ``dt_to_int(x)`` you had two separate utilities: ``dt_to_ns`` and ``dt_to_us``...",py,1,1,1
"@@ -25,6 +25,9 @@ import logging
 
 import pytest
 import jinja2
+from helpers.utils import CallbackChecker
+from PyQt5.QtCore import QUrl
+from qutebrowser.utils.debug import qenum_key
 
 try:
     from PyQt5.QtWebKit import QWebSettings","Please also import the `utils` and `debug` modules here, and group the imports correctly.",py,1,1,1
"@@ -1,7 +1,9 @@
-_base_ = './faster_rcnn_r50_fpn_1x_coco.py'
+_base_ = './faster_rcnn_r50_caffe_fpn_mstrain_1x_coco.py'
 model = dict(roi_head=dict(bbox_head=dict(num_classes=1)))
 classes = ('person', )
 data = dict(
     train=dict(classes=classes),
     val=dict(classes=classes),
     test=dict(classes=classes))
+
+load_from = 'http://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_bbox_mAP-0.398_20200504_163323-30042637.pth'  # noqa",Rename the configs to be `faster_rcnn_r50_fpn_mstrain_1x_coco-person.py`,py,1,1,1
"@@ -119,11 +119,11 @@ class ActiveExecution:
             )
             if self._interrupted:
                 raise DagsterExecutionInterruptedError(
-                    f""Execution of pipeline was interrupted before completing the execution plan. {state_str}""
+                    f""Execution of job/pipeline was interrupted before completing the execution plan. {state_str}""
                 )
             else:
                 raise DagsterInvariantViolationError(
-                    f""Execution of pipeline finished without completing the execution plan. {state_str}""
+                    f""Execution of job/pipeline finished without completing the execution plan. {state_str}""
                 )
 
         # See verify_complete - steps for which we did not observe a failure/success event are in an unknown","even with `JobDefinition`, will we not know if it's a job or a pipeline?",py,1,1,1
"@@ -647,6 +647,7 @@ def read_config_py(filename: str, raising: bool = False) -> None:
 
     if api.errors:
         raise configexc.ConfigFileErrors('config.py', api.errors)
+    config.instance.config_py_loaded = True
 
 
 def read_autoconfig() -> None:","This means it isn't set when there were errors - but in that case, the `config.py` is still loaded, just with some errors. This should probably be done before the `if api.errors:`.",py,1,1,1
"@@ -214,6 +214,14 @@ class TlsConfig:
             key_size=ctx.options.key_size,
             passphrase=ctx.options.cert_passphrase.encode(""utf8"") if ctx.options.cert_passphrase else None,
         )
+        if self.certstore.default_ca.has_expired():
+            ctx.log.warn(
+                ""The mitmproxy certificate authority has expired!\n""
+                ""Please delete all CA-related files in your ~/.mitmproxy folder.\n""
+                ""The CA will be regenerated automatically after restarting mitmproxy.\n""
+                ""Then make sure all your clients have the new CA installed."",
+            )
+
         for certspec in ctx.options.certs:
             parts = certspec.split(""="", 1)
             if len(parts) == 1:",Let's point them to the docs to use mitm.it et al.,py,1,1,1
"@@ -81,3 +81,12 @@ class APITimelineEvent(pydantic.BaseModel):
     user_name: str
     created: int
     metadata: APIEventMetadata
+
+class APIRecommendationNotificationTimelineEvent(pydantic.BaseModel):
+    # since `id` is not sent in APITimelineEvent
+    # this field is needed for deletion of Recommendation and Notification Events
+    id: int
+    event_type: UserTimelineEventType
+    user_name: str
+    created: int
+    metadata: APIEventMetadata","You can instead add the `id` field to APITimelineEvent. If all entities are not going to have it, you can make it as `id: Optional[int]`.",py,1,1,1
"@@ -32,6 +32,7 @@ import email.generator
 import email.encoders
 import email.mime.multipart
 import email.message
+from quopri import encodestring
 
 from PyQt5.QtCore import QUrl
 ","Please only import modules (i.e. `import quopri` and use `encodestring.quopri`), as this makes things much more readable IMHO.",py,1,1,1
"@@ -127,10 +127,14 @@ class RemoteFileSystem(luigi.target.FileSystem):
         return exists
 
     def _ftp_exists(self, path, mtime):
+        path_parts = path.split('/')
+        path = '/'.join(path_parts[:-1])
+        fn = path_parts[-1]
+
         files = self.conn.nlst(path)
 
         exists = False
-        if files:
+        if fn in files:
             if mtime:
                 mdtm = self.conn.sendcmd('MDTM ' + path)
                 modified = datetime.datetime.strptime(mdtm[4:], ""%Y%m%d%H%M%S"")",Does this assignment make sense?? You seem to overwrite it right afterwards in the loop no?,py,1,1,1
"@@ -44,7 +44,7 @@ public abstract class NewSessionQueue implements HasReadyState {
 
   public abstract boolean offerFirst(HttpRequest request, RequestId requestId);
 
-  public abstract Optional<HttpRequest> poll();
+  public abstract Optional<HttpRequest> poll(RequestId requestId);
 
   public abstract int clear();
 ","The expected behaviour for `poll` would be to match what `Deque` does, which is: > Retrieves and removes the head of the queue represented by this deque As such, you shouldn't need the `RequestId` here.",py,1,1,1
"@@ -42,7 +42,7 @@ extras_require[""examples""] = extras_require[""recommended""] + [
     ""ffmpeg"",
     ""cftime"",
     ""netcdf4"",
-    ""dask"",
+    ""dask<=2020.12.0"",
     ""scipy"",
     ""shapely"",
     ""scikit-image""","Ideally we'd fix the regression in a separate PR, rather than pin this here.",py,0,1,1
"@@ -631,6 +631,8 @@ class FormatChecker(BaseTokenChecker):
             elif token[1] == ',':
                 if not bracket_level:
                     return False
+            elif token[1] == '.':
+                continue
             elif token[0] not in (tokenize.NAME, tokenize.STRING):
                 return False
         return False","Well, yes, this is one possible solution. Thanks for a fix  ",py,0,0,1
"@@ -264,6 +264,16 @@ class BuildTest(QuiltTestCase):
         with assertRaisesRegex(self, build.BuildException, r'Bad yaml syntax.*build_bad_syntax\.yml'):
             build.build_package(None, 'test_syntax_error', PACKAGE, path)
 
+    def test_build_no_contents_node(self):
+        """"""
+        Attempt to build a yml file without contents node nor packages
+        """"""
+        mydir = os.path.dirname(__file__)
+        path = os.path.join(mydir, './build_no_contents_node.yml')
+
+        with assertRaisesRegex(self, build.BuildException, r'Error in build_no_contents_node.yml'):
+            build.build_package(None, 'no_contents', PACKAGE, path)
+
     def test_build_checks_yaml_syntax_error(self):    # pylint: disable=C0103
         """"""
         Attempt to build a yml file with a syntax error",Docstring inaccurate: You tested 'packages' elsewhere,py,1,1,1
"@@ -104,7 +104,7 @@ def check_for_software_updates(flash_message=False):
     :return: True if you have latest version, else False if you need to upgrade
              or None if server was not reachable.
     """"""
-    from invenio.config import CFG_VERSION
+    from invenio.version import __version__ as invenio_version
     from invenio.base.i18n import _
     try:
         find = re.compile('Invenio v[0-9]+.[0-9]+.[0-9]+(\-rc[0-9])?'",we can use `invenio.version` instead,py,1,0,1
"@@ -144,7 +144,9 @@ def _process_recommendations(recommendations, count, artist_type, user_name, off
         err_msg = 'No recommendations for user {}, please try again later.'.format(user_name)
         raise APINoContent(err_msg, payload={'last_updated': int(getattr(recommendations, 'created').timestamp())})
 
-    count = min(count, MAX_ITEMS_PER_GET)
+    # For the purpose of experimenting with recommendations, we're allowing to fetch at most
+    # 1K recommendations.
+    count = min(count, 1000)
 
     return mbid_list[offset:offset+count], total_mbid_count
 ","This should really be a defined constant, tied the number of recommendations we generate. For expediency sake, maybe open a ticket for improving that so we can merge this faster?",py,1,1,1
"@@ -987,6 +987,7 @@ class BrowseModeDocumentTextInfo(textInfos.TextInfo):
 
 	def getControlFieldSpeech(self, attrs, ancestorAttrs, fieldType, formatConfig=None, extraDetail=False, reason=None):
 		textList = []
+		role=attrs.get('role')
 		landmark = attrs.get(""landmark"")
 		if formatConfig[""reportLandmarks""] and fieldType == ""start_addedToControlFieldStack"" and landmark:
 			try:",This line is no longer necessary.,py,1,0,1
"@@ -262,6 +262,19 @@ def define_model(model_name, dbengine, model_seed):
                primary_key=True),
     )
 
+    groups_settings = Table(
+        '{}_groups_settings'.format(model_name),
+        base.metadata,
+        Column('group_name',
+               ForeignKey('{}.name'.format(members_tablename)),
+               primary_key=True),
+        Column('settings',
+               Text(16777215)),
+    )
+
+
+
+
     def get_string_by_dialect(db_dialect, column_size):
         """"""Get Sqlalchemy String by dialect.
         Sqlite doesn't support collation type, need to define different",@blueandgold I'm still somewhat unfamiliar with the model stuff and want to confirm that Im not missing anything I need here. For instance I probably need bindings or queries? Lets chat tomorrow,py,0,0,1
"@@ -1,8 +1,6 @@
-#!/usr/bin/env python
-
 # ----------------------------------------------------------------------
 # Numenta Platform for Intelligent Computing (NuPIC)
-# Copyright (C) 2013, Numenta, Inc.  Unless you have an agreement
+# Copyright (C) 2014, Numenta, Inc.  Unless you have an agreement
 # with Numenta, Inc., for a separate license for this software code, the
 # following terms and conditions apply:
 #",I think it is preferred to change to `2013-2014`.,py,1,0,1
"@@ -103,7 +103,11 @@ class Message(serializable.Serializable):
         ce = self.headers.get(""content-encoding"")
         if ce:
             try:
-                return encoding.decode(self.raw_content, ce)
+                content = encoding.decode(self.raw_content, ce)
+                # A client may illegally specify a byte -> str encoding here (e.g. utf8)
+                if isinstance(content, str):
+                    raise ValueError(""Invalid Content-Encoding: {}"".format(ce))
+                return content
             except ValueError:
                 if strict:
                     raise","If it is a client, shouldn't we raise a ProtocolException or something similar?",py,1,1,1
"@@ -0,0 +1,19 @@
+from flask import Blueprint
+from werkzeug.exceptions import NotFound
+
+
+# Blueprint to contain the view that returns 404 if API calls are made to
+# the web app instead of the api flask application
+api_404_bp = Blueprint('api_404', __name__)
+
+
+@api_404_bp.route('/1/submit_listens', methods=['GET', 'POST'])
+@api_404_bp.route('/1/user/<user_name>/listens', methods=['GET'])
+@api_404_bp.route('/2.0/', methods=['GET', 'POST'])
+@api_404_bp.route('/api/auth/', methods=['GET', 'POST'])
+def webapp_api_call(user_name=None):
+    """"""
+    This route is used to raise 404s when api calls are made to the webapp
+    instead of the api.
+    """"""
+    raise NotFound(""Incorrect address used in call to API, please use api.listenbrainz.org instead."")","The body of this message should be JSON, in the same format as other error messages sent by the API.",py,1,1,1
"@@ -124,7 +124,7 @@ def range(start: int,
 
 
 def read_csv(path, header='infer', names=None, usecols=None,
-             mangle_dupe_cols=True, parse_dates=False, comment=None):
+             mangle_dupe_cols=True, parse_dates=False, comment=None, index_col=None):
     """"""Read CSV (comma-separated) file into DataFrame.
 
     Parameters",We should put the `index_col` argument betwen `names` and `usecols` to follow pandas'?,py,1,1,1
"@@ -48,9 +48,8 @@ class TestFileCompletion:
         return _get_prompt_func
 
     @pytest.mark.parametrize('steps, where, subfolder', [
-        (1, 'next', '..'),
-        (1, 'prev', 'c'),
-        (2, 'next', 'a'),
+        (1, 'next', 'a'),
+        (2, 'next', 'b'),
         (2, 'prev', 'b'),
     ])
     def test_simple_completion(self, tmp_path, get_prompt, steps, where,",You can leave this one as it still should work. Going to the previous item once still falls in `c`.,py,1,1,1
"@@ -44,6 +44,12 @@ from luigi.cmdline_parser import CmdlineParser
 _no_value = object()
 
 
+class ParameterVisibility(object):
+    PUBLIC = 0
+    HIDDEN = 1
+    PRIVATE = 2
+
+
 class ParameterException(Exception):
     """"""
     Base exception.",You can use the enum class that's built into python. (there's a 2.7 backport we're already using),py,1,1,1
"@@ -131,7 +131,12 @@ def create_full_filename(basename, filename):
     encoding = sys.getfilesystemencoding()
     filename = utils.force_encoding(filename, encoding)
     basename = utils.force_encoding(basename, encoding)
-    if os.path.isabs(filename) and os.path.isdir(filename):
+
+    if filename.endswith('/'):
+        # The path is a directory we want to store the file in (rather than the
+        # path *to* the file).
+        return os.path.join(filename, basename)
+    elif os.path.isabs(filename) and os.path.isdir(filename):
         # We got an absolute directory from the user, so we save it under
         # the default filename in that directory.
         return os.path.join(filename, basename)",Shouldn't this be `os.sep` so it works on Windows with `\` too?,py,1,1,1
"@@ -517,8 +517,8 @@ class VoiceSettingsDialog(SettingsDialog):
 		# Translators: This is a label for a setting in voice settings (an edit box to change voice pitch for capital letters; the higher the value, the pitch will be higher).
 		capPitchChangeLabel=wx.StaticText(self,-1,label=_(""Capital pitch change percentage""))
 		settingsSizer.Add(capPitchChangeLabel)
-		self.capPitchChangeEdit=wx.TextCtrl(self,wx.NewId())
-		self.capPitchChangeEdit.SetValue(str(config.conf[""speech""][getSynth().name][""capPitchChange""]))
+		self.capPitchChangeEdit=wx.SpinCtrl(self, min=0, max=100,
+			initial=config.conf[""speech""][getSynth().name][""capPitchChange""])
 		settingsSizer.Add(self.capPitchChangeEdit,border=10,flag=wx.BOTTOM)
 		# Translators: This is the label for a checkbox in the
 		# voice settings dialog.","The minimum here is -100, not 0. (The value is relative, not multiplicative.) Do these controls support negative values?",py,1,1,1
"@@ -153,7 +153,11 @@ def cleanup():
 			log.exception(""Error terminating app module %r"" % deadMod)
 
 def doesAppModuleExist(name):
-	return any(importer.find_module(""appModules.%s"" % name) for importer in _importers)
+	# #9797: when invoked from system tests, importers list isn't initialized (attribute error on a None object), thus assume no app module exists.
+	try:
+		return any(importer.find_module(""appModules.%s"" % name) for importer in _importers)
+	except AttributeError:
+		return False
 
 def fetchAppModule(processID,appName):
 	""""""Returns an appModule found in the appModules directory, for the given application name.","I think I would prefer just to check if _importers is None and return False, rather than letting it knowingly fail. Though I'd like to also understand why systemTestSpy actually causes doesAppModule exist to be called? can you provide an example traceback on the issue?",py,1,1,1
"@@ -269,6 +269,13 @@ def set_rate_limits(per_token_limit, per_ip_limit, window_size):
         set_rate_limits(per_token_limit, per_ip_limit, window_size)
 
 
+@cli.command(name=""update_all_user_listen_counts"")
+def update_all_user_listen_counts():
+    """""" Scans listen table and update listen counts for all users """"""
+    application = webserver.create_app()
+    with application.app_context():
+        ts_update_user_listen_counts()
+
 @cli.command(name=""recalculate_all_user_data"")
 def recalculate_all_user_data():
     """"""",Could use updating.,py,1,0,1
"@@ -971,7 +971,7 @@ class _tls_sessions(object):
                 if len(sid) > 12:
                     sid = sid[:11] + ""...""
                 res.append((src, dst, sid))
-        colwidth = map(lambda x: max(map(lambda y: len(y), x)), apply(zip, res))
+        colwidth = [max([len(y) for y in x]) for x in zip(*res)]
         fmt = ""  "".join(map(lambda x: ""%%-%ds""%x, colwidth))
         return ""\n"".join(map(lambda x: fmt % x, res))
 ",Use a generator () instead of [],py,1,0,1
"@@ -231,6 +231,14 @@ def file(recid, filename):
             return send_file(file_, mimetype='application/octet-stream',
                              attachment_filename=filename)
         return send_file(document['uri'])
+
+    from invenio.modules.documents.utils import _get_legacy_bibdocs
+    for fullpath, permission in _get_legacy_bibdocs(recid, filename=filename):
+        if not permission:
+            error = 401
+            continue
+        return send_file(fullpath)
+
     abort(error)
 
 ",Why the previous lines are reading the whole file into memory :scream: ?,py,1,1,1
"@@ -108,8 +108,9 @@ class TestCloudFormationCreateStack(CloudFormationConnectionBase):
 
     def test_create_stack_fails(self):
         self.set_http_response(status_code=400, reason='Bad Request',
-                               body='Invalid arg.')
-        with self.assertRaises(self.service_connection.ResponseError):
+            body='{""Error"": {""Code"": 1, ""Message"": ""Invalid arg.""}}')
+        with self.assertRaisesRegexp(self.service_connection.ResponseError,
+            'Invalid arg.'):
             api_response = self.service_connection.create_stack(
                 'stack_name', template_body=SAMPLE_TEMPLATE,
                 parameters=[('KeyName', 'myKeyName')])",This probably needs more tests that just this modified one. How about a test that validates the parsed attributes of the exception given a JSON error message?,py,1,1,1
"@@ -49,7 +49,8 @@ class FCOSHead(nn.Module):
                      use_sigmoid=True,
                      loss_weight=1.0),
                  conv_cfg=None,
-                 norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)):
+                 norm_cfg=dict(type='GN', num_groups=32, requires_grad=True),
+                 center_sample_radius=0):  # 0 for disable `center sampling`
         super(FCOSHead, self).__init__()
 
         self.num_classes = num_classes",This is somewhat misleading. It may be better to add a parameter `center_sampling` to indicate whether or not using center sampling.,py,1,1,1
"@@ -73,11 +73,8 @@ class ConsistentHashRing:
 
   def compute_ring_position(self, key):
     if self.hash_type == 'fnv1a_ch':
-      big_hash = '{:x}'.format(int(fnv32a( str(key) )))
-      if len(big_hash) > 4:
-          small_hash = int(big_hash[:4], 16) ^ int(big_hash[4:], 16)
-      else:
-          small_hash = int(big_hash, 16)
+      big_hash = int(fnv32a(str(key)))
+      small_hash = (big_hash >> 16) ^ (big_hash & 0xffff)
     else:
       big_hash = compactHash(str(key))
       small_hash = int(big_hash[:4], 16)","I see that here we don't have the same python version check as in carbon, we should make them consistent. The best solution may be to use `big_hash = int(fnv32a(six.binary_type(key)))` for both 2.x and 3.x.",py,1,1,1
"@@ -444,6 +444,9 @@ class Daemon(Logger):
             daemon_jobs.append(self.watchtower.run)
         if self.network:
             self.network.start(jobs=[self.fx.run])
+            # prepare lightning functionality, also load channel db early
+            self.network.maybe_init_lightning()
+            self.network.channel_db.load_data()
 
         self.taskgroup = TaskGroup()
         asyncio.run_coroutine_threadsafe(self._run(jobs=daemon_jobs), self.asyncio_loop)","if we start calling `channel_db.load_data()` from multiple places, we should add some kind of guarantees into `load_data` that it only runs once it always runs on the sql thread, so no need for locking; it could simply have an early return if it has already run once",py,1,1,1
"@@ -1,8 +1,10 @@
 import uuid
 import time
+import sys
 from collections import deque
 
 import param
+from unittest import SkipTest
 import numpy as np
 from holoviews import Dimension, NdLayout, GridSpace, Layout, NdOverlay
 from holoviews.core.spaces import DynamicMap, HoloMap, Callable",Don't want to be too much of a stickler but imports are generally organized by stdlib then external libraries.,py,1,1,1
"@@ -33,6 +33,7 @@ class RouteTable(TaggedEC2Object):
         self.id = None
         self.vpc_id = None
         self.routes = []
+        self.propagatingvgws = []
         self.associations = []
 
     def __repr__(self):",Any reason this is not `propagating_vgws` instead of all one word?,py,1,1,1
"@@ -148,10 +148,10 @@ def dynamize_value(val):
 if six.PY2:
     class Binary(object):
         def __init__(self, value):
-            if isinstance(value, six.text_type):  # Support only PY2 for backward compatibility.
-                value = value.encode('utf-8')
-            elif not isinstance(value, bytes):
+            if not isinstance(value, (bytes, six.text_type)):
                 raise TypeError('Value must be a string of binary data!')
+            if not isinstance(value, bytes):
+                value = value.encode(""utf-8"")
 
             self.value = value
 ",I believe that `unicode` should still be encoded to UTF-8. The internal representation (`value`) of the `Binary` class should always be `bytes`.,py,1,1,1
"@@ -27,7 +27,13 @@ MeshType = itk.Mesh[PixelType, Dimension]
 mesh = MeshType.New()
 
 # Create Vector Container and Store values in it for each Point
-v = itk.VectorContainer[itk.UL, PixelType].New()
+# For windows use itk.ULL
+if hasattr(itk.VectorContainer, 'ULAD'):
+    IdentifierType = itk.UL
+else:
+    IdentifierType = itk.ULL
+
+v = itk.VectorContainer[IdentifierType, PixelType].New()
 v.Reserve(NumberOfPoints)
 
 for i in range(NumberOfPoints):","A generic way to check for Windows is `if os.name == 'nt'`. But if the one you wrote here works, we should keep it.",py,1,1,1
"@@ -111,8 +111,8 @@ def hierarchical(keys):
     ndims = len(keys[0])
     if ndims <= 1:
         return True
-    dim_vals = zip(*keys)
-    combinations = (zip(*dim_vals[i:i+2])
+    dim_vals = list(zip(*keys))
+    combinations = (list(zip(*dim_vals[i:i+2]))
                     for i in range(ndims-1))
     hierarchies = []
     for combination in combinations:",Is the second list needed here? Seems like `combination` in the nested for loop below is only used as an iterator.,py,1,1,1
"@@ -656,7 +656,13 @@ class TabbedBrowser(tabwidget.TabWidget):
             key: mark identifier; capital indicates a global mark
         """"""
         # strip the fragment as it may interfere with scrolling
-        url = self.current_url().adjusted(QUrl.RemoveFragment)
+        try:
+            url = self.current_url().adjusted(QUrl.RemoveFragment)
+        except qtutils.QtValueError:
+            # show an error only if the mark is not automatically set
+            if key != ""'"":
+                message.error(self._win_id, ""Failed to set mark: url invalid"")
+            return
         point = self.currentWidget().page().currentFrame().scrollPosition()
 
         if key.isupper():","Never use a bare `except:`, that'd catch any exception (even a typo somewhere, for example). This should be `except qtutils.QtValueError:` instead.",py,1,1,1
"@@ -47,6 +47,9 @@ def molecule_provisioner_section_data():
                 'instance-1': [{
                     'foo': 'bar'
                 }],
+                'localhost': [{
+                    'foo': 'baz'
+                }]
             },
             'group_vars': {
                 'example_group1': [{",This and line 156 below adds coverage for the special case of localhost host_vars,py,0,0,1
"@@ -42,11 +42,12 @@ class TestProcessProxyOptions:
         assert self.p()
 
     def test_certs(self, tdata):
-        self.assert_noerr(
-            ""--cert"",
-            tdata.path(""mitmproxy/data/testkey.pem""))
-        with pytest.raises(Exception, match=""does not exist""):
-            self.p(""--cert"", ""nonexistent"")
+        with pytest.raises(Exception, match=""ambiguous option""):
+            self.assert_noerr(
+                ""--cert"",
+                tdata.path(""mitmproxy/data/testkey.pem""))
+            with pytest.raises(Exception, match=""does not exist""):
+                self.p(""--cert"", ""nonexistent"")
 
 
 class TestProxyServer:",Is this change intentional? The double-indented `.raises` doesn't make much sense to me.,py,1,1,1
"@@ -63,7 +63,7 @@ def configdata_init(monkeypatch):
 class TestEarlyInit:
 
     def test_config_py_path(self, args, init_patch, config_py_arg):
-        config_py_arg.write('c.colors.hints.bg = ""red""\n')
+        config_py_arg.write('config.load_autoconfig()\nc.colors.hints.bg = ""red""\n')
         configinit.early_init(args)
         expected = 'colors.hints.bg = red'
         assert config.instance.dump_userconfig() == expected",I'd prefer using `'\n'.join` here as well to make it a bit more readable (and consistent).,py,1,1,1
"@@ -44,9 +44,9 @@ class Model(object):
   def __init__(self, inferenceType):
     """""" Model constructor.
 
-    Args:
-      inferenceType: An opfutils.InferenceType value that specifies the type
+      @param inferenceType: An opfutils.InferenceType value that specifies the type
           of inference (i.e. TemporalNextStep, Classification, etc.).
+      @param header format of data going into the model, from nupic.data.file_record_stream.py
     """"""
     self._numPredictions = 0
     self.__inferenceType =  inferenceType",This function doesn't take a `header` parameter...,py,1,1,1
"@@ -29,6 +29,7 @@ class _ResourceEvent:
         self.request = request
 
     def __repr__(self):
+        # Not sure what proper conversion to fstring is
         return ""<{klass} action={action} uri={uri}>"".format(
             klass=self.__class__.__name__, **self.payload
         )",This is probably better to leave it with format(),py,1,1,1
"@@ -220,6 +220,12 @@ _options = [
             ""'plotting.sample_ratio' should be 1.0 >= value >= 0.0."",
         ),
     ),
+    Option(
+        key=""plotting.backend"",
+        doc=(""Backend to use for plotting. Default is matplotlib.""),
+        default=""matplotlib"",
+        types=str,
+    ),
 ]  # type: List[Option]
 
 _options_dict = dict(zip((option.key for option in _options), _options))  # type: Dict[str, Option]",Could you add a list of currently supported backends?,py,1,0,1
"@@ -193,7 +193,7 @@ class SparkSubmitTaskTest(unittest.TestCase):
         def interrupt():
             raise KeyboardInterrupt()
 
-        proc.return_value.poll = interrupt
+        proc.return_value.wait = interrupt
         try:
             job = TestSparkSubmitTask()
             job.run()",btw ideally we should use the mock library for this. but that's prob outside the scope of this PR,py,0,0,1
"@@ -582,7 +582,7 @@ public class DistributorTest {
         );
 
         Session firefoxSession = distributor.newSession(createRequest(firefoxPayload)).getSession();
-        LOG.info(String.format(""Firefox Session %d assigned to %s"", i, chromeSession.getUri()));
+        LOG.finer(String.format(""Firefox Session %d assigned to %s"", i, chromeSession.getUri()));
 
         boolean inFirefoxNodes = firefoxNodes.stream().anyMatch(node -> node.getUri().equals(firefoxSession.getUri()));
         boolean inChromeNodes = chromeNodes.stream().anyMatch(node -> node.getUri().equals(chromeSession.getUri()));","Since this is in a test, I imagine that the choice of `info` level was deliberate.",py,1,1,1
"@@ -3419,7 +3419,15 @@ class Elfcar(VolumetricData):
             poscar (Poscar): Poscar object containing structure.
             data: Actual data.
         """"""
-        super().__init__(poscar.structure, data)
+        # allow for poscar or structure files to be passed
+        if isinstance(poscar, Poscar):
+            tmp_struct = poscar.structure
+            self.poscar = poscar
+        elif isinstance(poscar, Structure):
+            tmp_struct = poscar
+            self.poscar = Poscar(poscar)
+
+        super().__init__(tmp_struct, data)
         # TODO: modify VolumetricData so that the correct keys can be used.
         # for ELF, instead of ""total"" and ""diff"" keys we have
         # ""Spin.up"" and ""Spin.down"" keys",Can you modify the docstring to reflect the fact that you can also pass a `Structure` ?,py,1,1,1
"@@ -167,7 +167,7 @@ class View(collections.abc.Sequence):
 
     def load(self, loader):
         loader.add_option(
-            ""view_filter"", typing.Optional[str], None,
+            ""view_filter"", typing.Optional[str], """",
             ""Limit the view to matching flows.""
         )
         loader.add_option(",Is there a reason why you changed the default?,py,1,1,1
"@@ -56,6 +56,19 @@ def setup_json_serializer(config):
     config.add_renderer(""json"", renderer)
 
 
+def setup_csp_headers(config):
+    """"""Content-Security-Policy HTTP response header helps reduce XSS risks on
+    modern browsers by declaring, which dynamic resources are allowed to load.
+    On APIs, we disable everything.
+    """"""
+    disable_all = ""default-src 'none'; "" ""frame-ancestors 'none'; "" ""base-uri 'none'; ""
+
+    def on_new_response(event):
+        event.response.headers.setdefault(""Content-Security-Policy"", disable_all)
+
+    config.add_subscriber(on_new_response, NewResponse)
+
+
 def setup_version_redirection(config):
     """"""Add a view which redirects to the current version of the API.
     """"""","Why not just `""default-src 'none'; frame-ancestors 'none'; base-uri 'none';""`? Why the trailing space in the string?",py,1,1,1
"@@ -6,6 +6,10 @@ from kinto.core.schema import (Any, HeaderField, QueryField, HeaderQuotedInteger
                                FieldList, TimeStamp, URL)
 from kinto.core.utils import native_value
 
+POSTGRESQL_MAX_INTEGER_VALUE = 2**64 / 2
+
+POSITIVE_BIG_INTEGER = colander.Range(min=0, max=POSTGRESQL_MAX_INTEGER_VALUE)
+
 
 class TimeStamp(TimeStamp):
     """"""This schema is deprecated, you shoud use `kinto.core.schema.TimeStamp` instead.""""""","In other parts of code we used lowercase for validators, but anything is fine, i guess.",py,1,1,1
"@@ -50,7 +50,9 @@ class SnakebiteHdfsClient(hdfs_abstract_client.HdfsFileSystem):
     def list_path(path):
         if isinstance(path, list) or isinstance(path, tuple):
             return path
-        if isinstance(path, str) or isinstance(path, unicode):
+        # TODO: Should this be:
+        # isinstance(path, (six.text_type, six.binary_type))?
+        if isinstance(path, six.string_types):
             return [path, ]
         return [str(path), ]
 ",Do you know the answer to the TODO @gpoulin ?,py,0,0,1
"@@ -10,6 +10,7 @@ from mmcv.utils import build_from_cfg
 
 from mmdet.core.evaluation.bbox_overlaps import bbox_overlaps
 from mmdet.datasets.builder import PIPELINES
+from .utils import create_random_bboxes
 
 
 def test_resize():","If relative import is adopted, is it impossible to run unit tests in the current folder?",py,1,1,1
"@@ -108,7 +108,11 @@ class NdWidget(param.Parameterized):
         super(NdWidget, self).__init__(**params)
         self.id = plot.comm.target if plot.comm else uuid.uuid4().hex
         self.plot = plot
-        self.dimensions, self.keys = drop_streams(plot.streams,
+        streams = []
+        for stream in plot.streams:
+            if any(k in plot.dimensions for k in stream.contents):
+                streams.append(stream)
+        self.dimensions, self.keys = drop_streams(streams,
                                                   plot.dimensions,
                                                   plot.keys)
 ",I assume this bit is simply a bug fix and otherwise unrelated?,py,0,0,1
"@@ -140,6 +140,7 @@ class HTTPFlow(flow.Flow):
     """"""
     request: HTTPRequest
     response: Optional[HTTPResponse] = None
+    trailers: http.Headers
     error: Optional[flow.Error] = None
     """"""
     Note that it's possible for a Flow to have both a response and an error",I suppose trailers are optional as well?,py,1,1,1
"@@ -660,7 +660,7 @@ class CaiTemporaryStore(object):
             return '/'.join(asset_pb.name.split('/')[:-4])
 
         elif (asset_pb.asset_type.startswith('google.appengine') or
-              asset_pb.asset_type.startswith('google.bigquery') or
+              asset_pb.asset_type.startswith('google.cloud.bigquery') or
               asset_pb.asset_type.startswith('google.spanner') or
               asset_pb.asset_type.startswith('google.cloud.kms')):
             # Strip off the last two segments of the name to get the parent",Minor nit: Can we make these alphabetical?,py,1,1,1
"@@ -49,7 +49,7 @@ class BuildTest(QuiltTestCase):
 
         # Verify cache contents
         srcpath = os.path.join(mydir, 'data/10KRows13Cols.csv')
-        path_hash = build._path_hash(srcpath, 'csv', {})
+        path_hash = build._path_hash(srcpath, 'csv',  {'parse_dates': ['Date0']})
         assert os.path.exists(teststore.cache_path(path_hash))
         
         # Build again using the cache",this works but it's super fragile; @kevinemoore can you get this info from build.yml? other unit tests will need the logic.,py,0,1,1
"@@ -236,6 +236,7 @@ class dim(object):
     # Unary operators
     def __neg__(self): return dim(self, operator.neg)
     def __not__(self): return dim(self, operator.not_)
+    def __invert__(self): return dim(self, operator.inv)
     def __pos__(self): return dim(self, operator.pos)
 
     # Binary operators",Thanks. Are there any other operators missing?,py,1,1,1
"@@ -152,4 +152,11 @@ class RPN(BaseDetector):
         Returns:
             np.ndarray: The image with bboxes drawn on it.
         """"""
+        if kwargs is not None:
+            if 'score_thr' in kwargs:
+                kwargs.pop('score_thr')
+            if 'text_color' in kwargs:
+                kwargs.pop('text_color')
+            if 'bbox_color' in kwargs:
+                kwargs['colors'] = kwargs.pop('bbox_color')
         mmcv.imshow_bboxes(data, result, top_k=top_k, **kwargs)","can we simply use kwargs.pop('score_thr', None) ?",py,1,1,1
"@@ -39,6 +39,7 @@ with open('README.rst') as fobj:
 install_requires = [
     'tornado>=4.0,<5',
     'python-daemon<3.0',
+    'toml',
 ]
 
 if os.environ.get('READTHEDOCS', None) == 'True':",No version specification?,py,1,0,1
"@@ -11,6 +11,13 @@ from .custom import CustomDataset
 
 @DATASETS.register_module()
 class XMLDataset(CustomDataset):
+    """"""XML dataset for detection.
+
+    Args:
+        min_size (int|float|None, optional): The minimum size of bounding
+            boxes in the images. If the size of a bounding box is less than
+            ``min_size``, it would be add to ignored field.
+    """"""
 
     def __init__(self, min_size=None, **kwargs):
         super(XMLDataset, self).__init__(**kwargs)","`int | float | None` or `int | float, optional`",py,1,0,0
"@@ -65,7 +65,7 @@ def safePow(a, b):
   if b is None: return None
   try:
     result = math.pow(a, b)
-  except ValueError:
+  except:
     return None
   return result
 ",Would be very nice if you can preserve this part.,py,1,0,1
"@@ -0,0 +1,6 @@
+from dagster import graph
+
+
+@graph
+def graph_one():
+    pass",Nitpick: include newline at end of file.,py,1,1,1
"@@ -368,7 +368,7 @@ class CenterNetHead(BaseDenseHead, BBoxTestMixin):
         if labels.numel() == 0:
             return bboxes, labels
 
-        out_bboxes, keep = batched_nms(bboxes[:, :4], bboxes[:, -1], labels,
+        out_bboxes, keep = batched_nms(bboxes[:, :4], bboxes[:, -1].contiguous(), labels,
                                        cfg.nms_cfg)
         out_labels = labels[keep]
 ","To be on the safe side, it is best to add contiguous to bboxes.",py,1,1,1
"@@ -45,7 +45,8 @@ public class Grid {
 
   public List<Node> getNodes() {
     return distributorStatus.get().getNodes().stream()
-      .map(summary -> new Node(summary.getNodeId(), summary.getUri(), summary.isUp(), summary.getMaxSessionCount()))
+      .map(summary -> new Node(summary.getNodeId(), summary.getUri(), summary.isUp(),
+                               summary.getMaxSessionCount(), summary.getStereotypes()))
       .collect(ImmutableList.toImmutableList());
   }
 ",Break things on to one parameter per line now.,py,1,1,1
"@@ -138,7 +138,18 @@ def _filter_outputs_by_handle(
     step_key = str(node_handle)
     output_found = False
     for step_output_handle, value in output_dict.items():
-        if (
+
+        # For the mapped output case, where step keys are in the format
+        # ""step_key[upstream_mapped_output_name]"" within the step output handle.
+        if step_output_handle.step_key.startswith(f""{step_key}[""):
+            output_found = True
+            key_start = step_output_handle.step_key.find(""["")
+            key_end = step_output_handle.step_key.find(""]"")
+            upstream_mapped_output_name = step_output_handle.step_key[key_start + 1 : key_end]
+            mapped_outputs[upstream_mapped_output_name] = value
+
+        # For all other cases, search for exact match.
+        elif (
             step_key == step_output_handle.step_key
             and step_output_handle.output_name == output_name
         ):","I know not exactly inside the scope of this PR, but looked at the type annotation while trying to grok it - could we change it from `Any` to `Dict[str, Any]`?",py,0,1,1
"@@ -7,5 +7,5 @@ Workflow mgmgt + task scheduling + dependency resolution.
 __author__ = 'The Luigi Authors'
 __contact__ = 'https://github.com/spotify/luigi'
 __license__ = 'Apache License 2.0'
-__version__ = '2.8.13'
+__version__ = '3.0.0b2'
 __status__ = 'Production'",@honnix shouldn't we change version here prior to merge?,py,0,1,1
"@@ -1,10 +1,13 @@
 import logging
 import sqlalchemy
 import uuid
+import json
 
 from datetime import datetime
 from listenbrainz import db
 from listenbrainz.db.exceptions import DatabaseException
+from data.model.similar_user_model import SimilarUserRecord, SimilarUsers
+from typing import Tuple, List
 
 
 logger = logging.getLogger(__name__)",lets try to use ujson for speed,py,1,1,1
"@@ -46,7 +46,6 @@ CONSOLE_COLORS_TO_RGB=( #http://en.wikipedia.org/wiki/Color_Graphics_Adapter
 COMMON_LVB_UNDERSCORE=0x8000
 
 
-
 @wincon.PHANDLER_ROUTINE
 def _consoleCtrlHandler(event):
 	if event in (wincon.CTRL_C_EVENT,wincon.CTRL_BREAK_EVENT):",Looks like removing this blank line is the only change in this file. This change can probably be removed.,py,1,1,1
"@@ -428,7 +428,9 @@ SEQUENCE_TYPES = {
 }
 
 
-def _emit_no_member(node, owner, owner_name, ignored_mixins=True, ignored_none=True):
+def _emit_no_member(
+    node, owner, owner_name, ignored_mixins, ignored_none, mixin_class_rgx
+):
     """"""Try to see if no-member should be emitted for the given owner.
 
     The following cases are ignored:",Why are the default values gone away?,py,1,1,1
"@@ -0,0 +1,6 @@
+from .utils import verify_model
+
+
+__all__ = [
+    'verify_model'
+]",No need to design `test_onnx` as python package.,py,0,0,1
"@@ -154,6 +154,7 @@ class CompletionModel(QAbstractItemModel):
         """"""Override QAbstractItemModel::columnCount.""""""
         # pylint: disable=unused-argument
         return 3
+        # pylint: enable=unused-argument
 
     def canFetchMore(self, parent):
         """"""Override to forward the call to the categories.""""""","No need for this, as pylint already only turns things off for this function and it's needed for the entire function.",py,1,1,1
"@@ -90,8 +90,8 @@ class PipelineBuilder(object):
                 else:
                     api = api_class(self.global_configs,
                                     version=api_version)
-            except api_errors.ApiExecutionError as e:
-                LOGGER.error('Failed to execute API %s, v=%s\n%s',
+            except api_errors.ApiInitializationError as e:
+                LOGGER.error('Failed to initialize API %s, v=%s\n%s',
                              api_class_name, api_version, e)
                 raise api_errors.ApiInitializationError(e)
 ","This can just be the following, since you are re-raising the same exception now: raise",py,1,1,1
"@@ -23,7 +23,8 @@ def main(args=None):
 
     parser = argparse.ArgumentParser(description=""Kinto Command-Line ""
                                                  ""Interface"")
-    commands = ('init', 'start', 'migrate', 'delete-collection', 'version')
+    commands = ('init', 'start', 'migrate', 'delete-collection', 'version',
+                'rebuild-quotas')
     subparsers = parser.add_subparsers(title='subcommands',
                                        description='Main Kinto CLI commands',
                                        dest='subcommand',",nitpick: we could add `rebuild-quotas` only if plugin is included?,py,1,1,1
"@@ -1,12 +1,14 @@
 # -*- coding: UTF-8 -*-
-#globalCommands.py
-#A part of NonVisual Desktop Access (NVDA)
-#This file is covered by the GNU General Public License.
-#See the file COPYING for more details.
-#Copyright (C) 2006-2018 NV Access Limited, Peter Vágner, Aleksey Sadovoy, Rui Batista, Joseph Lee, Leonard de Ruijter, Derek Riemer, Babbage B.V., Davy Kager, Ethan Holliger, Łukasz Golonka
+# globalCommands.py
+# A part of NonVisual Desktop Access (NVDA)
+# This file is covered by the GNU General Public License.
+# See the file COPYING for more details.
+# Copyright (C) 2006-2020 NV Access Limited, Peter Vágner, Aleksey Sadovoy, Rui Batista, Joseph Lee, Leonard de Ruijter, Derek Riemer, Babbage B.V., Davy Kager, Ethan Holliger, Łukasz Golonka, Accessolutions, Julien Cochuyt  # noqa: E501 line too long
 
 import time
 import itertools
+from typing import Optional
+
 import tones
 import audioDucking
 import touchHandler",Why not split the line?,py,1,0,1
"@@ -26,6 +26,9 @@ class StatsAPITestCase(IntegrationTestCase):
         sent_count = payload['count']
         received_count = data['count']
         self.assertEqual(sent_count, received_count)
+        sent_total_count = payload['count']
+        received_total_count = data['total_count']
+        self.assertEqual(sent_total_count, received_total_count)
         sent_artist_list = payload['all_time']['artists']
         received_artist_list = data['artists']
         self.assertListEqual(sent_artist_list, received_artist_list)",`total_count` is not obvious. Can we make the name more explicit? `total_artist_count`,py,1,1,1
"@@ -41,7 +41,7 @@ install_requires = [
     # https://pagure.io/python-daemon/issue/18
     'python-daemon<2.2.0',
     'python-dateutil==2.7.5',
-    'enum34>1.1.0;python_version<""3.4""',
+    'enum34>1.1.0;python_version<""3.4""'
 ]
 
 if os.environ.get('READTHEDOCS', None) == 'True':",trailing commas in Python lists are valid. Are you saying pip has a problem with this?,py,1,1,1
"@@ -2,16 +2,17 @@ import types
 import logging
 import traceback
 from moto.s3 import models as s3_models, responses as s3_responses, exceptions as s3_exceptions
-from moto.s3.responses import minidom, MalformedXML, undo_clean_key_name, is_delete_keys
+from moto.s3.responses import (minidom, MalformedXML, undo_clean_key_name, is_delete_keys)
 from moto.s3.exceptions import S3ClientError
 from moto.s3bucket_path import utils as s3bucket_path_utils
 from localstack import config
 from localstack.utils.aws import aws_stack
-from localstack.services.s3 import s3_listener
+from localstack.services.s3 import s3_listener, s3_utils
 from localstack.utils.server import multiserver
 from localstack.utils.common import wait_for_port_open, get_free_tcp_port
 from localstack.services.infra import start_moto_server
 from localstack.services.awslambda.lambda_api import BUCKET_MARKER_LOCAL
+from urllib.parse import urlparse
 
 LOG = logging.getLogger(__name__)
 ",nit: braces could be removed,py,1,1,1
"@@ -15,12 +15,14 @@
 """"""Base GCP client which uses the discovery API.""""""
 import logging
 import threading
+import httplib2
+from retrying import retry
+
 import googleapiclient
+
 from googleapiclient import discovery
-import httplib2
 from oauth2client import client
 from ratelimiter import RateLimiter
-from retrying import retry
 
 from google.cloud import forseti as forseti_security
 from google.cloud.forseti.common.gcp_api import _supported_apis",Please alpha sort these.,py,1,1,1
"@@ -1,17 +1,15 @@
 import inspect
 from functools import update_wrapper
-from typing import TYPE_CHECKING, Callable, Generator, List, Optional, Union
+from typing import TYPE_CHECKING, Callable, Generator, List, Optional, Sequence, Union
 
 from dagster import check
 from dagster.core.definitions.sensor import RunRequest, SensorDefinition, SkipReason
 from dagster.core.errors import DagsterInvariantViolationError
 
-from ....seven import funcsigs
-from ...decorator_utils import get_function_params
 from ...errors import DagsterInvariantViolationError
 from ..events import AssetKey
 from ..graph import GraphDefinition
-from ..pipeline import PipelineDefinition
+from ..job import JobDefinition
 from ..sensor import AssetSensorDefinition, RunRequest, SensorDefinition, SkipReason
 
 if TYPE_CHECKING:",should we asspire to remove `job` if we have `jobs` ? both isnt the worst i guess,py,1,1,1
"@@ -124,10 +124,10 @@ class TypingChecker(BaseChecker):
                 ""type"": ""yn"",
                 ""metavar"": ""<y_or_n>"",
                 ""help"": (
-                    ""Set to ``no`` if the app / libary does NOT need to ""
-                    ""support runtime introspection of type ""
-                    ""annotations. Only applies to Python version ""
-                    ""3.7 - 3.9""
+                    ""Set to ``no`` if the app / library does NOT need to ""
+                    ""support runtime introspection of type annotations. ""
+                    ""Only change it if you understand what that means. ""
+                    ""Applies to Python version 3.7 - 3.9""
                 ),
             },
         ),","Could we explain ""what that means"" or link to the doc that explains it here ? :)",py,1,1,1
"@@ -80,7 +80,11 @@ kwargs = delimitedList(kwarg)
 
 
 def setRaw(s, loc, toks):
-    toks[0].raw = s[toks[0].start:toks[0].end]
+    try:
+        toks[0]['raw'] = s[toks[0].start:toks[0].end]
+    except AttributeError:
+        # Accommodate version < 3 of the PyParsing API.
+        toks[0].raw = s[toks[0].start:toks[0].end]
 
 
 call = Group(","The code you have in the try-block should be compatible with pyparsing pre-3.0 and post-3.0. It's the code in the except block that only works in pyparsing pre 3.0. I don't think the code in the try block will *ever* raise `AttributeError`, in either version of pyparsing.",py,1,1,1
"@@ -97,10 +97,13 @@ class AdminDirectoryClient(_base_client.BaseClient):
         request = members_stub.list(groupKey=group_key,
                                     maxResults=FLAGS.max_results_admin_api)
 
-        results = self._build_paged_result(
+        paged_results = self._build_paged_result(
             request, members_stub, self.rate_limiter)
 
-        return [item.get('members', []) for item in results]
+        group_members = []
+        for page in paged_results:
+            group_members.extend(page.get('members', []))
+        return group_members
 
 
     def get_groups(self, customer_id='my_customer'):","If you're up for fixing this once, if not just open an issue, but we should write another helper method to un-bundle the results of a paged request. It'd accept just one argument, the string of the key and do what you're doing on lines 103-106",py,1,1,1
"@@ -1614,7 +1614,7 @@ class CloudSqlInstanceIterator(resource_iter_class_factory(
         api_method_name='iter_cloudsql_instances',
         resource_name='cloudsql_instance',
         api_method_arg_key='projectNumber',
-        resource_validation_method_name='cloudsql_api_enabled')):
+        resource_validation_method_name='enumerable')):
     """"""The Resource iterator implementation for CloudSQL Instance.""""""
 
 ",Please also remove the cloudsql_api_enabled function at line 734.,py,0,1,1
"@@ -0,0 +1,17 @@
+class InboxController < ApplicationController
+  include Mandrill::Rails::WebHookProcessor
+
+  def handle_inbound(event_payload)
+    handler = IncomingMail::Handler.new
+    resp = handler.handle(event_payload)
+    Rails.logger.warn(resp.inspect)
+    if resp.action == IncomingMail::Response::ERROR
+      # TODO do we want mandrill to keep trying on our error?
+      head 500
+    elsif resp.action == IncomingMail::Response::DROPPED
+      head 204 # TODO does mandrill treat this like 200?
+    else
+      head 200 # default tells mandrill to stop trying to send the event
+    end
+  end
+end",is there an error tracking system we can use to log this with?,rb,1,1,1
"@@ -239,7 +239,14 @@ module Travis
 
           def stop_postgresql
             sh.echo ""PostgreSQL package is detected. Stopping postgresql service. See https://github.com/travis-ci/travis-ci/issues/5737 for more information."", ansi: :yellow
-            sh.cmd ""sudo service postgresql stop"", echo: true
+            command = <<~ENDOFBASH
+              if [[ ""$TRAVIS_INIT"" = systemd ]]; then
+                sudo systemctl stop postgresql
+              else
+                sudo service postgresql stop
+              fi
+            ENDOFBASH
+            sh.cmd command, echo: true
           end
       end
     end",`==` for equality check please!,rb,1,1,0
"@@ -0,0 +1,9 @@
+<% if @subscription_coupon.valid? %>
+  $("".totalprice"").html('<%= t(""subscriptions.discount.#{@subscription_coupon.duration}"", final_price: @subscription_coupon.apply(@purchase.price), full_price: @purchase.price, duration_in_months: @subscription_coupon.duration_in_months) %>');
+  $("".coupon .error"").hide();
+  $(""#total a"").hide();
+  $("".coupon"").hide();
+  $(""#purchase_stripe_coupon_id"").val(""<%= @subscription_coupon.code %>"");
+<% else %>
+  $("".coupon .error"").show();
+<% end %>","I'd vote that new js be written in coffeescript instead, with us converting the old stuff when we happen to touch it.",rb,1,1,1
"@@ -438,7 +438,7 @@ module Beaker
           @logger.trace result.stdout
         end
       else # a directory with ignores
-        dir_source = Dir.glob(""#{source}/**/*"").reject do |f|
+        dir_source = Dir.glob(""#{source}/**/{*,.*}"").reject do |f|
           f.gsub(/\A#{Regexp.escape(source)}/, '') =~ ignore_re #only match against subdirs, not full path
         end
         @logger.trace ""After rejecting ignored files/dirs, going to scp [#{dir_source.join("", "")}]""",Can you update this PR with tests for this?,rb,0,1,1
"@@ -5,7 +5,7 @@
         <th><%= _('Organisation') %>&nbsp;<%= paginable_sort_link('orgs.name') %></th>
         <th><%= _('Administrator Email') %>&nbsp;<%= paginable_sort_link('orgs.contact_email') %></th>
         <th><%= _('Organisation Type(s)') %>&nbsp;<%= paginable_sort_link('orgs.org_type') %></th>
-        <th><%= _('Templates') %>&nbsp;<%= paginable_sort_link('orgs.updated_at') %></th>
+        <th><%= _('Templates') %></th>
         <th class=""sorter-false""><span aria-hidden=""false"" class=""sr-only""><%= _('Actions') %></span></th>
       </tr>
     </thead>",good you removed this sortable field. Sorting by updated_at when the field name was Templates seems odd,rb,1,1,1
"@@ -230,11 +230,10 @@ MESSAGE
           def dartfmt
             args = task[:dartfmt]
 
-            if args.is_a?(String)
-              sh.echo ""dartfmt arguments aren't supported."", ansi: :red
-            end
-
-            sh.if package_direct_dependency?('dart_style'), raw: true do
+            # If specified `-dartfmt: custom` and there is a dependency on `dart_style` we
+            # will use the custom (pinned) version of dart_style to run formatting checks
+            # instead of the SDK.
+            sh.if args == 'custom' and package_direct_dependency?('dart_style'), raw: true do
               sh.raw 'function dartfmt() { pub run dart_style:format ""$@""; }'
             end
 ",Uh...wouldn't `custom` be passed to the args here?,rb,1,1,1
"@@ -28,10 +28,11 @@ Puppet::Functions.create_function(:run_task) do
   end
 
   def run_task(task_name, targets, task_args = nil)
+    task_args ||= {}
     r = Bolt::ExecutionResult.from_bolt(
       run_task_raw(task_name, targets, task_args)
     )
-    if !r.ok && task_args && task_args['_abort'] != false
+    if !r.ok && !task_args['_catch_errors']
       raise Bolt::RunFailure.new(r, 'run_task', task_name)
     end
     r",task_args could still be nil.,rb,1,1,1
"@@ -131,7 +131,7 @@ public class DriverCommandExecutor extends HttpCommandExecutor implements Closea
         Thread.currentThread().interrupt();
         throw new WebDriverException(""Timed out waiting for driver server to stop."", e);
       } finally {
-        executorService.shutdownNow();
+        executorService.shutdown();
       }
 
     } else {","For the command executor, which in turn, uses the HTTP client to talk to the WebDriver, the client might have high-timeout values set, so the shutdown can take a long time if we wait for it to complete, especially if multiple-long running threads are there. I think it might be a good idea in general to couple the shutdown() with `awaitTermination()` with a timeout, if the ongoing tasks do not complete within that timeout then call `shutdownNow()`. What do you think?",rb,1,1,0
"@@ -19,6 +19,12 @@ module Travis
           super
           if version == 'nightly'
             install_python_nightly
+            return
+          end
+
+          sh.if ""! -f #{virtualenv_activate}"" do
+            sh.echo ""#{version} is not installed; attempting download"", ansi: :yellow
+            install_python_archive( version )
           end
         end
 ",why not just change this line to `install_python_archive('nightly')` and remove the nightly method?,rb,1,1,1
"@@ -18,4 +18,9 @@
   .trail-titles li.<%= topic.slug.parameterize %> {
     border-color: <%= topic.color %>;
   }
+
+  .trail.<%= topic.slug.parameterize %> .topic-label {
+    background: <%= topic.color %>;
+    color: <%= topic.color_accent %>;
+  }
 <% end %>","Just noticed that this seems to be just CSS and not SASS. It shouldn't be done as part of this pull request, but do we want to support SASS in here? The nesting is a little prettier and we currently can't use Bourbon mixins or anything.",rb,1,1,1
"@@ -1,3 +1,4 @@
+# -*- coding: utf-8 -*-
 require 'resolv'
 require 'inifile'
 require 'timeout'",Is this something we need to be adding to all the Beaker source files?,rb,1,1,1
"@@ -35,13 +35,13 @@ public class BaseSuite {
   public static ExternalResource testEnvironment = new ExternalResource() {
     @Override
     protected void before() {
-      log.info(""Preparing test environment"");
+      log.finest(""Preparing test environment"");
       GlobalTestEnvironment.get(SeleniumTestEnvironment.class);
       System.setProperty(""webdriver.remote.shorten_log_messages"", ""true"");
     }
     @Override
     protected void after() {
-      log.info(""Cleaning test environment"");
+      log.finest(""Cleaning test environment"");
       TestEnvironment environment = GlobalTestEnvironment.get();
       if (environment != null) {
         environment.stop();",This is in test code: understanding what we're doing is important in this context.,rb,1,0,1
"@@ -10,7 +10,7 @@ class Duplicate < ActiveRecord::Base
   validates :comment, length: { maximum: 1000 }, allow_blank: true
 
   def resolve!(editor_account)
-    good_project.editor_account = bad_project.editor_account = editor_account
+    @editor_account = good_project.editor_account = bad_project.editor_account = editor_account
     Duplicate.transaction { RESOLVES.each { |r| send(""resolve_#{r}!"") } }
   end
 ",Do we even need to set `good_project.editor_account` and `bad_project.editor_account`? I can't see that they are used any longer. Do they need to be set for something else?,rb,1,1,1
"@@ -11,10 +11,14 @@ describe Bolt::WinRM do
 
   let(:host) { ENV['BOLT_WINRM_HOST'] || 'localhost' }
   let(:port) { ENV['BOLT_WINRM_PORT'] || 55985 }
+  let(:ssl_port) { ENV['BOLT_WINRM_SSL_PORT'] || 55986 }
   let(:user) { ENV['BOLT_WINRM_USER'] || ""vagrant"" }
   let(:password) { ENV['BOLT_WINRM_PASSWORD'] || ""vagrant"" }
   let(:command) { ""echo $env:UserName"" }
-  let(:winrm) { Bolt::WinRM.new(host, port, user, password) }
+  let(:config) { Bolt::Config.new(transports: { winrm: { insecure: true } }) }
+  let(:ssl_config) { Bolt::Config.new(transports: { winrm: { ca_cert: 'resources/cert.pem' } }) }
+  let(:winrm) { Bolt::WinRM.new(host, port, user, password, config: config) }
+  let(:winrm_ssl) { Bolt::WinRM.new(host, ssl_port, user, password, config: ssl_config) }
   let(:echo_script) { <<PS }
 foreach ($i in $args)
 {",I guess this is an automatic mapping (i.e. I don't see the `Vagrantfile` updated to map 5986 to 55986)?,rb,1,1,1
"@@ -11,11 +11,15 @@ feature 'Account Settings' do
 
   scenario 'user views paid purchases' do
     user = create(:user)
-    create_list(:paid_purchase, 3, user: user)
+    create_list(:paid_purchase, 4, user: user, created_at: 6.minutes.ago)
+    purchase_two = create(:paid_purchase, user: user, created_at: 5.minutes.ago)
+    purchase_one = create(:paid_purchase, user: user, created_at: 1.minutes.ago)
 
     visit edit_my_account_path(as: user)
 
     expect_to_see_my_paid_purchases(user)
+    expect(purchase_one.purchaseable_name).
+      to appear_before(purchase_two.purchaseable_name)
   end
 
   scenario 'user with no purchases' do","Place the . on the next line, together with the method name.",rb,1,1,1
"@@ -1,12 +1,8 @@
 <% org = template.org.abbreviation.present? ? template.org.abbreviation : template.org.name %>
-<% if example_answer.present? || guidance.present? %>
+<% if guidance.present? %>
   <dl<%= for_plan ? ' class=""dl-horizontal""' : '' %>>
-    <% if example_answer.present? %>
-      <dt><%= _('Example answer') %></dt>
-      <dd><%= raw example_answer.text %><dd>
-    <% end %>
     <% if guidance.present? %>
-      <dt><%= _('Guidance') %></dt>
+      <dt><%= template.customization_of.nil? ? _('Guidance') : _('%{org} Guidance') % { org: guidance.org.short_name } %></dt>
       <dd><%= raw guidance.text %></dd>
     <% end %>
   </dl>",this if is no longer needed,rb,1,0,1
"@@ -0,0 +1,7 @@
+<script type=""text/javascript"">
+  analytics.track('Purchased',
+    <%= raw purchased_hash(purchase_amount, purchase_name).to_json %>
+  );
+</script>
+
+<%= render 'conversions/adwords', purchase_amount: purchase_amount %>",Does Segment.io not handle Google Adwords conversions?,rb,1,1,1
"@@ -0,0 +1,13 @@
+# frozen_string_literal: true
+
+require_relative '../../test_helper'
+
+class TestDeprecateSpace < Test::Unit::TestCase
+  def setup
+    @tester = Faker::Space
+  end
+
+  def launch_vehicule
+    assert @tester.character.match(/\w+/)
+  end
+end",copy and   it should be `@tester.launch_vehicule.match` :),rb,1,0,0
"@@ -28,7 +28,17 @@ class Dispatcher
   end
 
   def requires_approval_notice?(approval)
-    true
+    if approval.cart.getProp('origin') == 'ncr'
+      self.with_approval_notice_requirements { approval.is_final_approval? }
+    else
+      true
+    end
+  end
+
+  def with_approval_notice_requirements &requirements
+    if block_given?
+      requirements.call
+    end
   end
 
   def self.initialize_dispatcher(cart)","This could turn into a rules block that we pull out of here, potentially covering all of the different clients and addressing other client-specific functions",rb,1,1,1
"@@ -70,7 +70,7 @@ public class NodeOptions {
       Capabilities caps = info.getCanonicalCapabilities();
       builders.stream()
           .filter(builder -> builder.score(caps) > 0)
-          .peek(builder -> LOG.info(String.format(""Adding %s %d times"", caps, info.getMaximumSimultaneousSessions())))
+          .peek(builder -> LOG.finest(String.format(""Adding %s %d times"", caps, info.getMaximumSimultaneousSessions())))
           .forEach(builder -> {
             DriverService.Builder freePortBuilder = builder.usingAnyFreePort();
 ",This is an informational message that allows someone to read the console output and understand how the grid node is configured. Please leave.,rb,1,1,1
"@@ -1,7 +1,7 @@
 class Trail < ActiveRecord::Base
   extend FriendlyId
 
-  validates :name, presence: true
+  validates :name, :description, presence: true
 
   has_many :steps, dependent: :destroy
   has_many :exercises, through: :steps","If we add this validation, we also probably want a migration which sets a value for existing trails. Otherwise, all existing trails will become invalid.",rb,1,1,1
"@@ -15,6 +15,10 @@ describe Bolt::SSH do
   let(:port) { 2224 }
   let(:command) { ""pwd"" }
   let(:ssh) { Bolt::SSH.new(hostname, port, user, password) }
+  let(:key) {
+    { config: Bolt::Config.new(key: Dir["".vagrant/**/private_key""],
+                               insecure: true) }
+  }
   let(:insecure) { { config: Bolt::Config.new(insecure: true) } }
   let(:echo_script) { <<BASH }
 for var in ""$@""","It looks like this depends on an external file, so probably won't work for anyone else? Note we don't run tests marked with `vagrant: true` in appveyor or travis, but only when running `bundle exec rake test`.",rb,1,1,1
"@@ -83,7 +83,7 @@ module Bolt
           raise Bolt::Error.unknown_task(task_name) unless tasksig
 
           Bolt::Task::Run.validate_params(tasksig, params) if params
-          Bolt::Task.new(tasksig.task_hash)
+          Bolt::Task.from_task_signature(tasksig)
         end
       end
 ",Do we still need this line (or function) with these changes?,rb,1,1,1
"@@ -25,3 +25,4 @@ class ChromeRemoteConnection(RemoteConnection):
         self._commands[""launchApp""] = ('POST', '/session/$sessionId/chromium/launch_app')
         self._commands[""setNetworkConditions""] = ('POST', '/session/$sessionId/chromium/network_conditions')
         self._commands[""getNetworkConditions""] = ('GET', '/session/$sessionId/chromium/network_conditions')
+        self._commands['ExecuteCDP'] = ('POST', '/session/$sessionId/goog/cdp/execute')",Should this be camelCase to match the above commands? I am not the expert here so maybe Lucas or David can chime in.,rb,0,1,1
"@@ -115,7 +115,8 @@ module.exports = function exec(command, opt_options) {
 
   var proc = childProcess.spawn(command, options.args || [], {
     env: options.env || process.env,
-    stdio: options.stdio || 'ignore'
+    stdio: options.stdio || 'ignore',
+    detached: true
   });
 
   // This process should not wait on the spawned child, however, we do","You're welcome to surface this option through the API, but I'm not going to make this the default behavior.",rb,1,1,1
"@@ -0,0 +1,19 @@
+class NameUnnamedRedactions < ActiveRecord::Migration[5.0]
+  def self.up
+    Redaction.find_each do |redaction|
+        if redaction.title.empty?
+            redaction.title = redaction.id.to_s
+            redaction.save!
+        end
+    end
+  end
+
+  def self.down
+    Redaction.find_each do |redaction|
+        if redaction.title.eql? redaction.id.to_s
+            redaction.title = """"
+            redaction.save!
+        end
+    end
+  end
+end",Indentation should be the standard two spaces please.,rb,1,1,1
"@@ -0,0 +1,19 @@
+<% reports.each do |report| %>
+  <div class=""reports"">
+    <div style=""float:left"">
+      <%= link_to user_thumbnail(report.user), :controller => :user, :action =>:view, :display_name => report.user.display_name %>
+    </div>
+    <%= t("".reported_by_html"", :user_name => report.user.display_name, :user_url => url_for(:controller => :user, :action => :view, :display_name => report.user.display_name)) %> <br/>
+    <span class=""deemphasize"">
+      <%= t("".updated_at"", :datetime => l(report.updated_at.to_datetime, :format => :friendly)) %>
+    </span>
+    <br/>
+    <span class=""deemphasize"">
+      <%= t "".category"", category: report.category %>
+    </span>
+    <br/>
+    <%= report.details %>
+    <br/>
+  </div>
+  <hr>
+<% end %>","As this is inside the loop, and hence only contains one report, this seems like the wrong class name to use?",rb,1,1,1
"@@ -3,12 +3,12 @@ module Subscriber
     before_filter :authorize
 
     def index
-      @invoices = SubscriptionInvoice.
+      @invoices = Invoice.
         find_all_by_stripe_customer_id(current_user.stripe_customer_id)
     end
 
     def show
-      @invoice = SubscriptionInvoice.new(params[:id])
+      @invoice = Invoice.new(params[:id])
       ensure_invoice_belongs_to_user
     end
 ","Place the . on the next line, together with the method name.",rb,1,1,1
"@@ -153,6 +153,11 @@ module Faker
         regexify(/IT\d{2,4}\/\d{2,10}/)
       end
 
+      # Get a random Russian tax number.
+      def russian_tax_number(region: nil, type: :legal)
+        inn_number(region, type)
+      end
+
       private
 
       # Mod11 functionality from https://github.com/badmanski/mod11/blob/master/lib/mod11.rb",I think we could add a formatted/unformatted keyword parameter for this method. What do you think?,rb,1,1,1
"@@ -48,6 +48,10 @@ module RSpec::Core
           options[:libs] << dir
         end
 
+        parser.on('-i') do
+          raise OptionParser::InvalidOption.new
+        end
+
         parser.on('-r', '--require PATH', 'Require a file.') do |path|
           options[:requires] ||= []
           options[:requires] << path","In @fj's example he had put `--I`. I'm curious why you put `-i` here? Actually, I think maybe both should raise an error.",rb,0,1,1
"@@ -0,0 +1,19 @@
+<% modifiable = !template.customization_of.present? && template.id.present? && (template.org_id = current_user.org.id) %>
+<% details_path = modifiable ? edit_org_admin_template_path(template.id) : template.id.present? ? org_admin_template_path(template.id) : org_admin_templates_path %>
+<ul class=""nav nav-tabs"" role=""tablist"">
+  <li role=""presentation"" <%= isActivePage(details_path) ? ' class=active' : '' %>>
+    <%= link_to(_('Template details'), details_path, { 'aria-controls': 'show_template', role: 'tab' }) %>
+  </li>
+  <% template.phases.each do |phase| %>
+    <% phase_path = phase.modifiable? ? edit_org_admin_template_phase_path(template.id, phase.id) : org_admin_template_phase_path(template.id, phase.id) %>
+    <li role=""presentation"" <%= isActivePage(phase_path) ? ' class=active' : '' %>>
+      <%= link_to(phase.title, phase_path, { 'aria-controls': ""#{phase.id}"", role: 'tab' }) %>
+    </li>
+  <% end %>
+  <!-- Add another phase button -->
+  <% if modifiable %>
+    <li role=""presentation"" <%= isActivePage(new_org_admin_template_phase_path(template.id)) ? ' class=active' : '' %>>
+      <%= link_to(_('Add new phase'), new_org_admin_template_phase_path(template.id), { 'aria-controls': 'add_phase', role: 'tab' }) %>
+    </li>
+  <% end %>
+</ul>",why don't we add modifiable? method into template model instead?,rb,1,1,1
"@@ -1,4 +1,5 @@
 require 'spec_helper'
+require 'pp'
 
 class ClassMixedWithDSLHelpers
   include Beaker::DSL::Helpers",Doesn't look like you're actually using this anywhere?,rb,0,0,0
"@@ -76,12 +76,13 @@ class ApplicationController < ActionController::Base
 
   def authenticate_user!
     if not_signed_in?
-      flash[:error] = 'You need to sign in for access to this page.'
+      flash[:error] = ""You need to sign in for access to this page.""
       return_to_param = make_return_to(""Previous"", request.fullpath)
       session[:return_to] = return_to_param
       redirect_to root_url(return_to: return_to_param)
-    elsif session[:return_to]
-      session.delete(:return_to)
+    elsif current_user.inactivated?
+      redirect_to root_url
+      flash[:error] = ""You are not allowed to login because your account has been inactivated. Please <a href='/feedback'>contact an administrator</a>.""
     end
   end
 ",@pkarman I removed this because I wasn't sure why it was here - thoughts? Happy to re-introduce and write a test for it if we need it :),rb,0,0,1
"@@ -0,0 +1,18 @@
+RSpec::Support.require_rspec_core ""formatters/base_formatter""
+
+module RSpec
+  module Core
+    module Formatters
+      # @private
+      class CFormatter < BaseFormatter
+        Formatters.register self, :example_failed, :dump_profile
+
+        def example_failed(failure)
+          output.puts ""#{failure.example.location}:#{failure.example.description}""
+        end
+
+        def dump_profile(_profile); end
+      end
+    end
+  end
+end",You don't need to do this if you don't register `dump_profile`,rb,1,1,1
"@@ -601,7 +601,8 @@ module Travis
           when 'bioc-devel'
             config[:bioc_required] = true
             config[:bioc_use_devel] = true
-            normalized_r_version('devel')
+            config[:r] = 'release'
+            normalized_r_version
           when 'bioc-release'
             config[:bioc_required] = true
             config[:bioc_use_devel] = false",Is there a reason you aren't using `normalized_r_version('release')`?,rb,1,1,1
"@@ -35,7 +35,13 @@ describe AuthHashService, '#find_or_create_user_from_auth_hash' do
   end
 
   context 'with an existing user' do
-    it 'finds the user' do
+    it ""finds the user by email"" do
+      existing_user = create(:user, email: auth_hash[""info""][""email""])
+
+      expect(existing_user).to eq AuthHashService.new(auth_hash).find_or_create_user_from_auth_hash
+    end
+
+    it ""finds the user by auth_provider and auth_uid"" do
       existing_user = create(:user, auth_provider: 'github', auth_uid: 1)
 
       expect(existing_user).to eq AuthHashService.new(auth_hash).find_or_create_user_from_auth_hash",Line is too long. [99/80],rb,1,1,1
"@@ -93,7 +93,7 @@ public class Docker {
       throw new WebDriverException(""Unable to pull container: "" + name);
     }
 
-    LOG.info(String.format(""Pull of %s:%s complete"", name, tag));
+    LOG.fine(String.format(""Pull of %s:%s complete"", name, tag));
 
     return findImage(new ImageNamePredicate(name, tag))
         .orElseThrow(() -> new DockerException(",Waiting for the pull takes a long time. This message informs the user that at least one of the images being pulled is available. Please leave.,rb,1,1,1
"@@ -11,6 +11,13 @@ class Post < ActiveRecord::Base
 
   scope :by_newest, -> { order('posts.created_at desc') }
   scope :by_unanswered, -> { joins(:topic).where(topics: { posts_count: 1 }).by_newest }
+  # DISTINCT ON is a Postgres extension to the SQL standard so it won't work on other databases.
+  scope :most_recent, lambda {
+    joins(""INNER JOIN (
+            SELECT DISTINCT ON (topic_id) topic_id, id FROM posts ORDER BY topic_id, created_at DESC
+          ) most_recent ON (most_recent.id=posts.id)"")
+  }
+  scope :open_topics, -> { joins(:topic).where(topics: { closed: false }).by_newest }
 
   def body=(value)
     super(value ? value.fix_encoding_if_invalid!.strip_tags.strip : nil)",How about renaming it to `open_topics`?,rb,1,1,1
"@@ -44,6 +44,11 @@ module RSpec
         end
         self
       end
+
+      def clear
+        @values.clear
+        self
+      end
     end
   end
 end",Mind adding a spec to `set_spec.rb` for this?,rb,1,1,1
"@@ -31,8 +31,7 @@ module LinkAccessors
           cleaned_uri = String.clean_url(uri)
           cached_uri = send cache_method
           return if !cached_uri.nil? && cleaned_uri == cached_uri
-          update_link_uri(accessor, links.of_category(Link::CATEGORIES[link_category]).first_or_initialize,
-                          cleaned_uri, link_category.to_s)
+          update_link_uri(accessor, obtain_link(link_category), cleaned_uri, link_category.to_s)
         end
       end
     end","using ""links....first_or_initialize"" is adding the link to the project.links now. We don't want that as it is possible that the setting of the uri to '' is used to delete the link from the array (or never create it in the first place on projects#create). We need to break that out into the method below.",rb,1,1,1
"@@ -34,6 +34,7 @@
 #  image_content_type  :string
 #  auth_provider       :string
 #  home_tile           :integer
+#  tou_agreed          :datetime
 #
 # Indexes
 #",What does this map in PostgreSQL? We should be using `timestamp with time zone` for a purpose like this.,rb,1,1,1
"@@ -102,8 +102,17 @@ module Ncr
         # skip state machine
         self.proposal.update(status: 'approved')
       else
-        approvers = emails.map{|e| User.for_email(e)}
-        self.proposal.approvers = approvers
+        individuals = emails.map do |email|
+          user = User.for_email(email)
+          # Reuse existing approvals, if present
+          if existing = self.proposal.existing_approval_for(user)
+            existing
+          else
+            Approvals::Individual.new(user: user)
+          end
+        end
+
+        self.proposal.root_approval = Approvals::Serial.new(child_approvals: individuals)
       end
     end
 ","Do we need to worry about a `root_approval` already existing here, or can we safely assume this will only be called on the initial setup?",rb,1,1,1
"@@ -76,7 +76,7 @@ describe CatalogController do
           expect(session[:search].keys).to include :id
           
           search = Search.find(session[:search][:id])
-          expect(search.query_params[:q]).to eq @user_query
+          expect(search.query_params['q']).to eq @user_query
         end
       end
 ","There isn't a backwards-compat issue here, right? The old hash was a HWIA, and now we're stuck with a stringified hash?",rb,1,0,1
"@@ -44,6 +44,10 @@ import java.util.List;
  * </code>
  */
 public abstract class By {
+  static {
+    WebDriverException.scheduleIpHostResolving();
+  }
+
   /**
    * @param id The value of the ""id"" attribute to search for
    * @return a By which locates elements by the value of the ""id"" attribute.","we shouldn't add a bunch of static initializers 'everywhere' in the code. Probably just one would be good, during the construction of the 'RemoteWebDriver' class.",rb,1,1,1
"@@ -0,0 +1,5 @@
+package org.openqa.selenium.grid.distributor.remote;
+
+public class RemoteDistributorTest {
+
+}",Probably best not to have an empty test....,rb,1,1,1
"@@ -1,4 +1,4 @@
 <% showusername = true if showusername.nil? %>
 <table id=""changeset_list"">
-  <%= render :partial => 'changeset', :locals => {:showusername => showusername}, :collection => @edits unless @edits.nil? %>
+  <%= render :partial => 'changeset/changeset', :locals => {:showusername => showusername}, :collection => @edits unless @edits.nil? %>
 </table>",This change should be unnecessary - rendering the `changset` partial from a changeset view should default to the one in the same view.,rb,1,1,1
"@@ -13,13 +13,14 @@ module RSpec
       # @overload before(scope, &block)
       #   @param scope [Symbol] `:example`, `:context`, or `:suite`
       #     (defaults to `:example`)
-      # @overload before(scope, conditions, &block)
+      # @overload before(scope, *conditions, &block)
       #   @param scope [Symbol] `:example`, `:context`, or `:suite`
       #     (defaults to `:example`)
-      #   @param conditions [Hash]
-      #     constrains this hook to examples matching these conditions e.g.
+      #   @param conditions [Array<Symbol>, Hash] constrains this hook to
+      #     examples matching these conditions e.g.
       #     `before(:example, :ui => true) { ... }` will only run with examples
-      #     or groups declared with `:ui => true`.
+      #     or groups declared with `:ui => true`. Symbols will be transformed
+      #     into hash entries with `true` values.
       # @overload before(conditions, &block)
       #   @param conditions [Hash]
       #     constrains this hook to examples matching these conditions e.g.","I'm still unsure about the changes in all this file, can you show some sample renders before / after? They imply the main use case is an array of symbols with a hash as an afterthought when really we expect this to be a hash 99% of the time.",rb,1,1,1
"@@ -1,5 +1,11 @@
 class TeamsController < ApplicationController
-  before_filter :must_be_team_owner
+  before_filter :must_be_team_owner, only: :edit
+
+  def index
+    @catalog = Catalog.new
+
+    render layout: 'empty-body'
+  end
 
   def edit
     @team = current_team",Should this be `teams#new`? We're not displaying a list of teams.,rb,1,1,1
"@@ -27,6 +27,7 @@ module Beaker
     # @option opts [Beaker::Logger] :logger A {Beaker::Logger} object
     def timesync host, opts
       logger = opts[:logger]
+      ntp_server = opts[:ntp_server] ? opts[:ntp_server] : NTPSERVER
       block_on host do |host|
         logger.notify ""Update system time sync for '#{host.name}'""
         if host['platform'].include? 'windows'",Any possible value in having an ntp server per host? @branan ?,rb,0,1,1
"@@ -0,0 +1,11 @@
+<%= form_tag(url, method: :get, remote: true, class: 'form-inline') do %>
+  <div class=""form-group"">
+    <div class=""input-group"">
+      <span class=""input-group-addon"" id=""search-addon"">
+        <span class=""glyphicon glyphicon-search"" aria-hidden=""true""></span>
+      </span>
+      <%= text_field_tag(:search, nil, class: 'form-control', 'aria-describedby': 'search-addon', 'aria-required': true) %>
+    </div>
+  </div>
+  <%= submit_tag(_('Search'), class: 'btn btn-default', style: 'margin-top: 8px;') %>
+<% end %>","We should use fontawesome here since we're using it everywhere else. `class=""fa fa-search""` should work",rb,1,1,1
"@@ -343,9 +343,7 @@ module Bolt
     end
 
     def list_tasks
-      outputter.print_table(pal.list_tasks)
-      outputter.print_message(""\nUse `bolt task show <task-name>` to view ""\
-                              ""details and parameters for a specific task."")
+      outputter.print_tasks(pal.list_tasks, pal.list_modulepath)
     end
 
     def show_plan(plan_name)","Can we just override ""list_tasks"" in the human outputter instead of adding a new method?",rb,1,1,1
"@@ -4,11 +4,15 @@
 
 <header>
   <div class=""topic-image"">
-    <%= image_tag ""topics/#{topic.slug}.svg"" %>
+    <%= link_to topic do %>
+      <%= image_tag ""topics/#{topic.slug}.svg"" %>
+    <% end %>
   </div>
 
   <div class=""topic-title"">
-    <h2><%= trail.topic_name %></h2>
+    <div class=""trail-topic-name"">
+      <%= render topic %>
+    </div>
     <h1><%= trail.name %></h1>
     <p><%= trail.description %></p>
   </div>","This doesn't seem super semantic. How do you feel about it, @Magnus-G ?",rb,0,1,1
"@@ -7,7 +7,7 @@ csp_policy = {
   :form_action => %w['self'],
   :frame_ancestors => %w['self'],
   :frame_src => %w['self'],
-  :img_src => %w['self' data: www.gravatar.com *.wp.com tile.openstreetmap.org *.tile.openstreetmap.org *.tile.thunderforest.com tileserver.memomaps.de *.openstreetmap.fr],
+  :img_src => %w['self' data: www.gravatar.com *.wp.com tile.openstreetmap.org *.tile.openstreetmap.org *.tile.thunderforest.com tileserver.memomaps.de *.openstreetmap.fr *.global.ssl.fastly.net],
   :manifest_src => %w['self'],
   :media_src => %w['none'],
   :object_src => %w['self'],",I'd make this an override in the `embed` method of the export controller rather than enabling it globally.,rb,0,0,1
"@@ -1,6 +1,6 @@
 C2::Application.routes.draw do
   ActiveAdmin.routes(self)
-  root :to => 'home#index'
+  root to: ""home#index""
   get '/error' => 'home#error'
   get '/profile'  => 'profile#show'
   post '/profile' => 'profile#update'","If you're going to change that one, why not change them all and get it done with?",rb,1,1,1
"@@ -1,6 +1,12 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 # SPDX - License - Identifier: Apache - 2.0
 
+# Purpose
+# This code example demonstrates how to set the access control list (ACL)
+# on an Amazon Simple Storage Solution (Amazon S3) bucket for the given owner.
+
+# snippet-start:[s3.s3_set_bucket_acls.rb]
+
 require 'aws-sdk-s3'
 
 # Sets the access control list (ACL) on an Amazon S3 bucket for the",Simple Storage **Service**,rb,0,0,0
"@@ -2,4 +2,13 @@ module NotifierHelper
   def fp(text)
     format_paragraph(text, 72, 0)
   end
+
+  def link_to_user(display_name)
+    link_to(
+      display_name,
+      user_url(display_name, :host => SERVER_URL),
+      :target => ""_blank"",
+      :style => ""text-decoration: none; color: #222; font-weight: bold""
+    )
+  end
 end","I added the `link_to_user` helper to declutter the template a bit, but then it means this Ruby file now contains some CSS instructions. What's the proper Rails way to do this?",rb,0,0,1
"@@ -83,6 +83,14 @@ class User < ActiveRecord::Base
     [purchased_subscription, team_subscription].compact.detect(&:active?)
   end
 
+  def annualized_payment
+    plan.annualized_payment
+  end
+
+  def discounted_annual_payment
+    plan.discounted_annual_payment
+  end
+
   private
 
   def team_subscription","Had a thought about this: we could make the upgrade route `/individual_plan/:id/annual_billing`, and then I could avoid these delegators. Worth it?",rb,0,1,1
"@@ -1,13 +1,13 @@
 <!DOCTYPE html>
 <html>
   <head>
-    <meta charset=""utf-8"">
     <title>C2</title>
-    <meta name=""viewport"" content=""width=device-width, initial-scale=1"" />
+    <meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"" />
+    <meta name=""viewport"" content=""width=device-width"" />
     <link rel=""stylesheet"" type=""text/css"" href=""<%= stylesheet_url(""mailer_new.css"") %>"" />
+    <%= render 'mail_shared/outlook_fix' %>
   </head>
   <body>
     <%= yield %>
-    <%= render partial: ""mail_shared/footer"" %>
   </body>
 </html>",why not put the footer code into a shared partial? I think we will be using it for all emails so good to just have in layout. can take lines 142 -> 157 from attachment template and put it in `mail_shared/_footer.html.haml`,rb,0,1,1
"@@ -469,6 +469,13 @@ Rails.application.routes.draw do
     resources :license_permissions
   end
 
+  namespace 'api', defaults: { format: :json } do
+    namespace 'v1' do
+      post 'unsubscribe'
+      post 'jwt'
+    end
+  end
+
   get 'sitemap_index.xml', controller: 'sitemap', action: 'index', format: 'xml'
   get 'sitemaps/:ctrl/:page.xml', controller: 'sitemap', action: 'show', format: 'xml'
 ",Add a jwt and enlistment resource under the namespace v1,rb,1,1,1
"@@ -400,7 +400,8 @@ module RSpec::Core
     # @attr duration [Float] the time taken (in seconds) to run the suite
     # @attr examples [Array<RSpec::Core::Example>] the examples run
     # @attr number_of_examples [Fixnum] the number of examples to profile
-    ProfileNotification = Struct.new(:duration, :examples, :number_of_examples)
+    # @attr profiler [RSpec::Core::Profiler] the profiler used to capture examples
+    ProfileNotification = Struct.new(:duration, :examples, :number_of_examples, :profiler)
     class ProfileNotification
       # @return [Array<RSpec::Core::Example>] the slowest examples
       def slowest_examples","I don't think the profiler formatter needs to be exposed of profile notification. Seems like once you merge the example/example group event handling into the existing profiler formatter this will no longer be needed on the notification object anymore, right?",rb,1,1,1
"@@ -135,7 +135,8 @@ class PathResolver
   # This operation considers posix paths, windows paths, and file URLs.
   #
   # Unix absolute paths and UNC paths start with slash. Windows roots can start
-  # with a drive letter. Absolute paths in the browser start with file://.
+  # with a drive letter. Absolute paths may start with file://, http://, or
+  # https:// when the IO module is xmlhttprequest (Opal runtime only).
   #
   # path - the String path to check
   #",I didn't know that `start_with?` accepts a list of arguments! It's good to know :smile:,rb,0,0,1
"@@ -1,13 +1,14 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
-# SPDX - License - Identifier: Apache - 2.0
+# SPDX-License-Identifier: Apache-2.0
 
+# Purpose:
 # This code example allows a federated user with a limited set of
-# permissions to list the objects in an Amazon S3 bucket.
+# permissions to list the objects in an Amazon Simple Storage Solution (Amazon S3) bucket.
 
+# snippet-start:[s3.ruby.auth_federation_token_request_test.rb]
 # Prerequisites:
 #  - An existing Amazon S3 bucket.
 
-# snippet-start:[s3.ruby.auth_federation_token_request_test.rb]
 require 'aws-sdk-s3'
 require 'aws-sdk-iam'
 require 'json'",Simple Storage **Service**,rb,0,0,0
"@@ -0,0 +1,8 @@
+require 'spec_helper'
+
+describe 'Purchases' do
+  it 'raise not found if no purchase exists' do
+    visit purchase_path('robots.txt')
+    expect(page.status_code).to eq(404)
+  end
+end",I'd try writing this as a controller spec.,rb,0,0,1
"@@ -6,6 +6,10 @@ feature ""User creates a subscription"" do
     sign_in
   end
 
+  after do
+    clean_up_stripe_coupons
+  end
+
   scenario ""doesn't create a Stripe subscription with an invalid credit card"" do
     subscribe_with_invalid_credit_card
     expect(current_user).not_to have_active_subscription",Thoughts on having this as a global `after` hook in the file with the Stripe fake?,rb,1,1,1
"@@ -38,12 +38,16 @@
 <% content_for :javascript do %>
 <script type=""text/javascript"">
   function workshop_details(workshop) {
+    if(workshop.online) {
+      return "" Online"";
+    }
+
     var details = [];
     for (var s=0; s<workshop.active_sections.length; s++) {
       details.push(workshop.active_sections[s].section.city);
     }
     if(details.length > 0) {
-      return "" in "" + details.join("" and "");
+      return "" in-person in "" + details.join("" and "");
     } else {
       return """";
     }","What do you think about adding an `else {` block to wrap the rest of this method, instead of using an early return guard?",rb,1,1,1
"@@ -0,0 +1,16 @@
+<% 
+  tool_name = Rails.configuration.branding[:application][:name]
+  helpdesk_email = Rails.configuration.branding[:organisation][:helpdesk_email]
+
+  # Override the default Rails route helper for the contact_us page IF an alternate contact_us url was defined
+  # in the branding config file
+  contact_us = Rails.application.config.branding[:organisation][:contact_us_url] || contact_us_url
+%>
+<p>
+  <%= _('All the best') %>
+  <br />
+  <%= _('The %{tool_name} team') %{:tool_name => tool_name} %>
+</p>
+<p>
+  <%= _('You may change your notification preferences on your profile page.') %>&nbsp;<%= _('Please do not reply to this email.') %>&nbsp;<%= raw(_('If you have any questions or need help, please contact us at %{helpdesk_email} or visit %{contact_us}') %{ :helpdesk_email => mail_to(helpdesk_email, helpdesk_email, subject: email_subject), :contact_us => link_to(contact_us, contact_us) }) %>
+</p>","Nice partial, it was copied/pasted across many mails...",rb,1,0,1
"@@ -76,7 +76,7 @@ public class ProtocolHandshake {
 
         if (result.isPresent()) {
           Result toReturn = result.get();
-          LOG.info(String.format(""Detected dialect: %s"", toReturn.dialect));
+          LOG.finest(String.format(""Detected dialect: %s"", toReturn.dialect));
           return toReturn;
         }
       }",This is an incorrect change. The dialect spoken is an important part of the handshake and should be communicated to users.,rb,1,1,1
"@@ -53,6 +53,13 @@ describe Mentor do
 
       expect(mentor.active_mentees).to eq [active]
     end
+
+    it 'eager loads mentees' do
+      mentor = create(:mentor)
+
+      expect { mentor.reload.active_mentees }.
+        to eager_load { create(:subscriber, :includes_mentor, mentor: mentor) }
+    end
   end
 
   describe '#active_mentee_count' do","Place the . on the next line, together with the method name.",rb,1,1,1
"@@ -6,7 +6,7 @@
 
     <%- if params[:q] and params[:search_field] and params[:search_field] != blacklight_config.default_search_field -%>
       <li><%= t 'blacklight.search.zero_results.search_fields', :search_fields => search_field_label(params) %> - 
-      <%= link_to t('blacklight.search.zero_results.search_everything'), url_for(params_for_search(:search_field=>blacklight_config.default_search_field.key)) %>
+      <%= link_to t('blacklight.search.zero_results.search_everything'), params_for_search(:params => params.merge(:search_field=>blacklight_config.default_search_field.key)) %>
       </li>
     <%- end %>
 ",But you are passing one here.,rb,0,0,1
"@@ -44,7 +44,7 @@ public abstract class NewSessionQueue implements HasReadyState {
 
   public abstract boolean offerFirst(HttpRequest request, RequestId requestId);
 
-  public abstract Optional<HttpRequest> poll();
+  public abstract Optional<HttpRequest> poll(RequestId requestId);
 
   public abstract int clear();
 ","The expected behaviour for `poll` would be to match what `Deque` does, which is: > Retrieves and removes the head of the queue represented by this deque As such, you shouldn't need the `RequestId` here.",rb,1,1,1
"@@ -12,7 +12,9 @@ class ProposalsController < ApplicationController
 
   def show
     @proposal = proposal.decorate
-    cookies[:detail] = params[:detail]
+    if !params[:detail].blank?
+      cookies[:detail] = params[:detail]
+    end
     mode = cookies[:detail]
     if mode == ""new""
       @client_data_instance ||= proposal.client_data",@jessieay I had to re-add this check because the cookie was getting wiped when the query wasnt set.,rb,0,0,1
"@@ -21,9 +21,12 @@ class PurchasesController < ApplicationController
     end
 
     if @purchase.save
+      create_subscription if @purchaseable.subscription?
+
       km_http_client.record(@purchase.email, ""Submit Payment"", { ""Product Name"" => @purchaseable.name, ""Order Total"" => @purchase.price })
       track_purchase_if_paid(@purchase)
-      redirect_to @purchase.success_url
+
+      redirect_to success_url
     else
       @active_card = retrieve_active_card
       render :new","To follow Tell, Don't Ask here: tell the purchaseable to do something (`@purchaseable.add_to current_user`) and then implement the correct behavior for each type. Inflecting on the `@purchaseable` and then varying behavior here tightly couples the controller to the behavior for this specific purchaseable, and means you'll have to special case every purchaseable type as you add them.",rb,1,1,0
"@@ -0,0 +1,18 @@
+require 'travis/build/appliances/base'
+module Travis
+  module Build
+    module Appliances
+      class MavenCentralMirror < Base
+        GOOGLE_MAVEN_MIRROR='https://maven-central.storage-download.googleapis.com/repos/central/data/'
+        def apply
+          sh.raw bash('travis_maven_central_mirror')
+          sh.raw ""travis_maven_central_mirror #{GOOGLE_MAVEN_MIRROR}""
+        end
+
+        def apply?
+          config[:os] != 'windows'
+        end
+      end
+    end
+  end
+end",can this please be configurable via config as we might not want to set a mirror by default,rb,1,1,1
"@@ -98,7 +98,8 @@ EOF
 
     def generate_blacklight_marc_demo
       if options[:marc]
-        gem ""blacklight-marc"", ""~> 5.0""
+        blacklight_marc = String.new('blacklight-marc')
+        gem blacklight_marc, '~> 6.0'
 
         Bundler.with_clean_env do
           run ""bundle install""",Why this line?,rb,1,0,1
"@@ -35,6 +35,7 @@ describe ForumsController do
   end
 
   it 'admin show with pagination' do
+    skip 'TODO: This test never ran correctly. It silently failed due to no assertions.'
     create_list(:topic, 20)
     login_as user
     get :show, id: forum.id",These really should be fixed for real.,rb,0,0,1
"@@ -1,4 +1,13 @@
+require 'logger'
+
 module Bolt
+  class << self
+    attr_accessor :log_level
+    attr_accessor :config
+  end
+
+  @config = {}
+
   require 'bolt/executor'
   require 'bolt/node'
 end","thanks for moving this up here, seems like a much more intuitive place",rb,1,0,1
"@@ -64,7 +64,7 @@ module Bolt
              end
 
       data = load_defaults(project).push(
-        filepath: project.config_file,
+        filepath: configfile,
         data: conf,
         logs: logs,
         deprecations: []","If you pass `--configfile /path/to/bolt.yaml`, we will actually load `/path/to/bolt-project.yaml` if it exists. Will this cause us to instead report that we loaded `/path/to/bolt.yaml` when we didn't?",rb,1,1,1
"@@ -2,7 +2,10 @@ class ShowsController < ApplicationController
   layout ""landing_pages""
 
   def show
-    @show = Show.friendly.find(params[:id])
+    @show = ShowListing.new(
+      Show.friendly.find(params[:id]),
+      current_user,
+    )
 
     respond_to do |format|
       format.html do",Put a comma after the last parameter of a multiline method call.,rb,1,1,1
"@@ -21,14 +21,13 @@ class SubscriptionMailer < BaseMailer
     )
   end
 
-  def subscription_receipt(email, plan_name, amount, stripe_invoice_id)
-    @plan_name = plan_name
+  def subscription_receipt(email, amount, stripe_invoice_id)
     @amount = amount
     @stripe_invoice_id = stripe_invoice_id
 
     mail(
       to: email,
-      subject: ""[Learn] Your #{plan_name} receipt and some tips""
+      subject: '[Learn] Your receipt and some tips'
     )
   end
 ",Prefer single-quoted strings when you don't need string interpolation or special symbols.,rb,1,1,1
"@@ -218,7 +218,8 @@ class Plan < ActiveRecord::Base
 
         if self.save!
           # Send an email confirmation to the owners and co-owners
-          deliver_if(recipients: self.owner_and_coowners, key: 'users.feedback_requested') do |r|
+          owners = User.joins(:roles).where('roles.plan_id =? AND roles.access IN (?)', self.id, Role.access_values_for(:administrator))
+          deliver_if(recipients: owners, key: 'users.feedback_requested') do |r|
             UserMailer.feedback_confirmation(r, self, user).deliver_now
           end
           # Send an email to all of the org admins as well as the Org's administrator email","owner_and_coowners class method is still used after the change? If not, please remove it!",rb,1,1,1
"@@ -66,4 +66,15 @@ describe Practice do
       expect(result.map(&:name)).to eq([""Started""])
     end
   end
+
+  describe ""#quizzes"" do
+    it ""returns all the quizzes"" do
+      user = build_stubbed(:user)
+      quiz = create(:quiz)
+
+      practice = Practice.new(user)
+
+      expect(practice.quizzes).to eq([quiz])
+    end
+  end
 end","Since there's only one `quiz`, do you think using `eq` is more direct?",rb,1,1,1
"@@ -76,6 +76,13 @@ describe 'apply_prep' do
       end
     end
 
+    it 'fails if version task is not found' do
+      Puppet::Pal::ScriptCompiler.any_instance.expects(:task_signature).with('puppet_agent::version')
+      is_expected.to run.with_params(hostnames).and_raise_error(
+        Bolt::Error, 'puppet_agent::version could not be found'
+      )
+    end
+
     it 'fails if version check fails' do
       failed_results = Bolt::ResultSet.new(
         targets.map { |t| Bolt::Result.new(t, error: { 'msg' => 'could not get version' }) }",We expect this to happen because users may have used their own puppet_agent package?,rb,1,1,1
"@@ -0,0 +1,14 @@
+require File.expand_path(File.dirname(__FILE__) + '/test_helper.rb')
+
+class TestFakerImage < Test::Unit::TestCase
+  def setup
+    @tester = Faker::Image
+  end
+
+  def test_urls
+    Google::Search::Image.stub :initialize, Google::Search::Image do
+      assert @tester.urls('test',1).is_a?(Array)
+    end
+  end
+
+end",How about now? @tejasbubane,rb,0,0,0
"@@ -110,7 +110,7 @@ class ErrorHandler(object):
                             value = message
                             try:
                                 message = message['message']
-                            except TypeError:
+                            except KeyError:
                                 message = None
                     else:
                         message = value.get('message', None)",could you change this to instead of being a `try.. except` be `message = message.get('message')`,rb,1,1,1
"@@ -0,0 +1,3 @@
+<h2><%= t ""changeset.rss.comment"", :author => comments_entry.author.display_name, 
+  :changeset_id => comments_entry.changeset.id.to_s %></h2>
+<%= render :partial => 'comment', :object => comments_entry %>",What's the point of extracting this into a partial? It doesn't look like it's used anywhere else?,rb,1,1,1
"@@ -36,10 +36,17 @@ module Selenium
       SOCKET_LOCK_TIMEOUT = 45
       STOP_TIMEOUT        = 20
 
+      @executable = nil
+      @missing = ''
+
+      class << self
+        attr_accessor :executable, :missing_text
+      end
+
       attr_accessor :host
 
       def initialize(executable_path, port, *extra_args)
-        @executable_path = executable_path
+        @executable_path = binary_path(executable_path)
         @host            = Platform.localhost
         @port            = Integer(port)
         @extra_args      = extra_args",Is this `@missing_text` ?,rb,1,0,1
"@@ -1,17 +1,11 @@
 <li class=""subscription"">
   <% if subscription.active? %>
     <p><strong><%= subscription.plan.name %></strong> <br /> Active since <%= subscription.created_at.to_s(:simple) %></p>
-    <% if subscription.scheduled_for_cancellation_on %>
+    <% if subscription.scheduled_for_cancellation? %>
       <p><%= t('subscriptions.cancellation_scheduled_on', date: subscription.scheduled_for_cancellation_on.to_s(:simple)) %></p>
     <% end %>
   <% else %>
     <p>Canceled on <%= subscription.deactivated_on.to_s(:simple) %></p>
   <% end %>
-  <% if subscription.active? && subscription.scheduled_for_cancellation_on.blank? %>
-    <%= link_to t('subscriptions.change_plan'), edit_subscription_path %>
-  <% end %>
-  <%= link_to 'View all invoices', subscriber_invoices_path, class: 'invoices' %>
-  <% if subscription.active? && subscription.scheduled_for_cancellation_on.blank? %>
-    <%= link_to t('subscriptions.cancel'), new_subscriber_cancellation_path, class: 'cancel' %>
-  <% end %>
+  <%= render 'subscriptions/management', subscription: subscription %>
 </li>",This compound condition is duplicated above.,rb,1,1,1
"@@ -117,6 +117,19 @@ module Faker
         regexify(bothify(fetch(key)))
       end
 
+      def mercosur_license_plate(legacy_state_abreviation = NOT_GIVEN, state_abreviation: '')
+        key = 'vehicle.mercosur_license_plate'
+        if legacy_state_abreviation != NOT_GIVEN
+          warn_with_uplevel ""Passing `state_abreviation` with the 1st argument of `Vehicle.mercosur_license_plate` is deprecated. Use keyword argument like `Vehicle.mercosur_license_plate(state_abreviation: ...)` instead."", uplevel: 1
+          state_abreviation = legacy_state_abreviation
+        end
+        
+        return regexify(bothify(fetch(key))) if state_abreviation.empty?
+
+        key = key + '.by_state.' + state_abreviation
+        regexify(bothify(fetch(key)))
+      end
+
       def singapore_license_plate
         key = 'vehicle.license_plate'
         plate_number = regexify(bothify(fetch(key)))","Not sure if the `legacy_state_abreviation` is required in this particular case, since there was no previous implementation of this method, so not including it wouldn't be a breaking change.",rb,1,1,1
"@@ -1,5 +1,6 @@
 require 'erb'
 require 'shellwords'
+require 'set'
 
 module RSpec
   module Core","An aside, are we not worried about polluting stdlib here?",rb,0,0,1
"@@ -2,6 +2,10 @@
 
 require_relative '../../../vendored/require_vendored.rb'
 
+# Add bolt spec helpers
+bolt_dir = Gem::Specification.find_by_name('bolt').gem_dir
+$LOAD_PATH.unshift(File.join(bolt_dir, 'spec', 'lib'))
+
 # Ensure tasks are enabled when rspec-puppet sets up an environment
 # so we get task loaders.
 Puppet[:tasks] = true","Seems inconsistent with the `require_relative` above. If the module is moved out of bolt, the relative require will need to reflect that too.",rb,1,1,1
"@@ -61,7 +61,9 @@
     <article>
       <figure id=""bullet-3"" class=""journey-bullet"">3.</figure>
       <h2>Enroll in premium, hands-on video tutorials</h2>
-      <p>Our video tutorials are more than just video tutorials. You&rsquo;ll build real apps and communicate directly with a thoughtbot developer or designer. Begin an online video tutorial as soon as you sign up.</p>
+      <p>Our video tutorials go beyond passive learning. You&rsquo;ll build
+      real apps and communicate directly with a thoughtbot developer or
+      designer. You can begin one as soon as you sign up.</p>
     </article>
     <figure class=""supporting-visual two-stacked"">
       <div>",`You can begin as soon as you sign up.`?,rb,1,0,0
"@@ -0,0 +1,10 @@
+require 'test_helper'
+
+describe 'FeedbacksController' do
+  it 'creates feedback' do
+    assert_difference('Feedback.count') do
+      post :create, feedback: { rating: 5, uuid: 'e91fc264-12345', more_info: 1, project_name: 'Ruby On Rails' }
+    end
+    assert_response :success
+  end
+end",This can be expanded to include the `project_id` and the `ip_address`.,rb,1,1,1
"@@ -7,6 +7,7 @@ require 'optparse'
 module Bolt
   class BoltOptionParser < OptionParser
     OPTIONS = { inventory: %w[nodes targets query rerun description],
+                group: %w[nodes targets query rerun description],
                 authentication: %w[user password private-key host-key-check ssl ssl-verify],
                 escalation: %w[run-as sudo-password],
                 run_context: %w[concurrency inventoryfile save-rerun],","I don't think this command will actually do anything with these options. I'd remove this, and modify the line below to not include it.",rb,1,1,1
"@@ -38,6 +38,9 @@ try:
 except NameError:
     pass
 
+if sys.version > '3':
+    long = int
+
 
 class WebElement(object):
     """"""Represents a DOM element.",Should be `if sys.version_info[0] > 2:`,rb,1,1,1
"@@ -29,7 +29,7 @@ class User < ActiveRecord::Base
   end
 
   def first_name
-    name.split("" "").first
+    name.split(' ').first
   end
 
   def last_name",Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,1,1,1
"@@ -22,8 +22,8 @@ var iam = new AWS.IAM({apiVersion: '2010-05-08'});
 
 iam.getAccessKeyLastUsed({AccessKeyId: 'ACCESS_KEY_ID'}, function(err, data) {
   if (err) {
-    console.log(""Error"", err);
+    throw err;
   } else {
-    console.log(""Success"", data.AccessKeyLastUsed);
+    console.log(""Last Access Key used: "" + data.AccessKeyLastUsed);
   }
 });","I changed all the error console logs to throws, since these examples are written as command line tools. This will cause the script to properly report an error, vs exiting with a successful exit code.",rb,1,1,1
"@@ -1,5 +1,5 @@
 <div id=""blacklight-modal"" class=""modal fade"" tabindex=""-1"" role=""dialog"" aria-labelledby=""modal menu"" aria-hidden=""true"">
-  <div class=""modal-dialog"" role=""document"">
+  <div class=""modal-dialog modal-lg"" role=""document"">
     <div class=""modal-content"">
     </div>
   </div>",Would it be useful for us to make this configurable/easily overridable in some way? It might be useful to have smaller modals particularly if a dev never configures a facet to use the A-Z pagination. \\_()_/,rb,1,1,1
"@@ -1,5 +1,5 @@
 module DashboardsHelper
-  def learn_live_link(&block)
+  def upcase_live_link(&block)
     if current_user_has_access_to?(:office_hours)
       link_to OfficeHours.url, target: ""_blank"", &block
     else",maybe just `chat_room_link`?,rb,1,1,1
"@@ -600,7 +600,7 @@ img.intercom-interblocks-article-author-avatar-image {
 
 <p>Hi <%= @user.first_name %>,</p>
 
-<p><%= @video.email_body_text %></p>
+<p><%= @html_content %></p>
 
 <p style=""text-align: center"">
 <ic-block data-generated-at=""14775965965790.22154604114587806"" data-type=""button"" data-link-url=""<%= video_url(@video, @utm_params) %>"" data-text=""Check it Out"" data-id=""block-ember4053"" data-align=""center""><zws>&#8203;</zws><insert contenteditable=""false""><insert-point></insert-point></insert><a class=""intercom-h2b-button"" href=""<%= video_url(@video, @utm_params) %>"" contenteditable=""false""><%= @video.email_cta_label %></a><insert contenteditable=""false""><insert-point></insert-point></insert><zws>&#8203;</zws></ic-block>",I think you'll need an HTML safe somewhere to get the uneacapef HTML.,rb,1,1,1
"@@ -269,8 +269,12 @@ module Beaker
     def get_domain_name(host)
       domain = nil
       search = nil
-      if ((host['platform'] =~ /windows/) and not host.is_cygwin?)
-        resolv_conf = host.exec(Command.new('type C:\Windows\System32\drivers\etc\hosts')).stdout
+      if host['platform'] =~ /windows/
+        if host.is_cygwin?
+          resolv_conf = host.exec(Command.new(""cat /cygdrive/c/Windows/System32/drivers/etc/hosts"")).stdout
+        else
+          resolv_conf = host.exec(Command.new('type C:\Windows\System32\drivers\etc\hosts')).stdout
+        end
       else
         resolv_conf = host.exec(Command.new(""cat /etc/resolv.conf"")).stdout
       end","I'm not a fan of hardcoded system drives, but if it works...",rb,1,0,1
"@@ -1,6 +1,7 @@
 <div class=""row"">
   <div class=""col-md-12"">
     <h1>Usage statistics</h1>
+    <p><%= _('Use the filters to generate organisational usage statistics for a custom date range. The graphs display new users and plans for your organisation over the past year. You can download a CSV report for each graph.') %></p>
   </div>
 </div>
 <div class=""row"">","this hint should help to mitigate any confusion, nite to see it",rb,1,0,1
"@@ -3,6 +3,7 @@ require 'rspec/support/spec/library_wide_checks'
 RSpec.describe RSpec do
   fake_libs = File.expand_path('../../support/fake_libs', __FILE__)
   allowed_loaded_features = [
+    /open3.rb/,       # Used by Bisect::Runner, which is not normally loaded
     /optparse\.rb/,   # Used by OptionParser.
     /rbconfig\.rb/,   # loaded by rspec-support for OS detection.
     /shellwords\.rb/, # used by ConfigurationOptions and RakeTask.","My reading of this is that this would not be loaded except in specs utilising the bisect feature, can we not use the isolated environment stuff to test that feature avoiding this?",rb,1,1,1
"@@ -46,7 +46,7 @@ module RSpec
 
           examples.select do |ex|
             file_scoped_include?(ex.metadata, ids, locations) do
-              !exclusions.include_example?(ex) && non_scoped_inclusions.include_example?(ex)
+              (exclusions.empty? || !exclusions.include_example?(ex)) && non_scoped_inclusions.include_example?(ex)
             end
           end
         end",Why? (not had enough   yet   ),rb,1,0,0
"@@ -0,0 +1,17 @@
+RSpec.configure do |config|
+  config.before do
+    allow(Kernel).to receive(:srand).and_raise NotImplementedError,
+      ""#{Kernel}.srand should always be stubbed or mocked. "" +
+      ""This appears to be an unintended call.""
+
+    allow(RSpec::Core::Random).to receive(:srand).and_raise NotImplementedError,
+      ""#{RSpec::Core::Random}.srand should always be stubbed or mocked. "" +
+      ""This appears to be an unintended call.""
+
+    if defined?(::Random)
+      allow(::Random).to receive(:srand).and_raise NotImplementedError,
+        ""#{::Random}.srand should always be stubbed or mocked. "" +
+        ""This appears to be an unintended call.""
+    end
+  end
+end",Why did you feel the need to add these checks? I'm not sure what I think of them yet....,rb,1,0,1
"@@ -13,6 +13,9 @@ module BrowseHelper
     if version
       name = t 'printable_name.with_version', :id => name, :version => object.version.to_s
     end
+    # stop here if redacted to avoid giving away redacted version tags.
+    return name if object.redacted?
+
     if object.tags.include? ""name:#{I18n.locale}""
       name = t 'printable_name.with_name',  :name => object.tags[""name:#{I18n.locale}""].to_s, :id => name
     elsif object.tags.include? 'name'","I think I'd rather have `unless object.redacted?` around the next block rather than an early return, which is generally considered bad form.",rb,1,1,1
"@@ -0,0 +1,15 @@
+require 'beaker/tasks/rake_task'
+
+Beaker::Tasks::RakeTask.new
+
+desc ""Run Beaker PE tests""
+Beaker::Tasks::RakeTask.new(""beaker:test:pe"",:hosts) do |t,args|
+  t.type = 'pe'
+  t.hosts = args[:hosts]
+end
+
+desc ""Run Beaker Git tests""
+Beaker::Tasks::RakeTask.new(""beaker:test:git"",:hosts) do |t,args|
+  t.type = 'git'
+  t.hosts = args[:hosts]
+end",The task created by this line doesn't seem to work. I get NameError: undefined local variable or method `failure_message` whenever I run it. It also doesn't seem to actually use the :hosts and :type argument that I pass to it whereas the tasks defined below seem to work fine.,rb,0,0,1
"@@ -11,6 +11,19 @@ class Subscription < ActiveRecord::Base
   validates :plan_type, presence: true
   validates :user_id, presence: true
 
+  def self.restarting_today
+    where.not(deactivated_on: nil).
+      where(
+        reactivated_on: nil,
+        scheduled_for_reactivation_on: Time.zone.today,
+      )
+  end
+
+  def self.restarting_in_two_days
+    where.not(deactivated_on: nil).
+      where(scheduled_for_reactivation_on: Time.zone.today + 2.days)
+  end
+
   def self.canceled_in_last_30_days
     canceled_within_period(30.days.ago, Time.zone.now)
   end",Indent ) the same as the start of the line where ( is.,rb,1,1,1
"@@ -20,7 +20,7 @@ class OrganizationDecorator < Cherry::Decorator
 
   class << self
     def select_options
-      options = Organization.active.order('lower(name)').pluck(:name, :id)
+      options = Organization.active.select(:name, :id).order('lower(name)').map { |org| [org.name, org.id] }
       options.unshift(['Unaffiliated', ''])
       options.push(['Other', ''])
     end","Is this change driven by function, style, performance or some other consideration?",rb,1,1,1
"@@ -36,7 +36,7 @@ feature ""Visitor"" do
 
   def expect_page_to_have_preview_cta
     expect(page.body).to include(
-      I18n.t(""watchables.preview.cta"", subscribe_url: subscribe_path).html_safe
+      I18n.t(""watchables.preview.cta"", subscribe_url: join_path).html_safe
     )
   end
 end",Put a comma after the last parameter of a multiline method call.,rb,1,1,1
"@@ -1,5 +1,7 @@
 module Gsa18f
   class DashboardController < ApplicationController
+    before_action :check_disabled_client
+
     def index
       @rows = self.format_results(self.queryset)
     end","seems like this `check_disabled_client` check should be in `application_controller` and just selectively skipped? (I think the only page we want disabled clients to be able to see is the home page, right?) That would ensure that future controllers also use the check rather than needing to explicitly add it to each controller",rb,1,1,1
"@@ -0,0 +1,5 @@
+class AddUuiDtoProject < ActiveRecord::Migration
+  def change
+    add_column :projects, :uuid, :string
+  end
+end",This class name is a bit odd. Shouldn't it be `AddUuidToProject` (note capitalization),rb,1,1,1
"@@ -1,4 +1,7 @@
 class SubscribeOldChangesets < ActiveRecord::Migration[4.2]
+  class Changeset < ActiveRecord::Base
+  end
+
   def up
     Changeset.find_each do |changeset|
       changeset.subscribers << changeset.user unless changeset.subscribers.exists?(changeset.user.id)",I think this will fail if there are changesets in the database as the migration relies on the `subscribers` and `user` associations on the changeset.,rb,1,1,1
"@@ -120,8 +120,8 @@ describe Mongoid::Clients::Factory do
 
             let(:config) do
               {
-                default: { hosts: [ ""127.0.0.1:27017"" ], database: database_id },
-                secondary: { uri: ""mongodb://127.0.0.1:27017,127.0.0.1:27018/mongoid_test"" }
+                default: { hosts: [ ""127.0.0.1:30000"" ], database: database_id },
+                secondary: { uri: ""mongodb://127.0.0.1:30000,127.0.0.1:30001/mongoid_test"" }
               }
             end
 ","Because of the SDAM changes in the driver since the last release, this test broke when run with the master branch of the driver due to the host on localhost:27017 being removed (the warning said it was because it was a standalone and there were multiple seeds). Given that the tests don't actually need to do anything with the server, I figured it was easier to just change the ports to ones that we never actually run tests against.",rb,1,1,1
"@@ -19,6 +19,8 @@ package org.openqa.grid.web;
 
 import com.google.common.collect.Maps;
 
+import com.sun.org.glassfish.gmbal.ManagedObject;
+
 import org.openqa.grid.internal.Registry;
 import org.openqa.grid.internal.utils.GridHubConfiguration;
 import org.openqa.grid.web.servlet.DisplayHelpServlet;",And again. The reason it's bad is that if someone uses a JDK not produced by Oracle they won't have this class.,rb,0,1,1
"@@ -0,0 +1,16 @@
+class Account::Subscription
+  attr_reader :account
+
+  def initialize(account)
+    @account = account
+  end
+
+  def unsubscribe(notification_type = :all)
+    attribute_name = case notification_type
+                     when :kudo then :email_kudos
+                     when :post then :email_posts
+                     else :email_master
+                     end
+    account.update_attribute(attribute_name, false)
+  end
+end",This file can go into `app/models/account/subscription.rb`?,rb,0,0,1
"@@ -26,7 +26,7 @@ module Unix
         'puppetbin'        => '/opt/puppet/bin/puppet',
         'puppetbindir'     => '/opt/puppet/bin',
         'puppetsbindir'    => '/opt/puppet/sbin',
-        'systembindir'     => '/opt/puppet/bin',
+        'privatebindir'    => '/opt/puppet/bin',
         'puppetvardir'     => '/var/opt/lib/pe-puppet',
         'hieradatadir'     => '/var/lib/hiera',
         'hieraconf'        => '/etc/puppetlabs/puppet/hiera.yaml',","@kevpl I just noticed the PE default is wrong, it needs to be the same as AIO (/opt/puppetlabs/puppet/bin). Not an issue currently, but something we'll need to come back to.",rb,0,0,1
"@@ -212,7 +212,14 @@ module Blacklight
     end
 
     def search_builder_class
-      super || Blacklight::Solr::SearchBuilder
+      super || locate_search_builder_class
+    end
+
+    def locate_search_builder_class
+      ::SearchBuilder
+    rescue NameError
+      Deprecation.warn(Configuration, ""Your application is missing the SearchBuilder. Have you run `rails generate blacklight:search_builder`? Falling back to Blacklight::Solr::SearchBuilder"")
+      Blacklight::Solr::SearchBuilder
     end
 
     def default_per_page",Do we really need to deprecation `Blacklight::Solr::SearchBuilder`? It seems like it works fine as-is for common uses..,rb,1,1,1
"@@ -0,0 +1,19 @@
+class NameUnnamedRedactions < ActiveRecord::Migration[5.0]
+  def self.up
+  	# after titles are fixed we change the column so to not be null
+    change_column_null ""redactions"", ""title"", false
+    # gets each redaction
+    # sets redaction title equal to a string of the id if there is no title
+    Redaction.find_each do |redaction|
+      if redaction.title.empty?
+        redaction.title = redaction.id.to_s
+        redaction.save!
+      end
+    end
+  end
+
+  def self.down
+  	# for down-migration we allow title column to be null
+    change_column_null ""redactions"", ""title"", true
+  end
+end","I think you might need to fill in the titles first, and then change the column constraint afterwards.",rb,1,1,1
"@@ -33,13 +33,14 @@
     <div class=""panel-group"" id=""phases_accordion"" role=""tablist"">
       <!-- If template has phases-->
       <% if template_hash[:template][:phases].present? %>
+        <% i = 0 %>
         <% template_hash[:template][:phases].each do |phase_no, phase_hash| %>
           <% phase = phase_hash[:data] %>
             <div class=""panel panel-default"">
               <div class=""heading-button"" role=""button"" data-toggle=""collapse""
                    data-parent=""phases_accordion"" 
                    href=""#collapsePhase<%= phase.id %>""
-                   aria-expanded=""false"" 
+                   aria-expanded=""<%= i == 0 ? 'true' : 'false' %>"" 
                    aria-controls=""#collapsePhase<%= phase.id %>"">
                    
                 <div class=""panel-heading"" role=""tab"" id=""<%= ""headingPhase#{phase.id}"" %>"">","We could check for first instead of adding an extra variable and its counter ``` template_hash[:template][:phases].each do |o| aria-expanded=""<%= template_hash[:template][:phases].first == o ? 'true' : 'false' %>"" end",rb,1,1,1
"@@ -7,12 +7,13 @@ class PostsController < ApplicationController
   before_action :find_forum_and_topic_records, only: [:create]
 
   def index
-    @posts = Post.paginate(page: params[:page], per_page: 10)
+    all_posts = Post.all
+    @posts = all_posts.paginate(page: params[:page], per_page: 10)
   end
 
   def create
     @post = build_new_post
-    if verify_recaptcha(model: @post) && @post.save
+    if @post.save
       post_notification(@post)
       redirect_to topic_path(@topic)
     else",This looks better the previous way.,rb,1,0,1
"@@ -1,7 +1,7 @@
 require 'test_helper'
 
 class PersonTest < ActiveSupport::TestCase
-  before { Rails.cache }
+  before { Person::Cached.stubs(:count).returns(Person.count) }
 
   describe 'searchable_factor' do
     let(:person) { create(:account).person }",I thought we were going to remove the `Person::Cached` class based upon our decision to not implement caching in the ohloh-ui code at this time and that we would like to try relying on the Rails 4 Russian Doll Caching model of view fragments.,rb,1,1,1
"@@ -0,0 +1,19 @@
+class ConvertAttachmentToPaperclip < ActiveRecord::Migration
+  def self.up
+    change_table :attachments do |attachment|
+      attachment.rename :filename, :attachment_file_name
+      attachment.rename :size, :attachment_file_size
+      attachment.rename :content_type, :attachment_content_type
+      attachment.datetime :attachment_updated_at 
+
+      # Removing child thumbnails as its not required for paperclip 
+      Attachment.delete_all(""parent_id is not null"")
+
+      attachment.remove :parent_id, :thumbnail, :width, :height, :is_default
+    end
+  end
+
+  def self.down
+    raise ActiveRecord::IrreversibleMigration, ""Cannot recover deleted data""
+  end
+end","This was a change from the `change` method to `self.up` and `self.down` with the `IrreversibleMigration`, isn't it? I think we missed the restriction that we do not want any migrations in the ohloh-ui repository: they all have to be in the ohloh repository for tracking. That said; we would not be able to apply this migration until we are ready to deploy PURR in to production since it would break the `attachment` model. However, we would want to run this migration every Monday after successful restoration of the production database into ohloh-qa-db.",rb,1,1,0
"@@ -20,7 +20,7 @@ module RSpec
         # @example
         #    format_duration(1) #=>  ""1 minute 1 second""
         #    format_duration(135.14) #=> ""2 minutes 15.14 seconds""
-        def format_duration(duration)
+        def self.format_duration(duration)
           precision = case
                       when duration < 1;    SUB_SECOND_PRECISION
                       when duration < 120;  DEFAULT_PRECISION","Should these be module functions instead, so `Helpers` can still act like a module? ""Class"" methods on modules have always confused me.",rb,1,1,1
"@@ -45,7 +45,8 @@ public class Grid {
 
   public List<Node> getNodes() {
     return distributorStatus.get().getNodes().stream()
-      .map(summary -> new Node(summary.getNodeId(), summary.getUri(), summary.isUp(), summary.getMaxSessionCount()))
+      .map(summary -> new Node(summary.getNodeId(), summary.getUri(), summary.isUp(),
+                               summary.getMaxSessionCount(), summary.getStereotypes()))
       .collect(ImmutableList.toImmutableList());
   }
 ",Break things on to one parameter per line now.,rb,1,1,1
"@@ -187,6 +187,16 @@ describe Blacklight::SearchBuilder do
     end
   end
 
+  describe ""#facet"" do
+    it ""should be nil if no value is set"" do
+      expect(subject.facet).to be_nil
+    end
+
+    it ""should set facet value"" do
+      expect(subject.facet('format').facet).to eq 'format'
+    end
+  end
+
   describe ""#search_field"" do
     it ""should use the requested search field"" do
       blacklight_config.add_search_field 'x'",Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,1,1,1
"@@ -134,5 +134,9 @@ class UserRolesControllerTest < ActionController::TestCase
     end
     assert_redirected_to user_path(target_user.display_name)
     assert_equal ""The string `no_such_role' is not a valid role."", flash[:error]
+
+    # Revoking administrator role from current user should fail
+    post :revoke, :params => { :display_name => administrator_user.display_name, :role => ""administrator"" }
+    assert_redirected_to user_path(administrator_user.display_name)
   end
 end",Can we assert that the flash message is shown here... I think there some examples of doing it in other tests.,rb,1,1,1
"@@ -0,0 +1,17 @@
+require 'travis/build/appliances/base'
+
+module Travis
+  module Build
+    module Appliances
+      class NpmRegistry < Base
+        def apply
+          if data[:npm_registry]
+            sh.fold ""npm_registry"" do
+              sh.export 'NPM_CONFIG_REGISTRY', data[:npm_registry], echo: true
+            end
+          end
+        end
+      end
+    end
+  end
+end",This logic should be moved to `apply?`.,rb,0,1,1
"@@ -1,9 +1,12 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 # SPDX - License - Identifier: Apache - 2.0
 
+# Purpose
 # This code example demonstrates how to use an RSA public key to
 # encrypt content and then upload that encrypted content
-# to an Amazon S3 bucket.
+# to an Amazon Simple Storage Solution (Amazon S3) bucket.
+
+# snippet-start:[s3.ruby.s3_add_cspk_encrypt_item]
 
 require 'aws-sdk-s3'
 require 'openssl'",Simple Storage **Service**,rb,0,0,0
"@@ -117,7 +117,7 @@ Puppet::Functions.create_function(:run_plan, Puppet::Functions::InternalFunction
         # undef/nil
         result = catch(:return) do
           scope.with_global_scope do |global_scope|
-            closure.call_by_name_with_scope(global_scope, params, true)
+            executor.run_plan(global_scope, closure, params)
           end
           nil
         end&.value",@McdonaldSeanp I think this will help you longterm too but heads up.,rb,0,0,1
"@@ -20,7 +20,7 @@ class Coupon
   end
 
   def valid?
-    stripe_coupon.present?
+    stripe_coupon.present? && stripe_coupon.valid
   end
 
   private","Just to be sure, the `stripe_coupon` has the method `valid`, not `valid?`?",rb,1,1,1
"@@ -255,7 +255,7 @@ module Blacklight::UrlHelperBehavior
 
     # Delete any request params from facet-specific action, needed
     # to redir to index action properly. 
-    new_params.except! *Blacklight::Solr::FacetPaginator.request_keys.values
+    new_params.except! *blacklight_config.facet_paginator_class.request_keys.values
 
     new_params 
   end",Line is too long. [83/80],rb,1,1,1
"@@ -1,6 +1,6 @@
 FactoryGirl.define do
   factory :user do
-    client_slug { ENV['CLIENT_SLUG_DEFAULT'] || 'ncr' }
+    client_slug { ENV['CLIENT_SLUG_DEFAULT'] || nil }
     sequence(:email_address) {|n| ""user#{n}@example.com"" }
     sequence(:first_name) {|n| ""FirstName#{n}"" }
     sequence(:last_name) {|n| ""LastName#{n}"" }","maybe we should just set to `nil` rather than using env var? I haven't ever set it, so not sure what the use case for env var is.",rb,1,1,1
"@@ -526,6 +526,7 @@ module Bolt
     end
 
     def apply_manifest(code, targets, filename = nil, noop = false)
+      Puppet[:tasks] = false
       ast = pal.parse_manifest(code, filename)
 
       executor = Bolt::Executor.new(config.concurrency, analytics, noop)",Was this a bug?,rb,1,0,1
"@@ -0,0 +1,15 @@
+# frozen_string_literal: truer
+
+equire_relative 'test_helper'
+
+def setup
+  @tester = Faker::GratefulDead
+end
+
+def test_player
+  assert @tester.player.match(/\w/)
+end
+
+def test_song
+  assert @tester.song.match(/\w/)
+end",It should be `true` instead of `truer`.,rb,1,1,1
"@@ -27,10 +27,11 @@ class IdentifierPresenter
     return _(""None defined"") if id.new_record? || id.value.blank?
 
     without = id.value_without_scheme_prefix
-    return id.value unless without != id.value && !without.starts_with?(""http"")
+    prefix = with_scheme_name ? id.identifier_scheme.description + "": "" : ''
+    return prefix + id.value unless without != id.value && !without.starts_with?(""http"")
 
     ""<a href=\""#{id.value}\"" class=\""has-new-window-popup-info\""> "" \
-      ""#{with_scheme_name ? id.identifier_scheme.description : ''}: #{without}</a>""
+      ""#{prefix} #{without}</a>""
   end
 
   private",Looks like rubocop prefers double quotes for the final `''` here,rb,1,1,1
"@@ -20,9 +20,17 @@ module Mongoid
   # against the database.
   class Criteria
     include Enumerable
+
+    # @api private
+    alias :_enumerable_find :find
+
     include Contextual
     include Queryable
     include Findable
+
+    # @api private
+    alias :_findable_find :find
+
     include Inspectable
     include Includable
     include Marshalable",why not put the aliases in the `Findable` module (inside the `included do` block)?,rb,1,1,1
"@@ -11,6 +11,10 @@ module ProductsHelper
     ""https://upcase.com/video_tutorials/21-intermediate-ruby-on-rails""
   end
 
+  def state_class_for(exercise)
+    exercise.status_for(current_user).state.parameterize
+  end
+
   def exercise_link(url, options = {}, &block)
     if current_user_has_access_to?(:exercises)
       link_to url, options, &block","This is going to run a lot of queries on the dashboard and products index; I'm not sure it will perform acceptably. When displaying the tooltips for trails, we'll have an `ExerciseWithProgress`, which will respond to `state`. One option would be to use this and define a default, empty `state` on `Exercise`. Thoughts?",rb,1,1,1
"@@ -0,0 +1,7 @@
+# frozen_string_literal: true
+# encoding: utf-8
+
+class Order
+  include Mongoid::Document
+  field :status, type: Mongoid::StringifiedSymbol
+end",Please add a newline a the end of file.,rb,1,1,1
"@@ -3,7 +3,7 @@ FactoryGirl.define do
 
   factory :api_token do
     access_token
-    step
+    step { create(:approval_step) }
     expires_at { Time.current + 7.days }
   end
 end",this is the actual fix?,rb,1,0,1
"@@ -1,9 +1,10 @@
 <figure class=""tile weekly-iteration <%= topic_slugs(video) %>"">
   <%= link_to video, title: video.name do %>
-    <%= render video.teachers %>
-    <h2>Weekly Iteration</h2>
     <h1><%= video.name %></h1>
-    <h3><%= teacher_names(video.teachers) %></h3>
-    <p class=""description""><%= truncate_html(format_markdown(video.notes)) %></p>
+    <%= render video.teachers %>
+    <h3 class=""teacher-names""><%= teacher_names(video.teachers) %></h3>
+    <p class=""description"">
+      <%= truncate_html(video.summary_or_notes, length: 250) %>
+    </p>
   <% end %>
 </figure>","I see `video.summary || video.notes` being used in more than one place, which suggests it might be business logic. How about `video.summary_or_notes`, or `video.description`?",rb,1,1,1
"@@ -1,5 +1,11 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
-# SPDX - License - Identifier: Apache - 2.0
+# SPDX-License-Identifier: Apache-2.0
+
+# Purpose
+# s3-ruby-example-access-permissions.rb demonstrates how to set the access control list (ACL) for an
+# Amazon Simple Storage Solution (Amazon S3) bucket for public access.
+
+# snippet-start:[s3.ruby.s3-ruby-example-access-permissions]
 
 require 'aws-sdk-s3'
 require 'net/http'",Simple Storage **Service**,rb,0,0,0
"@@ -1,5 +1,10 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
-# SPDX-License-Identifier: Apache-2.0
+# SPDX - License - Identifier: Apache - 2.0
+
+# Purpose
+# This code example demonstrates how to receives messages in a queue in Amazon Simple Queue Service (Amazon SQS).
+
+# snippet-start:[s3.ruby.sqs-ruby-example-get-messages.rb]
 
 require 'aws-sdk-sqs'
 require 'aws-sdk-sts'",receive (remove 's'),rb,1,0,0
"@@ -1,5 +1,18 @@
 feature ""Approve a Gsa18F procurement"" do
   context ""when signed in as the approver"" do
+    context ""last step is completed"" do
+      it ""sends one email to the requester"" do
+        procurement.individual_steps.first.complete!
+        deliveries.clear
+
+        login_as(purchaser)
+        visit proposal_path(proposal)
+        click_on(""Mark as Purchased"")
+
+        expect(deliveries.length).to eq(1)
+      end
+    end
+
     it ""the step execution button is correctly marked"" do
       login_as(approver)
 ",Would it be useful to ensure it sent the message to the right person?,rb,1,1,1
"@@ -1,4 +1,4 @@
-class ReplaceRegistrationLinkWithChargifyIdOnSections < ActiveRecord::Migration
+class ReplaceRegistrationLinkWithChargifyIdOnSections < ActiveRecord::Migration[4.2]
   def self.up
     remove_column :sections, :registration_link
     add_column :sections, :chargify_id, :string",Metrics/LineLength: Line is too long. [84/80],rb,1,1,1
"@@ -26,6 +26,7 @@ module Ncr
     before_validation :normalize_values
     before_update :record_changes
 
+    validates :amount, presence: true
     validates :cl_number, format: {
       with: /\ACL\d{7}\z/,
       message: ""must start with 'CL', followed by seven numbers""",spec for this? Looks like we don't have any validation specs in the spec file for this model -- would love to hear about why! Is there a philosophical opposition to specs for AR validations (I know many hold the view that they are not important because it's basically just double checking that you wrote a validation rather than testing behavior),rb,1,1,0
"@@ -41,6 +41,16 @@ describe RSpec do
     end
   end
 
+  describe "".current_example"" do
+    it ""sets the example being executed"" do
+      group = RSpec::Core::ExampleGroup.describe(""an example group"")
+      example = group.example(""an example"")
+
+      RSpec.current_example = example
+      expect(RSpec.current_example).to be(example)
+    end
+  end
+
   describe ""::reset"" do
     it ""resets the configuration and world objects"" do
       config_before_reset = RSpec.configuration",This spec seems to duplicate the one above (IMO) -- is there anything new being tested here?,rb,1,1,1
"@@ -318,4 +318,11 @@ public interface DriverCommand {
   // Mobile API
   String GET_NETWORK_CONNECTION = ""getNetworkConnection"";
   String SET_NETWORK_CONNECTION = ""setNetworkConnection"";
+
+  // Cast Media Router API
+  String GET_CAST_SINKS = ""getCastSinks"";
+  String SET_CAST_SINK_TO_USE = ""selectCastSink"";
+  String START_CAST_TAB_MIRRORING = ""startCastTabMirroring"";
+  String GET_CAST_ISSUE_MESSAGE = ""getCastIssueMessage"";  
+  String STOP_CASTING = ""stopCasting"";    
 }",These command names are specific to Chromium-based browsers. Please move to `ChromiumDriverCommand`,rb,1,1,1
"@@ -20,6 +20,7 @@ from selenium.common.exceptions import NoSuchFrameException
 from selenium.common.exceptions import StaleElementReferenceException
 from selenium.common.exceptions import WebDriverException
 from selenium.common.exceptions import NoAlertPresentException
+from selenium.common.exceptions import ElementNotVisibleException
 
 """"""
  * Canned ""Expected Conditions"" which are generally useful within webdriver",Is this an oversight for some code in the body?,rb,1,1,1
"@@ -28,11 +28,15 @@
 #  template_id                       :integer
 #  org_id                            :integer
 #  funder_id                         :integer
+#  grant_id                          :integer
+#  api_client_id                     :integer
 #
 # Indexes
 #
-#  index_plans_on_template_id  (template_id)
-#  index_plans_on_funder_id    (funder_id)
+#  index_plans_on_template_id   (template_id)
+#  index_plans_on_funder_id     (funder_id)
+#  index_plans_on_grant_id      (grant_id)
+#  index_plans_on_api_client_id (api_client_id)
 #
 # Foreign Keys
 #",We can do a pass through the code for all these TODO's after the Rails 5 migration. Thanks for keeping these up to date,rb,1,1,1
"@@ -16,6 +16,11 @@
     <span class=""divider"">
       <h4 class=""text"">Video</h4>
     </span>
+
+    <% if @video.trail.present? %>
+      <%= render ""trails/progress"", trail: @video.trail %>
+    <% end %>
+
     <%= render @video.preview, name: @video.name %>
 
     <section class='video-notes'>","I couldn't get this working locally, so it probably looks rough around the edges",rb,1,1,1
"@@ -82,7 +82,7 @@ module Mongoid
     def extract_embedded_attributes(attributes)
       atomic_position.split(""."").inject(attributes) do |attrs, part|
         attrs = attrs[part =~ /\d/ ? part.to_i : part]
-        attrs
+        attrs || {}
       end
     end
   end","I don't think this is correct. If there are not attributes at the specified path (`atomic_position`), this method should probably return nil and the docstring should be updated to reflect that.",rb,1,1,1
"@@ -53,6 +53,7 @@ class Topic < ActiveRecord::Base
       raw_trail_map = http.body_str
       self.trail_map = JSON.parse(raw_trail_map)
       self.summary = trail_map['description']
+      self.name = trail_map['name']
       if trail_map['prerequisites'].present?
         trail_map['prerequisites'].each do |related|
           self.related_topics << Topic.find_by_slug(related)",We should clean up this method by using the extract method pattern.,rb,1,1,1
"@@ -4,12 +4,13 @@ module Travis
       class Test
         class Scala < Test
           class Config < Hashr
-            define :scala => '2.9.1'
+            define :scala => 'undefined'
           end
 
           def setup
             super
-            shell.echo(""Using Scala #{config.scala}"")
+            # Tell what version of Scala is expected (or display 'undefined' if managed by build tool)
+            shell.echo(""Expect to run tests with Scala version '#{config.scala}'"")
           end
 
           def install",Should we find a better naming ? I think it's not so bad...,rb,1,1,1
"@@ -18,6 +18,8 @@ module RSpec::Core
       @failed_examples = []
       @pending_examples = []
       @duration = @start = @load_time = nil
+      @profiler = Profiler.new
+      register_listener @profiler, *Profiler::NOTIFICATIONS
     end
 
     # @private",:+1: I much prefer having this owned by the reporter rather than config.,rb,1,1,1
"@@ -1,9 +1,13 @@
 class ProductsController < ApplicationController
   def index
-    @courses = Course.only_public.by_position
+    @courses = Course.only_public.by_position.in_person
+    @online_courses = Course.only_public.by_position.online
+    # This @workshops line can be removed on 2013-01-16, when Product.workshops
+    # will be empty and all online workshops will be in Course. Remember to edit
+    # index.html.erb and remove @workshops there, too.
+    @workshops = Product.workshops.active.ordered
     @books = Product.books.active.ordered
     @videos = Product.videos.active.ordered
-    @workshops = Product.workshops.active.ordered
   end
 
   def show",Should we have integration coverage for this functionality?,rb,1,1,1
"@@ -36,7 +36,6 @@
                     plan: nil,
                     phase: phase,
                     readonly: true,
-                    question_guidance: {},
                     edit: false,
                     guidance_groups: [],
                     base_template_org: template.base_org,",Removed unused variable.,rb,1,1,1
"@@ -0,0 +1,5 @@
+package org.openqa.selenium.grid.session.remote;
+
+public class SessionTest {
+
+}",And another empty test. Please remove until there's content.,rb,1,1,1
"@@ -20,6 +20,8 @@ C2::Application.routes.draw do
   match ""/auth/:provider/callback"" => ""auth#oauth_callback"", via: [:get]
   get ""/auth/failure"" => ""auth#failure""
   post ""/logout"" => ""auth#logout""
+  resources :users, only: [:update]
+
   resources :help, only: [:index, :show]
 
   # mandrill-rails",Sweet! +100 for the better security and standards-compliance this change gives us.,rb,1,0,1
"@@ -227,14 +227,14 @@ module RSpec
               rescue Pending::SkipDeclaredInExample
                 # no-op, required metadata has already been set by the `skip`
                 # method.
-              rescue Exception => e
+              rescue AllExceptionsExcludingDangerousOnesOnRubiesThatAllowIt => e
                 set_exception(e)
               ensure
                 run_after_example
               end
             end
           end
-        rescue Exception => e
+        rescue Support::AllExceptionsExceptOnesWeMustNotRescue => e
           set_exception(e)
         ensure
           @example_group_instance = nil # if you love something... let it go",Namespaced here but not above?,rb,0,1,1
"@@ -2,6 +2,7 @@
 
 require 'pathname'
 require 'bolt/pal'
+require 'bolt/config'
 
 module Bolt
   class Project","This circular dependency seems weird, but I don't think we can remove the project dependency from config and I'm not sure where else to put `system_path` that makes sense...",rb,1,1,1
"@@ -161,6 +161,17 @@ module Beaker
       FileUtils.rm_rf(@vagrant_path)
     end
 
+    #snapshotting depends on https://github.com/scalefactory/vagrant-multiprovider-snap
+    def take_snapshot(hostname,snapshot_name)
+      @logger.debug ""Creating snapshot of #{hostname}""
+      vagrant_cmd(""snap take #{hostname} --name=#{snapshot_name}"")
+    end
+
+    def restore_snapshot(hostname,snapshot_name)
+      @logger.debug ""Restoring snapshot of #{hostname}""
+      vagrant_cmd(""snap rollback #{hostname} --name=#{snapshot_name}"")
+    end
+
     def vagrant_cmd(args)
       Dir.chdir(@vagrant_path) do
         exit_status = 1","I know that the rest of this file isn't properly yard doc-ed, but please include yard docs for any new methods.",rb,1,1,1
"@@ -0,0 +1,15 @@
+class HelpController < ApplicationController
+  layout 'help'
+
+  def index
+    dir = Rails.root.join('app', 'views', 'help', '*.md')
+    files = Dir.glob(dir)
+    @pages = files.map{|file| File.basename(file, '.md') }.sort
+  end
+
+  def show
+    page = params[:id]
+    # TODO make sure this isn't a security hole
+    render ""help/#{page}""
+  end
+end",Probably best to use a whitelist. Maybe pull out the listing logic in `index` into a shared function (or class var) to get such a list. Only render if `page` is a member of that list (404 otherwise)?,rb,1,1,1
"@@ -63,6 +63,17 @@ module Beaker
         raise ""Unable to create OpenStack Network instance (api_key: #{@options[:openstack_api_key]}, username: #{@options[:openstack_username]}, auth_url: #{@options[:openstack_auth_url]}, tenant: #{@options[:openstack_tenant]})""
       end
 
+      # Validate openstack_volume_support setting value, reset to boolean if passed via ENV value string
+      if not @options[:openstack_volume_support].is_a?(TrueClass) || @options[:openstack_volume_support].is_a?(FalseClass)
+        if @options[:openstack_volume_support].match(/\btrue\b/i)
+          @options[:openstack_volume_support] = true
+        elsif @options[:openstack_volume_support].match(/\bfalse\b/i)
+          @options[:openstack_volume_support] = false
+        else
+          raise ""Invalid value provided for CONFIG setting openstack_volume_support, current value #{@options[:openstack_volume_support]}""
+        end
+      end
+
     end
 
     #Provided a flavor name return the OpenStack id for that flavor","@ipcrm this seems like an awful lot of work for what you're trying to get at. Is there some use case where a string or something like that must be passed in, so you can't just rely on this being of type `TrueClass` or `FalseClass`? We would prefer to rely on people setting the yaml correctly and failing on the case when people have set the wrong type for these. That keeps the code here simple, and in places like hypervisors or parsers, it's not a lot of wasted time to fail since things are just getting started. also, it seems to be the case that if someone passed in a `FalseClass` `false` value, this wouldn't set the `@options[:openstack_volume_support]` value correctly, would it? I would imagine the outer if statement would need an else case to take care of that, no?",rb,0,1,0
"@@ -171,7 +171,9 @@ def verify_no_deny_list_words(file_contents, file_location):
 
 def verify_no_secret_keys(file_contents, file_location):
     """"""Verify the file does not contain 20- or 40- length character strings,
-    which may be secret keys. Allow strings in the allow list.""""""
+    which may be secret keys. Allow strings in the allow list in
+    https://github.com/awsdocs/aws-doc-sdk-examples/blob/master/scripts/checkin_tests.py,
+    and in and in src/allow.list.xml in the AWSDocsChecklistCodeSampleCatalog GitFarm repo.""""""
     error_count = 0
     twenties = re.findall(""[^A-Z0-9][A][ACGIKNPRS][A-Z]{2}[A-Z0-9]{16}[^A-Z0-9]"",
                           file_contents)","""and in and in"" -> ""and in"" (make same change to all occurrences in this doc).",rb,1,1,1
"@@ -94,6 +94,12 @@ module Beaker
             @cmd_options[:debug_errors] = bool
           end
 
+          opts.on '--exec-manual-tests',
+                  'Execute manual tests',
+                  '(default: false)' do |bool|
+            @cmd_options[:exec_manual_tests] = bool
+          end
+
           opts.on '--root-keys',
                   'Install puppetlabs pubkeys for superuser',
                   '(default: false)' do |bool|","In the current implementation of subcommands, this option will need to be copied over the `beaker test run` group.",rb,1,1,1
"@@ -65,10 +65,6 @@ class Product < ActiveRecord::Base
     type.underscore
   end
 
-  def fulfilled_with_github?
-    github_team.present?
-  end
-
   def to_aside_partial
     ""#{self.class.name.underscore.pluralize}/aside""
   end","This was actually unused on `master`, so I removed it instead of fixing it with this change.",rb,0,0,1
"@@ -16,6 +16,10 @@ class Topic < ActiveRecord::Base
 
   friendly_id :name, use: [:slugged, :finders]
 
+  def self.explorable
+    where(explorable: true)
+  end
+
   def to_s
     name
   end","I don't see this mentioned in the PR description. What does ""explorable"" mean?",rb,0,1,1
"@@ -190,6 +190,9 @@ class Purchase < ActiveRecord::Base
       full_price = purchaseable.send(:""#{variant}_price"")
       if coupon
         coupon.apply(full_price)
+      elsif stripe_coupon_id.present?
+        subscription_coupon = SubscriptionCoupon.new(stripe_coupon_id)
+        subscription_coupon.apply(full_price)
       else
         full_price
       end","After doing the Prime launch, I think refactoring `Purchase` would a good way to spend time while we collect post-launch data. Getting this `if` statement out using dependency injection would help remove some complexity.",rb,1,1,1
"@@ -8,6 +8,7 @@ class UserRolesController < ApplicationController
   before_action :require_valid_role
   before_action :not_in_role, :only => [:grant]
   before_action :in_role, :only => [:revoke]
+  before_action :not_revoke_admin_current_user
 
   def grant
     @this_user.roles.create(:role => @role, :granter => current_user)",This should only be applied to the `revoke` method but in fact this is so specific that I don't think there's any point making it a filter - the point of filters is that they can be shared across multiple methods but these even has the method name in it's name so clearly it only ever makes sense to apply it to revoke. As such I would just put the logic in the `revoke` method and get rid of the filter.,rb,1,1,1
"@@ -4,12 +4,11 @@ module Ncr
     MAX_UPLOADS_ON_NEW = 10
 
     def new
-      @approver_email = self.suggested_approver_email
+      @model_instance.approving_official_email = self.suggested_approver_email
       super
     end
 
     def create
-      @approver_email = params[:approver_email]
       super
     end
 ",I tend to use `self` for class methods only - thoughts on just using `suggested_approver_email` here?,rb,1,1,1
"@@ -10,4 +10,9 @@ module FeatureSpecHelper
     setup_mock_auth(:myusa, user)
     visit '/auth/myusa'
   end
+
+  def focus_field(field_id)
+    execute_script ""document.getElementById('#{field_id}').scrollIntoView()""
+    execute_script ""$('##{field_id}').focus()""
+  end
 end","since we'er only using this method once right now, I'd suggest putting it in the spec file where it is being used. Easier to check it out that way!",rb,1,1,1
"@@ -0,0 +1,13 @@
+require 'travis/build/appliances/base'
+
+module Travis
+  module Build
+    module Appliances
+      class AddGithubHostKey < Base
+        def apply
+          sh.raw %(grep '^github\\.com,' ~/.ssh/known_hosts >&/dev/null || echo 'github.com,204.232.175.90 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==' >> ~/.ssh/known_hosts)
+        end
+      end
+    end
+  end
+end",Can you use `ssh-keyscan` instead of a hardcoded key?,rb,1,1,1
"@@ -0,0 +1,19 @@
+require_relative ""../../../db/chores/roles_conversion""
+
+describe RolesConversion do
+  describe ""#ncr_budget_approvers"" do
+    it ""should convert NCR budget approvers"" do
+      expect {
+        RolesConversion.new.ncr_budget_approvers
+      }.to_not change { User.count }
+    end
+
+    it ""should be idempotent based on client_slug+role"" do
+      with_env_var('NCR_BA61_TIER1_BUDGET_MAILBOX', 'someoneelse@example.com') do
+        expect {
+          RolesConversion.new.ncr_budget_approvers
+        }.to_not change { User.count }
+      end
+    end
+  end
+end",this seems brittle. what happens when we (inevitably) reorganize the file structure of the tests?,rb,1,1,1
"@@ -20,13 +20,15 @@ Workshops::Application.routes.draw do
     resource :team, only: :edit
   end
 
-  get '/pages/tmux' => redirect('/products/4-humans-present-tmux')
+  get '/pages/tmux' => redirect('https://www.youtube.com/watch?v=CKC8Ph-s2F4')
 
   if Rails.env.staging? || Rails.env.production?
     get '/products/:id' => redirect('/workshops/18-test-driven-rails'),
       constraints: { id: /(10|12).*/ }
     get '/products/:id' => redirect('/workshops/19-design-for-developers'),
       constraints: { id: /(9|11).*/ }
+    get '/products/:id' => redirect('https://www.youtube.com/watch?v=CKC8Ph-s2F4'),
+      constraints: { id: /(4).*/ }
     get '/products/14' => redirect('/prime')
     get '/products/14-prime' => redirect('/prime')
   end",Align the elements of a hash literal if they span more than one line.,rb,1,1,1
"@@ -2,7 +2,7 @@
   tool_name = Rails.configuration.branding[:application][:name]
   link = accept_invitation_url(@resource, :invitation_token => @token)
   helpdesk_email = Rails.configuration.branding[:organisation][:helpdesk_email]
-  contact_us_url = Rails.configuration.branding[:organisation][:contact_us_url] || contact_us_url
+  contact_us = (Rails.configuration.branding[:organisation][:contact_us_url] || contact_us_url)
   email_subject = _('Query or feedback related to %{tool_name}') %{ :tool_name => tool_name }
 %>
 <% FastGettext.with_locale FastGettext.default_locale do %>","thanks for changing it, the rename is for sure safer!",rb,1,0,1
"@@ -27,7 +27,7 @@ describe 'episodes/index.xml.builder' do
     end
 
     it 'has an updated date of the most recently published episode' do
-      @xml.css('channel pubDate').first.text.should == 1.day.ago.xmlschema.to_s
+      @xml.css('channel pubDate').first.text.should == 1.day.ago.to_s(:rfc822)
     end
 
     it 'includes both episodes' do",Its unfortunate that the previous tests didn't catch the incorrect format because we're just testing against itself. This change has the same problem. Do you think it'd be better to actually check the string has the right format more manually?,rb,1,1,1
"@@ -6,6 +6,15 @@ RSpec.describe RSpec::Core::Formatters::BaseFormatter do
   let(:output)    { StringIO.new }
   let(:formatter) { RSpec::Core::Formatters::BaseFormatter.new(output) }
 
+  describe '#notifications' do
+    it 'knows which notifications it responds to' do
+      expect(formatter.notifications).to eq([
+        :start, :example_group_started, :example_started, :example_pending,
+        :example_failed, :dump_summary, :close
+      ])
+    end
+  end
+
   describe ""read_failed_line"" do
     it ""deals gracefully with a heterogeneous language stack trace"" do
       exception = double(:Exception, :backtrace => [",This exact list seems to make for a brittle spec. What value do you find in listing them all out here? It's duplicating what's already in the `notifications` method...,rb,1,1,1
"@@ -146,7 +146,7 @@ module RSpec::Core
       # Returns the message generated for this failure line by line.
       #
       # @return [Array(String)] The example failure message
-      def message_lines
+      def message_lines(default_color_proc=lambda {|x| x })
         @lines ||=
           begin
             lines = [""Failure/Error: #{read_failed_line.strip}""]",This seems more convoluted then what you had before :(. @JonRowe -- can you suggest a way to do this that you'd be satisfied with?,rb,0,0,1
"@@ -110,7 +110,7 @@ describe RSpec::Core::Formatters::BaseTextFormatter do
     context 'for #share_examples_for' do
       it 'outputs the name and location' do
 
-        share_examples_for 'foo bar' do
+        group.share_examples_for 'foo bar' do
           it(""example name"") { expect(""this"").to eq(""that"") }
         end
 ",Why the need to change from `share_examples_for` to `group.share_examples_for` here and elsewhere? It suggests that you've made this much more of a breaking change...,rb,1,1,1
"@@ -17,7 +17,7 @@ class ManagersControllerTest < ActionController::TestCase
     login_as accounts(:admin)
     get :index, project_id: @proj.to_param
     must_respond_with :success
-    assert_tag tag: 'a', attributes: { class: 'btn btn-primary' }
+    must_select 'a.btn.btn-primary'
     assert_select '.col-md-4 a.btn.btn-primary', text: 'I manage this project on Open Hub'
   end
 ",assert_tag is missing. Must switch to assert_select syntax.,rb,1,1,1
"@@ -84,9 +84,12 @@ module Travis
 
           def submodules
             self.if '-f .gitmodules' do
+              if config[:git][:submodules_depth]
+                depth_opt = "" --depth=#{config[:git][:submodules_depth]}""
+              end
               cmd 'echo -e ""Host github.com\n\tStrictHostKeyChecking no\n"" >> ~/.ssh/config', echo: false
               cmd 'git submodule init', fold: ""git.#{next_git_fold_number}""
-              cmd 'git submodule update', assert: true, fold: ""git.#{next_git_fold_number}"", retry: true
+              cmd ""git submodule update #{depth_opt}"", assert: true, fold: ""git.#{next_git_fold_number}"", retry: true
             end
           end
 ",won't this explode if `depth_opt` isn't set?,rb,1,1,1
"@@ -4,3 +4,5 @@
 
 <%= t(""mailer.cancelation_mailer.cta"") %>
 <%= proposal_url(@proposal) %>
+
+<%= t(""mailer.footer"", feedback_url: feedback_url) %>",Just to make sure - This is a template that needs a second pass right? The footer is a part of the actual base template again.,rb,1,1,1
"@@ -201,6 +201,9 @@ r lw(\n(.lu*75u/100u).'
         result << %(.sp
 #{counter}. #{manify terms.map {|dt| dt.text }.join ' '}
 .RS 4)
+      when 'horizontal'
+        result << %(.TP
+#{manify terms.map {|dt| dt.text }.join(', '), whitespace: :normalize})
       else
         result << %(.sp
 #{manify terms.map {|dt| dt.text }.join(', '), whitespace: :normalize}",I tried this and it doesn't seem to have any effect. Can you clarify how the TP macro works?,rb,1,1,1
"@@ -544,7 +544,7 @@ module RSpec
       def reporter
         @reporter ||= begin
                         add_formatter('progress') if formatters.empty?
-                        add_formatter(RSpec::Core::Formatters::DeprecationFormatter, deprecation_stream, output_stream)
+                        formatters << RSpec::Core::Formatters::DeprecationFormatter[deprecation_stream, output_stream]
                         Reporter.new(*formatters)
                       end
       end",Wait what are the `[` brackets doing here?,rb,1,1,1
"@@ -1,7 +1,5 @@
 class Exercise < ActiveRecord::Base
-  has_many :classifications, as: :classifiable, dependent: :destroy
   has_many :statuses, as: :completeable, dependent: :destroy
-  has_many :topics, through: :classifications
   has_one :trail, through: :step, as: :completeables
   has_one :step, dependent: :destroy, as: :completeable
 ",Should we have a migration to delete classification data for exercises? Is there any?,rb,1,1,1
"@@ -4,18 +4,6 @@
     <h1 id=""project_title"">The Communicart for Common Acquisition Platform</h1>
   </div>
   <div class=""home-main-body"">
-        <% unless signed_in? %>
-        <div class=""lightbox"">
-            <div class=""needs-auth"">
-              <h3>Please sign in</h3>
-              <p>In order to view this page, you'll need to sign in with a MyUSA account.</p>
-              <link href='//fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
-              <link href='//s3.amazonaws.com/myusa-static/button.min.css' rel='stylesheet' type='text/css'>
-              <%= link_to 'Connect with MyUSA', ""/auth/myusa"", :class => 'btn btn-social btn-myusa' %>
-            </div>
-        </div>
-        <% end %>
-
       <div class=""row"">
         <div class=""col-sm-12"">
           <h2 id=""project_tagline"">&quot;P-Card holders deserve easy, modern, automated management of their shopping carts.&quot;</h2>",Can we get rid of the lightbox JS/CSS if we're not using it?,rb,1,1,1
"@@ -322,9 +322,13 @@ HELP
 
     def execute_plan(options)
       Bolt.config = options
-      result = run_plan(options[:object],
-                        options[:task_options],
-                        options[:modules])
+      begin
+        result = run_plan(options[:object],
+                          options[:task_options],
+                          options[:modules])
+      rescue Puppet::Error
+        raise Bolt::CLIError, ""Exiting because of an error in Puppet code""
+      end
       puts result
     end
 ",if you raise Bolt::CLIError here it will also set a failure exit code,rb,1,1,1
"@@ -0,0 +1,18 @@
+#!/usr/bin/env ruby
+# frozen_string_literal: true
+
+def facter_executable
+  if ENV.key? 'Path'
+    ENV['Path'].split(';').each do |p|
+      if p =~ /Puppet\\bin\\?$/
+        return File.join(p, 'facter')
+      end
+    end
+    'C:\Program Files\Puppet Labs\Puppet\bin\facter'
+  else
+    '/opt/puppetlabs/puppet/bin/facter'
+  end
+end
+
+# Delegate to facter
+exec(facter_executable, '--json')","I want to double check this works, but this all makes sense to me.",rb,1,1,1
"@@ -509,7 +509,8 @@ module Blacklight::SolrHelper
     # override any field-specific default in the solr request handler. 
     solr_params[:""f.#{facet_field}.facet.limit""]  = limit + 1
     solr_params[:""f.#{facet_field}.facet.offset""] = ( input.fetch(Blacklight::Solr::FacetPaginator.request_keys[:page] , 1).to_i - 1 ) * ( limit )
-    solr_params[:""f.#{facet_field}.facet.sort""] = input[  Blacklight::Solr::FacetPaginator.request_keys[:sort] ] if  input[  Blacklight::Solr::FacetPaginator.request_keys[:sort] ]   
+    solr_params[:""f.#{facet_field}.facet.sort""] = input[  Blacklight::Solr::FacetPaginator.request_keys[:sort] ] if  input[  Blacklight::Solr::FacetPaginator.request_keys[:sort] ]
+    solr_params[:""f.#{facet_field}.facet.prefix""] = input.fetch(Blacklight::Solr::FacetPaginator.request_keys[:prefix] , """") 
     solr_params[:rows] = 0
 
     return solr_params","I think it'd be better not to send the facet.prefix at all, if no prefix is required (although I supposed solr probably checks if the string is null or empty when applying defaults?)",rb,1,1,1
"@@ -163,8 +163,10 @@ module Blacklight::FacetsHelperBehavior
   # @option options [Array<String>]  an array of classes to add to count span.
   # @return [String]
   def render_facet_count(num, options = {})
-    classes = (options[:classes] || []) << ""facet-count""
-    content_tag(""span"", t('blacklight.search.facets.count', :number => number_with_delimiter(num)), :class => classes)
+    classes = (options[:classes] || [])
+    content_tag(""div"", :class => ""facet-count"") do
+      content_tag(""span"", t('blacklight.search.facets.count', :number => number_with_delimiter(num)), :class => classes)
+    end
   end
   
   ##",What benefit does the new `div` give us?,rb,1,1,1
"@@ -1,5 +1,5 @@
 # Load the Rails application.
-require File.expand_path('../application', __FILE__)
+require_relative 'application'
 
 # Initialize the Rails application.
-Upcase::Application.initialize!
+Rails.application.initialize!",Style/StringLiterals: Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,0,1,1
"@@ -1,13 +1,13 @@
 class Loader
   def self.import_articles_and_topics(posts)
     posts.each do |post|
+      next if post[:tags].include?(""this week in open source"")
       article = Article.find_or_initialize_by_title_and_published_on(post[:title],post[:published_at])
       unless article.persisted?
         article.body_html = post[:body_html]
         article.tumblr_url = post[:tumblr_url]
         article.save!
         post[:tags].each do |tag|
-          puts tag.downcase
           topic = Topic.find_by_slug(tag.downcase.parameterize)
           if topic.nil?
             topic = Topic.new",Can we make this more generic and create an array of potential tags to be excluded from the import? There will be more.,rb,1,1,1
"@@ -64,6 +64,19 @@ describe ""when running a plan that manipulates an execution result"", ssh: true d
       end
     end
 
+    context 'with $future flag' do
+      it 'exposes `status` method for result and renames `result` to `value`' do
+        with_tempfile_containing('conf', { future: true }.to_json) do |conf|
+          params = { nodes: uri }.to_json
+          additional_flags = config_flags + ['--configfile', conf.path.to_s]
+          result = run_cli(['plan', 'run', 'results::test_result', ""--params"", params] + additional_flags)
+          expect(@log_output.readlines)
+            .to include(""NOTICE  Puppet : Result status: success\n"")
+          expect(JSON.parse(result).first).to include('value')
+        end
+      end
+    end
+
     it 'exposes errrors for results' do
       params = { target: uri }.to_json
       output = run_cli(['plan', 'run', 'results::test_error', ""--params"", params] + config_flags)",We should update run_cli to unset `$future`,rb,1,1,1
"@@ -0,0 +1,17 @@
+module Blacklight
+  module Rendering
+    class Microdata < AbstractStep
+      include ActionView::Helpers::TagHelper
+      def render
+        return next_step(values) unless config.itemprop
+        next_step(values.map { |x| itemprop(x, config.itemprop) })
+      end
+
+      private
+
+        def itemprop(val, itemprop)
+          content_tag :span, val, itemprop: itemprop
+        end
+    end
+  end
+end",2 trailing blank lines detected.,rb,1,0,1
"@@ -327,6 +327,16 @@ class FirefoxProfile(object):
                     rc.append(node.data)
             return ''.join(rc).strip()
 
+        def parse_manifest_json(content):
+            """"""Extracts the details from the contents of a WebExtensions `manifest.json` file.""""""
+            manifest = json.loads(content)
+            return {
+                'id': manifest['applications']['gecko']['id'],
+                'version': manifest['version'],
+                'name': manifest['version'],
+                'unpack': False,
+            }
+
         if not os.path.exists(addon_path):
             raise IOError('Add-on path does not exist: %s' % addon_path)
 ",The id is not mandatory for web extensions. Could you update this to support a web extension without an id?,rb,1,1,1
"@@ -33,6 +33,7 @@ module Travis
           # easier to find and our `git clone`'d libraries are found by the
           # `go` commands.
           set 'GOPATH', ""#{HOME_DIR}/gopath:$GOPATH""
+          set 'PATH', ""$PATH:$GOPATH/bin""
           cmd ""mkdir -p #{HOME_DIR}/gopath/src/#{data.source_host}/#{data.slug}"", assert: false, timing: false
           cmd ""rsync -az ${TRAVIS_BUILD_DIR}/ #{HOME_DIR}/gopath/src/#{data.source_host}/#{data.slug}/"", assert: false, timing: false
           set ""TRAVIS_BUILD_DIR"", ""#{HOME_DIR}/gopath/src/#{data.source_host}/#{data.slug}""",does GVM do this for us?,rb,1,1,1
"@@ -9,10 +9,15 @@ FactoryGirl.define do
     rwa_number ""R1234567"" # TODO remove, since it's not applicable for BA61
     org_code Ncr::Organization.all[0].to_s
     project_title ""NCR Name""
+    sequence(:approving_official_email) {|n| ""approver#{User.count}@some-cartoon-show.com"" }
     association :proposal, flow: 'linear'
 
     trait :with_approvers do
+      # TODO use wo.setup_approvals_and_observers instead
       association :proposal, :with_serial_approvers, flow: 'linear'
+      after :create do |wo|
+        wo.approving_official_email = wo.approving_official.email_address
+      end
     end
 
     trait :is_emergency do",PT story for this?,rb,0,0,0
"@@ -95,6 +95,16 @@ module Rails
         end
       end
 
+      # Expose database runtime to controller for logging.
+      initializer ""mongoid.log_runtime"" do
+        require ""mongoid/railties/controller_runtime""
+        ActiveSupport.on_load(:action_controller) do
+          include ::Mongoid::Railties::ControllerRuntime
+        end
+      end
+
+
+
       config.after_initialize do
         # Unicorn clears the START_CTX when a worker is forked, so if we have
         # data in START_CTX then we know we're being preloaded. Unicorn does",:scissors: empty spaces please.,rb,1,1,0
"@@ -40,7 +40,7 @@ public class BazelBuild {
     if (target == null || """".equals(target)) {
       throw new IllegalStateException(""No targets specified"");
     }
-    log.info(""\nBuilding "" + target + "" ..."");
+    log.finest(""\nBuilding "" + target + "" ..."");
 
     ImmutableList.Builder<String> builder = ImmutableList.builder();
     builder.add(""bazel"", ""build"", target);",This is to let people know that the tooling is doing something during a build. Please leave.,rb,1,1,1
"@@ -37,11 +37,10 @@ class Proposal < ActiveRecord::Base
   visitable # Used to track user visit associated with processed proposal
 
   has_many :steps
-  has_many :individual_steps, ->{ individual }, class_name: ""Steps::Individual""
   has_many :approval_steps, class_name: ""Steps::Approval""
   has_many :purchase_steps, class_name: ""Steps::Purchase""
-  has_many :completers, through: :individual_steps, source: :completer
-  has_many :api_tokens, through: :individual_steps
+  has_many :completers, through: :steps, source: :completer
+  has_many :api_tokens, through: :steps
   has_many :attachments, dependent: :destroy
   has_many :comments, -> { order(created_at: :desc) }, dependent: :destroy
 ",does this need a scope to `individual` -- the parent (root) step will never have a completer.,rb,1,1,1
"@@ -27,7 +27,7 @@ import org.openqa.selenium.internal.Locatable;
  */
 public abstract class SingleKeyAction extends KeysRelatedAction {
   protected final Keys key;
-  private static final Keys[] MODIFIER_KEYS = {Keys.SHIFT, Keys.CONTROL, Keys.ALT};
+  private static final Keys[] MODIFIER_KEYS = {Keys.SHIFT, Keys.CONTROL, Keys.ALT, Keys.META, Keys.COMMAND, Keys.LEFT_ALT, Keys.LEFT_CONTROL, Keys.LEFT_SHIFT};
 
   protected SingleKeyAction(Keyboard keyboard, Mouse mouse, Keys key) {
     this(keyboard, mouse, null, key);","LEFT_ALT, LEFT_CONTROL, and LEFT_SHIFT should already be aliases. META could be an alias for ALT but probably isn't yet.",rb,1,1,1
"@@ -626,6 +626,8 @@ context 'Substitutions' do
       assert_equal %q{<a href=""mailto:author+website@4fs.no"">author+website@4fs.no</a>}, para.sub_macros(para.source)
       para = block_from_string('john@domain.uk.co')
       assert_equal %q{<a href=""mailto:john@domain.uk.co"">john@domain.uk.co</a>}, para.sub_macros(para.source)
+      para = block_from_string('bert&ernie@sesamestreet.com')
+      assert_equal %q{<a href=""mailto:bert&amp;ernie@sesamestreet.com"">bert&amp;ernie@sesamestreet.com</a>}, para.apply_subs(para.source)
     end
 
     test 'should ignore escaped inline email address' do",For a second I read Bernie! Feel the Bern,rb,0,0,0
"@@ -449,7 +449,11 @@ module Beaker
             if host.is_pe?
               bounce_service( host, 'pe-httpd' )
             else
-              stop_puppet_from_source_on( host ) if puppet_master_started
+              if puppet_master_started
+                stop_puppet_from_source_on( host )
+              else
+                dump_puppet_log(host)
+              end
             end
 
           rescue Exception => teardown_exception",If I understand this correctly `puppet_master_started` won't be set if backing up the puppet.conf or laying down the new puppet.conf errors and so in those cases there will always be a `teardown_exception` of `NoMethodError`. Does that seem correct? I think we should probably initialize `puppet_master_started` to `false` before the begin block if my reading of this is correct.,rb,1,1,1
"@@ -0,0 +1,14 @@
+MAIL_SETTINGS = {
+  :address        => 'smtp.sendgrid.net',
+  :port           => '587',
+  :authentication => :plain,
+  :user_name      => ENV['SENDGRID_USERNAME'],
+  :password       => ENV['SENDGRID_PASSWORD'],
+  :domain         => 'heroku.com'
+}
+
+if ENV[""EMAIL_RECIPIENTS""]
+  Mail.register_interceptor(
+    RecipientInterceptor.new(ENV.fetch(""EMAIL_RECIPIENTS""))
+  )
+end",Put a comma after the last parameter of a multiline method call.,rb,1,1,1
"@@ -4,10 +4,9 @@
     <!-- if the user has projects -->
     <p>
       <% if @plans.count > 0 %>
-        <%= _('The table below lists the plans that you have created, and any that have been shared with you by others.') %><br />
-        <%= _('These can be edited, shared, exported or deleted at anytime.')%>
+        <%= _('The table below lists the plans that you have created, and that have been shared with you by others. You can edit, share, download, make a copy, or remove these plans at any time.')%>
       <% else %>
-        <strong><%= _(""Welcome."") %></strong><br />
+        <strong><%= _(""Welcome"") %></strong><br />
         <%= _(""You are now ready to create your first DMP."") %><br />
         <%= _(""Click the 'Create plan' button below to begin."")%>
       <% end %>",not sure when this got merged but we should get the habit of using length instead of count to avoid an extra query,rb,1,1,1
"@@ -72,7 +72,8 @@ RSpec.describe ""FailedExampleNotification"" do
     let(:exception) { instance_double(Exception, :backtrace => [ ""#{__FILE__}:#{__LINE__}""], :message => 'Test exception') }
 
     before do
-      allow(example).to receive(:example_group) { class_double(RSpec::Core::ExampleGroup, :metadata => {}, :parent_groups => []) }
+      metadata = {:shared_group_name => 'double shared group'}
+      allow(example).to receive(:example_group) { class_double(RSpec::Core::ExampleGroup, :metadata => metadata, :parent_groups => [], location: ""#{__FILE__}:#{__LINE__}"") }
     end
 
     it 'should return failure_lines without color' do","You need to use hash rocket syntax here, as we support `1.8.7` and this breaks the travis build. Also why is this necessary, it's not clear to me...",rb,1,1,1
"@@ -29,7 +29,7 @@ import org.openqa.selenium.remote.service.DriverService;
  *
  * @see <a href=""https://chromium.googlesource.com/chromium/src/+/master/chrome/test/chromedriver/client/command_executor.py"">List of ChromeWebdriver commands</a>
  */
-class ChromeDriverCommandExecutor extends DriverCommandExecutor {
+public class ChromeDriverCommandExecutor extends DriverCommandExecutor {
 
   private static final ImmutableMap<String, CommandInfo> CHROME_COMMAND_NAME_TO_URL = ImmutableMap.of(
       ChromeDriverCommand.LAUNCH_APP,",This states very clearly that this is a derivative of Chrome and not Chromium. Do we need to extract an abstract `ChromiumCommandExecutor` and have both Edge and Chrome derive from that?,rb,1,1,1
"@@ -23,4 +23,14 @@ module RSpecHelpers
     end
   end
 
+  def expect_deprecation_with_call_site(file, line)
+    expect(RSpec.configuration.reporter).to receive(:deprecation) do |options|
+      expect(options[:call_site]).to include([file, line].join(':'))
+    end
+  end
+
+  def allow_deprecation
+    allow(RSpec.configuration.reporter).to receive(:deprecation)
+  end
+
 end","I can't get this helper to fail. I've passed incorrect line numbers and it always passes. I see the block get run, but it doesn't seem this inner expectation is properly raised.",rb,0,0,1
"@@ -3,7 +3,7 @@
 
 # Purpose:
 # sns-ruby-example-create-topic.rb demonstrates how to create an Amazon Simple Notification Services (SNS) topic using
-# the AWS SDK for JavaScript (v3).
+# the AWS SDK for Ruby.
 
 # Inputs:
 # - REGION",Simple Notification **Service** (singular),rb,0,0,0
"@@ -1,10 +1,13 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 # SPDX - License - Identifier: Apache - 2.0
 
+# Purpose
+# This code example demonstrates how to configure an Amazon Simple Storage Solution (Amazon S3) bucket as a static website.
+
+# snippet-start:[s3.s3_ruby_bucket_website.rb]
+
 require 'aws-sdk-s3'
 
-# Configures an Amazon S3 bucket as a static website.
-#
 # Prerequisites:
 #
 # - An Amazon S3 bucket.",Simple Storage **Service**,rb,0,0,0
"@@ -201,6 +201,14 @@ module RSpec
           end
         end
 
+        # Just like `subject`, except the block is invoked by an implicit `before`
+        # hook. This serves a dual purpose of setting up state and providing a
+        # memoized reference to that state.
+        def subject!(name=nil, &block)
+          subject(name, &block)
+          before { __send__(:subject) }
+        end
+
         attr_reader :explicit_subject_block
 
         private",It'd be good to have full yard docs for this....care to take a stab at that?,rb,1,1,1
"@@ -7,3 +7,9 @@ get(
   as: :book,
   constraints: LicenseableConstraint.new(Book)
 )
+
+get '/backbone-js-on-rails' => redirect('https://gumroad.com/l/backbone-js-on-rails')
+get '/geocoding-on-rails' => redirect('https://gumroad.com/l/geocoding-on-rails')
+get '/ios-on-rails' => redirect('https://gumroad.com/l/ios-on-rails')
+get '/ios-on-rails-beta' => redirect('https://gumroad.com/l/ios-on-rails')
+get '/ruby-science' => redirect('https://gumroad.com/l/ruby-science')",I actually think this is `ios-on-rails-beta`,rb,1,0,1
"@@ -4,6 +4,12 @@
 <div class=""text-box-wrapper"">
   <div class=""text-box"">
     <p>Thank you for purchasing <%= @purchaseable.name %>.</p>
+
+    <% if subscription = current_user.subscription and !subscription.active? %>
+      <p>It appears you stopped subscribing to <%= @purchaseable.name %> on
+      <%= l subscription.deactivated_on, format: :long %>. If you would like
+      to resubscribe, please <%= mail_to 'learn@thoughtbot.com', 'contact us' %>.</p>
+    <% end %>
   </div>
 </div>
 ",What do you think about extracting this conditional into a method?,rb,1,1,1
"@@ -93,6 +93,19 @@ describe TeamPlan do
     end
   end
 
+  describe '#fulfill' do
+    it 'starts a subscription' do
+      user = build_stubbed(:user)
+      purchase = build_stubbed(:purchase, user: user)
+      plan = build_stubbed(:team_plan)
+      fulfillment = stub_subscription_fulfillment(purchase)
+
+      plan.fulfill(purchase, user)
+
+      expect(fulfillment).to have_received(:fulfill)
+    end
+  end
+
   def team_plan
     build(:team_plan)
   end",Looks like one more instance of the method pointed out above.,rb,0,0,1
"@@ -72,8 +72,6 @@ class ApiKeysController < ApplicationController
     @api_key = ApiKey.find params[:id]
   rescue ActiveRecord::RecordNotFound
     raise ParamRecordNotFound
-  rescue e
-    raise e
   end
 
   def find_models","Is this a part of the effort of masking `ActiveRecord::RecordNotFound` reports in our monitoring software? If so, I suspect it may not do what we want. I think the monitoring software will detect the creation of any error. After all, we handle `ActiveRecord::RecordNotFound` errors and show a 404 page in most instances. The exception is being handled, but is still being reported. I suspect that to really prevent non-error exceptions, like when users ask for non-existent records, we will need to use ActiveRecord to find records without raising exceptions; i.e.: using `Account.find_by login: params[login]`",rb,1,1,0
"@@ -29,10 +29,9 @@ module Faker
         fetch('elder_scrolls.first_name')
       end
 
-      def first_name
+      def last_name
         fetch('elder_scrolls.last_name')
       end
-
     end
   end
 end",Fixing duplicated methods. Copy and   and adding specs for the new methods,rb,0,0,1
"@@ -1,4 +1,5 @@
 module Reverification
+  # rubocop:disable ClassLength
   class Process
     PILOT_AMOUNT = 5000
     class << self","Would be great, if we can avoid disabling/enabling the `ClassLength`",rb,1,1,1
"@@ -1171,6 +1171,18 @@ You can use icons for admonitions by setting the 'icons' attribute.
       output = render_string input, :safe => Asciidoctor::SafeMode::SAFE, :attributes => {'docdir' => File.dirname(__FILE__)}
       assert_xpath '//*[@class=""admonitionblock tip""]//*[@class=""icon""]/img[@src=""data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=""][@alt=""Tip""]', output, 1
     end
+
+    test 'can use font-based icons' do
+      input = <<-EOS
+:icons: font
+
+[TIP]
+You can use icons for admonitions by setting the 'icons' attribute.
+      EOS
+
+      output = render_string input, :safe => Asciidoctor::SafeMode::SERVER
+      assert_xpath '//*[@class=""admonitionblock tip""]//*[@class=""icon""]/i[@class=""icon-tip""]', output, 1
+    end
   end
 
   context 'Image paths' do","That is one nasty xpath, can you clean that up any?",rb,1,1,1
"@@ -97,8 +97,13 @@ module Travis
           set 'CI', 'true', echo: false
           set 'CONTINUOUS_INTEGRATION', 'true', echo: false
           set 'HAS_JOSH_K_SEAL_OF_APPROVAL', 'true', echo: false
-          data.env_vars.each do |var|
-            set var.key, var.value, echo: var.to_s
+          data.env_vars_groups.each do |group|
+            if group.announce?
+              cmd ""echo -e \""\033[33;1mSetting environment variables from #{group.source}\033[0m\""; "", assert: false, echo: false
+            end
+            group.vars.each do |var|
+              set var.key, var.value, echo: var.to_s
+            end
           end
           if data.env_vars.any?
             # adds a newline to the log",won't this also echo Travis vars? maybe it should be something like: `echo: group.announce?`,rb,1,1,1
"@@ -8,9 +8,17 @@ class TemplatePolicy < ApplicationPolicy
   end
   
   def index?
-    user.can_super_admin? || user.can_modify_templates?
+    user.can_super_admin?
   end
 
+  def organisational?
+    user.can_modify_templates?
+  end
+  
+  def customisable?
+    user.can_modify_templates?
+  end
+  
   def new?
     user.can_super_admin? || user.can_modify_templates?
   end",org_admins should not see index page?,rb,1,1,1
"@@ -0,0 +1,9 @@
+FactoryGirl.define do
+  factory :twelve_month_summary do
+    association :analysis
+    affiliated_committers_count 2
+    affiliated_commits_count 2
+    outside_committers_count 2
+    outside_commits_count 2
+  end
+end",Why all the count attributes set to static values? Shouldn't these be random?,rb,1,1,0
"@@ -22,7 +22,7 @@ feature 'Visitor updates password' do
     visit_password_reset_page_for user
     change_password_to ''
 
-    page.should have_content I18n.t('flashes.failure_after_update')
+    expect(page).to have_content I18n.t('flashes.failure_after_update')
     user_should_be_signed_out
   end
 ",Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,1,1,1
"@@ -37,6 +37,12 @@ module Selenium
         def bridge_class
           Bridge
         end
+
+        def print_page(**options)
+          options[:page_ranges] &&= Array(options[:page_ranges])
+
+          bridge.print_page(options)
+        end
       end # Driver
     end # Firefox
   end # WebDriver",Same here. and all others.,rb,0,0,0
"@@ -0,0 +1,7 @@
+describe Searchable do
+  describe "".rebuild_index"" do
+    it ""should rebuild the index"" do
+      expect(Proposal.rebuild_index).not_to raise
+    end
+  end
+end",should probably `create(:proposal)` here at least once so there is something to index.,rb,1,1,1
"@@ -520,6 +520,12 @@ webdriver.WebDriver.prototype.call = function(fn, opt_scope, var_args) {
  * Schedules a command to wait for a condition to hold, as defined by some
  * user supplied function. If any errors occur while evaluating the wait, they
  * will be allowed to propagate.
+ *
+ * <p>In the event a condition returns a Promise, the polling loop will wait 
+ * for it to be resolved and use the resolved value for evaluating whether the
+ * condition has been satisfied. The resolution time for a promise is factored
+ * into whether a wait has timed out.
+ *
  * @param {function():boolean} fn The function to evaluate as a wait condition.
  * @param {number} timeout How long to wait for the condition to be true.
  * @param {string=} opt_message An optional message to use if the wait times",Will you link to {!webdriver.promise.Promise} here?,rb,1,1,1
