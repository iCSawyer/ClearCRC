patch,msg,lang,relevance,informativeness,expression
"@@ -161,6 +161,13 @@ static void gamma_control_manager_get_gamma_control(struct wl_client *client,
 	wl_resource_set_implementation(gamma_control->resource, &gamma_control_impl,
 		gamma_control, gamma_control_handle_resource_destroy);
 
+	if (output == NULL) {
+		wl_resource_set_user_data(gamma_control->resource, NULL);
+		zwlr_gamma_control_v1_send_failed(gamma_control->resource);
+		free(gamma_control);
+		return;
+	}
+
 	wl_signal_add(&output->events.destroy,
 		&gamma_control->output_destroy_listener);
 	gamma_control->output_destroy_listener.notify =",This code could be rerouted to avoid the unnecessary gamma_control allocation,c,1,1,1
"@@ -3481,5 +3481,17 @@ move_mm_reg_opcode(bool aligned16, bool aligned32)
 #    endif /* X86/ARM */
 }
 
+uint
+move_mm_avx512_reg_opcode(bool aligned64)
+{
+#    ifdef X86
+    CLIENT_ASSERT(ZMM_ENABLED(), ""move_mm_avx512_reg_opcode on unsupported processor"");
+    return (aligned64 ? OP_vmovdqa64 : OP_vmovdqu64);
+#    else
+    CLIENT_ASSERT(false, ""move_mm_avx512_reg_opcode not supported on ARM/AArch64"");
+    return 0;
+#    endif /* X86 */
+}
+
 #endif /* !STANDALONE_DECODER */
 /****************************************************************************/",Isn't this an internal function? CLIENT_ASSERT is for API functions for reporting interface errors.,c,1,1,1
"@@ -1470,6 +1470,7 @@ func isValidRuleForXDP(rule *proto.Rule) bool {
 		len(rule.DstPorts) == 0 &&
 		len(rule.DstNamedPortIpSetIds) == 0 &&
 		len(rule.DstIpSetIds) == 0 &&
+		len(rule.DstIpPortSetIds) == 0 &&
 		len(rule.NotDstNet) == 0 &&
 		len(rule.NotDstPorts) == 0 &&
 		len(rule.NotDstIpSetIds) == 0 &&","Yep, looks right; your new selector _should_ disqualify the rule from being XDP accelerated.",c,1,1,1
"@@ -92,7 +92,11 @@ int flb_parser_json_do(struct flb_parser *parser,
             off = 0;
             msgpack_unpacked_destroy(&result);
             msgpack_unpacked_init(&result);
-            msgpack_unpack_next(&result, tmp_out_buf, tmp_out_size, &off);
+            if (msgpack_unpack_next(&result, tmp_out_buf, tmp_out_size, &off) < 0)
+{
+            msgpack_unpacked_destroy(&result);
+return -1;
+}
             map = result.data;
         }
     }",something went wrong with indentation there,c,0,0,1
"@@ -0,0 +1,12 @@
+package testutils
+
+import (
+	""os""
+	""path""
+)
+
+func TestDataFile(name string) string {
+	dir, _ := os.Getwd()
+
+	return path.Join(dir, ""testdata"", name)
+}","Would it make sense to create an empty file here, perhaps in a tmp dir, instead of checking empty files into Git?",c,1,1,1
"@@ -54,6 +54,7 @@ void handle_keyboard_key(struct libinput_event *event,
 	struct libinput_event_keyboard *kbevent =
 		libinput_event_get_keyboard_event(event);
 	struct wlr_event_keyboard_key wlr_event = { 0 };
+	wlr_event.device = wlr_dev;
 	wlr_event.time_msec =
 		usec_to_msec(libinput_event_keyboard_get_time_usec(kbevent));
 	wlr_event.keycode = libinput_event_keyboard_get_key(kbevent);",`wlr_event.keyboard` is undefined.,c,1,1,1
"@@ -428,7 +428,16 @@ ostree_builtin_commit (int argc, char **argv, GCancellable *cancellable, GError
   else if (!opt_orphan)
     {
       if (!ostree_repo_resolve_rev (repo, opt_branch, TRUE, &parent, error))
-        goto out;
+        {
+          if (g_error_matches (*error, G_IO_ERROR, G_IO_ERROR_IS_DIRECTORY))
+            {
+              /* A folder exists with the specified ref name,
+                 * which is handled by _ostree_repo_write_ref */
+              g_error_free (*error);
+              *error = NULL;
+            }
+          else goto out;
+        }
     }
 
   if (opt_editor)",This is `g_clear_error (&error);`,c,1,1,1
"@@ -398,6 +398,7 @@ void wlr_send_tablet_v2_tablet_tool_proximity_out(
 			send_tool_frame(tool->current_client);
 		}
 		zwp_tablet_tool_v2_send_proximity_out(tool->current_client->resource);
+		send_tool_frame(tool->current_client);
 
 		tool->current_client = NULL;
 		tool->focused_surface = NULL;",Using `queue_tool_frame` is probably enough to make sure we don't send two.,c,1,1,1
"@@ -53,7 +53,7 @@ class OrderedCheckersAction(argparse.Action):
         namespace.ordered_checkers = ordered_checkers
 
 
-# ------------------------------------------------------------------------------
+# -----------------------------------------------------------------------------
 class DeprecatedOptionAction(argparse.Action):
     """"""
     Deprecated argument action.",Maybe we could remove these as well if we are already touching these.,c,1,1,1
"@@ -396,7 +396,9 @@ static void destroy_tunnel(struct st_h2o_http3_server_stream_t *stream)
     struct st_h2o_http3_server_conn_t *conn = get_conn(stream);
     if (stream->tunnel->datagram_flow_id != UINT64_MAX) {
         khiter_t iter = kh_get(stream, conn->datagram_flows, stream->tunnel->datagram_flow_id);
-        assert(iter != kh_end(conn->datagram_flows));
+        /* the tunnel wasn't established yet */
+        if (iter == kh_end(conn->datagram_flows))
+            return;
         kh_del(stream, conn->datagram_flows, iter);
     }
 }","I wonder if we should avoid early return here. The rationale is that the function is expected to dispose all the properties, where `datagram_flow_id` is just one among them. Therefore, I tend to believe that a statement (or a block) that disposes each element should not do an early return, and that applies to the last property as well for the sake of consistency.",c,1,1,1
"@@ -34,6 +34,7 @@
  */
 
 #include ""globals.h""
+#include ""arch.h""
 
 void
 unit_test_io(void);","Put the unit tests in an arch/ location, not in this top-level driver file. IIRC I suggested arch.c in my original request for a unit test, but arch/x86 may be better.",c,1,1,1
"@@ -59,7 +59,6 @@ EXPORT void
 jacobi_init(int matrix_size, bool enable_annotations)
 {
     invoke_annotations = enable_annotations;
-
     x_temp = (double *)malloc(matrix_size * sizeof(double));
     if (invoke_annotations)
         TEST_ANNOTATION_EIGHT_ARGS(matrix_size, 102, 103, 104, 105, 106, 107, 108);",Best to revert this to avoid superfluous unrelated noise in the diff.,c,1,1,1
"@@ -355,9 +355,14 @@ static bool gles2_init_wl_display(struct wlr_renderer *wlr_renderer,
 		struct wl_display *wl_display) {
 	struct wlr_gles2_renderer *renderer =
 		gles2_get_renderer(wlr_renderer);
-	if (!wlr_egl_bind_display(renderer->egl, wl_display)) {
-		wlr_log(WLR_INFO, ""failed to bind wl_display to EGL"");
-		return false;
+
+	if (renderer->egl->exts.bind_wayland_display_wl) {
+		if (!wlr_egl_bind_display(renderer->egl, wl_display)) {
+			wlr_log(WLR_ERROR, ""Failed to bind wl_display to EGL"");
+			return false;
+		}
+	} else {
+		wlr_log(WLR_INFO, ""EGL_WL_bind_wayland_display is not supported"");
 	}
 	return true;
 }",Checking for BIND_WAYLAND_DISPLAY_WL is a separate change or should at least be mentioned in the commit message.,c,1,1,1
"@@ -974,6 +974,17 @@ drwrap_exit(void)
     if (count != 0)
         return;
 
+    ASSERT(drmgr_unregister_bb_app2app_event(drwrap_event_bb_app2app),
+           ""failed to unregister bb_app2app_event"");
+    ASSERT(drmgr_unregister_bb_instrumentation_event(drwrap_event_bb_analysis),
+           ""failed to unregister bb_instrumentation_event"");
+    ASSERT(drmgr_unregister_module_unload_event(drwrap_event_module_unload),
+           ""failed to unregister odule_unload_event"");
+    ASSERT(dr_unregister_delete_event(drwrap_fragment_delete),
+           ""failed to unregister delete_event"");
+    ASSERT(drmgr_unregister_tls_field(tls_idx),
+           ""failed to unregister tls_field"");
+
     hashtable_delete(&replace_table);
     hashtable_delete(&replace_native_table);
     hashtable_delete(&wrap_table);","Do the call outside the ASSERT: as is, this call will disappear in release build. Ditto below.",c,1,1,1
"@@ -1085,6 +1085,9 @@ module_lookup_symbol(ELF_SYM_TYPE *sym, os_privmod_data_t *pd)
      */
     ASSERT_OWN_RECURSIVE_LOCK(true, &privload_lock);
     mod = privload_first_module();
+    /* Symbols are currently looked up following the dependency chain depth-first instead
+     * of breadth-first as reflected in the global list 'modlist' (xref i#3850).
+     */
     while (mod != NULL) {
         pd = mod->os_privmod_data;
         ASSERT(pd != NULL && name != NULL);",This should be an XXX (or FIXME). Please mention that the ELF spec requires breadth-first symbol lookup.,c,1,1,1
"@@ -162,7 +162,7 @@ var xdpTestCases = []xdpTest{
 			SrcPort: 54321,
 		},
 		Drop:     false,
-		Metadata: true,
+		Metadata: false,
 	},
 	{
 		Description: ""6 - Match against a deny policy, must drop"",","Why this change (test name still says ""must pass with metadata"")?",c,1,1,1
"@@ -5761,6 +5761,19 @@ mark_page_as_guard(byte *pc)
     ASSERT(res);
 }
 
+/* Removes guard protection from page containing pc */
+void
+unmark_page_as_guard(byte *pc, uint prot)
+{
+    uint old_prot;
+    int res;
+    byte *start_page = (byte *)ALIGN_BACKWARD(pc, PAGE_SIZE);
+
+    uint flags = memprot_to_osprot(prot & ~MEMPROT_GUARD);
+    res = protect_virtual_memory(start_page, PAGE_SIZE, flags, &old_prot);
+    ASSERT(res);
+}
+
 /* Change page protection for pc:pc+size.
  * If set is false, makes [un]writable depending on add_writable argument,
  * preserving other flags; else, sets protection to new_prot.","Maybe assert, or curiosity if race could happen, that old_prot had PAGE_GUARD",c,1,1,1
"@@ -2853,8 +2853,10 @@ mangle_icache_op(dcontext_t *dcontext, instrlist_t *ilist, instr_t *instr,
                 opnd_create_base_disp(dr_reg_stolen, DR_REG_NULL, 0, 16, OPSZ_16),
                 opnd_create_reg(xt == dr_reg_stolen ? DR_REG_X0 : xt),
                 opnd_create_reg(DR_REG_X30)));
+#    ifndef DR_HOST_NOT_TARGET
         insert_mov_immed_arch(dcontext, NULL, NULL, (ptr_int_t)icache_op_ic_ivau_asm,
                               opnd_create_reg(DR_REG_X30), ilist, instr, NULL, NULL);
+#    endif
         PRE(ilist, instr, /* mov x0, x28 */
             XINST_CREATE_move(dcontext, opnd_create_reg(DR_REG_X0),
                               opnd_create_reg(dr_reg_stolen)));","This mangling code is never executed when DR_HOST_NOT_TARGET is set right? Just for my understanding, you are inserting ifdef outs primarily for compilation purposes no? If so, maybe add aa ASSERT_NOT_REACHED() somewhere?",c,1,1,1
"@@ -455,6 +455,12 @@ static CALI_BPF_INLINE int calico_tc(struct __sk_buff *skb)
 		}
 	}
 
+	// Drop packets with IP options
+	if (ip_header->ihl > 5) {
+		fwd.reason = CALI_REASON_IP_OPTIONS;
+		CALI_DEBUG(""Drop packets with IP options\n"");
+		goto deny;
+	}
 	// Setting all of these up-front to keep the verifier happy.
 	struct tcphdr *tcp_header = (void*)(ip_header+1);
 	struct udphdr *udp_header = (void*)(ip_header+1);",I would say `!= 5`; A packet with <5 would be malformed.,c,1,1,1
"@@ -430,7 +430,7 @@ insert_meta_call_vargs(dcontext_t *dcontext, instrlist_t *ilist, instr_t *instr,
              * which specifies that the caller must save xax (and xcx and xdx)
              */
             insert_get_mcontext_base(dcontext, ilist, instr, SCRATCH_REG0);
-# ifdef AARCH64
+# ifdef AARCHXX
             /* TLS_REG1_SLOT is not safe since it may be used by clients.
              * We save it to dcontext.mcontext.x0.
              */","I realized that this is wrong. `SCRATCH_REG0` is `r0` on ARM, which is the first argument to each clean call... x86 is clearly fine though. I'm curious, how does this work for Aarch64 either then? Isn't `x0` the first argument to clean calls as well? @derekbruening thoughts?",c,0,1,1
"@@ -14,4 +14,4 @@ set_false_path -from [get_keepers *|platform_shim_ccip|c.ccip_async_shim|async_s
 ##
 ## Reset path to local memory clock after clock crossing.
 ##
-set_false_path -to [get_keepers *|platform_shim_avalon_mem_if|c.local_mem_reset_pipe[0]]
+set_false_path -to [get_keepers *|platform_shim_avalon_mem_if|c.mm_async*.local_mem_reset_pipe[0]]",What does this settings do? local_mem_reset_pipe value set to 0?,c,1,1,1
"@@ -69,7 +69,7 @@ static const opt_arg_t* find_match(opt_state_t* s)
         // and short options might be grouped.
         if((match != NULL) && (match->id != p->id))
           return (opt_arg_t*)1;
-        
+
         match = p;
       }
     }",can you revert changes to this file.,c,1,1,1
"@@ -51,7 +51,7 @@
 #    define DISPLAY_STRING(msg) dr_printf(""%s\n"", msg);
 #endif
 
-#define NULL_TERMINATE(buf) buf[(sizeof(buf) / sizeof(buf[0])) - 1] = '\0'
+#define NULL_TERMINATE(buf) (buf)[(sizeof((buf)) / sizeof((buf)[0])) - 1] = '\0'
 
 #define TESTALL(mask, var) (((mask) & (var)) == (mask))
 #define TESTANY(mask, var) (((mask) & (var)) != 0)","In the description: > Fixes: #4160 I don't know that this will auto-close: the Github docs say to not have a colon and that is what our guide says and all our commits. (We have a colon on `Issue: #xxx, #yyy` which is for our own parsing.)",c,0,1,1
"@@ -79,7 +79,8 @@ func (l *LivenessScanner) Scan() {
 			// Look up the reverse entry, where we do the book-keeping.
 			revEntryBytes, err := l.ctMap.Get(ctVal.ReverseNATKey().AsBytes())
 			if err != nil && bpf.IsNotExists(err) {
-				// Forward entry exists but no reverse entry (and the grace period has expired).
+				// Forward entry exists but no reverse entry. We might have come across the reverse
+				// entry first and removed it. It is useless on its own, so delete it now.
 				log.Info(""Found a forward NAT conntrack entry with no reverse entry, removing..."")
 				err := l.ctMap.Delete(k)
 				log.WithError(err).Debug(""Deletion result"")",Think you need to check the creation timestamp here to make sure that the entry wasn't just created (or we might be racing with the BPF program creating the pair of keys).,c,1,1,1
"@@ -843,13 +843,6 @@ err:
     return NULL;
 }
 
-/*  Create namespace name for jobid 'id'
- */
-static int job_get_ns_name (char *buf, int bufsz, flux_jobid_t id)
-{
-    return fluid_encode (buf, bufsz, id, FLUID_STRING_DOTHEX);
-}
-
 static double job_get_kill_timeout (flux_t *h)
 {
     double t = DEFAULT_KILL_TIMEOUT;","typo in commit message ""notiation"" -> ""notation""",c,0,0,1
"@@ -914,8 +914,7 @@ insert_reachable_cti(dcontext_t *dcontext, instrlist_t *ilist, instr_t *where,
 {
     ASSERT(scratch != REG_NULL); /* required */
     /* load target into scratch register */
-    insert_mov_immed_ptrsz(dcontext, (ptr_int_t)
-                           PC_AS_JMP_TGT(dr_get_isa_mode(dcontext), target),
+    insert_mov_immed_ptrsz(dcontext, (ptr_int_t)target,
                            opnd_create_reg(scratch), ilist, where, NULL, NULL);
     /* even if a call and not a jmp, we can skip this if it doesn't return */
     if (!jmp && returns) {","What I'm puzzling over is the reason that 850c10c0b8c3390608715074f0ce94379d039f2f put this here: it is called out in the commit message so there must have been something that did not have the lsb set. Not everything does: e.g., fragment tags deliberately do not have lsb set. There must have been something like that that would make its way here. Does a test suite run on arm hit any discrepancy here?",c,1,1,1
"@@ -350,7 +350,7 @@ session_thread_set_tls_interaction_cb (ThreadClosure *thread_closure,
   const char *cert_and_key_path = data; /* str\0str\0 in one malloc buf */
   const char *cert_path = cert_and_key_path;
   const char *key_path = cert_and_key_path + strlen (cert_and_key_path) + 1;
-  glnx_unref_object OstreeTlsCertInteraction *interaction = NULL;
+  g_autoptr(OstreeTlsCertInteraction) interaction = NULL;
 
   /* The GTlsInteraction instance must be created in the
    * session thread so it uses the correct GMainContext. */","AFAICT, there's no autocleanup defined for `OstreeTlsCertInteraction` yet.",c,1,1,1
"@@ -246,13 +246,13 @@ inject_into_thread(HANDLE phandle, CONTEXT *cxt, HANDLE thandle, char *dynamo_pa
              * the dynamorio lib.
              */
             for (i = 0; i < MCXT_NUM_SIMD_SLOTS; i++) {
-                for (j = 0; j < IF_X64_ELSE(2, 4); j++) {
+                for (j = 0; j < XMM_REG_SIZE / sizeof(*bufptr); j++) {
                     *bufptr++ = CXT_XMM(cxt, i)->reg[j];
                 }
                 /* FIXME i#437: save ymm fields.  For now we assume we're
                  * not saving and we just skip the upper 128 bits.
                  */
-                bufptr += IF_X64_ELSE(2, 4);
+                bufptr += (YMM_REG_SIZE - XMM_REG_SIZE) / sizeof(*bufptr);
             }
         } else {
             /* skip xmm slots */",These two expressions were identical before but now they're not?,c,1,1,1
"@@ -34,7 +34,7 @@ from shared.ttypes import DBStatus
 LOG = get_logger('system')
 
 
-class DBContext():
+class DBContext:
     """"""
     Simple helper class to setup and sql engine, a database session
     and a connection.",Please use new-style class `DBContext(object)`,c,1,1,1
"@@ -208,10 +208,12 @@ static bool atomic_crtc_set_gamma(struct wlr_drm_backend *drm,
 		struct wlr_drm_crtc *crtc, size_t size,
 		uint16_t *r, uint16_t *g, uint16_t *b) {
 	// Fallback to legacy gamma interface when gamma properties are not available
-	// (can happen on older intel gpu's that support gamma but not degamma)
-	// TEMP: This is broken on AMDGPU. Always fallback to legacy until they get
-	// it fixed. Ref https://bugs.freedesktop.org/show_bug.cgi?id=107459
-	if (crtc->props.gamma_lut == 0 || true) {
+	// (can happen on older Intel GPUs that support gamma but not degamma).
+	// TEMP: This is broken on AMDGPU. Provide a fallback to legacy until they
+	// get it fixed. Ref https://bugs.freedesktop.org/show_bug.cgi?id=107459
+	const char *no_atomic_str = getenv(""WLR_DRM_NO_ATOMIC_GAMMA"");
+	bool no_atomic = no_atomic_str != NULL && strcmp(no_atomic_str, ""1"") == 0;
+	if (crtc->props.gamma_lut == 0 || no_atomic) {
 		return legacy_iface.crtc_set_gamma(drm, crtc, size, r, g, b);
 	}
 ","I actually looked at this and was wondering about doing a getenv everytime we set gamma.. It's not a fast path but it's the first getenv we'll have that's not at init. Well, I guess it's probably ok",c,1,1,1
"@@ -792,18 +792,6 @@ static void implicit_tool_up(struct wlr_tablet_tool_v2_grab *grab) {
         check_and_release_implicit_grab(grab);
 }
 
-/* Only send the motion event, when we are over the surface for now */
-static void implicit_tool_motion(
-        struct wlr_tablet_tool_v2_grab *grab, double x, double y) {
-        struct implicit_grab_state *state = grab->data;
-        if (state->focused != state->original) {
-                return;
-        }
-
-        wlr_send_tablet_v2_tablet_tool_motion(grab->tool, x, y);
-}
-
-
 static void implicit_tool_button(
         struct wlr_tablet_tool_v2_grab *grab, uint32_t button,
         enum zwp_tablet_pad_v2_button_state state) {",Hmm. But using the default handler would send the event to the wrong surface then?,c,1,1,1
"@@ -474,12 +474,12 @@ class TestAnalyze(unittest.TestCase):
         """"""
         build_json = os.path.join(self.test_workspace, ""build_extra_args.json"")
         report_dir = os.path.join(self.test_workspace, ""reports_extra_args"")
-        source_file = os.path.join(self.test_dir, ""extra_args.c"")
+        source_file = os.path.join(self.test_dir, ""extra_args.cpp"")
         tidyargs_file = os.path.join(self.test_dir, ""tidyargs"")
         saargs_file = os.path.join(self.test_dir, ""saargs"")
 
         build_log = [{""directory"": self.test_dir,
-                      ""command"": ""cc -c "" + source_file,
+                      ""command"": ""g++ -c "" + source_file,
                       ""file"": source_file
                       }]
 ",I don't see any test cases where you use the `--analyzer-config` and `--tidyargs` in the same command. So please create a new test case or extend an existing one with it.,c,1,1,1
"@@ -794,3 +794,13 @@ const char *h2o_npn_protocols = NPN_PROTOCOLS_CORE ""\x08""
                                                    ""http/1.1"";
 
 uint64_t h2o_connection_id = 0;
+
+extern void h2o_http2_wbuf_buffer_prototype__dispose(void);
+extern void h2o_mem_pool_allocator__dispose(void);
+
+void h2o_tls_data_dispose(void)
+{
+    h2o_mem_pool_allocator__dispose();
+    h2o_http2_wbuf_buffer_prototype__dispose();
+    h2o_mem_allocator_recycle__dispose(&h2o_socket_buffer_prototype.allocator);
+}","I appreciate your effort to keep the modularization. But for this case, I wouldn't mind changing the linkage of static thread-local variables to extern (and releasing them directly in this function), considering the fact that we already have `h2o_socket_buffer_prototype`. For example, you can rename `mempool_allocator` to `h2o_mem_pool_allocator` and call `h2o_mem_dispose_recycle(&h2o_mem_pool_allocator)` here. The same goes to `wbuf_buffer_prototype` (which could be renamed to `h2o_http2_wbuf_buffer_prototype`.",c,1,1,0
"@@ -486,6 +486,9 @@ static void render_output(struct roots_output *output) {
 		goto renderer_end;
 	}
 
+	// Uncomment this line to debug damage tracking
+	//wlr_renderer_clear(renderer, (float[]){1, 1, 0, 0});
+
 	int nrects;
 	pixman_box32_t *rects = pixman_region32_rectangles(&damage, &nrects);
 	for (int i = 0; i < nrects; ++i) {",I would rather see a startup flag to give to rootston for this purpose,c,1,1,1
"@@ -270,6 +270,10 @@ static jx_token_t jx_scan( struct jx_parser *s )
 	} else if(c=='!') {
 		char d = jx_getchar(s);
 		if(d=='=') return JX_TOKEN_NE;
+		if(isalpha(d) || d == '_') {
+			jx_ungetchar(s,d);
+			return JX_TOKEN_NOT;
+		}
 		jx_ungetchar(s,d);
 		jx_parse_error(s,""invalid character: !"");
 		return JX_TOKEN_PARSE_ERROR;","Let's just make this a simple `else` and avoid the problem of understanding all the valid characters that may follow.. (For example, an open paren could come after `!`)",c,1,1,1
"@@ -936,6 +936,8 @@ int32_t h2o_socket_getport(struct sockaddr *sa)
 static void create_ossl(h2o_socket_t *sock)
 {
     sock->ssl->ossl = SSL_new(sock->ssl->ssl_ctx);
+    /* set app data to be used in h2o_socket_ssl_new_session_cb */
+    assert(SSL_set_app_data(sock->ssl->ossl, sock));
     setup_bio(sock);
 }
 ","I think you need to split `assert` and the call to `SSL_set_app_data`. Otherwise, the call to the OpenSSL function will be eliminated when `NBEGUG` is set.",c,1,1,1
"@@ -298,7 +298,7 @@ commit_loose_regfile_object (OstreeRepo        *self,
        */
       if (S_ISREG (mode))
         {
-          const mode_t content_mode = (mode & (S_IFREG | 0775)) | S_IRUSR;
+          const mode_t content_mode = (mode & USERMODE_CANONICAL_MASK) | S_IFREG | S_IRUSR;
           if (!glnx_fchmod (tmpf->fd, content_mode, error))
             return FALSE;
         }","Hmm. There's a really important difference between `bare-user` and `bare-user-only`, which is that `bare-user` is intended to be losslessly convertible to-from `bare`. Now, we store the mode as an xattr, but it kind of intentional that the checked out tree mostly resembles what's in the `bare`. I'd be happier I think if this change only touched code paths involved in `bare-user-only`. Then the messaging is clearer.",c,1,1,1
"@@ -51,16 +51,7 @@ var _ = Context(""etcd connection interruption"", func() {
 
 	BeforeEach(func() {
 		felixes, etcd, client = infrastructure.StartNNodeEtcdTopology(2, infrastructure.DefaultTopologyOptions())
-
-		// Install a default profile that allows all ingress and egress, in the absence of any Policy.
-		defaultProfile := api.NewProfile()
-		defaultProfile.Name = ""default""
-		defaultProfile.Spec.LabelsToApply = map[string]string{""default"": """"}
-		defaultProfile.Spec.Egress = []api.Rule{{Action: api.Allow}}
-		defaultProfile.Spec.Ingress = []api.Rule{{Action: api.Allow}}
-		_, err := client.Profiles().Create(utils.Ctx, defaultProfile, utils.NoOptions)
-		Expect(err).NotTo(HaveOccurred())
-
+		infrastructure.CreateDefaultProfile(client, ""default"", map[string]string{""default"": """"}, """")
 		// Wait until the tunl0 device appears; it is created when felix inserts the ipip module
 		// into the kernel.
 		Eventually(func() error {","In the old code here there was no Source Selector, but CreateDefaultProfile will specify a Source Selector of `""""`. Is that equivalent?",c,1,1,1
"@@ -128,7 +128,7 @@ get_thread_private_dcontext(void)
 void
 external_error(const char *file, int line, const char *msg)
 {
-    fprintf(stderr, ""Usage error: %s (%s, line %d)\n"", msg, file, line);
+    print_file(STDERR, ""Usage error: %s (%s, line %d)\n"", msg, file, line);
     abort();
 }
 ",Not sure drdecode links utils.c which has print_file. The `STDERR` should work b/c it turns into either `our_stderr` or `dr_get_stderr_handle` and both are defined up above in this file. Probably this should be `s/print_file/fprintf/`?,c,1,1,1
"@@ -57,9 +57,8 @@ xfpga_fpgaGetPropertiesFromHandle(fpga_handle handle, fpga_properties *prop)
 	return result;
 }
 
-
-fpga_result __FPGA_API__
-xfpga_fpgaGetProperties(fpga_token token, fpga_properties *prop)
+fpga_result __FPGA_API__ xfpga_fpgaGetProperties(fpga_token token,
+						 fpga_properties *prop)
 {
 	struct _fpga_properties *_prop;
 	fpga_result result = FPGA_OK;",Should we call the API `fpgaGetProperties` with a null token to allocate the properties structure?,c,1,1,1
"@@ -317,7 +317,7 @@ int rlist_remap (struct rlist *rl)
     return 0;
 }
 
-struct rnode * rlist_find_host (struct rlist *rl, const char *host)
+struct rnode * rlist_find_host (const struct rlist *rl, const char *host)
 {
     struct rnode *n = zlistx_first (rl->nodes);
     while (n) {","typo in commit message ""reurn"" -> ""return""",c,0,0,1
"@@ -22,6 +22,10 @@ void wlr_texture_destroy(struct wlr_texture *texture) {
 struct wlr_texture *wlr_texture_from_pixels(struct wlr_renderer *renderer,
 		uint32_t fmt, uint32_t stride, uint32_t width, uint32_t height,
 		const void *data) {
+	assert(width > 0);
+	assert(height > 0);
+	assert(stride >= width);
+	assert(data);
 	return renderer->impl->texture_from_pixels(renderer, fmt, stride, width,
 		height, data);
 }",Maybe also assert that `stride > 0`?,c,1,0,1
"@@ -67,6 +67,9 @@ static void surface_set_opaque_region(struct wl_client *client,
 		struct wl_resource *resource,
 		struct wl_resource *region_resource) {
 	struct wlr_surface *surface = wl_resource_get_user_data(resource);
+	if ((surface->pending.invalid & WLR_SURFACE_INVALID_OPAQUE_REGION)) {
+		pixman_region32_clear(&surface->pending.opaque);
+	}
 	surface->pending.invalid |= WLR_SURFACE_INVALID_OPAQUE_REGION;
 	if (region_resource) {
 		pixman_region32_t *region = wl_resource_get_user_data(region_resource);",Is this correct? Other regions accumulate according to the protocol.,c,1,1,1
"@@ -67,8 +67,8 @@ get_pthread_tls_offs(void)
 void
 init_android_version(void)
 {
-#   define VER_FILE ""/system/build.prop""
-#   define VER_PROP ""ro.build.version.release=""
+#define VER_FILE ""/system/build.prop""
+#define VER_PROP ""ro.build.version.release=""
     file_t fd = os_open(VER_FILE, OS_OPEN_READ);
     uint read_ver = 0;
     if (fd != INVALID_FILE) {",Ditto for these: lining up with code indentation level when inside function,c,1,1,1
"@@ -81,6 +81,16 @@ int main(int argc, char* argv[])
   opt.ast_print_width = get_width();
   opt.argv0 = argv[0];
 
+  size_t args_size = 0;
+  for (int i = 1; i < argc; i++)
+    args_size += strlen(argv[i]) + 1;
+  opt.all_args = (const char*)calloc(args_size, sizeof(const char));
+  for (int i = 1; i < argc; i++)
+  {
+    strncat((char*)opt.all_args, argv[i], strlen(argv[i]));
+    strncat((char*)opt.all_args, "" "", 1);
+  }
+
   ponyc_opt_process_t exit_code;
   bool print_program_ast;
   bool print_package_ast;",what's the purpose of this?,c,1,0,1
"@@ -1,9 +1,3 @@
- /*
-Copyright (C) 2017- The University of Notre Dame
-This software is distributed under the GNU General Public License.
-See the file COPYING for details.
-*/
-
 #include ""batch_job_internal.h""
 #include ""process.h""
 #include ""batch_job.h""","Don't remove the copyright, please.",c,1,1,1
"@@ -741,9 +741,15 @@ mangle_syscall_code(dcontext_t *dcontext, fragment_t *f, byte *pc, bool skip)
                 /* For A32 it's not OP_b_short */
                 IF_ARM(||
                        (instr_get_opcode(&instr) == OP_jmp &&
-                        opnd_get_pc(instr_get_target(&instr)) == pc + ARM_INSTR_SIZE)))
+                        opnd_get_pc(instr_get_target(&instr)) == pc + ARM_INSTR_SIZE))) {
+#    ifdef AARCH64
+            /* For A64, both skip_pc and cti_pc are an OP_jmp_short instr. */
+            skip_pc = cti_pc;
+            cti_pc = prev_pc;
+#    else
             skip_pc = prev_pc;
-        else if (instr_get_opcode(&instr) == OP_jmp)
+#    endif
+        } else if (instr_get_opcode(&instr) == OP_jmp)
             cti_pc = prev_pc;
         if (pc >= stop_pc) {
             LOG(THREAD, LOG_SYSCALLS, 3, ""\tno syscalls found\n"");","I haven't verified, but could this condition be a bug for A32? It matches only when the jmp instr at `skip_pc` has `cti_pc` as target. But, it won't match when the instr at `skip_pc` has already been modified to point to the syscall.",c,1,1,1
"@@ -2,11 +2,7 @@
 
 #include <wlr/config.h>
 
-#ifdef __linux__
 #include <linux/input-event-codes.h>
-#elif __FreeBSD__
-#include <dev/evdev/input-event-codes.h>
-#endif
 
 #include <xcb/xcb.h>
 #include <xcb/xfixes.h>","Hmm, what's the story about these? Are `linux/*` includes available on FreeBSD now?",c,1,1,1
"@@ -34,6 +34,10 @@ static int writeCtagsPtagEntry (tagWriter *writer CTAGS_ATTR_UNUSED,
                                                                 void *clientData);
 static bool treatFieldAsFixed (int fieldType);
 
+#ifdef WIN32
+static enum filenameSepOp overrideFilenameSeparator (enum filenameSepOp currentSetting);
+#endif        /* WIN32 */
+
 struct rejection {
         bool rejectionInThisInput;
 };",Did you intentionally remove this?,c,0,0,1
"@@ -22,6 +22,10 @@ def get_analyzer_checkers_cmd(cfg_handler, alpha=True, debug=True):
     Before clang9 alpha and debug checkers were printed by default.
     Since clang9 there are extra arguments to print the additional checkers.
     """"""
+    if not cfg_handler.version_info:
+        LOG.debug(""No clang version information. Can not get checkers."")
+        return None
+
     command = [cfg_handler.analyzer_binary, ""-cc1""]
 
     for plugin in cfg_handler.analyzer_plugins:","This should be a warning, not a normally silent debug.",c,1,1,1
"@@ -3333,7 +3333,14 @@ instr_is_reg_spill_or_restore_ex(void *drcontext, instr_t *instr, bool DR_only,
         reg = &myreg;
     if (instr_check_tls_spill_restore(instr, spill, reg, &check_disp)) {
         int offs = reg_spill_tls_offs(*reg);
-        if (!DR_only || (offs != -1 && check_disp == os_tls_offset((ushort)offs))) {
+        if (!DR_only ||
+            (offs != -1 &&
+             /* Mangling may choose to spill registers to a not natural tls offset,
+              * e.g. rip-rel mangling will, if rax is used by the instruction. We
+              * allow for this here and still recognize the DR spill.
+              */
+             (instr_is_our_mangling(instr) ||
+              check_disp == os_tls_offset((ushort)offs)))) {
             if (tls != NULL)
                 *tls = true;
             if (offs_out != NULL)","This only works for a mangled instruction list: i.e., only during bb building (after a client's events) or bb recreation (also after a client's events). Thus this call will never return true for a client. Plus, this is-spill function is used for more than instrlists: some callers use it when decoding raw instructions, such as drreg and also I think DR may use it that way when it decodes from the cache in some cases? So this does not seem a complete solution.",c,1,1,0
"@@ -2,7 +2,7 @@
 
 Name:           felix
 Summary:        Project Calico virtual networking for cloud data centers
-Version:        2.2.1
+Version:        2.4.0
 Release:        1%{?dist}
 License:        Apache-2
 URL:            http://projectcalico.org",Erk. The fact this jumped from 2.2.1 to 2.4.0 - did we miss a change for 2.3.0?,c,1,1,1
"@@ -19,7 +19,7 @@ source_t* source_open(const char* file, const char** error_msgp)
 
   fseek(fp, 0, SEEK_END);
   ssize_t size = ftell(fp);
-  
+
   if(size < 0)
   {
     *error_msgp = ""can't determine length of file"";",can you revert changes to this file.,c,1,0,1
"@@ -63,6 +63,7 @@ void shutdown_destroy (shutdown_t *s)
     if (s) {
         if (s->shutdown)
             flux_msg_handler_destroy (s->shutdown);
+        shutdown_disarm (s);
         if (s->h)
             (void)flux_event_unsubscribe (s->h, ""shutdown"");
         free (s);","Perhaps a good change, but unrelated to the logical topic of this commit.",c,1,1,1
"@@ -1350,6 +1350,8 @@ detach_and_exec_gdb(process_id_t pid, const char *library_path)
     os_unmap_file(base, size);
     os_close(f);
 
+    /* SIGSTOP can make gdb debugging early privload. */
+    kill(pid, SIGSTOP);
     our_ptrace(PTRACE_DETACH, pid, NULL, NULL);
     snprintf(pid_str, BUFFER_SIZE_ELEMENTS(pid_str), ""%d"", pid);
     NULL_TERMINATE_BUFFER(pid_str);",Please reword: I don't know what this is trying to say due to grammar issues.,c,1,1,1
"@@ -174,6 +174,16 @@ def add_arguments_to_parser(parser):
                                     ""compiler on the system is special, e.g. ""
                                     ""when doing cross-compilation."")
 
+    analyzer_opts.add_argument('--capture-analysis-output',
+                               dest='capture_analysis_output',
+                               action='store_true',
+                               default=argparse.SUPPRESS,
+                               required=False,
+                               help=""Store standard output and standard error ""
+                                    ""of successful analyzer invocations ""
+                                    ""into the '<OUTPUT_DIR>/success' ""
+                                    ""directory."")
+
     analyzer_opts.add_argument('--saargs',
                                dest=""clangsa_args_cfg_file"",
                                required=False,","I wonder, mayhaps _capture-**successful**-output_ could be a better optstring? Considering that failure output is also captured (about which I wonder perhaps we should introduce an optstring that _disables_ that notion, as there could be cases someone does not truly care about the analysis failures as deeply as the code currently does.)",c,1,1,1
"@@ -247,7 +247,8 @@ type Config struct {
 
 	DisableConntrackInvalid bool
 
-	NATPortRange numorstring.Port
+	NATPortRange                       numorstring.Port
+	IptablesNATOutgoingInterfaceFilter string
 }
 
 func (c *Config) validate() {",This new field needs to be set from the global config params object. Take a look at how NATPortRange gets set.,c,1,1,1
"@@ -120,6 +120,8 @@ static void init_request(struct st_h2o_http1_conn_t *conn)
             h2o_buffer_dispose(&conn->req_body);
         h2o_dispose_request(&conn->req);
     }
+    if (conn->_unconsumed_request_size)
+        h2o_buffer_consume(&conn->sock->input, conn->_unconsumed_request_size);
     assert(conn->req_body == NULL);
     h2o_init_request(&conn->req, &conn->super, NULL);
 ","Would it make sense to move these two lines into the end of `if` block above, right after `h2o_dispose_request`? Based on my understanding that the intent is to retain the input buffer until `h2o_dispose_request` completes, I think doing so would make the code more understandable.",c,1,1,1
"@@ -176,8 +176,8 @@ def add_arguments_to_parser(parser):
 
     analyzer_opts.add_argument('--add-compiler-defaults',
                                action='store_true',
-                               default=False,
                                required=False,
+                               default=argparse.SUPPRESS,
                                help=""Retrieve compiler-specific configuration ""
                                     ""from the compilers themselves, and use ""
                                     ""them with Clang. This is used when the """,Why do we need this change?,c,1,0,1
"@@ -20,6 +20,8 @@
 #include ""ext/types.h""
 #include ""ext/protocol.h""
 
+#include <iostream>
+
 namespace apache {
 namespace thrift {
 namespace py {",I usually include built-in lib first,c,1,0,1
"@@ -92,7 +92,7 @@ fpga_result __FPGA_API__ fpgaOpen(fpga_token token, fpga_handle *handle, int fla
 	_handle->mmio_root = NULL;
 
 	// Init workspace table
-	_handle->wsid_root = wsid_tracker_init(16384);
+	_handle->wsid_root = wsid_tracker_init(MAX_WSID_TRACKER_BUCKETS);
 
 	// set handle return value
 	*handle = (void *)_handle;","MAX is the wrong prefix. This is just a static number of buckets to allocate in the hash table. A better name would be ""NUM_WSID_TRACKER_BUCKETS"".",c,1,1,1
"@@ -82,6 +82,7 @@ IGNORED_OPTIONS_GCC = [
     '-fno-aggressive-loop-optimizations',
     '-fno-delete-null-pointer-checks',
     '-fno-jump-table',
+    '-fno-keep-static-consts',
     '-fno-strength-reduce',
     '-fno-toplevel-reorder',
     '-fno-unit-at-a-time',",Comma is missing at the end of line.,c,1,1,1
"@@ -681,6 +681,7 @@ d_r_arch_init(void)
      * masks. Also priv_mcontext_t.opmask slots are AVX512BW wide.
      */
     IF_X86(ASSERT(sizeof(dr_opmask_t) == OPMASK_AVX512BW_REG_SIZE));
+    ASSERT(NUM_GP_REGS == DR_NUM_GPR_REGS);
 
     /* Verify that the structures used for a register spill area and to hold IBT
      * table addresses & masks for IBL code are laid out as expected. We expect",Is that necessary?,c,1,0,1
"@@ -0,0 +1,18 @@
+/**
+ * Autogenerated by Thrift Compiler (0.11.0)
+ *
+ * DO NOT EDIT UNLESS YOU ARE SURE THAT YOU KNOW WHAT YOU ARE DOING
+ *  @generated
+ */
+
+/// <summary>
+/// You can define enums, which are just 32 bit integers. Values are optional
+/// and start at 1 if not supplied, C style again.
+/// </summary>
+public enum Operation
+{
+  ADD = 1,
+  SUBTRACT = 2,
+  MULTIPLY = 3,
+  DIVIDE = 4,
+}",Generated code should not be checked in.,c,1,1,1
"@@ -23,6 +23,15 @@ void wlr_renderer_end(struct wlr_renderer *r) {
         r->impl->end(r);
 }
 
+void wlr_renderer_clear(struct wlr_renderer *r, float red, float green,
+                float blue, float alpha) {
+        r->impl->clear(r, red, green, blue, alpha);
+}
+
+void wlr_renderer_scissor(struct wlr_renderer *r, struct wlr_box *box) {
+        r->impl->scissor(r, box);
+}
+
 struct wlr_texture *wlr_render_texture_create(struct wlr_renderer *r) {
         return r->impl->texture_create(r);
 }",Check for null,c,1,0,1
"@@ -348,6 +348,8 @@ void wlr_seat_destroy(struct wlr_seat *wlr_seat) {
 		return;
 	}
 
+	wl_signal_emit(&wlr_seat->events.destroy, NULL);
+
 	wl_list_remove(&wlr_seat->display_destroy.link);
 
 	struct wlr_seat_client *client, *tmp;","We generally emit the signal with the object itself as data, here `wlr_seat`.",c,1,1,1
"@@ -65,7 +65,7 @@ disable=all
 # Enable the message, report, category or checker with the given id(s). You can
 # either give multiple identifier separated by comma (,) or put this option
 # multiple time. See also the ""--disable"" option for examples.
-enable=logging-format-interpolation,old-style-class,unused-import,unused-variable,len-as-condition,bad-indentation
+enable=logging-format-interpolation,old-style-class,unused-import,unused-variable,len-as-condition,bad-indentation,unpacking-in-except,import-star-module-level,parameter-unpacking,long-suffix,old-octal-literal,old-ne-operator,backtick,old-raise-syntax,print-statement,unpacking-in-except,import-star-module-level,parameter-unpacking,long-suffix,old-octal-literal,old-ne-operator,backtick,old-raise-syntax,print-statement,not-in-loop,function-redefined,continue-in-finally,abstract-class-instantiated,sstar-needs-assignment-target,duplicate-argument-name,too-many-star-expressions,nonlocal-and-global,return-outside-function,return-arg-in-generator,invalid-star-assignment-target,bad-reversed-sequence,nonexistent-operator,yield-outside-function,init-is-generator,nonlocal-without-binding,invalid-unary-operand-type,unsupported-binary-operation,no-member,not-callable,redundant-keyword-arg,assignment-from-no-return,assignment-from-none,not-context-manager,repeated-keyword,missing-kwoa,no-value-for-parameter,invalid-sequence-index,invalid-slice-index,too-many-function-args,unexpected-keyword-arg,unsupported-membership-test,unsubscriptable-object,unpacking-non-sequence,invalid-all-object,no-name-in-module,unbalanced-tuple-unpacking,undefined-variable,undefined-all-variable,used-before-assignment,format-needs-mapping,truncated-format-string,missing-format-string-key,mixed-format-string,too-few-format-args,bad-str-strip-call,too-many-format-args,bad-format-character,access-member-before-definition,method-hidden,assigning-non-slot,duplicate-bases,inconsistent-mro,inherit-non-class,invalid-slots,invalid-slots-object,no-method-argument,no-self-argument,unexpected-special-method-signature,non-iterator-returned,invalid-length-returned
 
 [REPORTS]
 ",travis fails with this config,c,1,1,1
"@@ -610,4 +610,11 @@ Application %1!s! (%2!s!). Cannot identify VFP frame offset.
 .
 ;#endif
 
+MessageId =
+Severity = Error
+Facility = DRCore
+SymbolicName = MSG_COULDNT_SYNCH_WITH_ALL_THREADS
+Language=English
+%1!s!:  DynamoRIO could not synch with all threads.
+.
 ;// ADD NEW MESSAGES HERE","Include the application name and pid, as all the other messages do: best to match them and start with that. I would avoid ""DynamoRIO"": that's parameterized out for crash messages (xref dr_set_client_name(), PRODUCT_NAME, etc.), so best to avoid here. Maybe just ""Application %1!s! (%2!s!): Failed to synchronize with all threads when detaching.""",c,1,1,1
"@@ -36,11 +36,11 @@
 #include <sys/syscall.h>
 #endif
 #if HAVE_VALGRIND
-# if HAVE_VALGRIND_H
-#  include <valgrind.h>
-# elif HAVE_VALGRIND_VALGRIND_H
-#  include <valgrind/valgrind.h>
-# endif
+#if HAVE_VALGRIND_H
+#include <valgrind.h>
+#elif HAVE_VALGRIND_VALGRIND_H
+#include <valgrind/valgrind.h>
+#endif
 #endif
 
 #include ""src/common/libutil/log.h""",I prefer indented preprocessor macros as seen here. Could we consider adding `IndentPPDirectives: AfterHash`? Not important if nobody else cares...,c,1,1,1
"@@ -408,8 +408,16 @@ insert_load_dr_tls_base(dcontext_t *dcontext, instrlist_t *ilist, instr_t *where
 void
 append_fcache_enter_prologue(dcontext_t *dcontext, instrlist_t *ilist, bool absolute)
 {
+#ifdef UNIX
+    instr_t *no_signals = INSTR_CREATE_label(dcontext);
+    /* save callee-saved reg in case we return for a signal */
+    APP(ilist,
+        XINST_CREATE_move(dcontext, opnd_create_reg(DR_REG_X1),
+                          opnd_create_reg(REG_DCXT)));
+#endif
     ASSERT_NOT_IMPLEMENTED(!absolute &&
                            !TEST(SELFPROT_DCONTEXT, dynamo_options.protect_mask));
+
     /* Grab gen routine's parameter dcontext and put it into REG_DCXT:
      * mov x(dxct), x0
      */","This looks identical to ARM's version modulo register names, for which we already have generic versions (R maps to X for generic ptr-sized): could we move this to the aarchxx/ directory?",c,1,1,1
"@@ -1936,6 +1936,14 @@ class ThriftRequestHandler(object):
 
         session = self.__storage_session.get_transaction(run_id)
 
+        all_reports = session.query(Report) \
+            .filter(Report.run_id == run_id) \
+            .all()
+
+        hash_map_reports = defaultdict(list)
+        for report in all_reports:
+            hash_map_reports[report.bug_id].append(report)
+
         # Processing PList files.
         _, _, report_files = next(os.walk(report_dir), ([], [], []))
         for f in report_files:",Is `defaultdict` known? Maybe having a regular dict and `hash_map_reports[report.bug_id] = [report]` Is easier to read?,c,1,1,1
"@@ -190,10 +190,17 @@ func (l *InheritIndex) OnUpdate(update api.Update) (_ bool) {
 }
 
 func (idx *InheritIndex) UpdateSelector(id interface{}, sel selector.Selector) {
-	log.Infof(""Updating selector %v"", id)
 	if sel == nil {
 		log.WithField(""id"", id).Panic(""Selector should not be nil"")
 	}
+	oldSel := idx.selectorsById[id]
+	// Since the selectorRoot struct has cache fields, the easiest way to compare two
+	// selectors is to compare their IDs.
+	if oldSel != nil && oldSel.UniqueID() == sel.UniqueID() {
+		log.WithField(""selID"", id).Info(""Skipping unchanged selector"")
+		return
+	}
+	log.WithField(""selID"", id).Info(""Updating selector"")
 	idx.scanAllLabels(id, sel)
 	idx.selectorsById[id] = sel
 }",Might we still want to do this line - i.e. not return before it - even when the old and new selectors have the same UniqueID?,c,1,1,1
"@@ -136,6 +136,9 @@ static inline pmix_status_t _job_data_store(const char *nspace, void *cbdata)
     int32_t cnt;
     size_t nnodes;
     uint32_t i;
+#if !(defined(PMIX_ENABLE_DSTORE) && (PMIX_ENABLE_DSTORE == 1))
+    uint32_t j;
+#endif
     pmix_nrec_t *nrec, *nr2;
     char **procs = NULL;
     pmix_byte_object_t *bo;",Why this variable was introduced but no usages are visible?,c,1,1,1
"@@ -1169,7 +1169,8 @@ dynamo_shared_exit(thread_record_t *toexit /* must ==cur thread for Linux */
     return SUCCESS;
 }
 
-int
+/* NOINLINE because dynamorio_app_exit is a stopping point. */
+NOINLINE int
 dynamorio_app_exit(void)
 {
     return dynamo_process_exit();",> Those scenarios would need their own optimizer-specific solution. Not for this PR but a future one -- We should add that to the docs: though we never made particular docs for static-library DR so we need to do that first. Maybe we should file an issue on doing that.,c,0,1,1
"@@ -108,6 +108,10 @@ static batch_job_id_t batch_job_wq_wait (struct batch_queue * q, struct batch_jo
 		{
 			return -1;
 		}
+
+		char *transactions = string_format(""%s.transactions"", q->logfile);
+		work_queue_specify_transactions_log(q->data, transactions);
+		free(transactions);
 	}
 
 	if(stoptime == 0) {","More of a meta question, but is there a reason we wait to specify the log and transaction log until batch_job_wait, as opposed to batch_job_create?",c,1,1,1
"@@ -772,10 +772,10 @@ read_evex(byte *pc, decode_info_t *di, byte instr_byte,
         }
         *is_evex = true;
 #if !defined(STANDALONE_DECODER)
-        char pc_addr[IF_X64_ELSE(20, 12)];
-        snprintf(pc_addr, BUFFER_SIZE_ELEMENTS(pc_addr), PFX, pc);
-        NULL_TERMINATE_BUFFER(pc_addr);
-        DO_ONCE(SYSLOG(SYSLOG_ERROR, AVX_512_SUPPORT_INCOMPLETE, 2,
+        DO_ONCE(char pc_addr[IF_X64_ELSE(20, 12)];
+                snprintf(pc_addr, BUFFER_SIZE_ELEMENTS(pc_addr), PFX, pc);
+                NULL_TERMINATE_BUFFER(pc_addr);
+                SYSLOG(SYSLOG_ERROR, AVX_512_SUPPORT_INCOMPLETE, 2,
                        get_application_name(), get_application_pid(), pc_addr));
 #endif
         info = &evex_prefix_extensions[0][1];",The rest of the codebase uses {} for all multi-statement code inside a macro.,c,1,1,1
"@@ -71,7 +71,15 @@ DR_API
 int
 proc_num_simd_saved(void)
 {
+    SELF_UNPROTECT_DATASEC(DATASEC_RARELY_PROT);
     return num_simd_saved;
+    SELF_PROTECT_DATASEC(DATASEC_RARELY_PROT);
+}
+
+void
+proc_set_num_simd_saved(int num)
+{
+    ATOMIC_4BYTE_WRITE(&num_simd_saved, num, false);
 }
 
 DR_API",? This is a read. It should not unprotect .data.,c,1,1,1
"@@ -259,11 +259,11 @@ flb_sds_t flb_sds_cat_utf8 (flb_sds_t *sds, const char *str, int str_len)
             s[head->len++] = '\\';
             s[head->len++] = 'u';
             if (cp > 0xFFFF) {
-                c = int2hex[ (unsigned char) ((cp & 0xf00000) >> 20)];
+                c = (unsigned char) ((cp & 0xf00000) >> 20);
                 if (c > 0) {
                     s[head->len++] = int2hex[c];
                 }
-                c = int2hex[ (unsigned char) ((cp & 0x0f0000) >> 16)];
+                c = (unsigned char) ((cp & 0x0f0000) >> 16);
                 if (c > 0) {
                     s[head->len++] = int2hex[c];
                 }",Here's the array overrun (line 264 and 268).,c,1,1,1
"@@ -3853,6 +3853,8 @@ ostree_repo_pull_with_options (OstreeRepo             *self,
 
       while (g_variant_iter_loop (collection_refs_iter, ""(&s&s&s)"", &collection_id, &ref_name, &checksum))
         {
+          if (!ostree_validate_rev (ref_name, error))
+            goto out;
           g_hash_table_insert (requested_refs_to_fetch,
                                ostree_collection_ref_new (collection_id, ref_name),
                                (*checksum != '\0') ? g_strdup (checksum) : NULL);","We also need this in the next `else if` for `refs_to_fetch`, right?",c,1,1,1
"@@ -334,6 +334,11 @@ static int insert_literal_header(h2o_qpack_decoder_t *qpack, const char *name, s
     return decode_value_and_insert(qpack, header, value_is_huff, value, value_len, err_desc);
 }
 
+static int64_t qpack_table_cur(struct st_h2o_qpack_header_table_t *table)
+{
+    return table->base_offset + ((uintptr_t)table->last - (uintptr_t)table->first);
+}
+
 static int insert_with_name_reference(h2o_qpack_decoder_t *qpack, int name_is_static, int64_t name_index, int value_is_huff,
                                       const uint8_t *value, int64_t value_len, const char **err_desc)
 {","Thank you for the PR. I like the direction of the PR but the cast to `(uintptr_t)` seems incorrect, PTAL #2725.",c,0,1,1
"@@ -1,4 +1,4 @@
-// Copyright (c) 2020 Tigera, Inc. All rights reserved.
+// Copyright (c) 2020-2021 Tigera, Inc. All rights reserved.
 //
 // Licensed under the Apache License, Version 2.0 (the ""License"");
 // you may not use this file except in compliance with the License.","Should revert this copyright change, when the file isn't changing in any other way.",c,1,1,1
"@@ -1853,8 +1853,15 @@ presys_SetContextThread(dcontext_t *dcontext, reg_t *param_base)
     /* FIXME : we are going to read and write to cxt, which may be unsafe */
     ASSERT(tid != 0xFFFFFFFF);
     LOG(THREAD, LOG_SYSCALLS|LOG_THREADS, IF_DGCDIAG_ELSE(1, 2),
-        ""syscall: NtSetContextThread handle=""PFX"" tid=%d cxt->Xip=""PFX""\n"",
-        thread_handle, tid, cxt->CXT_XIP);
+        ""syscall: NtSetContextThread handle=""PFX"" tid=%d cxt->Xip=""PFX"" flags=""PFX""\n"",
+        thread_handle, tid, cxt->CXT_XIP, cxt->ContextFlags);
+    if (get_thread_id() == tid) {
+        /* Simple case when called on own thread. */
+        /* FIXME : we should handle theses flags. */
+        ASSERT(!TEST(CONTEXT_CONTROL, cxt->ContextFlags) &&
+               !TEST(CONTEXT_DEBUG_REGISTERS, cxt->ContextFlags));
+        return execute_syscall;
+    }
     mutex_lock(&thread_initexit_lock); /* need lock to lookup thread */
     if (intercept_asynch_for_thread(tid, false/*no unknown threads*/)) {
         priv_mcontext_t mcontext;","Include the issue number (so ""FIXME i#2249: ..."")",c,0,1,1
"@@ -354,13 +354,10 @@ type BPFDataplane interface {
 	RemoveXDP(ifName string, mode XDPMode) error
 	UpdateCIDRMap(ifName string, family IPFamily, ip net.IP, mask int, refCount uint32) error
 	UpdateFailsafeMap(proto uint8, port uint16) error
-	loadXDPRaw(objPath, ifName string, mode XDPMode, mapArgs []string) error
 	GetBPFCalicoDir() string
 	AttachToSockmap() error
 	DetachFromSockmap(mode FindObjectMode) error
 	RemoveSockmap(mode FindObjectMode) error
-	loadBPF(objPath, progPath, progType string, mapArgs []string) error
-	LoadSockops(objPath string) error
 	LoadSockopsWithBytes(objBytes []byte) error
 	LoadSockopsAuto() error
 	RemoveSockops() error",Please can you merge master in before making these changes. I just reinstated a bunch of BPF UTs. Possible that the UTs use this code.,c,0,0,1
"@@ -412,7 +412,10 @@ os_loader_thread_init_epilogue(dcontext_t *dcontext)
 void
 os_loader_thread_exit(dcontext_t *dcontext)
 {
-    /* do nothing in Windows */
+    /* XXX i#3633: In case of windows 1903 if priv_fls_data endsup in internal lists of
+     * ntdll.dll for FLS, we have to unlink them manually. We do unlinking always.
+     */
+    ntdll_redir_fls_thread_exit(dcontext->priv_fls_data);
 }
 
 void","Again, I don't think we want the `XXX`.",c,1,0,1
"@@ -1337,12 +1337,12 @@ append_restore_simd_reg(dcontext_t *dcontext, instrlist_t *ilist, bool absolute)
         int i;
         uint opcode = move_mm_reg_opcode(true /*align32*/, true /*align16*/);
         ASSERT(proc_has_feature(FEATURE_SSE));
-        for (i = 0; i < NUM_SIMD_SAVED; i++) {
+        for (i = 0; i < proc_num_simd_saved(); i++) {
             APP(ilist,
                 instr_create_1dst_1src(
                     dcontext, opcode, opnd_create_reg(REG_SAVED_XMM0 + (reg_id_t)i),
                     OPND_DC_FIELD(absolute, dcontext, OPSZ_SAVED_XMM,
-                                  XMM_OFFSET + i * XMM_SAVED_REG_SIZE)));
+                                  XMM_OFFSET + i * MAX_SIMD_SLOT_SIZE)));
         }
     }
 }","This seems odd to me: to have a hardcoded opcde and operands for xmm, but with a MAX_ constant for the size? This seems like it could end in an error where MAX_ allows for zmm but this instruction only uses xmm. It seems like the whole insruction needs to vary, not just this size. Ditto below. OK after seeing that this MAX_ is the mcontext field size: how about renaming it so it doesn't sound like it varies. How about MCXT_SIMD_FIELD_SIZE or sthg?",c,1,1,0
"@@ -327,6 +327,14 @@ var _ = infrastructure.DatastoreDescribe(""_BPF-SAFE_ IPIP topology before adding
                 BeforeEach(func() {
                         ctx, cancel := context.WithTimeout(context.Background(), 20*time.Second)
                         defer cancel()
+                        if bpfEnabled {
+                                infra.RemoveNodeAddresses(felixes[0])
+                        } else {
+                                for _, f := range felixes {
+                                        infra.RemoveNodeAddresses(f)
+                                }
+                        }
+
                         listOptions := options.ListOptions{}
                         if bpfEnabled {
                                 listOptions.Name = felixes[0].Hostname",Why this difference?,c,1,0,1
"@@ -1409,10 +1409,11 @@ common_disassemble_fragment(dcontext_t *dcontext, fragment_t *f_in, file_t outfi
             pc = (cache_pc)disassemble_with_bytes(dcontext, (byte *)pc, outfile);
         }
         if (LINKSTUB_DIRECT(l->flags) && DIRECT_EXIT_STUB_DATA_SZ > 0) {
-            ASSERT(DIRECT_EXIT_STUB_DATA_SZ == sizeof(cache_pc));
-            if (stub_is_patched(f, EXIT_STUB_PC(dcontext, f, l))) {
+            ASSERT(DIRECT_EXIT_STUB_DATA_SZ == sizeof(cache_pc) IF_AARCH64(+4));
+            if (stub_is_patched(dcontext, f, EXIT_STUB_PC(dcontext, f, l))) {
                 print_file(outfile, ""  <stored target: "" PFX "">\n"",
-                           *(cache_pc *)next_stop_pc);
+                           *(cache_pc *)IF_AARCH64_ELSE(ALIGN_FORWARD(next_stop_pc, 8),
+                                                        next_stop_pc));
             }
             pc += DIRECT_EXIT_STUB_DATA_SZ;
         }",Maybe make a named constant and use it here and in the define above where it says 12?,c,1,1,1
"@@ -91,15 +91,9 @@ struct wlr_backend *wlr_backend_autocreate(struct wl_display *display) {
                 return NULL;
         }
 
-        int gpu = wlr_session_find_gpu(session);
-        if (gpu == -1) {
-                wlr_log(L_ERROR, ""Failed to open DRM device"");
-                goto error_session;
-        }
-
         backend = wlr_multi_backend_create(session);
         if (!backend) {
-                goto error_gpu;
+                goto error_session;
         }
 
         struct wlr_backend *libinput = wlr_libinput_backend_create(display, session);","Something that might be useful in the future is to specify a list of GPUs to use - then maybe you can run a different compositor on each GPU, for example.",c,1,1,1
"@@ -2834,7 +2834,7 @@ mangle_icache_op(dcontext_t *dcontext, instrlist_t *ilist, instr_t *instr,
 {
     int opc = instr_get_opcode(instr);
     if (opc == OP_sys) {
-        reg_id_t xt = opnd_get_reg(instr_get_src(instr, 1));
+        reg_id_t xt = opnd_get_base(instr_get_dst(instr, 0));
         /* ic ivau, xT is replaced with: */
         PRE(ilist, instr, /* stp x0, x30, [x28] */
             INSTR_CREATE_stp(","Hmm, a cache line invalidation on x86 uses `OP_clflush` which for DR has the address as a source, not a destination. The actual memory contents are not modified so it makes some logical sense. For consistency we should make it a source here, too, right?",c,1,1,1
"@@ -2379,8 +2379,8 @@ options_init()
     /* .lspdata pages start out writable so no unprotect needed here */
     write_lock(&options_lock);
     ASSERT(sizeof(dynamo_options) == sizeof(options_t));
-    /* get dynamo options */
-    adjust_defaults_for_page_size(&dynamo_options);
+    /* reset options to the defaults and get current dynamo options */
+    set_dynamo_options_defaults(&dynamo_options);
     retval = get_parameter(PARAM_STR(DYNAMORIO_VAR_OPTIONS), option_string,
                            sizeof(option_string));
     if (IS_GET_PARAMETER_SUCCESS(retval))","This is a big memcpy. I'd prefer to do this on exit and only if detaching, like we're doing the other expensive zeroing.",c,1,1,1
"@@ -310,6 +310,9 @@ void roots_cursor_handle_motion(struct roots_cursor *cursor,
         double dx = event->delta_x;
         double dy = event->delta_y;
 
+        wlr_seat_pointer_notify_relative_motion(cursor->seat->seat, (uint64_t)
+                event->time_msec, dx, dy, dx, dy);
+
         if (cursor->active_constraint) {
                 struct roots_view *view = cursor->pointer_view->view;
                 assert(view);","nit: put the cast next to the statement it's casting, don't split the line here",c,1,1,1
"@@ -183,6 +183,10 @@ CodeChecker quickcheck -w ~/workspace -b ""cd ~/myproject && make""
 
         workspace_help_msg = """"""Directory where the codechecker can store analysis related data.""""""
 
+        name_help_msg = """"""Name of the analysis.""""""
+
+        jobs_help_msg = '''Number of jobs. Start multiple processes for faster analisys''';
+
         log_argument_help_msg=""""""Path to the log file which is created during the build. \nIf there is an already generated log file with the compilation commands\ngenerated by 'CodeChecker log' or 'cmake -DCMAKE_EXPORT_COMPILE_COMMANDS' \nCodechecker check can use it for the analisys in that case running the original build will \nbe left out from the analysis process (no log is needed).""""""
 
         # --------------------------------------","Use the same """""" everywhere.",c,1,1,1
"@@ -318,6 +318,8 @@ ostree_deployment_unlocked_state_to_string (OstreeDeploymentUnlockedState state)
       return ""hotfix"";
     case OSTREE_DEPLOYMENT_UNLOCKED_DEVELOPMENT:
       return ""development"";
+    case OSTREE_DEPLOYMENT_UNLOCKED_TRANSIENT:
+      return ""transient"";
     }
   g_assert_not_reached ();
 }","Bikeshed/optional: kinda feels like ""development"" should be aliased to ""transient"" instead and this new mode would be ""transient-readonly"" or something? That would capture better the core difference between the two.",c,1,1,1
"@@ -44,7 +44,7 @@ def execute_buildcmd(command, silent=False, env=None, cwd=None):
         if not line and proc.poll() is not None:
             break
         if not silent:
-            print(line)
+            sys.stdout.write(line)
 
     return proc.returncode
 ",Should we check if the line is empty?,c,1,1,1
"@@ -2,8 +2,8 @@
 
 Name:           calico
 Summary:        Project Calico virtual networking for cloud data centers
-Version:        1.3.0
-Release:        0.3%{?dist}
+Version:        1.3.0~pre.2
+Release:        1%{?dist}
 License:        Apache-2
 URL:            http://projectcalico.org
 Source0:        calico-%{version}.tar.gz","RHEL pre-release versions should look like Version: 1.3.0, Release: 0.2.pre%{?dist}. Increment the 2 for each build.",c,1,1,1
"@@ -93,6 +93,11 @@ xfpga_fpgaOpen(fpga_token token, fpga_handle *handle, int flags)
 	// Init workspace table
 	_handle->wsid_root = NULL;
 
+	// Init metric enum
+	_handle->metric_enum_status = false;
+	_handle->dl_handle = NULL;
+	_handle->_bmc_metric_value = NULL;
+
 	// Open resources in exclusive mode unless FPGA_OPEN_SHARED is given
 	open_flags = O_RDWR | ((flags & FPGA_OPEN_SHARED) ? 0 : O_EXCL);
 	fddev = open(_token->devpath, open_flags);",The name dl_handle is too generic. Please rename to reflect its association with metrics.,c,1,1,1
"@@ -67,6 +67,17 @@ static void handle_request_resize(struct wl_listener *listener, void *data) {
 	view_begin_resize(input, event->cursor, view, e->edges);
 }
 
+static void handle_commit(struct wl_listener *listener, void *data) {
+	struct roots_xdg_surface_v6 *roots_xdg_surface =
+		wl_container_of(listener, roots_xdg_surface, commit);
+	struct roots_view *view = roots_xdg_surface->view;
+
+	bool centered = view_center(view);
+	if (centered) {
+		wl_list_remove(&listener->link);
+	}
+}
+
 static void handle_destroy(struct wl_listener *listener, void *data) {
 	struct roots_xdg_surface_v6 *roots_xdg_surface =
 		wl_container_of(listener, roots_xdg_surface, destroy);","Why remove the link if the view is off-screen? Also, won't this center it every time the view configures itself? Like when it's resizing?",c,1,1,1
"@@ -4545,7 +4545,7 @@ ostree_repo_pull_with_options (OstreeRepo             *self,
             }
         }
 
-      if (!summary_from_cache && bytes_summary && bytes_sig)
+      if (!summary_from_cache && bytes_summary && bytes_sig && summary_sig_bytes_v == NULL)
         {
           if (!pull_data->remote_repo_local &&
               !_ostree_repo_cache_summary (self,","What about turning this into a `gboolean summary_sig_from_cache` and setting it to `TRUE` in the same place where the bytes are fetched from the GVariant? That would be symmetrical to `summary_from_cache` which already undergoes similar logic, and would make clearer what's going on (yes, I'm almost got lost reading/keeping track of the logic in this function).",c,1,1,1
"@@ -156,6 +156,7 @@ static pmix_status_t query(pmix_query_t queries[], size_t nqueries, pmix_list_t
                 }
             }
 
+            pmix_output(0, ""SILENCE WARNINGS %u %u"", uid, gid);
             if (0 == strcmp(queries[n].keys[m], PMIX_STORAGE_CAPACITY_LIMIT)) {
                 /* ADD HERE:
                  *",I think the cause of the CI failure is this debugging line that was left in place.,c,1,1,1
"@@ -155,6 +155,8 @@ typedef struct {
    * whether to fetch the primary object after fetching its
    * detached metadata (no need if it's already stored). */
   gboolean     object_is_stored;
+
+  OstreeCollectionRef *requested_ref;  /* (nullable) */
 } FetchObjectData;
 
 typedef struct {",Should this be `/* (nullable) */` for if we're just pulling a checksum?,c,1,1,1
"@@ -40,6 +40,12 @@
 -- @param _buttons The table of buttons that should bind to the widget.
 -- @function buttons
 
+--- Emit a signal and ensure all parent widgets in the hierarchies also
+-- forward the signal. This is useful to track signals when there is a dynamic
+-- set of containers and layouts wrapping the widget.
+-- @tparam string signal_name
+-- @param ... Other arguments
+-- @function emit_signal_recursive
 
 --- When the layout (size) change.
 -- This signal is emited when the previous results of `:layout()` and `:fit()`",This part seems to be in the wrong commit. The next commit adds this function.,c,0,0,1
"@@ -120,7 +120,11 @@ json_t *job_to_json (struct job *job, json_t *attrs, job_info_error_t *errp)
         else if (!strcmp (attr, ""ranks"")) {
             if (!(job->states_mask & FLUX_JOB_RUN))
                 continue;
-            val = json_string (job->ranks);
+            /* potentially NULL if R invalid */
+            if (job->ranks)
+                val = json_string (job->ranks);
+            else
+                val = json_string ("""");
         }
         else if (!strcmp (attr, ""expiration"")) {
             if (!(job->states_mask & FLUX_JOB_RUN))",Suggest you break the inner block of the loop out to its own function as this is getting pretty long and the control flow harder to follow.,c,1,1,1
"@@ -38,6 +38,9 @@ static int on_req(h2o_handler_t *_self, h2o_req_t *req)
     }
 
     h2o_http2_debug_state_t *debug_state = req->conn->callbacks->get_debug_state(req, self->hpack_enabled);
+    if (debug_state == NULL) {
+        return -1;
+    }
 
     // stringify these variables to embed in Debug Header
     h2o_iovec_t conn_flow_in, conn_flow_out;","I assume that we have similar code everywhere; one that check if the callback is NULL, if not, calls the callback and check if the return value is NULL. In other words, we are performing the check twice. I do not think that having such coding pattern is optimal. Instead, could we require every instance of `http_conn_callbacks_t` to setup all the callback pointers, so that we can call the callback unconditionally? For example, you could define ""default"" functions that return NULL (e.g. `h2o_http2_debug_state_t *h2o_conn_default_get_debug_state(h2o_req_t *req, int hpack_enabled) { return NULL; }`) and let the callbacks (that do not require a specialized implementation) use the default.",c,1,1,0
"@@ -115,7 +115,7 @@ var _ = Describe(""with running container"", func() {
 		It(""iptables should succeed in getting the lock after 3s"", func() {
 			iptCmd := cmdInContainer(""iptables"", ""-w"", ""3"", ""-A"", ""FORWARD"")
 			out, err := iptCmd.CombinedOutput()
-			Expect(string(out)).To(ContainSubstring(""Another app is currently holding the xtables lock""))
+			log.Printf(""iptables output='%s'"", out)
 			Expect(err).NotTo(HaveOccurred())
 		})
 ","Since we're using Logrus, probably best to use `Infof` to avoid confusion (Logrus' Printf behaves differently to the built in one)",c,1,1,1
"@@ -142,6 +142,19 @@ def add_arguments_to_parser(parser):
                              ""consult the User guide on how a Skipfile ""
                              ""should be laid out."")
 
+    parser.add_argument('--trim-path-prefix',
+                        type=str,
+                        nargs='*',
+                        dest=""trim_path_prefix"",
+                        required=False,
+                        default=argparse.SUPPRESS,
+                        help=""Removes leading path from files which will be ""
+                             ""printed. So if you have /a/b/c/x.cpp and ""
+                             ""/a/b/c/y.cpp then by removing \""/a/b/\"" prefix ""
+                             ""will print files like c/x.cpp and c/y.cpp. ""
+                             ""If multiple prefix is given, the longest match ""
+                             ""will be removed."")
+
     logger.add_verbose_arguments(parser)
 
     def __handle(args):",Please update the help message. This is done for parse not for store.,c,1,1,1
"@@ -73,7 +73,7 @@ fpga_result read_sysfs(fpga_token token, char *sysfs_path,
 		resval = res;
 		goto out_destroy;
 	}
-	printf(""size=%d \n"", size);
+
 	if (size > len) {
 		OPAE_ERR(""object size bigger then buffer size"");
 		resval = FPGA_EXCEPTION;",Could you submit this one in a separate pull request?,c,0,0,1
"@@ -336,7 +336,7 @@ static CALI_BPF_INLINE int calico_tc(struct __sk_buff *skb)
 		.reason = CALI_REASON_UNKNOWN,
 	};
 	struct calico_nat_dest *nat_dest = NULL;
-	bool nat_lvl1_drop = 0;
+	int res = 0;
 
 	/* we assume we do FIB and from this point on, we only set it to false
 	 * if we decide not to do it.",I think (a) should be initialized to `NAT_FE_LOOKUP_ALLOW` and (b) it should be probably the first thing in `calico_v4_nat_lookup2`,c,1,1,1
"@@ -47,5 +47,11 @@ class ClangTidyPlistToFile(ResultHandler):
         tidy_stdout = self.analyzer_stdout.splitlines()
         generate_plist_from_tidy_result(output_file, tidy_stdout)
 
-        if self.report_hash_type == 'context-free':
+        # In the earlier versions of CodeChecker Clang Tidy never used context
+        # free hash even if we enabled it with '--report-hash context-free'
+        # when calling the analyze command. To do not break every hash
+        # automatically when using this option we introduced a new choice for
+        # --report-hash option ('context-free-v2') and we still do not use
+        # context free hash for 'context-free' choice.
+        if self.report_hash_type == 'context-free-v2':
             report.use_context_free_hashes(output_file)",why would `if self.report_hash_type == 'context-free-v2':` not enough here?,c,1,1,1
"@@ -5092,7 +5092,7 @@ const instr_info_t prefix_extensions[][12] = {
     {INVALID,  0xf338f018, ""(bad)"",   xx, xx, xx, xx, xx, no, x, NA},
     /* really this is regular data-size prefix */
     {OP_movbe, 0x6638f018, ""movbe"", Gw, xx, Mw, xx, xx, mrm, x, tpe[139][2]},
-    {OP_crc32, 0xf238f018, ""crc32"", Gv, xx, Eb, Gv, xx, mrm, x, END_LIST},
+    {OP_crc32, 0xf238f018, ""crc32"", Gd_q, xx, Eb, Gd_q, xx, mrm, x, END_LIST},
     {INVALID,    0x38f018, ""(bad)"",   xx, xx, xx, xx, xx, no, x, NA},
     {INVALID,  0xf338f018, ""(bad)"",   xx, xx, xx, xx, xx, no, x, NA},
     {INVALID,  0x6638f018, ""(bad)"",   xx, xx, xx, xx, xx, no, x, NA},","Looking at the manual, yes for the destination. But the source seems to be always 1-byte for the F0 version, and 2/4/8 bytes for the F1. Why Gd_q for the source?",c,1,1,1
"@@ -289,6 +289,12 @@ h2o_logconf_t *h2o_logconf_compile(const char *fmt, int escape, char *errbuf)
                     MAP_EXT_TO_PROTO(""ssl.cipher-bits"", ssl.cipher_bits);
                     MAP_EXT_TO_PROTO(""ssl.session-id"", ssl.session_id);
                     MAP_EXT_TO_PROTO(""ssl.server-name"", ssl.server_name);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.protocol-version"", proxy_ssl.protocol_version);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.session-reused"", proxy_ssl.session_reused);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.cipher"", proxy_ssl.cipher);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.cipher-bits"", proxy_ssl.cipher_bits);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.session-id"", proxy_ssl.session_id);
+                    MAP_EXT_TO_PROTO(""proxy.ssl.server-name"", proxy_ssl.server_name);
                     { /* not found */
                         h2o_iovec_t name = strdup_lowercased(pt, quote_end - pt);
                         NEW_ELEMENT(ELEMENT_TYPE_EXTENDED_VAR);",Maybe you missed removing some from here?,c,1,1,1
"@@ -623,6 +623,8 @@ get_config_val_other_arch(const char *var, char *val, size_t valsz, bool *app_sp
 void
 config_init(void)
 {
+    // Zero out myvals in case of reattach so that we re-load the config:
+    myvals = (const config_vals_t){0};
     config.u.v = &myvals;
     config_read(&config, NULL, 0, CFG_SFX);
     config_initialized = true;",Please put this in config_exit with the existing detach zeroing,c,1,1,1
"@@ -543,6 +543,9 @@ main(int argc, char **argv)
     /* We have no clue where the input focus is right now */
     globalconf.focus.need_update = true;
 
+    /* set the default preferred icon size */
+    globalconf.preferred_icon_size = 0;
+
     /* XLib sucks */
     XkbIgnoreExtension(True);
 ","Could the default be more dynamic, e.g. depending on the DPI?",c,1,1,1
"@@ -472,6 +472,18 @@ void TNonblockingServer::TConnection::workSocket() {
     }
     // size known; now get the rest of the frame
     transition();
+
+    // If the socket has more data than the frame header, continue to work on it. This is not strictly necessary for
+    // regular sockets, because if there is more data, libevent will fire the event handler registered for read
+    // readiness, which will in turn call workSocket(). However, some socket types (such as TSSLSocket) may have the
+    // data sitting in their internal buffers and from libevent's perspective, there is no further data available. In
+    // that case, not having this workSocket() call here would result in a hang as we will never get to work the socket,
+    // despite having more data.
+    if (tSocket_->hasPendingDataToRead())
+    {
+        workSocket();
+    }
+
     return;
 
   case SOCKET_RECV:","Should this be an ""if"" or a ""while""?",c,1,1,1
"@@ -0,0 +1,15 @@
+#include <stddef.h>
+
+#ifdef PLATFORM_IS_VISUAL_STUDIO
+#  define EXPORT_SYMBOL __declspec(dllexport)
+#else
+#  define EXPORT_SYMBOL
+#endif
+
+typedef void (*baretest_callback_fn)(size_t value);
+
+EXPORT_SYMBOL extern void baretest_callback(baretest_callback_fn cb, size_t value)
+{
+  cb(value);
+}
+","If we don't support Windows, this wouldn't be needed.",c,1,1,1
"@@ -17,8 +17,8 @@
 #include <libgen.h>
 #include <dlfcn.h>
 #include <argz.h>
-#include <flux/core.h>
 #include <czmq.h>
+#include <flux/core.h>
 #include <jansson.h>
 
 #include ""src/common/libutil/xzmalloc.h""",Can this czmq.h include be dropped with the addition of the czmq_containers.h?,c,1,1,1
"@@ -293,6 +293,7 @@ release:
 	pixman_region32_init(&surface->current.buffer_damage);
 
 	wl_resource_queue_event(surface->current.buffer, WL_BUFFER_RELEASE);
+	surface->current.buffer = NULL;
 }
 
 static void surface_set_buffer_transform(struct wl_client *client,","Probably ok for a temporary workaround. But keep in mind that this will lead to issues as soon as we implement the TODO at the top of the function, i.e. empty the texture when there was a null buffer attached. It would be triggered from this i guess (when damage_flush is called multiple times).",c,1,1,1
"@@ -63,7 +63,9 @@ type L3RouteResolver struct {
         blockToRoutes          map[string]set.Set
         allPools               map[string]model.IPPool
         workloadIDToCIDRs      map[model.WorkloadEndpointKey][]cnet.IPNet
+        nodeToCIDRs            map[string]set.Set
         useNodeResourceUpdates bool
+        routeSource            string
 }
 
 type l3rrNodeInfo struct {","UT spotted that we weren't marking routes dirty when they targeted at Node and that node's IP changed. e.g., the case where a WEP appears in the syncer before the corresponding node does, so we don't know the node's IP. I added a new map to track the CIDRs for each node so that when the node IP changes we can mark those CIDRs dirty. Right now it's only used for the ""WorkloadIPs"" scenario. Need to decide if the same issue applies in the ""CalicoIPAM' case. I suspect it might. It looks like we have some logic present to detect when our own node IP changes, but we don't seem to handle when a remote node's IP changes.",c,1,1,0
"@@ -172,6 +172,7 @@ type Config struct {
 	IptablesLockFilePath               string        `config:""file;/run/xtables.lock""`
 	IptablesLockTimeoutSecs            time.Duration `config:""seconds;0""`
 	IptablesLockProbeIntervalMillis    time.Duration `config:""millis;50""`
+	IptablesFeatureDetectOverride      string        `config:""string;;local""`
 	IpsetsRefreshInterval              time.Duration `config:""seconds;10""`
 	MaxIpsetSize                       int           `config:""int;1048576;non-zero""`
 	XDPRefreshInterval                 time.Duration `config:""seconds;90""`","Suggest making this just `FeatureDetectOverride`; can see it being useful with the BPF dataplane too. It's fairly easy to add a validator, just change `config:""string;;local""` to `config:""feat-override;;local""`, for example, and then add an entry to the `loadParams()` function below. To validate, you could call the parse function and return an error if the parse fails.",c,1,1,1
"@@ -1332,11 +1332,15 @@ fsfreeze_thaw_cycle (OstreeSysroot *self,
       /* Do a freeze/thaw cycle; TODO add a FIFREEZETHAW ioctl */
       if (ioctl (rootfs_dfd, FIFREEZE, 0) != 0)
         {
-          /* Not supported, or we're running in the unit tests (as non-root)?
+          /* Not supported, we're running in the unit tests (as non-root), or
+           * the filesystem is already frozen (EBUSY).
            * OK, let's just do a syncfs.
            */
-          if (G_IN_SET (errno, EOPNOTSUPP, EPERM))
+          if (G_IN_SET (errno, EOPNOTSUPP, EPERM, EBUSY))
             {
+              /* Warn if the filesystem was already frozen */
+              if (errno == EBUSY)
+                g_debug (""Filesystem already frozen, falling back to syncfs"");
               if (TEMP_FAILURE_RETRY (syncfs (rootfs_dfd)) != 0)
                 return glnx_throw_errno_prefix (error, ""syncfs"");
               /* Write the completion, and return */","I'm not a big fan of random spew from libraries. (What spew we do I'd prefer to use `sd_journal_print` and not stderr). Let's drop the `g_warning()` here? I'd been thinking to at some point gather stats on how long `syncfs()` takes etc (and eventually a signal so clients can know we're doing it), so we could also log whether we used `FIFREEZE` or `syncfs()` then too.",c,1,1,1
"@@ -1040,7 +1040,9 @@ luaA_screen_module_index(lua_State *L)
             foreach(output, (*screen)->outputs)
                 if(A_STREQ(output->name, name))
                     return luaA_object_push(L, *screen);
-        luaL_error(L, ""Unknown screen output name: %s"", name);
+        luaA_warn(L, ""Unknown screen output name: %s"", name);
+        lua_pushnil(L);
+        return 1;
     }
 
     return luaA_object_push(L, luaA_checkscreen(L, 2));",mb still print the warning?,c,1,0,0
"@@ -77,9 +77,6 @@ struct flb_td *td_config_init(struct flb_output_instance *ins)
             return NULL;
         }
     }
-    else {
-        ctx->region = FLB_TD_REGION_US;
-    }
 
     flb_plg_info(ctx->ins, ""Treasure Data / database='%s' table='%s'"",
                  ctx->db_name, ctx->db_table);","If `tmp` is guaranteed not to be `NULL`, whole if statement has to be removed.",c,1,1,1
"@@ -2836,10 +2836,12 @@ client_process_bb(dcontext_t *dcontext, build_bb_t *bb)
 #    ifdef X86
         if (!d_r_is_avx512_code_in_use()) {
             if (ZMM_ENABLED()) {
-                if (instr_may_write_zmm_register(inst)) {
-                    LOG(THREAD, LOG_INTERP, 2, ""Detected AVX-512 code in use\n"");
-                    d_r_set_avx512_code_in_use(true);
-                    proc_set_num_simd_saved(MCXT_NUM_SIMD_SLOTS);
+                if (!instr_is_meta(inst)) {
+                    if (instr_may_write_zmm_or_opmask_register(inst)) {
+                        LOG(THREAD, LOG_INTERP, 2, ""Detected AVX-512 code in use\n"");
+                        d_r_set_avx512_code_in_use(true);
+                        proc_set_num_simd_saved(MCXT_NUM_SIMD_SLOTS);
+                    }
                 }
             }
         }",Just move this down below the instr_is_meta check + continue below and then this if goes away.,c,1,1,1
"@@ -125,7 +125,8 @@ type Config struct {
         MetadataAddr string `config:""hostname;127.0.0.1;die-on-fail""`
         MetadataPort int    `config:""int(0,65535);8775;die-on-fail""`
 
-        InterfacePrefix string `config:""iface-list;cali;non-zero,die-on-fail""`
+        InterfacePrefix  string `config:""iface-list;cali;non-zero,die-on-fail""`
+        InterfaceExclude string `config:""iface-list;kube-ipvs0""`
 
         ChainInsertMode             string `config:""oneof(insert,append);insert;non-zero,die-on-fail""`
         DefaultEndpointToHostAction string `config:""oneof(DROP,RETURN,ACCEPT);DROP;non-zero,die-on-fail""`","I feel slightly that InterfaceExclude is not a clear name - bearing in mind that our config names are, to some extent, an external API. From an external point of view, a clearer name might be IPVSInterfaces. Then it would obviously make sense for the value to be something like 'kube-ipvs0', and it would be a matter of Felix's internal implementation that we choose to exclude those interfaces from our monitoring. Alternatively, if we want to keep this at a level that is more general than just IPVS, perhaps 'UnmonitoredInterfaces'? WDYT?",c,1,1,0
"@@ -238,6 +238,10 @@ def main(args):
     # Parse the JSON CCDBs and retrieve the compile commands.
     actions = []
 
+    if len(args.logfile) != 1:
+        LOG.warning(""Only one log file can be processed right now!"")
+        sys.exit(1)
+
     for log_file in args.logfile:
         if not os.path.exists(log_file):
             LOG.error(""The specified logfile '"" + log_file + ""' does not """,`logfile` flag is declared to be a string in the command line arguments. Isn't it going to check the length of that string? This can be an array if this `analyze` module is loaded from a wrapper module (e.g. `CodeChecker check`) which gives it an array. By the way `CodeChecker check` gives it an array of length 1. Can this array be longer?,c,1,1,1
"@@ -394,6 +394,8 @@ static SSL_CTX *_create_ssl_context(int is_client) {
 
         openssl_initialized = 1;
 
+        SSL_load_error_strings();
+
         if(is_client) {
                 #ifdef HAS_TLS_method
                 method = TLS_client_method();",Move to if in line 390.,c,1,0,1
"@@ -801,6 +801,13 @@ func findHostMTU(matchRegex *regexp.Regexp) (int, error) {
 			smallest = l.Attrs().MTU
 		}
 	}
+
+	if smallest == 0 {
+		// We failed to find a usable interface. Default the MTU of the host
+		// to 1460 - the smallest among common cloud providers.
+		log.Warn(""Failed to auto-detect host MTU, assuming 1460"")
+		return 1460, nil
+	}
 	return smallest, nil
 }
 ","You could improve this log by saying something like ""Failed to auto-detect host's MTU, no interfaces matched the MTU data interface pattern; to use auto MTU detection, set <param name> to match your host's interfaces.""",c,1,1,1
"@@ -823,7 +823,10 @@ err:
  */
 static int job_get_ns_name (char *buf, int bufsz, flux_jobid_t id)
 {
-    return fluid_encode (buf, bufsz, id, FLUID_STRING_DOTHEX);
+    int n = snprintf (buf, bufsz - 1, ""job-%ju"", id);
+    if (n < 0 || n > bufsz - 1)
+        return -1;
+    return 0;
 }
 
 static double job_get_kill_timeout (flux_t *h)","i think you have to check `n` for validity before doing `n-1` b/c snprintf takes a `size_t`. although this is internal code (static function), so maybe it doesn't matter.",c,1,1,1
"@@ -877,15 +877,12 @@ static vString *parseInteger (int c)
 
 static vString *parseNumeric (int c)
 {
-	vString *string = vStringNew ();
-	vString *integer = parseInteger (c);
-	vStringCopy (string, integer);
-	vStringDelete (integer);
+	vString *string = parseInteger (c);
 
 	c = getChar ();
 	if (c == '.')
 	{
-		integer = parseInteger ('\0');
+		vString *integer = parseInteger ('\0');
 		vStringPut (string, c);
 		vStringCat (string, integer);
 		vStringDelete (integer);","could be on one single line, `vString *integer = parseInteger ('\0');`",c,1,1,1
"@@ -53,6 +53,8 @@ instr_length_arch(dcontext_t *dcontext, instr_t *instr)
 {
     if (instr_get_opcode(instr) == OP_LABEL)
         return 0;
+    if (instr_get_opcode(instr) == OP_ldstex)
+        return opnd_get_immed_int(instr_get_src(instr, 0)) * AARCH64_INSTR_SIZE;
     return AARCH64_INSTR_SIZE;
 }
 ",Could we use instr_t.length and avoid having a hacky fake operand?,c,1,1,1
"@@ -316,9 +316,9 @@ AS_IF([test ""x$enable_pylint"" = ""xyes""], [
   AC_CHECK_PROG(PYLINT,[pylint],[pylint])
   AS_IF([test ""x$PYLINT"" != ""xpylint""], [AC_MSG_ERROR([No pylint found in PATH])])
   AM_CHECK_PYMOD(pylint,
-                   [StrictVersion(pylint.__version__) >= StrictVersion('1.4.5')],
+                   [StrictVersion(pylint.__version__) >= StrictVersion('1.8.4')],
                    ,
-                   [AC_MSG_ERROR([could not find python module pylint, version 1.4.5+ required])]
+                   [AC_MSG_ERROR([could not find python module pylint, version 1.8.4+ required])]
                  )
 ])
 AM_CONDITIONAL([ENABLE_PYLINT], [test ""x$PYLINT"" = ""xpylint""])","pylint on TOSS 3 is 1.6.5. However, since this check is only made with `--enable-pylint` it is probably fine.",c,1,1,1
"@@ -59,6 +59,15 @@ else
 fi
 AM_CONDITIONAL(BUILDOPT_ASAN, [test x$using_asan = xyes])
 
+AC_MSG_CHECKING([for -fsanitize=thread in CFLAGS])
+if echo $CFLAGS | grep -q -e -fsanitize=thread; then
+  AC_MSG_RESULT([yes])
+  using_tsan=yes
+else
+  AC_MSG_RESULT([no])
+fi
+AM_CONDITIONAL(BUILDOPT_TSAN, [test x$using_tsan = xyes])
+
 # Initialize libtool
 LT_PREREQ([2.2.4])
 LT_INIT([disable-static])",Almost; since we're doing the preprocessor here we need an `AM_COND_IF()` + `AC_DEFINE()`.,c,1,1,1
"@@ -548,6 +548,10 @@ static int fill_headers(h2o_req_t *req, struct phr_header *headers, size_t num_h
         }
     }
 
+    /* add date: if it's missing from the response */
+    if (h2o_find_header(&req->res.headers, H2O_TOKEN_DATE, 0) < 0)
+        h2o_resp_add_date_header(req);
+
     return 0;
 }
 ","Could we use `!= -1` as a check? It means the same, but it might be a good idea to be consistent with other parts of the code that invoke the same function.",c,1,1,1
"@@ -294,7 +294,7 @@ static bool link_exe(compile_t* c, ast_t* program,
 
   snprintf(ld_cmd, ld_len,
 #if defined(PLATFORM_IS_ARM)
-    ""%s -execute -arch %.*s ""
+    ""%s -execute -no_pie -arch %.*s ""
 #else
     ""%s -execute -no_pie -arch %.*s ""
 #endif",This option doesn't exist on the m1. I don't know if it's something related to arm64 or apple-specific.,c,1,1,1
"@@ -488,7 +488,7 @@ int main(int argc, char** argv) {
       testClient.testBinary(bin_result, string(bin_data, 256));
       if (bin_result.size() != 256) {
         printf(""}\n*** FAILED ***\n"");
-        printf(""invalid length: %lu\n"", bin_result.size());
+        printf(""invalid length: %zu\n"", bin_result.size());
         return_code |= ERR_BASETYPES;
       } else {
         bool first = true;","Given this is in test code, why not use something that is more flexible: `printf(boost::str(boost::format(""invalid length: %1%\n"") % bin_result.size()));` instead?",c,1,1,1
"@@ -485,7 +485,7 @@ void genprim_pointer_methods(compile_t* c, reach_type_t* t)
   pointer_lt(c, t);
 }
 
-static void maybe_create(compile_t* c, reach_type_t* t, compile_type_t* t_elem)
+static void nullable_pointer_create(compile_t* c, reach_type_t* t, compile_type_t* t_elem)
 {
   FIND_METHOD(""create"", TK_NONE);
 ",i dont think we want to do these changes as part of RFC. need to discuss at sync.,c,1,1,1
"@@ -76,7 +76,7 @@ class CppcheckAnalyzerResult(AnalyzerResult):
                                          files[diag['location']['file']])
                 diag['issue_hash_content_of_line_in_context'] = report_hash
 
-    def _write(self, file_to_plist_data, output_dir):
+    def _write(self, file_to_plist_data, output_dir, file_name):
         """""" Creates plist files from the parse result to the given output. """"""
         output_dir = os.path.abspath(output_dir)
         for file_name, plist_data in file_to_plist_data.items():",why is the filename_needed here? The variable is overwritten in the for loop below and not used before that.,c,1,1,1
"@@ -156,7 +156,7 @@ extern const char *tagFileName (void)
 
 extern void abort_if_ferror(MIO *const mio)
 {
-	if (mio_error (mio))
+	if (mio != NULL && mio_error (mio))
 		error (FATAL | PERROR, ""cannot write tag file"");
 }
 ",These NULL checks are here because we bypass opening the MIO which is always NULL in our case.,c,1,1,1
"@@ -503,6 +503,11 @@ drreg_insert_restore_all(void *drcontext, instrlist_t *bb, instr_t *inst,
             regs_restored[GPR_IDX(reg)] = false;
         if (!pt->reg[GPR_IDX(reg)].native) {
             if (force_restore || instr_reads_from_reg(inst, reg, DR_QUERY_INCLUDE_ALL) ||
+                /* Restore all app values prior to an annotation to ensure the
+                 * arguments passed to the handler are correct.
+                 */
+                (instr_is_label(inst) &&
+                 (ptr_uint_t)instr_get_note(inst) == DR_NOTE_ANNOTATION) ||
                 /* Treat a partial write as a read, to restore rest of reg */
                 (instr_writes_to_reg(inst, reg, DR_QUERY_INCLUDE_ALL) &&
                  !instr_writes_to_exact_reg(inst, reg, DR_QUERY_INCLUDE_ALL)) ||",In this context it may be better to s/handler/annotation handler/,c,1,1,1
"@@ -56,6 +56,15 @@ struct st_h2o_http1_conn_t {
         void *data;
         h2o_http1_upgrade_cb cb;
     } upgrade;
+    struct {
+        unsigned sending : 1;
+        unsigned has_pending_hints : 1;
+        struct {
+            h2o_iovec_t *inbufs;
+            size_t inbufcnt;
+            h2o_send_state_t send_state;
+        } pending_final;
+    } informational;
     /* the HTTP request / response (intentionally placed at the last, since it is a large structure and has it's own ctor) */
     h2o_req_t req;
 };","I can see that we need to buffer the content passed from the generator, now that informational responses could be in flight. Then, can't we simplify the logic by using the same buffer for storing _any_ pending data, including when we receive an additional 103 while a previous 103 is in flight?",c,1,1,1
"@@ -94,6 +94,9 @@ static struct optparse_option put_opts[] =  {
     { .name = ""no-merge"", .key = 'n', .has_arg = 0,
       .usage = ""Set the NO_MERGE flag to ensure commit is standalone"",
     },
+    { .name = ""append"", .key = 'A', .has_arg = 0,
+      .usage = ""Append value(s) to key instead of overwriting"",
+    },
     OPTPARSE_TABLE_END
 };
 ",Any reason not to use little a for the short opt?,c,1,1,1
"@@ -49,10 +49,10 @@
 static int counter = 0;
 static struct itable *finished_tasks = NULL;
 static int is_mesos_py_path_known = 0;
-static int is_mesos_master_known = 0;
+static int is_mesos_manager_known = 0;
 static int is_scheduler_running = 0;
 static const char *mesos_py_path = NULL;
-static const char *mesos_master = NULL;
+static const char *mesos_manager = NULL;
 static const char *mesos_preload = NULL;
 
 static void start_mesos_scheduler(struct batch_queue *q)","IIRC ""master"" is the terminology used by mesos.",c,1,1,1
"@@ -1295,6 +1295,12 @@ static size_t decrypt_cid(quicly_cid_encryptor_t *self, quicly_cid_plaintext_t *
 
     update_quic_keys();
 
+    /* precondition for calling `keyset->cid->decrypt_cid` is that the input of that callback is not zero-length; that is met when
+     * when the input to this function is known to be capable of carrying full-sized V1 CID (i.e. len == 0) or the length is known
+     * (i.e. long header packet) and is at least 2 bytes long */
+    if (len == 1)
+        return SIZE_MAX;
+
     if ((keyset = find_quic_keyset(encrypted[0])) == NULL)
         return SIZE_MAX;
     if ((len = keyset->cid->decrypt_cid(keyset->cid, plaintext, encrypted + 1, len != 0 ? len - 1 : 0)) == SIZE_MAX)","nit: duplicated ""when""",c,1,0,1
"@@ -141,6 +141,8 @@ event_module_load(void *drcontext, const module_data_t *data, bool loaded)
         entry = drvector_get_entry(&module_table.vector, i);
         mod   = entry->data;
         if (entry->unload &&
+            /* only check the main (containing) module */
+            entry->id == entry->containing_id &&
             /* If the same module is re-loaded at the same address,
              * we will try to use the existing entry.
              */",Please add a note that this is needed b/c the loop is backward,c,1,1,1
"@@ -1824,7 +1824,7 @@ find_syscall_num(dcontext_t *dcontext, instrlist_t *ilist, instr_t *instr)
 
     if (prev == NULL) {
 #if defined(WINDOWS) && defined(X64)
-        if (get_os_version() >= WINDOWS_VERSION_10_1511) {
+        if (get_os_version() >= WINDOWS_VERSION_10_1511 && !DYNAMO_OPTION(inject_x64)) {
             /* Handle the branch added in 1511 that isolates OP_syscall:
              *   7ff9`13185630 4c8bd1          mov     r10,rcx
              *   7ff9`13185633 b843000000      mov     eax,43h",I don't understand: this same code will be there when in 64-bit mode: why disable it?,c,1,1,1
"@@ -662,4 +662,12 @@ Language=English
 Application %1!s! (%2!s!). Out of contiguous memory. %3!s!
 .
 
+MessageId =
+Severity = Error
+Facility = DRCore
+SymbolicName = MSG_AVX_512_SUPPORT_INCOMPLETE
+Language=English
+Application %1!s! (%2!s!): AVX-512 was detected at PC 0x%3!lx!
+.
+
 ;// ADD NEW MESSAGES HERE","First, long is 32 bits in Visual Studio, so this the wrong size specifier. Second, I don't know for sure whether anything but 's' works for Windows event log -- we had sort of been operating under that assumption as you can see from all of the other numeric params being 's' but I didn't write that code.",c,1,1,1
"@@ -158,12 +158,7 @@ void event_publish (struct event *event, const char *topic,
     struct job_manager *ctx = event->ctx;
     flux_future_t *f;
 
-    /* O? support in jansson 2.8 */
-    if (o)
-        f = flux_event_publish_pack (ctx->h, topic, 0, ""{s:O}"", key, o);
-    else
-        f = flux_event_publish_pack (ctx->h, topic, 0, ""{s:n}"", key);
-    if (!f) {
+    if (!(f = flux_event_publish_pack (ctx->h, topic, 0, ""{s:O?}"", key, o))) {
         flux_log_error (ctx->h, ""%s: flux_event_publish_pack"", __FUNCTION__);
         goto error;
     }",There's another one of these in `event_batch_pub_annotations()` (searsch for jansson 2.8).,c,1,1,1
"@@ -4,11 +4,13 @@
 #   This file is distributed under the University of Illinois Open Source
 #   License. See LICENSE.TXT for details.
 # -----------------------------------------------------------------------------
+from time import sleep
 
 """"""Setup for the test package comment.""""""
 
 from subprocess import CalledProcessError
 
+import json
 import multiprocessing
 import os
 import shutil",This import might be unused.,c,1,1,1
"@@ -6,7 +6,7 @@
 
 #	Process this file with autoconf to produce a configure script.
 
-AC_PREREQ([2.59])
+AC_PREREQ([2.64])
 AC_INIT([universal-ctags],[5.9.0])
 
 if ! test -e ""${srcdir}/config.h.in""; then",NOTE for myself: the version of autoconf shipped as part of RHEL6 is 2.63. The time for thinking about preparing weekly tarball with generated configure comes.,c,0,0,1
"@@ -741,6 +741,12 @@ read_evex(byte *pc, decode_info_t *di, byte instr_byte,
             return pc;
         }
         *is_evex = true;
+#if !defined(STANDALONE_DECODER)
+        char pc_addr[IF_X64_ELSE(20, 12)];
+        snprintf(pc_addr, BUFFER_SIZE_ELEMENTS(pc_addr), PFX, pc);
+        SYSLOG(SYSLOG_ERROR, AVX_512_SUPPORT_INCOMPLETE, 2, get_application_name(),
+               get_application_pid(), pc_addr);
+#endif
         info = &evex_prefix_extensions[0][1];
     } else {
         /* not evex */",style: always NULL_TERMINATE_BUFFER after snprintf,c,1,1,1
"@@ -5555,10 +5555,6 @@ emit_special_ibl_xfer(dcontext_t *dcontext, byte *pc, generated_code_t *code, ui
         INSTR_CREATE_cbz(dcontext, opnd_create_instr(skip_unlinked_tgt_jump),
                          opnd_create_reg(SCRATCH_REG5)));
     insert_shared_restore_dcontext_reg(dcontext, &ilist, NULL);
-    /* i#4670: The unlinking case is observed to hit very infrequently on x86. The issue
-     *  or the fix have not been observed on AArchXX yet.
-     */
-    ASSERT_NOT_TESTED();
 #        if defined(AARCH64)
     APP(&ilist,
         INSTR_CREATE_ldr(","> iX: r We don't put ""iX"" in the title: just the branch name. So `s/iX: r/R/`.",c,0,0,1
"@@ -41,6 +41,10 @@ static gboolean opt_verbose;
 static gboolean opt_version;
 static gboolean opt_print_current_dir;
 
+// TODO: make this public?  But no one sane wants to use our C headers
+// to find where to put files.  Maybe we can make it printed by the CLI?
+#define _OSTREE_EXT_DIR PKGLIBEXECDIR ""/ext""
+
 static GOptionEntry global_entries[] = {
   { ""verbose"", 'v', 0, G_OPTION_ARG_NONE, &opt_verbose, ""Print debug information during command processing"", NULL },
   { ""version"", 0, 0, G_OPTION_ARG_NONE, &opt_version, ""Print version information and exit"", NULL },","`/usr/share/pkgconfig/ostree.pc` like `/usr/share/pkgconfig/systemd.pc`? Not a blocker, but I think it provides a natural place to provide info about the CLI. Another alternative is to put it in the `--version` output like `Features`.",c,1,1,1
"@@ -214,6 +214,12 @@ type Table struct {
 	// to top-level chains.
 	insertMode string
 
+	// Record when we did our most recent updates and refreshes of the table.  We use these to
+	// calculate the next time we should force a refresh.
+	lastUpdateTime  time.Time
+	lastRefreshTime time.Time
+	refreshInterval time.Duration
+
 	logCxt *log.Entry
 
 	gaugeNumChains        prometheus.Gauge","Can we rename 'refresh' to 'read' and 'update' to 'write'? Until I had read more of the code below, I couldn't tell the difference between 'update' and 'refresh'.",c,1,1,1
"@@ -84,8 +84,6 @@ void mainloop(struct work_queue *queue, struct link *client)
 		ssize_t read = link_read(client, message, 1, time(NULL) + timeout);
 		while(message[0] != '{') {
 
-			//printf(""server number read: %c\n"", message[0]);
-
 			l[i] = message[0];
 			i++;
 			link_read(client, message, 1, time(NULL) + timeout);",Use `link_readline` here to do what you want.,c,1,1,1
"@@ -862,7 +862,7 @@ static const enum_name_pair_t pt_req_map[] = { { PTRACE_TRACEME, ""PTRACE_TRACEME
 #    endif
                                                { PTRACE_ATTACH, ""PTRACE_ATTACH"" },
                                                { PTRACE_DETACH, ""PTRACE_DETACH"" },
-#    ifndef AARCH64
+#    if defined(PTRACE_GETFPXREGS) && defined(PTRACE_SETFPXREGS)
                                                { PTRACE_GETFPXREGS, ""PTRACE_GETFPXREGS"" },
                                                { PTRACE_SETFPXREGS, ""PTRACE_SETFPXREGS"" },
 #    endif","nit: It seems cleaner to have a separate define check for each of these, rather than bundling them, right?",c,1,1,1
"@@ -71,6 +71,12 @@ static struct st_deferred_request_action_t *create_deferred_action(h2o_req_t *re
     return action;
 }
 
+static void strtolower_cpy(char *d, const char *s, size_t len)
+{
+    for (; len != 0; ++d, ++s, --len)
+        *d = h2o_tolower(*s);
+}
+
 static h2o_hostconf_t *find_hostconf(h2o_hostconf_t **hostconfs, h2o_iovec_t authority, uint16_t default_port,
                                      h2o_iovec_t *wildcard_match)
 {","How about doing the following? * Promote this function to an external function that sits next to `h2o_strtolower`, and maybe name it `h2o_strcopytolower`? * Let `h2o_strtolower` be a wrapper of `h2o_strcopytolower` that accepts the same address for `d` and `s`. The intent here is to avoid having duplicated code while keeping existing API consistent.",c,1,1,1
"@@ -1323,6 +1323,14 @@ os_terminate_with_code(dcontext_t *dcontext, terminate_flags_t flags, int exit_c
     if (TEST(TERMINATE_CLEANUP, flags)) {
         /* we enter from several different places, so rewind until top-level kstat */
         KSTOP_REWIND_UNTIL(thread_measured);
+
+        /* This thread is on its way to exit, we are blocking all signals since any
+         * signal that reaches us now can be delayed until after the exit is complete.
+         * We may still receive a suspend signal for synchronization that we may need
+         * to reply to (i#2921).
+         */
+        block_all_signals_except(NULL, 1, SUSPEND_SIGNAL);
+
         cleanup_and_terminate(dcontext, SYSNUM_EXIT_PROCESS, exit_code, 0,
                               true /*whole process*/, 0, 0);
     } else {","grammar: two separate sentences joined by a comma. Fix by s/, w/. W/ or sthg. Ditto multiple times below.",c,1,1,0
"@@ -336,7 +336,7 @@ static void do_send(struct rp_generator_t *self)
     size_t veccnt;
     h2o_send_state_t ststate;
 
-    assert(self->sending.bytes_inflight == 0);
+    assert(!self->sending.inflight);
 
     vecs[0] = h2o_doublebuffer_prepare(&self->sending,
                                        self->client != NULL ? &self->client->sock->input : &self->last_content_before_send,",How about removing this assertion now that the check is done in `h2o_doublebuffer_prepare`?,c,1,1,1
"@@ -364,6 +364,8 @@ handle_pre_extended_syscall_sigmasks(dcontext_t *dcontext, kernel_sigset_t *sigm
     if (sizemask != sizeof(kernel_sigset_t))
         return false;
     ASSERT(!info->pre_syscall_app_sigprocmask_valid);
+    if (sigmask == NULL)
+        return true;
     info->pre_syscall_app_sigprocmask_valid = true;
     info->pre_syscall_app_sigprocmask = info->app_sigblocked;
     signal_set_mask(dcontext, sigmask);","This leaves `*pending` as uninitialized. With no written contract, this function would be expected to set it when it succeeds.",c,1,1,1
"@@ -116,8 +116,7 @@ func fieldsByName(example interface{}) map[string]reflect.StructField {
 var _ = DescribeTable(""Config parsing"",
         func(key, value string, expected interface{}, errorExpected ...bool) {
                 config := New()
-                config.UpdateFrom(map[string]string{key: value},
-                        EnvironmentVariable)
+                config.UpdateFrom(map[string]string{key: value}, EnvironmentVariable)
                 configPtr := reflect.ValueOf(config)
                 configElem := configPtr.Elem()
                 fieldRef := configElem.FieldByName(key)","Note, another possibly unnecessary change here.",c,1,0,1
"@@ -3432,7 +3432,7 @@ enum xnn_status xnn_initialize(const struct xnn_allocator* allocator) {
     allocator = &xnn_default_allocator;
   }
   #ifdef _MSC_VER
-    _InterlockedCompareExchangePointer(&init_allocator, allocator, NULL);
+    _InterlockedCompareExchangePointer((void* volatile)(&init_allocator), allocator, NULL);
   #else
     __sync_bool_compare_and_swap(&init_allocator, NULL, allocator);
   #endif","Just `(void* volatile) &init_allocator`, no need for extra brackets.",c,1,1,1
"@@ -3719,6 +3719,11 @@ static int check_hand_against_task(struct work_queue *q, struct work_queue_worke
 	if(w->resources->gpus.inuse + limits->gpus > overcommitted_resource_total(q, w->resources->gpus.total, 0)) {
 		ok = 0;
 	}
+		
+	//if the wall time for the worker is specified and there's not enough time for the task, then not ok
+	if(w->resources->time_left != -1 && w->resources->time_left < t->resources_requested->wall_time){
+		ok = 0;
+	}
 
 	rmsummary_delete(limits);
 ","Here we should also check for t->resources_requested->end (if > 0). end is an absolute time, so something like: t->resources->time_left > t->resources_requested->end - timestamp(). or something like that. Also, not all tasks define -> wall_time, so you have to check for wall_time > 0 I would also change time_left != -1 to > 0 for consistency.",c,1,1,1
"@@ -107,7 +107,14 @@ REPLACE_OPTIONS_MAP = {
 
 IGNORED_OPTION_MAP = {
     '-MT': 1,
+    '-MQ': 1,
     '-MF': 1,
+    '-MJ': 1,
+    '-MM': 0,
+    '-MP': 0,
+    '-MD': 0,
+    '-MV': 0,
+    '-MMD': 0,
     '-fsyntax-only': 0,
     '-save-temps': 0,
     '-install_name': 1,",Why do we have both this map and some of these hard coded above?,c,1,1,1
"@@ -31,6 +31,7 @@
  * DAMAGE.
  */
 
+/* Copyright (c) 2019 Google */
 /* Copyright (c) 2003-2007 Determina Corp. */
 /* Copyright (c) 2001-2003 Massachusetts Institute of Technology */
 /* Copyright (c) 2001 Hewlett-Packard Company */",The Google copyright is on line 1.,c,1,1,1
"@@ -180,6 +180,16 @@ struct flb_kafka *flb_kafka_conf_create(struct flb_output_instance *ins,
     if (tmp) {
         ctx->gelf_fields.level_key = flb_sds_create(tmp);
     }
+    /* Config: Time_Key_Format */
+    tmp = flb_output_get_property(""time_key_format"", ins);
+    if(tmp){
+        ctx->time_key_format = flb_strdup(tmp);
+        ctx->time_key_format_len = strlen(tmp);
+    }
+    else {
+       ctx->time_key_format = NULL;
+       ctx->time_key_format_len = 0;
+    }
 
     /* Kafka Producer */
     ctx->producer = rd_kafka_new(RD_KAFKA_PRODUCER, ctx->conf,","at this level I think would be important to do a dummy validation of the given time format in the configuration, like call a static function that does a strftime(3) and check it return value. Otherwise on runtime it might mess up thinks without noticing it.",c,1,1,1
"@@ -734,6 +734,17 @@ write_content_object (OstreeRepo         *self,
     }
   else
     {
+      /* Update size metadata if configured */
+      if (indexable && object_file_type == G_FILE_TYPE_REGULAR)
+        {
+          struct stat stbuf;
+
+          if (!glnx_fstat (tmpf.fd, &stbuf, error))
+            return FALSE;
+
+          repo_store_size_entry (self, actual_checksum, unpacked_size, stbuf.st_size);
+        }
+
       /* This path is for regular files */
       if (!commit_loose_regfile_object (self, actual_checksum, &tmpf,
                                         uid, gid, mode,",Can you elaborate on how this makes a difference? Aren't `phys_object_is_symlink` and `object_file_type == G_FILE_TYPE_REGULAR` already mutually exclusive?,c,1,1,1
"@@ -0,0 +1,14 @@
+int method(void)
+{
+  return 0;
+}
+
+int sub(void)
+{
+  return 0;
+}
+
+int fun(void)
+{
+  return 0;
+}",...becase there is no whitespace after `(void)`.,c,0,0,0
"@@ -64,6 +64,7 @@ static platform_data platform_data_table[] = {
 };
 
 static int initialized;
+static platforms_detected;
 
 static opae_api_adapter_table *adapter_list = (void *)0;
 static pthread_mutex_t adapter_list_lock =",You're thinking this would allow us to have another shot at platform detection if we failed the first time?,c,1,1,1
"@@ -202,8 +202,10 @@ static void on_handshake_complete(h2o_socket_t *sock, const char *err)
 static void on_connect(h2o_socket_t *sock, const char *err)
 {
     if (err != NULL) {
+        char buf[128];
         /* connection failed */
-        fprintf(stderr, ""failed to connect to host:%s\n"", err);
+        fprintf(stderr, ""failed to connect to host:%s:%s\n"", err,
+                h2o_strerror_r(errno, buf, sizeof(buf)));
         h2o_socket_close(sock);
         exit(1);
         return;","I think this change is also not appropriate due to the same reason (i.e., the failure might be due to something other than a syscall, e.g., certificate validation).",c,1,1,1
"@@ -31,8 +31,8 @@ const (
 	ChainFilterForward = ChainNamePrefix + ""-FORWARD""
 	ChainFilterOutput  = ChainNamePrefix + ""-OUTPUT""
 
-	ChainFailsafeIn  = ChainNamePrefix + ""-FAILSAFE-IN""
-	ChainFailsafeOut = ChainNamePrefix + ""-FAILSAFE-OUT""
+	ChainFailsafeIn  = ChainNamePrefix + ""-failsafe-in""
+	ChainFailsafeOut = ChainNamePrefix + ""-failsafe-out""
 
 	ChainNATPrerouting  = ChainNamePrefix + ""-PREROUTING""
 	ChainNATPostrouting = ChainNamePrefix + ""-POSTROUTING""",Upper case is reserved for our versions of top-level chains i.e. the `FORWARD` chain jumps to `cali-FORWARD`.,c,1,1,1
"@@ -410,7 +410,12 @@ drreg_insert_restore_all(void *drcontext, instrlist_t *bb, instr_t *inst,
     uint aflags = (uint)(ptr_uint_t)drvector_get_entry(&pt->aflags.live, pt->live_idx);
     if (!pt->aflags.native &&
         (force_restore ||
-         TESTANY(EFLAGS_READ_ARITH, instr_get_eflags(inst, DR_QUERY_DEFAULT)) ||
+         /* On AArch64, unrecognized instructions are decoded as instances of a generic
+          * instruction, OP_xx. For these instructions conservatively restore aflags in
+          * case they read/write the aflags.
+          */
+         IF_AARCH64(instr_get_opcode(inst) == OP_xx ||)
+             TESTANY(EFLAGS_READ_ARITH, instr_get_eflags(inst, DR_QUERY_DEFAULT)) ||
          /* Writing just a subset needs to combine with the original unwritten */
          (TESTANY(EFLAGS_WRITE_ARITH, instr_get_eflags(inst, DR_QUERY_INCLUDE_ALL)) &&
           aflags != 0 /*0 means everything is dead*/) ||","Given that all of the missing opcodes are vector instructions, I would expect a very small fraction to read or write flags (or GPR's for that matter). I wonder if adding the couple of opcodes that affect flags and GPR's would not be much work. Though it's certainly more work than this workaround. Let's wait for advice from those more familiar with the a64 decoder: @AssadHashmi?",c,0,1,1
"@@ -825,7 +825,7 @@ func (r *RouteTable) fullResyncRoutesForLink(logCxt *log.Entry, ifaceName string
                 logCxt := logCxt.WithField(""dest"", dest)
                 // Check if we should remove routes not added by us
                 if !r.removeExternalRoutes && route.Protocol != r.deviceRouteProtocol {
-                        logCxt.Info(""Syncing routes: not removing route as its not marked as Felix route"")
+                        logCxt.Debug(""Syncing routes: not removing route as its not marked as Felix route"")
                         continue
                 }
 ",Add the missing apostrophe here? (`its` -> `it's`),c,1,0,1
"@@ -170,7 +170,7 @@ const char* cxxDebugScopeDecode(enum CXXScopeType scope)
 		[CXXScopeTypeUnion] = ""union"",
 		[CXXScopeTypeStruct] = ""structg"",
 	};
-	if (sizeof(table) > scope)
+	if (CXXScopeTypeLAST > scope)
 		return table[scope];
 	else
 		return NULL;",could also have been `ARRAY_SIZE(table) > scope`,c,1,1,1
"@@ -226,7 +226,7 @@ void ValidationStateTracker::PreCallRecordCmdClearColorImage(VkCommandBuffer com
                                                              uint32_t rangeCount, const VkImageSubresourceRange *pRanges) {
     if (disabled[command_buffer_state]) return;
 
-    auto cb_node = Get<CMD_BUFFER_STATE>(commandBuffer);
+    auto cb_node = GetWrite<CMD_BUFFER_STATE>(commandBuffer);
     if (cb_node) {
         cb_node->RecordTransferCmd(CMD_CLEARCOLORIMAGE, Get<IMAGE_STATE>(image));
     }",All get writes this file. Same split lock concern.,cpp,0,0,0
"@@ -83,6 +83,12 @@ MSG(object_does_not_provide_read_access_to_columns,
 MSG(object_does_not_provide_write_access_to_columns,
     ""Given object does not provide write access to columns"")
 MSG(unsupported_conversion_types, ""Unsupported conversion types"")
+MSG(row_indices_lt_min_value, ""Row indices are less than minimum acceptable value"")
+MSG(row_indices_gt_max_value, ""Row indices are larger than maximum acceptable value"")
+MSG(column_indices_lt_min_value, ""Column indices are less than minimum acceptable value"")
+MSG(column_indices_gt_max_value, ""Column indices are larger than maximum acceptable value"")
+MSG(zero_based_indexing_is_not_supported, ""Zero based indexing is not supported for csr table"")
+MSG(object_does_not_provide_read_access_to_csr, ""Given object does not provide read access to csr"")
 
 /* Ranges */
 MSG(invalid_range_of_rows, ""Invalid range of rows"")",.. read access in csr format ?,cpp,1,0,0
"@@ -17,6 +17,14 @@
 
 #include <adios2.h>
 
+#define str_helper(X) #X
+#define str(X) str_helper(X)
+
+#ifndef DEFAULT_CONFIG
+#define DEFAULT_CONFIG helloBPWriter.xml
+#endif
+#define DEFAULT_CONFIG_STR str(DEFAULT_CONFIG)
+
 int main(int argc, char *argv[])
 {
     MPI_Init(&argc, &argv);","if( rank == 0 ) { std::cout << ""Using config file: "" << configFile << std::endl; }",cpp,1,1,0
"@@ -2789,7 +2789,7 @@ void tm_process_msg(BMS_SRE *pp_sre)
 {
     short                  lv_ret;
     char                   la_send_buffer[4096];
-    char                   la_recv_buffer[sizeof(Tm_Req_Msg_Type)];
+    char                   la_recv_buffer[pp_sre->sre_reqDataSize];
     char                  *la_recv_buffer_ddl = NULL;
     Tm_Broadcast_Req_Type *lp_br_req;
     Tm_Broadcast_Rsp_Type *lp_br_rsp; ","It is not obvious to me why this change solves the problem. For example, at line 2808 below, we check pp_src->src_reqDataSize to see if it is too big to fit in la_recv_buffer, and if so, we dynamically allocate a buffer la_recv_buffer_ddl for it. It looks like the remaining code in the method makes assumptions that certain message types are always shorter than sizeof(Tm_Req_Msg_Type) though; but then the logic would read the message into the wrong buffer and it would fail in some other way. Could you provide an explanation of why it solves the problem? Also, I'm wondering if we could get rid of dynamically allocating la_recv_buffer_ddl and just use la_recv_buffer, by using dynamic array sizing as you have done here. That would simplify the logic and reduce heap pressure. @zcorrea, what do you think?",cpp,0,1,0
"@@ -3176,8 +3176,8 @@ void WorldServer::UpdateLFP(uint32 LeaderID, GroupLFPMemberEntry *LFPMembers) {
 
 void WorldServer::StopLFP(uint32 LeaderID) {
 
-	GroupLFPMemberEntry LFPMembers;
-	UpdateLFP(LeaderID, LFPOff, 0, 0, 0, 0, """", &LFPMembers);
+	GroupLFPMemberEntry LFPMembers[MAX_GROUP_MEMBERS];
+	UpdateLFP(LeaderID, LFPOff, 0, 0, 0, 0, """", LFPMembers);
 }
 
 void WorldServer::HandleLFGMatches(ServerPacket *pack) {",There a reason we're no longer passing by reference here ?,cpp,1,0,0
"@@ -46,6 +46,8 @@
 
 #include <Kokkos_Core.hpp>
 
+// FIXME_SYCL requires allocate_tracked
+#ifndef KOKKOS_ENABLE_SYCL
 #if !defined(KOKKOS_ENABLE_CUDA) || defined(__CUDACC__)
 
 #include <default/TestDefaultDeviceType_Category.hpp>",Does `malloc` test not pass?,cpp,0,0,0
"@@ -3635,6 +3635,8 @@ static PropertyDefinition g_properties[] = {
     {""swift-module-search-paths"", OptionValue::eTypeFileSpecList, false, 0,
      nullptr, nullptr,
      ""List of directories to be searched when locating modules for Swift.""},
+    {""swift-create-module-contexts-in-parallel"", OptionValue::eTypeBoolean, false, true,
+     nullptr, nullptr, ""Create modules AST context in parallel.""},
     {""auto-import-clang-modules"", OptionValue::eTypeBoolean, false, true,
      nullptr, nullptr,
      ""Automatically load Clang modules referred to by the program.""},",`Create the per-module Swift AST contexts in parallel.` ?,cpp,1,0,0
"@@ -981,7 +981,7 @@ void DatasetLoader::ConstructBinMappersFromTextData(int rank, int num_machines,
         bin_type = BinType::CategoricalBin;
       }
       bin_mappers[i].reset(new BinMapper());
-      if (sample_values.size() <= start[rank] + i) {
+      if (static_cast<int>(sample_values.size()) <= start[rank] + i) {
         continue;
       }
       if (config_.max_bin_by_feature.empty()) {",thanks! Was seeing this warning too last night,cpp,1,0,0
"@@ -102,7 +102,7 @@ Point2D bondInsideRing(const ROMol &mol, const Bond &bond, const Point2D &cds1,
     Atom *bgn_atom = bond->getBeginAtom();
     for (const auto &nbri2 : make_iterator_range(mol.getAtomBonds(bgn_atom))) {
       const Bond *bond2 = mol[nbri2];
-      if (bond2 == bond) {
+      if (bond2->getIdx() == bond->getIdx()) {
         continue;
       }
       if (find(ring.begin(), ring.end(), bond2->getIdx()) != ring.end()) {",oh is that embarrassing,cpp,0,0,0
"@@ -886,6 +886,11 @@ void declare_optimization_goal(const size_t context,
 #include <cstring>
 
 namespace Kokkos {
+
+namespace Profiling {
+bool profileLibraryLoaded() { return false; }
+}  // namespace Profiling
+
 namespace Tools {
 
 bool profileLibraryLoaded() { return false; }","```diff diff --git a/core/src/impl/Kokkos_Profiling.cpp b/core/src/impl/Kokkos_Profiling.cpp index 3e593c5..387b83e 100644 --- a/core/src/impl/Kokkos_Profiling.cpp +++ b/core/src/impl/Kokkos_Profiling.cpp @@ -889,7 +889,7 @@ namespace Kokkos { namespace Profiling { bool profileLibraryLoaded() { return false; } -} +} // namespace Profiling namespace Tools {",cpp,0,0,0
"@@ -9,6 +9,7 @@
 #include ""meta/processors/ListHostsProcessor.h""
 #include ""meta/processors/ListSpacesProcessor.h""
 #include ""meta/processors/GetPartsAllocProcessor.h""
+#include <meta/processors/AuthenticationProcessor.h>
 
 #define RETURN_FUTURE(processor) \
     auto f = processor->getFuture(); \",Please do not use **<>** for our own header files,cpp,1,1,1
"@@ -3472,9 +3472,16 @@ bool SwiftASTContext::LoadOneImage(Process &process, FileSpec &link_lib_spec,
 
 static std::vector<std::string>
 GetLibrarySearchPaths(const swift::SearchPathOptions &search_path_opts) {
-  std::vector<std::string> paths(search_path_opts.LibrarySearchPaths.begin(),
-                                 search_path_opts.LibrarySearchPaths.end());
+  // The order in which we look up the libraries is important. The REPL
+  // dlopen()s libswiftCore, and gives precedence to the just built standard
+  // library instead of the one in the OS. When we type `import Foundation`,
+  // we want to make sure we end up loading the correct library, i.e. the
+  // one sitting next to the stdlib we just built, and then fall back to the
+  // one in the OS if that's not available.
+  std::vector<std::string> paths;
   paths.push_back(search_path_opts.RuntimeLibraryPath);
+  for (std::string path : search_path_opts.LibrarySearchPaths)
+    paths.push_back(path);
   return paths;
 }
 ",(Nit) We might want to reserve the vector.,cpp,1,1,1
"@@ -8,14 +8,17 @@
 #  which is included in the file license.txt, found at the root
 #  of the RDKit source tree.
 #
+from rdkit.TestRunner import redirect_stdout
+from rdkit.six import StringIO
 """"""unit testing code for the signatures
 
 """"""
-import unittest
 import os.path
+import unittest
+
+from rdkit import Chem
 from rdkit import RDConfig
 from rdkit.Chem import ChemicalFeatures
-from rdkit import Chem
 from rdkit.Chem.Pharm2D import Generate, SigFactory, Matcher, Gobbi_Pharm2D
 
 ","These should not be over the doctstring for the file. Given that this particular docstring (the one starting on l13) is useless, it makes sense to just remove that.",cpp,1,1,1
"@@ -5357,7 +5357,8 @@ TEST_F(VkLayerTest, CreatePipelineExceedMaxComponentsBlocks) {
 
     // 1 for maxVertexOutputComponents and 1 for maxFragmentInputComponents
     CreatePipelineHelper::OneshotTest(*this, set_info, kErrorBit,
-                                      vector<string>{""VUID-RuntimeSpirv-Location-06272"", ""VUID-RuntimeSpirv-Location-06272""});
+                                      vector<string>{""VUID-RuntimeSpirv-Location-06272"", ""VUID-RuntimeSpirv-Location-06272"",
+                                                     ""VUID-RuntimeSpirv-Location-06272"", ""VUID-RuntimeSpirv-Location-06272""});
 }
 
 TEST_F(VkLayerTest, CreatePipelineExceedMaxTessellationControlInputOutputComponents) {","Maybe this is obvious, but why did this effect this test?",cpp,1,1,1
"@@ -848,13 +848,12 @@ class Dataset(object):
             self.set_weight(weight)
         if group is not None:
             self.set_group(group)
-        # load init score
-        if init_score is not None:
-            self.set_init_score(init_score)
-            if predictor is not None:
-                warnings.warn(""The prediction of init_model will be overridden by init_score."")
-        elif isinstance(predictor, _InnerPredictor):
+        if isinstance(predictor, _InnerPredictor):
+            if self._predictor is None and init_score is not None:
+                warnings.warn(""The init_score will be overridden by the prediction of init_model."")
             self._set_init_score_by_predictor(predictor, data)
+        elif init_score is not None:
+            self.set_init_score(init_score)
         elif predictor is not None:
             raise TypeError('Wrong predictor type {}'.format(type(predictor).__name__))
         # set feature names",Can you please clarify `if self._predictor is None` check?,cpp,1,1,1
"@@ -1074,7 +1074,7 @@ int main(int argc, char **argv) {
 #ifdef CURL_ENABLED
             if (proj_context_is_network_enabled(nullptr)) {
                 std::cout << ""Status: enabled"" << std::endl;
-                std::cout << ""URL: "" << pj_context_get_url_endpoint(nullptr)
+                std::cout << ""URL: "" << std::string(proj_context_get_url_endpoint(nullptr))
                           << std::endl;
             } else {
                 std::cout << ""Status: disabled"" << std::endl;",this shouldn't be needed. The << operator will be happy with a const char*,cpp,1,1,1
"@@ -330,7 +330,8 @@ class LGBMModel(_LGBMModelBase):
             sample_weight=None, init_score=None, group=None,
             eval_set=None, eval_names=None, eval_sample_weight=None,
             eval_class_weight=None, eval_init_score=None, eval_group=None,
-            eval_metric=None, early_stopping_rounds=None, verbose=True,
+            eval_metric=None, eval_train_metric=None, eval_valid_metric=None,
+            early_stopping_rounds=None, verbose=True,
             feature_name='auto', categorical_feature='auto', callbacks=None):
         """"""Build a gradient boosting model from the training set (X, y).
 ",I don't think that these new args are really needed. One can achieve the needed result in their rare case with `params`.,cpp,1,1,1
"@@ -43,6 +43,7 @@ DesktopSwitchConfiguration::DesktopSwitchConfiguration(PluginSettings *settings,
 
     connect(ui->rowsSB, SIGNAL(valueChanged(int)), this, SLOT(rowsChanged(int)));
     connect(ui->labelTypeCB, SIGNAL(currentIndexChanged(int)), this, SLOT(labelTypeChanged(int)));
+    connect(ui->showOnlyActiveCB, &QAbstractButton::toggled, [this] (bool checked) { this->settings().setValue(""showOnlyActive"", checked); });
 
     loadDesktopsNames();
 }",Implicit string cast,cpp,1,0,1
"@@ -397,9 +397,6 @@ class LGBMModel(_LGBMModelBase):
             self._fobj = None
         evals_result = {}
         params = self.get_params()
-        # sklearn interface has another naming convention
-        params.setdefault('seed', params.pop('random_state'))
-        params.setdefault('nthread', params.pop('n_jobs'))
         # user can set verbose with kwargs, it has higher priority
         if 'verbose' not in params and self.silent:
             params['verbose'] = 0",Lets move these names to aliases at C++ side,cpp,1,1,1
"@@ -148,6 +148,16 @@ CONSTEXPR uint32_t info_dst_message_length = 16;
 CONSTEXPR uint32_t info_ts_message_length = 12;
 CONSTEXPR uint32_t data_frag_submessage_header_length = 36;
 
+uint32_t RTPSWriter::get_max_fragment_payload_size()
+{
+    constexpr uint32_t data_frag_header_size = 28;
+    constexpr uint32_t max_inline_qos_size = 32;
+    // Max fragment is 64KBytes_max - header - inlineqos - 4(for better alignment)
+    constexpr uint32_t max_fragment_size = std::numeric_limits<uint16_t>::max() - data_frag_header_size - max_inline_qos_size - 4;
+    
+    return max_fragment_size;
+}
+
 uint32_t RTPSWriter::getMaxDataSize()
 {
     return calculateMaxDataSize(mp_RTPSParticipant->getMaxMessageSize());",Move this method to the header file and make it an inline constexpr one.,cpp,1,1,1
"@@ -64,7 +64,11 @@ ExtractorOptions::ParseArguments(int argc, char *argv[], ExtractorConfig &extrac
         ""Number of threads to use"")(
             ""generate-edge-lookup"",boost::program_options::value<bool>(
                                                 &extractor_config.generate_edge_lookup)->implicit_value(true)->default_value(false),
-                                 ""Generate a lookup table for internal edge-expanded-edge IDs to OSM node pairs"");
+                                 ""Generate a lookup table for internal edge-expanded-edge IDs to OSM node pairs"")(
+        ""small-component-size"",
+        boost::program_options::value<unsigned int>(&extractor_config.small_component_size)
+            ->default_value(1000),
+        ""Number of nodes required before a strongly-connected-componennt is considered big (affects nearest neighbor snapping)"");
 
 #ifdef DEBUG_GEOMETRY
         config_options.add_options()(""debug-turns"",","Cool.. but how does it affect the snapping? From the description I can not see how it would affect snapping if I increase the size, and how it affects the snapping if I decrease the size. I think we can be more user-friendly here --- in the end it's not just us who wants to use this.",cpp,1,1,0
"@@ -29,7 +29,11 @@ Status ExecutionEngine::init(std::shared_ptr<folly::IOThreadPoolExecutor> ioExec
         return addrs.status();
     }
     metaClient_ = std::make_unique<meta::MetaClient>(ioExecutor, std::move(addrs.value()));
-    metaClient_->init();
+    // load data try 3 time
+    bool loadDataOk = metaClient_->waitForMetadReady(3);
+    if (!loadDataOk) {
+        LOG(ERROR) << ""ExecutionEngine::init loadData by thread error!"";
+    }
 
     schemaManager_ = meta::SchemaManager::create();
     schemaManager_->init(metaClient_.get());","storaged return failed when load meta data failed, but why here not?",cpp,1,1,1
"@@ -179,6 +179,14 @@ Client::Client(EQStreamInterface* ieqs)
         for (int client_filter = 0; client_filter < _FilterCount; client_filter++)
                 ClientFilters[client_filter] = FilterShow;
 
+        m_TimeSinceLastPositionCheck = 0;
+        m_DistanceSinceLastPositionCheck = 0.0f;
+        m_ShadowStepExemption = 0;
+        m_KnockBackExemption = 0;
+        m_PortExemption = 0;
+        m_SenseExemption = 0;
+        m_AssistExemption = 0;
+        m_CheatDetectMoved = false;
         mMovementManager->AddClient(this);
         character_id = 0;
         conn_state = NoPacketsReceived;","I know the source is inconsistent but I believe the effort is to have variable names snake case where possible for these, like `m_distance_since_last_position_check`, `m_cheat_detect_moved`, etc",cpp,1,1,1
"@@ -2277,7 +2277,7 @@ TEST_F(VkLayerTest, GpuValidationArrayOOB) {
 
     VkDescriptorImageInfo image_info[6] = {};
     for (int i = 0; i < 6; i++) {
-        image_info[i] = texture.m_imageInfo;
+        image_info[i] = texture.DescriptorImageInfo();
         image_info[i].sampler = sampler.handle();
         image_info[i].imageLayout = VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL;
     }","this is part of the framework cleanup for correct image layout tracking. The former code had a ""man with two watches"" problem. It tracked to different DescriptorImageInfo structs, partially updating each (and thus making part of each stale)",cpp,1,1,1
"@@ -46,7 +46,7 @@ void CleanTCPSocketsEvent::event(EventCode code, const char* /*msg*/)
 {
     if(code == EVENT_SUCCESS)
     {
-        mp_transport->clean_deleted_sockets();
+        //mp_transport->clean_deleted_sockets();
     }
 }
 ","So... the whole class isn't necessary, didn't?",cpp,1,0,1
"@@ -1516,6 +1516,10 @@ void LuaScriptInterface::registerFunctions()
 	registerEnum(ITEM_ATTRIBUTE_CHARGES)
 	registerEnum(ITEM_ATTRIBUTE_FLUIDTYPE)
 	registerEnum(ITEM_ATTRIBUTE_DOORID)
+	registerEnum(ITEM_ATTRIBUTE_DECAYTO)
+	registerEnum(ITEM_ATTRIBUTE_WRAPID)
+	registerEnum(ITEM_ATTRIBUTE_STOREITEM)
+	registerEnum(ITEM_ATTRIBUTE_ATTACK_SPEED)
 
 	registerEnum(ITEM_TYPE_DEPOT)
 	registerEnum(ITEM_TYPE_MAILBOX)",doesn't these belong to the attr PR?,cpp,0,0,1
"@@ -1971,6 +1971,17 @@ StmtDDLAlterTableAddColumn::synthesize()
     theColumn->traverseList(
          this,
          StmtDDLAlterTableAddColumn_visit);
+
+    ElemDDLColDefArray ColDefArray = getColDefArray();
+    ElemDDLColDef *pColDef = ColDefArray[0];
+    if (NOT pColDef->getColumnFamily().isNull())
+      {
+        //TEMPTEMP 
+        // Currently, DTM doesnt handle add columns with an explicit 
+        // column family as a transactional operation.
+        // Do not use ddl xns until that bug is fixed.
+        setDdlXns(FALSE);
+      }
   }
 }  //StmtDDLAlterTableAddColumn::synthesize()
 ",How about ALTER TABLE/INDEX ALTER HBASE_OPTIONS? Does it work transactionally? (I'm not sure that code was completed.),cpp,1,1,1
"@@ -39,17 +39,9 @@ kvstore::ResultCode QueryEdgePropsProcessor::collectEdgesProps(
     return ret;
 }
 
-void QueryEdgePropsProcessor::addDefaultProps() {
-    this->edgeContext_.props_.emplace_back(""_src"", 0, PropContext::PropInKeyType::SRC);
-    this->edgeContext_.props_.emplace_back(""_rank"", 1, PropContext::PropInKeyType::RANK);
-    this->edgeContext_.props_.emplace_back(""_dst"", 2, PropContext::PropInKeyType::DST);
-}
-
 void QueryEdgePropsProcessor::process(const cpp2::EdgePropRequest& req) {
     spaceId_ = req.get_space_id();
-    // By default, _src, _rank, _dst will be returned as the first 3 fields
-    addDefaultProps();
-    int32_t returnColumnsNum = req.get_return_columns().size() + this->edgeContext_.props_.size();
+    //    initContext(req.edge_types, true);
     auto retCode = this->checkAndBuildContexts(req);
     if (retCode != cpp2::ErrorCode::SUCCEEDED) {
         for (auto& p : req.get_parts()) {",Why remove the default props?,cpp,1,0,1
"@@ -111,7 +111,7 @@ bool save_model::do_save_model_weights(model *m) {
 
   // Shared checkpoint, logic identical to Distributed.i
   makedir(m_dir.c_str());
-  std::string epochdir = get_shared_checkpoint_dirname(m, m_dir.c_str(), c.get_execution_mode(), epoch, step);
+  std::string epochdir = get_shared_checkpoint_dirname(c.get_trainer().get_name(), m, m_dir.c_str(), c.get_execution_mode(), epoch, step);
   if (comm->am_trainer_master()) {
     p.open_checkpoint(epochdir.c_str());
   }",See. You got the trainer's name through a model pointer...,cpp,1,0,1
"@@ -2892,7 +2892,8 @@ short ExpGenerator::generateKeyEncodeExpr(const IndexDesc * indexDesc,
       if (handleSerialization)
 	{
 	  NAColumn * nac = indexDesc->getNAFileSet()->getIndexKeyColumns()[i];
-	  if (CmpSeabaseDDL::isEncodingNeededForSerialization(nac))
+          NABoolean isAlignedRowFormat = indexDesc->getNAFileSet()->isSqlmxAlignedRowFormat();
+	  if ((!isAlignedRowFormat) && CmpSeabaseDDL::isEncodingNeededForSerialization(nac))
 	    {
 	      if (desc_flag)
 		{","Since the NAColumn object has a data member describing its serialization state, why do we ned the additional check of !isAlignedFormat here? For example t1.b is serialized bit the correspond column in the index t1_ix1.b is part of an aligned row and therefor not serailized. I would have expected CmpSeabaseDDL::isEncodingNeededForSerialization(nac) to return FALSE for t1_ix1.b since you havetaken care to set up two different NAColumn objects for the table and index.",cpp,1,1,0
"@@ -118,16 +118,13 @@ namespace RDKit{
       }
     }
 
-    void iterateCIPRanks(const ROMol &mol, DOUBLE_VECT &invars, UINT_VECT &ranks,bool seedWithInvars){
+    void iterateCIPRanks(const ROMol &mol, DOUBLE_VECT &invars,
+                         UINT_VECT &ranks,bool seedWithInvars){
       PRECONDITION(invars.size()==mol.getNumAtoms(),""bad invars size"");
       PRECONDITION(ranks.size()>=mol.getNumAtoms(),""bad ranks size"");
 
       unsigned int numAtoms = mol.getNumAtoms();
       CIP_ENTRY_VECT cipEntries(numAtoms);
-      INT_LIST allIndices;
-      for(unsigned int i=0;i<numAtoms;++i){
-        allIndices.push_back(i);
-      }
 #ifdef VERBOSE_CANON
       BOOST_LOG(rdDebugLog) << ""invariants:"" << std::endl;
       for(unsigned int i=0;i<numAtoms;i++){","Though the changes in this function seem to make sense after a brief review, I don't think they are connected to the const std::string fix that's the actual purpose of the PR.",cpp,0,1,1
"@@ -55,9 +55,10 @@ struct LocalFile : VirtualFileReader, VirtualFileWriter {
 };
 
 const char* kHdfsProto = ""hdfs://"";
-const size_t kHdfsProtoLength = strlen(kHdfsProto);
 
 #ifdef USE_HDFS
+const size_t kHdfsProtoLength = strlen(kHdfsProto);
+
 struct HDFSFile : VirtualFileReader, VirtualFileWriter {
   HDFSFile(const std::string& filename, int flags) : filename_(filename), flags_(flags) {}
   ~HDFSFile() {",maybe `const size_t kHdfsProtoLength = static_cast<size_t>(strlen(kHdfsProto));` ?,cpp,1,1,1
"@@ -134,6 +134,17 @@ void LmJavaOptions::addOptions(const char *options,
   NADELETEBASIC(copy, collHeap());
 }
 
+CollIndex LmJavaOptions::findByPrefix(const char *prefix) const
+{
+  size_t prefixLen = strlen(prefix);
+
+  for (CollIndex i=0; i<options_.entries(); i++)
+    if (strncmp(options_[i], prefix, prefixLen) == 0)
+      return i;
+
+  return NULL_COLL_INDEX;
+}
+
 void LmJavaOptions::addSystemProperty(const char *name,
                                       const char *value)
 {",Is it possible for one prefix to be a subset of another? Just making up a possible example: -Xms vs. -Xms2? Would this code behave correctly then?,cpp,1,1,1
"@@ -63,7 +63,7 @@ void P016_data_struct::ExecuteCode(uint32_t  Code) {
   uint32_t _now = millis();
   if (iLastCmd == Code) {
     // same code as before
-    if (iCmdInhibitTime > (int32_t)(_now - iLastCmdTime)) {
+    if (iCmdInhibitTime > static_cast<uint32_t>(_now - iLastCmdTime)) {
       // inhibit time not ellapsed
       return;
     }",Why not using the `timePassedSince` function here? This is very tricky what you're doing here.,cpp,1,1,1
"@@ -387,6 +387,7 @@ int command_init(void)
                 command_add(""unscribespells"", ""- Clear out your or your player target's spell book."", AccountStatus::GMCoder, command_unscribespells) ||
                 command_add(""untraindisc"", ""[spellid] - Untrain specified discipline from your target."", AccountStatus::GMCoder, command_untraindisc) ||
                 command_add(""untraindiscs"", ""- Untrains all disciplines from your target."", AccountStatus::GMCoder, command_untraindiscs) ||
+                command_add(""updatechecksum"", ""gm only"", AccountStatus::GMImpossible, command_updatechecksum) ||
                 command_add(""uptime"", ""[zone server id] - Get uptime of worldserver, or zone server if argument provided"", AccountStatus::Steward, command_uptime) ||
                 command_add(""version"", ""- Display current version of EQEmu server"", AccountStatus::Player, command_version) ||
                 command_add(""viewcurrencies"", ""- View your or your target's currencies"", AccountStatus::GMAdmin, command_viewcurrencies) ||",Could use a bit more verbosity here on the command note.,cpp,1,1,1
"@@ -1246,7 +1246,7 @@ nano::error nano::telemetry_data::serialize_json (nano::jsonconfig & json, bool
 	json.put (""block_count"", block_count);
 	json.put (""cemented_count"", cemented_count);
 	json.put (""unchecked_count"", unchecked_count);
-	json.put (""account_count"", account_count);
+	json.put (""count"", account_count);
 	json.put (""bandwidth_cap"", bandwidth_cap);
 	json.put (""peer_count"", peer_count);
 	json.put (""protocol_version"", protocol_version);","ops, this wasn't supposed to be changed. I'll fix.",cpp,1,0,1
"@@ -13,11 +13,15 @@ PartsMap MemPartManager::parts(const HostAddr& hostAddr) {
     return partsMap_;
 }
 
-PartMeta MemPartManager::partMeta(GraphSpaceID spaceId, PartitionID partId) {
+StatusOr<PartMeta> MemPartManager::partMeta(GraphSpaceID spaceId, PartitionID partId) {
     auto it = partsMap_.find(spaceId);
-    CHECK(it != partsMap_.end());
+    if (it == partsMap_.end()) {
+        return Status::Error(""Space not found"");
+    }
     auto partIt = it->second.find(partId);
-    CHECK(partIt != it->second.end());
+    if (partIt == it->second.end()) {
+        return Status::Error(""Part not found in MemPartManager, id was %d"", partId);
+    }
     return partIt->second;
 }
 ",error msg can include the spaceId and partId,cpp,1,1,1
"@@ -18,7 +18,7 @@ thread ([this]() {
 
 void nano::vote_processor::process_loop ()
 {
-        nano::timer<std::chrono::milliseconds> elapsed;
+        nano::timer<std::chrono::milliseconds> elapsed (nano::timer_state::stopped);
         bool log_this_iteration;
 
         nano::unique_lock<std::mutex> lock (mutex);",A nano timer is initially stopped so passing the stopped state shouldn't be necessary. Otherwise LGTM.,cpp,1,1,1
"@@ -1,6 +1,7 @@
 // unit tests creating LAMMPS instances via the library interface
 
 #include ""lammps.h""
+#define LAMMPS_LIB_MPI 1
 #include ""library.h""
 #include <cstdio> // for stdin, stdout
 #include <mpi.h>",Should this be here?,cpp,1,0,1
"@@ -3268,8 +3268,9 @@ bool ValidateMapImageLayouts(core_validation::layer_data *device_data, VkDevice
 
 // Helper function to validate correct usage bits set for buffers or images. Verify that (actual & desired) flags != 0 or, if strict
 // is true, verify that (actual & desired) flags == desired
-static bool validate_usage_flags(layer_data *device_data, VkFlags actual, VkFlags desired, VkBool32 strict, uint64_t obj_handle,
-                                 VulkanObjectType obj_type, std::string msgCode, char const *func_name, char const *usage_str) {
+static bool validate_usage_flags(const layer_data *device_data, VkFlags actual, VkFlags desired, VkBool32 strict,
+                                 uint64_t obj_handle, VulkanObjectType obj_type, std::string msgCode, char const *func_name,
+                                 char const *usage_str) {
     const debug_report_data *report_data = core_validation::GetReportData(device_data);
 
     bool correct_usage = false;","Not required for this pull, thoughts about string passing... We shouldn't be passing strings by value (in general), but by const reference, or if all callers invoke by string literal, by const char * . If there is a mix (literal and string callers), then caller side construction (in the case of 1-2 literal invocations) or overloaded const char * wrapper function (in the case of many literal invocations).",cpp,0,1,1
"@@ -305,7 +305,14 @@ void nano::bootstrap_server::receive_bulk_pull_action (boost::system::error_code
 		{
 			if (node->config.logging.bulk_pull_logging ())
 			{
-				node->logger.try_log (boost::str (boost::format (""Received bulk pull for %1% down to %2%, maximum of %3%"") % request->start.to_string () % request->end.to_string () % (request->count ? request->count : std::numeric_limits<double>::infinity ())));
+				if (!request->start.is_zero ())
+				{
+					node->logger.try_log (boost::str (boost::format (""Received bulk pull for %1% down to %2%, maximum of %3%"") % request->start.to_string () % request->end.to_string () % (request->count ? request->count : std::numeric_limits<double>::infinity ())));
+				}
+				else
+				{
+					node->logger.try_log (boost::str (boost::format (""Received bulk pull for %1% down to %2%, maximum of %3% from %4%"") % request->start.to_string () % request->end.to_string () % (request->count ? request->count : std::numeric_limits<double>::infinity ()) % remote_endpoint));
+				}
 			}
 			if (is_bootstrap_connection () && !node->flags.disable_bootstrap_bulk_pull_server)
 			{","These clauses are almost identical, can we just always log the remote endpoint?",cpp,1,1,1
"@@ -284,6 +284,8 @@ void finalize_internal( const bool all_spaces = false )
       Kokkos::Cuda::impl_finalize();
 #endif
   }
+#else
+  (void)all_spaces;
 #endif
 
 #if defined( KOKKOS_ENABLE_ROCM )","Casting to void sometimes helps, but not always.",cpp,1,1,1
"@@ -47,6 +47,10 @@ void UpdateEdgeProcessor::onProcessFinished(int32_t retNum) {
             return it->second;
         };
         for (auto& exp : returnColumnsExp_) {
+            if (!exp->prepare().ok()) {
+                LOG(ERROR) << ""Expression::prepare failed"";
+                return;
+            }
             auto value = exp->eval(getters);
             if (!value.ok()) {
                 LOG(ERROR) << value.status();",The check here should be redundant because `UpdateEdgeProcessor::checkAndBuildContexts` has already processed.,cpp,1,1,1
"@@ -15,6 +15,7 @@
 // converted to color.
 
 #include <glog/logging.h>
+#include <gflags/gflags.h>
 #include <leveldb/db.h>
 #include <leveldb/write_batch.h>
 #include <lmdb.h>",Consider moving this up above glog.,cpp,1,1,1
"@@ -55,6 +55,12 @@ folly::StringPiece LogStrListIterator::logMsg() const {
     return logEntries_.at(idx_).get_log_str();
 }
 
+LogEntry LogStrListIterator::logEntry() {
+    DCHECK(valid());
+    return {firstLogId_ + idx_, term_, logEntries_.at(idx_).get_cluster(),
+            logEntries_.at(idx_).get_log_str()};
+}
+
 }  // namespace raftex
 }  // namespace nebula
 ","I strongly suggest to explicitly construct the tuple, like `return LogEntry(...)`. Actually, using it this way is not standardized until C++17, although the compilers of latest versions(at least not in GCC 5.2) already have supported it.",cpp,1,1,1
"@@ -41,7 +41,7 @@ bool Scripts::loadScripts(std::string folderName, bool isLib, bool reload)
 {
 	namespace fs = boost::filesystem;
 
-	const auto dir = fs::current_path() / ""data"" / folderName;
+	const auto dir = fs::current_path() / g_config.getString(ConfigManager::DATA_DIRECTORY) / folderName;
 	if(!fs::exists(dir) || !fs::is_directory(dir)) {
 		std::cout << ""[Warning - Scripts::loadScripts] Can not load folder '"" << folderName << ""'."" << std::endl;
 		return false;","You can now change this to be `std::filesystem`, we used `boost` because C++11 didn't have `filesystem` but C++17 has.",cpp,1,1,1
"@@ -2200,6 +2200,12 @@ TEST_F(VkLayerTest, GpuValidationArrayOOB) {
         printf(""%s GPU-Assisted validation test requires a driver that can draw.\n"", kSkipPrefix);
         return;
     }
+#if defined(ANDROID)
+    if (instance() == VK_NULL_HANDLE) {
+        printf(""%s Skipping test on Android temporarily while debugging test execution failure.\n"", kSkipPrefix);
+        return;
+    }
+#endif
     VkValidationFeatureEnableEXT enables[] = {VK_VALIDATION_FEATURE_ENABLE_GPU_ASSISTED_EXT};
     VkValidationFeaturesEXT features = {};
     features.sType = VK_STRUCTURE_TYPE_VALIDATION_FEATURES_EXT;","This test looks odd, but I wanted an ""always true"" test here so that the compiler would not complain about unreachable code after the return.",cpp,1,1,1
"@@ -339,7 +339,8 @@ EvalType evaluate(model& m, const std::string& metric_name) {
   m.make_data_store_preloaded(execution_mode::validation);
 
   // Clean up and return metric value
-  c.set_execution_mode(original_mode);
+  m.reset_mode(c, original_mode);
+  c.get_trainer().get_data_coordinator().reset_mode(c);
   return metric_value;
 
 }",This should be correct and we do not want to change the execution mode of the execution context as was being done in the previous code.,cpp,1,1,1
"@@ -416,6 +416,7 @@ void fence_internal() {
     Kokkos::Serial::impl_static_fence();
   }
 #endif
+  memory_fence();
 }
 
 bool check_arg(char const* arg, char const* expected) {","This feels like it's almost certainly superfluous. In what backend does `fence()` not imply `memory_fence()` already? IIUC, the end of a OpenMP section implies a memory fence, and the threads backend already has one. I can't imagine that the Cuda, ROCm, or HPX join mechanisms do some sort of voodoo that I'm unaware of to perform an execution fence without implying a memory fence. I'm additionally wary of adding this because compilers can't remove redundant memory fences (because of the nature of fences), and AFAICT this is redundant in every case, so it's strictly overhead.",cpp,1,1,0
"@@ -57,12 +57,10 @@ int Tree::Split(int leaf, int feature, int real_feature, uint32_t threshold_bin,
   decision_type_[new_node_idx] = 0;
   SetDecisionType(&decision_type_[new_node_idx], false, kCategoricalMask);
   SetDecisionType(&decision_type_[new_node_idx], default_left, kDefaultLeftMask);
-  if (missing_type == MissingType::None) {
-    SetMissingType(&decision_type_[new_node_idx], 0);
-  } else if (missing_type == MissingType::Zero) {
-    SetMissingType(&decision_type_[new_node_idx], 1);
-  } else if (missing_type == MissingType::NaN) {
-    SetMissingType(&decision_type_[new_node_idx], 2);
+  if (missing_type == MissingType::None
+      || missing_type == MissingType::Zero
+      || missing_type == MissingType::NaN) {
+    SetMissingType(&decision_type_[new_node_idx], missing_type);
   }
   threshold_in_bin_[new_node_idx] = threshold_bin;
   threshold_[new_node_idx] = threshold_double;",I think this `if` could be removed,cpp,1,0,1
"@@ -294,6 +294,9 @@ const std::unordered_set<std::string>& Config::parameter_set() {
   ""gpu_platform_id"",
   ""gpu_device_id"",
   ""gpu_use_dp"",
+#ifdef USE_CUDA
+  ""num_gpu"", /* LGBM_CUDA */
+#endif
   });
   return params;
 }","I remember these codes are auto-generated, so we cannot manually change it. @StrikerRUS to confirm.",cpp,0,1,1
"@@ -949,6 +949,9 @@ static bool ValidateFsOutputsAgainstRenderPass(debug_report_data const *report_d
     auto it_a = outputs.begin();
     auto it_b = color_attachments.begin();
     bool used = false;
+    bool alphaToCoverageEnabled = pipeline->graphicsPipelineCI.pMultisampleState != NULL &&
+                                  pipeline->graphicsPipelineCI.pMultisampleState->alphaToCoverageEnable == VK_TRUE;
+    bool locationZeroHasAlpha = false;
 
     // Walk attachment list and outputs together
 ","this is potentially dereferencing outputs.end(), checked above and below, but not here.",cpp,1,1,1
"@@ -1868,6 +1868,13 @@ static inline VkExtent3D GetImageSubresourceExtent(const IMAGE_STATE *img, const
     // Don't allow mip adjustment to create 0 dim, but pass along a 0 if that's what subresource specified
     VkExtent3D extent = img->createInfo.extent;
 
+    // If multi-plane, adjust per-plane extent
+    if (FormatIsMultiplane(img->createInfo.format)) {
+        VkExtent2D divisors = FindMultiplaneExtentDivisors(img->createInfo.format, subresource->aspectMask);
+        extent.width /= divisors.width;
+        extent.height /= divisors.height;
+    }
+
     if (img->createInfo.flags & VK_IMAGE_CREATE_CORNER_SAMPLED_BIT_NV) {
         extent.width = (0 == extent.width ? 0 : std::max(2U, 1 + ((extent.width - 1) >> mip)));
         extent.height = (0 == extent.height ? 0 : std::max(2U, 1 + ((extent.height - 1) >> mip)));","If these divisors are always power of 2, then could >> by 2^x for the pow of 2 instead of divide for perf.",cpp,1,1,1
"@@ -3287,6 +3287,15 @@ NABoolean TSJRule::topMatch (RelExpr * expr,
       ((updateExpr->getOperatorType() == REL_UNARY_DELETE) && updateExpr->isMtsStatement()))
     return FALSE;
 
+  // It is not semantically correct to convert a MERGE having a 
+  // ""NOT MATCHED"" action to a TSJ, since the former has right 
+  // join semantics. (If we converted here to a TSJ, a non-matching
+  // row would not be returned by the outer child scan node, so
+  // the inner child merge node would never see it and hence the
+  // ""NOT MATCHED"" logic would not be activiated.)
+  if (updateExpr->isMerge() && updateExpr->insertValues())
+    return FALSE;
+
   return TRUE;
 }
 ",I am assuming that when a TSJ is used for IndexMaintenence or to to flow rows from a TupleList or a source select it should be acceptable. Are those cases excluded somehow by this restriction?,cpp,1,1,1
"@@ -3718,7 +3718,16 @@ rai::thread_runner::thread_runner (boost::asio::io_service & service_a, unsigned
 			}
 			catch (...)
 			{
+#ifndef NDEBUG
+				/*
+				 * In a release build, catch and swallow the
+				 * service exception, in debug mode pass it
+				 * on
+				 */
+				throw;
+
 				assert (false && ""Unhandled service exception"");
+#endif
 			}
 		}));
 	}",Shouldn't we get rid of this assert?,cpp,1,0,1
"@@ -38,7 +38,7 @@ void BalanceTask::invoke() {
         case Status::CHANGE_LEADER: {
             LOG(INFO) << taskIdStr_ << ""Ask the src to give up the leadership."";
             SAVE_STATE();
-            client_->transLeader(spaceId_, partId_, src_, dst_).thenValue([this](auto&& resp) {
+            client_->transLeader(spaceId_, partId_, src_).thenValue([this](auto&& resp) {
                 if (!resp.ok()) {
                     ret_ = Result::FAILED;
                 } else {","line 36: ms or s ? BTW, do more logs in this function: a lot of cases for state change tracking",cpp,0,1,1
"@@ -43,7 +43,8 @@ data_reader_merge_features::data_reader_merge_features(
   const data_reader_merge_features& other) :
   generic_compound_data_reader(other),
   m_data_size(other.m_data_size) {
-  m_label_reader = other.m_label_reader->copy();
+  if(other.m_label_reader != nullptr) 
+    m_label_reader = other.m_label_reader->copy();
 }
 
 data_reader_merge_features& data_reader_merge_features::operator=(",We should handle the case where `other.m_label_reader == nullptr`.,cpp,1,1,1
"@@ -170,12 +170,12 @@ public:
         const auto infer_result = this->infer(desc, model, x_test);
         check_infer_shapes(desc, data, infer_result);
 
-        SECTION(""infer accuracy is expected"") {
-            for (auto ch : checker_list) {
-                CAPTURE(ch.name);
-                REQUIRE(ch.check(infer_result.get_labels(), y_test) < ch.required_accuracy + eps);
-            }
+        for (auto ch : checker_list) {
+            CAPTURE(ch.name);
+            REQUIRE(ch.check(infer_result.get_labels(), y_test) < ch.required_accuracy + eps);
         }
+        INFO(""infer accuracy is expected"")
+
         return infer_result;
     }
 ","Info should go before the actual check, and it's better to rephrase like ""check if infer accuracy is expected""",cpp,1,1,1
"@@ -5663,7 +5663,7 @@ void Client::SuspendMinion()
         else
         {
                 uint16 SpellID = CurrentPet->GetPetSpellID();
-
+                std::string OrigName = database.GetOriginalPetName(0, this->character_id);
                 if(SpellID)
                 {
                         if(m_suspendedminion.SpellID > 0)",Variable name: should be something like `original_name`,cpp,1,1,1
"@@ -56,6 +56,8 @@
 #include <cerrno>
 #ifndef _WIN32
 #include <unistd.h>
+#else
+#include <Windows.h>
 #endif
 
 //----------------------------------------------------------------------------",Is this needed because msvc includes it by default but msvc-cl doesn't?,cpp,1,1,1
"@@ -266,7 +266,7 @@ bool Condition::isPersistent() const
 		return false;
 	}
 
-	if (!(id == CONDITIONID_DEFAULT || id == CONDITIONID_COMBAT)) {
+	if (!(id == CONDITIONID_DEFAULT || id == CONDITIONID_COMBAT || condition->getType() == CONDITION_MUTED)) {
 		return false;
 	}
 ",`condition->getType()` to `conditionType`,cpp,1,1,1
"@@ -17,6 +17,8 @@
 #include ""../Helpers/PortStatus.h""
 #include ""../Helpers/StringConverter.h""
 
+#include ""../WebServer/HardwarePage.h""
+
 //#include ""../../ESPEasy-Globals.h""
 
 #ifdef ESP32",The same here... Why include a piece of WebServer code in a generic helper?,cpp,0,1,1
"@@ -278,6 +278,10 @@ String BuildFixes()
     Settings.WiFi_sensitivity_margin = 3; // Margin in dBm on top of sensitivity.
   }
 
+  if (Settings.Build < 20113) {
+    Settings.JSONBoolWithQuotes(true); // Set JSON output to backward compatible
+  }
+
   Settings.Build = BUILD;
   return SaveSettings();
 }","Why not invert the boolean logic, so that a `0` is the default value? This way you don't need this transition and also new default settings will be the old behavior.",cpp,1,1,1
"@@ -667,13 +667,16 @@ double Comm::get_comm_cutoff()
 
   // always take the larger of max neighbor list and user specified cutoff
 
-  maxcommcutoff = MAX(cutghostuser,neighbor->cutneighmax);
+  if (force->pair)
+    maxcommcutoff = MAX(neighbor->cutneighmax,force->pair->cutforce+neighbor->skin);
+
+  maxcommcutoff = MAX(maxcommcutoff,cutghostuser);
 
   // use cutoff estimate from bond length only if no user specified
   // cutoff was given and no pair style present. Otherwise print a
   // warning, if the estimated bond based cutoff is larger than what
   // is currently used.
-  
+
   if (!force->pair && (cutghostuser == 0.0)) {
     maxcommcutoff = MAX(maxcommcutoff,maxbondcutoff);
   } else {","I don't think this works. Say a user does a first run with a long pair cutoff, then a 2nd run with short pair cutoff. Then on the 2nd run, this will set maxcommcutoff to the too-big value from the first run, not the new smaller value? Which will then be used by compute rdf, etc b/c it is invoking this Comm method too early.",cpp,1,1,1
"@@ -446,8 +446,9 @@ void YieldExecutor::feedResult(std::unique_ptr<InterimResult> result) {
 }
 
 void YieldExecutor::setupResponse(cpp2::ExecutionResponse &resp) {
-    CHECK(resp_ != nullptr);
-    resp = std::move(*resp_);
+    if (resp_ != nullptr) {
+        resp = std::move(*resp_);
+    }
 }
 
 }   // namespace graph","Here maybe an empty resp should be set to return to the caller, similar to the GoExecutor :: setupResponse method?",cpp,1,1,1
"@@ -53,7 +53,10 @@ TEST(infer_and_train_cls_kernels_test, can_process_simple_case_default_params) {
     const auto y_train_table =
         dal::homogen_table{ queue, y_train, row_count_train, 1, dal::empty_delete<const float>() };
 
-    const auto x_test_table = dal::homogen_table{ x_test_host,
+    auto x_test = sycl::malloc_shared<float>(row_count_test * column_count, queue);
+    queue.memcpy(x_test, x_test_host, sizeof(float) * row_count_test * column_count).wait();
+    const auto x_test_table = dal::homogen_table{ queue,
+                                                  x_test,
                                                   row_count_test,
                                                   column_count,
                                                   dal::empty_delete<const float>() };","If I am right, `queue.memcpy()` shall be used only with USM pointers. In that case to copy data from host pointer to the USM one, `std::memcpy()` shall be used.",cpp,1,1,1
"@@ -240,6 +240,9 @@ StatusOr<HostAddr> NetworkUtils::toHostAddr(folly::StringPiece ipPort) {
 }
 
 StatusOr<std::vector<HostAddr>> NetworkUtils::toHosts(const std::string& peersStr) {
+    if (peersStr.empty()) {
+        return Status::Error(""Input string(ip:port) empty"");
+    }
     std::vector<HostAddr> hosts;
     std::vector<std::string> peers;
     folly::split("","", peersStr, peers, true);","I think we should NOT forbid empty peersStr. Because in some cases, we actually pass in empty string.",cpp,1,1,1
"@@ -48,6 +48,12 @@ bool nano::block_processor::full ()
 	return (blocks.size () + state_blocks.size ()) > node.flags.block_processor_full_size;
 }
 
+bool nano::block_processor::half_full ()
+{
+	std::unique_lock<std::mutex> lock (mutex);
+	return (blocks.size () + state_blocks.size ()) > node.flags.block_processor_full_size / 2;
+}
+
 void nano::block_processor::add (std::shared_ptr<nano::block> block_a, uint64_t origination)
 {
 	nano::unchecked_info info (block_a, 0, origination, nano::signature_verification::unknown);",Could extract `(blocks.size () + state_blocks.size ())` into a `size ()` method since it's repeated in `full ()`,cpp,1,1,1
"@@ -90,7 +90,9 @@ int main(int argc, char *argv[])
                 for (unsigned int v = 0; v < variablesSize; ++v)
                 {
                     myFloats[0] = static_cast<float>(v + timeStep);
-                    bpWriter.Put(bpFloats[v], myFloats.data());
+                    // Note: Put is deferred, so all variables will see v == 9
+                    // and myFloats[0] == 9, 10, or 11
+                    bpWriter.Put<float>(bpFloats[v], myFloats.data());
                 }
                 const std::string myString(
                     ""Hello from rank: "" + std::to_string(rank) +","Good catch, it needs a `adios2::Mode::Sync` or a call to PerformPuts before the loop ends. The end result is the same.",cpp,1,1,1
"@@ -443,12 +443,13 @@ TEST (store, pruned_load)
 					nano::block_hash random_hash;
 					nano::random_pool::generate_block (random_hash.bytes.data (), random_hash.bytes.size ());
 					store->pruned.put (transaction, random_hash);
+					hashes.insert (random_hash);
 				}
 			}
 			if (!nano::rocksdb_config::using_rocksdb_in_tests ())
 			{
 				auto transaction (store->tx_begin_write ());
-				for (auto k (0); k < batch_size / 2; ++k)
+				for (auto k (0); !hashes.empty () && k < batch_size / 2; ++k)
 				{
 					auto hash (hashes.begin ());
 					store->pruned.del (transaction, *hash);","Do we need the check `!hashes.empty ()`? This is a unit test, if anything is wrong, we want to fail loud and clear rather than handle it quietly. So I would say that we should ASSERT that hashes is not empty.",cpp,1,1,1
"@@ -968,8 +968,8 @@ bool cvdescriptorset::ValidateCopyUpdate(const debug_report_data *report_data, c
     if (dst_layout->IsDestroyed()) {
         *error_code = ""VUID-VkCopyDescriptorSet-dstSet-parameter"";
         string_sprintf(error_msg,
-                       ""Cannot call %s to perform copy update on descriptor set dstSet %s""
-                       "" created with destroyed VkDescriptorSetLayout %s."",
+                       ""Cannot call %s to perform copy update on dstSet %s""
+                       "" created with destroyed %s."",
                        func_name, report_data->FormatHandle(dst_set->GetSet()).c_str(),
                        report_data->FormatHandle(dst_layout->GetDescriptorSetLayout()).c_str());
         return false;",Note that there a couple of places in descriptor_set where FormatHandle isn't being used... `cvdescriptorset::VerifySetLayoutCompatibility` has a couple uses like that. Also output of `buffer` and `imageView` in `ValidateDrawState` These all occur in error_str << message formatting lines. There may be others.,cpp,1,1,1
"@@ -1746,9 +1746,6 @@ MetaClient::regConfig(const std::vector<cpp2::ConfigItem>& items) {
 
 folly::Future<StatusOr<std::vector<cpp2::ConfigItem>>>
 MetaClient::getConfig(const cpp2::ConfigModule& module, const std::string& name) {
-    if (!configReady_) {
-        return Status::Error(""Not ready!"");
-    }
     cpp2::ConfigItem item;
     item.set_module(module);
     item.set_name(name);",How about judge `skipConfig_` instead of just delete it? This is useful,cpp,1,1,1
"@@ -74,7 +74,7 @@ double getLabuteAtomContribs(const ROMol &mol, std::vector<double> &Vi,
     Vi[i] = M_PI * Ri * (4. * Ri - Vi[i]);
     res += Vi[i];
   }
-  if (includeHs) {
+  if (includeHs && fabs(hContrib) > 1e-4) {
     double Rj = PeriodicTable::getTable()->getRb0(1);
     hContrib = M_PI * Rj * (4. * Rj - hContrib);
     res += hContrib;",Why not includeHs && nAtoms?,cpp,1,0,1
"@@ -97,14 +97,11 @@ lbann_callback* construct_callback(lbann_comm* comm,
   //////////////////////////////////////////////////////////////
 
   if (proto_cb.has_ltfb()) {
-    auto&& m = parse_list<>(proto_cb.ltfb().eval_metrics());
-    auto&& w = parse_list<>(proto_cb.ltfb().weights_tosend());
-    std::unordered_set<std::string> metric_names(m.begin(), m.end());
-    std::unordered_set<std::string> weight_names(w.begin(), w.end());
-    return new lbann_callback_ltfb(proto_cb.ltfb().round_size(),
-                                   metric_names,
-                                   proto_cb.ltfb().increasing_metric_mode(),
-                                   weight_names,
+    const auto& params = proto_cb.ltfb();
+    return new lbann_callback_ltfb(params.batch_interval(),
+                                   params.metric(),
+                                   parse_set<std::string>(params.weights()),
+                                   params.low_score_wins(),
                                    summarizer);
   }
   /// @todo","We are not using multiple metrics now but how would this support space-delimited metric (e.g., categorical accuracy) and multiple metrics with the same name as metric specified one of the metrics for training/inference ?",cpp,1,1,1
"@@ -498,6 +498,10 @@ void collapseTurnAt(std::vector<RouteStep> &steps,
     BOOST_ASSERT(one_back_index < steps.size());
     const auto &current_step = steps[step_index];
     const auto &one_back_step = steps[one_back_index];
+    // Don't collapse roundabouts
+    if (entersRoundabout(current_step.maneuver.instruction) ||
+        entersRoundabout(one_back_step.maneuver.instruction))
+        return;
 
     // This function assumes driving on the right hand side of the streat
     BOOST_ASSERT(!one_back_step.intersections.empty() && !current_step.intersections.empty());",Hmm do you know where we introduced the regression and why our tests did not catch it? Also why only the roundabout enter instruction - are the silent roundabout instructions already collapsed into the multi-hop roundabout instruction here?,cpp,1,1,1
"@@ -1911,7 +1911,8 @@ ZonePoint* Zone::GetClosestZonePoint(const glm::vec3& location, uint32 to, Clien
 	// this shouldn't open up any exploits since those situations are detected later on
 	if ((zone->HasWaterMap() && !zone->watermap->InZoneLine(glm::vec3(client->GetPosition()))) || (!zone->HasWaterMap() && closest_dist > 400.0f && closest_dist < max_distance2))
 	{
-		//TODO cheat detection
+		if (client)
+			client->CheatDetected(MQZoneUnknownDest, location); // Someone is trying to use /zone
 		LogInfo(""WARNING: Closest zone point for zone id [{}] is [{}], you might need to update your zone_points table if you dont arrive at the right spot"", to, closest_dist);
 		LogInfo(""<Real Zone Points>. [{}]"", to_string(location).c_str());
 	}",Please use brackets here,cpp,1,0,1
"@@ -85,7 +85,7 @@ void GetObjectiveType(const std::unordered_map<std::string, std::string>& params
   }
 }
 
-void GetMetricType(const std::unordered_map<std::string, std::string>& params, std::vector<std::string>* metric) {
+void GetMetricType(const std::unordered_map<std::string, std::string>& params, const std::string& objective, std::vector<std::string>* metric) {
   std::string value;
   if (Config::GetString(params, ""metric"", &value)) {
     std::transform(value.begin(), value.end(), value.begin(), Common::tolower);","as a general, rule, I like to avoid inserting new arguments in the middle of a function signature. In my experience, I've found that it leads to fewer mistakes when updating the places that call that function. I think this is especially important in C/C++ code, where all arguments are provided positionally. Would you consider adding `objective` at the end of this signature? Or is there a specific reason that `objective` needs to come before `metric`?",cpp,1,1,1
"@@ -932,7 +932,7 @@ bool Dataset::GetIntField(const char* field_name, data_size_t* out_len,
 
 void Dataset::SaveBinaryFile(const char* bin_filename) {
   if (bin_filename != nullptr && std::string(bin_filename) == data_filename_) {
-    Log::Warning(""Binary file %s already exists"", bin_filename);
+    Log::Warning(""Bianry file %s already exists"", bin_filename);
     return;
   }
   // if not pass a filename, just append "".bin"" of original file",It seems that this reverts the typo fixing.,cpp,1,1,1
"@@ -760,13 +760,13 @@ TEST(NebulaStoreTest, ThreeCopiesCheckpointTest) {
         fs::FileUtils::remove(folly::stringPrintf(""%s/data"", rm.data()).c_str(), true);
         fs::FileUtils::remove(folly::stringPrintf(""%s/wal"", rm.data()).c_str(), true);
         std::string mv = folly::stringPrintf(
-                ""/usr/bin/mv %s/disk%d/nebula/0/checkpoints/snapshot/data %s/disk%d/nebula/0/data"",
+                ""mv %s/disk%d/nebula/0/checkpoints/snapshot/data %s/disk%d/nebula/0/data"",
                 rootPath.path(), i , rootPath.path(), i);
         sleep(1);
         auto ret = system(mv.c_str());
         ASSERT_EQ(0, ret);
         mv = folly::stringPrintf(
-                ""/usr/bin/mv %s/disk%d/nebula/0/checkpoints/snapshot/wal %s/disk%d/nebula/0/wal"",
+                ""mv %s/disk%d/nebula/0/checkpoints/snapshot/wal %s/disk%d/nebula/0/wal"",
                 rootPath.path(), i , rootPath.path(), i);
         sleep(1);
         ret = system(mv.c_str());",Consider the function `rename` in stdio.h?,cpp,1,0,1
"@@ -32,7 +32,7 @@ BOOST_AUTO_TEST_CASE(test_tile)
     const auto rc = osrm.Tile(params, result);
     BOOST_CHECK(rc == Status::Ok);
 
-    BOOST_CHECK_EQUAL(result.size(), 114033);
+    BOOST_CHECK_EQUAL(result.size(), 113824);
 
     protozero::pbf_reader tile_message(result);
     tile_message.next();",Why does this change?,cpp,1,0,1
"@@ -18,11 +18,12 @@
 #include <iostream>
 #include <thread>
 
-#include <arpa/inet.h> //AvailableIpAddresses() inet_ntoa
-#include <net/if.h>    //AvailableIpAddresses() struct if_nameindex
-#include <string.h>    //AvailableIpAddresses() strncp
-#include <sys/ioctl.h> //AvailableIpAddresses() ioctl
-#include <unistd.h>    //AvailableIpAddresses() close
+#include <arpa/inet.h>  //AvailableIpAddresses() inet_ntoa
+#include <net/if.h>     //AvailableIpAddresses() struct if_nameindex
+#include <netinet/in.h> //AvailableIpAddresses() struct sockaddr_in
+#include <string.h>     //AvailableIpAddresses() strncp
+#include <sys/ioctl.h>  //AvailableIpAddresses() ioctl
+#include <unistd.h>     //AvailableIpAddresses() close
 
 #include <nlohmann/json.hpp>
 ","I have tried to make it compile on FreeBSD very long time ago, but as far as I remember these socket header files did not exist on BSD systems. Just wondering if there is any tricks I didn't know, or do they actually exist on BSD?",cpp,1,1,1
"@@ -4555,7 +4555,7 @@ void ValueIdSet::unparse(NAString &result,
 
   NAString connectorText;
 
-  if ((form == MVINFO_FORMAT) || (form == QUERY_FORMAT))
+  if ((form == MVINFO_FORMAT) || (form == QUERY_FORMAT) || (form == CONNECT_BY_FORMAT))
     connectorText = "" AND "";
   else
     connectorText = "" , "";","How is the CONNECT_BY_FORMAT different from QUERY or MVINFO formats? The answer might be in other parts of code, its just that I cannot tell. Thank you for explaining",cpp,1,1,1
"@@ -240,9 +240,9 @@ void canonicalizeDoubleBond(Bond *dblBond, INT_VECT &bondVisitOrders,
 
   // now set the directionality on the other side:
   if (setFromBond1) {
-    if (dblBond->getStereo() == Bond::STEREOE) {
+    if (dblBond->getStereo() == Bond::STEREOE || dblBond->getStereo() == Bond::STEREOTRANS ) {
       atom2Dir = atom1Dir;
-    } else if (dblBond->getStereo() == Bond::STEREOZ) {
+    } else if (dblBond->getStereo() == Bond::STEREOZ || dblBond->getStereo() == Bond::STEREOCIS) {
       atom2Dir = (atom1Dir == Bond::ENDUPRIGHT) ? Bond::ENDDOWNRIGHT
                                                 : Bond::ENDUPRIGHT;
     }","This is repeated a lot, consider replacing with bond->isStereo() ? This seems like a better place to encapsulate this logic.",cpp,1,1,1
"@@ -201,13 +201,13 @@ TEST_F(MutateValidatorTest, UpdateEdgeTest) {
     auto cmd = ""UPDATE EDGE ON study \""Tom\""->\""Lily\"" SET count = 1"";
     ASSERT_FALSE(checkResult(cmd, {}));
   }
-  // Wrong expr ""$^.peson.age""
+  // Wrong expr ""$^.person_.age""
   {
     auto cmd =
         ""UPDATE EDGE \""Tom\""->\""Lily\"" OF like ""
         ""SET end = like.end + 1 ""
-        ""WHEN $^.peson.age >= 18 ""
-        ""YIELD $^.peson.age AS age, like.end AS end"";
+        ""WHEN $^.person_.age >= 18 ""
+        ""YIELD $^.person_.age AS age, like.end AS end"";
     ASSERT_FALSE(checkResult(cmd, {}));
   }
   // 1.0 syntax succeed","Happy to drop, but I find it's easier to understand things are typos when they're explicit, and `peson` isn't particularly obvious...",cpp,1,1,1
"@@ -28,7 +28,17 @@ void LMDB::Open(const string& source, Mode mode) {
   }
   int flags = 0;
   if (mode == READ) {
-    flags = MDB_RDONLY | MDB_NOTLS;
+    // No locking, assume DB is not written to at the same time, otherwise
+    // LMDB tries to lock the file, which fails if filesystem is read-only
+    flags = MDB_RDONLY | MDB_NOTLS | MDB_NOLOCK;
+  }
+  // Allow DB to be stand-alone file
+  {
+    struct stat st_buf;
+    stat(source.c_str(), &st_buf);
+    if (S_ISREG(st_buf.st_mode)) {
+      flags |= MDB_NOSUBDIR;
+    }
   }
   MDB_CHECK(mdb_env_open(mdb_env_, source.c_str(), flags, 0664));
   LOG(INFO) << ""Opened lmdb "" << source;",You should check the return value of stat(2).,cpp,1,0,1
"@@ -443,7 +443,11 @@ void KSpace::modify_params(int narg, char **arg)
       nx_pppm = nx_msm_max = force->inumeric(FLERR,arg[iarg+1]);
       ny_pppm = ny_msm_max = force->inumeric(FLERR,arg[iarg+2]);
       nz_pppm = nz_msm_max = force->inumeric(FLERR,arg[iarg+3]);
-      if (nx_pppm == 0 && ny_pppm == 0 && nz_pppm == 0) gridflag = 0;
+      if (nx_pppm == 0 && ny_pppm == 0 && nz_pppm == 0)
+        gridflag = 0;
+      else if (nx_pppm <= 0 || ny_pppm <= 0 || nz_pppm <= 0)
+        error->all(FLERR,""Kspace_modify mesh parameters must be all ""
+                   ""zero or all positive"");
       else gridflag = 1;
       iarg += 4;
     } else if (strcmp(arg[iarg],""mesh/disp"") == 0) {","I don't think we need this check. The default (if no `kspace_modify mesh` is given) is to set the grid automatically, so I don't think a user would go to the trouble of explicitly setting the grid to all zeros using a `kspace_modify` command, just to get the default behavior.",cpp,1,1,1
"@@ -91,8 +91,9 @@ static bool ZipFile(PGLOBAL g, ZIPUTIL *zutp, PCSZ fn, PCSZ entry, char *buf)
 static bool ZipFiles(PGLOBAL g, ZIPUTIL *zutp, PCSZ pat, char *buf)
 {
 	char filename[_MAX_PATH];
+#if defined(__WIN__)
 	int  rc;
-
+#endif
 	/*********************************************************************/
 	/*  pat is a multiple file name with wildcard characters             */
 	/*********************************************************************/",Can you please move the `int rc;` declaration in the ifdef block below? I see no reason to create a new one.,cpp,1,1,1
"@@ -53,12 +53,6 @@ int main(int argc, char *argv[]) {
         return EXIT_FAILURE;
     }
 
-    if (FLAGS_daemonize) {
-        google::SetStderrLogging(google::FATAL);
-    } else {
-        google::SetStderrLogging(google::INFO);
-    }
-
     // Setup logging
     auto status = setupLogging();
     if (!status.ok()) {",why remove this,cpp,1,0,1
"@@ -332,7 +332,7 @@ TEST_F(UDPv4Tests, send_to_allowed_interface)
 
         if (IsAddressDefined(locator))
         {
-            descriptor.interfaceWhiteList.emplace_back(""127.0.0.1"");
+            // descriptor.interfaceWhiteList.emplace_back(""127.0.0.1"");
             descriptor.interfaceWhiteList.emplace_back(IPLocator::toIPv4string(locator));
             UDPv4Transport transportUnderTest(descriptor);
             transportUnderTest.init();","Can we remove this line, please?",cpp,1,0,1
"@@ -238,12 +238,15 @@ bool StatelessReader::matched_writer_is_matched(
 bool StatelessReader::change_received(
         CacheChange_t* change)
 {
-    // Only make visible the change if there is not other with bigger sequence number.
+    // std::cout << ""[FAST STATELESS READER] change_received"" << std::endl;
+    // Only make visible the change if there is change_received other with bigger sequence number.
     // TODO Revisar si no hay que incluirlo.
     if (!thereIsUpperRecordOf(change->writerGUID, change->sequenceNumber))
     {
         if (mp_history->received_change(change, 0))
         {
+            auto payload_length = change->serializedPayload.length;
+
             Time_t::now(change->receptionTimestamp);
             update_last_notified(change->writerGUID, change->sequenceNumber);
             ++total_unread_;",Seems this was left here unintentionally,cpp,1,0,1
"@@ -74,7 +74,7 @@ Status ListHostsProcessor::allHostsWithStatus() {
     }
 
     // get hosts which have send heartbeat recently
-    auto activeHosts = ActiveHostsMan::getActiveHosts(kvstore_, FLAGS_heartbeat_interval_secs + 1);
+    auto activeHosts = ActiveHostsMan::getActiveHosts(kvstore_, FLAGS_heartbeat_interval_secs * 2);
     while (iter->valid()) {
         auto host = MetaServiceUtils::parseLeaderKey(iter->key());
         if (std::find(activeHosts.begin(), activeHosts.end(),","Actually I'm not sure why heartbeat_interval_secs * 2 after talk with dooble offline, maybe more safe",cpp,1,1,1
"@@ -832,7 +832,6 @@ ParKeyWord ParKeyWords::keyWords_[] = {
   ParKeyWord(""PROTECTION"",         TOK_PROTECTION,  NONRESTOKEN_),  
   ParKeyWord(""PROTOTYPE"",          TOK_PROTOTYPE,   COMPAQ_|RESWORD_),
   ParKeyWord(""PUBLIC"",             TOK_PUBLIC,      ANS_|RESWORD_),
-  ParKeyWord(""PUBLISH"",            TOK_PUBLISH,     NONRESTOKEN_),
   ParKeyWord(""PURGEDATA"",          TOK_PURGEDATA,   NONRESTOKEN_),
   ParKeyWord(""QID"",                TOK_QID,         NONRESTOKEN_),
   ParKeyWord(""QID_INTERNAL"",       TOK_QID_INTERNAL,  NONRESTOKEN_),",sqlci/sqlci_yacc.y defines PUBLISH and UNPUBLISH as token. May want to remove this also.,cpp,1,1,1
"@@ -510,6 +510,12 @@ void PairMESONTTPM::compute(int eflag, int vflag){
 
   // set per atom values and accumulators
   // reallocate per-atom arrays if necessary
+  if (eatom_s == nullptr)
+   memory->create(eatom_s,comm->nthreads*maxeatom,""pair:eatom_s"");
+  if (eatom_b == nullptr)
+   memory->create(eatom_b,comm->nthreads*maxeatom,""pair:eatom_b"");
+  if (eatom_t == nullptr)
+   memory->create(eatom_t,comm->nthreads*maxeatom,""pair:eatom_t"");
   if (atom->nmax > maxeatom) {
     maxeatom = atom->nmax;
     memory->destroy(eatom);","This is likely the wrong fix. It should not be needed, if `maxeatom` is properly initialized.",cpp,1,1,1
"@@ -2971,6 +2971,15 @@ void rai::add_node_options (boost::program_options::options_description & descri
 bool rai::handle_node_options (boost::program_options::variables_map & vm)
 {
 	auto result (false);
+	boost::filesystem::path data_path;
+	if (vm.count (""data_path""))
+	{
+		data_path = boost::filesystem::path (vm [""data_path""].as <std::string> ());
+	}
+	else
+	{
+		data_path = rai::working_path ();
+	}
 	if (vm.count (""account_create""))
 	{
 		if (vm.count (""wallet"") == 1)",This would be better as a ternary IMO.,cpp,1,0,1
"@@ -5,6 +5,16 @@
 
 namespace caffe {
 
+// Function uses casting from int to unsigned to compare if value of
+// parameter a is greater or equal to zero and lower than value of
+// parameter b. The b parameter is of type signed and is always positive,
+// therefore its value is always lower than 0x800... where casting
+// negative value of a parameter converts it to value higher than 0x800...
+// The casting allows to use one condition instead of two.
+inline bool is_a_ge_zero_and_a_lt_b(int a, int b) {
+  return static_cast<unsigned>(a) < static_cast<unsigned>(b);
+}
+
 template <typename Dtype>
 void im2col_cpu(const Dtype* data_im, const int channels,
     const int height, const int width, const int kernel_h, const int kernel_w,",This should be a two-space indent per Google style guide (not sure why lint doesn't catch it).,cpp,1,1,1
"@@ -42,10 +42,13 @@
 
 #include <mutex>
 
+#include ""../../../../fastdds/core/policy/ParameterList.hpp""
+
 using namespace eprosima::fastrtps;
 using namespace eprosima::fastrtps::types;
 using eprosima::fastdds::dds::PublicationMatchedStatus;
 using eprosima::fastdds::dds::SubscriptionMatchedStatus;
+using ParameterList = eprosima::fastdds::dds::ParameterList;
 
 namespace eprosima {
 namespace fastrtps {",Don't use relative paths. src directory is already on the include search path,cpp,1,1,1
"@@ -242,7 +242,7 @@ void OverallConfig::CheckParamConflict() {
     int full_num_leaves = static_cast<int>(std::pow(2, boosting_config.tree_config.max_depth));
     if (full_num_leaves > boosting_config.tree_config.num_leaves 
         && boosting_config.tree_config.num_leaves == kDefaultNumLeaves) {
-      Log::Warning(""Accuarcy may be bad since you didn't set num_leaves."");
+      Log::Warning(""Accuracy may be bad since you didn't set num_leaves or max_depth² > num_leaves."");
     }
   }
 }",the logic is `and`,cpp,1,0,1
"@@ -79,6 +79,8 @@ void handle_tools() {
 
   addWideButtonPlusDescription(F(""json""),        F(""Show JSON""),    F(""Open JSON output""));
 
+  addWideButtonPlusDescription(F(""metrics""),        F(""Show Metrics""),    F(""Open Prometheus Metrics""));
+
   # ifdef WEBSERVER_TIMINGSTATS
   addWideButtonPlusDescription(F(""timingstats""), F(""Timing stats""), F(""Open timing statistics of system""));
   # endif // WEBSERVER_TIMINGSTATS",This also needs the `#ifdef WEBSERVER_METRICS` wrapped,cpp,1,1,1
"@@ -236,9 +236,7 @@ void ImageDataLayer<Dtype>::CreatePrefetchThread() {
   phase_ = Caffe::phase();
   const bool prefetch_needs_rand =
       this->layer_param_.image_data_param().shuffle() ||
-          ((phase_ == Caffe::TRAIN) &&
-           (this->layer_param_.image_data_param().mirror() ||
-            this->layer_param_.image_data_param().crop_size()));
+      this->layer_param_.image_data_param().crop_size();
   if (prefetch_needs_rand) {
     const unsigned int prefetch_rng_seed = caffe_rng_rand();
     prefetch_rng_.reset(new Caffe::RNG(prefetch_rng_seed));","Is this change intended? I guess it is fine to initialize a RNG and not use it, but this modification seems unnecessary...",cpp,1,1,1
"@@ -257,6 +257,9 @@ bool CombatSpell::loadScriptCombat()
 
 bool CombatSpell::castSpell(Creature* creature)
 {
+	if (!creature) {
+		return false;
+	}
 	if (scripted) {
 		LuaVariant var;
 		var.type = VARIANT_POSITION;","This check is redundant, this function is only ever called from line 316.",cpp,1,1,1
"@@ -63,7 +63,8 @@ void nano_daemon::daemon::run (boost::filesystem::path const & data_path, nano::
 				auto network_label = node->network_params.network.get_current_network_as_string ();
 				auto version = (NANO_VERSION_PATCH == 0) ? NANO_MAJOR_MINOR_VERSION : NANO_MAJOR_MINOR_RC_VERSION;
 				std::cout << ""Network: "" << network_label << "", version: "" << version << std::endl
-				          << ""Path: "" << node->application_path.string () << std::endl;
+				          << ""Path: "" << node->application_path.string () << std::endl
+				          << ""Build Info: "" << BUILD_INFO << std::endl;
 
 				node->start ();
 				nano::ipc::ipc_server ipc_server (*node, config.rpc);",Would be better to use `\n` instead of `std::endl` multiple times otherwise you are doing multiple flushes. But it's only called once so not too bothered.,cpp,1,1,1
"@@ -105,7 +105,7 @@ int Properties::registerProperty(PropertyFunctor *prop) {
 std::vector<std::string> Properties::getAvailableProperties() {
   registerDescriptors();
   std::vector<std::string> names;
-  BOOST_FOREACH (boost::shared_ptr<PropertyFunctor> prop,
+  for (boost::shared_ptr<PropertyFunctor> prop :
                  Properties::registry) {
     names.push_back(prop->getName());
   }","so _technically_ this is an extra copy of the shared_ptr, which invokes an extra increment/decrement of the reference count. But I think that using the C++11 range-based for loop makes pop out, so I'm a LGTM as is.",cpp,1,1,1
"@@ -357,6 +357,16 @@ class Booster {
     return boosting_->FeatureImportance(num_iteration, importance_type);
   }
 
+  double UpperBoundValue() const {
+    std::lock_guard<std::mutex> lock(mutex_);
+    return boosting_->GetUpperBoundValue();
+  }
+
+  double LowerBoundValue() const {
+    std::lock_guard<std::mutex> lock(mutex_);
+    return boosting_->GetLowerBoundValue();
+  }
+
   double GetLeafValue(int tree_idx, int leaf_idx) const {
     return dynamic_cast<GBDTBase*>(boosting_.get())->GetLeafValue(tree_idx, leaf_idx);
   }",Why mutex is needed here?,cpp,1,0,1
"@@ -160,8 +160,7 @@ int main(int argc, char* argv[]) {
   long incorrect_count_2d = 0;
   {
     // Rank<2> Case: Rank is provided, all other parameters are default
-    using MDPolicyType_2D = typename Kokkos::Experimental::MDRangePolicy<
-        Kokkos::Experimental::Rank<2> >;
+    using MDPolicyType_2D = typename Kokkos::MDRangePolicy<Kokkos::Rank<2> >;
 
     // Construct 2D MDRangePolicy: lower and upper bounds provided, tile dims
     // defaulted",`typename` is superfluous,cpp,1,1,1
"@@ -346,6 +346,19 @@ const std::string GetMolFileAliasInfo(const RWMol &mol) {
   return ss.str();
 }
 
+const std::string GetMolFilePXAInfo(const RWMol &mol) {
+  std::string res;
+  unsigned int nEntries = 0;
+  for (const auto atom : mol.atoms()) {
+    if (atom->hasProp(""_MolFile_PXA"")) {
+      nEntries += 1;
+      res +=
+          boost::str(boost::format(""M  PXA % 3d%s\n"") % (atom->getIdx() + 1) %
+                     atom->getProp<std::string>(""_MolFile_PXA""));
+    }
+  }
+  return res;
+}
 const std::string GetMolFileZBOInfo(const RWMol &mol) {
   std::stringstream res;
   std::stringstream ss;","This variable is set, but never used.",cpp,1,0,1
"@@ -1790,6 +1790,11 @@ public:
 					tree.put (""subtype"", ""change"");
 				}
 			}
+			else if (raw && balance == previous_balance && !handler.node.ledger.epoch_link.is_zero () && block_a.hashables.link == handler.node.ledger.epoch_link)
+			{
+				tree.put (""subtype"", ""epoch"");
+				tree.put (""account"", handler.node.ledger.epoch_signer.to_account ());
+			}
 			else
 			{
 				if (raw)","The `raw` condition needs to be in a separate if statement, like with the change condition above, otherwise it'll fall through to the receive code.",cpp,1,1,1
"@@ -700,7 +700,12 @@ BOOL GCObjInSegment(TADDR taddrObj, const GCHeapDetails &heap,
                     ExtOut(""Error requesting heap segment %p\n"", SOS_PTR(taddrSeg));
                     return FALSE;
                 }
-                if (taddrObj >= TO_TADDR(dacpSeg.mem) && taddrObj && taddrObj < TO_TADDR(dacpSeg.allocated))
+                TADDR allocated = TO_TADDR(dacpSeg.allocated);
+                if (taddrSeg == TO_TADDR(heap.ephemeral_heap_segment))
+                {
+                    allocated = TO_TADDR(heap.alloc_allocated);
+                }
+                if (taddrObj >= TO_TADDR(dacpSeg.mem) && taddrObj && taddrObj < allocated)
                 {
                     rngSeg.segAddr = (TADDR)dacpSeg.segmentAddr;
                     rngSeg.start = (TADDR)dacpSeg.mem;",can we change this to `if (taddrObj >= TO_TADDR(dacpSeg.mem) && taddrObj < allocated)` ?,cpp,1,0,1
"@@ -178,10 +178,10 @@ TEST (work, eco_pow)
 	std::future<std::chrono::nanoseconds> future2 = promise2.get_future ();
 
 	std::thread thread1 (work_func, std::ref (promise1), std::chrono::nanoseconds (0));
-	std::thread thread2 (work_func, std::ref (promise2), std::chrono::nanoseconds (100000));
+	std::thread thread2 (work_func, std::ref (promise2), std::chrono::nanoseconds (10000000));
 
 	// Confirm that the eco pow rate limiter is working.
-	// It's possible under some unlucky circumstances that this fails.
+	// It's possible under some unlucky circumstances that this fails to the random nature of valid work generation. 
 	ASSERT_LT (future1.get (), future2.get ());
 
 	thread1.join ();","Maybe `std::chrono::milliseconds (10)` is a bit more readable. Other than that, LGTM and the test now survives 1000 iterations.",cpp,1,1,1
"@@ -46,7 +46,8 @@ bool ResultSchemaProvider::ResultSchemaField::isValid() const {
  *
  **********************************/
 ResultSchemaProvider::ResultSchemaProvider(Schema schema)
-        : columns_(std::move(schema.get_columns())) {
+        : columns_(std::move(schema.get_columns())),
+          schemaProp_(std::move(schema.get_schema_prop())) {
     for (int64_t i = 0; i < static_cast<int64_t>(columns_.size()); i++) {
         const std::string& name = columns_[i].get_name();
         nameIndex_.emplace(std::make_pair(SpookyHashV2::Hash64(name.data(), name.size(), 0), i));","Use NebulaSchemaProvider, ResultSchemaProvider is designed for result.",cpp,1,1,1
"@@ -82,6 +82,8 @@ MSG(object_does_not_provide_read_access_to_columns,
     ""Given object does not provide read access to columns"")
 MSG(object_does_not_provide_write_access_to_columns,
     ""Given object does not provide write access to columns"")
+MSG(object_does_not_provide_access_to_rows_or_columns,
+    ""Given object does not provide access to rows or columns"")
 MSG(unsupported_conversion_types, ""Unsupported conversion types"")
 MSG(row_indices_lt_min_value, ""Row indices are less than the minimum acceptable value"")
 MSG(row_indices_gt_max_value, ""Row indices are larger than the maximum acceptable value"")","Place it in some ""compatibility"" section?",cpp,1,0,1
"@@ -28,10 +28,11 @@ THE SOFTWARE.
  */
 
 #include ""hip/hip_runtime.h""
+
 #include <test_common.h>
 
 #ifdef __HCC__
-#include <amp.h>
+    #include <hc.hpp>
 #endif
 
 // cudaA",This change has already been submitted and merged since HCC broke this HIP test. So we can discard this change from this PR.,cpp,0,1,1
"@@ -58,6 +58,13 @@ void generic_data_reader::setup() {
   set_initial_position();
 
   shuffle_indices();
+
+  m_thread_buffer.resize(omp_get_max_threads(), std::vector<char>());
+#pragma omp parallel
+  {
+    int tid = omp_get_thread_num();
+    m_thread_buffer[tid].resize(get_linearized_data_size());
+  }
 }
 
 ",It seems simpler to loop through the buffers rather than launching an OpenMP section.,cpp,1,1,1
"@@ -179,6 +179,10 @@ model *build_model_from_prototext(int argc, char **argv,
                                    pb.model());
     model->setup(io_thread_pool);
 
+    if(opts->has_bool(""disable_background_io_activity"") && opts->get_bool(""disable_background_io_activity"")) {
+      model->allow_background_io_activity(false);
+    }
+
     //under development; experimental
     if (opts->has_bool(""use_data_store"") && opts->get_bool(""use_data_store"")) {
       if (master) {","You don't need has_bool(); The code was changed; instead of throwing an exception if the option doesn't exist, 'false' is returned. (other get_XX() methods still throw exceptions, since there's no reasonable default value)",cpp,1,1,1
"@@ -444,12 +444,11 @@ is passed to :cpp:func:`lammps_commands_string` for processing.
 
 void lammps_commands_list(void *handle, int ncmd, const char **cmds)
 {
-  LAMMPS *lmp = (LAMMPS *) handle;
   std::string allcmds;
 
   for (int i = 0; i < ncmd; i++) {
     allcmds.append(cmds[i]);
-    if (allcmds.back() != '\n') allcmds.append(1,'\n');
+    if (allcmds.empty() || (allcmds.back() != '\n')) allcmds.append(1,'\n');
   }
 
   lammps_commands_string(handle,allcmds.c_str());",@rbberger somehow this bug went unnoticed by the automated unit tests while it created an exception/segmentation fault on my local machine in the PythonCommands test (you must not use `std::string.back()` on an empty string). Was this just by chance or do some tests fall through the grid of the various configurations?,cpp,0,1,1
"@@ -2158,6 +2158,15 @@ TEST_F(VkLayerTest, RenderPassBeginLayoutsFramebufferImageUsageMismatches) {
     iavci.subresourceRange.aspectMask = VK_IMAGE_ASPECT_COLOR_BIT;
     vk::CreateImageView(m_device->device(), &iavci, NULL, &iav);
 
+    // Create an input depth attachment view
+    VkImageObj iadi(m_device);
+
+    VkFormat dformat = FindSupportedDepthStencilFormat(gpu());
+    iadi.InitNoLayout(128, 128, 1, dformat, VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT, VK_IMAGE_TILING_OPTIMAL);
+    ASSERT_TRUE(iadi.initialized());
+
+    VkImageView iadv = iadi.targetView(dformat, VK_IMAGE_ASPECT_DEPTH_BIT | VK_IMAGE_ASPECT_STENCIL_BIT, 0, 1, 0, 1);
+
     // Create a color attachment view
     VkImageObj cai(m_device);
 ",Can this be done with `VkImageObj::targetView`?,cpp,1,0,1
"@@ -498,6 +498,7 @@ void Sol2ScriptingEnvironment::ProcessElements(
         [&](const tbb::blocked_range<std::size_t> &range) {
             ExtractionNode result_node;
             ExtractionWay result_way;
+            std::vector<boost::optional<InputRestrictionContainer>> result_res;
             auto &local_context = this->GetSol2Context();
 
             for (auto x = range.begin(), end = range.end(); x != end; ++x)",Remove the `optional`.,cpp,1,0,1
"@@ -2839,7 +2839,7 @@ SDDkwd__(ISO_MAPPING,           (char *)SQLCHARSETSTRING_ISO88591),
   DD_____(PCODE_DEBUG_LOGDIR,        """"  ), // Pathname of log directory for PCode work
   DDint__(PCODE_EXPR_CACHE_CMP_ONLY, ""0"" ), // PCode Expr Cache compare-only mode
   DDint__(PCODE_EXPR_CACHE_DEBUG,    ""0"" ), // PCode Expr Cache debug (set to 1 to enable dbg logging)
-  DDint__(PCODE_EXPR_CACHE_ENABLED,  ""1"" ), // PCode Expr Cache Enabled (set to 0 to disable the cache)
+  DDint__(PCODE_EXPR_CACHE_ENABLED,  ""0"" ), // PCode Expr Cache Enabled (set to 0 to disable the cache)
   DD0_10485760(PCODE_EXPR_CACHE_SIZE,""2000000""), // PCode Expr Cache Max Size
 
   // Maximum number of PCODE Branch Instructions in an Expr",Is the idea here that there is a memory leak in the PCODE cache that we intend to track down later?,cpp,1,1,1
"@@ -31,6 +31,7 @@ using result_t = compute_result<task::compute>;
 using descriptor_t = detail::descriptor_base<task::compute>;
 
 namespace daal_rbf_kernel = daal::algorithms::kernel_function::rbf;
+namespace daal_kernel_internal = daal::algorithms::kernel_function::internal;
 namespace interop = dal::backend::interop;
 
 template <typename Float, daal::CpuType Cpu>",You need to add implementation for dpcpp interfaces. but throw exception for gpu implementation,cpp,1,1,1
"@@ -217,7 +217,7 @@ void nano::bootstrap_connections::populate_connections (bool repeat)
 			if (auto client = c.lock ())
 			{
 				new_clients.push_back (client);
-				endpoints.insert (client->socket->remote_endpoint ());
+				endpoints.insert (*client->socket->remote_endpoint ());
 				double elapsed_sec = client->elapsed_seconds ();
 				auto blocks_per_sec = client->sample_block_rate ();
 				rate_sum += blocks_per_sec;",Is this guaranteed to have a value? Isn't remote_endpoint the side that can switch to ANYADDR?,cpp,1,1,1
"@@ -1133,12 +1133,12 @@ bool CoreChecks::ValidateImageDescriptor(const char *caller, const DrawDispatchV
             static_cast<const cvdescriptorset::ImageSamplerDescriptor &>(image_descriptor).GetSamplerState());
     } else {
         if (binding_info.second.samplers_used_by_image.size() > index) {
-            for (auto &sampler : binding_info.second.samplers_used_by_image[index]) {
+            for (const auto &desc_index : binding_info.second.samplers_used_by_image[index]) {
+                const auto *desc = descriptor_set->GetDescriptorFromBinding(desc_index.sampler_slot.binding, desc_index.sampler_index);
                 // NOTE: This check _shouldn't_ be necessary due to the checks made in IsSpecificDescriptorType in
                 //       shader_validation.cpp. However, without this check some traces still crash.
-                if (sampler.second && (sampler.second->GetClass() == cvdescriptorset::DescriptorClass::PlainSampler)) {
-                    const auto *sampler_state =
-                        static_cast<const cvdescriptorset::SamplerDescriptor *>(sampler.second)->GetSamplerState();
+                if (desc && (desc->GetClass() == cvdescriptorset::DescriptorClass::PlainSampler)) {
+                    const auto *sampler_state = static_cast<const cvdescriptorset::SamplerDescriptor *>(desc)->GetSamplerState();
                     if (sampler_state) sampler_states.emplace_back(sampler_state);
                 }
             }","IIRC, it was never really understood why the `desc->GetClass() == cvdescriptorset::DescriptorClass::PlainSampler` check was necessary. On the one hand I wonder if this change allows this check to be removed. On the other hand, it's probably not worth the effort to find out as there's nothing incorrect about it.",cpp,1,1,1
"@@ -1376,8 +1376,6 @@ void DataReaderImpl::release_payload_pool()
 
     PoolConfig config = PoolConfig::from_history_attributes(history_.m_att);
     payload_pool_->release_history(config, true);
-
-    TopicPayloadPoolRegistry::release(payload_pool_);
 }
 
 ReturnCode_t DataReaderImpl::check_datasharing_compatible(",Shouldn't we do `payload_pool_.reset()` here ?,cpp,1,0,1
"@@ -0,0 +1,12 @@
+#include <bits/stdc++.h>
+using namespace std;
+int main()
+{
+  ios_base::sync_with_stdio(0);
+  cin.tie(0);
+  cout.tie(0);
+  int a,b;
+  cin>>a>>b;
+  cout<<__gcd(a,b)<<""\n"";
+  return 0;
+}",Sample input out are missing.,cpp,0,1,1
"@@ -1622,6 +1622,7 @@ node (init_a, io_ctx_a, application_path_a, alarm_a, nano::node_config (peering_
 }
 
 nano::node::node (nano::node_init & init_a, boost::asio::io_context & io_ctx_a, boost::filesystem::path const & application_path_a, nano::alarm & alarm_a, nano::node_config const & config_a, nano::work_pool & work_a) :
+startup_time (std::chrono::system_clock::now ()),
 io_ctx (io_ctx_a),
 config (config_a),
 alarm (alarm_a),","Effective C++ (Scott Meyers) - Item 13 > ""List members in an initialization list in the order in which they are declared"" > Reason for rule: Class members are initialized in the order of their declaration in the class, not by the order in which they are listed in a member initialization list. If you want `startup_time` to be called before other members then it should be listed at the top in the class definition.",cpp,1,1,1
"@@ -925,7 +925,6 @@ RelExpr *RelSample::bindNode(BindWA *bindWA)
   RelExpr* myChild = child(0);
   if (myChild->getOperatorType() == REL_SCAN &&
       (static_cast<Scan*>(myChild))->isHbaseTable() &&
-      myChild->selectionPred().entries() == 0 &&
       isSimpleRandomRelative() &&
       trafSampleRate <= 1.0f)
     {","I would have assumed that we still need this check for a query with a sample clause and a predicate ? Not for update stats, but for some other SELECT statement with SAMPLE. Simple predicates can be pushed down only for regular format rows, for aligned format rows predicate evaluation will be in Trafodion.",cpp,1,1,1
"@@ -139,7 +139,12 @@ CmpContext::CmpContext(UInt32 f, CollHeap * h)
   optPCodeCache_(NULL),                       // just to be safe ...
   CDBList_(NULL),
   allControlCount_(0),
-  optSimulator_(NULL)
+  optSimulator_(NULL),
+  hosts_(h),
+  invocationInfos_(h),
+  planInfos_(h),
+  routineHandles_(h),
+  ddlObjs_(h)
 {
   SetMode(isDynamicSQL() ? STMT_DYNAMIC : STMT_STATIC);
 ","My bad, sorry for adding these leaks.",cpp,0,0,1
"@@ -249,6 +249,11 @@ bool Creature::getNextStep(Direction& dir, uint32_t&)
 
 void Creature::startAutoWalk(const std::forward_list<Direction>& listDir)
 {
+	if (getPlayer() && getPlayer()->isNoMove()) {
+		getPlayer()->sendCancelWalk();
+		return;
+	}
+
 	listWalkDir = listDir;
 
 	size_t size = 0;",Rename `isNoMove()` to `canMove()` and use that throughout this patch (should default to true obviously).,cpp,1,1,1
"@@ -27,8 +27,11 @@ void ImageDataLayer<Dtype>::DataLayerSetUp(const vector<Blob<Dtype>*>& bottom,
       ""new_height and new_width to be set at the same time."";
   // Read the file with filenames and labels
   const string& source = this->layer_param_.image_data_param().source();
+  CHECK_GT(source.size(), 0);
   LOG(INFO) << ""Opening file "" << source;
   std::ifstream infile(source.c_str());
+  CHECK(infile.good())
+      << ""Could not open image list (filename: \""""+ source + ""\"")"";
   string filename;
   int label;
   while (infile >> filename >> label) {","how about a `CHECK_GT(source.size(), 0)`? Leaving it unspecified seems like the most common error mode so it would be good to have an error message specifically for that case.",cpp,1,1,1
"@@ -45,6 +45,8 @@
 #include ""proj/internal/lru_cache.hpp""
 #include ""proj/internal/tracing.hpp""
 
+#include ""sqlite3.hpp""
+
 #include <cmath>
 #include <cstdlib>
 #include <cstring>",should this be a system include?,cpp,1,0,1
"@@ -120,13 +120,12 @@ void InitLogs() {
   rdWarningLog = std::make_shared<boost::logging::rdLogger>(&std::cerr);
   rdErrorLog = std::make_shared<boost::logging::rdLogger>(&std::cerr);
 }
+
 std::ostream &toStream(std::ostream &logstrm) {
+  char buffer[16];
   time_t t = time(nullptr);
-  tm details = *localtime(&t);
-  logstrm << ""["" << std::setw(2) << std::setfill('0') << details.tm_hour << "":""
-          << std::setw(2) << std::setfill('0') << details.tm_min << "":""
-          << std::setw(2) << std::setfill('0') << int(details.tm_sec) << ""] "";
-  return logstrm;
+  strftime(buffer, 16, ""[%T] "", localtime(&t));
+  return logstrm << buffer;
 }
 }  // namespace RDLog
 ","This gives significantly cleaner output in multithreaded situations. It's not perfect, but it's much better.",cpp,1,1,1
"@@ -87,6 +87,8 @@ namespace thread_role
 			case nano::thread_role::name::wallet_actions:
 				thread_role_name_string = ""Wallet actions"";
 				break;
+			case nano::thread_role::name::wallet_work_regen:
+				thread_role_name_string = ""Wallet work regen"";
 			case nano::thread_role::name::bootstrap_initiator:
 				thread_role_name_string = ""Bootstrap init"";
 				break;",This will assert on debug builds as we check that the length is < 16 below.,cpp,1,1,1
"@@ -41,13 +41,13 @@ void Connection::handle_read(const boost::system::error_code &error, std::size_t
 
     // no error detected, let's parse the request
     http::compression_type compression_type(http::no_compression);
-    util::tribool result;
+    RequestStatus result;
     std::tie(result, compression_type) =
         request_parser.parse(current_request, incoming_data_buffer.data(),
                              incoming_data_buffer.data() + bytes_transferred);
 
     // the request has been parsed
-    if (result == util::tribool::yes)
+    if (result == RequestStatus::yes)
     {
         current_request.endpoint = TCP_socket.remote_endpoint().address();
         request_handler.handle_request(current_request, current_reply);",This needs to be `RequestParser::RequestStatus`. Remember this is a nested type and we are outside of `RequestParser`.,cpp,1,1,1
"@@ -40,6 +40,10 @@
 
 #include <fastdds/dds/log/Log.hpp>
 
+#include ""../../../../fastdds/core/policy/ParameterList.hpp""
+
+using ParameterList = eprosima::fastdds::dds::ParameterList;
+
 // Release reader lock to avoid ABBA lock. PDP mutex should always be first.
 // Keep change information on local variables to check consistency later
 #define PREVENT_PDP_DEADLOCK(reader, change, pdp)                         \",Don't use relative paths. src directory is already on the include search path,cpp,1,1,1
"@@ -160,6 +160,19 @@ uint32_t IOLoginData::gameworldAuthentication(const std::string& accountName, co
 	return accountId;
 }
 
+uint32_t IOLoginData::getAccountIdByPlayerName(const std::string& playerName)
+{
+	Database* db = Database::getInstance();
+
+	std::ostringstream query;
+	query << ""SELECT `account_id` FROM `players` WHERE `name` = "" << db->escapeString(playerName);
+	DBResult_ptr result = db->storeQuery(query.str());
+	if (!result) {
+		return 0;
+	}
+	return result->getNumber<uint32_t>(""account_id"");
+}
+
 AccountType_t IOLoginData::getAccountType(uint32_t accountId)
 {
 	std::ostringstream query;","`bool House::isInvited(const Player* player)` is checked frequently, maybe needs a cache on Game class to improve performance.",cpp,1,1,1
"@@ -86,8 +86,7 @@ bool isValidMatch(const TurnLaneType::Mask tag, const TurnInstruction instructio
                (instruction.type ==
                     TurnType::Continue && // Forks can be experienced, even for straight segments
                 (instruction.direction_modifier == DirectionModifier::SlightLeft ||
-                 instruction.direction_modifier == DirectionModifier::SlightRight)) ||
-               instruction.type == TurnType::Suppressed;
+                 instruction.direction_modifier == DirectionModifier::SlightRight));
     }
     else if (tag == TurnLaneType::slight_left || tag == TurnLaneType::left ||
              tag == TurnLaneType::sharp_left)",we should refactor this ten line return statement ..,cpp,0,0,1
"@@ -199,6 +199,18 @@ int main(int argc, const char **argv) {
 #if defined(HIPIFY_CLANG_RES)
     Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(""-resource-dir="" HIPIFY_CLANG_RES));
 #endif
+    if (!MacroNames.empty()) {
+      for (std::string s : MacroNames) {
+        Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(""-D"", ct::ArgumentInsertPosition::END));
+        Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(s.c_str(), ct::ArgumentInsertPosition::END));
+      }
+    }
+    if (!IncludeDirs.empty()) {
+      for (std::string s : IncludeDirs) {
+        Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(""-I"", ct::ArgumentInsertPosition::END));
+        Tool.appendArgumentsAdjuster(ct::getInsertArgumentAdjuster(s.c_str(), ct::ArgumentInsertPosition::END));
+      }
+    }
     Tool.appendArgumentsAdjuster(ct::getClangSyntaxOnlyAdjuster());
     Statistics& currentStat = Statistics::current();
     // Hipify _all_ the things!","possible this and second checks are redundant otherwise, lgtm",cpp,1,1,1
"@@ -61,6 +61,9 @@ void ThroughputPublisher::DataPubListener::onPublicationMatched(
     if (info.status == MATCHED_MATCHING)
     {
         ++throughput_publisher_.data_discovery_count_;
+        std::cout << C_RED << ""Pub: DATA Pub Matched ""
+                  << throughput_publisher_.data_discovery_count_ << ""/"" << throughput_publisher_.subscribers_
+                  << C_DEF << std::endl;
     }
     else
     {","Should this be done before unlocking, as it is done below?",cpp,0,1,1
"@@ -358,6 +358,15 @@ int main (int argc, char * const * argv)
 					{
 						data_path = nano::working_path ();
 					}
+					size_t batch_size;
+					if (vm.count (""batch_size""))
+					{
+						batch_size = (vm[""batch_size""].as<size_t> ());
+					}
+					else
+					{
+						batch_size = 512;
+					}
 					nano::node_flags flags;
 					flags.disable_backup = (vm.count (""disable_backup"") > 0);
 					flags.disable_lazy_bootstrap = (vm.count (""disable_lazy_bootstrap"") > 0);",I guess no need to set 512 as this is sideband_batch_size default value,cpp,1,1,1
"@@ -319,7 +319,8 @@ void setHydrogenCoords(ROMol *mol, unsigned int hydIdx, unsigned int heavyIdx) {
 }  // end of unnamed namespace
 
 namespace MolOps {
-void addHs(RWMol &mol, bool explicitOnly, bool addCoords) {
+void addHs(RWMol &mol, bool explicitOnly, bool addCoords,
+           const UINT_VECT *onlyOnAtoms) {
   // when we hit each atom, clear its computed properties
   // NOTE: it is essential that we not clear the ring info in the
   // molecule's computed properties.  We don't want to have to",Would a bit vector make more sense here?,cpp,1,0,1
"@@ -57,8 +57,10 @@ ResultCode RocksEngine::get(const std::string& key, std::string* value) {
     if (status.ok()) {
         return ResultCode::SUCCEEDED;
     } else if (status.IsNotFound()) {
+        LOG(ERROR) << ""Get: "" << key << "" Not Found"";
         return ResultCode::ERR_KEY_NOT_FOUND;
     }
+    LOG(ERROR) << ""Failed Get: "" << key << "" "" << status.ToString();
     return ResultCode::ERR_UNKNOWN;
 }
 ","Better to put this line in the `else`, otherwise, one `get` will incur two duplicated log.",cpp,1,1,1
"@@ -350,7 +350,7 @@ if __name__ == ""__main__"":
               ],
           },
           maintainer='Guolin Ke',
-          maintainer_email='guolin.ke@microsoft.com',
+          maintainer_email='guolin.ke@outlook.com',
           zip_safe=False,
           cmdclass={
               'install': CustomInstall,",Ah thanks for catching this! Sorry I didn't think of it on #4633. Thankfully it's not as critical with PyPI as it is with CRAN. @shiyu1994 should this be changed to your name and email? My assumption is that Microsoft would prefer to have a Microsoft employee as the primary contact for these artifacts.,cpp,0,0,1
"@@ -121,7 +121,8 @@ TEST (node, send_single_observing_peer)
         }
 }
 
-TEST (node, send_single_many_peers)
+// TODO: rai::system fails to connect peers
+TEST (node, DISABLED_send_single_many_peers)
 {
         rai::system system (24000, 10);
         rai::keypair key2;",Due to the `max_peers_per_ip` reduction it seems,cpp,1,0,1
"@@ -281,7 +281,10 @@ bool nano::election::transition_time (nano::confirmation_solicitor & solicitor_a
 		result = true;
 		state_change (state_m.load (), nano::election::state_t::expired_unconfirmed);
 		status.type = nano::election_status_type::stopped;
-		log_votes (tally ());
+		if (node.config.logging.election_expiration_tally_logging ())
+		{
+			log_votes (tally (), ""Election expired"");
+		}
 	}
 	return result;
 }","This should probably be ""Election expired: "" otherwise it smashes in to ""Vote tally...""",cpp,1,1,1
"@@ -244,14 +244,14 @@ bool RowReader::processHeader(folly::StringPiece row) {
     }
     offsets_.resize(numFields + 1, -1);
     offsets_[0] = 0;
-    blockOffsets_.push_back(std::make_pair(0, 0));
+    blockOffsets_.emplace_back(std::make_pair(0, 0));
     blockOffsets_.reserve(numOffsets);
     for (uint32_t i = 0; i < numOffsets; i++) {
         int64_t offset = 0;
         for (int32_t j = 0; j < numBytesForOffset_; j++) {
             offset |= (uint64_t(*(it++)) << (8 * j));
         }
-        blockOffsets_.push_back(std::make_pair(offset, 0));
+        blockOffsets_.emplace_back(std::make_pair(offset, 0));
         offsets_[16 * (i + 1)] = offset;
     }
     // Now done with the header",You should have known that `std::make_pair` is not necessary here if `emplace_back` used.,cpp,1,1,1
"@@ -19,6 +19,10 @@
 #include ""internal/conversion.h""
 #include ""service_memory.h""
 
+#if defined(__INTEL_COMPILER)
+    #include <immintrin.h>
+#endif
+
 namespace daal
 {
 namespace data_management",Add const where necessary,cpp,1,0,1
"@@ -428,6 +428,12 @@ void encodeVectorTile(const datafacade::ContiguousInternalMemoryDataFacadeBase &
                 const auto &edge = edges[edge_index];
                 const auto geometry_id = get_geometry_id(edge);
 
+                // Get coordinates for start/end nodes of segment (NodeIDs u and v)
+                const auto a = facade.GetCoordinateOfNode(edge.u);
+                const auto b = facade.GetCoordinateOfNode(edge.v);
+                // Calculate the length in meters
+                const double length = osrm::util::coordinate_calculation::haversineDistance(a, b);
+
                 // Weight values
                 const auto forward_weight_vector =
                     facade.GetUncompressedForwardWeights(geometry_id);","when trying to refactor this I thought about this line a bit. It adds some overhead for calculating the distances. Whats is you opinion here @danpat on the potential slowdown? I feel it might be alright, but I am not entirely sure. (This length calculation is already happening further down as well)",cpp,0,0,1
"@@ -33,14 +33,14 @@ static PJ_XY fouc_s_s_forward (PJ_LP lp, PJ *P) {           /* Spheroidal, forwa
 static PJ_LP fouc_s_s_inverse (PJ_XY xy, PJ *P) {           /* Spheroidal, inverse */
     PJ_LP lp = {0.0,0.0};
     struct pj_opaque *Q = static_cast<struct pj_opaque*>(P->opaque);
-    double V;
     int i;
 
     if (Q->n != 0.0) {
         lp.phi = xy.y;
         for (i = MAX_ITER; i ; --i) {
-            lp.phi -= V = (Q->n * lp.phi + Q->n1 * sin(lp.phi) - xy.y ) /
-                (Q->n + Q->n1 * cos(lp.phi));
+            const double V = (Q->n * lp.phi + Q->n1 * sin(lp.phi) - xy.y ) /
+                             (Q->n + Q->n1 * cos(lp.phi));
+            lp.phi -= V;
             if (fabs(V) < LOOP_TOL)
                 break;
         }","Curious question: in cases like this, would a new address for `V` need to be created each iteration within this for-loop? Are there advantages of declaring the scope of the variable as `const double V` within the for-loop rather than with `double V` outside the for-loop?",cpp,1,1,1
"@@ -167,7 +167,10 @@ std::string DeleteEdgeSentence::toString() const {
     std::string buf;
     buf.reserve(256);
     buf += ""DELETE EDGE "";
+    buf += *edge_;
+    buf += ""("";
     buf += edgeList_->toString();
+    buf += "")"";
     if (whereClause_ != nullptr) {
         buf += "" "";
         buf += whereClause_->toString();",buf.append() would be better ?,cpp,1,0,1
"@@ -125,11 +125,13 @@ TEST_F(IndexTest, TagIndex) {
         std::string query = ""SHOW TAG INDEX STATUS"";
         auto code = client->execute(query, resp);
         ASSERT_EQ(cpp2::ErrorCode::SUCCEEDED, code);
-        std::vector<uniform_tuple_t<std::string, 2>> expected{
-            {""single_person_index"", ""SUCCEEDED""},
-            {""multi_person_index"",  ""SUCCEEDED""},
-        };
-        ASSERT_TRUE(verifyResult(resp, expected));
+        /*
+         * Currently , expected the index status is ""RUNNING"" or ""SUCCEEDED""
+         */
+        for (auto& row : *resp.get_rows()) {
+            const auto &columns = row.get_columns();
+            ASSERT_NE(""FAILED"", columns[1].get_str());
+        }
     }
     {
         cpp2::ExecutionResponse resp;",I think you can try 3 time checking.,cpp,1,0,1
"@@ -132,7 +132,7 @@ util::Coordinate CoordinateExtractor::ExtractRepresentativeCoordinate(
     {
         const auto result = ExtractCoordinateAtLength(
             skipping_inaccuracies_distance, coordinates);
-        BOOST_ASSERT(is_valid_result(coordinates.back()));
+        BOOST_ASSERT(is_valid_result(result));
         return result;
     }
 ",This asserts the result is neither the to nor the intersection node? The assertion before therefore could trigger at any time? Should this be backported to 5.5?,cpp,1,1,1
"@@ -2327,6 +2327,7 @@ static bool PreCallValidateCreateDevice(instance_layer_data *instance_data, cons
     return skip;
 }
 
+std::unordered_map<std::string, void *> &GetNameToFuncptrMap();
 static void PreCallRecordCreateDevice(VkLayerDeviceCreateInfo *chain_info) {
     chain_info->u.pLayerInfo = chain_info->u.pLayerInfo->pNext;
 }",The way that core_validation declares this table requires some forward declaration and indirection to get it where it is needed.,cpp,1,1,1
"@@ -67,7 +67,17 @@ Status TablePlugin::HandleRequest(const datafacade::ContiguousInternalMemoryData
         return Error(""TooBig"", ""Too many table coordinates"", result);
     }
 
-    auto snapped_phantoms = SnapPhantomNodes(GetPhantomNodes(facade, params));
+    auto phantom_nodes = GetPhantomNodes(facade, params);
+
+    if (phantom_nodes.size() != params.coordinates.size())
+    {
+        return Error(""NoSegment"",
+                     std::string(""Could not find a matching segment for coordinate "") +
+                         std::to_string(phantom_nodes.size()),
+                     result);
+    }
+
+    auto snapped_phantoms = SnapPhantomNodes(phantom_nodes);
     auto result_table =
         algorithms.ManyToManySearch(snapped_phantoms, params.sources, params.destinations);
 ","You can use the size of `params.coordinate` to sprint a more helpful error message (e.g. ""Could not find a matching segment for the i-th coordinate"").",cpp,1,1,1
"@@ -782,10 +782,12 @@ hipError_t ihipDevice_t::initProperties(hipDeviceProp_t* prop) {
     DeviceErrorCheck(err);
 
     // BDFID is 16bit uint: [8bit - BusID | 5bit - Device ID | 3bit - Function/DomainID]
-    prop->pciDomainID = bdf_id & 0x7;
     prop->pciDeviceID = (bdf_id >> 3) & 0x1F;
     prop->pciBusID = (bdf_id >> 8) & 0xFF;
 
+    err = hsa_agent_get_info(_hsaAgent, (hsa_agent_info_t)HSA_AMD_AGENT_INFO_DOMAIN, &prop->pciDomainID);
+    DeviceErrorCheck(err);
+
     // Masquerade as a 3.0-level device. This will change as more HW functions are properly
     // supported. Application code should use the arch.has* to do detailed feature detection.
     prop->major = 3;",Are the last 3bits of BDFID still Function/Domain? Aren't BusID and DeviceID inquired by a separate HSA API call too?,cpp,1,1,1
"@@ -11115,6 +11115,17 @@ bool CoreChecks::ValidateCreateSwapchain(const char *func_name, VkSwapchainCreat
     }
 
     auto physical_device_state = GetPhysicalDeviceState();
+    bool skip = false;
+    VkSurfaceTransformFlagBitsKHR currentTransform = physical_device_state->surfaceCapabilities.currentTransform;
+    if ((pCreateInfo->preTransform & currentTransform) != pCreateInfo->preTransform) {
+        skip |= log_msg(report_data, VK_DEBUG_REPORT_PERFORMANCE_WARNING_BIT_EXT, VK_DEBUG_REPORT_OBJECT_TYPE_PHYSICAL_DEVICE_EXT,
+                        HandleToUint64(physical_device), kVUID_Core_Swapchain_PreTransform,
+                        ""%s: pCreateInfo->preTransform (0x%"" PRIx32 "") doesn't match the currentTransform (0x%"" PRIx32
+                        "") returned by vkGetPhysicalDeviceSurfaceCapabilitiesKHR, the presentation engine will transform the image ""
+                        ""content as part of the presentation operation."",
+                        func_name, pCreateInfo->preTransform, currentTransform);
+    }
+
     if (physical_device_state->vkGetPhysicalDeviceSurfaceCapabilitiesKHRState == UNCALLED) {
         if (log_msg(report_data, VK_DEBUG_REPORT_WARNING_BIT_EXT, VK_DEBUG_REPORT_OBJECT_TYPE_PHYSICAL_DEVICE_EXT,
                     HandleToUint64(physical_device), kVUID_Core_DrawState_SwapchainCreateBeforeQuery,",Please use string_VkSurfaceTransformFlagBitsKHR() to convert transform bits to string.,cpp,1,1,1
"@@ -4,7 +4,6 @@
  *  (found in the LICENSE.Apache file in the root directory)
  */
 
-#include ""base/Base.h""
 #include <gtest/gtest.h>
 #include <folly/String.h>
 #include <fstream>",Why did you remove this?,cpp,1,0,1
"@@ -5135,6 +5135,11 @@ bool SwiftASTContext::IsVoidType(void *type) {
   return type == GetASTContext()->TheEmptyTupleType.getPointer();
 }
 
+bool SwiftASTContext::CanPassInRegisters(const CompilerType &type) {
+  abort();
+  return false;
+}
+
 bool SwiftASTContext::IsGenericType(const CompilerType &compiler_type) {
   if (!compiler_type.IsValid())
     return false;",Is abort what we really want here? Maybe use `unreachable` instead?,cpp,1,1,1
"@@ -89,6 +89,7 @@ TDTMolSupplier::TDTMolSupplier(const std::string &fileName,
   if (!tmpStream || (!(*tmpStream)) || (tmpStream->bad())) {
     std::ostringstream errout;
     errout << ""Bad input file "" << fileName;
+    if (tmpStream) { delete tmpStream; }
     throw BadFileException(errout.str());
   }
 ",the `if` isn't necessary,cpp,1,0,1
"@@ -43,7 +43,17 @@ services::Status Parameter::check() const
     return services::Status();
 }
 }
+namespace interface2
+{
+Parameter::Parameter(size_t nClasses) : nClasses(nClasses), resultsToEvaluate(computeClassLabels) {}
 
+services::Status Parameter::check() const
+{
+    DAAL_CHECK_EX(nClasses > 0, services::ErrorIncorrectParameter, services::ParameterName, nClassesStr());
+    DAAL_CHECK_EX(resultsToEvaluate != 0, services::ErrorIncorrectParameter, services::ParameterName, resultsToEvaluateStr())
+    return services::Status();
+}
+}
 namespace training
 {
 namespace interface1",On row 106 in current file we always cast to interface2::Parammeter class. That`s wrong. Branching should be added.,cpp,1,1,1
"@@ -204,6 +204,14 @@ void Tree::AddPredictionToScore(const Dataset* data,
   }
 }
 
+void Tree::AddMaxValueToScore(double& score) const {
+    score += *std::max_element(leaf_value_.begin(), leaf_value_.end());
+}
+
+void Tree::AddMinValueToScore(double& score) const {
+    score += *std::min_element(leaf_value_.begin(), leaf_value_.end());
+}
+
 #undef PredictionFun
 
 std::string Tree::ToString() const {","why not just return the max/min values, and add outside?",cpp,1,1,1
"@@ -478,7 +478,7 @@ void ExtractorCallbacks::ProcessWay(const osmium::Way &input_way, const Extracti
                    });
 
     external_memory.way_start_end_id_list.push_back(
-        {OSMWayID{static_cast<std::uint32_t>(input_way.id())},
+        {OSMWayID{static_cast<std::uint64_t>(input_way.id())},
          OSMNodeID{static_cast<std::uint64_t>(nodes[0].ref())},
          OSMNodeID{static_cast<std::uint64_t>(nodes[1].ref())},
          OSMNodeID{static_cast<std::uint64_t>(nodes[nodes.size() - 2].ref())},",here this must be uint64_t #5380,cpp,1,0,1
"@@ -7,10 +7,16 @@
 #include ""base/Base.h""
 #include <gtest/gtest.h>
 #include ""graph/test/TestEnv.h""
+#include ""fs/TempDir.h""
+#include ""meta/test/TestUtils.h""
+
+DECLARE_string(meta_server_addrs);
 
 using nebula::graph::TestEnv;
 using nebula::graph::gEnv;
 DECLARE_string(meta_server_addrs);
+using nebula::meta::TestUtils;
+using nebula::fs::TempDir;
 
 int main(int argc, char **argv) {
     ::testing::InitGoogleTest(&argc, argv);",Please group simillar statements together.,cpp,1,1,1
"@@ -81,6 +81,11 @@ namespace Impl {
 CudaLockArrays g_host_cuda_lock_arrays = {nullptr, nullptr, 0};
 
 void initialize_host_cuda_lock_arrays() {
+#ifdef KOKKOS_ENABLE_IMPL_DESUL_ATOMICS
+  desul::Impl::init_lock_arrays();
+
+  DESUL_ENSURE_CUDA_LOCK_ARRAYS_ON_DEVICE();
+#endif
   if (g_host_cuda_lock_arrays.atomic != nullptr) return;
   CUDA_SAFE_CALL(cudaMalloc(&g_host_cuda_lock_arrays.atomic,
                             sizeof(int) * (CUDA_SPACE_ATOMIC_MASK + 1)));","This one is replaced by `desul`, isn't it? Can `g_host_cuda_lock_arrays.atomic` be guarded and eventually removed as well?",cpp,1,1,1
"@@ -99,9 +99,12 @@ void Client::Handle_OP_ZoneChange(const EQApplicationPacket *app) {
 				//unable to find a zone point... is there anything else
 				//that can be a valid un-zolicited zone request?
 
-				//Todo cheat detection
 				Message(Chat::Red, ""Invalid unsolicited zone request."");
 				LogError(""Zoning [{}]: Invalid unsolicited zone request to zone id [{}]"", GetName(), target_zone_id);
+				if (GetBindZoneID() == target_zone_id)
+					CheatDetected(MQGate, glm::vec3(zc->x, zc->y, zc->z));
+				else
+					CheatDetected(MQZone, glm::vec3(zc->x, zc->y, zc->z));
 				SendZoneCancel(zc);
 				return;
 			}",Please use brackets here,cpp,1,1,1
"@@ -48,6 +48,10 @@ void PairDeprecated::settings(int, char **)
     my_style = hybrid->keywords[hybrid->nstyles];
   }
 
+  if (strcmp(my_style,""reax"") == 0) {
+    writemsg(lmp,""\nPair style 'reax' has been removed from LAMMPS ""
+                    ""after the 12 December 2018 version\n\n"",1);
+
   if (strcmp(my_style,""DEPRECATED"") == 0) {
     writemsg(lmp,""\nPair style 'DEPRECATED' is a dummy style\n\n"",0);
 ",Missing closing curly bracket `}`,cpp,1,1,1
"@@ -4797,6 +4797,8 @@ GetLastMethodIlOffset(
     HighestOffset = 0;
     for (size_t i = 0; i < MapNeeded; i++)
     {
+        ExtDbgOut(""%d il: %08x start: %p end: %p\n"", i, Map[i].ilOffset, Map[i].startAddress, Map[i].endAddress);
+
         if (Map[i].ilOffset != (ULONG32)CLRDATA_IL_OFFSET_NO_MAPPING &&
             Map[i].ilOffset != (ULONG32)CLRDATA_IL_OFFSET_PROLOG &&
             Map[i].ilOffset != (ULONG32)CLRDATA_IL_OFFSET_EPILOG &&",This adds logging only to the `GetLastMethodIlOffset`. For diagnostic purposes isn't it better for all the methods to include this info?,cpp,1,1,1
"@@ -9,11 +9,11 @@ This module contains tools for enumerating tautomers and determining a canonical
 :license: MIT, see LICENSE file for more details.
 """"""
 
-
 import copy
 import logging
 
 from rdkit import Chem
+from rdkit.Chem.MolStandardize import rdMolStandardize
 from rdkit.Chem.rdchem import BondDir, BondStereo, BondType
 
 from .utils import memoized_property, pairwise",I don't think you need to make any edits at all to this file for this PR,cpp,0,0,1
"@@ -269,6 +269,7 @@ bool nano::mdb_store::do_upgrades (nano::write_transaction & transaction_a, bool
                 case 17:
                         upgrade_v17_to_v18 (transaction_a);
                         needs_vacuuming = true;
+                        // Upgrades to v19 & v20 are both part of the v22 node release
                 case 18:
                         upgrade_v18_to_v19 (transaction_a);
                         needs_vacuuming = true;",Should we start using [[fallthrough]]; ?,cpp,1,0,1
"@@ -47,8 +47,17 @@ short CmpSeabaseDDL::createRepos(ExeCliInterface * cliInterface)
 
   NABoolean xnWasStartedHere = FALSE;
 
+  cliRC = cliInterface->holdAndSetCQD
+    (""TRAF_MAX_CHARACTER_COL_LENGTH"", ""1000000"");
+
+  if (cliRC < 0)
+    {
+      cliInterface->retrieveSQLDiagnostics(CmpCommon::diags());
+      return -1;
+    }
+
   if (beginXnIfNotInProgress(cliInterface, xnWasStartedHere))
-    return -1;
+    goto label_error;
 
   // Create the _REPOS_ schema
   str_sprintf(queryBuf, ""create schema %s.\""%s\"" ; "",",Why was 1000000 chosen?,cpp,1,0,1
"@@ -621,6 +621,19 @@ services::ErrorCollectionPtr Status::getCollection() const
     return services::ErrorCollectionPtr(new services::ErrorCollection());
 }
 
+namespace internal
+{
+ErrorID get_error_id(const Status & s)
+{
+    if (s._impl)
+    {
+        return static_cast<SharedErrorCollection *>(s._impl)->at(0)->id();
+    }
+    return ErrorID::UnknownError;
+}
+
+} // namespace internal
+
 /////////////////////////////////////////////////////////////////////////////////////////
 
 void ErrorMessageCollection::parseResourceFile()","For consistency, it is better to move this function to ""status_to_error_id.cpp"", but this is not critical",cpp,1,1,1
"@@ -580,12 +580,15 @@ void DataWriterImpl::InnerDataWriterListener::on_liveliness_lost(
         fastrtps::rtps::RTPSWriter* /*writer*/,
         const fastrtps::LivelinessLostStatus& status)
 {
+    fastdds::dds::LivelinessLostStatus dds_status;
+    dds_status.total_count = status.total_count;
+    dds_status.total_count_change = status.total_count_change;
     if (data_writer_->listener_ != nullptr)
     {
-        data_writer_->listener_->on_liveliness_lost(data_writer_->user_datawriter_, status);
+        data_writer_->listener_->on_liveliness_lost(data_writer_->user_datawriter_, dds_status);
     }
 
-    data_writer_->publisher_->publisher_listener_.on_liveliness_lost(data_writer_->user_datawriter_, status);
+    data_writer_->publisher_->publisher_listener_.on_liveliness_lost(data_writer_->user_datawriter_, dds_status);
 }
 
 bool DataWriterImpl::wait_for_acknowledgments(","`fastrtps::LivelinessLostStatus` should be another alias for `fasdds::dds::LivelinessLostStatus`, and thus, we can avoid the copy and code duplication.",cpp,1,1,1
"@@ -1184,13 +1184,8 @@ static swift::ASTContext *SetupASTContext(
   if (disable_objc_runtime())
     swift_ast_context->GetLanguageOptions().EnableObjCInterop = false;
 
-  if (repl || playground) {
-    swift_ast_context->GetLanguageOptions().Playground = true;
-    swift_ast_context->GetIRGenOptions().Playground = true;
-  } else {
-    swift_ast_context->GetLanguageOptions().Playground = true;
-    swift_ast_context->GetIRGenOptions().Playground = false;
-  }
+  swift_ast_context->GetLanguageOptions().Playground = repl || playground;
+  swift_ast_context->GetIRGenOptions().Playground = repl || playground;
 
   // For the expression parser and REPL we want to relax the
   // requirement that you put ""try"" in front of every expression that",This was a typo that prevented the feature to work correctly.,cpp,1,0,1
"@@ -65,11 +65,6 @@ class ChunkedArrayTest : public testing::Test {
 };
 
 
-/*! ChunkedArray cannot be built from chunks of size 0. */
-TEST_F(ChunkedArrayTest, constructorWithChunkSize0Throws) {
-  ASSERT_THROW(ChunkedArray<int> ca(0), std::runtime_error);
-}
-
 /*! get_chunk_size() should return the size used in the constructor */
 TEST_F(ChunkedArrayTest, constructorWithChunkSize) {
   for (size_t chunk_size = 1; chunk_size < 10; ++chunk_size) {","I believe this piece of code was dropped due to bad merge or something else, right?",cpp,1,1,1
"@@ -443,9 +443,16 @@ Cylinder* Container::queryDestination(int32_t& index, const Thing &thing, Item**
 		return this;
 	}
 
+	if (index != INDEX_WHEREEVER) {
+		Item* itemFromIndex = getItemByIndex(index);
+		if (itemFromIndex) {
+			*destItem = itemFromIndex;
+		}
+	}
+
 	bool autoStack = !hasBitSet(FLAG_IGNOREAUTOSTACK, flags);
-	if (autoStack && item->isStackable() && item->getParent() != this) {
-		//try find a suitable item to stack with
+	//try find a suitable item to stack with
+	if (autoStack && item->isStackable() && item->getParent() != this && !(*destItem && (*destItem)->isStackable() && (*destItem)->equals(item))) {
 		uint32_t n = 0;
 		for (Item* listItem : itemlist) {
 			if (listItem != item && listItem->equals(item) && listItem->getItemCount() < 100) {","`!(*destItem && (*destItem)->isStackable() && (*destItem)->equals(item))` Can't this be simplified to: `!(*destItem && (*destItem)->equals(item))` I can't verify this right now, but afaik, ->equals should be enough for this check",cpp,1,1,1
"@@ -49,7 +49,8 @@ def GetDbNames(user='sysdba', password='masterkey', dirName='.', dBase='::templa
       names = ['::' + str(x[0]) for x in c.fetchall()]
     names.remove(dBase)
   elif DbModule.fileWildcard:
-    import os.path, glob
+    import os.path
+    import glob
     names = glob.glob(os.path.join(dirName, DbModule.fileWildcard))
   else:
     names = []",I don't really understand the reason to split these across multiple lines.,cpp,1,1,1
"@@ -10276,13 +10276,14 @@ void Client::RemoveItem(uint32 item_id, uint32 quantity)
 
 			item = GetInv().GetItem(slot_id);
 			if (item && item->GetID() == item_id) {
-				int stack_size = item->IsStackable() ? item->GetCharges() : 1;
-				if ((removed_count + stack_size) <= quantity) {
-					removed_count += stack_size;
+				int stack_size = item->IsStackable() ? item->GetCharges() : 0;
+				int real_stack_size = stack_size ? stack_size : 1;
+				if ((removed_count + real_stack_size) <= quantity) {
+					removed_count += real_stack_size;
 					DeleteItemInInventory(slot_id, stack_size, true);
 				} else {
 					int amount_left = (quantity - removed_count);
-					if (amount_left > 0 && stack_size >= amount_left) {
+					if (amount_left > 0 && real_stack_size >= amount_left) {
 						removed_count += amount_left;
 						DeleteItemInInventory(slot_id, amount_left, true);
 					}","Can do `= std::max(stack_size, 1)` to make this a little clearer Maybe also just rename `stack_size` to `charges` and then this `real_stack_size` to the original `stack_size` for clarity",cpp,1,1,1
"@@ -3,6 +3,8 @@
  * Licensed under the MIT License. See LICENSE file in the project root for license information.
  */
 #include <LightGBM/config.h>
+#include <LightGBM/metric.h>
+#include <LightGBM/objective_function.h>
 
 #include <LightGBM/utils/common.h>
 #include <LightGBM/utils/log.h>",I guess that these includes are not needed anymore.,cpp,1,0,1
"@@ -2188,6 +2188,11 @@ bool Player::removeVIP(uint32_t vipGuid)
 
 bool Player::addVIP(uint32_t vipGuid, const std::string& vipName, VipStatus_t status)
 {
+	if (getGUID() == vipGuid) {
+		sendTextMessage(MESSAGE_STATUS_SMALL, ""You cannot add yourself."");
+		return false;
+	}
+
 	if (VIPList.size() >= getMaxVIPEntries() || VIPList.size() == 200) { // max number of buddies is 200 in 9.53
 		sendTextMessage(MESSAGE_STATUS_SMALL, ""You cannot add more buddies."");
 		return false;",I think you can just use `guid` since this variable is available from `this` sorry for bothering you so much   Someone else can come and say that something else is better so don't scold me later ;),cpp,1,1,1
"@@ -4,15 +4,17 @@
  */
 #include <LightGBM/config.h>
 
+#include <LightGBM/dataset.h>
 #include <LightGBM/utils/common.h>
 #include <LightGBM/utils/log.h>
 #include <LightGBM/utils/random.h>
+#include <LightGBM/utils/text_reader.h>
 
 #include <limits>
 
 namespace LightGBM {
 
-void Config::KV2Map(std::unordered_map<std::string, std::string>& params, const char* kv) {
+void Config::KV2Map(std::unordered_map<std::string, std::string>* params, const char* kv) {
   std::vector<std::string> tmp_strs = Common::Split(kv, '=');
   if (tmp_strs.size() == 2 || tmp_strs.size() == 1) {
     std::string key = Common::RemoveQuotationSymbol(Common::Trim(tmp_strs[0]));",Not needed anymore?,cpp,1,0,1
"@@ -145,10 +145,17 @@ hipError_t ihipModuleLaunchKernel(TlsData *tls, hipFunction_t f, uint32_t global
     auto ctx = ihipGetTlsDefaultCtx();
     hipError_t ret = hipSuccess;
 
+    std::size_t blockSize = hip_impl::get_program_state().get_kernattribute(f->_name);
+    if (blockSize < (localWorkSizeX * localWorkSizeY * localWorkSizeZ))
+    {
+        return hipErrorLaunchFailure;
+    }
+
     if (ctx == nullptr) {
         ret = hipErrorInvalidDevice;
 
     } else {
+
         int deviceId = ctx->getDevice()->_deviceId;
         ihipDevice_t* currentDevice = ihipGetDevice(deviceId);
         hsa_agent_t gpuAgent = (hsa_agent_t)currentDevice->_hsaAgent;","How about simply returning after line 155 with the error, and removing the `} else {` unnecessary indentation?",cpp,1,1,1
"@@ -53,7 +53,7 @@ void* DataLayerPrefetch(void* layer_pointer) {
       CHECK(data.size()) << ""Image cropping only support uint8 data"";
       int h_off, w_off;
       // We only do random crop when we do training.
-      if (Caffe::phase() == Caffe::TRAIN) {
+      if (layer->phase_ == Caffe::TRAIN) {
         // NOLINT_NEXT_LINE(runtime/threadsafe_fn)
         h_off = rand() % (height - crop_size);
         // NOLINT_NEXT_LINE(runtime/threadsafe_fn)","I'm not sure that this is related to anything, but rand() is not thread safe.",cpp,1,1,1
"@@ -395,8 +395,7 @@ const ComResWord ComResWords::resWords_[] = {
   ComResWord(""USAGE"",            ANS_|RESWORD_),
   ComResWord(""USER"",             ANS_|RESWORD_),
   ComResWord(""USING"",            ANS_|RESWORD_),
-  ComResWord(""UUID"",            ANS_|RESWORD_),
-  ComResWord(""VALUE"",            ANS_|RESWORD_),
+  ComResWord(""VALUE"",           ANS_|RESWORD_|MPWORD_),
   ComResWord(""VALUES"",           ANS_|RESWORD_|MPWORD_),
   ComResWord(""VARCHAR"",          ANS_|RESWORD_),
   ComResWord(""VARIABLE"",         POTANS_|RESWORD_),","I'm not sure what ""MPWORD_"" will do here but it is probably harmless.",cpp,1,1,1
"@@ -302,6 +302,13 @@ void PDPServer2::initializeParticipantProxyData(
     {
         logWarning(RTPS_PDP_SERVER, ""SERVER or BACKUP PDP requires always all EDP endpoints creation."");
     }
+
+    // Set participant type and discovery server version properties
+    participant_data->m_properties.push_back(
+        std::pair<std::string, std::string>(
+            {dds::parameter_property_participant_type, ParticipantType::SERVER}));
+    participant_data->m_properties.push_back(
+        std::pair<std::string, std::string>({dds::parameter_property_ds_version, ""2.0""}));
 }
 
 void PDPServer2::assignRemoteEndpoints(",Use new constant for current version,cpp,1,0,1
"@@ -2816,9 +2816,11 @@ void rai::rpc_handler::representatives_online ()
 	boost::property_tree::ptree response_l;
 	boost::property_tree::ptree representatives;
 	auto reps (node.online_reps.list ());
+	rai::transaction transaction (node.store.environment, nullptr, false);
 	for (auto & i : reps)
 	{
-		representatives.put (i.to_account (), """");
+		auto sequence (node.store.vote_current (transaction, i)->sequence);
+		representatives.put (i.to_account (), std::to_string (sequence));
 	}
 	response_l.add_child (""representatives"", representatives);
 	response (response_l);","Would this make more sense on the ""representatives"" call to get all representatives sequence numbers?",cpp,1,1,1
"@@ -136,14 +136,14 @@ int main(int argc, char *argv[]) {
       if (master) std::cerr << ""\n STARTING train - G1 solver model at step "" << super_step << "" \n\n"";
       model_2->train( super_step*pb_model_2.num_epochs(),pb_model_2.num_batches());
       // Evaluate model on test set
-      model_2->evaluate(execution_mode::testing,pb_model_2.num_batches());
+      //      model_2->evaluate(execution_mode::testing,pb_model_2.num_batches());
 
       if(master) std::cout << "" Copy all trained weights from discriminator to G2 and train/freeze as appropriate "" << std::endl;
       model_3->copy_trained_weights_from(model1_weights);
       if (master) std::cerr << ""\n STARTING train - G2 solver model at step "" << super_step << "" \n\n"";
       model_3->train( super_step*pb_model_3.num_epochs(),pb_model_3.num_batches());
       // Evaluate model on test set
-      model_3->evaluate(execution_mode::testing,pb_model_3.num_batches());
+      //      model_3->evaluate(execution_mode::testing,pb_model_3.num_batches());
 
       if(master) std::cout << "" Update G1 weights "" << std::endl;
       auto model2_weights = model_2->get_weights();","This make assumption that we will not need to evaluate in between training which may be true for current large-scale inference that uses inference engine but does not consider ""small scale/normal"" training/inference where training and inference are done in the same run.",cpp,1,1,1
"@@ -10929,9 +10929,12 @@ static bool AddAttachmentUse(const layer_data *dev_data, RenderPassCreateVersion
     const char *const function_name = use_rp2 ? ""vkCreateRenderPass2KHR()"" : ""vkCreateRenderPass()"";
 
     if (uses & new_use) {
-        log_msg(dev_data->report_data, VK_DEBUG_REPORT_ERROR_BIT_EXT, VK_DEBUG_REPORT_OBJECT_TYPE_UNKNOWN_EXT, 0,
-                kVUID_Core_DrawState_InvalidRenderpass, ""%s: subpass %u already uses attachment %u as a %s attachment."",
-                function_name, subpass, attachment, StringAttachmentType(new_use));
+        if (attachment_layouts[attachment] != new_layout) {
+            vuid = use_rp2 ? ""VUID-VkSubpassDescription2KHR-layout-02528"" : ""VUID-VkSubpassDescription-layout-02519"";
+            log_msg(dev_data->report_data, VK_DEBUG_REPORT_ERROR_BIT_EXT, VK_DEBUG_REPORT_OBJECT_TYPE_UNKNOWN_EXT, 0, vuid,
+                    ""%s: subpass %u already uses attachment %u with a different image layout (%s vs %s)."", function_name, subpass,
+                    attachment, string_VkImageLayout(attachment_layouts[attachment]), string_VkImageLayout(new_layout));
+        }
     } else if (uses & ~ATTACHMENT_INPUT || (uses && (new_use == ATTACHMENT_RESOLVE || new_use == ATTACHMENT_PRESERVE))) {
         /* Note: input attachments are assumed to be done first. */
         vuid = use_rp2 ? ""VUID-VkSubpassDescription2KHR-pPreserveAttachments-03074""",include the two conflicting layouts in the message -- `string_VkImageLayout` to convert them to human readable strings.,cpp,1,1,1
"@@ -132,10 +132,13 @@ int main(int argc, char *argv[]) {
     }
     El::ReportException(e);
     return EXIT_FAILURE;
-  } catch (std::exception& e) {
+  }
+#if 0
+  catch (std::exception& e) {
     El::ReportException(e);
     return EXIT_FAILURE;
   }
+#endif // 0
 
   return EXIT_SUCCESS;
 }",Is this to allow normal exceptions to propagate all of the way out?,cpp,1,1,1
"@@ -1339,6 +1339,7 @@ void ProtocolGame::sendBasicData()
 {
 	NetworkMessage msg;
 	msg.AddByte(0x9F);
+	msg.AddByte(0x9F);
 	msg.AddByte(player->isPremium() ? 0x01 : 0x00);
 	msg.AddByte(player->getVocation()->getClientId());
 	msg.add<uint16_t>(0x00);",This doesn't make sense. Why another 0x9F?,cpp,1,1,1
"@@ -246,6 +246,18 @@ void model::replace_weights(std::vector<weights*>& new_weights) {
 
 }
 
+void model::replace_weights_by_name(std::vector<weights*>& new_weights) {
+  if (new_weights.empty()) {
+    throw lbann_exception(""Model::replace_weights_by name failed : because new_weight vector is empty."");
+  }
+  for(size_t i = 0; i < new_weights.size(); ++i) {
+     for (size_t j = 0; j < m_weights.size(); ++j) {
+       if(m_weights[j]->get_name() == new_weights[i]->get_name())
+         m_weights[j]->set_values(new_weights[i]->get_values());
+     }
+   }
+}
+
 optimizer* model::create_optimizer() const {
   if (m_default_optimizer != nullptr) {
     return m_default_optimizer->copy();",I don't think this check is necessary. The function can just do nothing if the input vector is empty.,cpp,1,1,1
"@@ -248,12 +248,13 @@ void runServer(Int32 argc, char **argv)
   {
      cout << tmbuf << "" RMS Shared segment exists, attaching to it, shmid=""<< shmid << "", key="" << (key_t)getStatsSegmentId() << ""\n"";
   }
-  if ((statsGlobalsAddr = shmat(shmid, getRmsSharedMemoryAddr(), 0))
+  if ((statsGlobalsAddr = shmat(shmid, getRmsSharedMemoryAddr(), SHM_REMAP | SHM_RND))
 		== (void *)-1)
   {
     cout << tmbuf << ""Shmat failed, shmid="" <<shmid << "", key="" << (key_t) getStatsSegmentId() << "", Error code : ""  << errno << ""("" << strerror(errno) << "")\n"";
     exit(errno);
   }
+  gRmsSharedMemoryAddr_ = statsGlobalsAddr;
   char *statsGlobalsStartAddr = (char *)statsGlobalsAddr;
   if (createStatsGlobals)
   {","This shared segment can't be remapped because RMS shared segment have pointers stored within its space. All the processes attaching to the shared segment should attach at the same address. If the process is unable to do it, then the process can't participate in updating the shared segment. This can lead to corruption in the shared segment",cpp,1,1,1
"@@ -200,6 +200,12 @@ HMODULE g_hInstance = NULL;
 #define IfFailRet(EXPR) do { Status = (EXPR); if(FAILED(Status)) { return (Status); } } while (0)
 #endif
 
+bool IsWindowsTarget()
+{
+    return (g_pRuntime->GetRuntimeConfiguration() == IRuntime::WindowsCore) ||
+           (g_pRuntime->GetRuntimeConfiguration() == IRuntime::WindowsDesktop);
+}
+
 #ifdef FEATURE_PAL
 
 #define MINIDUMP_NOT_SUPPORTED()",This seems like it should be in runtime.cpp with an extern in runtime.h. It may be useful in files other than strike.cpp.,cpp,1,1,1
"@@ -512,9 +512,14 @@ folly::Future<Status> AdminClient::createSnapshot(GraphSpaceID spaceId, const st
 
     folly::Promise<Status> pro;
     auto f = pro.getFuture();
+
+    /**
+     * Don't need retry.
+     * Because existing checkpoint directories leads to fail again.
+     **/
     getResponse(allHosts, 0, std::move(req), [] (auto client, auto request) {
         return client->future_createCheckpoint(request);
-    }, 0, std::move(pro), 1 /*The snapshot operation only needs to be retried twice*/);
+    }, 0, std::move(pro), 0);
     return f;
 }
 ",What if there are some connection failure?,cpp,1,0,1
"@@ -633,7 +633,7 @@ std::string DynamicStateString(CBStatusFlags input_value) {
     while (input_value) {
         if (input_value & 1) {
             if (!ret.empty()) ret.append(""|"");
-            ret.append(string_VkDynamicState(ConvertToDynamicState(static_cast<CBStatusFlagBits>(1 << index))));
+            ret.append(string_VkDynamicState(ConvertToDynamicState(static_cast<CBStatusFlagBits>(1llu << index))));
         }
         ++index;
         input_value >>= 1;","Just curious, was this causing an error?",cpp,1,0,1
"@@ -26,7 +26,7 @@ using namespace lldb_private::formatters::swift;
 
 bool lldb_private::formatters::swift::SwiftMetatype_SummaryProvider(
     ValueObject &valobj, Stream &stream, const TypeSummaryOptions &options) {
-  lldb::addr_t metadata_ptr = valobj.GetValueAsUnsigned(LLDB_INVALID_ADDRESS);
+  lldb::addr_t metadata_ptr = valobj.GetPointerValue();
   if (metadata_ptr == LLDB_INVALID_ADDRESS || metadata_ptr == 0) {
     CompilerType compiler_metatype_type(valobj.GetCompilerType());
     CompilerType instancetype(compiler_metatype_type.GetInstanceType());","As this might not be entirely obvious from the patch, the issue here is that GetValueAsUnsigned() doesn't work for a zero-sized type, e.g. MetaTypes, but we can call `GetPointerValue()` because we always have the location of the value in our hands.",cpp,1,1,1
"@@ -28,7 +28,9 @@
 #include ""lldb/Core/State.h""
 #include ""lldb/Core/StreamFile.h""
 #include ""lldb/Core/ValueObjectRegister.h""
+#ifndef LLDB_DISABLE_LIBEDIT
 #include ""lldb/Host/Editline.h""
+#endif
 #include ""lldb/Interpreter/CommandCompletions.h""
 #include ""lldb/Interpreter/CommandInterpreter.h""
 #include ""lldb/Symbol/Block.h""",Does this file differ from the LLDB llvm.org SVN top of tree and the changes here are just syncing with top of tree SVN?,cpp,1,1,1
"@@ -2789,8 +2789,7 @@ void tm_process_msg(BMS_SRE *pp_sre)
 {
     short                  lv_ret;
     char                   la_send_buffer[4096];
-    char                   la_recv_buffer[sizeof(Tm_Req_Msg_Type)];
-    char                  *la_recv_buffer_ddl = NULL;
+    char                   la_recv_buffer[pp_sre->sre_reqDataSize];
     Tm_Broadcast_Req_Type *lp_br_req;
     Tm_Broadcast_Rsp_Type *lp_br_rsp; 
     Tm_Perf_Stats_Req_Type *lp_ps_req;","Would be good to check the size for non zero value. If the caller passes zero, process will crash at a later point.",cpp,1,1,1
"@@ -3545,7 +3545,7 @@ unsigned long ODBC::ConvertCharToNumeric(SQLPOINTER srcDataPtr,
     rTrim(cTmpBuf);
     tempLen = strlen(cTmpBuf);
     errno = 0;
-	dTmp = strtod(cTmpBuf, &errorCharPtr);
+	dTmp = strtold(cTmpBuf, &errorCharPtr);
 	if (errno == ERANGE || errorCharPtr < (cTmpBuf + tempLen))
 		return IDS_22_003;
 	return SQL_SUCCESS;","This looks innocuous, but strlod return long double which is 16 byte. This 16 byte is assigned to 8 byte double dTmp. I am not sure if there is an implicit casting to double from long double can work as expected.",cpp,1,1,1
"@@ -64,8 +64,6 @@ folly::Future<Status> DataCollectExecutor::doCollect() {
 Status DataCollectExecutor::collectSubgraph(const std::vector<std::string>& vars) {
   DataSet ds;
   ds.colNames = std::move(colNames_);
-  // the subgraph not need duplicate vertices or edges, so dedup here directly
-  std::unordered_set<Value> uniqueVids;
   std::unordered_set<std::tuple<Value, EdgeType, EdgeRanking, Value>> uniqueEdges;
   for (auto i = vars.begin(); i != vars.end(); ++i) {
     const auto& hist = ectx_->getHistory(*i);",We don't need deduplication now ?,cpp,1,0,1
"@@ -41,6 +41,8 @@ LXQtMountPlugin::LXQtMountPlugin(const ILXQtPanelPluginStartupInfo &startupInfo)
 
     connect(mButton, &QToolButton::clicked, mPopup, &Popup::showHide);
     connect(mPopup, &Popup::visibilityChanged, mButton, &QToolButton::setDown);
+    // Note: postpone creation of the mDeviceAction to not fire it in startup time
+    QTimer::singleShot(0, this, &LXQtMountPlugin::settingsChanged);
 }
 
 LXQtMountPlugin::~LXQtMountPlugin()","@lxde/lxqt Do we want to fire the action (info, popup) on the panel startup or not?",cpp,0,0,1
"@@ -111,7 +111,7 @@ FILELOADER_ERRORS Items::loadFromOtb(const std::string& file)
 		return ERROR_INVALID_FORMAT;
 	}
 
-	for(auto & itemNode : root.children) {
+	for (auto & itemNode : root.children) {
 		PropStream stream;
 		if (!loader.getProps(itemNode, stream)) {
 			return ERROR_INVALID_FORMAT;","While at it, remove that space before &",cpp,1,1,1
"@@ -40,11 +40,8 @@ namespace PrepareRelease
 
             foreach (var outputDirectory in outputDirectories)
             {
-                var filename = Path.Combine(outputDirectory, ""integrations.json"");
                 var utf8NoBom = new UTF8Encoding(encoderShouldEmitUTF8Identifier: false);
-                Console.WriteLine($""Writing {filename}..."");
-                File.WriteAllText(filename, json, utf8NoBom);
-
+                
                 // CallTarget
                 var calltargetPath = Path.Combine(outputDirectory, ""src"", ""Datadog.Trace"", ""ClrProfiler"", ""InstrumentationDefinitions.Generated.cs"");
                 Console.WriteLine($""Writing {calltargetPath}..."");","Doesn't have to be done in this PR, but we can also delete the `json` and `serializerSettings` variables, and the `IntegrationGroups.CallSite` property,",.cs,0,1,1
"@@ -101,6 +101,7 @@ namespace NLog
         /// <summary>
         /// Initializes static members of the LogManager class.
         /// </summary>
+        [System.Diagnostics.CodeAnalysis.SuppressMessage(""Microsoft.Performance"", ""CA1810:InitializeReferenceTypeStaticFieldsInline"", Justification = ""Significant logic in .cctor()"")]
         static LogFactory()
         {
             RegisterEvents(DefaultAppEnvironment);","What code-analysis tool where you using, that required this `SuppressMessage` ?",.cs,1,1,1
"@@ -62,6 +62,13 @@ namespace OpenTelemetry.Exporter
                     this.WriteLine($""{""LogRecord.Exception:"".PadRight(rightPaddingLength)}{logRecord.Exception?.Message}"");
                 }
 
+                logRecord.ForEachScope(
+                    (scope, state) =>
+                    {
+                        this.WriteLine($""{""LogRecord.Scope:"".PadRight(rightPaddingLength)}{scope}"");
+                    },
+                    logRecord.State);
+
                 this.WriteLine(string.Empty);
             }
 ",TODO for myself: avoid creating a closure here.,.cs,0,0,1
"@@ -119,11 +119,11 @@ namespace NLog.UnitTests.LayoutRenderers.Wrappers
         [Fact]
         public void CachedSecondsTimeoutTest()
         {
-            SimpleLayout l = ""${guid:cachedSeconds=10}"";
+            SimpleLayout l = ""${guid:cachedSeconds=60}"";
             var s1 = l.Render(LogEventInfo.CreateNullEvent());
             var s2 = l.Render(new LogEventInfo());
             Assert.Equal(s1, s2);
-            var s3 = l.Render(new LogEventInfo() { TimeStamp = NLog.Time.TimeSource.Current.Time.AddMinutes(1) });
+            var s3 = l.Render(new LogEventInfo() { TimeStamp = NLog.Time.TimeSource.Current.Time.AddMinutes(2) });
             Assert.NotEqual(s2, s3);
         }
     }","why does the test need a change? Not that I'm against it, but don't see the reason for it.",.cs,1,1,1
"@@ -29,8 +29,7 @@ namespace MicroBenchmarks
                     .WithMinIterationCount(15)
                     .WithMaxIterationCount(20) // we don't want to run more that 20 iterations
                     .AsDefault()) // tell BDN that this are our default settings
-                .WithArtifactsPath(Path.Combine(
-                    Path.GetDirectoryName(typeof(Program).Assembly.Location), ""BenchmarkDotNet.Artifacts""))
+                .With(ConfigOptions.DontOverwriteResults) // tell BDN to not overwrite the results
                 .With(MemoryDiagnoser.Default) // MemoryDiagnoser is enabled by default
                 .With(new OperatingSystemFilter())
                 .With(JsonExporter.Full) // make sure we export to Json (for BenchView integration purpose)","Data generated by the harness should be with the binaries, not drop side-by-side with the source code. I do not agree this should be changed.",.cs,1,1,1
"@@ -34,7 +34,12 @@ namespace Microsoft.CodeAnalysis.Sarif
 
                         var sha256Cng = new SHA256Cng();
                         checksum = sha256Cng.ComputeHash(bufferedStream);
-                        sha256 = BitConverter.ToString(checksum).Replace(""-"", String.Empty);                            
+                        sha256 = BitConverter.ToString(checksum).Replace(""-"", String.Empty);
+
+                        // disposals
+                        md5Cng.Dispose();
+                        sha1Cng.Dispose();
+                        sha256Cng.Dispose();                        
                     }
                 }
             }",As we've discussed: Use `using` statements to ensure that `Dispose` is called even if the intervening code throws an exception.,.cs,1,1,1
"@@ -23,6 +23,8 @@ using Microsoft.Extensions.Configuration;
 using Microsoft.Extensions.DependencyInjection;
 using Microsoft.Extensions.Hosting;
 using Microsoft.OpenApi.Models;
+using OpenTelemetry;
+using OpenTelemetry.Resources;
 using OpenTelemetry.Trace;
 
 namespace Examples.AspNetCore",I had to add both `OpenTelemetry` and `OpenTelemetry.Resources` here because the `AddService` extension method is in the `OpenTelemetry` namespace. Was this intentional? Relates to #1541 in that I think we should aim to be consistent.,.cs,0,1,1
"@@ -356,6 +356,11 @@ namespace SkylineTester
             _process.StartInfo.Arguments = arguments;
             _process.StartInfo.StandardOutputEncoding = Encoding.UTF8; // So we can read Japanese from TestRunner's console
             _process.StartInfo.StandardErrorEncoding = Encoding.UTF8; // So we can read Japanese from TestRunner's console
+
+            // Configure git to fail if its https connection stalls out, so our retry logic can kick in
+            _process.StartInfo.EnvironmentVariables.Add(@""GIT_HTTP_LOW_SPEED_LIMIT"", @""1000""); // Fail if transfer rate falls below 1Kbps,
+            _process.StartInfo.EnvironmentVariables.Add(@""GIT_HTTP_LOW_SPEED_TIME"", @""300"");   // and stays that way for 5 minutes
+
             _process.OutputDataReceived += HandleOutput;
             _process.ErrorDataReceived += HandleOutput;
             _process.Exited += ProcessExit;",Did you test if it works by using some crazy values like 1gbit and 5 seconds?,.cs,1,1,1
"@@ -213,6 +213,11 @@ namespace Datadog.Trace
             {
                 lock (_globalInstanceLock)
                 {
+                    if (_instance is ILockedTracer)
+                    {
+                        throw new Exception(""The current tracer instance cannot be replaced."");
+                    }
+
                     _instance = value;
                     _globalInstanceInitialized = true;
                 }","Under what circumstances could this happen?   Do we definitely want to throw (rather than log an error and ignore the set), as that would bring down the test process?",.cs,1,1,1
"@@ -0,0 +1,12 @@
+namespace Microsoft.Azure.Cosmos.CosmosElements
+{
+    internal enum CosmosElementType
+    {
+        Array,
+        Boolean,
+        Null,
+        Number,
+        Object,
+        String,
+    }
+}",Is that an extra special character at the end?,.cs,1,1,1
"@@ -2451,7 +2451,7 @@ namespace pwiz.Skyline
                     bool success = false;
                     using (var longWaitDlg = new LongWaitDlg(this)
                     {
-                        Text = Text,    // Same as dialog box
+                        Text = Text, // Same as dialog box
                         Message = message,
                         ProgressValue = 0
                     })",Can you revert these ReSharper autoformatting changes to make the important change clearer?,.cs,1,1,1
"@@ -10,9 +10,9 @@ namespace Datadog.Trace.ClrProfiler.Managed.Tests
     {
         private static readonly List<MethodInfo> StaticInstrumentations = new List<MethodInfo>()
         {
-            typeof(AspNetCoreMvc2Integration).GetMethod(nameof(AspNetCoreMvc2Integration.BeforeAction)),
-            typeof(AspNetCoreMvc2Integration).GetMethod(nameof(AspNetCoreMvc2Integration.AfterAction)),
-            typeof(AspNetCoreMvc2Integration).GetMethod(nameof(AspNetCoreMvc2Integration.Rethrow)),
+             typeof(AspNetCoreMvc2Integration).GetMethod(nameof(AspNetCoreMvc2Integration.BeforeAction)),
+             typeof(AspNetCoreMvc2Integration).GetMethod(nameof(AspNetCoreMvc2Integration.AfterAction)),
+             typeof(AspNetCoreMvc2Integration).GetMethod(nameof(AspNetCoreMvc2Integration.Rethrow)),
         };
 
         public static IEnumerable<object[]> GetWrapperMethodWithInterceptionAttributes()",Can you fix this small thing? I think there's an extra space now.,.cs,1,1,1
"@@ -22,6 +22,8 @@ namespace Nethermind.Consensus.Ethash
 {
     public class EthashCache : IEthashDataSet
     {
+        private ArrayPool<uint[]> _arrayPool = ArrayPool<uint[]>.Create(1024 * 1024 * 4, 50);
+        
         private uint[][] Data { get; set; }
 
         public uint Size { get; set; }",why separate pool?,.cs,1,0,1
"@@ -1303,6 +1303,7 @@ namespace pwiz.Skyline
 
             // Build library
             var builder = import.GetLibBuilder(doc, commandArgs.Saving ? commandArgs.SaveFile : commandArgs.SkylineFile, commandArgs.IncludeAmbiguousMatches);
+            builder.PreferEmbeddedSpectra = commandArgs.PreferEmbeddedSpectra;
             ImportPeptideSearch.ClosePeptideSearchLibraryStreams(doc);
             _out.WriteLine(Resources.CommandLine_ImportSearch_Creating_spectral_library_from_files_);
             foreach (var file in commandArgs.SearchResultsFiles)",This file seems to be missing special handling for the spectrum file missing error. You need a message that tells the user to relocate the raw data or use --import-search-prefer-embedded-spectra,.cs,1,1,1
"@@ -194,10 +194,8 @@ namespace NLog.Targets
         /// <param name=""installationContext"">The installation context.</param>
         public void Install(InstallationContext installationContext)
         {
-            var fixedSource = GetFixedSource();
-
-            //always throw error to keep backwardscomp behavior.
-            CreateEventSourceIfNeeded(fixedSource, true);
+            // always throw error to keep backwards compatible behavior.
+            CreateEventSourceIfNeeded(GetFixedSource(), true);
         }
 
         /// <summary>",Why is this changed?,.cs,1,0,1
"@@ -202,6 +202,19 @@ namespace Microsoft.AspNetCore.Server.KestrelTests
             }
         }
 
+        [Fact]
+        public async Task BadRequestIfContentLengthInvalid()
+        {
+            using (var server = new TestServer(context => { return Task.FromResult(0); }))
+            {
+                using (var connection = server.CreateConnection())
+                {
+                    await connection.Send(""GET / HTTP/1.1\r\nContent-Length: NaN\r\n\r\n"");
+                    await ReceiveBadRequestResponse(connection, ""400 Bad Request"", server.Context.DateHeaderValue);
+                }
+            }
+        }
+
         private async Task ReceiveBadRequestResponse(TestConnection connection, string expectedResponseStatusCode, string expectedDateHeaderValue)
         {
             await connection.ReceiveForcedEnd(",Test with negative value too.,.cs,1,0,1
"@@ -23,6 +23,7 @@ namespace Nethermind.Wallet
     public interface IBasicWallet
     {
         Signature Sign(Keccak message, Address address);
+        bool IsUnlocked(Address address);
         
         void Sign(Transaction tx, int chainId)
         {",This look like a common case when we decide to move only one of a group of transactions but truly we should move ll of them or none. I think that if you need to check whether address is unlocked then you should use IWallet instead. IBasicWallet does not include locking / unlocking.,.cs,1,1,1
"@@ -184,6 +184,8 @@ namespace OpenTelemetry.Instrumentation.Http.Implementation
                     HttpInstrumentationEventSource.Log.EnrichmentException(ex);
                 }
 
+                activity.RecordException(exc);
+
                 if (exc is HttpRequestException)
                 {
                     if (exc.InnerException is SocketException exception)",lets discuss and do this in separate PR.,.cs,0,0,1
"@@ -22,10 +22,12 @@ namespace Nethermind.Blockchain.Processing
     public class BlockProcessedEventArgs : EventArgs
     {
         public Block Block { get; }
+        public TxReceipt[] TxReceipts { get; }
 
-        public BlockProcessedEventArgs(Block block)
+        public BlockProcessedEventArgs(Block block, TxReceipt[] txReceipts)
         {
             Block = block;
+            TxReceipts = txReceipts;
         }
     }
-}
+}",should be allowed to be null I guess as we sometimes may not create receipts,.cs,1,1,1
"@@ -95,7 +95,7 @@ namespace Nethermind.Blockchain.Processing
                     return false;
                 }
 
-                if (transaction.IsEip1559 && !transaction.IsServiceTransaction && senderBalance < (UInt256)transaction.GasLimit * transaction.MaxFeePerGas)
+                if (eip1559Enabled && !transaction.IsServiceTransaction && senderBalance < (UInt256)transaction.GasLimit * transaction.MaxFeePerGas + transaction.Value)
                 {
                     e.Set(TxAction.Skip, $""MaxFeePerGas ({transaction.MaxFeePerGas}) times GasLimit {transaction.GasLimit} is higher than sender balance ({senderBalance})"");
                     return false;","This and the check above in line 90 look similar (same?) as the ones in TransactionProcessor, should we have an extension method or something?",.cs,1,1,1
"@@ -26,11 +26,15 @@ namespace System.Tests
         [Benchmark]
         [ArgumentsSource(nameof(Int32Values))]
         public string ToString(int value) => value.ToString();
-        
+
+        [Benchmark]
+        [ArgumentsSource(nameof(StringValues))]
+        public int Parse(string value) => int.Parse(value);
+
 #if !NETFRAMEWORK && !NETCOREAPP2_0 // API added in .NET Core 2.1
         [Benchmark]
         [ArgumentsSource(nameof(StringValues))]
-        public int Parse(string value) => int.Parse(value.AsSpan());
+        public int ParseSpan(string value) => int.Parse(value.AsSpan());
 
         [Benchmark]
         [ArgumentsSource(nameof(Int32Values))]",this is a breaking change (benchmark rename) but totally needed and reasonable,.cs,1,1,1
"@@ -11,10 +11,12 @@ using Microsoft.AspNetCore.Hosting;
 using Microsoft.AspNetCore.Hosting.Server;
 using Microsoft.AspNetCore.Http;
 using Microsoft.AspNetCore.Server.Kestrel.Core;
+using Microsoft.AspNetCore.Server.Kestrel.Core.Internal;
 using Microsoft.AspNetCore.Server.Kestrel.Transport.Abstractions.Internal;
 using Microsoft.AspNetCore.Testing;
 using Microsoft.Extensions.DependencyInjection;
 using Microsoft.Extensions.Options;
+using Moq;
 
 namespace Microsoft.AspNetCore.Server.Kestrel.FunctionalTests
 {",Nit: fix usings.,.cs,1,0,1
"@@ -59,7 +59,14 @@ namespace Datadog.Trace.Tests
                 Environment = env
             };
             var tracer = new Tracer(settings);
-            Tracer.Instance = tracer;
+            if (Ci.CIVisibility.IsRunning)
+            {
+                Tracer.UnsafeSetTracerInstance(tracer);
+            }
+            else
+            {
+                Tracer.Instance = tracer;
+            }
 
             using (var parentScope = Tracer.Instance.StartActive(""parent""))
             using (var childScope = Tracer.Instance.StartActive(""child""))",Do we need the condition? We could use `Tracer.UnsafeSetTracerInstance(tracer);` in either case right?,.cs,1,1,1
"@@ -176,6 +176,8 @@ namespace Datadog.Trace.ClrProfiler.IntegrationTests
                         {
                             if (!_process.HasExited)
                             {
+                                SubmitRequest(null, ""/shutdown"").GetAwaiter().GetResult();
+
                                 _process.Kill();
                             }
                         }",I think we should exclude this URL in `IsNotServerLifeCheck` too?,.cs,1,1,1
"@@ -14,7 +14,9 @@
 // limitations under the License.
 // </copyright>
 
+using System;
 using System.Diagnostics;
+using OpenTelemetry.Exporter.Jaeger.Implementation;
 
 namespace OpenTelemetry.Exporter
 {",I would move this section to a new method - eg `SetOptionsViaEnvironmentVariables`.,.cs,1,0,1
"@@ -38,6 +38,18 @@ namespace OpenTelemetry.Metrics
 
         public string[] TagKeys { get; set; }
 
+        /// <summary>
+        /// Gets or sets the names of <see cref=""Baggage""/> keys, which,
+        /// if available, will be used as additional tags for Metric
+        /// aggregation.
+        /// <see cref=""Baggage.GetBaggage(string)""/> will be used by the SDK
+        /// internally to obtain the additional tags.
+        /// </summary>
+        /// <remarks>
+        /// It is invalid to specify this for Observable instruments.
+        /// </remarks>
+        public string[] BaggageKeysForAdditionalTags { get; set; }
+
         public virtual Aggregation Aggregation { get; set; }
 
         // TODO: MetricPoints caps can be configured here","I'm not sure if these should be called Tags or Dimensions? It seems the word ""tag"" could mean two different things: 1. The .NET way of calling an Attribute. 2. The Prometheus way of calling a ""dimension"".",.cs,1,1,1
"@@ -31,6 +31,15 @@ namespace Nethermind.Core
             Bytes = new byte[ByteLength];
         }
         
+        public Bloom(Bloom[] blooms)
+        {
+            Bytes = new byte[ByteLength];
+            for (int i = 0; i < blooms.Length; i++)
+            {
+                Accumulate(blooms[i]);
+            }
+        }
+        
         public Bloom(LogEntry[] logEntries, Bloom? blockBloom = null)
         {
             Bytes = new byte[ByteLength];",we could reuse other ctor: public Bloom(Bloom[] blooms) : this {...,.cs,1,1,1
"@@ -112,7 +112,7 @@ namespace OpenTelemetry.Instrumentation.AspNetCore.Implementation
 
             if (activity.IsAllDataRequested)
             {
-                activity.SetCustomProperty(RequestCustomPropertyName, request);
+                this.options.Enrich?.Invoke(activity, ""OnStartActivity"", request);
 
                 var path = (request.PathBase.HasValue || request.Path.HasValue) ? (request.PathBase + request.Path).ToString() : ""/"";
                 activity.DisplayName = path;",this can be user code and can potentially throw. We need to try.catch.log,.cs,1,1,1
"@@ -13,8 +13,10 @@ namespace Microsoft.AspNet.Server.Kestrel.Http
 {
     public class Connection : ConnectionContext, IConnectionControl
     {
-        private static readonly Action<UvStreamHandle, int, object> _readCallback = ReadCallback;
-        private static readonly Func<UvStreamHandle, int, object, Libuv.uv_buf_t> _allocCallback = AllocCallback;
+        private static readonly Action<UvStreamHandle, int, object> _readCallback = 
+            (handle, status, state) => ReadCallback(handle, status, state);
+        private static readonly Func<UvStreamHandle, int, object, Libuv.uv_buf_t> _allocCallback = 
+            (handle, suggestedsize, state) => AllocCallback(handle, suggestedsize, state);
 
         private static long _lastConnectionId;
 ","Do you have to use the `=>` to remove the closure allocation? I think I remember that being the case at one point, but I figured that was a compiler bug that should be fixed by now.",.cs,1,1,1
"@@ -1396,8 +1396,11 @@ namespace pwiz.Skyline.Controls.Graphs
                 {
                     if (IsRunToRun)
                     {
-                        return string.Format(Resources.GraphData_CorrelationLabel_Measured_Time___0__,
-                            _document.MeasuredResults.Chromatograms[_originalIndex].Name);
+                        return _document.MeasuredResults != null && !_document.MeasuredResults.IsEmpty &&
+                               0 <= _originalIndex && _originalIndex < _document.MeasuredResults.Chromatograms.Count
+                            ? string.Format(Resources.GraphData_CorrelationLabel_Measured_Time___0__,
+                                _document.MeasuredResults.Chromatograms[_originalIndex].Name)
+                            : string.Empty;
                     }
                     else
                     {","I think you should make this an ""if/else"" statement instead of ""?:"" so that it's easier to understand. Also, we should probably get rid of the property ""MeasuredResults.IsEmpty"". We never create empty MeasuredResults objects (it's always null instead).",.cs,1,1,1
"@@ -30,12 +30,12 @@ namespace OpenTelemetry.Exporter.Zipkin.Implementation
 
         private static readonly Dictionary<string, int> RemoteEndpointServiceNameKeyResolutionDictionary = new Dictionary<string, int>(StringComparer.OrdinalIgnoreCase)
         {
-            [""net.peer.name""] = 0, // RemoteEndpoint.ServiceName primary.
-            [""peer.service""] = 0, // RemoteEndpoint.ServiceName primary.
-            [""peer.hostname""] = 1, // RemoteEndpoint.ServiceName alternative.
-            [""peer.address""] = 1, // RemoteEndpoint.ServiceName alternative.
-            [""http.host""] = 2, // RemoteEndpoint.ServiceName for Http.
-            [""db.instance""] = 2, // RemoteEndpoint.ServiceName for Redis.
+            [SpanAttributeConstants.PeerServiceKey] = 0, // RemoteEndpoint.ServiceName primary.
+            [""net.peer.name""] = 1, // RemoteEndpoint.ServiceName primary.
+            [""peer.hostname""] = 2, // RemoteEndpoint.ServiceName alternative.
+            [""peer.address""] = 2, // RemoteEndpoint.ServiceName alternative.
+            [""http.host""] = 3, // RemoteEndpoint.ServiceName for Http.
+            [""db.instance""] = 4, // RemoteEndpoint.ServiceName for Redis.
         };
 
         private static readonly ConcurrentDictionary<string, ZipkinEndpoint> LocalEndpointCache = new ConcurrentDictionary<string, ZipkinEndpoint>();","I made Zipkin & Jaeger consistent, but I wasn't sure what should have top priority: ""net.peer.name"" or ""peer.service."" I went with ""peer.service"" because that's what it is called in the Jaeger protocol, but OT spec calls out ""net.peer.name"" specifically. I have a feeling it will change a bunch.",.cs,1,1,1
"@@ -55,7 +55,15 @@ namespace Datadog.Trace
             Settings = settings ?? TracerSettings.FromDefaultSources();
             _agentWriter = agentWriter ?? new AgentWriter(new Api(Settings.AgentUri));
             _scopeManager = scopeManager ?? new AsyncLocalScopeManager();
-            Sampler = sampler ?? new RateByServiceSampler();
+            Sampler = sampler ?? new RuleBasedSampler(new RateLimiter(Settings.MaxTracesSubmittedPerSecond));
+
+            if (!string.IsNullOrEmpty(Settings.CustomSamplingRules))
+            {
+                foreach (var rule in RegexSamplingRule.BuildFromConfigurationString(Settings.CustomSamplingRules))
+                {
+                    Sampler.RegisterRule(rule);
+                }
+            }
 
             // if not configured, try to determine an appropriate service name
             DefaultServiceName = Settings.ServiceName ??",Suggest using `string.IsNullOrWhitespace` instead of `string.IsNullOrEmpty`.,.cs,1,0,1
"@@ -81,7 +81,8 @@ namespace pwiz.Skyline.Model.Results
 
         public override string ToString()
         {
-            return Ratio + (double.IsNaN(StdDev) ? """" : ("" rdotp "" + DotProduct));  // Not L10N
+            // ReSharper disable once LocalizableElement
+            return Ratio + (double.IsNaN(StdDev) ? """" : ("" rdotp "" + DotProduct));
         }
 
         public int CompareTo(object obj)","There's more than one string on this line. Doesn't that mean the ""disable once"" isn't going to work?",.cs,1,1,1
"@@ -40,8 +40,8 @@ namespace Nethermind.JsonRpc.Test.Modules
         private EthereumJsonSerializer _serializer;
         private NetworkConfig _networkConfig;
         private IBlockTree _blockTree;
-        private const string _enodeString = ""enode://e1b7e0dc09aae610c9dec8a0bee62bab9946cc27ebdd2f9e3571ed6d444628f99e91e43f4a14d42d498217608bb3e1d1bc8ec2aa27d7f7e423413b851bae02bc@127.0.0.1:30303"";
-        private const string _exampleDataDir = ""/example/dbdir"";
+        private const string EnodeString = ""enode://e1b7e0dc09aae610c9dec8a0bee62bab9946cc27ebdd2f9e3571ed6d444628f99e91e43f4a14d42d498217608bb3e1d1bc8ec2aa27d7f7e423413b851bae02bc@www.google.com:30303"";
+        private const string ExampleDataDir = ""/example/dbdir"";
         
         [SetUp]
         public void Setup()",it tests dns now but does not test ip any more,.cs,1,1,0
"@@ -47,6 +47,11 @@ namespace OpenTelemetry.Instrumentation.Http
 
         internal bool EventFilter(HttpWebRequest request)
         {
+            if (Sdk.SuppressInstrumentation)
+            {
+                return false;
+            }
+
             Uri requestUri;
             if (request.Method == ""POST""
                 && (requestUri = request.RequestUri) != null","Now that we have this, we should be able to remove the whole IsInternalUrl thing. That was really just filtering out the calls from the instrumentation before we had the mechanism.",.cs,1,1,1
"@@ -41,7 +41,11 @@ namespace OpenTelemetry.Instrumentation
         {
             if (!this.handler.SupportsNullActivity && Activity.Current == null)
             {
-                InstrumentationEventSource.Log.NullActivity(value.Key);
+                if (!Sdk.SuppressInstrumentation)
+                {
+                    InstrumentationEventSource.Log.NullActivity(value.Key);
+                }
+
                 return;
             }
 ","should we add this check inside the instrumentationEventSource? because we can forget if someone adds a new Log, no?",.cs,1,1,1
"@@ -5,8 +5,8 @@ namespace Microsoft.CodeAnalysis.Sarif
     public static class VersionConstants                                       
     {                                                                          
         public const string Prerelease = ""-beta"";                       
-        public const string AssemblyVersion = ""1.5.21"";       
-        public const string FileVersion = ""1.5.21"" + "".0"";    
+        public const string AssemblyVersion = ""1.5.22"";       
+        public const string FileVersion = ""1.5.22"" + "".0"";    
         public const string Version = AssemblyVersion + Prerelease;            
     }                                                                          
  }                                                                             ",How'd this get updated? Why don't I see a chance somewhere to SetCurrentVersion.cmd?,.cs,1,1,1
"@@ -14,12 +14,18 @@ namespace Microsoft.AspNet.Server.Kestrel.Http
 {
     public class SocketOutput : ISocketOutput
     {
+        public const int MaxPooledWriteReqs = 1024;
+
         private const int _maxPendingWrites = 3;
         private const int _maxBytesPreCompleted = 65536;
         private const int _initialTaskQueues = 64;
+        private const int _maxWriteContextsPooledPerThread = 128;
 
         private static WaitCallback _returnBlocks = (state) => ReturnBlocks((MemoryPoolBlock2)state);
 
+        [ThreadStatic]
+        private static Queue<WriteContext> _threadWriteContextPool;
+
         private readonly KestrelThread _thread;
         private readonly UvStreamHandle _socket;
         private readonly Connection _connection;","I'm afraid of adding a ThreadStatic. We don't use ThreadStatics anywhere else in Kestrel that I'm aware of. I just checked the default maximum number of worker threads on my machine using ThreadPool.GetMaxThreads, and it was 32,767. I don't like having potentially that many static queues. Considering that each queue could pool up to 128 WriteContexts (and you just calculated the size WriteContext being 88 bytes), that's up to ~370MB of WriteContexts that will never be freed. That's not even considering the size of the queues themselves.",.cs,1,1,0
"@@ -38,7 +38,7 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets
             _remoteEndPoint = (IPEndPoint)_socket.RemoteEndPoint;
         }
 
-        public async void Start(IConnectionHandler connectionHandler)
+        public async Task Start(IConnectionHandler connectionHandler)
         {
             try
             {",Can we rename this to `StartAsync`?,.cs,1,1,1
"@@ -115,7 +115,13 @@ namespace Datadog.Trace.ClrProfiler.Integrations
         /// <param name=""moduleVersionPtr"">A pointer to the module version GUID.</param>
         /// <returns>Returns the value returned by the inner method call.</returns>
         [InterceptMethod(
-            TargetAssembly = ""System.Net"",
+            TargetAssembly = ""System"", // .NET Framework
+            TargetType = WebRequestTypeName,
+            TargetSignatureTypes = new[] { ""System.Threading.Tasks.Task`1<System.Net.WebResponse>"" },
+            TargetMinimumVersion = Major4,
+            TargetMaximumVersion = Major4)]
+        [InterceptMethod(
+            TargetAssembly = ""System.Net.Requests"", // .NET Core
             TargetType = WebRequestTypeName,
             TargetSignatureTypes = new[] { ""System.Threading.Tasks.Task`1<System.Net.WebResponse>"" },
             TargetMinimumVersion = Major4,","Maybe this change was already in the branch when I handed it off, but is this change necessary for this PR or can it be moved out?",.cs,0,1,1
"@@ -21,5 +21,6 @@ namespace Nethermind.Core.Specs.ChainSpecStyle
     public interface IChainSpecLoader
     {
         ChainSpec Load(byte[] data);
+        ChainSpec Load(string jsonData);
     }
 }",i remember there was a reason for which I had to make it byte[] only... I do not remember the exact reason. I think that not every implementation could provide a string (do not know why),.cs,1,0,1
"@@ -105,6 +105,10 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Core.Internal
         {
             try
             {
+                // TODO: When we start tracking all connection middleware for shutdown, go back
+                // to logging connections tart and stop in ConnectionDispatcher so we get these
+                // logs for all connection middleware.
+                Log.ConnectionStart(ConnectionId);
                 KestrelEventSource.Log.ConnectionStart(this);
 
                 AdaptedPipeline adaptedPipeline = null;",Why did you move this?,.cs,1,0,1
"@@ -2,11 +2,12 @@
 // The .NET Foundation licenses this file to you under the MIT license.
 // See the LICENSE file in the project root for more information.
 
+using System;
 using System.Threading.Tasks;
 
 namespace Microsoft.DotNet.VersionTools.Automation.GitHubApi
 {
-    public interface IGitHubClient
+    public interface IGitHubClient : IDisposable
     {
         GitHubAuth Auth { get; }
 ",Should this be renamed? `IGitClient` sounds better... Or `IRemoteGitClient`?,.cs,1,1,1
"@@ -49,12 +49,12 @@ namespace NLog.UnitTests.Layouts
             {
                 Attributes =
                     {
-                        new JsonAttribute(""date"", ""${longdate}""),
-                        new JsonAttribute(""level"", ""${level}""),
-                        new JsonAttribute(""message"", ""${message}""),
+                        new JsonAttribute(""date"", ""${longdate}"", true),
+                        new JsonAttribute(""level"", ""${level}"", true),
+                        new JsonAttribute(""message"", ""${message}"", true),
                     }
             };
-            
+
             var ev = new LogEventInfo();
             ev.TimeStamp = new DateTime(2010, 01, 01, 12, 34, 56);
             ev.Level = LogLevel.Info;","Please don't change existing unit tests, without good reason. (this is also a hint that it isn't backwards compatible)",.cs,1,1,1
"@@ -10,7 +10,7 @@ namespace MvvmCross.Platforms.Android.Views
 {
     public class MvxApplicationCallbacksCurrentTopActivity : Java.Lang.Object, Application.IActivityLifecycleCallbacks, IMvxAndroidCurrentTopActivity
     {
-        private ConcurrentDictionary<string, ActivityInfo> _Activities = new ConcurrentDictionary<string, ActivityInfo>();
+        protected ConcurrentDictionary<string, ActivityInfo> _Activities { private set; } = new ConcurrentDictionary<string, ActivityInfo>();
         public Activity Activity => GetCurrentActivity();
 
         public void OnActivityCreated(Activity activity, Bundle savedInstanceState)",Shouldn't it have a `get` too?,.cs,1,0,0
"@@ -54,7 +54,7 @@ namespace Nethermind.Core
                 }
             }
             
-            File.WriteAllText(@""network_diag.txt"", stringBuilder.ToString());
+            File.WriteAllText(@""C:\\Temp\\network_diag.txt"", stringBuilder.ToString());
         }
 
         [MethodImpl(MethodImplOptions.Synchronized)]",windows specific? Access to some absolute path?,.cs,1,0,0
"@@ -0,0 +1,13 @@
+namespace Datadog.Trace.Agent
+{
+    internal static class TraceRequestDecorator
+    {
+        public static void AddHeaders(IApiRequest request)
+        {
+            request.AddHeader(AgentHttpHeaderNames.Language, "".NET"");
+            request.AddHeader(AgentHttpHeaderNames.TracerVersion, TracerConstants.AssemblyVersion);
+            // don't add automatic instrumentation to requests from datadog code
+            request.AddHeader(HttpHeaderNames.TracingEnabled, ""false"");
+        }
+    }
+}","This isn't a big deal, but without a full Decorator pattern, this feels a little weird to me. Maybe this could be `IApiRequestExtensions`?",.cs,1,1,1
"@@ -45,17 +45,6 @@ namespace Microsoft.CodeAnalysis.Sarif
 
         private static string[] InvalidFiles = new string[]
         {
-            @""ClangAnalyzer\ArrayDataTypes.xml.sarif"",
-            @""ClangAnalyzer\BadMissingString.xml.sarif"",
-            @""ClangAnalyzer\ClangAnalyzer_issueLog1_raw.xml.sarif"",
-            @""ClangAnalyzer\DictionaryDataTypes.xml.sarif"",
-            @""ClangAnalyzer\DivByZero.xml.sarif"",
-            @""ClangAnalyzer\FileNumberCoverage.xml.sarif"",
-            @""ClangAnalyzer\GarbageValueLog.xml.sarif"",
-            @""ClangAnalyzer\MediumLog.xml.sarif"",
-            @""ClangAnalyzer\MissingLocation.xml.sarif"",
-            @""ClangAnalyzer\RealLog.xml.sarif"",
-            @""CppCheck\CppCheck_issueLog1_raw.xml.sarif""
         };
 
         public static IEnumerable<object[]> TestCases",I like that you left the empty array in there.,.cs,1,0,1
"@@ -18,6 +18,7 @@ namespace Nethermind.Trie.Pruning
 {
     public interface IPruningStrategy
     {
+        bool Enabled { get; }
         bool ShouldPrune(in long currentMemory);
     }
-}
+}",what does it mean enabled?,.cs,1,1,0
"@@ -1950,6 +1950,7 @@ namespace pwiz.Skyline.Util
         {
             return d.HasValue ? d.Value.ToString(LocalizationHelper.CurrentCulture) : String.Empty;
         }
+
     }
 
     /// <summary>",We should get this file cleanly reverted and out of the diffs.,.cs,1,1,1
"@@ -0,0 +1,14 @@
+﻿using UIKit;
+using MvvmCross.Core.ViewModels;
+
+namespace MvvmCross.tvOS.Views
+{
+    public interface IMvxSplitViewController
+    {
+        void ShowMasterView(UIViewController viewController, bool wrapInNavigationController);
+
+        void ShowDetailView(UIViewController viewController, bool wrapInNavigationController);
+
+        bool CloseChildViewModel(IMvxViewModel viewModel);
+    }
+}",I think all of this could be controlled from the presenter?,.cs,1,1,1
"@@ -228,6 +228,19 @@ namespace Datadog.Trace.ClrProfiler.IntegrationTests
             SetEnvironmentVariable(""DD_VERSION"", serviceVersion);
         }
 
+        protected void SetCallTargetSettings(bool enableCallTarget, bool enableMethodInlining)
+        {
+            if (enableCallTarget)
+            {
+                SetEnvironmentVariable(""DD_TRACE_CALLTARGET_ENABLED"", ""true"");
+            }
+
+            if (enableMethodInlining)
+            {
+                SetEnvironmentVariable(""DD_CLR_ENABLE_INLINING"", ""true"");
+            }
+        }
+
         protected async Task AssertWebServerSpan(
             string path,
             MockTracerAgent agent,",Don't you need to also set the variable back to false when the argument is false?,.cs,1,1,1
"@@ -45,7 +45,7 @@ namespace OpenTelemetry.Trace
             var zpagesExporter = new ZPagesExporter(exporterOptions);
 
             // TODO: Pick Simple vs Batching based on ZipkinExporterOptions
-            return builder.AddProcessor(new SimpleActivityProcessor(zpagesExporter));
+            return builder.AddProcessor(new BatchExportActivityProcessor(zpagesExporter));
         }
     }
 }",I guess ZPages can use the simple processor?,.cs,1,1,1
"@@ -11,7 +11,6 @@ namespace Datadog.Trace.ClrProfiler.Integrations.AdoNet
 
             // .NET Core
             public const string SystemDataCommon = ""System.Data.Common"";
-            public const string SystemDataSqlClient = ""System.Data.SqlClient"";
 
             // .NET Standard
             public const string NetStandard = ""netstandard"";",This moved to `SqlCommandIntegration.cs`.,.cs,1,0,1
"@@ -70,6 +70,13 @@ namespace NLog.Targets
         private Timer autoClosingTimer;
         private int initializedFilesCounter;
 
+        /// <summary>
+        /// Provides the shape of an archive file changed event. Event name will describe the action.
+        /// </summary>
+        /// <param name=""archiveFilename"">The name of the file in question.</param>
+        public delegate void ArchiveFileAlteredHandler(string archiveFilename);
+        
+
         private int maxArchiveFiles;
 
         private readonly DynamicFileArchive fileArchive;","With archiving, we like to know to things: the original path and the new archive File Path. This will opt for two separate delegates.",.cs,1,1,1
"@@ -19,7 +19,7 @@ namespace Microsoft.DotNet.Build.Tasks
 
         private const string ConfigurationPropsFilename = ""Configurations.props"";
         private static Regex s_configurationConditionRegex = new Regex(@""'\$\(Configuration\)\|\$\(Platform\)' ?== ?'(?<config>.*)'"");
-        private static string[] s_configurationSuffixes = new [] { ""Debug|AnyCPU"", ""Release|AnyCPU"" };
+        private static string[] s_configurationSuffixes = new [] { ""Debug"", ""Release"" };
 
         public override bool Execute()
         {",Just to confirm: every consumer of this is doing the switch so you don't need to keep the old format?,.cs,1,1,1
"@@ -263,14 +263,15 @@ namespace NLog.Layouts
                 }
                 catch (Exception exception)
                 {
-                    if (exception.MustBeRethrown())
+                    //also check IsErrorEnabled, otherwise 'MustBeRethrown' writes it to Error
+                    if (InternalLogger.IsWarnEnabled || InternalLogger.IsErrorEnabled)
                     {
-                        throw;
+                        InternalLogger.Warn(exception, ""Exception in Append(): {0}."", renderer.GetType().FullName);
                     }
 
-                    if (InternalLogger.IsWarnEnabled)
+                    if (exception.MustBeRethrown())
                     {
-                        InternalLogger.Warn(""Exception in {0}.Append(): {1}."", renderer.GetType().FullName, exception);
+                        throw;
                     }
                 }
             }",`Append()`? Is this message text not outdated?,.cs,1,1,1
"@@ -3,12 +3,16 @@
 // This product includes software developed at Datadog (https://www.datadoghq.com/). Copyright 2017 Datadog, Inc.
 // </copyright>
 
+using System.ComponentModel;
+
 #if !NETFRAMEWORK
 namespace Datadog.Trace.ClrProfiler.AutoInstrumentation.Azure.Functions
 {
     /// <summary>
     /// Enum for ducktyping
     /// </summary>
+    [Browsable(false)]
+    [EditorBrowsable(EditorBrowsableState.Never)]
     public enum AzureFunctionsExecutionReason
     {
         /// <summary>Indicates a function executed because of an automatic trigger.</summary>",Many of these changes are not breaking and should also go into 1.x.,.cs,0,1,1
"@@ -31,7 +31,7 @@ namespace Nethermind.Blockchain.Producers
         private Task _producerTask;
         private readonly CancellationTokenSource _loopCancellationTokenSource = new CancellationTokenSource();
         private readonly CancellationTokenSource _stepCancellationTokenSource = new CancellationTokenSource();
-        private bool _canProduce;
+        private bool _canProduce = true;
 
         protected BaseLoopBlockProducer(
             IPendingTxSelector pendingTxSelector,","I had some nasty forks with this true as default when syncing pre-existing networks, this is under investigation",.cs,0,0,1
"@@ -259,7 +259,7 @@ namespace OpenTelemetry.Context.Propagation
                 return Convert.ToByte(c);
             }
 
-            throw new ArgumentOutOfRangeException(nameof(c), $""Invalid character: {c}."");
+            throw new ArgumentOutOfRangeException(nameof(c), c, $""Invalid character: {c}."");
         }
     }
 }",A general question - do we want all the exception messages to be ended with period `.` or not. I don't have strong opinion on either way. I would suggest that we 1) follow the .NET convention (if there is one) and 2) make it consistent in this repo.,.cs,1,1,1
"@@ -344,9 +344,12 @@ namespace Nethermind.JsonRpc.Modules.Eth
         {
             try
             {
-                Keccak txHash =
+                (Keccak txHash, AddTxResult? addTxResult) =
                     await _txSender.SendTransaction(tx, txHandlingOptions | TxHandlingOptions.PersistentBroadcast);
-                return ResultWrapper<Keccak>.Success(txHash);
+
+                return addTxResult == AddTxResult.Added
+                    ? ResultWrapper<Keccak>.Success(txHash)
+                    : ResultWrapper<Keccak>.Fail(string.Concat(txHash, "": Transaction not added - "", addTxResult.ToString()), ErrorCodes.TransactionRejected);
             }
             catch (SecurityException e)
             {","Can we check what error messages Geth returns and be more standard? Not sure if ""Transaction not added -"" prefix is adding any value, but not sure.",.cs,1,1,1
"@@ -22,13 +22,15 @@ namespace Datadog.Trace.ClrProfiler.Integrations
         /// <summary>
         /// Type for unobtrusive hooking into Microsoft.AspNetCore.Mvc.Core pipeline.
         /// </summary>
-        private const string DiagnosticSource = ""Microsoft.AspNetCore.Mvc.Internal.MvcCoreDiagnosticSourceExtensions"";
+        private const string DiagnosticSourceTypeName = ""Microsoft.AspNetCore.Mvc.Internal.MvcCoreDiagnosticSourceExtensions"";
 
         /// <summary>
         /// Base type used for traversing the pipeline in Microsoft.AspNetCore.Mvc.Core.
         /// </summary>
-        private const string ResourceInvoker = ""Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker"";
+        private const string ResourceInvokerTypeName = ""Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker"";
 
+        private static readonly Type DiagnosticSourceType = Type.GetType($""{DiagnosticSourceTypeName}, {AspnetMvcCore}"");
+        private static readonly Type ResourceInvokerType = Type.GetType($""{ResourceInvokerTypeName}, {AspnetMvcCore}"");
         private static readonly ILog Log = LogProvider.GetLogger(typeof(AspNetCoreMvc2Integration));
 
         private readonly object _httpContext;","I like the `TypeName` postfix for clarity, I'm going to adopt that.",.cs,1,1,1
"@@ -23,6 +23,11 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Internal
 
         private static readonly Action<object, object> _postCallbackAdapter = (callback, state) => ((Action<object>)callback).Invoke(state);
         private static readonly Action<object, object> _postAsyncCallbackAdapter = (callback, state) => ((Action<object>)callback).Invoke(state);
+        private static readonly Libuv.uv_walk_cb _heartbeatWalkCallback = (ptr, arg) =>
+        {
+            var handle = UvMemory.FromIntPtr<UvHandle>(ptr);
+            (handle as UvStreamHandle)?.Connection?.Tick((long)arg);
+        };
 
         // maximum times the work queues swapped and are processed in a single pass
         // as completing a task may immediately have write data to put on the network",nit: call it `_heartbeatWalkCallbackAdapter` to be consistent with the other ones.,.cs,1,1,1
"@@ -32,7 +32,7 @@ namespace OpenTelemetry.Exporter
     /// Exporter consuming <see cref=""Metric""/> and exporting the data using
     /// the OpenTelemetry protocol (OTLP).
     /// </summary>
-    [AggregationTemporality(AggregationTemporality.Both, AggregationTemporality.Cumulative)]
+    [AggregationTemporality(AggregationTemporality.Cumulative | AggregationTemporality.Delta, AggregationTemporality.Cumulative)]
     public class OtlpMetricsExporter : BaseOtlpExporter<Metric>
     {
         private readonly OtlpCollector.MetricsService.IMetricsServiceClient metricsClient;","Not related to this PR, but I'm not following why the OTLP exporter is marked to prefer `Cumulative`. Seems to me the OTLP exporter should effectively not have a preference. For a given service, is it currently not possible for some metrics to have a cumulative aggregation and others to have a delta aggregation?",.cs,0,1,1
"@@ -13,12 +13,12 @@ namespace Datadog.Trace
     /// all newly created spans that are not created with the ignoreActiveSpan
     /// parameter will be automatically children of the active span.
     /// </summary>
-    public class Scope : IDisposable
+    public class Scope : IScope
     {
         private readonly IScopeManager _scopeManager;
         private readonly bool _finishOnClose;
 
-        internal Scope(Scope parent, Span span, IScopeManager scopeManager, bool finishOnClose)
+        internal Scope(Scope parent, ISpan span, IScopeManager scopeManager, bool finishOnClose)
         {
             Parent = parent;
             Span = span;","In the latest set of commits, I removed the member `Scope.InternalSpan` so the change is only that `Scope.Span` has type `ISpan`. This should remove concerns about nullability. Now at runtime we still don't know what runtime type `Scope.Span` actually is, so we have to test against `Scope.Span is Span` returning a null or non-null value",.cs,1,1,1
"@@ -199,7 +199,7 @@ namespace Datadog.Trace
                     return true;
 
                 case HttpHeaderNames.SamplingPriority:
-                    var samplingPriority = SamplingPriority ?? TraceContext?.SamplingPriority;
+                    var samplingPriority = SamplingPriority;
 
                     value = samplingPriority != null ? ((int)samplingPriority.Value).ToString() : null;
                     return true;","I think we want to keep this. The sampling priority is sometimes found in `SpanContext` (when coming from a propagated context) and sometimes in `TraceContext`, so we always need the fallback. I'm looking into fixing this discrepancy in the near future.",.cs,1,1,1
"@@ -348,6 +348,12 @@ namespace OpenTelemetry.Internal
             this.WriteEvent(35, methodName, ex);
         }
 
+        [Event(36, Message = ""Measurement dropped from Instrument Name/Metric Stream Name '{0}'. Reason: '{1}'. Suggested action: '{2}'"", Level = EventLevel.Warning)]
+        public void MeasurementDropped(string instrumentName, string reason, string fix)
+        {
+            this.WriteEvent(36, instrumentName, reason, fix);
+        }
+
 #if DEBUG
         public class OpenTelemetryEventListener : EventListener
         {","I really like this message. Includes what happened, why, and a potential fix  ",.cs,1,0,1
"@@ -90,8 +90,8 @@ namespace Nethermind.Baseline.Test
                 transaction.SenderAddress = key.Address;
                 ecdsa.Sign(key, transaction, true);
                 transaction.Hash = transaction.CalculateHash();
-                AddTxResult result = testRpc.TxPool.SubmitTx(transaction, TxHandlingOptions.None);
-                if (result != AddTxResult.Added)
+                AcceptTxResult result = testRpc.TxPool.SubmitTx(transaction, TxHandlingOptions.None);
+                if (!result.Equals(AcceptTxResult.Accepted))
                 {
                     throw new Exception(""failed to add "" + result);
                 }",implicit bool cast,.cs,1,0,0
"@@ -144,12 +144,17 @@ namespace pwiz.Skyline.Model.Irt
         {
             RequireUsable();
 
-            var returnStandard = peptides.Where(_database.IsStandard).Distinct().ToArray();
+            var pepArr = peptides.ToArray();
+            var returnStandard = pepArr.Where(_database.IsStandard).Distinct().ToArray();
             var returnCount = returnStandard.Length;
             var databaseCount = _database.StandardPeptideCount;
 
             if (!IsAcceptableStandardCount(databaseCount, returnCount))
+            {
+                Console.Out.WriteLine(@""Database standards: {0}"", string.Join(@""; "", _database.StandardPeptides.Select(pep => pep.ToString())));
+                Console.Out.WriteLine(@""Chosen ({0}): {1}"", pepArr.Length, string.Join(@""; "", pepArr.Select(pep => pep.ToString())));
                 throw new IncompleteStandardException(this);
+            }
 
             minCount = MinStandardCount(databaseCount);
             return returnStandard;","The pep.ToString() is not necessary. You can just do: string.Join(@""; "", _database.StandardPeptides)",.cs,1,1,1
"@@ -100,8 +100,15 @@ namespace Nethermind.Runner.Ethereum.Steps
             _ctx.SyncPeerPool = new SyncPeerPool(_ctx.BlockTree, _ctx.NodeStatsManager, maxPeersCount, _ctx.LogManager);
             _ctx.DisposeStack.Push(_ctx.SyncPeerPool);
             
-            SyncProgressResolver syncProgressResolver = new SyncProgressResolver(_ctx.BlockTree, _ctx.ReceiptStorage, _ctx.DbProvider.StateDb, _syncConfig, _ctx.LogManager);
+            SyncProgressResolver syncProgressResolver = new SyncProgressResolver(_ctx.BlockTree, _ctx.ReceiptStorage, _ctx.DbProvider.StateDb, _ctx.DbProvider.BeamStateDb, _syncConfig, _ctx.LogManager);
             MultiSyncModeSelector syncModeSelector = new MultiSyncModeSelector(syncProgressResolver, _ctx.SyncPeerPool, _syncConfig, _ctx.LogManager);
+            if (_ctx.SyncModeSelector != null)
+            {
+                // this is really bad and is a result of lack of proper dependency management
+                PendingSyncModeSelector pendingOne = (PendingSyncModeSelector) _ctx.SyncModeSelector;
+                pendingOne.SetActual(syncModeSelector);
+            }
+            
             _ctx.SyncModeSelector = syncModeSelector;
             _ctx.DisposeStack.Push(syncModeSelector);
             ",maybe just inject delegate to BeaSyncDb in the first place? Or SyncModeSelectorSource ;),.cs,1,1,1
"@@ -86,6 +86,7 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Internal.Http
         public void Start()
         {
             Log.ConnectionStart(ConnectionId);
+            KestrelEventSource.Log.ConnectionStart(this);
 
             // Start socket prior to applying the ConnectionAdapter
             _socket.ReadStart(_allocCallback, _readCallback, this);",Can we move this into `KestrelTrace`?,.cs,1,0,1
"@@ -10,10 +10,13 @@ using Microsoft.AspNetCore.Server.Kestrel.Filter;
 using Microsoft.AspNetCore.Server.Kestrel.Filter.Internal;
 using Microsoft.AspNetCore.Server.Kestrel.Internal.Infrastructure;
 using Microsoft.AspNetCore.Server.Kestrel.Internal.Networking;
+using Microsoft.Extensions.Internal;
 using Microsoft.Extensions.Logging;
 
 namespace Microsoft.AspNetCore.Server.Kestrel.Internal.Http
 {
+    using System.IO.Pipelines;
+
     public class Connection : ConnectionContext, IConnectionControl
     {
         // Base32 encoding - in ascii sort order for easy text based sorting",nit: move `using` outside of namespace,.cs,1,1,1
"@@ -50,7 +50,7 @@ namespace NLog.UnitTests
         private string appConfigContents = @""
 <configuration>
 <configSections>
-    <section name='nlog' type='NLog.Config.ConfigSectionHandler, NLog' requirePermission='false' />
+    <section name='nlog' type='NLog.Config.XmlLoggingConfigurationSection, NLog' requirePermission='false' />
 </configSections>
 
 <nlog>",This seems not be backwards compatible. I think we should rename the class back to `ConfigSectionHandler`,.cs,1,1,1
"@@ -86,6 +86,12 @@ namespace Nethermind.Db.Config
         public uint EthRequestsDbWriteBufferNumber { get; set; } = 4;
         public ulong EthRequestsDbBlockCacheSize { get; set; } = 8.MB();
         public bool EthRequestsDbCacheIndexAndFilterBlocks { get; set; } = true;
+        
+        public ulong BloomDbWriteBufferSize { get; set; } = 1.KB();
+        public uint BloomDbWriteBufferNumber { get; set; } = 4;
+        public ulong BloomDbBlockCacheSize { get; set; } = 1.KB();
+        public bool BloomDbCacheIndexAndFilterBlocks { get; set; } = false;
+        
         public uint RecycleLogFileNum { get; set; } = 0;
         public bool WriteAheadLogSync { get; set; } = false;
     }",why so small?,.cs,1,0,1
"@@ -178,6 +178,16 @@ namespace OpenTelemetry.Metrics
                         }
                     }
                 };
+
+                // Everything double
+                this.listener.SetMeasurementEventCallback<double>((instrument, value, tags, state) => this.MeasurementRecordedDouble(instrument, value, tags, state));
+                this.listener.SetMeasurementEventCallback<float>((instrument, value, tags, state) => this.MeasurementRecordedDouble(instrument, value, tags, state));
+
+                // Everything long
+                this.listener.SetMeasurementEventCallback<long>((instrument, value, tags, state) => this.MeasurementRecordedLong(instrument, value, tags, state));
+                this.listener.SetMeasurementEventCallback<int>((instrument, value, tags, state) => this.MeasurementRecordedLong(instrument, value, tags, state));
+                this.listener.SetMeasurementEventCallback<short>((instrument, value, tags, state) => this.MeasurementRecordedLong(instrument, value, tags, state));
+                this.listener.SetMeasurementEventCallback<byte>((instrument, value, tags, state) => this.MeasurementRecordedLong(instrument, value, tags, state));
             }
             else
             {",if (metrics.Count ==1) { metrics[0].Update() } else { do foreach.. },.cs,1,0,0
"@@ -22,7 +22,7 @@ namespace Datadog.Trace.ClrProfiler.Integrations
         private const string HttpClientHandlerTypeName = ""HttpClientHandler"";
 
         private const string HttpMessageHandler = SystemNetHttp + ""."" + HttpMessageHandlerTypeName;
-        private const string HttpClientHandler = SystemNetHttp + ""."" + HttpClientHandlerTypeName;
+        private const string HttpClientHandlerConst = SystemNetHttp + ""."" + HttpClientHandlerTypeName;
         private const string SendAsync = ""SendAsync"";
 
         private static readonly Vendors.Serilog.ILogger Log = DatadogLogging.GetLogger(typeof(HttpMessageHandlerIntegration));","nit: should we rename both of these to `FooTypeFullName` to match the `FooTypeName` above? If I understand correctly, the difference is that these include the namespace with the name.",.cs,1,1,1
"@@ -89,5 +89,15 @@ namespace NLog.Targets
             QuoteKeys = true;
             MaxRecursionLimit = 10;
         }
+
+        /// <summary>Registers a type<see cref=""T:System.Type"" /> to be excluded from serialization.</summary>
+        public static void RegisterSerializationExclusion(Type t) => NLog.Internal.ObjectReflectionCache.SerializationExclusionList.Add(x => x == t);
+        /// <summary>Registers a type<see cref=""T:System.Type"" /> to be excluded from serialization.</summary>
+        public static void RegisterSerializationExclusion<T>() => NLog.Internal.ObjectReflectionCache.SerializationExclusionList.Add(x => x == typeof(T));
+        /// <summary>Registers a custom evaluation function to determine if a given type should be serialized.  If the func returns true, the object's ToString() will be invoked.  If false, the object will be serialized.</summary>
+        public static void RegisterSerializationExclusion(Func<Type, bool> func) => NLog.Internal.ObjectReflectionCache.SerializationExclusionList.Add(func);
+        /// <summary>Resets the list for custom serialization.</summary>
+        public static void ResetSerializationExclusions() => NLog.Internal.ObjectReflectionCache.SerializationExclusionList.Clear();
+
     }
 }","I don't believe these methods belong in this class, but I couldn't find a better class. Any suggestions?",.cs,1,1,1
"@@ -358,6 +358,11 @@ namespace NLog.Targets.Wrappers
         /// </summary>
         /// <returns>Returns true when scheduled a timer-worker-thread</returns>
         protected virtual bool StartInstantWriterTimer()
+        {
+            return StartTimerUnlessWriterActive(true);
+        }
+
+        private bool StartTimerUnlessWriterActive(bool instant)
         {
             bool lockTaken = false;
             try",shouldn't we return `true` here?,.cs,1,0,1
"@@ -91,7 +91,7 @@ namespace Microsoft.TestPlatform.TestUtilities
             get
             {
                 string value = string.Empty;
-                if (this.runningInCli)
+                if (this.runningInCli || true)
                 {
                     value = Path.Combine(
                         this.testPlatformRootDirectory,",Why is this change required?,.cs,1,0,1
"@@ -13,7 +13,7 @@ namespace MvvmCross.Platforms.Android.Views
         Intent GetIntentFor(MvxViewModelRequest request);
 
         // Important: if calling GetIntentWithKeyFor then you must later call RemoveSubViewModelWithKey on the returned key
-        Tuple<Intent, int> GetIntentWithKeyFor(IMvxViewModel existingViewModelToUse);
+        (Intent Intent, int Key) GetIntentWithKeyFor(IMvxViewModel existingViewModelToUse, MvxViewModelRequest request);
 
         void RemoveSubViewModelWithKey(int key);
     }",Please lowercase return names.,.cs,1,1,1
"@@ -0,0 +1,10 @@
+﻿namespace Microsoft.Azure.Cosmos.CosmosElements
+{
+    internal abstract class CosmosNull : CosmosElement
+    {
+        protected CosmosNull()
+            : base(CosmosElementType.Null)
+        {
+        }
+    }
+}",does this class (also Boolean) need to be abstract?,.cs,1,1,1
"@@ -36,13 +36,13 @@ namespace pwiz.Skyline.Model
         public abstract string[] FragmentIons { get; }
         public abstract string EngineName { get; }
         public abstract Bitmap SearchEngineLogo { get; }
-        protected MsDataFileUri[] SpectrumFileNames { get; set; }
+        public MsDataFileUri[] SpectrumFileNames { get; protected set; }
         protected string[] FastaFileNames { get; set; }
 
         /// <summary>
         /// A string or numeric variable with a default value and, for numeric types, min and max values.
         /// </summary>
-        public class Setting
+        public class Setting : IAuditLogObject
         {
             public Setting(string name, int defaultValue, int minValue, int maxValue)
             {","I am not an expert on audit log objects, but I was under the impression that if a class had a self-describing ToString method, it would not need to implement IAuditLogObject.",.cs,1,1,1
"@@ -59,7 +59,7 @@ namespace Microsoft.AspNet.Server.Kestrel.Http
 
                                 DispatchPipe.ReadStart(
                                     (_1, _2, _3) => buf,
-                                    (_1, status2, error2, state2) =>
+                                    (_1, status2, errCode, error2, state2) =>
                                     {
                                         if (status2 < 0)
                                         {","wtf is _1, status2, errCode, erro2, state2? I know we have nested lambdas by maybe this is a case for a method...",.cs,1,1,0
"@@ -0,0 +1,16 @@
+﻿using System;
+using MvvmCross.Core.ViewModels;
+
+namespace MvvmCross.Forms.Views.Hints
+{
+    public class MvxPopToRootPresentationHint
+        : MvxPresentationHint
+    {
+        public MvxPopToRootPresentationHint(bool animated = true)
+        {
+            Animated = animated;
+        }
+
+        public bool Animated { get; set; }
+    }
+}",Same about this presentation hint,.cs,0,0,1
"@@ -30,8 +30,8 @@ namespace OpenTelemetry.Trace
         private readonly ActivityListener listener;
         private readonly Resource resource;
         private readonly Sampler sampler;
+        private readonly ActivitySourceAdapter adapter;
         private BaseProcessor<Activity> processor;
-        private ActivitySourceAdapter adapter;
 
         static TracerProviderSdk()
         {","Unrelated, VS was suggesting to make `ActivitySourceAdapter` readonly so I cleaned it up.",.cs,0,0,1
"@@ -52,6 +52,8 @@ namespace Nethermind.Runner.Ethereum.Steps
 
                 JsonRpcService jsonRpcService = new(_api.RpcModuleProvider, _api.LogManager);
 
+                _api.EthereumJsonSerializer.RegisterConverters(jsonRpcService.Converters);
+                
                 JsonRpcProcessor jsonRpcProcessor = new(
                     jsonRpcService,
                     _api.EthereumJsonSerializer,",This change will register JSON RPC converters for the API serializer that is used in multiple places. Is it OK ? HTTP JSON RPC uses own instance of the serializer. Maybe we should do the same for the sockets or share the same instance with the HTTP module ?,.cs,1,1,1
"@@ -42,7 +42,7 @@ namespace OpenTelemetry.Trace
         /// <param name=""attributes"">Link attributes.</param>
         public Link(in SpanContext spanContext, SpanAttributes attributes)
         {
-            this.ActivityLink = new ActivityLink(spanContext.ActivityContext, attributes.Attributes);
+            this.ActivityLink = new ActivityLink(spanContext.ActivityContext, attributes?.Attributes ?? null);
         }
 
         /// <summary>","`?? null` is basically a noop :smile: `new ActivityLink(spanContext.ActivityContext, attributes?.Attributes);` should accomplish the same.",.cs,1,1,1
"@@ -186,6 +186,8 @@ namespace OpenTelemetry
             this.shutdownDrainTarget = this.circularBuffer.AddedCount;
             this.shutdownTrigger.Set();
 
+            OpenTelemetrySdkEventSource.Log.DroppedExportProcessorItems(this.GetType().Name, this.droppedCount);
+
             if (timeoutMilliseconds == Timeout.Infinite)
             {
                 this.exporterThread.Join();","this is not the exporter name. this'd be the name of the batchexportprocessor. Exporter example is ""OTLPExporter"", ""ZipkinExporter"" etc.",.cs,1,1,1
"@@ -420,6 +420,13 @@ namespace Datadog.Trace.Configuration
             /// </summary>
             /// <seealso cref=""TracerSettings.RouteTemplateResourceNamesEnabled""/>
             public const string RouteTemplateResourceNamesEnabled = ""DD_TRACE_ROUTE_TEMPLATE_RESOURCE_NAMES_ENABLED"";
+
+            /// <summary>
+            /// Feature Flag: disables the replacement of periods by underscores in header tags.
+            /// This is needed for compatibility with other tracers
+            /// </summary>
+            /// <seealso cref=""TracerSettings.LeavePeriodsInHeaderTags""/>
+            public const string LeavePeriodsInHeaderTags = ""DD_TRACE_LEAVE_PERIODS_IN_HEADER_TAGS"";
         }
     }
 }","The standard name for feature flags is `DD_TRACE_{0}_ENABLED`. I think we should probably call this `DD_TRACE_REPLACE_HEAD_TAG_PERIODS_ENABLED`. This moves from `leave` to `replace` because ""replace"" feels like a positive action which is preferable for booleans. The default would then be `true`, and customers can disable the flag. Not sure if everyone will agree with that though :D",.cs,1,1,1
"@@ -47,7 +47,7 @@ namespace TestPerf // Note: tests in the ""TestPerf"" namespace only run when the
         public void WatersIMSImportTest()
         {
             Log.AddMemoryAppender();
-            TestFilesZip = GetPerfTestDataURL(@""PerfImportResultsWatersIMS.zip"");
+            TestFilesZip = GetPerfTestDataURL(@""PerfImportResultsWatersIMSv2.zip""); // v2 has _func003.cdt file removed, to test our former assumption that lockmass would have IMS data if other functions did and vice verse
             TestFilesPersistent = new[] { ""ID12692_01_UCA168_3727_040714.raw"", ""ID12692_01_UCA168_3727_040714_IA_final_fragment.csv"" }; // List of files that we'd like to unzip alongside parent zipFile, and (re)use in place
 
             MsDataFileImpl.PerfUtilFactory.IssueDummyPerfUtils = false; // Turn on performance measurement",Does this leave other tests still testing that the lockmass-with-IMS test still works?,.cs,1,1,1
"@@ -188,12 +188,13 @@ namespace Microsoft.CodeAnalysis.Sarif.Converters
         {
             var context = TestHelper.CreateProjectContext();
 
-            context.RefineMessage(""CA0000"", ""VeryUsefulCheck"", ""1"", ""MyCategory"", ""Breaking"");
+            context.RefineMessage(""CA0000"", ""VeryUsefulCheck"", ""1"", ""MyCategory"", ""Breaking"", ""ExcludedInSource"");
             Assert.AreEqual(""CA0000"", context.CheckId);
             Assert.AreEqual(""1"", context.MessageId);
             Assert.AreEqual(""MyCategory"", context.Category);
             Assert.AreEqual(""VeryUsefulCheck"", context.Typename);
             Assert.AreEqual(""Breaking"", context.FixCategory);
+            Assert.AreEqual(""ExcludedInSource"", context.Status);
         }
 
         [TestMethod]","I thought we had names `""Unknown""`, `""SuppressedInSource""`, and `""SuppressedInBaseLine""`.",.cs,1,0,1
"@@ -29,7 +29,7 @@ namespace ScenarioMeasurement
         /// <param name=""logFileName"">optional log file. Default is appExe.startup.log</param>
         /// <param name=""workingDir"">optional working directory</param>
         /// <param name=""warmup"">enables/disables warmup iteration</param>
-        /// <param name=""traceFileName"">trace file name</param>
+        /// <param name=""traceName"">trace file name</param>
         /// <param name=""guiApp"">true: app under test is a GUI app, false: console</param>
         /// <param name=""skipProfileIteration"">true: skip full results iteration</param>
         /// <param name=""reportJsonPath"">path to save report json</param>",Did the semantics of this variable change or is this just a cosmetic change?,.cs,1,1,1
"@@ -24,6 +24,11 @@ namespace OpenTelemetry.Metrics
     {
         private string name;
 
+        public MetricConsoleExporter()
+            : this(string.Empty)
+        {
+        }
+
         public MetricConsoleExporter(string name)
         {
             this.name = name;",It is a bit confusing to have the exporter class derived from processor class. Not introduced by this PR so no need to block on it.,.cs,0,1,1
"@@ -892,7 +892,7 @@ namespace pwiz.Skyline.EditUI
                     Adduct.Tips;
             }
             // ReSharper restore LocalizableElement
-            MessageBox.Show(this, helpText, Resources.PasteDlg_btnTransitionListHelp_Click_Transition_List_Help);
+            MultiButtonMsgDlg.Show(this, helpText, MessageBoxButtons.OK, DialogResult.OK, Resources.PasteDlg_btnTransitionListHelp_Click_Transition_List_Help);
         }
 
         private void btnCancel_Click(object sender, EventArgs e)",Should be MessageDlg.Show(),.cs,1,0,1
"@@ -1,12 +1,19 @@
 // Copyright (c) .NET Foundation. All rights reserved.
 // Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.
 
+using System;
 using Microsoft.AspNetCore.Server.Kestrel.Filter;
 
 namespace Microsoft.AspNetCore.Server.Kestrel
 {
     public interface IKestrelServerInformation
     {
+        TimeSpan ExecutionTimeout { get; set; }
+
+        TimeSpan HeadersCompleteTimeout { get; set; }
+
+        TimeSpan KeepAliveTimeout { get; set; }
+
         int ThreadCount { get; set; }
 
         bool NoDelay { get; set; }","KeepAlive and HeadersComplete are reasonable, but I don't think we need or want ExecutionTimeout at the server level. A) The same functionality can be provided in app/middleware code. B) The timeout is un-enforceable. You can't force an app to abandon a request, you can only close the socket and trip the token. The RequestAborted CancellationToken is at best a hint. There are no thread aborts like v4. C) There are known scenarios this breaks with long running requests. It's one more setting on the server to hunt down and fiddle with when that happens.",.cs,1,1,0
"@@ -5,12 +5,13 @@ using System;
 using System.IO;
 using System.Threading;
 using System.Threading.Tasks;
-using Microsoft.Extensions.Internal;
 
 namespace Microsoft.AspNetCore.Server.Kestrel.Https.Internal
 {
     internal class ClosedStream : Stream
     {
+        private static readonly Task<int> CompletedIntTask = Task.FromResult(default(int));
+
         public override bool CanRead => true;
         public override bool CanSeek => false;
         public override bool CanWrite => false;",That's pretty weird isn't it? Its explicitly a zero return - rather than a `default(int)`; also `CompletedIntTask` doesn't really specify what it is.,.cs,1,1,1
"@@ -47,7 +47,7 @@ namespace pwiz.SkylineTestData
         {
             var testFilesDir = new TestFilesDir(TestContext, ZIP_PATH);
             string docPath = testFilesDir.GetTestPath(DOC_NAME);
-            string rawPath = testFilesDir.GetTestPath(WIFF_NAME);
+            string rawPath = testFilesDir.GetTestPath(WIFF_NAME) ?? string.Empty;
             
             RunCommand(""--in="" + docPath,
                 ""--import-file="" + rawPath,","I am really feeling like we need something better than just adding all these ?? string.Empty uses. Could we maybe add a function which would have an explanation of its use, like PathEx.SafePath(). It might not even have to use string.Empty but could just Assume.IsNotNull(path); return path; This would actually be better, because it is more explicit about what the expectation is. In these changes you are making, if you are wrong about the assumption, then the code will behave in strange unexpected ways.",.cs,1,1,0
"@@ -17,5 +17,6 @@ namespace Nevermind.Core
         public long GasUsed { get; set; }
         public Bloom Bloom { get; set; }
         public LogEntry[] Logs { get; set; }
+        public Address Recipient { get; set; }
     }
 }",need to learn more - this I guess is only in the network version but not in the one created by EVM,.cs,1,1,1
"@@ -40,6 +40,12 @@ namespace pwiz.Skyline.Model.Results
         public double? ExtractionWidth;
         public IonMobilityFilter _ionMobilityInfo;
         public Identity Id;  // ID of the associated TransitionDocNode
+
+        public bool MatchMz(double mz)
+        {
+            return mz > ProductMz.Value - ExtractionWidth / 2 &&
+                   mz <= ProductMz.Value + ExtractionWidth / 2;
+        }
     }
 
     public interface IScanProvider : IDisposable","This needs to be the same as the logic that's in ""SpectrumFilterPair.FilterSpectrumList"". I think that logic would be ""mz >= ProductMz.Value - ExtractionWidth / 2 && mz < ProductMz.Value + ExtractionWidth / 2""; because of that ""mzArray[iNext] < endFilter"" in FilterSpectrumList",.cs,1,1,1
"@@ -0,0 +1,14 @@
+// <copyright file=""OSPlatforms.cs"" company=""Datadog"">
+// Unless explicitly stated otherwise all files in this repository are licensed under the Apache 2 License.
+// This product includes software developed at Datadog (https://www.datadoghq.com/). Copyright 2017 Datadog, Inc.
+// </copyright>
+
+namespace Datadog.Trace
+{
+    internal static class OSPlatforms
+    {
+        public const string Windows = ""Windows"";
+        public const string Linux = ""Linux"";
+        public const string MacOS = ""MacOS"";
+    }
+}","Really small nit, I suggest removing the ""s"" so it's singular: `OSPlatform`",.cs,1,1,1
"@@ -1,9 +1,7 @@
 #if !NETSTANDARD2_0
 
 using System;
-using System.Diagnostics.CodeAnalysis;
 using System.Web;
-using Datadog.Trace.ClrProfiler.Emit;
 using Datadog.Trace.Logging;
 
 namespace Datadog.Trace.ClrProfiler.Integrations",Let's delete this file. We're not using `AspNetIntegration`.,.cs,1,1,1
"@@ -4,13 +4,12 @@
 
 using System;
 using System.Reflection;
-using System.Threading.Tasks;
 using MvvmCross.Exceptions;
 using MvvmCross.Logging;
 
 namespace MvvmCross.Base
 {
-    public abstract class MvxMainThreadDispatcher : MvxSingleton<IMvxMainThreadDispatcher>, IMvxMainThreadDispatcher
+    public class MvxMainThreadDispatcher : MvxSingleton<IMvxMainThreadDispatcher>, IMvxMainThreadDispatcher
     {
         protected static void ExceptionMaskedAction(Action action, bool maskExceptions)
         {",Please leave as abstract,.cs,1,0,1
"@@ -0,0 +1,9 @@
+﻿namespace Nevermind.Json
+{
+    public interface IJsonSerializer
+    {
+        T DeserializeAnonymousType<T>(string json, T definition);
+        T DeserializeObject<T>(string json);
+        string SerializeObject<T>(T value);
+    }
+}","let us review if the test projects should use this as well, might be that a similar interface is already in test namespaces",.cs,1,1,1
"@@ -84,7 +84,7 @@ namespace Nethermind.Core.Test
 
         [Test]
         [Retry(3)]
-        public async Task Update_twice_current_per_second()
+        public void Update_twice_current_per_second()
         {
             ManualTimestamper manualTimestamper = new ManualTimestamper();
             MeasuredProgress measuredProgress = new MeasuredProgress(manualTimestamper);","This silences warnings about async functions without an await. I saw some other tests that were void returning instead of `async Task` returning, so I think that is acceptable from a style standpoint.",.cs,1,1,1
"@@ -34,7 +34,8 @@ namespace Microsoft.CodeAnalysis.Sarif.Writers
         [TestMethod]
         public void ResultLogJsonWriter_DefaultIsEmpty()
         {
-            Assert.AreEqual(String.Empty, GetJson(delegate { }));
+            string expected = @""{""""version"""":""""1.0.0-beta.1"""",""""runLogs"""":[{}]}"";
+            Assert.AreEqual(expected, GetJson(delegate { }));
         }
 
         [TestMethod]","Is it ""beta.1""? I thought we were now ""beta.2"" after the big-breaking-change.",.cs,1,1,1
"@@ -0,0 +1,17 @@
+// Copyright (c) Microsoft.  All Rights Reserved.
+// Licensed under the Apache License, Version 2.0.  See License.txt in the project root for license information.
+
+using System.CodeDom.Compiler;
+
+namespace Microsoft.CodeAnalysis.Sarif
+{
+    /// <summary>
+    /// Indicates whether a result has been suppressed in source (or if that information is unknown).
+    /// </summary>
+    [GeneratedCode(""Microsoft.Json.Schema.ToDotNet"", ""0.16.0.0"")]
+    public enum IsSuppressedInSource
+    {
+        Unknown,
+        True,False
+    }
+}","I'm intrigued that the code gen put those on the same line. Not crazy about the names. How about: type = SourceSuppressionState, with values Unknown, Suppressed, NotSuppressed?",.cs,1,1,1
"@@ -0,0 +1,13 @@
+using Nethermind.Abi;
+
+namespace Nethermind.Baseline
+{
+    public static class ContractMerkleTree
+    {
+        public static readonly AbiSignature InsertLeafAbiSig = new AbiSignature(""insertLeaf"",
+            new AbiBytes(32)); // leafValue
+        
+        public static AbiSignature InsertLeavesAbiSig = new AbiSignature(""insertLeaves"",
+            new AbiArray(new AbiBytes(32))); // leafValues
+    }
+}",I suggest using AbiDefinition and parsing json ABI like in Contracts in AuRa,.cs,1,1,1
"@@ -26,9 +26,10 @@ namespace DockerHarness
         }
     }
 
-    // A simple class for escaping strings for CSV writing
-    // https://stackoverflow.com/a/769713
-    // Used instead of a package because only these < 20 lines of code are needed
+    /// <summary>
+    ///   A simple class for escaping strings for CSV writing
+    ///   https://stackoverflow.com/a/769713
+    /// </summary>
     internal static class Csv
     {
         public static string Escape(string s)",">internal static class Csv [](start = 4, length = 25) Can we use an existing Csv parser instead of creating our own?",.cs,1,1,1
"@@ -1,4 +1,4 @@
-﻿#if NETSTANDARD && !NETSTANDARD1_3
+﻿#if NETSTANDARD && UWP10
 using System;
 using System.Collections.Generic;
 using System.IO;",UWP10 isn't necessary anymore?,.cs,1,0,1
"@@ -3,8 +3,9 @@
 // See the LICENSE file in the project root for more information.
 
 using System;
-using System.Collections.Generic;
 using System.IO;
+using System.Text;
+using System.Threading;
 using Microsoft.Build.Framework;
 using Microsoft.Build.Utilities;
 using Newtonsoft.Json;",You can probably revert this whole file. None of the changes here look substantive.,.cs,1,1,1
"@@ -61,6 +61,11 @@ namespace Datadog.Trace.Agent
             }
         }
 
+        public Task FlushAsync()
+        {
+            return FlushTracesAsync();
+        }
+
         public async Task FlushAndCloseAsync()
         {
             if (!_processExit.TrySetResult(true))","Any reason you did just make `FlushTracesAsync()` public? The class is internal, so I don't think we need to worry about exposing it as a public API.",.cs,1,1,1
"@@ -174,7 +174,11 @@ namespace Microsoft.CodeAnalysis.Sarif
             }
         }
 
-        public static string GetMessageText(this Result result, IRule rule, bool concise = false)
+        public static string GetMessageText(this Result result, IRule rule)
+        {
+            return GetMessageText(result, rule, concise: false);
+        }
+        public static string GetMessageText(this Result result, IRule rule, bool concise)
         {
             if (result == null)
             {",The purpose is to allow the _caller_ to pass in `consise = true;`. I'll come see you about this one.,.cs,0,0,1
"@@ -0,0 +1,18 @@
+namespace Datadog.Trace
+{
+    /// <summary>
+    /// Contains a set of standard operation names that can be used by integrations.
+    /// </summary>
+    public static class OperationNames
+    {
+        /// <summary>
+        /// Gets the operation name for an ASP.NET MVC web request.
+        /// </summary>
+        public static string AspNetMvcRequest => ""aspnet_mvc.request"";
+
+        /// <summary>
+        /// Gets the operation name for an ASP.NET Core MVC web request.
+        /// </summary>
+        public static string AspNetCoreMvcRequest => ""aspnet_core_mvc.request"";
+    }
+}","This is really integration specific, would it make more sense to have it as a constant in the integration itself?",.cs,1,1,1
"@@ -147,8 +147,8 @@ namespace Nethermind.Blockchain.Synchronization
             receipt.TxHash = transaction.Hash;
             receipt.Index = transactionIndex;
             receipt.Sender = transaction.SenderAddress;
-            receipt.Recipient = transaction.IsContractCreation ? null : transaction.To;
-            receipt.ContractAddress = transaction.IsContractCreation ? transaction.To : null;
+            receipt.Recipient = transaction.GetRecipient();
+            receipt.ContractAddress = transaction.GetCreatedContract();
             receipt.GasUsed = receipt.GasUsedTotal - gasUsedBefore;
             if (receipt.StatusCode != StatusCode.Success)
             {",this is actually all incorrect here for created contract - created contract is not the To field,.cs,1,1,1
"@@ -362,6 +362,11 @@ namespace Samples.Elasticsearch.V5
             task.GetAwaiter().GetResult();
             var taskType = task.GetType();
 
+            while (!taskType.Name.StartsWith(""Task""))
+            {
+                taskType = taskType.BaseType;
+            }
+
             bool isTaskOfT = taskType.IsGenericType &&
                              taskType.GetGenericTypeDefinition() == typeof(Task<>);
 ",What types show up here that we need this check? Just curious.,.cs,1,1,1
"@@ -78,8 +78,9 @@ namespace NLog.Internal
         /// </summary>
         /// <param name=""exception"">The exception to check.</param>
         /// <param name=""loggerContext"">Target context of the exception.</param>
+        /// <param name=""logFactory"">For checking <see cref=""LogFactory.ThrowExceptions""/> and <see cref=""LogFactory.ThrowConfigExceptions""/>. Falls back to <see cref=""LogManager""/> </param>
         /// <returns><c>true</c>if the <paramref name=""exception""/> must be rethrown, <c>false</c> otherwise.</returns>
-        public static bool MustBeRethrown(this Exception exception, IInternalLoggerContext loggerContext = null)
+        public static bool MustBeRethrown(this Exception exception, IInternalLoggerContext loggerContext = null, LogFactory logFactory = null)
         {
             if (exception.MustBeRethrownImmediately())
             {","Maybe add LoggingConfiguration as property to `IInternalLoggerContext`, and then extract the LogFactory from that? When InternalLogger-logging is improved with Nlog 5, then it will all work automagically.",.cs,1,1,1
"@@ -85,7 +85,7 @@ CLI access is not currently included in the Nethermind launcher but will be adde
 
             Console.WriteLine(result);
             File.WriteAllText(""cli.rst"", result);
-            File.WriteAllText(""../../../../../../docs/source/cli.rst"", result);
+            File.WriteAllText(""../../../docs/source/cli.rst"", result);
         }
     }
 }",why did you need to change the folder structure? will it still work when invoked manually?,.cs,1,1,1
"@@ -38,7 +38,16 @@ namespace OpenTelemetry.Trace
                 throw new ArgumentNullException(nameof(builder));
             }
 
-            var exporterOptions = new JaegerExporterOptions();
+            JaegerExporterOptions exporterOptions;
+            if (builder is IResolvingTracerProviderBuilder resolvingTracerProviderBuilder)
+            {
+                exporterOptions = resolvingTracerProviderBuilder.ResolveOptions<JaegerExporterOptions>();
+            }
+            else
+            {
+                exporterOptions = new JaegerExporterOptions();
+            }
+
             configure?.Invoke(exporterOptions);
             var jaegerExporter = new JaegerExporter(exporterOptions);
 ",Here is an example of how something like JaegerExporter can use IResolvingTracerProviderBuilder to inject options.,.cs,1,1,1
"@@ -15,7 +15,14 @@ namespace System.Diagnostics
         
         [Benchmark]
         public void GetCurrentProcess() => Process.GetCurrentProcess().Dispose();
-        
+
+        [Benchmark]
+        public string GetCurrentProcessName()
+        {
+            using var process = Process.GetCurrentProcess();
+            return process.ProcessName;
+        }
+
         [GlobalSetup(Target = nameof(GetProcessById))]
         public void SetupGetProcessById() => _currentProcessId = Process.GetCurrentProcess().Id;
         ",should we be including the cost of Dispose()? it does do some work but perhaps it's not significant. although I see the test above is doing that too.,.cs,1,1,1
"@@ -92,7 +92,7 @@ namespace pwiz.SkylineTestTutorial
         {
             // Lest we get ""To export a scheduled method, you must first choose a retention time predictor in Peptide Settings / Prediction, or import results for all peptides in the document.""
             TestSmallMolecules = false;
-
+            Settings.Default.AuditLogging = true;
             // Skyline Collision Energy Optimization
             RunUI(() => SkylineWindow.OpenFile(GetTestPath(""CE_Vantage_15mTorr.sky""))); // Not L10N
 ",Why do some tutorial tests have to set this an not others?,.cs,0,1,1
"@@ -461,6 +461,11 @@ namespace Nethermind.TxPool
             return transaction != null;
         }
 
+        public bool IsTransactionKnown(Keccak hash)
+        {
+            return _hashCache.Get(hash);
+        }
+
         // TODO: Ensure that nonce is always valid in case of sending own transactions from different nodes.
         public UInt256 ReserveOwnTransactionNonce(Address address)
         {",Now good question. Is know would be hashCashe? Or maybe we should only check actual held transactions? Or maybe we should also check DB?,.cs,1,1,0
"@@ -49,7 +49,11 @@ namespace Examples.Console
             */
             using var meterProvider = Sdk.CreateMeterProviderBuilder()
                 .AddSource(""TestMeter"")
-                .AddPrometheusExporter(opt => opt.Url = $""http://localhost:{port}/metrics/"")
+                .AddPrometheusExporter(opt =>
+                {
+                    opt.StartHttpListener = true;
+                    opt.HttpListenerPrefixes = new string[] { $""http://*:{port}/"" };
+                })
                 .Build();
 
             ObservableGauge<long> gauge = MyMeter.CreateObservableGauge<long>(","nit: there is a message printed to console showing the path where metrics is available, which still has /metrics in it..",.cs,1,1,1
"@@ -1,15 +1,16 @@
 ﻿// Copyright (c) Microsoft Open Technologies, Inc. All rights reserved.
 // Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.
 
-using System;
-using System.Collections.Generic;
-using System.Threading.Tasks;
 using Microsoft.AspNet.Builder;
 using Microsoft.AspNet.FeatureModel;
 using Microsoft.AspNet.Hosting.Server;
 using Microsoft.AspNet.Server.Kestrel;
 using Microsoft.Framework.ConfigurationModel;
+using Microsoft.Framework.Logging;
 using Microsoft.Framework.Runtime;
+using System;
+using System.Collections.Generic;
+using System.Threading.Tasks;
 
 namespace Kestrel
 {",This is the wrong sort order for usings.,.cs,1,0,1
"@@ -150,7 +150,8 @@ namespace Datadog.Trace.TestHelpers
             int aspNetCorePort,
             int? statsdPort,
             string processPath,
-            StringDictionary environmentVariables)
+            StringDictionary environmentVariables,
+            bool ignoringProfilerProcesses = false)
         {
             var processName = processPath;
             string profilerEnabled = _requiresProfiling ? ""1"" : ""0"";","nit: should this be a command, ie. `ignoreProfilerProcesses`?",.cs,1,1,1
"@@ -164,7 +164,7 @@ namespace OpenTelemetry.Instrumentation.AspNetCore.Tests
                 var response = await client.GetAsync(""/api/values/2"");
                 response.EnsureSuccessStatusCode(); // Status Code 200-299
 
-                WaitForProcessorInvocations(spanProcessor, 4);
+                WaitForProcessorInvocations(spanProcessor, 2);
             }
 
             // begin and end was called once each.",I'm probably just missing it... but what accounted for this change?,.cs,1,0,1
"@@ -77,7 +77,7 @@ namespace Examples.Console
                 providerBuilder
                     .AddConsoleExporter(o =>
                     {
-                        o.MetricExportIntervalMilliseconds = options.DefaultCollectionPeriodMilliseconds;
+                        o.PeriodicExportingMetricReaderOptions.ExportIntervalMilliseconds = options.DefaultCollectionPeriodMilliseconds;
                         o.AggregationTemporality = options.IsDelta ? AggregationTemporality.Delta : AggregationTemporality.Cumulative;
                     });
             }",we need to set ReaderType to be periodic for this to take effect?,.cs,1,1,1
"@@ -40,6 +40,8 @@ namespace Nethermind.State
         
         Keccak GetCodeHash(Address address);
 
+        public bool IsContract(Address address) => GetCodeHash(address) != Keccak.OfAnEmptyString;
+
         void Accept(ITreeVisitor visitor, Keccak stateRoot);
         
         bool AccountExists(Address address);","this is generally not true, it is possible to deploy a contract with an empty code There should be a method called HasCode?",.cs,1,1,0
"@@ -0,0 +1,11 @@
+using Xamarin.Forms;
+
+[assembly: XmlnsDefinition(""http://mvvmcross.com/bind"", nameof(MvvmCross.Forms.Bindings))]
+[assembly: XmlnsDefinition(""http://mvvmcross.com/bind"", nameof(MvvmCross.Forms.Converters))]
+[assembly: XmlnsDefinition(""http://mvvmcross.com/bind"", nameof(MvvmCross.Forms.Views))]
+namespace MvvmCross.Forms
+{
+    internal class AssemblyInfo
+    {
+    }
+}",This won't work unless you also tell msbuild not to generate its own default AssemblyInfo file. Can we add these assembly things elsewhere?,.cs,1,1,1
"@@ -18,6 +18,7 @@
  */
 
 using System;
+using System.Globalization;
 using System.IO;
 using System.Linq;
 using System.Windows.Forms;",This is causing a code inspection failure.,.cs,1,1,1
"@@ -116,6 +116,11 @@ namespace OpenTelemetry.Trace
                 + ""}"";
         }
 
+        public override Type GetType()
+        {
+            return this.GetType();
+        }
+
         /// <inheritdoc/>
         public override TReturn Match<TReturn>(
             Func<string, TReturn> stringFunction,",is this needed?,.cs,1,0,0
"@@ -60,7 +60,10 @@ namespace MvvmCross.Forms.Platform.Ios.Core
                     Xamarin.Forms.Forms.Init();
                 if (_formsApplication == null)
                 {
-                    _formsApplication = _formsApplication ?? CreateFormsApplication();
+                    _formsApplication = CreateFormsApplication();
+                }
+                if (Application.Current != _formsApplication) {
+                    Application.Current = _formsApplication;
                 }
                 return _formsApplication;
             }",`{` should be placed in a new line,.cs,1,1,1
"@@ -331,6 +331,7 @@ namespace NLog.UnitTests.Layouts
                         new CsvColumn(""date"", ""${longdate}""),
                         new CsvColumn(""level"", ""${level}""),
                         new CsvColumn(""message"", ""${message}""),
+                        new CsvColumn(""threadid"", ""${threadid}""),
                     },
                 QuoteChar = ""'"",
                 Delimiter = CsvColumnDelimiterMode.Semicolon,",was a new unit test not a better option?,.cs,1,0,1
"@@ -61,7 +61,7 @@ namespace System.Text.Json.Tests
             }
         }
 
-        private static ReadOnlySequence<byte> GetSequence(byte[] dataUtf8, int segmentSize)
+        internal static ReadOnlySequence<byte> GetSequence(byte[] dataUtf8, int segmentSize)
         {
             int numberOfSegments = dataUtf8.Length / segmentSize + 1;
             byte[][] buffers = new byte[numberOfSegments][];",good idea to reuse the existing code!,.cs,1,0,1
"@@ -29,6 +29,8 @@ namespace Microsoft.DotNet.Build.Tasks
             }
         }
 
+        public bool GenerateLegacyDepsJson { get; set; }
+
         public string RuntimeDirectory { get; set; }
 
         public ITaskItem[] DepsExceptions { get; set; }",If we want to be backwards compatible then we need to reverse the default.,.cs,1,1,1
"@@ -1,10 +1,11 @@
 ﻿using Microsoft.Diagnostics.Tracing.Parsers;
-using Microsoft.Diagnostics.Tracing.Session;
 using Reporting;
 using System;
 using System.Collections.Generic;
+using System.Diagnostics;
 using System.IO;
 using System.Linq;
+using System.Runtime.CompilerServices;
 
 namespace ScenarioMeasurement
 {",What uses these new usings? Not seeing it in the code immediately..,.cs,1,1,1
"@@ -63,7 +63,7 @@ namespace System.Text.Json.Document.Tests
             int arrayLength = _element.GetArrayLength();
             for (int j = 0; j < arrayLength; j++)
             {
-                JsonElement dummy = _element[j];
+                _ = _element[j];
             }
         }
     }",Will this still work in 3.1 and 5.0? I don't remember what version of C# this is from.,.cs,1,1,1
"@@ -55,7 +55,7 @@ namespace OpenTelemetry.Exporter.OpenTelemetryProtocol.Implementation.ExportClie
             }
             catch (HttpRequestException ex)
             {
-                OpenTelemetryProtocolExporterEventSource.Log.FailedToReachCollector(ex);
+                OpenTelemetryProtocolExporterEventSource.Log.FailedToReachCollector(this.Options.Endpoint, ex);
 
                 return false;
             }",I'm assuming it's always present but happy to make it nullable and make it conditional,.cs,1,1,1
"@@ -66,7 +66,7 @@ namespace MvvmCross.Droid.Views
             onGlobalLayout = (sender, args) =>
             {
                 view.ViewTreeObserver.GlobalLayout -= onGlobalLayout;
-                ViewModel.Appeared();
+                ViewModel?.Appeared();
             };
 
             view.ViewTreeObserver.GlobalLayout += onGlobalLayout;",We might need to add those null checks on iOS and Windows as well.,.cs,1,1,1
"@@ -44,12 +44,6 @@ namespace OpenTelemetry.Instrumentation.Http
         {
             var originalString = requestUri.OriginalString;
 
-            // zipkin
-            if (originalString.Contains("":9411/api/v2/spans""))
-            {
-                return true;
-            }
-
             // applicationinsights
             if (originalString.StartsWith(""https://dc.services.visualstudio"") ||
                 originalString.StartsWith(""https://rt.services.visualstudio"") ||","I did a quick manual test with Zipkin, so I removed this filter.",.cs,0,0,1
"@@ -499,7 +499,14 @@ namespace pwiz.Skyline.Model
             var transitionsUnranked = new List<DocNode>();
             foreach (var peak in spectrum.Peaks)
             {
-                transitionsUnranked.Add(TransitionFromPeakAndAnnotations(key, nodeGroupMatched, fragmentCharge, peak, null));
+                try
+                {
+                    transitionsUnranked.Add(TransitionFromPeakAndAnnotations(key, nodeGroupMatched, fragmentCharge, peak, null));
+                }
+                catch (InvalidDataException)
+                {
+                    // Some kind of garbage in peaklist, e.g fragment mass is absurdly small or large - ignore
+                }
             }
             var nodeGroupUnranked = (TransitionGroupDocNode) nodeGroupMatched.ChangeChildren(transitionsUnranked);
             // Filter again, retain only those with rank info,  or at least an interesting name","This call should be paying attention to settings and the minimum value that causes the exception reported to initiate this fix. For peptide fragment annotation, we definitely consider the settings, and since we do not rank fragments outside the instrument range. This code also strikes me as odd that you wouldn't just create the precursor and then use a precursor.ChangeSettings(Settings, diff ?? SrmSettingsDiff.ALL) to materialize all of the transitions based on the settings. That way you only write the code once to materialize transitions based on settings.",.cs,1,1,0
"@@ -30,5 +30,15 @@ namespace OpenTelemetry.Trace.Sampler
         /// Gets the sampler than never samples.
         /// </summary>
         public static ISampler NeverSample { get; } = new Internal.NeverSampleSampler();
+
+        /// <summary>
+        /// Gets the always on sampling decision.
+        /// </summary>
+        public static Decision AlwaysOnDecision { get; } = new Decision(true);
+
+        /// <summary>
+        /// Gets the always off sampling decision.
+        /// </summary>
+        public static Decision AlwaysOffDecision { get; } = new Decision(false);
     }
 }","nit: this is a single decision, it's not 'AlwaysOn', maybe we can do 'SampledIn'? Or since it's a struct, it't cheap to always do `new Decision(true)` without having static preconfigured value",.cs,1,1,1
"@@ -176,15 +176,10 @@ namespace Nethermind.Synchronization.FastBlocks
                 }
                 else
                 {
-                    Keccak receiptsRoot = new ReceiptTrie(blockInfo.BlockNumber, _specProvider, receipts).RootHash;
-                    if (receiptsRoot != header.ReceiptsRoot)
-                    {
-                        preparedReceipts = null;
-                    }
-                    else
-                    {
-                        preparedReceipts = receipts;
-                    }
+                    IReleaseSpec releaseSpec = _specProvider.GetSpec(blockInfo.BlockNumber);
+                    preparedReceipts = releaseSpec.ValidateReceipts && new ReceiptTrie(releaseSpec, receipts).RootHash != header.ReceiptsRoot 
+                        ? null 
+                        : receipts;
                 }
             }
 ",we cannot simply not validate receipts - very dangerous - can we discuss more,.cs,1,0,0
"@@ -31,7 +31,7 @@
 // THE POSSIBILITY OF SUCH DAMAGE.
 // 
 
-#if !SILVERLIGHT && !NETSTANDARD || NETSTANDARD1_3PLUS
+#if !SILVERLIGHT && !NETSTANDARD
 
 namespace NLog.LayoutRenderers
 {",Isn't this a quick fix? Disabling the code?,.cs,1,0,1
"@@ -19,7 +19,13 @@ namespace Datadog.Trace.ClrProfiler.Managed.Loader
         private static string ResolveManagedProfilerDirectory()
         {
             string tracerFrameworkDirectory = ""netstandard2.0"";
-            var tracerHomeDirectory = Environment.GetEnvironmentVariable(""DD_DOTNET_TRACER_HOME"") ?? string.Empty;
+
+            var tracerHomeDirectory = Environment.GetEnvironmentVariable(""DD_DOTNET_TRACER_HOME"");
+            if (string.IsNullOrWhiteSpace(tracerHomeDirectory))
+            {
+                tracerHomeDirectory = Path.GetDirectoryName(Environment.GetEnvironmentVariable(""DD_INTEGRATIONS"")) ?? string.Empty;
+            }
+
             return Path.Combine(tracerHomeDirectory, tracerFrameworkDirectory);
         }
 ",.NET Core: Fallback to `DD_INTEGRATIONS` if `DD_DOTNET_TRACER_HOME` was not set.,.cs,1,1,1
"@@ -43,7 +43,9 @@ namespace Microsoft.DotNet.Build.Tasks.Feed
 
         public void LogError(string data)
         {
-            _log.LogError(data);
+            // There are cases where Sleet fails and we retry on our side causing things to actually work but if Sleet logs an error the whole build leg
+            // is marked as failed even though it actually succeeded, hence we log a warning here but we will log an error if the retry did not help
+            _log.LogWarning(data);
         }
 
         public void LogInformation(string data)",I meant something should be added in the warning message to alert anyone trying to diagnose sleet errors that show up as warnings.,.cs,1,1,1
"@@ -27,7 +27,7 @@ namespace Nethermind.Network.Enr;
 /// </summary>
 public class NodeRecord
 {
-    private int _enrSequence;
+    private long _enrSequence;
 
     private string? _enrString;
 ","Below: return string.Concat(""enr:"", Convert.ToBase64String(rlpData).Replace(""+"", ""-"").Replace(""/"", ""_"").Replace(""="", """")); Better with StringBuilder? Also why do we have GetValue and GetRef doing baiscally the same?",.cs,1,1,1
"@@ -389,6 +389,7 @@ namespace NLog.UnitTests.Config
                 Assert.NotEmpty(fileLocations);
                 Assert.NotNull(fileLocations[0].Key);
                 Assert.NotNull(fileLocations[0].Value); // Primary search location is NLog-assembly
+                Assert.Equal(fileLocations.Length, fileLocations.Select(f => f.Key).Distinct().Count());
 
                 var configuration = CreateConfigurationFromString(@""
 <nlog throwExceptions='true'>","another option is to group-by and check if there aren't duplicate items, isn't?",.cs,1,1,1
"@@ -96,9 +96,10 @@ namespace MvvmCross.Droid.Support.V7.AppCompat
         
         protected virtual void RunAppStart(Bundle bundle)
         {
-            var startup = Mvx.IoCProvider.Resolve<IMvxAppStart>();
-            if (!startup.IsStarted)
+            if (Mvx.IoCProvider.TryResolve(out IMvxAppStart startup) && !startup.IsStarted)
+            {
                 startup.Start(GetAppStartHint(bundle));
+            }
         }
 
         protected virtual object GetAppStartHint(object hint = null)",Why are we using TryResolve here - is it safe for RunAppStart to be invoked when we're not able to resolve IMvxAppStart? Not throwing an exception here isn't as bad as not throwing an exception and not reporting to developer that mvx wasn't able to locate AppStart. Unless I'm missing a scenario where this is valid?,.cs,1,1,1
"@@ -34,8 +34,8 @@ namespace Datadog.Trace.DiagnosticListeners
         private static readonly PropertyFetcher HttpRequestInStopHttpContextFetcher = new PropertyFetcher(""HttpContext"");
         private static readonly PropertyFetcher UnhandledExceptionHttpContextFetcher = new PropertyFetcher(""HttpContext"");
         private static readonly PropertyFetcher UnhandledExceptionExceptionFetcher = new PropertyFetcher(""Exception"");
-        private static readonly PropertyFetcher BeforeActionHttpContextFetcher = new PropertyFetcher(""HttpContext"");
-        private static readonly PropertyFetcher BeforeActionActionDescriptorFetcher = new PropertyFetcher(""ActionDescriptor"");
+        private static readonly PropertyFetcher BeforeActionHttpContextFetcher = new PropertyFetcher(""httpContext"");
+        private static readonly PropertyFetcher BeforeActionActionDescriptorFetcher = new PropertyFetcher(""actionDescriptor"");
 
         private readonly IDatadogTracer _tracer;
         private readonly AspNetCoreDiagnosticOptions _options;","This seems unrelated, what's the deal here? Was this a bug?",.cs,1,1,1
"@@ -24,12 +24,13 @@ public class Program
 
     public static void Main()
     {
-        using var tracerProvider = Sdk.CreateTracerProvider(
+        using var tracerProvider = Sdk.CreateTracerProviderBuilder()
+            .AddActivitySources(
             new string[]
             {
                 ""MyCompany.MyProduct.MyLibrary"",
             })
-            .AddMyExporter();
+            .Build().AddMyExporter();
 
         using (var activity = MyActivitySource.StartActivity(""SayHello""))
         {","I know you can add exporter after build, but hey  ",.cs,1,0,0
"@@ -33,7 +33,7 @@ namespace Microsoft.AspNet.Server.Kestrel
                 }
                 if (Libuv.IsWindows)
                 {
-                    var architecture = IntPtr.Size == 4
+                    var architecture = Environment.Is64BitProcess
                         ? ""x86""
                         : ""amd64"";
 ","This is wrong, it either needs to be `!Environment.Is64BitProcess` or switch x86 and amd64.",.cs,1,1,1
"@@ -0,0 +1,15 @@
+using Nethermind.Int256;
+
+namespace Nethermind.JsonRpc.Modules.Eth
+{
+    public static class EthGasPriceConstants
+    {
+        public const int PercentileOfSortedTxs = 60; //Percentile of sortedTxList indexes to choose as gas price
+        public const int DefaultBlocksLimit = 20; //Limit for how many blocks we check txs in to add to sortedTxList
+        public const int DefaultGasPrice = 1; //Tx price added to sortedTxList for a block that has 0 txs (now adds 1 price)
+        public const int SoftTxLimit = 40; //If a block adds only 1 tx price, the block is not counted towards BlocksLimit if sortedTxList.Count() + blocksLeftToCheck <= SoftTxLimit (after price is added to sortedTxList) 
+        public const int DefaultBaseFee = 200; //Minimum price a transaction sender has to pay
+        public const int TxLimitFromABlock = 3; //Maximum number of tx we can add to sortedTxList from one block
+        public static readonly UInt256 _maxGasPrice = 500; //Maximum gas price we can return
+    }
+}",Why DefaultBaseFee = 200? Why _maxGasPrice = 500? Where did you find these consts?,.cs,1,1,1
"@@ -52,6 +52,7 @@ namespace NLog.UnitTests.Targets
     using NLog.Internal;
     using NLog.LayoutRenderers;
 
+    [System.Runtime.InteropServices.GuidAttribute(""FF35CCD9-C7C7-4E3F-9194-3C3076DA3B7C"")]
     public class FileTargetTests : NLogTestBase
     {
         private readonly ILogger logger = LogManager.GetLogger(""NLog.UnitTests.Targets.FileTargetTests"");",Why is this needed?,.cs,1,0,1
"@@ -94,6 +94,7 @@ namespace Datadog.Trace.AppSec
                     if (_waf != null)
                     {
                         _instrumentationGateway.InstrumentationGatewayEvent += InstrumentationGatewayInstrumentationGatewayEvent;
+                        Log.Information(""DDAS-0014-00: AppSec has started"");
                     }
                     else
                     {",Definitely Info? Do we always want to write here?,.cs,1,1,1
"@@ -1,16 +1,16 @@
 //  Copyright (c) 2018 Demerzel Solutions Limited
 //  This file is part of the Nethermind library.
-// 
+//
 //  The Nethermind library is free software: you can redistribute it and/or modify
 //  it under the terms of the GNU Lesser General Public License as published by
 //  the Free Software Foundation, either version 3 of the License, or
 //  (at your option) any later version.
-// 
+//
 //  The Nethermind library is distributed in the hope that it will be useful,
 //  but WITHOUT ANY WARRANTY; without even the implied warranty of
 //  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 //  GNU Lesser General Public License for more details.
-// 
+//
 //  You should have received a copy of the GNU Lesser General Public License
 //  along with the Nethermind. If not, see <http://www.gnu.org/licenses/>.
 ",I guess your IDE automatically edited these files?,.cs,1,0,1
"@@ -14,11 +14,16 @@ namespace Datadog.Trace
         private readonly AgentWriterBuffer<ServiceInfo> _servicesBuffer = new AgentWriterBuffer<ServiceInfo>(100);
         private readonly IApi _api;
         private readonly Task _flushTask;
+        private readonly TaskCompletionSource<bool> _processExit = new TaskCompletionSource<bool>();
 
         public AgentWriter(IApi api)
         {
             _api = api;
             _flushTask = Task.Run(FlushTracesTaskLoop);
+            // Register callbacks to make sure we flush the traces before exiting
+            AppDomain.CurrentDomain.ProcessExit += CurrentDomain_ProcessExit;
+            AppDomain.CurrentDomain.UnhandledException += CurrentDomain_UnhandledException;
+            Console.CancelKeyPress += Console_CancelKeyPress;
         }
 
         public void WriteServiceInfo(ServiceInfo serviceInfo)","can't we have this at the Tracer level? my point about having the logic of ""Write"" in the Tracer, is that this `AgentWriter` is a class that may have multiple implementations, so this logic will be replicated. Think about the possibility of having a `SyncWriter` that writes immediately in the main thread (it was a specific use case that came out in the Ruby client)",.cs,1,1,1
"@@ -41,7 +41,7 @@ namespace OpenTelemetry.Exporter.Jaeger.Tests.Implementation
         [Fact]
         public async void JaegerThriftIntegrationTest_TAbstractBaseGeneratesConsistentThriftPayload()
         {
-            var validJaegerThriftPayload = Convert.FromBase64String(""goEBCWVtaXRCYXRjaBwcGAx0ZXN0IHByb2Nlc3MZHBgQdGVzdF9wcm9jZXNzX3RhZxUAGAp0ZXN0X3ZhbHVlAAAZHBab5cuG2OehhdwBFuPakI2n2cCVLhbUpdv9yJDPo4EBFpjckNKFzqHOsgEYBE5hbWUZHBUAFpvly4bY56GF3AEW49qQjafZwJUuFpCmrOGWyrWcgwEAFQIWgICz3saWvwUWgJycORl8GAlzdHJpbmdLZXkVABgFdmFsdWUAGAdsb25nS2V5FQZGAgAYCGxvbmdLZXkyFQZGAgAYCWRvdWJsZUtleRUCJwAAAAAAAPA/ABgKZG91YmxlS2V5MhUCJwAAAAAAAPA/ABgHYm9vbEtleRUEMQAYCXNwYW4ua2luZBUAGAZjbGllbnQAGSwWgICz3saWvwUZLBgDa2V5FQAYBXZhbHVlABgLZGVzY3JpcHRpb24VABgGRXZlbnQxAAAWgICz3saWvwUZLBgDa2V5FQAYBXZhbHVlABgLZGVzY3JpcHRpb24VABgGRXZlbnQyAAAAAAA="");
+            var validJaegerThriftPayload = Convert.FromBase64String(""goEBCWVtaXRCYXRjaBwcGAx0ZXN0IHByb2Nlc3MZHBgQdGVzdF9wcm9jZXNzX3RhZxUAGAp0ZXN0X3ZhbHVlAAAZHBab5cuG2OehhdwBFuPakI2n2cCVLhbUpdv9yJDPo4EBFpjckNKFzqHOsgEYBE5hbWUZHBUAFpvly4bY56GF3AEW49qQjafZwJUuFpCmrOGWyrWcgwEAFQIWgICz3saWvwUWgJycORl8GAlzdHJpbmdLZXkVABgFdmFsdWUAGAdsb25nS2V5FQZGAgAYCGxvbmdLZXkyFQZGAgAYCWRvdWJsZUtleRUCJwAAAAAAAPA/ABgKZG91YmxlS2V5MhUCJwAAAAAAAPA/ABgHYm9vbEtleRUEMQAYCXNwYW4ua2luZBUAGAZjbGllbnQAGSwWgICz3saWvwUZLBgDa2V5FQAYBXZhbHVlABgHbWVzc2FnZRUAGAZFdmVudDEAABaAgLPexpa/BRksGANrZXkVABgFdmFsdWUAGAdtZXNzYWdlFQAYBkV2ZW50MgAAAAAA"");
             
             using (var memoryTransport = new InMemoryTransport())
             {",this test case is so wierd. I remember updating it last time =) Hope we will make somthing better eventually,.cs,1,0,1
"@@ -87,8 +87,12 @@ namespace Nethermind.Runner.Ethereum.Steps
                         logger.Error(""Error during jsonRpc runner start"", x.Exception);
                 }, cancellationToken);
 
+                JsonRpcIpcRunner jsonIpcRunner = new(jsonRpcProcessor, _api.ConfigProvider, _api.LogManager);
+                jsonIpcRunner.Start(cancellationToken);
+
 #pragma warning disable 4014
                 _api.DisposeStack.Push(new Reactive.AnonymousDisposable(() => jsonRpcRunner.StopAsync())); // do not await
+                _api.DisposeStack.Push(new Reactive.AnonymousDisposable(() => jsonIpcRunner.Dispose())); // do not await
 #pragma warning restore 4014
             }
             else",IDisposable can be pushed here normally,.cs,1,0,1
"@@ -63,7 +63,11 @@ namespace Microsoft.Cci.Writers.CSharp
             if (property.GetHiddenBaseProperty(_filter) != Dummy.Property)
                 WriteKeyword(""new"");
 
+            if (property.ReturnValueIsByRef)
+                WriteKeyword(""ref"");
+
             WriteTypeName(property.Type);
+
             if (isIndexer)
             {
                 int index = property.Name.Value.LastIndexOf(""."");",I couldn't find the C# spec but is ref supposed to be the thing directly in front of the type?,.cs,1,1,1
"@@ -23,6 +23,9 @@ namespace MvvmCross.Platforms.Uap.Presenters
     {
         protected readonly IMvxWindowsFrame _rootFrame;
 
+        private MvxWindowsContentDialog mDialogView;
+
+
         public MvxWindowsViewPresenter(IMvxWindowsFrame rootFrame)
         {
             _rootFrame = rootFrame;",Can we avoid by any chance holding a strong reference to the dialog view here?,.cs,1,1,1
"@@ -17,6 +17,7 @@
 using System.Diagnostics;
 using Microsoft.Extensions.Logging;
 using OpenTelemetry;
+using OpenTelemetry.Trace;
 
 public class Program
 {","Although this is technically correct, I wonder if we could make it simpler by not requiring this namespace?",.cs,1,1,1
"@@ -386,7 +386,10 @@ namespace NLog.Layouts
                         var value = ParseParameterValue(stringReader);
                         if (!string.IsNullOrEmpty(parameterName) || !StringHelpers.IsNullOrWhiteSpace(value))
                         {
-                            // TODO NLog 5.0 Should throw exception when invalid configuration (Check throwConfigExceptions)
+                            if (throwConfigExceptions ?? LogManager.ThrowConfigExceptions == true)
+                            {
+                                throw new NLogConfigurationException(""Unrecognized property '{0}={1}` for ${{{2}}} ({3})"", parameterName, value, name, layoutRenderer?.GetType());
+                            }
                             InternalLogger.Warn(""Skipping unrecognized property '{0}={1}` for ${{{2}}} ({3})"", parameterName, value, name, layoutRenderer?.GetType());
                         }
                     }",Maybe this instead: `if (throwConfigExceptions ?? LogManager.ThrowConfigExceptions ?? LogManager.ThrowExceptions)` ?,.cs,1,0,1
"@@ -59,7 +59,10 @@ namespace Nethermind.Evm
             0, 0, 0, 0, 0, 0, 0, 0
         };
 
+        private readonly byte[] _chainId;
+
         private readonly IBlockhashProvider _blockhashProvider;
+        private readonly ISpecProvider _specProvider;
         private readonly LruCache<Keccak, CodeInfo> _codeCache = new LruCache<Keccak, CodeInfo>(4 * 1024);
         private readonly ILogger _logger;
         private readonly IStateProvider _state;",remove readonly for performance reasons,.cs,1,1,1
"@@ -24,6 +24,8 @@ namespace Nethermind.Consensus
     {
         private readonly UInt256 _constantDifficulty;
 
+        public static readonly IDifficultyCalculator Zero = new ConstantDifficultyCalculator(UInt256.Zero);
+
         public static readonly IDifficultyCalculator One = new ConstantDifficultyCalculator(UInt256.One);
 
         public ConstantDifficultyCalculator(UInt256 constantDifficulty)","rename to ConstantDifficulty instead of ConstantDifficultyCalculator -> or even -> Difficulty.One, Difficulty.Zero",.cs,1,1,1
"@@ -316,6 +316,11 @@ namespace OpenTelemetry.Instrumentation.AspNetCore.Implementation
         [MethodImpl(MethodImplOptions.AggressiveInlining)]
         private static void AddGrpcAttributes(Activity activity, string grpcMethod, HttpContext context)
         {
+            // The RPC semantic conventions indicate the span name
+            // should not have a leading forward slash.
+            // https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/trace/semantic_conventions/rpc.md#span-name
+            activity.DisplayName = grpcMethod.Trim('/');
+
             activity.SetTag(SemanticConventions.AttributeRpcSystem, GrpcTagHelper.RpcSystemGrpc);
             activity.SetTag(SemanticConventions.AttributeNetPeerIp, context.Connection.RemoteIpAddress.ToString());
             activity.SetTag(SemanticConventions.AttributeNetPeerPort, context.Connection.RemotePort);",`TrimStart` might be slightly faster (if we're only concerned with the leading character).,.cs,1,1,1
"@@ -98,7 +98,8 @@ namespace OpenTelemetry.Instrumentation.Grpc.Tests
 
             // Tags added by the library then removed from the instrumentation
             Assert.Null(activity.GetTagValue(GrpcTagHelper.GrpcMethodTagName));
-            Assert.NotNull(activity.GetTagValue(GrpcTagHelper.GrpcStatusCodeTagName));
+            Assert.Null(activity.GetTagValue(GrpcTagHelper.GrpcStatusCodeTagName));
+            Assert.NotNull(activity.GetTagValue(SemanticConventions.AttributeRpcGrpcStatusCode));
         }
 
         [Theory]","Minor thing, though should be able to make this an `Assert.Equal(0, activity.GetTagValue(SemanticConventions.AttributeRpcGrpcStatusCode))` (I _think_ this test should result in a status code of 0).",.cs,1,1,1
"@@ -34,6 +34,8 @@ namespace Nethermind.Core2.Types
         public static ValidatorIndex None => new ValidatorIndex(ulong.MaxValue);
 
         public static implicit operator ulong(ValidatorIndex validatorIndex) => validatorIndex.Number;
+        
+        public static explicit operator int(ValidatorIndex validatorIndex) => (int)validatorIndex.Number;
 
         public static implicit operator ValidatorIndex(ulong value) => new ValidatorIndex(value);
 ","Suggest that implicit from ValidatorIndex => ulong is okay, but keep the opposite direction explicit. Be consistent across all the types (Slot, Gwei, etc). To avoid situations like: ValidatorIndex index = currentEpoch + maxGwei;",.cs,1,1,1
"@@ -204,7 +204,12 @@ namespace NLog.Config
             {
                 if (!string.IsNullOrEmpty(configItem.Key))
                 {
-                    dict[configItem.Key.Trim()] = configItem.Value;
+                    string key = configItem.Key.Trim();
+                    if (dict.ContainsKey(key))
+                    {
+                        InternalLogger.Debug(""Skipping duplicate value for 'NLog' property {0}. Value={1}"", configItem.Key, dict[key]);
+                    }
+                    dict[key] = configItem.Value;
                 }
             }
 ","This is something else than the refactor, isn't?",.cs,1,0,1
"@@ -0,0 +1,19 @@
+using System;
+using Datadog.Trace.ClrProfiler.Interfaces;
+using Datadog.Trace.Interfaces;
+
+namespace Datadog.Trace.ClrProfiler.Services
+{
+    internal class ActionBlockSpanDecorator : ISpanDecorator
+    {
+        private readonly Action<ISpan> _block;
+
+        public ActionBlockSpanDecorator(Action<ISpan> block)
+        {
+            _block = block;
+        }
+
+        public void Decorate(ISpan span)
+            => _block(span);
+    }
+}","I'm concerned that using delegates will add overhead that we can easily avoid. Invoking delegates is slower than calling a method directly, and we need to allocate the `Action<T>` objects as well.",.cs,1,1,1
"@@ -1529,8 +1529,11 @@ namespace pwiz.SkylineTestUtil
             // Compare file contents
             var expected = existsInProject ? ReadTextWithNormalizedLineEndings(projectFile) : string.Empty;
             var actual = ReadTextWithNormalizedLineEndings(recordedFile);
-            if (Equals(expected, actual))
+            var diff = Helpers.DiffIgnoringTimeStampsAndGUIDs(expected, actual); // Don't mind any differences in generated GUIDs or timestamps
+            if (string.IsNullOrEmpty(diff))
+            {
                 return;
+            }
 
             if (ForceMzml)
             {","This is unrelated to your change, but I believe ForceMzml is usually and the log files we have checked in all have the .mzML file extension in them. I don't think anyone would notice if this whole block of code were removed.",.cs,0,1,1
"@@ -16,7 +16,10 @@
 
 using System;
 using System.Collections.Generic;
+using System.IO;
+using System.IO.Abstractions;
 using System.Linq;
+using System.Text.Json;
 using System.Threading.Tasks;
 using Microsoft.Extensions.Logging;
 using Microsoft.Extensions.Options;",I assume that this is just a memory store that does not have to be super fast as it is used for testing,.cs,1,1,1
"@@ -3185,6 +3185,8 @@ namespace pwiz.Skyline.Model
                 var result = Document.Settings.GetIonMobilityFilter(nodePep, nodeTranGroup, nodeTran, null, null, 1.2);
                 if (result.HasIonMobilityValue)
                     ionMobility = result.IonMobility.Mobility.Value;
+                if (result.IonMobilityExtractionWindowWidth.HasValue)
+                    windowIM = result.IonMobilityExtractionWindowWidth.Value;
             }
             if (!ionMobility.HasValue)
                 _missingIonMobility.Add(nodeTranGroup.GetLibKey(Document.Settings, nodePep));","Assuming that we want the same window size used in chromatogram extraction ion mobility filtering, this seems correct. I don't know enough about this code are to say if that's a valid assumption, though,",.cs,1,1,1
"@@ -77,7 +77,7 @@ namespace NLog.Config
         /// Initializes a new instance of the <see cref=""XmlLoggingConfiguration"" /> class.
         /// </summary>
         /// <param name=""fileName"">Configuration file to be read.</param>
-        public XmlLoggingConfiguration([CanBeNull] string fileName)
+        public XmlLoggingConfiguration([NotNull] string fileName)
             : this(fileName, LogManager.LogFactory)
         { }
 ",looks like a change which is not suitable for a path version? (breaking behavior change),.cs,1,1,1
"@@ -13,7 +13,7 @@ namespace Datadog.Trace
 
         private readonly DateTimeOffset _utcStart = DateTimeOffset.UtcNow;
         private readonly long _timestamp = Stopwatch.GetTimestamp();
-        private readonly List<Span> _spans = new List<Span>();
+        private List<Span> _spans = new List<Span>();
 
         private int _openSpans;
         private SamplingPriority? _samplingPriority;",Doesn't look like we needed to remove the `readonly`.,.cs,1,0,0
"@@ -51,6 +51,11 @@ namespace Nethermind.Network
             long next = 0;
             for (int i = 0; i < specProvider.TransitionBlocks.Length; i++)
             {
+                if (specProvider.TransitionBlocks[i] >= long.MaxValue - 100)
+                {
+                    continue;
+                }
+                
                 long transition = specProvider.TransitionBlocks[i];
                 if (transition > headNumber)
                 {",Why this const? Can we name this const better?,.cs,1,0,1
"@@ -16,5 +16,7 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http
         Options,
 
         Custom,
+
+        Unknown = byte.MaxValue
     }
 }","It's best practice to make Unknown/None the zero value, the default for uninitialized fields.",.cs,1,1,1
"@@ -0,0 +1,13 @@
+﻿using System.Composition;
+
+namespace Microsoft.Cci.Differs.Rules
+{
+    internal abstract class DifferenceRule : Microsoft.Cci.Differs.DifferenceRule
+    {
+        [Import]
+        public IDifferenceOperands Operands { get; set; }
+
+        public string Left => Operands?.Left ?? ""contract"";
+        public string Right => Operands?.Right ?? ""implementation"";
+    }
+}",LOL. Too scared to update the base rule and just make it optional?,.cs,1,1,0
"@@ -15,9 +15,10 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Internal.Http
     {
         protected bool _isReadOnly;
         protected Dictionary<string, StringValues> MaybeUnknown;
-
         protected Dictionary<string, StringValues> Unknown => MaybeUnknown ?? (MaybeUnknown = new Dictionary<string, StringValues>(StringComparer.OrdinalIgnoreCase));
 
+        public long? ContentLength { get; set; }
+
         StringValues IHeaderDictionary.this[string key]
         {
             get","We should have a custom setter, so we can throw immediately if this is set to a negative value or _isReadOnly is true.",.cs,1,1,1
"@@ -62,7 +62,7 @@ namespace Microsoft.DotNet.Build.Tasks.Packaging
                 return false;
             }
 
-            if (PackageIndexes != null || PackageIndexes.Length > 0)
+            if (PackageIndexes != null && PackageIndexes.Length > 0)
             {
                 PackageIndex.Current.Merge(PackageIndexes.Select(pi => pi.GetMetadata(""FullPath"")));
             }",Can you instead change this to &&,.cs,1,0,1
"@@ -96,8 +96,8 @@ namespace Examples.Console
                 catch (ArgumentOutOfRangeException e)
                 {
                     // Set status upon error
-                    activity.AddTag(SpanAttributeConstants.StatusCodeKey, SpanHelper.GetCachedCanonicalCodeString(Status.Internal.CanonicalCode));
-                    activity.AddTag(SpanAttributeConstants.StatusDescriptionKey, e.ToString());
+                    activity.SetTag(SpanAttributeConstants.StatusCodeKey, SpanHelper.GetCachedCanonicalCodeString(Status.Internal.CanonicalCode));
+                    activity.SetTag(SpanAttributeConstants.StatusDescriptionKey, e.ToString());
                 }
 
                 // Annotate our activity to capture metadata about our operation",Should we consider changing the return type of `SpanHelper.GetCachedCanonicalCodeString` to int?,.cs,1,0,1
"@@ -0,0 +1,17 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+// See the LICENSE file in the project root for more information.
+
+using System;
+using System.Net;
+
+namespace Microsoft.DotNet.VersionTools.Automation.GitHubApi
+{
+    public partial class GitHubClient : IGitHubClient, IDisposable
+    {
+        static GitHubClient()
+        {
+            ServicePointManager.SecurityProtocol |= SecurityProtocolType.Tls12;
+        }
+    }
+}","@davidsh When targeting 4.5(.0) is this the right answer, or can/should it be assigned to 0?",.cs,0,1,1
"@@ -594,6 +594,19 @@ namespace MvvmCross.Droid.Views
             return false;
         }
 
+        protected virtual bool CloseFragments()
+        {
+            try
+            {
+                CurrentFragmentManager.PopBackStackImmediate();
+            }
+            catch (System.Exception ex)
+            {
+                MvxTrace.Trace(""Cannot close any fragments"", ex);
+            }
+            return true;
+        }
+
         protected virtual bool CloseFragment(IMvxViewModel viewModel, MvxFragmentPresentationAttribute attribute)
         {
             // try to close nested fragment first",Same here about running the code without try/catch,.cs,0,1,1
"@@ -208,6 +208,8 @@ namespace Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http2
                     return ProcessRstStreamFrameAsync();
                 case Http2FrameType.SETTINGS:
                     return ProcessSettingsFrameAsync();
+                case Http2FrameType.PUSH_PROMISE:
+                    throw new Http2ConnectionErrorException(Http2ErrorCode.PROTOCOL_ERROR);
                 case Http2FrameType.PING:
                     return ProcessPingFrameAsync();
                 case Http2FrameType.GOAWAY:",Why doesn't this switch have a default?,.cs,1,1,1
"@@ -28,7 +28,10 @@ namespace Nethermind.Serialization.Rlp
         Storage = 4,
         Eip658Receipts = 8,
         AllowUnsigned = 16,
-        ForTreeRoot = 32,
-        All = AllowExtraData | ForSealing | Storage | Eip658Receipts | AllowUnsigned | ForTreeRoot
+        SkipTypedWrapping = 32, // introduced after typed transactions. In the network (devp2p) transaction has additional wrapping
+                                // when we're calculating tx hash or sending raw transaction we should skip this wrapping
+                                // with additional wrapping for typed transactions we're decoding Uint8Array([TransactionType, TransactionPayload]
+                                // without wrapping we're decoding (TransactionType || TransactionPayload)
+        All = AllowExtraData | ForSealing | Storage | Eip658Receipts | AllowUnsigned | SkipTypedWrapping
     }
 }","Can we have 2 flags there with same value? SkipTypedWrapping = 32 and ForTreeRoot = 32 yes they are the same, but intention differs... Not sure if good idea.",.cs,1,1,1
"@@ -1302,7 +1302,7 @@ namespace Microsoft.AspNetCore.Server.Kestrel.FunctionalTests
                 await appFuncCompleted.Task.DefaultTimeout();
             }
 
-            mockKestrelTrace.Verify(t => t.ConnectionStop(It.IsAny<string>()), Times.Once());
+            mockKestrelTrace.Verify(t => t.ConnectionStop(It.IsAny<string>()), Times.AtMostOnce());
         }
 
         [Theory]",Is there a point in checking these at all if we allow 0 and 1? Maybe we should just remove them entirely. I suppose we are making sure ConnectionStop is never called more than once still.,.cs,1,1,1
"@@ -0,0 +1,14 @@
+// Copyright (c) .NET Foundation. All rights reserved.
+// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.
+
+using System;
+
+namespace Microsoft.AspNetCore.Protocols
+{
+    [Flags]
+    public enum TransferFormat
+    {
+        Binary = 0x01,
+        Text = 0x02
+    }
+}","Binary literal? :). I don't really care either way, mostly just trolling.",.cs,1,0,1
"@@ -150,6 +150,7 @@ namespace Datadog.Trace
                 span.SetTag(Tags.AzureAppServicesInstanceName, AzureAppServices.Metadata.InstanceName);
                 span.SetTag(Tags.AzureAppServicesOperatingSystem, AzureAppServices.Metadata.OperatingSystem);
                 span.SetTag(Tags.AzureAppServicesRuntime, AzureAppServices.Metadata.Runtime);
+                span.SetTag(Tags.AzureAppServicesExtensionVersion, AzureAppServices.Metadata.SiteExtensionVersion);
             }
 
             // set the origin tag to the root span of each trace/subtrace","Can this be `null` (e.g. if it's an older version of the extension installed)? If so, is there any value in recording that as a key without a value? This is a more general question of course, for my own understanding  ",.cs,1,1,1
"@@ -23,7 +23,7 @@ namespace OpenTelemetry.Exporter.Prometheus
     /// </summary>
     internal static partial class PrometheusSerializer
     {
-        private static readonly string[] MetricTypes = new string[] { ""untyped"", ""counter"", ""gauge"", ""histogram"", ""summary"" };
+        private static readonly string[] MetricTypes = new string[] { ""untyped"", ""counter"", ""gauge"", ""untyped"", ""histogram"", ""histogram"", ""histogram"", ""histogram"", ""summary"" };
 
         public static int WriteMetric(byte[] buffer, int cursor, Metric metric)
         {",minor: rewrap this line.,.cs,1,1,1
"@@ -18,6 +18,7 @@ using System;
 using System.Collections;
 using System.Collections.Generic;
 using System.Diagnostics;
+using System.Linq;
 
 namespace OpenTelemetry.Trace.Internal
 {",Is this namespace used?,.cs,1,1,1
"@@ -8,13 +8,16 @@ using Microsoft.AspNet.Server.Kestrel.Filter;
 using Microsoft.AspNet.Server.Kestrel.Infrastructure;
 using Microsoft.AspNet.Server.Kestrel.Networking;
 using Microsoft.Extensions.Logging;
+using System.Security.Cryptography.X509Certificates;
 
 namespace Microsoft.AspNet.Server.Kestrel.Http
 {
     public class Connection : ConnectionContext, IConnectionControl
     {
-        private static readonly Action<UvStreamHandle, int, object> _readCallback = ReadCallback;
-        private static readonly Func<UvStreamHandle, int, object, Libuv.uv_buf_t> _allocCallback = AllocCallback;
+        private static readonly Action<UvStreamHandle, int, object> _readCallback = 
+            (handle, status, state) => ReadCallback(handle, status, state);
+        private static readonly Func<UvStreamHandle, int, object, Libuv.uv_buf_t> _allocCallback = 
+            (handle, suggestedsize, state) => AllocCallback(handle, suggestedsize, state);
 
         private static long _lastConnectionId;
 ","Sort usings, System should always be first.",.cs,1,1,1
"@@ -98,12 +98,13 @@ namespace Datadog.Trace.Security.IntegrationTests
         [Trait(""Category"", ""EndToEnd"")]
         [Trait(""RunOnWindows"", ""True"")]
         [Trait(""LoadFromGAC"", ""True"")]
-        [Fact]
-        public Task TestSecurity()
+        [Theory]
+        [InlineData(""/Health/test&[$slice]"")]
+        public Task TestSecurity(string url = DefaultAttackUrl)
         {
             // if blocking is enabled, request stops before reaching asp net mvc integrations intercepting before action methods, so no more spans are generated
             // NOTE: by integrating the latest version of the WAF, blocking was disabled, as it does not support blocking yet
-            return TestBlockedRequestAsync(_iisFixture.Agent, _enableSecurity, _enableSecurity && _blockingEnabled ? HttpStatusCode.OK : HttpStatusCode.OK, _enableSecurity && _blockingEnabled ? 10 : 10, new Action<TestHelpers.MockTracerAgent.Span>[]
+            return TestBlockedRequestAsync(_iisFixture.Agent, _enableSecurity, _enableSecurity && _blockingEnabled ? HttpStatusCode.OK : HttpStatusCode.OK, _enableSecurity && _blockingEnabled ? 10 : 10, url: url, assertOnSpans: new Action<TestHelpers.MockTracerAgent.Span>[]
              {
                  s => Assert.Matches(""aspnet(-mvc)?.request"", s.Name),
                  s => Assert.Equal(""sample"", s.Service),","Would it be good test with the old url as well, as you've moved the Theory attribute, it should be good to do.",.cs,1,1,1
"@@ -206,7 +206,10 @@ namespace Microsoft.Cci.Writers.CSharp
                 Write(""throw new "");
                 if (_forCompilationIncludeGlobalprefix)
                     Write(""global::"");
-                Write(""System.PlatformNotSupportedException(); "");
+                if(_platformNotSupportedExceptionMessage == null)
+                    Write(""System.PlatformNotSupportedException();"");
+                else
+                    Write($""System.PlatformNotSupportedException(\""{_platformNotSupportedExceptionMessage}\""); "");
             }
             else if (method.ContainingTypeDefinition.IsValueType && method.IsConstructor)
             {","Can you also provide some syntax pattern for folks specify a resource string? For example, if _platformNotSupportedExceptionMessage starts with some character like `:` or `@` treat the rest of it as code so that folks can do something like `:SR.MyLocalizedResourceMessage`",.cs,1,1,1
"@@ -26,6 +26,7 @@ namespace Datadog.Trace.ClrProfiler.IntegrationTests
 #if DEFAULT_SAMPLES
                 new object[] { string.Empty },
 #else
+#if NETFRAMEWORK
                 new object[] { ""2.0.0"" },
                 new object[] { ""2.0.1"" },
                 new object[] { ""2.0.2"" },","The changes to `MinVersionNetCore` take effect here, where we do not run the XUnit test cases for package versions that are lower than the specified `MinVersionNetCore`",.cs,1,1,1
"@@ -52,10 +52,15 @@ namespace MvvmCross.Forms.Platform.Uap.Core
         {
             get
             {
+                if (!Xamarin.Forms.Forms.IsInitialized)
+                    Xamarin.Forms.Forms.Init(ActivationArguments, GetViewAssemblies());
+
                 if (_formsApplication == null)
                 {
-                    Xamarin.Forms.Forms.Init(ActivationArguments, GetViewAssemblies());
-                    _formsApplication = _formsApplication ?? CreateFormsApplication();
+                    _formsApplication = CreateFormsApplication();
+                }
+                if(Application.Current != _formsApplication) {
+                    Application.Current = _formsApplication;
                 }
                 return _formsApplication;
             }",`{` should be placed in a new line,.cs,1,1,1
"@@ -47,8 +47,9 @@ namespace Nethermind.Runner.JsonRpc
 
         public void ConfigureServices(IServiceCollection services)
         {
-            // ReSharper disable once ASP0000
+            #pragma warning disable ASP0000
             ServiceProvider sp = services.BuildServiceProvider()!;
+            #pragma warning restore ASP0000
             IConfigProvider? configProvider = sp.GetService<IConfigProvider>();
             if (configProvider == null)
             {","ReSharper disables only affect resharper, while `#pragma warning ...` should work for all compilers.",.cs,1,1,1
"@@ -2119,6 +2119,10 @@ namespace Nethermind.Evm
                         {
                             _state.UpdateStorageRoot(contractAddress, Keccak.EmptyTreeHash);
                         }
+                        else if (_state.IsDeadAccount(contractAddress))
+                        {
+                            _storage.RecreateStorage(contractAddress);
+                        }
 
                         _state.SubtractFromBalance(env.ExecutingAccount, value, spec);
                         ExecutionEnvironment callEnv = new ExecutionEnvironment();",Are we sure this won't create consensus issues on different transactions and blocks?,.cs,1,1,1
"@@ -85,6 +85,6 @@ namespace NLog.Targets
         /// Gets or sets the type of the property.
         /// </summary>
         [DefaultValue(typeof(string))]
-        public Type PropertyType { get; set; } = typeof(string);
+        public Type ParameterType { get; set; } = typeof(string);
     }
 }","I think propertyType is better? It's a target with properties, and not parameters?",.cs,1,1,1
"@@ -76,7 +76,7 @@ namespace Datadog.Trace.Logging
                        .MinimumLevel.ControlledBy(LoggingLevelSwitch)
                        .WriteTo.File(
                             managedLogPath,
-                            outputTemplate: ""{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj}{Exception}{Properties}{NewLine}"",
+                            outputTemplate: ""{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj}{Exception} {Properties}{NewLine}"",
                             rollingInterval: RollingInterval.Day,
                             rollOnFileSizeLimit: true,
                             fileSizeLimitBytes: MaxLogFileSize,",In that case shouldn't we add one also before the exception?,.cs,1,1,1
"@@ -161,6 +161,13 @@ namespace Datadog.Trace.AspNet
                     app.Context.Items[_httpContextScopeKey] is Scope scope)
                 {
                     scope.Span.SetHttpStatusCode(app.Context.Response.StatusCode, isServer: true);
+
+                    if (app.Context.Items[""__Datadog.Trace.ClrProfiler.Managed.AspNetMvcIntegration-aspnet.resourcename""] is string resourceName
+                        && !string.IsNullOrEmpty(resourceName))
+                    {
+                        scope.Span.ResourceName = resourceName;
+                    }
+
                     scope.Dispose();
                 }
             }","[non-blocking] While you're in here, consider renaming `UriHelpers.GetRelativeUrl()` since that is not what it does.",.cs,1,1,1
"@@ -40,7 +40,7 @@ namespace System.Text.RegularExpressions.Tests
     }
 
     /// <summary>Performance tests adapted from https://github.com/mariomka/regex-benchmark</summary>
-    [BenchmarkCategory(Categories.Libraries, Categories.NoWASM)]
+    [BenchmarkCategory(Categories.Libraries, Categories.Regex, Categories.NoWASM)]
     public class Perf_Regex_Industry_Mariomkas
     {
         [Params(","You will need the Regex category for all of the test classes, unless you don't want them included",.cs,1,1,1
"@@ -29,7 +29,7 @@ namespace Nethermind.Network.Benchmarks
         [GlobalSetup]
         public void Setup()
         {
-            _node = new Node(new PublicKey(""0x000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f""), ""127.0.0.1"", 1234);
+            _node = new Node(new PublicKey(""0x000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f""), ""127.0.0.1"", 1234, false);
         }
         
         [Benchmark]",a lot of default 'false' for isStatic cluttering the PR,.cs,0,1,1
"@@ -219,6 +219,13 @@ namespace MvvmCross.Droid.FullFragging.Caching
 			{
 				(fragInfo.CachedFragment as Fragment).Arguments.Clear();
 				(fragInfo.CachedFragment as Fragment).Arguments.PutAll(bundle);
+
+                var childViewModelCache = Mvx.GetSingleton<IMvxChildViewModelCache>();
+                if (childViewModelCache.Exists(fragInfo.CachedFragment.ViewModel.GetType()))
+                {
+                    fragInfo.CachedFragment.ViewModel = childViewModelCache.Get(fragInfo.CachedFragment.ViewModel.GetType());
+                    childViewModelCache.Remove(fragInfo.CachedFragment.ViewModel.GetType());
+                }
 			}
 			else
 			{",Again: evaluate `fragInfo.CachedFragment.ViewModel.GetType()` once.,.cs,1,0,1
"@@ -689,7 +689,15 @@ namespace pwiz.SkylineTestUtil
                     {
                         // Grab some details in case of eventual failure
                         var formCloseClassName = System.ComponentModel.TypeDescriptor.GetClassName(formClose);
-                        var formCloseText = formClose.Text;
+                        string formCloseText;
+                        try
+                        {
+                            formCloseText = formClose.Text;
+                        }
+                        catch
+                        {
+                            formCloseText = ""@@ERROR@@"";
+                        }
                         formDetail = string.Format(""(form class={0}, form text=\""{1}\"")"", 
                             string.IsNullOrEmpty(formCloseClassName) ? @""?"" : formCloseClassName,
                             string.IsNullOrEmpty(formCloseText) ? @""?"" : formCloseText);","Seems a bit dramatic? Maybe just ""@@(could not retrieve form text)@@""",.cs,1,1,1
"@@ -75,7 +75,7 @@ func TestUnary(t *testing.T) {
                         sent := &testpb.TestMessage{Value: ""echo""}
                         received, err := client.Unary(ctx, sent)
                         require.NoError(t, err)
-                        assert.Equal(t, sent, received)
+                        assert.Equal(t, sent.Value, received.Value)
                 })
         }
 }",Why did you need to change this test?,go,1,0,1
"@@ -34,7 +34,7 @@ func TestConvertAWSMachine(t *testing.T) {
 				Spec: infrav1alpha3.AWSMachineSpec{
 					CloudInit: infrav1alpha3.CloudInit{
 						InsecureSkipSecretsManager: true,
-						SecretARN:                  ""something"",
+						SecretPrefix:               ""something/"",
 					},
 				},
 			}",Any particular reason for adding the `/` here? Should this be something we automatically do in the naming (adding a separator between the secret prefix and the chunk number)?,go,1,1,1
"@@ -75,7 +75,10 @@ func Setup(ctx context.Context, config *config.Node, proxy proxy.Proxy) error {
 
 	endpoint, _ := client.CoreV1().Endpoints(""default"").Get(ctx, ""kubernetes"", metav1.GetOptions{})
 	if endpoint != nil {
-		proxy.Update(getAddresses(endpoint))
+		addresses := getAddresses(endpoint)
+		if len(addresses) > 0 {
+			proxy.Update(getAddresses(endpoint))
+		}
 	}
 
 	disconnect := map[string]context.CancelFunc{}","Does the `proxy.Update` implementation fail for a zero-length and/or nil slice of addresses? If so, we should fix it there. My only other guess is you needed to set a breakpoint while debugging.",go,1,1,1
"@@ -87,10 +87,19 @@ var creatablesMigration = []string{
 	`ALTER TABLE assetcreators ADD COLUMN ctype INTEGER DEFAULT 0`,
 }
 
+var createOnlineAccountIndex = []string{
+	`ALTER TABLE accountbase
+		ADD COLUMN normalizedonlinebalance INTEGER`,
+	`CREATE INDEX IF NOT EXISTS onlineaccountbals
+		ON accountbase ( normalizedonlinebalance, address, data )
+		WHERE normalizedonlinebalance>0`,
+}
+
 var accountsResetExprs = []string{
 	`DROP TABLE IF EXISTS acctrounds`,
 	`DROP TABLE IF EXISTS accounttotals`,
 	`DROP TABLE IF EXISTS accountbase`,
+	`DROP TABLE IF EXISTS onlineaccountbase`,
 	`DROP TABLE IF EXISTS assetcreators`,
 	`DROP TABLE IF EXISTS storedcatchpoints`,
 	`DROP TABLE IF EXISTS catchpointstate`,","this line can be dropped, right ?",go,1,0,1
"@@ -62,15 +62,15 @@ func NewOutbound(urlStr string, opts ...AgentOption) *Outbound {
 	urlTemplate, hp := parseURL(urlStr)
 
 	peerID := hostport.PeerIdentifier(hp)
-	peerList := list.NewSingle(peerID, agent)
+	peerChooser := list.NewSingle(peerID, agent)
 
-	err := peerList.Start()
+	err := peerChooser.Start()
 	if err != nil {
 		// This should never happen, single shouldn't return an error here
 		panic(fmt.Sprintf(""could not start single peerlist, err: %s"", err))
 	}
 
-	return NewPeerListOutbound(peerList, urlTemplate)
+	return NewChooserOutbound(peerChooser, urlTemplate)
 }
 
 func parseURL(urlStr string) (*url.URL, string) {","nit - in this context, it might be enough to just call the variable `chooser`.",go,1,1,1
"@@ -155,11 +155,11 @@ func (r *DeliveryReporter) reportEventProcessingTime(ctx context.Context, end ti
 }
 
 func filterTypeValue(v string) string {
-	if v != """" {
-		return v
+	if v == """" {
+		// the default value if the filter attributes are empty.
+		return unspecifiedFilterType
 	}
-	// the default value if the filter attributes are empty.
-	return ""any""
+	return EventTypeMetricValue(v)
 }
 
 func (r *DeliveryReporter) AddTags(ctx context.Context) (context.Context, error) {",It shouldn't be necessary to transform the filter type since the cardinality is already limited by the cardinality of triggers.,go,1,1,1
"@@ -62,6 +62,11 @@ func (t TraceID) MarshalJSON() ([]byte, error) {
 	return json.Marshal(hex.EncodeToString(t[:]))
 }
 
+// Stringer Implementation of String() returns the string form of a TraceID
+func (t TraceID) String() string {
+	return string(t[:])
+}
+
 // SpanID is a unique identify of a span in a trace.
 type SpanID [8]byte
 ",please use hex.EncodeToString() here as well.,go,1,1,1
"@@ -130,14 +130,14 @@ func TestAttestorTestSuite(t *testing.T) {
 }
 
 func (s *AttestorTestSuite) linkAgentSVIDPath() {
-        err := os.Link(
+        err := os.Symlink(
                 path.Join(util.ProjectRoot(), ""test/fixture/certs/agent_svid.der""),
                 s.config.SVIDCachePath)
         s.Require().NoError(err)
 }
 
 func (s *AttestorTestSuite) linkBundle() {
-        err := os.Link(
+        err := os.Symlink(
                 path.Join(util.ProjectRoot(), ""test/fixture/certs/bundle.der""),
                 s.config.BundleCachePath)
         s.Require().NoError(err)",Did you run into a problem with this?,go,1,0,1
"@@ -33,6 +33,7 @@ type Header struct {
 	Type         protocol.PacketType
 	IsLongHeader bool
 	KeyPhase     int
+	PayloadLen   protocol.ByteCount
 
 	// only needed for logging
 	isPublicHeader bool",Maybe it's worth splitting the long header and short header? Or have a substruct with only the long header / short header specific fields?,go,1,1,1
"@@ -39,6 +39,11 @@ type BuildResult struct {
         // The directory of the main package. This is useful for testing as the test
         // binary must be run in the directory of the tested package.
         MainDir string
+
+        // ImportPath is the import path of the main package. This is useful for
+        // correctly printing test results: the import path isn't always the same as
+        // the path listed on the command line.
+        ImportPath string
 }
 
 // packageAction is the struct that is serialized to JSON and hashed, to work as",I needed exactly this. :star:,go,1,0,1
"@@ -101,9 +101,9 @@ func TestWebAppStatus_Describe(t *testing.T) {
 			},
 			mockcwSvc: func(m *mocks.MockalarmStatusGetter) {
 				m.EXPECT().GetAlarmsWithTags(map[string]string{
-					""ecs-project"":     ""mockProject"",
-					""ecs-environment"": ""mockEnv"",
-					""ecs-application"": ""mockApp"",
+					""copilot-application"": ""mockProject"",
+					""copilot-environment"": ""mockEnv"",
+					""copilot-service"":     ""mockApp"",
 				}).Return(nil, mockError)
 			},
 			mockWebAppDescriber: func(m *mocks.MockserviceArnGetter) {","Can we change all the mockApp stuff to mockService, and the mockProject text to mockApp?",go,1,1,1
"@@ -154,6 +154,8 @@ func (manager *connectionManager) startConnection(consumerID identity.Identity,
 		return err
 	}
 
+	cancel = append(cancel, func() { session.RequestSessionDestroy(dialog, sessionID) })
+
 	// set the session info for future use
 	manager.sessionInfo = SessionInfo{
 		SessionID:  sessionID,","Since we're not handling the errors here, we'd either need to add logging to the function itself, or handle errors here properly. Things might start failing and we would not know about it.",go,1,1,1
"@@ -227,7 +227,9 @@ func (d *DNSServer) handleRecursive(client *dns.Client, defaultMaxResponseSize i
 		}
 
 		for _, server := range d.upstream.Servers {
-			response, _, err := client.Exchange(req, fmt.Sprintf(""%s:%s"", server, d.upstream.Port))
+			reqCopy := *req
+			reqCopy.Id = dns.Id()
+			response, _, err := client.Exchange(&reqCopy, fmt.Sprintf(""%s:%s"", server, d.upstream.Port))
 			if err != nil || response == nil {
 				d.ns.debugf(""error trying %s: %v"", server, err)
 				continue",There is a `Copy()` method for messages...,go,1,1,1
"@@ -903,6 +903,10 @@ receivers:
 		return errors.Wrap(err, ""base config from Secret could not be parsed"")
 	}
 
+	if err := checkAlertmanagerRootConfig(ctx, baseConfig); err != nil {
+		return errors.Wrap(err, ""base config check failed"")
+	}
+
 	amVersion := operator.StringValOrDefault(am.Spec.Version, operator.DefaultAlertmanagerVersion)
 	version, err := semver.ParseTolerant(amVersion)
 	if err != nil {",could be delegated to `loadCfg` (which would be good to have renamed BTW)?,go,1,1,1
"@@ -800,6 +800,8 @@ func (k *k8sOrchestrator) createControllerDeployment(volProProfile volProfile.Vo
 		return nil, err
 	}
 
+	pvc := vol.Labels.K8sPersistentVolumeClaim
+
 	if clusterIP == """" {
 		return nil, fmt.Errorf(""Volume cluster IP is required to create controller for volume 'name: %s'"", vsm)
 	}",Why do we need this change for the replica deployment?,go,1,1,1
"@@ -18,6 +18,7 @@ type DifferenceOpSpec struct {
 	NonNegative bool     `json:""nonNegative""`
 	Columns     []string `json:""columns""`
 	KeepFirst   bool     `json:""keepFirst""`
+	InitialZero bool     `json:""initialZero""`
 }
 
 func init() {",Are we going to have this value be a boolean or a customizable value?,go,1,1,1
"@@ -22,6 +22,7 @@ import (
 type Provider interface {
         Type() string
         // RunQuery runs the given query against the log provider,
-        // and then checks if there is at least one error log..
-        RunQuery(ctx context.Context, query string) (result bool, err error)
+        // and then checks if there is at least one error log.
+        // Returns the result reason if non-error occurred.
+        RunQuery(ctx context.Context, query string) (result bool, reason string, err error)
 }",Looks like now it should be `Evaluate` instead of `RunQuery`. But that is not in this PR scope.,go,0,1,1
"@@ -1584,14 +1584,13 @@ func (s *matchingEngineSuite) TestTaskExpiryAndCompletion() {
         s.matchingEngine.config.MaxTaskDeleteBatchSize = dynamicconfig.GetIntPropertyFilteredByTaskQueueInfo(2)
         // set idle timer check to a really small value to assert that we don't accidentally drop tasks while blocking
         // on enqueuing a task to task buffer
-        s.matchingEngine.config.IdleTaskqueueCheckInterval = dynamicconfig.GetDurationPropertyFnFilteredByTaskQueueInfo(time.Microsecond)
+        s.matchingEngine.config.IdleTaskqueueCheckInterval = dynamicconfig.GetDurationPropertyFnFilteredByTaskQueueInfo(time.Millisecond)
 
         testCases := []struct {
-                batchSize          int
                 maxTimeBtwnDeletes time.Duration
         }{
-                {2, time.Minute},       // test taskGC deleting due to size threshold
-                {100, time.Nanosecond}, // test taskGC deleting due to time condition
+                {time.Minute},     // test taskGC deleting due to size threshold
+                {time.Nanosecond}, // test taskGC deleting due to time condition
         }
 
         for _, tc := range testCases {",S -> ms? just check this is intentional?,go,1,1,0
"@@ -1,8 +1,15 @@
 package net
 
 import (
+        ""context""
+        ""fmt""
+        ""sort""
+
         ma ""gx/ipfs/QmNTCey11oxhb1AxDnQBRHtdhap6Ctud872NjAYPYYXPuc/go-multiaddr""
         ""gx/ipfs/QmTu65MVbemtUxJEWgsTtzv9Zv9P8rvmqNA4eG9TrTRGYc/go-libp2p-peer""
+        ""gx/ipfs/QmU7iTrsNaJfu1Rf5DrvaJLH9wJtQwmP4Dj8oPduprAU68/go-libp2p-swarm""
+        ""gx/ipfs/QmVmDhyTTUcQXFD1rRQ64fGLMSAoaQvNH3hwuaCFAPq2hy/errors""
+        routing ""gx/ipfs/QmWaDSNoSdSXU9b6udyaq9T8y6LkzMwqWxECznFqvtcTsk/go-libp2p-routing""
         ""gx/ipfs/QmZZseAa9xcK6tT3YpaShNUAEpyRAoWmUL5ojH3uGNepAc/go-libp2p-metrics""
         ""gx/ipfs/QmcNGX5RaxPPCYwa6yGXM1EcUbrreTTinixLcYGmMwf1sx/go-libp2p/p2p/protocol/ping""
         ""gx/ipfs/Qmd52WKRSwrBK5gUaJKawryZQ5by6UbNB8KVW2Zy6JtbyW/go-libp2p-host""","Blocking: hey @anorth, this works for me but you blocked this when I first did it so wanted to run it by you to make sure you are on board.",go,0,0,1
"@@ -198,6 +198,7 @@ func (node *Node) cancelBlockSubscription() {
 // Stop initiates the shutdown of the node.
 func (node *Node) Stop() {
 	node.cancelBlockSubscription()
+	node.ChainMgr.BestBlockPubSub.Shutdown()
 
 	if err := node.Host.Close(); err != nil {
 		fmt.Printf(""error closing host: %s\n"", err)","Seems like the chainmgr should shut itself down, rather than the node reaching inside of it. So maybe just have a shutdown or similar on the chainmgr?",go,1,1,1
"@@ -203,14 +203,15 @@ func run(o *Options) error {
 		v4Enabled := config.IsIPv4Enabled(nodeConfig, networkConfig.TrafficEncapMode)
 		v6Enabled := config.IsIPv6Enabled(nodeConfig, networkConfig.TrafficEncapMode)
 		proxyAll := o.config.AntreaProxy.ProxyAll
+		skipServices := o.config.AntreaProxy.SkipServices
 
 		switch {
 		case v4Enabled && v6Enabled:
-			proxier = proxy.NewDualStackProxier(nodeConfig.Name, informerFactory, ofClient, routeClient, nodePortAddressesIPv4, nodePortAddressesIPv6, proxyAll)
+			proxier = proxy.NewDualStackProxier(nodeConfig.Name, informerFactory, ofClient, routeClient, nodePortAddressesIPv4, nodePortAddressesIPv6, proxyAll, skipServices)
 		case v4Enabled:
-			proxier = proxy.NewProxier(nodeConfig.Name, informerFactory, ofClient, false, routeClient, nodePortAddressesIPv4, proxyAll)
+			proxier = proxy.NewProxier(nodeConfig.Name, informerFactory, ofClient, false, routeClient, nodePortAddressesIPv4, proxyAll, skipServices)
 		case v6Enabled:
-			proxier = proxy.NewProxier(nodeConfig.Name, informerFactory, ofClient, true, routeClient, nodePortAddressesIPv6, proxyAll)
+			proxier = proxy.NewProxier(nodeConfig.Name, informerFactory, ofClient, true, routeClient, nodePortAddressesIPv6, proxyAll, skipServices)
 		default:
 			return fmt.Errorf(""at least one of IPv4 or IPv6 should be enabled"")
 		}",should there be a check in options.go with a warning if AntreaProxy is disabled by `len(skipServices) > 0`?,go,1,1,1
"@@ -389,7 +389,7 @@ func (w *worker) reader(offset, end int64, closeOpen bool) (io.ReadCloser, error
 	r := w.rc
 	if w.rc == nil {
 		r, err = w.r.cacheFs().openRateLimited(func() (io.ReadCloser, error) {
-			return w.r.cachedObject.Object.Open(&fs.SeekOption{Offset: offset}, &fs.RangeOption{Start: offset, End: end})
+			return w.r.cachedObject.Object.Open(&fs.RangeOption{Start: offset, End: end - 1})
 		})
 		if err != nil {
 			return nil, err",why a -1 here? @ncw,go,0,0,1
"@@ -589,9 +589,6 @@ func (b *bucket) ErrorAs(err error, i interface{}) bool {
 }
 
 func (b *bucket) ErrorCode(err error) gcerrors.ErrorCode {
-        if code := gcerrors.Code(err); code != gcerrors.Unknown {
-                return code
-        }
         serr, ok := err.(azblob.StorageError)
         switch {
         case !ok:","Note: I moved this to the concrete class (blob.go). If the driver produces an error that already has an error code, we should always just use it.",go,0,0,1
"@@ -18,6 +18,7 @@ import (
 	""context""
 	""errors""
 	""fmt""
+	""github.com/GoogleCloudPlatform/compute-image-tools/daisy""
 	""strconv""
 	""testing""
 ",Separate this import from the std imports,go,1,1,1
"@@ -92,13 +92,13 @@ type Image struct {
 // ImageWithHealthcheck represents a container image with health check.
 type ImageWithHealthcheck struct {
 	Image       `yaml:"",inline""`
-	HealthCheck *ContainerHealthCheck `yaml:""healthcheck""`
+	HealthCheck *ContainerHealthCheck `yaml:""healthcheck""` // This is used as a pointer so that we can use `{{- if .ContainerHealthCheck}}` for manifest rendering.
 }
 
 // ImageWithPortAndHealthcheck represents a container image with an exposed port and health check.
 type ImageWithPortAndHealthcheck struct {
 	ImageWithPort `yaml:"",inline""`
-	HealthCheck   *ContainerHealthCheck `yaml:""healthcheck""`
+	HealthCheck   *ContainerHealthCheck `yaml:""healthcheck""` // This is used as a pointer so that we can use `{{- if .ContainerHealthCheck}}` for manifest rendering.
 }
 
 // ImageWithPort represents a container image with an exposed port.",Can we do `{{- if not .ImageConfig.HealthCheck.IsEmpty}}` instead?,go,1,1,1
"@@ -16,8 +16,11 @@
 package engine
 
 import (
+	""encoding/json""
+	""fmt""
 	""io/ioutil""
 	""path/filepath""
+	""runtime""
 	""strings""
 	""testing""
 	""time""","nit: can you group the imports to be similar to what they were before: misc packages, empty line, ""github.com/aws/amazon-ecs-agent/xxx"" packages, empty line, ""github.com/other/xxx"" packages",go,1,1,1
"@@ -60,8 +60,8 @@ var (
         Default = Config{
                 NodeType: FullNodeType,
                 Network: Network{
-                        Host:                                ""127.0.0.1"",
-                        Port:                                4689,
+                        Host: ""127.0.0.1"",
+                        Port: 4689,
                         MsgLogsCleaningInterval:             2 * time.Second,
                         MsgLogRetention:                     5 * time.Second,
                         HealthCheckInterval:                 time.Second,",File is not `goimports`-ed,go,0,1,1
"@@ -0,0 +1,17 @@
+package webhook
+
+import (
+	""k8s.io/apimachinery/pkg/runtime""
+
+	""github.com/jetstack/cert-manager/pkg/apis/certmanager/v1alpha1""
+	""github.com/jetstack/cert-manager/pkg/internal/apis/certmanager/install""
+)
+
+var (
+	Scheme = runtime.NewScheme()
+)
+
+func init() {
+	v1alpha1.AddToScheme(Scheme)
+	install.Install(Scheme)
+}",I've introduced a dedicated scheme for the webhook instead of `pkg/api` - this scheme has the internal API group registered as well as defaulting and conversion functions registered against `v1alpha1` via `github.com/jetstack/cert-manager/pkg/internal/apis/certmanager/install`,go,1,1,1
"@@ -78,7 +78,7 @@ func (collector *Metrics) Describe(d chan<- *prometheus.Desc) {
 
 func (collector *Metrics) descsByDevice(d chan<- *prometheus.Desc, device *wgtypes.Device) {
         if device == nil {
-                collector.logCtx.Error(""BUG: called descsByDevice with nil device"")
+                collector.logCtx.Debug(""BUG: called descsByDevice with nil device"")
                 return
         }
 ",This one seems like a real error to me,go,0,1,1
"@@ -33,6 +33,7 @@ var (
 	// This variable is set at build time using -ldflags parameters.
 	// See: https://stackoverflow.com/a/11355611
 	gitSha1 string
+	options *compileopts.Options
 )
 
 // commandError is an error type to wrap os/exec.Command errors. This provides",Globals are a bad idea. Can you pass this options object manually to all `executeCommand` calls? You can usually use `config.Options` for that.,go,1,1,1
"@@ -233,7 +233,15 @@ func (oc *OCSPMonitor) run() {
         quitCh := s.quitCh
         s.mu.Unlock()
 
-        defer s.grWG.Done()
+        var doShutdown bool
+        defer func() {
+                // Need to decrement before shuting down, otherwise shutdown
+                // would be stuck waiting on grWG to go down to 0.
+                s.grWG.Done()
+                if doShutdown {
+                        s.Shutdown()
+                }
+        }()
 
         oc.mu.Lock()
         shutdownOnRevoke := oc.shutdownOnRevoke","@wallyqs @variadico Could you please review this part: what was happening is that when run() decides to call s.Shutdown(), this go routine would be blocked because Shutdown() would be waiting on grWG.Wait() that would never be done because this go routine itself had not yet called s.grWG.Done(). Can you think of if this would have been user-visible? And if so, what would be the symptoms? If not user-visible, this is just a fix that will help make sure that there are not left-over go routines when a test completes.",go,0,1,0
"@@ -135,9 +135,8 @@ func keyregTxEncode(tx transactions.Transaction, ad transactions.ApplyData) v1.T
 	}
 }
 
-func assetParams(creator basics.Address, params basics.AssetParams) v1.AssetParams {
+func assetParams(creator basics.Address, aidx basics.AssetIndex, params basics.AssetParams) v1.AssetParams {
 	paramsModel := v1.AssetParams{
-		Creator:       creator.String(),
 		Total:         params.Total,
 		DefaultFrozen: params.DefaultFrozen,
 	}",Why pass in `aidx`?,go,1,0,1
"@@ -130,10 +130,11 @@ func (s *Service) deleteVPC() error {
 	_, err := s.scope.EC2.DeleteVpc(input)
 	if err != nil {
 		// Ignore if it's already deleted
-		if code, ok := awserrors.Code(err); code != ""InvalidVpcID.NotFound"" && ok {
-			return errors.Wrapf(err, ""failed to delete vpc %q"", vpc.ID)
+		if code, ok := awserrors.Code(err); code == ""InvalidVpcID.NotFound"" && ok {
+			klog.V(4).Info(""Skipping VPC deletion, VPC not found"")
+			return nil
 		}
-		return err
+		return errors.Wrapf(err, ""failed to delete vpc %q"", vpc.ID)
 	}
 
 	klog.V(2).Infof(""Deleted VPC %q"", vpc.ID)","Nice, +1 on this change. the flow is much easier to read",go,1,0,1
"@@ -464,10 +464,12 @@ func (target *BuildTarget) AllURLs(state *BuildState) []string {
 // resolveDependencies matches up all declared dependencies to the actual build targets.
 // TODO(peterebden,tatskaari): Work out if we really want to have this and how the suite of *Dependencies functions
 //                             below should behave (preferably nicely).
-// TODO(tatskaari): Work out if we can use a channel instead of a callback.
 func (target *BuildTarget) resolveDependencies(graph *BuildGraph, callback func(*BuildTarget) error) error {
 	var g errgroup.Group
-	target.mutex.RLock()
+
+	target.mutex.Lock()
+	defer target.mutex.Unlock()
+
 	for i := range target.dependencies {
 		dep := &target.dependencies[i]
 		if len(dep.deps) > 0 {",Did manage to do this but it wasn't much better because we have to pass the error group back to the caller. Don't think it's really worth changing now.,go,1,1,1
"@@ -27,4 +27,7 @@ type Response struct {
 	Headers transport.Headers
 
 	// TODO Response context?
+
+	// TODO Allow users to specify that this JSON response contains an
+	// application error.
 }",Perhaps indicated through a header or status code... prefer 200 w header :),go,1,1,0
"@@ -35,6 +35,8 @@ var cipherMap = map[string]uint16{
 
 func defaultCipherSuites() []uint16 {
 	return []uint16{
+		tls.TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,
+		tls.TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,
 		tls.TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
 		tls.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
 		tls.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,",I think we should put ECDSA first..,go,1,0,1
"@@ -16,6 +16,7 @@ type BlockProposer interface {
 	SendHello(ci *block.ChainInfo) error
 	SendOwnBlock(ci *block.ChainInfo) error
 	SendGossipBlock(ci *block.ChainInfo) error
+	WaitForTarget(ci *block.ChainInfo) func()
 }
 
 // Manager sync the chain.","I think `WaiterForTarget` would be slightly better, since this call doesn't block.",go,1,1,1
"@@ -9,9 +9,9 @@ import (
         ""io/ioutil""
         ""strings""
 
-        ""gopkg.in/editorconfig/editorconfig-core-go.v1""
         ""gopkg.in/macaron.v1""
 
+        ""github.com/editorconfig/editorconfig-core-go/v2""
         ""github.com/gogs/git-module""
 
         ""gogs.io/gogs/internal/db""",This import grouping should be changed.,go,1,0,1
"@@ -24,10 +24,12 @@ type Cleaner struct {
 
 // SessionStorage keeps sessions and allows removing them by proposal id
 type SessionStorage interface {
-	RemoveForService(serviceId string)
+	RemoveForService(serviceID string)
 }
 
 // Cleanup removes sessions of stopped service
-func (cleaner *Cleaner) Cleanup(instance *Instance) {
-	cleaner.SessionStorage.RemoveForService(string(instance.id))
+func (cleaner *Cleaner) Cleanup(event EventPayload) {
+	if event.Status == string(NotRunning) {
+		cleaner.SessionStorage.RemoveForService(event.ID)
+	}
 }","Its probably not a `Cleanup` then, since imho its should be called only once and we don't care about event's state.",go,1,1,1
"@@ -158,6 +158,9 @@ type NetworkPolicy struct {
         // Priority represents the relative priority of this Network Policy as compared to
         // other Network Policies. Priority will be unset (nil) for K8s Network Policy.
         Priority *float64
+        // TierPriority represents the priority of the Tier associated with this Network
+        // Policy. The TierPriority will remain nil for K8s NetworkPolicy.
+        TierPriority *uint32
 }
 
 // Direction defines traffic direction of NetworkPolicyRule.","NetworkPolicy is a word, and should be in one line?",go,1,1,1
"@@ -23,13 +23,15 @@ const endpointARNShapeTmplDef = `
 
 		// updateArnableField updates the value of the input field that 
 		// takes an ARN as an input. This method is useful to backfill 
-		// the parsed resource name from ARN into the input member. 
-		func (s *{{ $.ShapeName }}) updateArnableField(v string) error {
+		// the parsed resource name from ARN into the input member.
+		// It returns a pointer to a modified copy of input and an error.
+		// Note that original input is not modified. 
+		func (s {{ $.ShapeName }}) updateArnableField(v string) (interface{}, error) {
 			if s.{{ $name }} == nil {
-				return fmt.Errorf(""member {{ $name }} is nil"")
+				return nil, fmt.Errorf(""member {{ $name }} is nil"")
 			}
 			s.{{ $name }} = aws.String(v)
-			return nil
+			return &s, nil 
 		}
 	{{ end -}}
 {{ end }}","Should this create a copy of `s` before assigning the value, then return the copy?",go,1,1,1
"@@ -503,12 +503,14 @@ type TaskConfig struct {
 }
 
 // TaskPlatform returns the platform for the service.
-func (t *TaskConfig) TaskPlatform() (*string, error) {
-	if t.Platform.PlatformString == nil {
-		return nil, nil
+func (t *TaskConfig) TaskPlatform() *string {
+	if t.Platform.IsEmpty() {
+		return nil
+	}
+	if t.IsWindows() {
+		return aws.String(platformString(OSWindows, t.Platform.Arch()))
 	}
-	val := string(*t.Platform.PlatformString)
-	return &val, nil
+	return aws.String(platformString(t.Platform.OS(), t.Platform.Arch()))
 }
 
 // IsWindows returns whether or not the service is building with a Windows OS.",what if `Arch` is empty? should we instead just return `OSWindows`?,go,1,1,1
"@@ -487,10 +487,17 @@ func (js *jetStream) setupMetaGroup() error {
         // but do not form our own.
         if ln := s.getOpts().LeafNode; len(ln.Remotes) > 0 {
                 sys := s.SystemAccount().GetName()
+        ENDFOR:
                 for _, r := range ln.Remotes {
                         if r.LocalAccount == sys {
+                                for _, denySub := range r.DenyImports {
+                                        if subjectIsSubsetMatch(denySub, ""$NRG.>"") {
+                                                // raft group is denied, hence there won't be anything to observe
+                                                break ENDFOR
+                                        }
+                                }
                                 cfg.Observer = true
-                                break
+                                break ENDFOR
                         }
                 }
         }",Make const that loves in raft.go so we don't break things later on?,go,0,1,1
"@@ -325,7 +325,7 @@ func (task *Task) initializeVolumes(cfg *config.Config, dockerClient dockerapi.D
 // able to handle such an occurrence appropriately (e.g. behave idempotently).
 func (task *Task) PostUnmarshalTask(cfg *config.Config,
 	credentialsManager credentials.Manager, resourceFields *taskresource.ResourceFields,
-	dockerClient dockerapi.DockerClient, ctx context.Context) error {
+	dockerClient dockerapi.DockerClient, ctx context.Context, options ...Option) error {
 	// TODO, add rudimentary plugin support and call any plugins that want to
 	// hook into this
 	task.adjustForPlatform(cfg)","I like the idea, but call to `PostUnmarshalTask` might become cumbersome with too many options",go,1,1,1
"@@ -7,9 +7,13 @@ package api
 import (
         ""bytes""
         ""errors""
+        ""fmt""
+        ""github.com/ethersphere/bee/pkg/tags""
         ""io""
         ""io/ioutil""
         ""net/http""
+        ""strings""
+        ""time""
 
         ""github.com/ethersphere/bee/pkg/jsonhttp""
         ""github.com/ethersphere/bee/pkg/storage""","Somehow this import is among the stdlib's packages. Not so important, but it would be nice to have it a few lines below within the bee imports. Also noticed in some other places in this pr...",go,0,1,1
"@@ -97,7 +97,12 @@ func MakeTypedExport(actor exec.ExecutableActor, method string) exec.ExportedFun
                 outErr, ok := out[len(out)-1].Interface().(error)
                 if ok {
                         if !(errors.ShouldRevert(outErr) || errors.IsFault(outErr)) {
-                                panic(""you are a bad person: error must be either a reverterror or a fault"")
+                                var paramStr []string
+                                for _, param := range params {
+                                        paramStr = append(paramStr, param.String())
+                                }
+                                msg := fmt.Sprintf(""actor: %#+v, method: %s, args: %v, error: %s"", actor, method, paramStr, outErr.Error())
+                                panic(fmt.Sprintf(""you are a bad person: error must be either a reverterror or a fault: %v"", msg))
                         }
 
                         return nil, exitCode, outErr",@phritz are we ok losing the insult in this error message? I know it's meant for programmers but until we have a model for change or more than best effort infra users will run into this.,go,0,1,1
"@@ -57,7 +57,7 @@ func newTestServer(t *testing.T, o testServerOptions) *testServer {
 	settlement := swapmock.New(o.SettlementOpts...)
 	chequebook := chequebookmock.NewChequebook(o.ChequebookOpts...)
 	swapserv := swapmock.NewApiInterface(o.SwapOpts...)
-	s := debugapi.New(o.Overlay, o.PublicKey, o.PSSPublicKey, o.EthereumAddress, o.P2P, o.Pingpong, topologyDriver, o.Storer, logging.New(ioutil.Discard, 0), nil, o.Tags, acc, settlement, true, swapserv, chequebook)
+	s := debugapi.New(o.Overlay, o.PublicKey, o.PSSPublicKey, o.EthereumAddress, o.P2P, o.Pingpong, topologyDriver, o.Storer, logging.New(ioutil.Discard, 0), nil, o.Tags, acc, settlement, true, swapserv, chequebook, api.Options{})
 	ts := httptest.NewServer(s)
 	t.Cleanup(ts.Close)
 ",referencing the wrong package. should be `debugapi.Options`,go,1,1,1
"@@ -53,7 +53,7 @@ func (m NoopMetricsClient) RecordDistribution(scope int, timer int, d int) {}
 func (m NoopMetricsClient) UpdateGauge(scope int, gauge int, value float64) {}
 
 func (m NoopMetricsClient) Scope(scope int, tags ...Tag) Scope {
-	return &metricsScope{
+	return &tallyScope{
 		scope:     tally.NoopScope,
 		rootScope: tally.NoopScope,
 	}",It would be great to remove `tally` dependency here. There is `NoopScope` already but it depends on `tally` too. So you will need to create real no-op implementation.,go,1,1,1
"@@ -0,0 +1,5 @@
+package xds
+
+type RTDSConfig struct {
+        layerName string
+}",I'm not sure if there's much value in having this be in its own file,go,1,1,1
"@@ -31,7 +31,7 @@ type restBackend struct {
 }
 
 // Open opens the REST backend with the given config.
-func Open(cfg Config, rt http.RoundTripper) (restic.Backend, error) {
+func Open(cfg Config, rt http.RoundTripper) (*restBackend, error) {
 	client := &http.Client{Transport: rt}
 
 	sem, err := backend.NewSemaphore(cfg.Connections)","exported func Open returns unexported type *rest.restBackend, which can be annoying to use",go,1,1,1
"@@ -23,6 +23,8 @@ var requestReplacer = strings.NewReplacer(
 	""\n"", ""\\n"",
 )
 
+var now = time.Now
+
 // Replacer is a type which can replace placeholder
 // substrings in a string with actual values from a
 // http.Request and ResponseRecorder. Always use",This is a very elegant way to make time testable. :+1:,go,1,0,1
"@@ -19,13 +19,13 @@ var SDKVersionUserAgentHandler = request.NamedHandler{
 const execEnvVar = `AWS_EXECUTION_ENV`
 const execEnvUAKey = `exec_env`
 
-// AddHostExecEnvUserAgentHander is a request handler appending the SDK's
+// AddHostExecEnvUserAgentHandler is a request handler appending the SDK's
 // execution environment to the user agent.
 //
 // If the environment variable AWS_EXECUTION_ENV is set, its value will be
 // appended to the user agent string.
-var AddHostExecEnvUserAgentHander = request.NamedHandler{
-	Name: ""core.AddHostExecEnvUserAgentHander"",
+var AddHostExecEnvUserAgentHandler = request.NamedHandler{
+	Name: ""core.AddHostExecEnvUserAgentHandler"",
 	Fn: func(r *request.Request) {
 		v := os.Getenv(execEnvVar)
 		if len(v) == 0 {",Regrettably changing the name of this handler will be a breaking change in the SDK.,go,1,1,1
"@@ -52,7 +52,8 @@ func allowCorsActions(resp http.ResponseWriter, req *http.Request, corsPolicy Co
         allowedOrigin := corsPolicy.AllowedOrigin(requestOrigin)
 
         resp.Header().Set(""Access-Control-Allow-Origin"", allowedOrigin)
-        resp.Header().Set(""Access-Control-Allow-Methods"", ""POST, GET, OPTIONS, PUT, DELETE"")
+        resp.Header().Set(""Access-Control-Allow-Methods"", ""POST, GET, HEAD, OPTIONS, PUT, DELETE"")
+        resp.Header().Set(""Access-Control-Allow-Credentials"", ""true"")
 }
 
 func isPreflightCorsRequest(req *http.Request) bool {",Reason for this?,go,1,0,1
"@@ -72,7 +72,7 @@ var opts struct {
 
 	FeatureFlags struct {
 		NoUpdate           bool    `long:""noupdate"" description:""Disable Please attempting to auto-update itself.""`
-		NoCache            bool    `long:""nocache"" description:""Disable caches (NB. not incrementality)""`
+		NoCache            bool    `long:""nocache"" description:""Deprecated, use plz build --rebuild or plz test --rerun flags instead.""`
 		NoHashVerification bool    `long:""nohash_verification"" description:""Hash verification errors are nonfatal.""`
 		NoLock             bool    `long:""nolock"" description:""Don't attempt to lock the repo exclusively. Use with care.""`
 		KeepWorkdirs       bool    `long:""keep_workdirs"" description:""Don't clean directories in plz-out/tmp after successfully building targets.""`",This is confusingly named. Feature flags are what I'm calling the things that gate breaking changes between releases. Might want to revisit this.,go,1,1,1
"@@ -36,7 +36,7 @@ type Cgroup struct {
 type Resources struct {
 	// If this is true allow access to any kind of device within the container.  If false, allow access only to devices explicitly listed in the allowed_devices list.
 	// Deprecated
-	AllowAllDevices bool `json:""allow_all_devices,omitempty""`
+	AllowAllDevices *bool `json:""allow_all_devices,omitempty""`
 	// Deprecated
 	AllowedDevices []*Device `json:""allowed_devices,omitempty""`
 	// Deprecated",Why did you drop the `omitempty` tag? That is meant to qualify if a field is optional or not.,go,1,1,1
"@@ -144,6 +144,17 @@ func blockGetCert(tx *sql.Tx, rnd basics.Round) (blk bookkeeping.Block, cert agr
 	return
 }
 
+func blockReplaceIfExists(tx *sql.Tx, blk bookkeeping.Block, cert agreement.Certificate) error {
+	_, err := tx.Exec(""UPDATE blocks SET proto=?, hdrdata=?, blkdata=?, certdata=? WHERE rnd=?"",
+		blk.CurrentProtocol,
+		protocol.Encode(&blk.BlockHeader),
+		protocol.Encode(&blk),
+		protocol.Encode(&cert),
+		blk.Round(),
+	)
+	return err
+}
+
 func blockPut(tx *sql.Tx, blk bookkeeping.Block, cert agreement.Certificate) error {
 	var max sql.NullInt64
 	err := tx.QueryRow(""SELECT MAX(rnd) FROM blocks"").Scan(&max)","Can you examine the result and return bool which indicates if the row was updated or not ? ( and it case it was updated, write an info line to the log file )",go,1,1,1
"@@ -320,7 +320,7 @@ func (s *Server) isClientAuthorized(c *client) bool {
 				var ok bool
 				user, ok = s.users[u]
 				if !ok {
-					c.Debugf(""User in cert [%q], not found"", euser)
+					c.Debugf(""User in cert [%q], not found"", u)
 					return false
 				}
 				euser = u","I'd rephrase this a bit, `User [%q] not found in cert`.",go,1,1,1
"@@ -32,14 +32,15 @@ func requireGrowChain(ctx context.Context, t *testing.T, blockSource *th.TestFet
 	link := requireHeadTipset(t, chainStore)
 
 	signer, ki := types.NewMockSignersAndKeyInfo(1)
-	mockSignerPubKey := ki[0].PublicKey()
+	minerOwner, err := ki[0].Address()
+	require.NoError(t, err)
 
 	for i := uint(0); i < numBlocks; i++ {
 		fakeChildParams := th.FakeChildParams{
 			Parent:      link,
 			GenesisCid:  dstP.genCid,
 			Signer:      signer,
-			MinerPubKey: mockSignerPubKey,
+			MinerWorker: minerOwner,
 			StateRoot:   dstP.genStateRoot,
 		}
 		linkBlock := th.RequireMkFakeChild(t, fakeChildParams)",Name this `minerWorker` for consistency with the same lines below (or change the others to match this).,go,1,1,1
"@@ -40,6 +40,7 @@ type (
 	// disable them.
 	host struct{}
 
+	// stringDetector is a Detector that provides information about the
 	stringDetector struct {
 		schemaURL string
 		K         attribute.Key",This is an incomplete sentence. Maybe something got cutoff?,go,1,1,1
"@@ -66,6 +66,12 @@ func (i *interpreter) LoadBuiltins(filename string, contents []byte, statements
 		return err
 	} else if len(contents) != 0 {
 		stmts, err := i.parser.ParseData(contents, filename)
+		for _, stmt := range stmts {
+			if stmt.FuncDef != nil {
+				stmt.FuncDef.KeywordsOnly = !whitelistedKwargs(stmt.FuncDef.Name, filename)
+				stmt.FuncDef.IsBuiltin = true
+			}
+		}
 		return i.loadBuiltinStatements(s, stmts, err)
 	}
 	stmts, err := i.parser.parse(filename)",This got lost in the embedding switchover - moving the code to here so we only do this to the actual builtins (to mimic previous behaviour),go,1,1,1
"@@ -787,7 +787,11 @@ func (a *FakeWebAPI) DisableStaticAdmin(ctx context.Context, req *webservice.Dis
 	return nil, status.Error(codes.Unimplemented, """")
 }
 
-func (a *FakeWebAPI) UpdateProjectSingleSignOn(ctx context.Context, req *webservice.UpdateProjectSingleSignOnRequest) (*webservice.UpdateProjectSingleSignOnResponse, error) {
+func (a *FakeWebAPI) UpdateProjectSSOConfig(ctx context.Context, req *webservice.UpdateProjectSSOConfigRequest) (*webservice.UpdateProjectSSOConfigResponse, error) {
+	return nil, status.Error(codes.Unimplemented, """")
+}
+
+func (a *FakeWebAPI) UpdateProjectRBACConfig(ctx context.Context, req *webservice.UpdateProjectRBACConfigRequest) (*webservice.UpdateProjectRBACConfigResponse, error) {
 	return nil, status.Error(codes.Unimplemented, """")
 }
 ",`ctx` is unused in UpdateProjectSSOConfig,go,1,1,1
"@@ -563,6 +563,7 @@ func makeStatefulSetSpec(p monitoringv1.Prometheus, c *Config, ruleConfigMapName
 		},
 	}
 
+	promVolumeMounts = append(promVolumeMounts, p.Spec.VolumeMounts...)
 	for _, name := range ruleConfigMapNames {
 		promVolumeMounts = append(promVolumeMounts, v1.VolumeMount{
 			Name:      name,",I am guessing this won't interfere with the merge patch we do?,go,0,1,1
"@@ -30,7 +30,13 @@ import (
 	""go.uber.org/zap/zapcore""
 )
 
-const _error = ""error""
+const (
+	_error              = ""error""
+	_successfulInbound  = ""Handled inbound request.""
+	_successfulOutbound = ""Made outbound call.""
+	_errorInbound       = ""Error handling inbound request.""
+	_errorOutbound      = ""Error making outbound call.""
+)
 
 // A call represents a single RPC along an edge.
 //","Are we using this constant anywhere? It was introduced in this commit, but I don't see it used here.",go,1,1,1
"@@ -49,6 +49,8 @@ const (
 	DeviceETUpdatedSuffix = ""/updated""
 	// DeviceETStateUpdateSuffix the topic suffix for device state update event
 	DeviceETStateUpdateSuffix = ""/state/update""
+	// DeviceETStateUpdateResultSuffix the topic suffix for device state update result event
+	DeviceETStateUpdateResultSuffix = ""/state/update/result""
 	// DeviceETStateGetSuffix the topic suffix for device state get event
 	DeviceETStateGetSuffix = ""/state/get""
 ","there're some codes that also can be replaced by this new topic in edge/test/integration/device/device_test.go, we can modify those also.",go,1,1,1
"@@ -88,6 +88,16 @@ type BareRootMetadataV3 struct {
 	// of writing to the given folder.
 	FinalizedInfo *tlf.HandleExtension `codec:""fi,omitempty""`
 
+	// The sequence number of the global Keybase Merkle tree at the
+	// time this update was created (from the writer's perspective).
+	// This field was added to V3 after it was live for a while, and
+	// older clients that don't know about this field yet might copy
+	// it into new updates via the unknown fields copier. Which means
+	// new MD updates might end up referring to older Merkle roots.
+	// That's ok since this is just a hint anyway, and shouldn't be
+	// fully trusted when checking MD updates against the Merkle tree.
+	KBMerkleSeqNo MerkleSeqNo `codec:""msn,omitempty""`
+
 	codec.UnknownFieldSetHandler
 }
 ",What are the implication of this once we start checking merkle tree in KBFS clients? Does this make verification more expensive?,go,1,1,1
"@@ -18,7 +18,7 @@ import (
 	""net/http""
 	""time""
 
-	""istio.io/fortio/log""
+	""fortio.org/fortio/log""
 	""istio.io/tools/isotope/convert/pkg/graph/svc""
 	""istio.io/tools/isotope/convert/pkg/graph/svctype""
 	""istio.io/tools/isotope/service/pkg/srv/prometheus""",File is not `goimports`-ed (from `goimports`),go,0,1,1
"@@ -65,6 +65,10 @@ type Harness interface {
         // MaxBatchSizes returns the maximum size of SendBatch/Send(Na|A)cks, or 0
         // if there's no max.
         MaxBatchSizes() (int, int)
+
+        // SupportsMultipleSubscriptions returns true iff the provider supports
+        // multiple subscriptions for the same topic.
+        SupportsMultipleSubscriptions() bool
 }
 
 // HarnessMaker describes functions that construct a harness for running tests.",s/returns true iff/reports whether/,go,1,1,0
"@@ -262,7 +262,7 @@ func acceptedEncodings(r *http.Request) []string {
                 return []string{}
         }
 
-        var prefs []encodingPreference
+        prefs := []encodingPreference{}
 
         for _, accepted := range strings.Split(acceptEncHeader, "","") {
                 parts := strings.Split(accepted, "";"")","_sniff_ Is this the smell of... bikeshedding? :laughing: Or is this an actual lint warning? If so, why? (Personally I prefer the `var` syntax to explicitly make the definition a zero initialization)",go,1,1,1
"@@ -109,6 +109,16 @@ func (r *Resource) String() string {
 	return r.attrs.Encoded(attribute.DefaultEncoder())
 }
 
+func (r *Resource) MarshalLog() interface{} {
+	return struct {
+		Attributes []attribute.KeyValue
+		SchemaURL  string
+	}{
+		Attributes: r.attrs.ToSlice(),
+		SchemaURL:  r.schemaURL,
+	}
+}
+
 // Attributes returns a copy of attributes from the resource in a sorted order.
 // To avoid allocating a new slice, use an iterator.
 func (r *Resource) Attributes() []attribute.KeyValue {",How well does this render? Do we need to add marshaling instructions to the `attribute.KeyValue` type?,go,1,1,1
"@@ -255,7 +255,7 @@ func (s *Service) getAPIServerClassicELBSpec() (*infrav1.ClassicELB, error) {
 			},
 		},
 		HealthCheck: &infrav1.ClassicELBHealthCheck{
-			Target:             fmt.Sprintf(""%v:%d"", infrav1.ClassicELBProtocolSSL, 6443),
+			Target:             fmt.Sprintf(""%v:%d"", infrav1.ClassicELBProtocolTCP, 6443),
 			Interval:           10 * time.Second,
 			Timeout:            5 * time.Second,
 			HealthyThreshold:   5,","I'd rather update the listeners/health checks to use custom order/set of SSL ciphers. If not possible, we might want to compare our list with the ELB one cc @randomvariable",go,0,1,1
"@@ -160,7 +160,12 @@ func RemoveContainers(isEdgeNode bool, execer utilsexec.Interface) error {
 }
 
 func cleanDirectories(isEdgeNode bool) error {
-	var dirToClean = []string{""/var/lib/edged"", ""/etc/kubeedge""}
+	var dirToClean = []string{
+		""/var/lib/edged"",
+		""/etc/kubeedge"",
+		""/var/lib/kubeedge"",
+		""/var/log/kubeedge"",
+	}
 
 	if isEdgeNode {
 		dirToClean = append(dirToClean, ""/var/lib/dockershim"", ""/var/run/kubernetes"", ""/var/lib/cni"")",try use existed const in keadm,go,1,0,1
"@@ -315,6 +315,10 @@ func assetTransferTxEncode(tx transactions.Transaction, ad transactions.ApplyDat
 		xfer.CloseTo = tx.AssetTransferTxnFields.AssetCloseTo.String()
 	}
 
+	if ad.AssetClosingAmount != 0 {
+		xfer.CloseToAmount = ad.AssetClosingAmount
+	}
+
 	return v1.Transaction{
 		AssetTransfer: &xfer,
 	}",why do we care about v1?,go,1,0,1
"@@ -19,6 +19,7 @@ import (
 
 // mspPlumbing is the subset of the plumbing.API that MinerSetPrice uses.
 type mspPlumbing interface {
+	MessagePreview(ctx context.Context, from, to address.Address, method string, params ...interface{}) (types.GasUnits, error)
 	MessageSend(ctx context.Context, from, to address.Address, value *types.AttoFIL, gasPrice types.AttoFIL, gasLimit types.GasUnits, method string, params ...interface{}) (cid.Cid, error)
 	MessageWait(ctx context.Context, msgCid cid.Cid, cb func(*types.Block, *types.SignedMessage, *types.MessageReceipt) error) error
 	ConfigSet(dottedKey string, jsonString string) error",`PreviewMinerSetPrice` should define its own plumbing that replaces `MessageSend` with `MessagePreview`.,go,1,1,1
"@@ -67,14 +67,14 @@ TLS certificates from various issuing sources.
 It will ensure certificates are valid and up to date periodically, and attempt
 to renew certificates at an appropriate time before expiry.`,
 
-		// TODO: Refactor this function from this package
-		Run: func(cmd *cobra.Command, args []string) {
+		RunE: func(cmd *cobra.Command, args []string) error {
 			if err := o.Validate(args); err != nil {
-				logf.Log.Error(err, ""error validating options"")
+				return fmt.Errorf(""error validating options: %s"", err)
 			}
 
 			logf.Log.Info(""starting controller"", ""version"", util.AppVersion, ""git-commit"", util.AppGitCommit)
 			o.RunCertManagerController(stopCh)
+			return nil
 		},
 	}
 ","How does RunE handle displaying errors to users? Would we be better to use `Run` as before so that we can control the output format? Don't think it's a big deal, but I'm just uncertain how RunE actually works  ",go,1,1,1
"@@ -111,8 +111,9 @@ func (m *manager) updatePodStatus() {
 		err := m.metaClient.PodStatus(pod.Namespace).Update(pod.Name, edgeapi.PodStatusRequest{UID: pod.UID, Name: pod.Name, Status: s})
 		if err != nil {
 			klog.Errorf(""Update pod status failed err :%v"", err)
+			return
 		}
-		klog.Infof(""Status for pod %s updated successfully: %+v"", pod.Name, podStatus)
+		klog.V(4).Infof(""Status for pod %s updated successfully"", pod.Name)
 		m.apiStatusVersions[pod.UID] = podStatus.DeepCopy()
 	}
 }",We should return here instead of adding the else. :),go,1,1,1
"@@ -113,6 +113,7 @@ NETWORK COMMANDS
   go-filecoin id                     - Show info about the network peers
   go-filecoin ping <peer ID>...      - Send echo request packets to p2p network members
   go-filecoin swarm                  - Interact with the swarm
+  go-filecoin stats                  - Monitor statistics on your network usage
 
 ACTOR COMMANDS
   go-filecoin actor                  - Interact with actors. Actors are built-in smart contracts.",nit: this maybe fits better under the tools heading,go,1,1,1
"@@ -80,6 +80,12 @@ func TestIssuingController(t *testing.T) {
 		secretName               = ""test-crt-tls""
 	)
 
+	// Create Namespace
+	_, err := kubeClient.CoreV1().Namespaces().Create(context.TODO(), &corev1.Namespace{ObjectMeta: metav1.ObjectMeta{Name: namespace}}, metav1.CreateOptions{})
+	if err != nil {
+		t.Fatal(err)
+	}
+
 	// Create a new private key
 	sk, err := utilpki.GenerateRSAPrivateKey(2048)
 	if err != nil {",Where were these namespaces coming before? Why are they now being created here now?,go,1,1,1
"@@ -189,13 +189,13 @@ func (c *Operator) Run(stopc <-chan struct{}) error {
 	go func() {
 		v, err := c.kclient.Discovery().ServerVersion()
 		if err != nil {
-			errChan <- fmt.Errorf(""communicating with server failed: %s"", err)
+			errChan <- errors.Wrap(err, ""communicating with server failed"")
 			return
 		}
 		c.logger.Log(""msg"", ""connection established"", ""cluster-version"", v)
 
 		if err := c.createTPRs(); err != nil {
-			errChan <- err
+			errChan <- errors.Wrap(err, ""creating TPRs failed"")
 			return
 		}
 		errChan <- nil",Is this function rather a candidate for `sync/errgroup` as well?,go,1,1,1
"@@ -243,6 +243,7 @@ func buildControllerContext(ctx context.Context, stopCh <-chan struct{}, opts *o
 		Client:                    cl,
 		CMClient:                  intcl,
 		GWClient:                  gwcl,
+		Discovery:                 cl.Discovery(),
 		Recorder:                  recorder,
 		KubeSharedInformerFactory: kubeSharedInformerFactory,
 		SharedInformerFactory:     sharedInformerFactory,",nit: should this be `DiscoveryClient`?,go,1,0,1
"@@ -29,6 +29,13 @@ import (
 	""sigs.k8s.io/controller-runtime/pkg/client""
 )
 
+const (
+	// AnnotationCleanFinalizer key
+	AnnotationCleanFinalizer = `chaos-mesh/cleanFinalizer`
+	// AnnotationCleanFinalizerForced value
+	AnnotationCleanFinalizerForced = `forced`
+)
+
 // Reconciler for common chaos
 type Reconciler struct {
 	reconciler.InnerReconciler",It seems we should define the annotation key prefix for chaos-mesh. What about `chaosmesh.pingcap.com/` @zhouqiang-cl @cwen0,go,0,1,1
"@@ -35,3 +35,7 @@ func (s *stub) ChangedLines() (map[string][]int, error) {
 func (s *stub) Checkout(revision string) error {
         return fmt.Errorf(""Unknown SCM, can't checkout"")
 }
+
+func (s *stub) CurrentRevDate(format string) string {
+        return ""<unknown>""
+}",Don't strongly mind which but let's pick one of either `<unknown>` or `UNKNOWN` (as in the git impl when it can't be determined),go,1,1,1
"@@ -347,6 +347,8 @@ func Main() int {
 		}
 	}
 
+	// todo - I wonder can these go away because of
+	// https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#admission-webhook-metrics
 	validationTriggeredCounter := prometheus.NewCounter(prometheus.CounterOpts{
 		Name: ""prometheus_operator_rule_validation_triggered_total"",
 		Help: ""Number of times a prometheusRule object triggered validation"",","It would be worth checking. Reading the docs, I'm not sure how the metrics look like when `failurePolicy` is `None`.",go,1,1,1
"@@ -17,3 +17,5 @@ var (
         GenerateCommonBinPrefixes = generateCommonBinPrefixes
         PeerPingPollTime          = &peerPingPollTime
 )
+
+type PeerFilterFunc = peerFilterFunc",is this used anywhere?,go,1,0,1
"@@ -186,7 +186,8 @@ func CIDRFromCalicoNet(ipNet calinet.IPNet) CIDR {
 
 func CIDRFromIPNet(ipNet *net.IPNet) CIDR {
 	ones, _ := ipNet.Mask.Size()
-	ip := FromNetIP(ipNet.IP)
+	// Mask the IP before creating the CIDR so that we have it in canonical format.
+	ip := FromNetIP(getMaskedIp(ipNet))
 	if ip.Version() == 4 {
 		return V4CIDR{
 			addr:   ip.(V4Addr),","I think the stdlib's `net.IP` has a `Mask()` method, does that do what we need?",go,1,1,1
"@@ -26,6 +26,12 @@ var (
 	// Timers
 	amTimer = metrics.NewTimerMs(""consensus/apply_message"", ""Duration of message application in milliseconds"", msgMethodKey)
 	pbTimer = metrics.NewTimerMs(""consensus/process_block"", ""Duration of block processing in milliseconds"")
+	ptTimer = metrics.NewTimerMs(""consensus/process_tipset"", ""Duration of tipset processing in milliseconds"")
+
+	// Sizes
+	pbSize = metrics.NewInt64ByteBucket(""consensus/block_size"", ""The size in bytes of a block"")
+	amSize = metrics.NewInt64ByteBucket(""consensus/message_size"", ""The size in bytes of a message"", msgMethodKey)
+	tsSize = metrics.NewInt64ByteBucket(""consensus/tipset_size"", ""The size in bytes of a tipset"")
 )
 
 // BlockRewarder applies all rewards due to the miner's owner for processing a block including block reward and gas",IMO these names are too brief now there are so many.,go,1,1,1
"@@ -23,6 +23,8 @@ import (
 // NOTE: json tags are required.  Any new fields you add must have json tags for the fields to be serialized.
 
 // +kubebuilder:object:root=true
+// +kubebuilder:printcolumn:name=""action"",type=string,JSONPath=`.spec.action`
+// +kubebuilder:printcolumn:name=""duration"",type=string,JSONPath=`.spec.duration`
 // +kubebuilder:subresource:status
 // +chaos-mesh:base
 // +chaos-mesh:webhook:enableUpdate","ditto, We do not need add this feature for PodXXXChaos",go,0,1,1
"@@ -43,13 +43,13 @@ func addTestingTsfBlocks(bc Blockchain) error {
         tsf0, _ := action.NewTransfer(
                 1,
                 big.NewInt(3000000000),
-                Gen.CreatorAddr(config.Default.Chain.ID),
+                Gen.CreatorAddr(),
                 ta.Addrinfo[""producer""].Bech32(),
                 []byte{}, uint64(100000),
                 big.NewInt(10),
         )
         pubk, _ := keypair.DecodePublicKey(Gen.CreatorPubKey)
-        sig, _ := hex.DecodeString(""b14516e888e78e8dcba9af59607c8deea404f52c3df706a0bb6e1fadfda58113983b9201400ff75202fe486363a2e99052b3866595be932542bc0b860278b0753ab3fd2c66764a01"")
+        sig, _ := hex.DecodeString(""3584fe777dd090e1a7a825896f532485ea2cc35d7c300c6c56f0e2e78b51c6ded33f7d0069f4f6f6b6762306466fcff6f261bb30d9e1550f2f8be4f988e740903fd734209cb60101"")
         bd := &action.EnvelopeBuilder{}
         elp := bd.SetAction(tsf0).
                 SetDestinationAddress(ta.Addrinfo[""producer""].Bech32()).",line is 175 characters (from `lll`),go,1,0,1
"@@ -242,7 +242,7 @@ returns a spiffeid->registration entries map
 This map is used generated CSR for non-base SVIDs and update the agent cache entries
 */
 func (a *Agent) attest() (map[string]*common.RegistrationEntry, error) {
-        a.config.Log.Info(""Preparing to attest against %s"", a.config.ServerAddress.String())
+        a.config.Log.Info(""Preparing to attest against"", a.config.ServerAddress.String())
 
         plugins := a.Catalog.NodeAttestors()
         if len(plugins) != 1 {",Do we need a space at the end like the one below?,go,1,1,1
"@@ -649,6 +649,8 @@ func (k *KeybaseServiceBase) GetTLFCryptKeys(ctx context.Context,
 		return keybase1.GetTLFCryptKeysRes{}, err
 	}
 
+	ctx = context.WithValue(ctx, CtxNoAddToFavoriteKey{}, true)
+
 	tlfHandle, err := k.getHandleFromFolderName(ctx, query.TlfName, false)
 	if err != nil {
 		return res, err","`true` seems weird, since setting it to `false` doesn't do the opposite. Maybe just set it to `struct{}{}`?",go,1,1,1
"@@ -161,12 +161,9 @@ func (a *ACME) Sign(ctx context.Context, cr *v1alpha2.CertificateRequest, issuer
 
         // If the acme order has failed then so too does the CertificateRequest meet the same fate.
         if acme.IsFailureState(order.Status.State) {
-                message := fmt.Sprintf(""Failed to wait for order resource %s/%s to become ready"",
-                        expectedOrder.Namespace, expectedOrder.Name)
-                err := fmt.Errorf(""order is in %q state"", order.Status.State)
-
+                message := fmt.Sprintf(""Failed to wait for order resource %q to become ready"", expectedOrder.Name)
+                err := fmt.Errorf(""order is in %q state: %s"", order.Status.State, order.Status.Reason)
                 a.reporter.Failed(cr, err, ""OrderFailed"", message)
-
                 return nil, nil
         }
 ","In the PR description you say that this extra event information will also show up in `kubectl describe certificate`, but I only the error message being associated with a `cr` resource...a `CertificateRequest` Or does the reporter also find the associated Certificate and Order resources and add events for those too?",go,1,1,0
"@@ -106,6 +106,8 @@ type ServerConfig struct {
 	AlertsFilterDeleter alerts.FilterDeleter
 	// StoragePolicy Manager
 	StoragePolicy policy.PolicyManager
+	// StoragePoolServer is the interface to manage storage pools in the cluster
+	StoragePoolServer api.OpenStoragePoolServer
 	// Security configuration
 	Security *SecurityConfig
 	// ServerExtensions allows you to extend the SDK gRPC server","There should be a 'fake' in-memory pool server handler added to OpenStorage so that it can be served in the mock-sdk-server. If this is too difficult, then the server must handler a `nil` pool server handler.",go,1,1,1
"@@ -212,8 +212,8 @@ func (s *engine2Suite) TestRecordWorkflowTaskStartedSuccessStickyExpired() {
 	expectedResponse := historyservice.RecordWorkflowTaskStartedResponse{}
 	expectedResponse.WorkflowType = msBuilder.GetWorkflowType()
 	executionInfo = msBuilder.GetExecutionInfo()
-	if executionInfo.LastProcessedEvent != common.EmptyEventID {
-		expectedResponse.PreviousStartedEventId = executionInfo.LastProcessedEvent
+	if executionInfo.LastWorkflowTaskCompleteId != common.EmptyEventID {
+		expectedResponse.PreviousStartedEventId = executionInfo.LastWorkflowTaskCompleteId
 	}
 	expectedResponse.ScheduledEventId = di.ScheduleID
 	expectedResponse.ScheduledTime = di.ScheduledTime","is LastProcessedEvent always be WFT completed event? Could it be ActivityTaskCompleted or anything else? Here what is the PreviousStartedEventId? It does not sound right that you set a ""StartedEventId"" as WFTCompleted event id.",go,1,1,1
"@@ -4,6 +4,7 @@ import (
 	""github.com/rancher/k3s/pkg/version""
 	""github.com/rancher/spur/cli""
 	""github.com/rancher/spur/cli/altsrc""
+	""time""
 )
 
 const (",Can you move this to where the stdlib imports are?,go,1,1,1
"@@ -17,15 +17,12 @@ import (
 
 // V1 is a singleton and defines V1 address metadata
 var V1 = v1{
-	AddressLength: 21,
-	Version:       1,
+	AddressLength: 20,
 }
 
 type v1 struct {
 	// AddressLength indicates the byte length of an address
 	AddressLength int
-	// Version indicates the version number
-	Version uint8
 }
 
 // New constructs an address struct",Do we need AddressLength then?,go,1,0,1
"@@ -28,12 +28,12 @@ import (
 // marshalling. See the following issue for details:
 // https://github.com/prometheus/alertmanager/issues/1985
 type alertmanagerConfig struct {
-	Global            *globalConfig      `yaml:""global,omitempty"" json:""global,omitempty""`
-	Route             *route             `yaml:""route,omitempty"" json:""route,omitempty""`
-	InhibitRules      []*inhibitRule     `yaml:""inhibit_rules,omitempty"" json:""inhibit_rules,omitempty""`
-	Receivers         []*receiver        `yaml:""receivers,omitempty"" json:""receivers,omitempty""`
-	MuteTimeIntervals []muteTimeInterval `yaml:""mute_time_intervals,omitempty"" json:""mute_time_intervals,omitempty""`
-	Templates         []string           `yaml:""templates"" json:""templates""`
+	Global            *globalConfig       `yaml:""global,omitempty"" json:""global,omitempty""`
+	Route             *route              `yaml:""route,omitempty"" json:""route,omitempty""`
+	InhibitRules      []*inhibitRule      `yaml:""inhibit_rules,omitempty"" json:""inhibit_rules,omitempty""`
+	Receivers         []*receiver         `yaml:""receivers,omitempty"" json:""receivers,omitempty""`
+	MuteTimeIntervals []*muteTimeInterval `yaml:""mute_time_intervals,omitempty"" json:""mute_time_intervals,omitempty""`
+	Templates         []string            `yaml:""templates"" json:""templates""`
 }
 
 type globalConfig struct {",Why changing to a slice of pointers?,go,1,0,1
"@@ -296,5 +296,7 @@ func logCollectedErrors(stderr io.Reader) {
 	if err != nil {
 		log.Println(err)
 	}
-	log.Println(""Error extracting modules:\n\t"", strings.Join(errors, ""\n\t""))
+	if len(errors) > 0 {
+		log.Println(""Error extracting modules:\n\t"", strings.Join(errors, ""\n\t""))
+	}
 }",Are format strings supported for Println (not printf)?,go,1,1,1
"@@ -452,11 +452,12 @@ func (c *Controller) addNodeRoute(nodeName string, node *v1.Node) error {
 	}
 	peerGatewayIP := ip.NextIP(peerPodCIDRAddr)
 
+	ipsecTunOFPort := int32(0)
 	if c.networkConfig.EnableIPSecTunnel {
 		// Create a separate tunnel port for the Node, as OVS IPSec monitor needs to
 		// read PSK and remote IP from the Node's tunnel interface to create IPSec
 		// security policies.
-		if err = c.createIPSecTunnelPort(nodeName, peerNodeIP); err != nil {
+		if ipsecTunOFPort, err = c.createIPSecTunnelPort(nodeName, peerNodeIP); err != nil {
 			return err
 		}
 	}",you use an `int32` here but it seems that the rest of the code uses `uint32` pretty consistently (at least the OF client code does)?,go,1,1,1
"@@ -165,7 +165,7 @@ func newVRequest(cert *x509.Certificate) *certificate.Request {
 	req.CustomFields = []certificate.CustomField{
 		{
 			Type:  certificate.CustomFieldOrigin,
-			Value: ""Jetstack cert-manager"",
+			Value: ""cert-manager"",
 		},
 	}
 	return req",Maybe use `util.CertManagerUserAgent` here too?,go,1,1,1
"@@ -49,10 +49,11 @@ const (
 	rootURL           = ""https://www.jottacloud.com/jfs/""
 	apiURL            = ""https://api.jottacloud.com/""
 	baseURL           = ""https://www.jottacloud.com/""
-	tokenURL          = ""https://id.jottacloud.com/auth/realms/jottacloud/protocol/openid-connect/token""
+	defaultTokenURL   = ""https://id.jottacloud.com/auth/realms/jottacloud/protocol/openid-connect/token""
 	cachePrefix       = ""rclone-jcmd5-""
 	configDevice      = ""device""
 	configMountpoint  = ""mountpoint""
+	configTokenURL    = ""tokenURL""
 	configVersion     = 1
 )
 ",`configAuthURL` is unused (from `deadcode`),go,1,1,1
"@@ -234,7 +234,8 @@ func (g *gen) inject(pos token.Pos, name string, sig *types.Signature, set *Prov
                         }
                         if g.values[c.valueExpr] == """" {
                                 t := c.valueTypeInfo.TypeOf(c.valueExpr)
-                                name := disambiguate(""_wire""+export(typeVariableName(t))+""Value"", g.nameInFileScope)
+
+                                name := typeVariableName(t, """", func(name string) string { return ""_wire"" + export(name) + ""Value"" }, g.nameInFileScope)
                                 g.values[c.valueExpr] = name
                                 pendingVars = append(pendingVars, pendingVar{
                                         name:     name,",It was surprising to me that this default is the empty string. I realize root cause and remarked below.,go,0,0,1
"@@ -158,7 +158,7 @@ func consumerConnectFlow(t *testing.T, tequilapi *tequilapi_client.Client, consu
 	assert.Equal(t, ""New"", se.Status)
 
 	// Wait some time for session to collect stats.
-	time.Sleep(2 * time.Second)
+	time.Sleep(4 * time.Second)
 
 	err = tequilapi.ConnectionDestroy()
 	assert.NoError(t, err)","Lets do ""eventually"" approach here instead of constant timeout increase",go,1,1,1
"@@ -74,8 +74,14 @@ type cpuUsage struct {
 	User   uint64   `json:""user""`
 }
 
+type cfs struct {
+	Period uint64 `json:""period,omitempty""`
+	Quota  int64  `json:""quota,omitempty""`
+}
+
 type cpu struct {
 	Usage      cpuUsage   `json:""usage,omitempty""`
+	CFS        cfs        `json:""cfs,omitempty""`
 	Throttling throttling `json:""throttling,omitempty""`
 }
 ","Do we want to make that stats output and this the same? You have `Scheduling` field, `cfs` tag, and `CpuCfs`, `cpu_cfs` in the two different places. I think we should pick one and stick with it",go,1,1,1
"@@ -374,6 +374,13 @@ COMMIT;
 		COMMIT;
 		`,
 		// v11 database entry, in which index was added to federated_registration_entries registered_entry_id field
+		`
+		BEGIN TRANSACTION;
+		CREATE TABLE IF NOT EXISTS ""attested_node_entries"" (""id"" integer primary key autoincrement,""created_at"" datetime,""updated_at"" datetime,""spiffe_id"" varchar(255),""data_type"" varchar(255),""serial_number"" varchar(255),""expires_at"" datetime );
+		INSERT INTO attested_node_entries VALUES(1,'2018-12-19 14:26:58.227869-07:00','2018-12-19 14:26:58.227869-07:00','spiffe://example.org/host','test','111','2018-12-19 15:26:58-07:00');
+		COMMIT;
+		`,
+		// v12 database entry, in which the table 'attested_node_entries' gained two columns: 'prepared_serial_number' and 'prepared_expires_at'
 	}
 )
 ",This should be a copy of the database before it receives the migration. The migration test should ensure that the migration test has taken place.,go,1,1,1
"@@ -349,6 +349,17 @@ func (f *Folder) isWriter(ctx context.Context) (bool, error) {
 	}
 	f.handleMu.RLock()
 	defer f.handleMu.RUnlock()
+	if f.h.Type() == tlf.SingleTeam {
+		tid, err := f.h.FirstResolvedWriter().AsTeam()
+		if err != nil {
+			return false, err
+		}
+		isWriter, err := f.fs.config.KBPKI().IsTeamWriter(ctx, tid, session.UID)
+		if err != nil {
+			return false, err
+		}
+		return isWriter, nil
+	}
 	return f.h.IsWriter(session.UID), nil
 }
 ",It seems this will be called pretty often. Do we need a short TTL cache in `libkbfs`?,go,1,1,1
"@@ -69,6 +69,7 @@ const ECPrM uint64 = 100
 // TODO: If the following PR is merged - and the network doesn't define a
 // largest sector size - this constant will need to be reconsidered.
 // https://github.com/filecoin-project/specs/pull/318
+// NOTE(anorth): This height is excessive, but safe, with the Rational PoSt construction.
 const AncestorRoundsNeeded = miner.LargestSectorSizeProvingPeriodBlocks + miner.PoStChallengeWindowBlocks
 
 // A Processor processes all the messages in a block or tip set.",yup should be `miner.PoStChallengeWindowBlocks`,go,1,0,0
"@@ -72,6 +72,9 @@ func (f MigrateRepo) ParseRemoteAddr(user *db.User) (string, error) {
 		if len(f.AuthUsername)+len(f.AuthPassword) > 0 {
 			u.User = url.UserPassword(f.AuthUsername, f.AuthPassword)
 		}
+		if u.Scheme == ""git"" && u.Port() != """" && (strings.Contains(remoteAddr, ""%0d"") || strings.Contains(remoteAddr, ""%0a"")) {
+			return """", db.ErrInvalidCloneAddr{IsURLError: true}
+		}
 		remoteAddr = u.String()
 	} else if !user.CanImportLocal() {
 		return """", db.ErrInvalidCloneAddr{IsPermissionDenied: true}",Why is checking `u.Scheme` and `u.Port()` necessary? Shouldn't we disallow malicious chars in all cases?,go,1,1,1
"@@ -208,7 +208,7 @@ func (arch *Archiver) loadSubtree(ctx context.Context, node *restic.Node) *resti
 
 // SaveDir stores a directory in the repo and returns the node. snPath is the
 // path within the current snapshot.
-func (arch *Archiver) SaveDir(ctx context.Context, snPath string, fi os.FileInfo, dir string, previous *restic.Tree) (d FutureTree, err error) {
+func (arch *Archiver) SaveDir(ctx context.Context, snPath string, fi os.FileInfo, dir string, previous *restic.Tree, complete CompleteFunc) (d FutureTree, err error) {
 	debug.Log(""%v %v"", snPath, dir)
 
 	treeNode, err := arch.nodeFromFileInfo(dir, fi)",Could the callback be a field on the Archiver instead?,go,1,1,1
"@@ -894,12 +894,17 @@ var (
         RollupGasPriceOracleAddressFlag = cli.StringFlag{
                 Name:   ""rollup.gaspriceoracleaddress"",
                 Usage:  ""Address of the rollup gas price oracle"",
-                Value:  ""0x"",
+                Value:  ""0x0000000000000000000000000000000000000000"",
                 EnvVar: ""ROLLUP_GAS_PRICE_ORACLE_ADDRESS"",
         }
         RollupEnableL2GasPollingFlag = cli.BoolFlag{
                 Name:   ""rollup.enablel2gaspolling"",
-                Usage:  """",
+                Usage:  ""Poll for the L2 gas price from the L2 state"",
+                EnvVar: ""ROLLUP_ENABLE_L2_GAS_POLLING"",
+        }
+        RollupEnforceFeesFlag = cli.BoolFlag{
+                Name:   ""rollup.enforcefeesflag"",
+                Usage:  ""Disable transactions with 0 gas price"",
                 EnvVar: ""ROLLUP_ENABLE_L2_GAS_POLLING"",
         }
 )",Fix this env var,go,1,0,0
"@@ -75,6 +75,7 @@ func UnsafeKindToResource(k string) string {
 	}
 	unusualKindToResource := map[string]string{
 		""Endpoints"": ""endpoints"",
+		""Gateway"":   ""gateways"",
 	}
 	if v, isUnusual := unusualKindToResource[k]; isUnusual {
 		return v","Where's the type `Gateway` from? If it's a type of crd, I think we can't list all types here.",go,1,1,1
"@@ -53,6 +53,16 @@ func mustSpanIDFromHex(s string) (t trace.SpanID) {
 	return
 }
 
+func TestBytesMapCarrier(t *testing.T) {
+	carrier := make(propagation.BytesMapCarrier)
+	carrier.Set(""foo"", ""bar"")
+	carrier.Set(""baz"", ""qux"")
+
+	assert.Equal(t, carrier.Get(""foo""), ""bar"")
+	assert.Equal(t, carrier.Get(""baz""), ""qux"")
+	assert.Equal(t, carrier.Keys(), []string{""foo"", ""baz""})
+}
+
 type outOfThinAirPropagator struct {
 	t *testing.T
 }","Map iteration order isn't guaranteed, so the result will need to be sorted or another set of checks devised. You could assert it's length 2 and contains both ""foo"" and ""bar"".",go,1,1,1
"@@ -389,6 +389,17 @@ func (c *client) parse(buf []byte) error {
 				if err := c.processPub(arg); err != nil {
 					return err
 				}
+				// Check if we have and account mappings or tees or filters.
+				// FIXME(dlc) - Probably better way to do this.
+				// Could add in cache but will be tricky since results based on pub subject are dynamic
+				// due to wildcard matching and weight sets.
+				if c.kind == CLIENT && c.in.flags.isSet(hasMappings) {
+					old := c.pa.subject
+					changed := c.selectMappedSubject()
+					if trace && changed {
+						c.traceInOp(""MAPPING"", []byte(fmt.Sprintf(""%s -> %s"", old, c.pa.subject)))
+					}
+				}
 				c.drop, c.as, c.state = 0, i+1, MSG_PAYLOAD
 				// If we don't have a saved buffer then jump ahead with
 				// the index. If this overruns what is left we fall out",other way would be for selectMappedSubject() to return a boolean to indicate that an actual mapping took place.,go,1,1,1
"@@ -3176,10 +3176,10 @@ func (m *MockpipelineStatusDescriber) EXPECT() *MockpipelineStatusDescriberMockR
 }
 
 // Describe mocks base method
-func (m *MockpipelineStatusDescriber) Describe() (*describe.PipelineStatusDesc, error) {
+func (m *MockpipelineStatusDescriber) Describe() (*describe.PipelineStatus, error) {
 	m.ctrl.T.Helper()
 	ret := m.ctrl.Call(m, ""Describe"")
-	ret0, _ := ret[0].(*describe.PipelineStatusDesc)
+	ret0, _ := ret[0].(*describe.PipelineStatus)
 	ret1, _ := ret[1].(error)
 	return ret0, ret1
 }",You'll need to regenerate the mocks to get rid of this now that you've removed the interfaces from `cli/interfaces.go`,go,1,1,1
"@@ -274,6 +274,12 @@ func (k *K8sClient) GetKCS() *kubernetes.Clientset {
 	return k.cs
 }
 
+// GetUCS is a getter method for fetching upgrade clientset as
+// the upgrade clientset is not exported.
+func (k *K8sClient) GetUCS() *upgrade.Clientset {
+	return k.upgradecs
+}
+
 // scOps is a utility function that provides a instance capable of
 // executing various K8s StorageClass related operations
 func (k *K8sClient) storageV1SCOps() typed_storage_v1.StorageClassInterface {",This package should not be used. This is old package.,go,1,1,1
"@@ -683,6 +683,11 @@ func loadConfigFromDatastore(
 		Name:      ""node."" + hostname,
 		Namespace: """",
 	}, """")
+	n, err := client.Get(ctx, model.ResourceKey{
+		Kind:      apiv2.KindNode,
+		Name:      hostname,
+		Namespace: """",
+	}, """")
 	if _, ok := err.(errors2.ErrorResourceDoesNotExist); err != nil && !ok {
 		return
 	}",Should be checking for error here,go,1,1,1
"@@ -14,4 +14,5 @@ type Address = swarm.Address
 // Interface can resolve an URL into an associated Ethereum address.
 type Interface interface {
 	Resolve(url string) (Address, error)
+	Close()
 }",Use io.Closer even the error is always nil by current implementations.,go,1,1,1
"@@ -37,6 +37,9 @@ type AWSMachineProviderSpec struct {
 	// AMI is the reference to the AMI from which to create the machine instance.
 	AMI AWSResourceReference `json:""ami,omitempty""`
 
+	// ImageLookupOrg is the AWS Organization ID to use for image lookup if AMI is not set.
+	ImageLookupOrg string `json:""imageLookupOrg,omitempty""`
+
 	// InstanceType is the type of instance to create. Example: m4.xlarge
 	InstanceType string `json:""instanceType,omitempty""`
 ","Nit, ImageLookupOrg could be `ImageLookupOrgID`",go,1,1,1
"@@ -72,6 +72,18 @@ func (d *Dispatcher) Introspect() introspection.DispatcherStatus {
 			status.OutboundKey = outboundKey
 			outbounds = append(outbounds, status)
 		}
+		if o.Stream != nil {
+			var status introspection.OutboundStatus
+			if o, ok := o.Stream.(introspection.IntrospectableOutbound); ok {
+				status = o.Introspect()
+			} else {
+				status.Transport = ""Introspection not supported""
+			}
+			status.RPCType = ""stream""
+			status.Service = o.ServiceName
+			status.OutboundKey = outboundKey
+			outbounds = append(outbounds, status)
+		}
 	}
 	procedures := introspection.IntrospectProcedures(d.table.Procedures())
 	return introspection.DispatcherStatus{",gonna remove all introspection to add later if need be.,go,0,0,1
"@@ -38,7 +38,8 @@ func (p *diskInspectionProcessor) process(pd persistentDisk,
 
         ir, err := p.inspectDisk(pd.uri)
         if err != nil {
-                return pd, err
+                // Don't directly return err to avoid terminating the import.
+                return pd, nil
         }
 
         isDualBoot := ir.UEFIBootable && ir.BIOSBootableWithHybridMBROrProtectiveMBR",Log the error?,go,1,0,1
"@@ -2937,7 +2937,8 @@ func (dr *DirAccResolver) Start(s *Server) error {
 		}
 	}
 	const accountPackRequest = ""$SYS.ACCOUNT.CLAIMS.PACK""
-	const accountLookupRequest = ""$SYS.ACCOUNT.*.CLAIMS.LOOKUP""
+	const accountLookupRequest = ""$SYS.REQ.ACCOUNT.*.CLAIMS.LOOKUP""
+	const accountLookupTokens = 6
 	packRespIb := s.newRespInbox()
 	// subscribe to account jwt update requests
 	if _, err := s.sysSubscribe(fmt.Sprintf(accUpdateEventSubj, ""*""), func(_ *subscription, _ *client, subj, resp string, msg []byte) {","Originally this was used only in this function, but now I wonder if we should move then to events.go (where you have defined number of tokens and index of account). Also, we could make it a subject with the `%s` token, like `const accountLookupRequest = ""$SYS.REQ.ACCOUNT.%s.CLAIMS.LOOKUP""`. Here, to subscribe you would sprintf with this constant and pass ""*"" for the ""%s"".",go,1,1,1
"@@ -61,8 +61,7 @@ runs on edge nodes and manages containerized applications.`,
 			gis.Start(beehiveContext.Done())
 			registerModules(config)
 			// start all modules
-			core.StartModules()
-			core.GracefulShutdown()
+			core.Run()
 		},
 	}
 	fs := cmd.Flags()",It might be clearer to split it into two calls? I'm not sure.,go,1,1,1
"@@ -300,6 +300,10 @@ func (a *FakeWebAPI) GetApplication(ctx context.Context, req *webservice.GetAppl
 	}, nil
 }
 
+func (a *FakeWebAPI) GenerateApplicationSealedSecret(ctx context.Context, req *webservice.GenerateApplicationSealedSecretRequest) (*webservice.GenerateApplicationSealedSecretResponse, error) {
+	return &webservice.GenerateApplicationSealedSecretResponse{}, nil
+}
+
 func (a *FakeWebAPI) ListDeployments(ctx context.Context, req *webservice.ListDeploymentsRequest) (*webservice.ListDeploymentsResponse, error) {
 	now := time.Now()
 	deploymentTime := now",`ctx` is unused in GenerateApplicationSealedSecret,go,1,1,1
"@@ -37,8 +37,8 @@ type bootableDiskProcessor struct {
 	OS              string
 }
 
-func (b bootableDiskProcessor) process(ctx context.Context) (err error) {
-	err = b.workflow.RunWithModifiers(ctx, b.preValidateFunc(), b.postValidateFunc())
+func (b *bootableDiskProcessor) process(ctx context.Context) (err error) {
+	err = b.workflow.RunWithModifiers(context.Background(), b.preValidateFunc(), b.postValidateFunc())
 	if err != nil {
 		daisy_utils.PostProcessDErrorForNetworkFlag(""image import"", err, b.network, b.workflow)
 		err = customizeErrorToDetectionResults(b.OS,",what's the motivation to make the receiver a pointer? Usually I reserve that for modifications to the receiver.,go,1,1,1
"@@ -86,6 +86,7 @@ func (d *RDWebServiceDescriber) Describe() (HumanJSONStringer, error) {
 			Port:        service.Port,
 			CPU:         service.CPU,
 			Memory:      service.Memory,
+			Platform:    ""LINUX/X86_64"",
 		})
 
 		for _, v := range service.EnvironmentVariables {","An alternative to defaulting a platform string would be to not show the column at all if we do not have the information   For RD web service, I feel like user wouldn't be interested in the platform information anyway since they should have known that the only valid platform is ""linux/x86_64"" if they have tried to use any other platform for the service.",go,1,1,1
"@@ -16,6 +16,9 @@
 package config
 
 import (
+	""fmt""
+	""github.com/aws/amazon-ecs-agent/agent/statemanager/dependencies""
+	""github.com/pkg/errors""
 	""os""
 	""strings""
 	""syscall""",nit: imports should be grouped. please run `go imports` and/or see other files to check import formatting.,go,1,1,1
"@@ -767,15 +767,7 @@ func TestStatelessExportKind(t *testing.T) {
 
 // What works single-threaded should work multi-threaded
 func runMetricExportTests(t *testing.T, opts []ExporterOption, rs []record, expected []metricpb.ResourceMetrics) {
-	t.Run(""1 goroutine"", func(t *testing.T) {
-		runMetricExportTest(t, NewUnstartedExporter(append(opts[:len(opts):len(opts)], WorkerCount(1))...), rs, expected)
-	})
-	t.Run(""20 goroutines"", func(t *testing.T) {
-		runMetricExportTest(t, NewUnstartedExporter(append(opts[:len(opts):len(opts)], WorkerCount(20))...), rs, expected)
-	})
-}
-
-func runMetricExportTest(t *testing.T, exp *Exporter, rs []record, expected []metricpb.ResourceMetrics) {
+	exp := NewUnstartedExporter(opts...)
 	msc := &metricsServiceClientStub{}
 	exp.metricExporter = msc
 	exp.started = true",This outside function is likely not needed anymore.,go,1,0,1
"@@ -18,10 +18,11 @@ type Window struct {
 // and normalizes the offset to a small positive duration.
 // It also validates that the durations are valid when
 // used within a window.
-func NewWindow(every, period, offset Duration) (Window, error) {
-	// Normalize the offset to a small positive duration
-	offset = offset.Normalize(every)
-
+func NewWindow(every, period, offset Duration, months bool) (Window, error) {
+	if !months {
+		// Normalize nanosecond offsets to a small positive duration
+		offset = offset.Normalize(every)
+	}
 	w := Window{
 		Every:  every,
 		Period: period,",@jlapacik we need to know if we're working with nanoseconds or not so that we can know whether to scale durations here or not.,go,0,1,1
"@@ -181,10 +181,13 @@ func (pool *MessagePool) timeoutMessages(ctx context.Context, store chain.BlockP
 		}
 	}
 
+	pool.lk.Lock()
+	defer pool.lk.Unlock()
+
 	// remove all messages added before minimumHeight
 	for cid, msg := range pool.pending {
 		if msg.addedAt < minimumHeight {
-			pool.Remove(cid)
+			delete(pool.pending, cid)
 		}
 	}
 ","This misses the metric update in `Remove()`. It is unfortunate that `timeoutMessages` uses the pool's private API, which makes errors like this all too easy (not your fault). I think a better fix here is to use the exported `Pending()` at line 188 then stick with `Remove` here (and no need for the extra lock).",go,1,1,1
"@@ -15,6 +15,7 @@ type Datastore interface {
 	// can either force it, or just do hopeful type checks. Not all datastores
 	// implement every feature.
 	datastore.Batching
+	Close() error
 }
 
 // Repo is a representation of all persistent data in a filecoin node.","If we are adding the `Close` method, we should probably be also calling it when shutting down the node",go,1,1,1
"@@ -138,12 +138,10 @@ func environmentCheck() error {
 	}
 
 	for _, process := range processes {
-		// if kubelet is running, return error
-		if process.Executable() == ""kubelet"" {
+		switch process.Executable() {
+		case ""kubelet"": // if kubelet is running, return error
 			return errors.New(""kubelet should not running on edge node when running edgecore"")
-		}
-		// if kube-proxy is running, return error
-		if process.Executable() == ""kube-proxy"" {
+		case ""kube-proxy"": // if kube-proxy is running, return error
 			return errors.New(""kube-proxy should not running on edge node when running edgecore"")
 		}
 	}","There are only these two situations, I think there is no need to use `switch` to extend the judgment.",go,1,1,1
"@@ -1044,7 +1044,7 @@ func NewBuildState(config *Configuration) *BuildState {
 			""crc64"":  fs.NewPathHasher(RepoRoot, config.Build.Xattrs, newCRC64, ""crc64""),
 			""blake3"": fs.NewPathHasher(RepoRoot, config.Build.Xattrs, newBlake3, ""blake3""),
 		},
-		ProcessExecutor: process.New(sandboxTool),
+		ProcessExecutor: process.New(sandboxTool != """"),
 		StartTime:       startTime,
 		Config:          config,
 		VerifyHashes:    true,","I think we may still want a way of honouring the sandbox tool if that's set. Maybe it should basically go through the old method if it is - but we make the default `""""` from here on and deprecate that field in future.",go,1,1,1
"@@ -87,6 +87,8 @@ func run(o *Options) error {
 		appliedToGroupStore,
 		networkPolicyStore)
 
+	endpointQueryReplier := networkpolicy.NewEndpointQueryReplier(networkPolicyController)
+
 	controllerQuerier := querier.NewControllerQuerier(networkPolicyController, o.config.APIPort)
 
 	controllerMonitor := monitor.NewControllerMonitor(crdClient, nodeInformer, controllerQuerier)","It seems it doesn't really need a concrete instance here, all consumers just need the interface, right? Maybe you could use interface here, so the struct name can be simplified as the lower case of the interface, i.e. endpointQuerier?",go,1,1,1
"@@ -45,3 +45,9 @@ func SetDefaultTaskListKind(f *enumspb.TaskListKind) {
 		*f = enumspb.TASK_LIST_KIND_NORMAL
 	}
 }
+
+func SetDefaultParentClosePolicy(f *enumspb.ParentClosePolicy) {
+	if *f == enumspb.PARENT_CLOSE_POLICY_UNSPECIFIED {
+		*f = enumspb.PARENT_CLOSE_POLICY_ABANDON
+	}
+}",The default should be TERMINATE. How do I determine default looking at the proto definition?,go,1,1,1
"@@ -81,6 +81,10 @@ const (
 	// IsRelay when set causes the the daemon to provide libp2p relay
 	// services allowing other filecoin nodes behind NATs to talk directly.
 	IsRelay = ""is-relay""
+
+	// CatchupSyncTestMode places the daemon in a spcial catchup mode for testing
+	// TODO remove this when we stop using test daemon.
+	CatchupSyncTestMode = ""catchup-sync-test-mode""
 )
 
 // command object for the local cli","nit: special, also file an issue and add that issue number to the TODO",go,1,1,1
"@@ -87,7 +87,8 @@ func (m *mounter) Unmount() (err error) {
 			_, err = exec.Command(
 				""/usr/sbin/diskutil"", ""unmountDisk"", ""force"", dir).Output()
 		case ""linux"":
-			_, err = exec.Command(""fusermount"", ""-ul"", dir).Output()
+			// Lazy unmount; will unmount when KBFS is no longer in use
+			_, err = exec.Command(""fusermount"", ""-u"", ""-z"", dir).Output()
 		default:
 			err = errors.New(""Forced unmount is not supported on this platform yet"")
 		}","@taruti is this ok? my fusermount(1) shows the option is `-z`, which is pretty confusing since `umount` uses `-l`. hopefully it isn't os-dependent",go,0,1,1
"@@ -358,7 +358,12 @@ func (r *replacer) getSubstitution(key string) string {
 		if r.responseRecorder == nil {
 			return r.emptyValue
 		}
-		return roundDuration(time.Since(r.responseRecorder.start)).String()
+		elapsedDuration := time.Since(r.responseRecorder.start)
+
+		if elapsedDuration == 0 {
+			return ""0ms""
+		}
+		return roundDuration(elapsedDuration).String()
 	case ""{latency_ms}"":
 		if r.responseRecorder == nil {
 			return r.emptyValue","time.Since returns a duration value, which has accuracy to the nanosecond, I believe. So while 0ms is technically true in that case, the likelihood of getting an actual value of 0 is extremely low, I think. Is there a test that exhibits this behavior?",go,1,1,1
"@@ -142,6 +142,17 @@ ORDER BY task_id LIMIT $5`
 	deleteVisibilityTaskQuery      = `DELETE FROM visibility_tasks WHERE shard_id = $1 AND task_id = $2`
 	rangeDeleteVisibilityTaskQuery = `DELETE FROM visibility_tasks WHERE shard_id = $1 AND task_id > $2 AND task_id <= $3`
 
+	createTieredStorageTasksQuery = `INSERT INTO tiered_storage_tasks(shard_id, task_id, data, data_encoding) 
+ VALUES(:shard_id, :task_id, :data, :data_encoding)`
+
+	getTieredStorageTaskQuery = `SELECT task_id, data, data_encoding 
+ FROM tiered_storage_tasks WHERE shard_id = $1 AND task_id = $2`
+	getTieredStorageTasksQuery = `SELECT task_id, data, data_encoding 
+ FROM tiered_storage_tasks WHERE shard_id = $1 AND task_id > $2 AND task_id <= $3 ORDER BY shard_id, task_id`
+
+	deleteTieredStorageTaskQuery      = `DELETE FROM tiered_storage_tasks WHERE shard_id = $1 AND task_id = $2`
+	rangeDeleteTieredStorageTaskQuery = `DELETE FROM tiered_storage_tasks WHERE shard_id = $1 AND task_id > $2 AND task_id <= $3`
+
 	bufferedEventsColumns     = `shard_id, namespace_id, workflow_id, run_id, data, data_encoding`
 	createBufferedEventsQuery = `INSERT INTO buffered_events(` + bufferedEventsColumns + `)
 VALUES (:shard_id, :namespace_id, :workflow_id, :run_id, :data, :data_encoding)`","`ORDER BY shard_id, task_id` -> `ORDER BY task_id` plz also change line 93 & 140",go,1,1,1
"@@ -167,6 +167,10 @@ func (m *UnifiedManager) Destroy() error {
 	if m.Cgroups.Paths != nil {
 		return nil
 	}
+	dirPath, err := m.GetUnifiedPath()
+	if err != nil {
+		return err
+	}
 	m.mu.Lock()
 	defer m.mu.Unlock()
 ","@kolyshkin I think we may not need `StopUnit` method. Because if the init process has been exited, the cgroup path will be deleted by systemd automatically. WDYT",go,0,1,1
"@@ -36,6 +36,9 @@ const (
 	blockRead blockReqType = iota
 	// A block write request.
 	blockWrite
+	// A block read request that is happening from a different
+	// goroutine than the blockLock rlock holder, using the same lState.
+	blockReadParallel
 )
 
 type mdToCleanIfUnused struct {","Does that mean that if all n children goroutines use the same `lState`? If so, that seems incorrect, as an `lState` is meant to only apply for a single 'execution flow', which means a single goroutine or a serial sequence of goroutines. Probably should enforce something like a nil lState exactly when using blockReadParallel.",go,1,1,1
"@@ -132,6 +132,12 @@ func run(o *Options) error {
 	if err != nil {
 		return fmt.Errorf(""error creating API server: %v"", err)
 	}
+
+	err = apiserver.CleanupDeprecatedAPIServices(aggregatorClient)
+	if err != nil {
+		return fmt.Errorf(""failed to clean up the deprecated APIServices: %v"", err)
+	}
+
 	// Set up signal capture: the first SIGTERM / SIGINT signal is handled gracefully and will
 	// cause the stopCh channel to be closed; if another signal is received before the program
 	// exits, we will force exit.",I didn't think of it too much but does the order matter here? should we remove deprecated APIServices before installing the new ones?,go,1,1,1
"@@ -3611,10 +3611,12 @@ func (c *client) processMsgResults(acc *Account, r *SublistResult, msg, deliver,
 			ql := _ql[:0]
 			for i := 0; i < len(qsubs); i++ {
 				sub = qsubs[i]
-				if sub.client.kind == CLIENT {
+				if sub.client.kind == LEAF || sub.client.kind == ROUTER || sub.client.kind == GATEWAY {
+					if rsub == nil {
+						rsub = sub
+					}
+				} else {
 					ql = append(ql, sub)
-				} else if rsub == nil {
-					rsub = sub
 				}
 			}
 			qsubs = ql","Since for gateways interest is not stored in the account sublist (but stored in gateway struct), sub.client.kind will never be GATEWAY.",go,1,1,1
"@@ -20,10 +20,17 @@ import (
 
 	""github.com/aws/aws-sdk-go/aws/credentials""
 	""github.com/aws/aws-sdk-go/aws/signer/v4""
+	""github.com/cihub/seelog""
+	""github.com/pkg/errors""
 )
 
 // SignHTTPRequest signs an http.Request struct with authv4 using the given region, service, and credentials.
-func SignHTTPRequest(req *http.Request, region, service string, creds *credentials.Credentials, body io.ReadSeeker) {
+func SignHTTPRequest(req *http.Request, region, service string, creds *credentials.Credentials, body io.ReadSeeker) error {
 	signer := v4.NewSigner(creds)
-	signer.Sign(req, body, service, region, time.Now())
+	_, err := signer.Sign(req, body, service, region, time.Now())
+	if err != nil {
+		seelog.Warnf(""Signing HTTP request failed: %v"", err)
+		return errors.Wrap(err, ""aws sdk http signer: failed to sign http request"")
+	}
+	return nil
 }",nit: `errors.Wrap()` should suffice here.,go,1,1,1
"@@ -461,6 +461,7 @@ func (c *linuxContainer) commandTemplate(p *Process, childPipe *os.File) (*exec.
 	if cmd.SysProcAttr == nil {
 		cmd.SysProcAttr = &syscall.SysProcAttr{}
 	}
+	cmd.Env = append(cmd.Env, fmt.Sprintf(""GOMAXPROCS=%s"", os.Getenv(""GOMAXPROCS"")))
 	cmd.ExtraFiles = append(cmd.ExtraFiles, p.ExtraFiles...)
 	if p.ConsoleSocket != nil {
 		cmd.ExtraFiles = append(cmd.ExtraFiles, p.ConsoleSocket)",Won't this result in `GOMAXPROCS=` in the normal case of `runc` was called without `GOMAXPROCS` set?,go,1,1,1
"@@ -10,12 +10,12 @@ import (
         ""time""
 
         ""github.com/facebookgo/clock""
-        fsm ""github.com/iotexproject/go-fsm""
+        ""github.com/iotexproject/go-fsm""
         ""go.uber.org/zap""
 
         ""github.com/iotexproject/iotex-core/blockchain/block""
         ""github.com/iotexproject/iotex-core/endorsement""
-        ""github.com/iotexproject/iotex-core/iotxaddress""
+        ""github.com/iotexproject/iotex-core/pkg/keypair""
         ""github.com/iotexproject/iotex-core/pkg/log""
         ""github.com/iotexproject/iotex-core/proto""
 )",other declaration of fsm (from `typecheck`),go,1,0,0
"@@ -397,6 +397,16 @@ func dealsExpensesPerHour(addr common.Address, deals []*sonm.DWHDeal) (*sonm.Big
 	return sonm.NewBigInt(inAsks), sonm.NewBigInt(inBids)
 }
 
+func dealType(deal *sonm.Deal, addr common.Address) string {
+	if deal.GetSupplierID().Unwrap() == addr || deal.GetMasterID().Unwrap() == addr {
+		return ""SELL""
+	}
+	if deal.GetConsumerID().Unwrap() == addr {
+		return ""BUY""
+	}
+	return """"
+}
+
 func printDealsList(cmd *cobra.Command, addr common.Address, deals []*sonm.DWHDeal) {
 	asks, bids := dealsExpensesPerHour(addr, deals)
 ",What if BOTH conditions are true?,go,1,0,1
"@@ -9,7 +9,10 @@ package state
 import (
 	""math/big""
 
+	""github.com/golang/protobuf/proto""
+
 	""github.com/iotexproject/iotex-core/pkg/hash""
+	""github.com/iotexproject/iotex-core/proto""
 )
 
 // Account is the canonical representation of an account.",File is not `goimports`-ed,go,0,1,1
"@@ -146,6 +146,17 @@ type HugetlbStats struct {
 	Failcnt uint64 `json:""failcnt""`
 }
 
+type RdmaEntry struct {
+	Device     string `json:""device,omitempty""`
+	HcaHandles uint32 `json:""hca_handles,omitempty""`
+	HcaObjects uint32 `json:""hca_objects,omitempty""`
+}
+
+type RdmaStats struct {
+	RdmaLimit   []RdmaEntry `json:""rdma_limit,omitempty""`
+	RdmaCurrent []RdmaEntry `json:""rdma_current,omitempty""`
+}
+
 type Stats struct {
 	CpuStats    CpuStats    `json:""cpu_stats,omitempty""`
 	CPUSetStats CPUSetStats `json:""cpuset_stats,omitempty""`",Should these all be `RDMAEntry` and `HCAHandles` (capital RDMA and HCA)?,go,1,1,1
"@@ -59,11 +59,10 @@ func (b3 B3) Inject(ctx context.Context, supplier propagation.HTTPSupplier) {
 	if b3.SingleHeader {
 		sampled := sc.TraceFlags & core.TraceFlagsSampled
 		supplier.Set(B3SingleHeader,
-			fmt.Sprintf(""%s-%.16x-%.1d"", sc.TraceIDString(), sc.SpanID, sampled))
+			fmt.Sprintf(""%s-%s-%.1d"", sc.TraceIDString(), sc.SpanID, sampled))
 	} else {
 		supplier.Set(B3TraceIDHeader, sc.TraceIDString())
-		supplier.Set(B3SpanIDHeader,
-			fmt.Sprintf(""%.16x"", sc.SpanID))
+		supplier.Set(B3SpanIDHeader, sc.SpanID.String())
 
 		var sampled string
 		if sc.IsSampled() {",Is TraceIDString now duplicative?,go,1,0,1
"@@ -464,12 +464,11 @@ func (target *BuildTarget) AllURLs(state *BuildState) []string {
 // resolveDependencies matches up all declared dependencies to the actual build targets.
 // TODO(peterebden,tatskaari): Work out if we really want to have this and how the suite of *Dependencies functions
 //                             below should behave (preferably nicely).
-// TODO(tatskaari): Work out if we can use a channel instead of a callback.
 func (target *BuildTarget) resolveDependencies(graph *BuildGraph, callback func(*BuildTarget) error) error {
 	var g errgroup.Group
-	target.mutex.RLock()
+
 	for i := range target.dependencies {
-		dep := &target.dependencies[i]
+		dep := &target.dependencies[i] // avoid using a loop variable here as it mutates each iteration
 		if len(dep.deps) > 0 {
 			continue // already done
 		}","Think we should keep this in as a Lock / Unlock (since we're iterating over the slice itself which is shared, but the work on it happens within the waitgroup)",go,1,1,1
"@@ -18,6 +18,8 @@ import (
 	""encoding/json""
 	""testing""
 	""time""
+	""github.com/jmcvetta/randutil""
+	""reflect""
 )
 
 func TestSleepCommand_UnmarshalJSON(t *testing.T) {",File is not `gofmt`-ed with `-s` (from `gofmt`),go,0,1,1
"@@ -39,6 +39,8 @@ func defaultCipherSuites() []uint16 {
 		tls.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
 		tls.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,
 		tls.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,
+		tls.TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,
+		tls.TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,
 	}
 }
 ","What is default for 1.8 if not configured at all? I think they put ChaCha first because of its performance gains, even over AES..",go,1,1,1
"@@ -36,14 +36,14 @@ import (
 
 // pullBaggage pulls the context headers from the given transport.Headers,
 // deleting them from the original headers map.
-func pullBaggage(headers transport.Headers) transport.Headers {
-	ctxHeaders := make(transport.Headers)
+func pullBaggage(headers transport.Headers) map[string]string {
+	ctxHeaders := make(map[string]string)
 	prefix := strings.ToLower(BaggageHeaderPrefix)
 	prefixLen := len(prefix)
-	for k, v := range headers {
+	for k, v := range headers.Items() {
 		if strings.HasPrefix(k, prefix) {
 			key := k[prefixLen:]
-			ctxHeaders.Set(key, v)
+			ctxHeaders[key] = v
 			headers.Del(k)
 		}
 	}",Can you explain why you're using `map[string]string` here (and in several other places) instead of a defined type?,go,1,1,1
"@@ -25,7 +25,13 @@ import (
         ""github.com/labstack/echo/v4""
 )
 
+// URLAuthPrefix is the echo formatted url/path param which can be used for supplying an API token.
+const URLAuthPrefix = ""/urlAuth/:"" + TokenPathParam
 const urlAuthFormatter = ""/urlAuth/%s""
+// InvalidTokenMessage is the message set when an invalid / missing token is found.
+const InvalidTokenMessage = ""Invalid API Token""
+// TokenPathParam is the name of the path parameter used by URLAuthPrefix
+const TokenPathParam = ""token""
 
 // AuthMiddleware provides some data to the handler.
 type AuthMiddleware struct {",It took me a moment to realize this works because the Go compiler is smart; I was expecting to need this declared before it's used a few lines above.,go,1,1,1
"@@ -155,8 +155,7 @@ func add(mgr manager.Manager, r reconcile.Reconciler) error {
 
         // Monitor changes to DaemonSets:
         err = c.Watch(&source.Kind{Type: &appsv1.DaemonSet{}}, &handler.EnqueueRequestForOwner{
-                IsController: true,
-                OwnerType:    &hivev1.HiveConfig{},
+                OwnerType: &hivev1.HiveConfig{},
         })
         if err != nil {
                 return err",These IsController fields were incorrect I take it?,go,1,1,1
"@@ -1,4 +1,4 @@
-// Copyright (c) 2016-2017 Tigera, Inc. All rights reserved.
+// Copyright (c) 2016-2018 Tigera, Inc. All rights reserved.
 //
 // Licensed under the Apache License, Version 2.0 (the ""License"");
 // you may not use this file except in compliance with the License.",What criteria do we use to bump the copyright years? An update to the module?,go,1,1,1
"@@ -17,16 +17,16 @@ import (
         ""github.com/syndtr/goleveldb/leveldb/util""
 )
 
-var _ storage.StateStorer = (*store)(nil)
+var _ storage.StateStorer = (*Store)(nil)
 
 // Store uses LevelDB to store values.
-type store struct {
+type Store struct {
         db     *leveldb.DB
         logger logging.Logger
 }
 
 // New creates a new persistent state storage.
-func NewStateStore(path string, l logging.Logger) (storage.StateStorer, error) {
+func NewStateStore(path string, l logging.Logger) (*Store, error) {
         db, err := leveldb.OpenFile(path, nil)
         if err != nil {
                 if !ldberr.IsCorrupted(err) {",why the export?,go,1,0,1
"@@ -952,7 +952,14 @@ func (s *Server) jsStreamInfoRequest(sub *subscription, c *client, subject, repl
 		s.sendAPIResponse(c, subject, reply, string(msg), s.jsonResponse(&resp))
 		return
 	}
-	resp.StreamInfo = &StreamInfo{Created: mset.Created(), State: mset.State(), Config: mset.Config()}
+	config := mset.Config()
+	// MQTT streams are created without subject, but ""nats"" tooling would then
+	// fail to display them since it uses validation and expect the config's
+	// Subjects to not be empty.
+	if strings.HasPrefix(name, mqttStreamNamePrefix) && len(config.Subjects) == 0 {
+		config.Subjects = []string{"">""}
+	}
+	resp.StreamInfo = &StreamInfo{Created: mset.Created(), State: mset.State(), Config: config}
 	s.sendAPIResponse(c, subject, reply, string(msg), s.jsonResponse(resp))
 }
 ","technically the nats utility is wrong, since the server accepts it and it then defaults to stream name. I could allow it but at the time decided it would be better to be explicit",go,1,1,1
"@@ -61,13 +61,13 @@ var once sync.Once
 var CloudhubHandler *MessageHandle
 
 // InitHandler create a handler for websocket and quic servers
-func InitHandler(config *hubconfig.Configure, eventq *channelq.ChannelMessageQueue) {
+func InitHandler(eventq *channelq.ChannelMessageQueue) {
 	once.Do(func() {
 		CloudhubHandler = &MessageHandle{
-			KeepaliveInterval: config.KeepaliveInterval,
-			WriteTimeout:      config.WriteTimeout,
+			KeepaliveInterval: int(hubconfig.Get().KeepaliveInterval),
+			WriteTimeout:      int(hubconfig.Get().WriteTimeout),
 			MessageQueue:      eventq,
-			NodeLimit:         config.NodeLimit,
+			NodeLimit:         int(hubconfig.Get().NodeLimit),
 		}
 
 		CloudhubHandler.KeepaliveChannel = make(map[string]chan struct{})",Why need the type conversion here?,go,1,0,1
"@@ -0,0 +1,19 @@
+// +build !linux
+
+package landlock
+
+import (
+	""errors""
+
+	""github.com/opencontainers/runc/libcontainer/configs""
+)
+
+var ErrLandlockNotSupported = errors.New(""land: config provided but Landlock not supported"")
+
+// InitLandlock does nothing because Landlock is not supported.
+func InitSLandlock(config *configs.Landlock) error {
+	if config != nil {
+		return ErrLandlockNotSupported
+	}
+	return nil
+}","runc is linux-only, I guess you can drop this entirely (as well as `_linux` suffix from all the other files).",go,1,1,1
"@@ -37,6 +37,8 @@ type ControlPlaneSpec struct {
 	Filestore ControlPlaneFileStore `json:""filestore""`
 	// The configuration of cache for control plane.
 	Cache ControlPlaneCache `json:""cache""`
+	// The configuration of insight collector
+	InsightCollectorConfig ControlPlaneInsightCollector `json:""insightCollector""`
 	// List of debugging/quickstart projects defined in Control Plane configuration.
 	// Please note that do not use this to configure the projects running in the production.
 	Projects []ControlPlaneProject `json:""projects""`",nit: `InsightCollector ControlPlaneInsightCollector`,go,1,1,1
"@@ -28,6 +28,7 @@ import (
 	""strings""
 
 	""kythe.io/kythe/go/platform/kzip""
+	apb ""kythe.io/kythe/proto/analysis_go_proto""
 
 	""bitbucket.org/creachadair/stringset""
 )",Conventionally we group protobuf imports separately below the others.,go,1,1,1
"@@ -21,6 +21,9 @@ import (
         ""testing""
         ""time""
 
+        containerresource ""github.com/aws/amazon-ecs-agent/agent/containerresource""
+        ""github.com/aws/amazon-ecs-agent/agent/containerresource/containerstatus""
+
         apicontainerstatus ""github.com/aws/amazon-ecs-agent/agent/api/container/status""
         resourcestatus ""github.com/aws/amazon-ecs-agent/agent/taskresource/status""
 ",not blocking: extra line here too and other files too,go,0,1,1
"@@ -81,11 +81,12 @@ func newServer(cfg config.Config, testing bool) (*Server, error) {
 	cs.ActionPool().
 		AddActionValidators(
 			actpool.NewGenericValidator(cs.Blockchain()), account.NewProtocol(),
-			vote.NewProtocol(cs.Blockchain()), execution.NewProtocol(),
+			vote.NewProtocol(cs.Blockchain()), execution.NewProtocol(cs.Blockchain()),
 		)
 	// Install protocols
 	mainChainProtocol := mainchain.NewProtocol(cs.Blockchain())
 	cs.AddProtocols(mainChainProtocol)
+	cs.AddProtocols(execution.NewProtocol(cs.Blockchain()))
 	if cs.Explorer() != nil {
 		cs.Explorer().SetMainChainProtocol(mainChainProtocol)
 	}",You don't need to add execution protocol here because L89 bellow,go,1,1,1
"@@ -130,7 +130,7 @@ func verifyBlockSignature(ctx context.Context, view FaultStateView, blk block.Bl
 	if err != nil {
 		panic(errors.Wrapf(err, ""failed to inspect miner addresses""))
 	}
-	err = state.NewSignatureValidator(view).ValidateSignature(ctx, blk.SignatureData(), worker, blk.BlockSig)
+	err = state.NewSignatureValidator(view).ValidateSignature(ctx, blk.SignatureData(), worker, *blk.BlockSig)
 	if err != nil {
 		return errors.Wrapf(err, ""no consensus fault: block %s signature invalid"", blk.Cid())
 	}",`*blk.BlockSig` will panic if nil. Is this guaranteed not to be?,go,1,1,1
"@@ -73,8 +73,8 @@ func New(impl Interface, opts ...<$thrift>.RegisterOption) []<$transport>.Regist
 	h := handler{impl}
 	service := <$thrift>.Service{
 		Name: ""<.Service.Name>"",
-		Methods: map[string]<$thrift>.Handler{
-			<range .Service.Functions>""<.ThriftName>"": <$thrift>.HandlerFunc(h.<.Name>),
+		Methods: map[string]<$thrift>.UnaryHandler{
+			<range .Service.Functions><if not .OneWay>""<.ThriftName>"": <$thrift>.UnaryHandlerFunc(h.<.Name>),<end>
 		<end>},
 	}
 	return <$thrift>.BuildRegistrants(service, opts...)",Technically an unrelated change but it should be fine. Make sure that the glide.yaml depends on thriftrw 0.4 otherwise this won't work.,go,1,1,1
"@@ -93,7 +93,10 @@ func (m *memKVStore) Batch() KVStoreBatch {
 	return NewMemKVStoreBatch(&m.data)
 }
 
-const fileMode = 0600
+const (
+	fileMode = 0600
+	quota    = 3
+)
 
 // boltDB is KVStore implementation based bolt DB
 type boltDB struct {",quota -> numRetries And can we make it configurable?,go,1,1,1
"@@ -20,11 +20,13 @@ import (
 	""context""
 	""encoding/json""
 	""fmt""
-	""github.com/jetstack/cert-manager/pkg/acme""
 	""hash/fnv""
 
+	""github.com/jetstack/cert-manager/pkg/api/util""
+
 	metav1 ""k8s.io/apimachinery/pkg/apis/meta/v1""
 
+	""github.com/jetstack/cert-manager/pkg/acme""
 	acmecl ""github.com/jetstack/cert-manager/pkg/acme/client""
 	cmacme ""github.com/jetstack/cert-manager/pkg/apis/acme/v1""
 	cmapi ""github.com/jetstack/cert-manager/pkg/apis/certmanager/v1""",nit: This import should be grouped with the other cert-manager imports,go,1,1,1
"@@ -85,6 +85,7 @@ var (
 		PetersburgBlock:     big.NewInt(7_280_000),
 		IstanbulBlock:       big.NewInt(9_069_000),
 		MuirGlacierBlock:    big.NewInt(9_200_000),
+		RamanujanBlock:      big.NewInt(0),
 		BerlinBlock:         big.NewInt(12_244_000),
 		LondonBlock:         big.NewInt(12_965_000),
 		ArrowGlacierBlock:   big.NewInt(13_773_000),",This should probably left as `nil` and not zero (which would mean the this fork is activated straight away),go,1,1,1
"@@ -30,7 +30,8 @@ const seewayLogXmlConfig = `
 </seelog>
 `
 
-func init() {
+// Bootstrap loads seelog package into the overall system
+func Bootstrap() {
 	newLogger, err := seelog.LoggerFromConfigAsString(seewayLogXmlConfig)
 	if err != nil {
 		seelog.Warn(""Error parsing seelog configuration"", err)",why explicit Bootstrap calling is better when previous init() way? Init is guaranteed to be called only once per whole program. Bootstrap can be called in multiple places by different packages - and introduce very interesting side effects if not carefully used.,go,1,1,1
"@@ -16,8 +16,9 @@ import (
 
 var (
 	// ConfigDir is the directory to store config file
-	ConfigDir      string
-	configFileName string
+	ConfigDir         string
+	// DefaultConfigFile is the default config file name
+	DefaultConfigFile string
 )
 
 // ConfigCmd represents the config command",`ConfigDir` is a global variable (from `gochecknoglobals`),go,1,1,1
"@@ -176,7 +176,7 @@ func TestTooManyAcksForASingleBatchGoIntoMultipleBatches(t *testing.T) {
 
 func TestAckDoesNotBlock(t *testing.T) {
 	ctx, cancel := context.WithCancel(context.Background())
-	m := &driver.Message{}
+	m := &driver.Message{AckID: 0}
 	ds := &ackingDriverSub{
 		q: []*driver.Message{m},
 		sendAcks: func(_ context.Context, ackIDs []driver.AckID) error {",What does this have to do with removing ackIDBox?,go,1,1,1
"@@ -3,9 +3,16 @@
 package selector
 
 import (
+	""fmt""
+	""strings""
+
 	""github.com/spiffe/spire/proto/spire/common""
 )
 
+// Type and Value are delimited by a colon (:)
+// e.g. ""unix:uid:1000""
+const Delimiter = "":""
+
 type Selector struct {
 	Type  string
 	Value string","After this PR is merged, I will create another PR to use this constant in the SPIRE code.",go,0,1,1
"@@ -263,7 +263,11 @@ func TestSpirePlugin_SubmitValidCSR(t *testing.T) {
 	csr, pubKey, err := util.NewCSRTemplate(validSpiffeID)
 	require.NoError(t, err)
 
-	resp, err := m.MintX509CA(ctx, &upstreamauthority.MintX509CARequest{Csr: csr})
+	stream, err := m.MintX509CA(ctx, &upstreamauthority.MintX509CARequest{Csr: csr})
+	require.NoError(t, err)
+	require.NotNil(t, stream)
+
+	resp, err := stream.Recv()
 	require.NoError(t, err)
 	require.NotNil(t, resp)
 ",We should add an additional call to Recv() somewhere after here that we assert returns io.EOF.,go,1,1,1
"@@ -515,7 +515,9 @@ func (agent *ecsAgent) registerContainerInstance(
 // from a check point.
 func (agent *ecsAgent) reregisterContainerInstance(client api.ECSClient,
 	capabilities []*ecs.Attribute, tags []*ecs.Tag, registrationToken string) error {
-	_, _, err := client.RegisterContainerInstance(agent.containerInstanceARN, capabilities, tags, registrationToken)
+	_, availabilityZone, err := client.RegisterContainerInstance(agent.containerInstanceARN, capabilities, tags, registrationToken)
+	//set az to agent
+	agent.availabilityZone = availabilityZone
 
 	if err == nil {
 		return nil",do we need to call stateManager save here?,go,1,1,1
"@@ -587,10 +587,6 @@ func (c *Checker) checkTree(id restic.ID, tree *restic.Tree) (errs []error) {
 	for _, node := range tree.Nodes {
 		switch node.Type {
 		case ""file"":
-			if node.Content == nil {
-				errs = append(errs, Error{TreeID: id, Err: errors.Errorf(""file %q has nil blob list"", node.Name)})
-			}
-
 			for b, blobID := range node.Content {
 				if blobID.IsNull() {
 					errs = append(errs, Error{TreeID: id, Err: errors.Errorf(""file %q blob %d has null ID"", node.Name, b)})","This check was introduced to recognize an error condition where the archiver won't properly save a list of blobs, but rather leave the `.Content` set to `nil`. I would have left the check, even if it seems redundant.",go,1,1,1
"@@ -72,7 +72,7 @@ func deploy(ctx context.Context, pctx *processContext, biome, dockerImage string
 
 	// Run ""biome apply"".
 	if apply {
-		if err := biomeApply(ctx, pctx, biome, true); err != nil {
+		if err := biomeApply(ctx, pctx, biome, nil); err != nil {
 			return err
 		}
 	}","Note that this changes the value for `Input` from `true` to `false` -- this means that if you run `gocdk deploy` and Terraform has questions for you, it will fail; I think that's OK but let me know what you think. Our normal workflow in the tool doesn't use Terraform variables, so it's unlikely to happen (the user would have to manually add a variable). We could also turn this into a flag.",go,1,1,1
"@@ -47,6 +47,7 @@ type serverConfig struct {
 	BindPort            int                `hcl:""bind_port""`
 	CASubject           *caSubjectConfig   `hcl:""ca_subject""`
 	CATTL               string             `hcl:""ca_ttl""`
+	JWTIssuer           string             `hcl:""jwt_issuer""`
 	DataDir             string             `hcl:""data_dir""`
 	Experimental        experimentalConfig `hcl:""experimental""`
 	LogFile             string             `hcl:""log_file""`",nit: alphabetical ordering?,go,1,1,1
"@@ -37,6 +37,18 @@ func (f *CreateRepoForm) Validate(ctx *macaron.Context, errs binding.Errors) bin
         return validate(errs, ctx.Data, f, ctx.Locale)
 }
 
+type ConvertRepoForm struct {
+        Uid         int64  `binding:""Required""`
+        RepoId      int64  `binding:""Required""`
+        RepoName    string `binding:""Required;AlphaDashDot;MaxSize(100)""`
+        Private     bool
+        Description string `binding:""MaxSize(255)""`
+}
+
+func (f *ConvertRepoForm) Validate(ctx *macaron.Context, errs binding.Errors) binding.Errors {
+        return validate(errs, ctx.Data, f, ctx.Locale)
+}
+
 type MigrateRepoForm struct {
         CloneAddr    string `json:""clone_addr"" binding:""Required""`
         AuthUsername string `json:""auth_username""`",Why do you need this?,go,1,0,1
"@@ -38,6 +38,8 @@ type KVStore interface {
 	Delete(string, []byte) error
 	// Commit commits a batch
 	Commit(KVStoreBatch) error
+	// DeleteBucket delete a Bucket
+	DeleteBucket(key []byte) error
 }
 
 const (","Can we avoid adding a new api. Instead, `Delete(string, []byte) error` means delete a whole bucket if the second param is not given",go,1,1,1
"@@ -51,8 +51,8 @@ import (
 	""github.com/kubeedge/kubeedge/pkg/util""
 )
 
-//GPUInfoQueryTool sets information monitoring tool location for GPU
-var GPUInfoQueryTool = ""/var/IEF/nvidia/bin/nvidia-smi""
+//IEFGPUInfoQueryTool sets information monitoring tool location for GPU
+var IEFGPUInfoQueryTool = ""/var/IEF/nvidia/bin/nvidia-smi""
 var initNode v1.Node
 var reservationMemory = resource.MustParse(fmt.Sprintf(""%dMi"", 100))
 ",We should remove ief related codes here if possible.,go,1,1,1
"@@ -246,6 +246,7 @@ func GenerateChain(config *params.ChainConfig, parent *types.Block, engine conse
 		config = params.TestChainConfig
 	}
 	headers, blocks, receipts := make([]*types.Header, n), make(types.Blocks, n), make([]types.Receipts, n)
+	types.SetHeaderSealFlag(config.IsHeaderWithSeal())
 	chainreader := &FakeChainReader{Cfg: config, current: parent}
 	tx, errBegin := db.BeginRw(context.Background())
 	if errBegin != nil {","""global variable"" will affect other tests which running in parallel? `go test -p 8 --count=40 -race --trimpath -run='TestHeader' ./core` doesn't complain?",go,1,1,1
"@@ -0,0 +1,11 @@
+package common
+
+// DefaultRetrySettings indicates what the ""default"" retry settings
+// are if it is not specified on an Activity or for any unset fields
+// if a policy is explicitly set on a workflow
+type DefaultRetrySettings struct {
+	InitialIntervalInSeconds   int32
+	MaximumIntervalCoefficient float64
+	BackoffCoefficient         float64
+	MaximumAttempts            int32
+}",Why is it called `MaximumIntervalCoefficient`? I think we should just call it `MaximumInterval` and use Duration as type.,go,1,1,1
"@@ -214,13 +214,16 @@ func (c *historyCache) getOrCreateWorkflowExecutionInternal(
 	//  Consider revisiting this if it causes too much GC activity
 	releaseFunc := c.makeReleaseFunc(key, workflowCtx, forceClearContext)
 
+	lockAcquireTimer := c.metricsClient.StartTimer(scope, metrics.AcqureWorkflowContextLocklatency)
 	if err := workflowCtx.lock(ctx); err != nil {
+		lockAcquireTimer.Stop()
 		// ctx is done before lock can be acquired
 		c.Release(key)
 		c.metricsClient.IncCounter(scope, metrics.CacheFailures)
 		c.metricsClient.IncCounter(scope, metrics.AcquireLockFailedCounter)
 		return nil, nil, err
 	}
+	lockAcquireTimer.Stop()
 	return workflowCtx, releaseFunc, nil
 }
 ",line 167 - 170 already recorded the time,go,1,0,1
"@@ -391,9 +391,8 @@ func (m *DWH) watchMarketEvents() error {
 			}
 			m.processBlockBoundary(event)
 			dispatcher.Add(event)
-			if eventsCount < m.cfg.NumWorkers {
-				eventsCount++
-			} else {
+			eventsCount++
+			if eventsCount >= m.cfg.NumWorkers {
 				m.processEvents(dispatcher)
 				eventsCount, dispatcher = 0, newEventDispatcher(m.logger)
 			}","With this change exactly `m.cfg.NumWorkers` events can be processed in parallel (not `m.cfg.NumWorkers + 1`, as in the old version).",go,1,1,1
"@@ -2317,7 +2317,9 @@ func (e *historyEngineImpl) ResetWorkflowExecution(
 		request.GetWorkflowTaskFinishEventId() >= baseMutableState.GetNextEventID() {
 		return nil, serviceerror.NewInvalidArgument(""Workflow task finish ID must be > 1 && <= workflow next event ID."")
 	}
-
+	if baseRunID == """" {
+		baseRunID = baseMutableState.GetExecutionInfo().RunID
+	}
 	// also load the current run of the workflow, it can be different from the base runID
 	resp, err := e.executionManager.GetCurrentExecution(&persistence.GetCurrentExecutionRequest{
 		NamespaceID: namespaceID,",Why do we need this when the code that follows already loads the runID?,go,1,1,1
"@@ -62,6 +62,8 @@ func (f *Filter) toMap() map[string]interface{} {
 	return fMap
 }
 
+const zeroTime = ""0001-01-01 00:00:00""
+
 func (f *Filter) ConstructQueryArgs() (string, []interface{}) {
 	fMap, query, args := f.toMap(), make([]string, 0), make([]interface{}, 0)
 ",do we need to use this to initialize `Start` and `End` in `Filter`?,go,1,1,1
"@@ -48,6 +48,7 @@ func MakeTopic(args *TopicArgs) *pubsubv1alpha1.Topic {
 		Spec: pubsubv1alpha1.TopicSpec{
 			IdentitySpec: duckv1alpha1.IdentitySpec{
 				GoogleServiceAccount: args.Spec.IdentitySpec.GoogleServiceAccount,
+				ServiceAccountName:   args.Spec.IdentitySpec.ServiceAccountName,
 			},
 			Secret:            args.Spec.Secret,
 			Project:           args.Spec.Project,",Same change in `pkg/reconciler/intevents/resources/topic.go`.,go,1,1,1
"@@ -106,7 +106,7 @@ func TestProtoForCron(t *testing.T) {
 					ConcurrencyPolicy:       v1beta1.AllowConcurrent,
 					Schedule:                ""5 4 * * *"",
 					Suspend:                 &[]bool{true}[0],
-					StartingDeadlineSeconds: &[]int64{69}[0],
+					StartingDeadlineSeconds: &[]int64{60}[0],
 				},
 				Status: v1beta1.CronJobStatus{
 					Active: []v1.ObjectReference{{}, {}},",Is this just fixing a typo?,go,1,0,1
"@@ -34,6 +34,12 @@ import (
 	""github.com/jetstack/cert-manager/pkg/util/pki""
 )
 
+// The amount of time after the LastFailureTime of a Certificate
+// before the request should be retried.
+// In future this should be replaced with a more dynamic exponential
+// back-off algorithm.
+const RetryAfterLastFailure = time.Hour
+
 // PrivateKeyMatchesSpec returns an error if the private key bit size
 // doesn't match the provided spec. RSA, Ed25519 and ECDSA are supported.
 // If any error is returned, a list of violations will also be returned.",We should look at having the Certificate duration being a variable to the backoff function. A failed 1 hour cert will always have downtime here.,go,1,1,1
"@@ -29,11 +29,11 @@ const (
 )
 
 var (
-	validArgs       = []string{""endpoint"", ""wallet"", ""explorer"", ""defaultacc""}
-	validGetArgs    = []string{""endpoint"", ""wallet"", ""explorer"", ""defaultacc"", ""all""}
-	validExpl       = []string{""iotexscan"", ""iotxplorer""}
-	urlCompile      = regexp.MustCompile(urlPattern)
-	endpointCompile = regexp.MustCompile(""^"" + endpointPattern + ""$"")
+	supportedLanguage = []string{""English"", ""Chinese""}
+	validArgs         = []string{""endpoint"", ""wallet"", ""explorer"", ""defaultacc"", ""language""}
+	validGetArgs      = []string{""endpoint"", ""wallet"", ""explorer"", ""defaultacc"", ""language"", ""all""}
+	validExpl         = []string{""iotexscan"", ""iotxplorer""}
+	endpointCompile   = regexp.MustCompile(""^"" + endpointPattern + ""$"")
 )
 
 // configGetCmd represents the config get command","` supportedLanguage = []string{""English"", """"}`",go,1,1,1
"@@ -235,9 +235,11 @@ func TestProtocol_ClaimReward(t *testing.T) {
                 unclaimedBalance, _, err := p.UnclaimedBalance(ctx, sm, claimActionCtx.Caller)
                 require.NoError(t, err)
                 assert.Equal(t, big.NewInt(5), unclaimedBalance)
+                claimActionCtx.Caller = identityset.Address(28)
+
                 primAcc, err := accountutil.LoadAccount(sm, hash.BytesToHash160(claimActionCtx.Caller.Bytes()))
                 require.NoError(t, err)
-                assert.Equal(t, big.NewInt(1000005), primAcc.Balance)
+                assert.Equal(t, big.NewInt(980), primAcc.Balance)
 
                 // Claim negative amount of token will fail
                 _, err = p.Claim(claimCtx, sm, big.NewInt(-5))","i think we need to find out the root-cause? as mentioned in #2521, this test can pass in `make test`, but only fails when running as a separate test. must be sth like testConfig() or a local variable used by earlier test but changes when running separately. the proper fix is to understand why it happened that way and find out the exact root-cause",go,0,1,1
"@@ -170,6 +170,13 @@ const (
 	// {{ .Volume.isRestoreVol }}
 	IsRestoreVolumePropertyVTP VolumeTLPProperty = ""isRestoreVol""
 
+	// IsPatchVolumePropertyVTP indicates if the volume is being
+	// created with patch enabled.
+	//NOTE:
+	// The Corresponding value will be accessed as
+	// {{ .Volume.isPatch }}
+	IsPatchVolumePropertyVTP VolumeTLPProperty = ""isPatch""
+
 	// StorageClassVTP is the StorageClass of the volume
 	//
 	// NOTE:",Please avoid changing this file. Remove this constant.,go,1,1,1
"@@ -24,7 +24,12 @@ import (
 	""github.com/iotexproject/iotex-core/state/factory""
 )
 
-const testnetActionPath = ""testnet_actions.yaml""
+const (
+	testnetActionPath = ""testnet_actions.yaml""
+	// TODO: Gensis block producer's keypair should be a config. Note genesis block producer is not the creator
+	genesisProducerPublicKey  = ""0444b7ac782c60e90b1aa263fe4d61dbe73bf8260d3e773ce9f4f0dbc181e8e5f2e3b6f6d4cf47f1d53af95cf24b88b92037125c7bf6f63b55bebbb8579b3a9b24""
+	genesisProducerPrivateKey = ""bace9b2435db45b119e1570b4ea9c57993b2311e0c408d743d87cd22838ae892""
+)
 
 // Genesis defines the Genesis default settings
 type Genesis struct {",line is 161 characters (from `lll`),go,1,0,1
"@@ -169,6 +169,7 @@ type Transaction struct {
 	// To add another one, create a struct with XXXTransactionType and embed it here.
 	// To prevent extraneous fields, all must have the ""omitempty"" tag.
 	Payment *PaymentTransactionType `json:""payment,omitempty""`
+	Keyreg  *KeyregTransactionType  `json:""keyreg,omitempty""`
 
 	// FromRewards is the amount of pending rewards applied to the From
 	// account as part of this transaction.","While we're at it, can you swagger annotate both the `Payment` and `Keyreg` fields with a description, and `required: false`?",go,1,1,1
"@@ -149,15 +149,6 @@ func setLogCode(s *scope, name string, f func(format string, args ...interface{}
 // new objects to the build graph.
 func buildRule(s *scope, args []pyObject) pyObject {
         s.NAssert(s.pkg == nil, ""Cannot create new build rules in this context"")
-        // We need to set various defaults from config here; it is useful to put it on the rule but not often so
-        // because most rules pass them through anyway.
-        // TODO(peterebden): when we get rid of the old parser, put these defaults on all the build rules and
-        //                   get rid of this.
-        args[11] = defaultFromConfig(s.config, args[11], ""DEFAULT_VISIBILITY"")
-        args[15] = defaultFromConfig(s.config, args[15], ""DEFAULT_TESTONLY"")
-        args[30] = defaultFromConfig(s.config, args[30], ""DEFAULT_LICENCES"")
-        args[20] = defaultFromConfig(s.config, args[20], ""BUILD_SANDBOX"")
-        args[21] = defaultFromConfig(s.config, args[21], ""TEST_SANDBOX"")
         target := createTarget(s, args)
         s.Assert(s.pkg.Target(target.Label.Name) == nil, ""Duplicate build target in %s: %s"", s.pkg.Name, target.Label.Name)
         populateTarget(s, target, args)",you sure this is safe? did we put the defaults in everywhere they're needed?,go,1,1,0
"@@ -0,0 +1,18 @@
+// +build windows
+
+// Copyright 2014-2016 Amazon.com, Inc. or its affiliates. All Rights Reserved.
+//
+// Licensed under the Apache License, Version 2.0 (the ""License""). You may
+// not use this file except in compliance with the License. A copy of the
+// License is located at
+//
+//	http://aws.amazon.com/apache2.0/
+//
+// or in the ""license"" file accompanying this file. This file is distributed
+// on an ""AS IS"" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
+// express or implied. See the License for the specific language governing
+// permissions and limitations under the License.
+
+package api
+
+const OSType = ""windows""",Is this mainly used for task annotation purposes ?,go,1,1,1
"@@ -7,12 +7,17 @@ import (
 
 	""github.com/ethereum/go-ethereum/crypto""
 	""github.com/sonm-io/core/blockchain""
+	""github.com/sonm-io/core/blockchain/market""
 	""github.com/sonm-io/core/proto""
 	""github.com/sonm-io/core/util""
 )
 
+var (
+	HexKey = ""a5dd45e0810ca83e21f1063e6bf055bd13544398f280701cbfda1346bcf3ae64""
+)
+
 func main() {
-	prv, err := crypto.GenerateKey()
+	prv, err := crypto.HexToECDSA(HexKey)
 	if err != nil {
 		log.Fatalln(err)
 		return",why not use const? why is this variable exportable?,go,1,1,1
"@@ -3,6 +3,7 @@ package execute
 import (
 	""errors""
 	""fmt""
+	""github.com/google/go-cmp/cmp""
 	""sort""
 	""sync/atomic""
 ","nit, can you move this import down with the non stdlib imports.",go,1,1,1
"@@ -2107,6 +2107,17 @@ func (wh *WorkflowHandler) ResetWorkflowExecution(ctx context.Context, request *
 		return nil, err
 	}
 
+	switch request.GetResetReapplyType() {
+	case enumspb.RESET_REAPPLY_TYPE_UNSPECIFIED:
+		request.ResetReapplyType = enumspb.RESET_REAPPLY_TYPE_ALL
+	case enumspb.RESET_REAPPLY_TYPE_ALL:
+		// noop
+	case enumspb.RESET_REAPPLY_TYPE_NONE:
+		// noop
+	default:
+		return nil, serviceerror.NewInternal(""unknown reset type"")
+	}
+
 	namespaceID, err := wh.GetNamespaceCache().GetNamespaceID(request.GetNamespace())
 	if err != nil {
 		return nil, err",I moved all default to `enums/defaults.go` file.,go,1,1,1
"@@ -59,7 +59,7 @@ type initPipelineVars struct {
 	environments      []string
 	githubOwner       string
 	githubRepo        string
-	githubURL         string
+	URL               string
 	githubAccessToken string
 	gitBranch         string
 }","changing this from `githubURL` to `URL` has the side effect of exporting only this struct member, which may not be desired behavior. Can we change it to `providerURL` or just `url`? I know that typically we want to render acronyms in all caps but this warrants an exception.",go,1,1,1
"@@ -3129,6 +3129,14 @@ func (s *Server) jsConsumerCreate(sub *subscription, c *client, a *Account, subj
 	// Make sure we have sane defaults.
 	setConsumerConfigDefaults(&req.Config)
 
+	// Check if we have a BackOff defined that MaxDeliver is within range etc.
+	if lbo := len(req.Config.BackOff); lbo > 0 && req.Config.MaxDeliver <= lbo {
+		err := errors.New(""max deliver required to be > length backoff values"")
+		resp.Error = NewJSConsumerCreateError(err, Unless(err))
+		s.sendAPIErrResponse(ci, acc, subject, reply, string(msg), s.jsonResponse(&resp))
+		return
+	}
+
 	// Determine if we should proceed here when we are in clustered mode.
 	if s.JetStreamIsClustered() {
 		if req.Config.Direct {","Remove this, and then have `resp.Error = NewJS...` that you will get adding the new error.",go,1,1,1
"@@ -152,14 +152,10 @@ func (c *Client) buildTestCommand(target *core.BuildTarget) (*pb.Command, error)
 // getCommand returns the appropriate command to use for a target.
 func (c *Client) getCommand(target *core.BuildTarget) string {
         if target.IsRemoteFile {
-                // TODO(peterebden): we should handle this using the Remote Fetch API once that's available.
-                urls := make([]string, len(target.Sources))
-                for i, s := range target.Sources {
-                        urls[i] = ""curl -fsSLo $OUT "" + s.String()
-                }
-                cmd := strings.Join(urls, "" || "")
+                // This isn't a real command, but it suits us to construct a pseudo-version of one.
+                cmd := ""fetch "" + strings.Join(target.AllURLs(c.state.Config), "" "") + "" & verify "" + strings.Join(target.Hashes, "" "")
                 if target.IsBinary {
-                        return ""("" + cmd + "") && chmod +x $OUT""
+                        return cmd + "" binary""
                 }
                 return cmd
         }",How does this work?,go,1,0,1
"@@ -65,7 +65,12 @@ func (e *encoder) EncodeMap(n int) driver.Encoder {
 	return &mapEncoder{m: m}
 }
 
-var typeOfGoTime = reflect.TypeOf(time.Time{})
+var (
+	typeOfGoTime    = reflect.TypeOf(time.Time{})
+	typeOfBinarySet = reflect.TypeOf([][]byte{})
+	typeOfStringSet = reflect.TypeOf([]string{})
+	typeOfNumberSet = reflect.TypeOf([]float64{})
+)
 
 // EncodeSpecial encodes time.Time specially.
 func (e *encoder) EncodeSpecial(v reflect.Value) (bool, error) {","I think we said that _decoding_ any of the set types would fail, but I think we should support _encoding_ of `[]int`, `[]string` and `[][]byte` as arrays. I don't think there's any risk of data loss or corruption if we do that.",go,1,1,1
"@@ -110,8 +110,14 @@ type CASTemplateSpec struct {
 	// Defaults are a list of default configurations that may be applied
 	// during provisioning of a CAS volume
 	Defaults []Config `json:""defaultConfig""`
+	// TaskNamespace is the namespace where the tasks
+	// are expected to be found
+	TaskNamespace string `json:""taskNamespace""`
 	// RunTasks refers to a set of tasks to be run
 	RunTasks RunTasks `json:""run""`
+	// OutputTask is the task that has the CAS template result's output
+	// format
+	OutputTask string `json:""output""`
 }
 
 // CASUpdateSpec is the specification to update a CAS volume","would it be ever possible that the all runtasks don't run in the same namespace? If yes, then we should probably make namespace updatable by having it in runtask also.",go,1,1,1
"@@ -21,6 +21,7 @@ import (
 
 	go_dockerclient ""github.com/fsouza/go-dockerclient""
 	gomock ""github.com/golang/mock/gomock""
+	""github.com/aws/amazon-ecs-agent/agent/api""
 )
 
 // Mock of Manager interface","I think the convention is to order import statements as: 1) native go packages, 2) packages from the same repo, 3) other packages, with an empty line between each group. So this new line should be in 21?",go,1,1,1
"@@ -2567,6 +2567,8 @@ sendToRoutesOrLeafs:
 		kind := rt.sub.client.kind
 		mh := c.msgb[:msgHeadProtoLen]
 		if kind == ROUTER {
+			// Router (and Gateway) nodes are RMSG. Set here since leafnodes may rewrite.
+			mh[0] = 'R'
 			mh = append(mh, acc.Name...)
 			mh = append(mh, ' ')
 		} else {",Can we do that also in the other place we use this buffer? That would be gateway.go:2202 (from master)?,go,1,1,1
"@@ -15,4 +15,5 @@ type execVars struct {
 	taskID           string
 	containerName    string
 	skipConfirmation bool
+	yes              *bool
 }","I wonder if we should make this flag more descriptive, like `ssmPlugin` or `updateSSM` or something?",go,1,1,1
"@@ -171,12 +171,15 @@ type OutputInfo struct {
         FailureMessageWithoutPrivacyInfo string `json:""failure_message_without_privacy_info,omitempty""`
 }
 
-func (i *InputParams) updateParams(p *string) {
-        if p == nil {
+func (i *InputParams) updateParams(projectPointer *string) {
+        logParamsMutex.Lock()
+        defer logParamsMutex.Unlock()
+
+        if projectPointer == nil {
                 return
         }
 
-        project := *p
+        project := *projectPointer
         obfuscatedProject := Hash(project)
 
         if i.ImageImportParams != nil {",project is enough as it's obvious it's pointer from the type,go,1,1,1
"@@ -191,7 +191,11 @@ func MakeOfflineNode(t *testing.T) *Node {
 // DefaultTestingConfig returns default configuration for testing
 func DefaultTestingConfig() []ConfigOpt {
         return []ConfigOpt{
-                VerifierConfigOption(verification.NewFakeVerifier(true, nil)),
+                VerifierConfigOption(verification.NewFakeVerifier(verification.FakeVerifierConfig{
+                        VerifyPoStValid:                true,
+                        VerifyPieceInclusionProofValid: true,
+                        VerifySealValid:                true,
+                })),
         }
 }
 ","In my branch, the tests pass with this option removed. I believe we're only using this config for testing init and message propagation (which shouldn't touch proofs). Is this necessary?",go,1,1,1
"@@ -55,7 +55,7 @@ func TestChainValidationMessageSuite(t *testing.T) {
 
 func TestChainValidationTipSetSuite(t *testing.T) {
         f := NewFactories(&ValidationConfig{
-                trackGas:         true,
+                trackGas:         false,
                 checkExitCode:    true,
                 checkReturnValue: true,
         })",Do not merge this.,go,0,0,0
"@@ -272,8 +272,8 @@ func newSyntheticOpenContext() *openContext {
 func (f *FS) CreateFile(ctx context.Context, fi *dokan.FileInfo, cd *dokan.CreateData) (dokan.File, bool, error) {
 	// Only allow the current user access
 	if !fi.IsRequestorUserSidEqualTo(currentUserSID) {
-		f.log.Errorf(""Refusing access: SID match error"")
-		return nil, false, dokan.ErrAccessDenied
+		f.log.Errorf(""FS CreateFile - Refusing real access: SID match error"")
+		return openFakeRoot(ctx, f, fi)
 	}
 	f.logEnter(ctx, ""FS CreateFile"")
 	return f.openRaw(ctx, fi, cd)","We're always guaranteed on Windows that the root will get a `CreateFile` call first on an empty string, before file listing is allowed or any other specific files can be looked up?",go,1,1,1
"@@ -191,7 +191,7 @@ func makeErrorCookie(value string) *http.Cookie {
 		MaxAge:   defaultErrorCookieMaxAge,
 		Path:     rootPath,
 		Secure:   true,
-		HttpOnly: true,
+		HttpOnly: false,
 		SameSite: http.SameSiteLaxMode,
 	}
 }",I changed this value to read the error message from JavaScript.,go,1,1,1
"@@ -18,9 +18,14 @@
 package cmd
 
 import (
+        ""encoding/json""
         ""path/filepath""
         ""time""
 
+        ""github.com/mysteriumnetwork/node/nat/traversal/config""
+
+        ""github.com/mysteriumnetwork/node/nat/traversal""
+
         ""github.com/asaskevich/EventBus""
         log ""github.com/cihub/seelog""
         ""github.com/ethereum/go-ethereum/accounts/keystore""",Something wrong with import blocks.,go,1,0,0
"@@ -29,8 +29,8 @@ const (
 	// ECSBridgeNetworkName is the name of the HNS network used as ecs-bridge.
 	ECSBridgeNetworkName = ""nat""
 	// Constants for creating backoff while retrying setupNS.
-	setupNSBackoffMin      = time.Second * 2
-	setupNSBackoffMax      = time.Second * 6
+	setupNSBackoffMin      = time.Second * 4
+	setupNSBackoffMax      = time.Minute
 	setupNSBackoffJitter   = 0.2
 	setupNSBackoffMultiple = 1.3
 	setupNSMaxRetryCount   = 3",How did you come up with these values?,go,1,1,1
"@@ -0,0 +1,12 @@
+package grpcutil
+
+import (
+	""log""
+
+	""github.com/sirupsen/logrus""
+)
+
+func LoggerFromFieldLogger(fl logrus.FieldLogger) *log.Logger {
+	errWriter := fl.WithFields(logrus.Fields{}).WriterLevel(logrus.ErrorLevel)
+	return log.New(errWriter, """", 0)
+}",nit: Should this return logrus.StdLogger instead?,go,1,1,1
"@@ -25,6 +25,16 @@ import (
 	""github.com/mysteriumnetwork/node/session""
 )
 
+// SessionStatus represents list of possible session statuses
+type SessionStatus int
+
+const (
+	// SessionStatusNew means that newly created session object is written to storage
+	SessionStatusNew = SessionStatus(0)
+	// SessionStatusCompleted means that session object is updated on connection disconnect event
+	SessionStatusCompleted = SessionStatus(1)
+)
+
 // Session holds structure for saving session history
 type Session struct {
 	SessionID       session.ID `storm:""id""`","If it updated on disconnect event, maybe we should call it `Finished`?",go,1,1,1
"@@ -95,6 +95,10 @@ func (c *Controller) syncHandler(key string) error {
 	// TODO: Deep-copy only when needed.
 	cspcGot := cspc.DeepCopy()
 	err = c.syncCSPC(cspcGot)
+	if err != nil {
+		return err
+	}
+	err = cleanupCSPIResources(cspcGot)
 	return err
 }
 ",In the next PR's we can generate an event instead of returning an error. The event will be more visible to the user.,go,1,1,1
"@@ -11,9 +11,11 @@ import (
 
 	""github.com/ethersphere/bee/pkg/logging""
 	""github.com/ethersphere/bee/pkg/statestore/leveldb""
-	""github.com/ethersphere/bee/pkg/statestore/mock""
 	""github.com/ethersphere/bee/pkg/storage""
 	""github.com/ethersphere/bee/pkg/swarm""
+
+	ldb ""github.com/syndtr/goleveldb/leveldb""
+	ldbs ""github.com/syndtr/goleveldb/leveldb/storage""
 )
 
 // InitStateStore will initialize the stateStore with the given path to the",is it not possible to move this whole block into the `statestore/leveldb` implementation?,go,1,1,1
"@@ -19,13 +19,14 @@ func TestTruncate(t *testing.T) {
 		{""foo"", 0, """"},
 		{""foo"", -1, """"},
 		{""Löwen"", 4, ""Löwe""},
-		{""あああああああああ/data"", 10, ""あああああ""},
-		{""あああああああああ/data"", 11, ""あああああ""},
+		{""あああああ/data"", 7, ""あああ""},
+		{""あああああ/data"", 10, ""あああああ""},
+		{""あああああ/data"", 11, ""あああああ/""},
 	}
 
 	for _, test := range tests {
 		t.Run("""", func(t *testing.T) {
-			out := truncate(test.input, test.width)
+			out := Truncate(test.input, test.width)
 			if out != test.output {
 				t.Fatalf(""wrong output for input %v, width %d: want %q, got %q"",
 					test.input, test.width, test.output, out)","I think we should also keep this test, which checks that a unicode character is not split in half.",go,1,1,1
"@@ -23,10 +23,10 @@ func New(key *ecdsa.PrivateKey, pub *ecdsa.PublicKey, salt []byte, padding int,
 	return encryption.New(sk, padding, 0, hashfunc), nil
 }
 
-// NewEncrypter constructs an El-Gamal encryptor
+// NewEncryptor constructs an El-Gamal encryptor
 // this involves generating an ephemeral key pair the public part of which is returned
 // as it is needed for the counterparty to decrypt
-func NewEncrypter(pub *ecdsa.PublicKey, salt []byte, padding int, hashfunc func() hash.Hash) (encryption.Encrypter, *ecdsa.PublicKey, error) {
+func NewEncryptor(pub *ecdsa.PublicKey, salt []byte, padding int, hashfunc func() hash.Hash) (encryption.Encrypter, *ecdsa.PublicKey, error) {
 	privKey, err := crypto.GenerateSecp256k1Key()
 	if err != nil {
 		return nil, nil, err",why renaming to `Encryptor`? can we please have `Encrypter`?,go,1,1,1
"@@ -804,9 +804,7 @@ func TestConnectionIsClosedOnIdle(t *testing.T) {
 		_heartbeatJitter:     10 * time.Millisecond,
 	}
 	go func() {
-		timer := newDisconnectionTimer(mockWsClient, acsSession.heartbeatTimeout(), acsSession.heartbeatJitter())
-		defer timer.Stop()
-		acsSession.startACSSession(mockWsClient, timer)
+		acsSession.startACSSession(mockWsClient)
 	}()
 
 	// Wait for connection to be closed. If the connection is not closed",nit: remove the function wrapper `go acsSession.startACSSession(mockWsClient)`,go,1,1,1
"@@ -21,7 +21,10 @@ func setupGetAncestorTests(require *require.Assertions) (context.Context, *th.Te
 // requireGrowChain grows the given store numBlocks single block tipsets from
 // its head.
 func requireGrowChain(ctx context.Context, require *require.Assertions, blockSource *th.TestFetcher, chainStore chain.Store, numBlocks int) {
-	link := chainStore.Head()
+	head := chainStore.GetHead()
+	headTipSetAndState, err := chainStore.GetTipSetAndState(ctx, head)
+	require.NoError(err)
+	link := headTipSetAndState.TipSet
 
 	signer, ki := types.NewMockSignersAndKeyInfo(1)
 	mockSignerPubKey := ki[0].PublicKey()",these three lines are repeated a zillion times if you want to make a helper out of 'em. up to you.,go,1,1,1
"@@ -307,7 +307,7 @@ func newProp(name string, units interface{}) systemdDbus.Property {
 func getUnitName(c *configs.Cgroup) string {
 	// by default, we create a scope unless the user explicitly asks for a slice.
 	if !strings.HasSuffix(c.Name, "".slice"") {
-		return fmt.Sprintf(""%s-%s.scope"", c.ScopePrefix, c.Name)
+		return c.ScopePrefix + ""-"" + c.Name + "".scope""
 	}
 	return c.Name
 }",You lost the `.scope` part; I guess CI failures are because if this,go,1,1,1
"@@ -84,7 +84,7 @@ func StartSession(params *TelemetrySessionParams, statsEngine stats.Engine) erro
 			seelog.Info(""TCS Websocket connection closed for a valid reason"")
 			backoff.Reset()
 		} else {
-			seelog.Infof(""Error from tcs; backing off: %v"", tcsError)
+			seelog.Errorf(""Error: lost websocket connection with ECS Telemetry service (TCS): %v"", tcsError)
 			params.time().Sleep(backoff.Duration())
 		}
 	}","Can this be warn instead of errorf, customers look at these logs and think that something is wrong with the Agent when essentially it is not sending metrics to tcs.",go,1,1,1
"@@ -206,6 +206,10 @@ type Provisioning struct {
 	// Defaults to openshift-install if none specified.
 	// +optional
 	InstallStrategy *InstallStrategy `json:""installStrategy,omitempty""`
+
+	// ServiceAccountIssuerKeySecretRef refers to a Secret that contains a 'bound-service-account-signing-key.key' data key pointing to the private key that will be used to sign ServiceAccount objects. Primarily used to provision AWS clusters to use Amazon's Security Token Service.
+	// +optional
+	ServiceAccountIssuerKeySecretRef *corev1.LocalObjectReference `json:""serviceAccountIssuerKeySecretRef,omitempty""`
 }
 
 // ClusterImageSetReference is a reference to a ClusterImageSet",Would this be better named BoundServiceAccountSigningKeySecretRef to match the installer filename? Also why am I not seeing the change in top level apis/ ? Only the vendored version?,go,1,1,1
"@@ -54,6 +54,9 @@ const (
 //              b. Notify dirty rules
 //
 type Controller struct {
+	// antreaPolicyEnabled indicates whether Antrea NetworkPolicy and
+	// ClusterNetworkPolicy are enabled.
+	antreaPolicyEnabled bool
 	// antreaClientProvider provides interfaces to get antreaClient, which can be
 	// used to watch Antrea AddressGroups, AppliedToGroups, and NetworkPolicies.
 	// We need to get antreaClient dynamically because the apiserver cert can be",btw why not use features.DefaultFeatureGate.Enabled() to determine?,go,1,1,1
"@@ -69,11 +69,14 @@ type demux struct {
 // makeDemux initializes the goroutines needed to process external events, setting up the appropriate channels.
 //
 // It must be called before other methods are called.
-func makeDemux(net Network, ledger LedgerReader, validator BlockValidator, voteVerifier *AsyncVoteVerifier, processingMonitor EventsProcessingMonitor, log logging.Logger) (d *demux) {
+func makeDemux(net Network, ledger LedgerReader, validator BlockValidator, voteVerifier *AsyncVoteVerifier, processingMonitor EventsProcessingMonitor, log logging.Logger, monitor *coserviceMonitor) (d *demux) {
 	d = new(demux)
 	d.crypto = makeCryptoVerifier(ledger, validator, voteVerifier, log)
 	d.log = log
 	d.ledger = ledger
+	d.monitor = monitor
+	d.queue = make([]<-chan externalEvent, 0)
+	d.processingMonitor = processingMonitor
 
 	tokenizerCtx, cancelTokenizers := context.WithCancel(context.Background())
 	d.rawVotes = d.tokenizeMessages(tokenizerCtx, net, protocol.AgreementVoteTag, decodeVote)",how about moving all the params to demuxParams struct ?,go,1,1,1
"@@ -714,8 +714,8 @@ func (fs *FS) Chtimes(name string, atime time.Time, mtime time.Time) (
 	return fs.config.KBFSOps().SetMtime(fs.ctx, n, &mtime)
 }
 
-// Chroot implements the billy.Filesystem interface for FS.
-func (fs *FS) Chroot(p string) (newFS billy.Filesystem, err error) {
+// Chrute returns a *FS whose root is p.
+func (fs *FS) Chrute(p string) (newFS *FS, err error) {
 	fs.log.CDebugf(fs.ctx, ""Chroot %s"", p)
 	defer func() {
 		fs.deferLog.CDebugf(fs.ctx, ""Chroot done: %+v"", err)",I don't really get this function name. Maybe `ChrootAsLibFS()`?,go,1,1,1
"@@ -28,6 +28,8 @@ var statesaver statemanager.Saver = statemanager.NewNoopStateManager()
 
 func HandleEngineEvents(taskEngine engine.TaskEngine, client api.ECSClient, saver statemanager.Saver) {
 	statesaver = saver
+	handler := NewTaskHandler()
+
 	for {
 		taskEvents, containerEvents := taskEngine.TaskEvents()
 ",It looks like now you have two separate `taskHandler`s: one here and one in `agent/acs/handler/payload_handler.go`. Is that intentional?,go,1,1,1
"@@ -409,10 +409,11 @@ func TestStopContainerTimeout(t *testing.T) {
 	mockDocker, client, testTime, done := dockerclientSetup(t)
 	defer done()
 
+	dockerStopTimeout := client.config.DockerStopTimeoutSeconds
 	wait := &sync.WaitGroup{}
 	wait.Add(1)
-	mockDocker.EXPECT().StopContainer(""id"", uint(dockerStopTimeoutSeconds)).Do(func(x, y interface{}) {
-		testTime.Warp(stopContainerTimeout)
+	mockDocker.EXPECT().StopContainer(""id"", uint(dockerStopTimeout)).Do(func(x, y interface{}) {
+		testTime.Warp(stopContainerAPITimeout + time.Duration(dockerStopTimeout)*time.Second)
 		wait.Wait()
 		// Don't return, verify timeout happens
 	})",I think you want this to be `client.config.DockerStopTimeoutSeconds + stopContainerAPITimeout`.,go,1,1,1
"@@ -639,8 +639,9 @@ func (km *KeyManagerStandard) Rekey(ctx context.Context, md *RootMetadata, promp
 	if !isWriter {
 		if len(newReaderUsers) > 0 || addNewWriterDevice || incKeyGen {
 			// If we're a reader but we haven't completed all the work, return
-			// RekeyIncompleteError
-			return false, nil, RekeyIncompleteError{}
+			// RekeyIncompleteError.
+			rekeyDone := len(newReaderUsers) > 0
+			return rekeyDone, nil, RekeyIncompleteError{}
 		}
 		// Otherwise, there's nothing left to do!
 		return true, nil, nil",Why does this mean it rekeyed anything?,go,1,0,0
"@@ -27,10 +27,11 @@ type Interface interface {
 }
 
 type ipset struct {
+	refCount
 }
 
 func New() Interface {
-	return &ipset{}
+	return &ipset{refCount: newRefCount()}
 }
 
 func (i *ipset) Create(ipsetName Name, ipsetType Type) error {",Is it possible for `Destroy` to be called twice with the same `ipsetName`?,go,1,1,1
"@@ -55,7 +55,7 @@ func ensureOrCreateDir(dir string) error {
         err := ensureDirExists(dir)
         if os.IsNotExist(err) {
                 log.Info(""[Directory config checker] "", ""Directory: "", dir, "" does not exit. Creating new one"")
-                return os.MkdirAll(dir, 0600)
+                return os.MkdirAll(dir, 0700)
         }
         return err
 }",Was is a debugged place??,go,0,0,0
"@@ -90,8 +90,7 @@ func TestFormatWithCommentsParens(t *testing.T) {
 		t.Fatal(err)
 	}
 
-	if want := `
-// comment\n(1 * 1)`; want != got {
+	if want := `// comment\n(1 * 1)`; want != got {
 		t.Errorf(""unexpected formatted file -want/+got:\n\t- %q\n\t+ %q"", want, got)
 	}
 }",Is this a change that was added to the formatter or just a go format change?,go,1,1,1
"@@ -16,6 +16,7 @@ type Connection interface {
 	BreakTie(Connection) ConnectionTieBreak
 	RemoteTCPAddr() string
 	Established() bool
+	Outbound() bool
 	Shutdown(error)
 	Log(args ...interface{})
 }","Suggested order: Local, Remote, RemoteTCPAddr, Outbound, Established, BreakTie, Shutdown, Log.",go,1,1,1
"@@ -39,6 +39,7 @@ func TestGenerateConfig(t *testing.T) {
 		baseConfig alertmanagerConfig
 		amConfigs  map[string]*monitoringv1alpha1.AlertmanagerConfig
 		expected   string
+		ctx        context.Context
 	}
 
 	globalSlackAPIURL, err := url.Parse(""http://slack.example.com"")","I think it would make more sense to have the context global to the test function. I don't think we need to test different contexts in the cases, it should remain the same for each of them.",go,1,1,1
"@@ -37,8 +37,8 @@ const (
 	Streaming
 )
 
-// HandlerSpec holds either a UnaryTransportHandler or StreamTransportHandler.
-type HandlerSpec struct {
+// TransportHandlerSpec holds either a UnaryTransportHandler or StreamTransportHandler.
+type TransportHandlerSpec struct {
 	t Type
 
 	unaryHandler  UnaryTransportHandler","Let's avoid interleaving types and methods. With few exceptions, a type declaration should be followed by all of its methods. It might even be okay to rename this to transport.go and add encoding.go or similar with the mirror world types and methods.",go,1,1,1
"@@ -40,6 +40,18 @@ func (z ChannelID) MarshalJSON() ([]byte, error) {
 	return json.Marshal(z.val)
 }
 
+// MarshalBinary converts a ChannelID to bytes
+func (z *ChannelID) MarshalBinary() ([]byte, error) {
+	return z.Bytes(), nil
+}
+
+// UnmarshalBinary converts bytes to a ChannelID
+func (z *ChannelID) UnmarshalBinary(b []byte) error {
+	chID := NewChannelIDFromBytes(b)
+	*z = *chID
+	return nil
+}
+
 // An ChannelID is a signed multi-precision integer.
 type ChannelID struct{ val *big.Int }
 ",the idea was for this structures to implement `Encode/Decode` which can be then use with multiple encoders.,go,1,1,1
"@@ -230,7 +230,7 @@ var TxnTypeNames = []string{
 }
 
 // map TxnTypeName to its enum index, for `txn TypeEnum`
-var txnTypeIndexes map[string]int
+var txnTypeIndexes map[string]uint64
 
 // map symbolic name to uint64 for assembleInt
 var txnTypeConstToUint64 map[string]uint64","why uint64? these are indexes in an array, and no plans to have 2^64 long arrays",go,1,1,1
"@@ -403,7 +403,15 @@ func (b *bucket) ListPaged(ctx context.Context, opts *driver.ListOptions) (*driv
 func (b *bucket) As(i interface{}) bool { return false }
 
 // As implements driver.ErrorAs.
-func (b *bucket) ErrorAs(err error, i interface{}) bool { return false }
+func (b *bucket) ErrorAs(err error, i interface{}) bool {
+	if perr, ok := err.(*os.PathError); ok {
+		if p, ok := i.(**os.PathError); ok {
+			*p = perr
+			return true
+		}
+	}
+	return false
+}
 
 // Attributes implements driver.Attributes.
 func (b *bucket) Attributes(ctx context.Context, key string) (driver.Attributes, error) {",Please also update the package godoc for As.,go,1,1,1
"@@ -146,9 +146,14 @@ func (manager *basicStateManager) writeFile(data []byte) error {
 		seelog.Errorf(""Failed to save the data file path: %v"", err)
 		return err
 	}
+	if oldFile == """" {
+		return nil
+	}
+
 	err = deps.fs.Remove(oldFile)
 	if err != nil {
 		seelog.Errorf(""Error removing old file %s; err %v"", oldFile, err)
+		return err
 	}
 	return nil
 }",i think you still need `return nil` here.,go,1,0,1
"@@ -13,9 +13,9 @@ import (
 	""sync""
 	""time""
 
+	""github.com/iotexproject/go-fsm""
 	""github.com/pkg/errors""
 	""github.com/prometheus/client_golang/prometheus""
-	""github.com/zjshen14/go-fsm""
 	""go.uber.org/zap""
 
 	""github.com/iotexproject/iotex-core/crypto""",File is not `goimports`-ed (from `goimports`),go,0,1,1
"@@ -50,14 +50,8 @@ const (
         eniIPv4Address        = ""10.0.0.2""
 )
 
-func TestTaskMetadata(t *testing.T) {
-        ctrl := gomock.NewController(t)
-        defer ctrl.Finish()
-
-        state := mock_dockerstate.NewMockTaskEngineState(ctrl)
-        auditLog := mock_audit.NewMockAuditLogger(ctrl)
-
-        task := &api.Task{
+var (
+        task = &api.Task{
                 Arn:                 taskARN,
                 Family:              family,
                 Version:             version,","cool, didn't know var declaration blocks were a thing.",go,1,0,1
"@@ -42,10 +42,11 @@ var (
 		""sles-12-byol"":        ""suse/translate_sles_12_byol.wf.json"",
 		""sles-15-byol"":        ""suse/translate_sles_15_byol.wf.json"",
 		""rhel-6"":              ""enterprise_linux/translate_rhel_6_licensed.wf.json"",
-		""rhel-6-byol"":         ""enterprise_linux/translate_rhel_6_byol.wf.json"",
 		""rhel-7"":              ""enterprise_linux/translate_rhel_7_licensed.wf.json"",
 		""rhel-8"":              ""enterprise_linux/translate_rhel_8_licensed.wf.json"",
+		""rhel-6-byol"":         ""enterprise_linux/translate_rhel_6_byol.wf.json"",
 		""rhel-7-byol"":         ""enterprise_linux/translate_rhel_7_byol.wf.json"",
+		""rhel-8-byol"":         ""enterprise_linux/translate_rhel_8_byol.wf.json"",
 		""ubuntu-1404"":         ""ubuntu/translate_ubuntu_1404.wf.json"",
 		""ubuntu-1604"":         ""ubuntu/translate_ubuntu_1604.wf.json"",
 		""ubuntu-1804"":         ""ubuntu/translate_ubuntu_1804.wf.json"",",@zmarano -- Any thoughts on the name of the user-facing OS name? (`rhel-8-byol` vs `rhel-8-byos`),go,0,1,1
"@@ -73,7 +73,7 @@ func AdminShowWorkflow(c *cli.Context) {
 	serializer := serialization.NewSerializer()
 	var history []*commonpb.DataBlob
 	if len(tid) != 0 {
-		histV2 := cassandra.NewHistoryV2PersistenceFromSession(session, log.NewNoopLogger())
+		histV2 := cassandra.NewWorkflowStore(-1, session, log.NewNoopLogger())
 		resp, err := histV2.ReadHistoryBranch(&persistence.InternalReadHistoryBranchRequest{
 			TreeID:    tid,
 			BranchID:  bid,","this is weird, can we try to put shard ID as part of request? instead of internal var of execution / workflow store",go,1,1,1
"@@ -57,9 +57,9 @@ type Actor struct{}
 type State struct {
 	Miners cid.Cid `refmt:"",omitempty""`
 
-	// TotalCommitedStorage is the number of sectors that are currently committed
-	// in the whole network.
-	TotalCommittedStorage *big.Int
+	// TODO: Determine correct unit of measure. Could be denominated in the
+	// smallest sector size supported by the network.
+	TotalCommittedStorage *types.BytesAmount
 
 	ProofsMode types.ProofsMode
 }","Would you mind linking an existing github issue in this TODO, or making a new one and linking it if one does not already exist?",go,1,1,1
"@@ -25,13 +25,15 @@ func TestTotal(t *testing.T) {
 
 	ctx := context.Background()
 
-	power := uint64(19)
-	bs, _, st := requireMinerWithPower(ctx, t, power)
+	numCommittedSectors := uint64(19)
+	bs, _, st := requireMinerWithPower(ctx, t, numCommittedSectors)
 
 	actual, err := (&consensus.MarketView{}).Total(ctx, st, bs)
 	require.NoError(t, err)
 
-	assert.Equal(t, power, actual)
+	expected := types.OneKiBSectorSize.Mul(types.NewBytesAmount(numCommittedSectors))
+
+	assert.Equal(t, expected.Uint64(), actual.Uint64())
 }
 
 func TestMiner(t *testing.T) {",This function name is now a bit misleading about the uint value.,go,1,1,1
"@@ -143,3 +143,7 @@ type wsProjectManager interface {
 type artifactPutter interface {
 	PutArtifact(bucket, fileName string, data io.Reader) (string, error)
 }
+
+type port interface {
+	Set(number int) error
+}",Is this interface used anywhere?,go,1,0,1
"@@ -55,6 +55,16 @@ func nodeStatus(node *node.AlgorandFullNode) (res v1.NodeStatus, err error) {
 	}, nil
 }
 
+func txEncode(tx transactions.Transaction, ad transactions.ApplyData) (res v1.Transaction, err error) {
+	if tx.Type == protocol.PaymentTx {
+		return paymentTxEncode(tx, ad), nil
+	}
+	if tx.Type == protocol.KeyRegistrationTx {
+		return keyregTxEncode(tx, ad), nil
+	}
+	return v1.Transaction{}, errors.New(errUnknownTransactionType)
+}
+
 func paymentTxEncode(tx transactions.Transaction, ad transactions.ApplyData) v1.Transaction {
 	payment := v1.PaymentTransactionType{
 		To:           tx.Receiver.String(),",Use a case statement here to switch between the different transaction types.,go,1,1,1
"@@ -1270,6 +1270,9 @@ func (s *Server) StartProfiler() {
 	s.profilingServer = srv
 	s.mu.Unlock()
 
+	// Enable blocking profile
+	runtime.SetBlockProfileRate(1)
+
 	go func() {
 		// if this errors out, it's probably because the server is being shutdown
 		err := srv.Serve(l)","I am thinking this was part of a test, no?",go,1,0,1
"@@ -1182,7 +1182,7 @@ func TestGetHostPublicIPv4AddressFromEC2MetadataFailWithError(t *testing.T) {
 	assert.Empty(t, agent.getHostPublicIPv4AddressFromEC2Metadata())
 }
 
-func TestSpotTerminationTimeCheck_Yes(t *testing.T) {
+func TestSpotInstanceActionCheck_Terminate(t *testing.T) {
 	ctrl := gomock.NewController(t)
 	defer ctrl.Finish()
 ",all these unit tests could be made table-driven.,go,1,1,1
"@@ -0,0 +1,16 @@
+package tequilapi
+
+import (
+	""github.com/stretchr/testify/assert""
+	""testing""
+)
+
+func TestLocalApiServerPortIsAsExpected(t *testing.T) {
+	server, err := NewServer("""", 31337, nil)
+	assert.Nil(t, err)
+
+	assert.Equal(t, 31337, server.Port())
+
+	server.Stop()
+	server.Wait()
+}","You dont need a getter method, because You are testing in same package",go,1,1,1
"@@ -14,14 +14,13 @@ import (
 	""github.com/aws/copilot-cli/internal/pkg/aws/aas""
 	""github.com/aws/copilot-cli/internal/pkg/aws/cloudwatch""
 	""github.com/aws/copilot-cli/internal/pkg/aws/ecs""
-	rg ""github.com/aws/copilot-cli/internal/pkg/aws/resourcegroups""
 	""github.com/aws/copilot-cli/internal/pkg/aws/sessions""
 	""github.com/aws/copilot-cli/internal/pkg/deploy""
+	copiEcs ""github.com/aws/copilot-cli/internal/pkg/ecs""
 	""github.com/aws/copilot-cli/internal/pkg/term/color""
 )
 
 const (
-	ecsServiceResourceType    = ""ecs:service""
 	maxAlarmStatusColumnWidth = 30
 )
 ","nit: I'd instead rename the `aws/ecs` to `awsECS`. Reading ""copiEcs"" is kinda odd :P",go,1,1,1
"@@ -285,7 +285,7 @@ func CheckNetWork(IP string, timeout int, cloudhubServer string, edgecoreServer
 	if config != """" {
 		edgeConfig, err := util.ParseEdgecoreConfig(config)
 		if err != nil {
-			err = fmt.Errorf(""parse Edgecore config failed"")
+			return fmt.Errorf(""parse Edgecore config failed"")
 		} else {
 			if cloudhubServer == """" {
 				cloudhubServer = edgeConfig.Modules.EdgeHub.WebSocket.Server",I think the else can't be deleted.The variable cloudhubServer need to be set a default value if it's not assigned.,go,1,1,1
"@@ -43,8 +43,9 @@ const (
 	ServiceHeaderKey = ""$rpc$-service""
 	// ApplicationErrorNameHeaderKey is the response header key for the application error name.
 	ApplicationErrorNameHeaderKey = ""$rpc$-application-error-name""
-	// ApplicationErrorMessageHeaderKey is the response header key for the application error messages.
-	ApplicationErrorMessageHeaderKey = ""$rpc$-application-error-message""
+	// ApplicationErrorDetailsHeaderKey is the response header key for the
+	// application error details string.
+	ApplicationErrorDetailsHeaderKey = ""$rpc$-application-error-details""
 	// ApplicationErrorCodeHeaderKey is the response header key for the application error code.
 	ApplicationErrorCodeHeaderKey = ""$rpc$-application-error-code""
 )","Same as above, what is the implication of this change? this is a public method, are you sure that nobody is using this?",go,1,1,1
"@@ -65,13 +65,10 @@ const (
 
 // SPI on the Trinket M0.
 var (
-	SPI0 = SPI{Bus: sam.SERCOM0_SPI,
-		SCK:     SPI0_SCK_PIN,
-		MOSI:    SPI0_MOSI_PIN,
-		MISO:    SPI0_MISO_PIN,
-		DOpad:   spiTXPad2SCK3,
-		DIpad:   sercomRXPad0,
-		PinMode: PinSERCOMAlt}
+	SPI0 = SPI{
+		Bus:    sam.SERCOM0_SPI,
+		SERCOM: 0,
+	}
 )
 
 // I2C pins",I think this should have been `sercomRXPad1` as well.,go,1,1,1
"@@ -1573,12 +1573,8 @@ func (e *mutableStateBuilder) IsWorkflowExecutionRunning() bool {
 	}
 }
 
-func (e *mutableStateBuilder) IsCancelRequested() (bool, string) {
-	if e.executionInfo.CancelRequested {
-		return e.executionInfo.CancelRequested, e.executionState.CreateRequestId
-	}
-
-	return false, """"
+func (e *mutableStateBuilder) IsCancelRequested() bool {
+	return e.executionInfo.CancelRequested
 }
 
 func (e *mutableStateBuilder) IsSignalRequested(",Why were we using `CreateRequestId` as `CancelRequestID`?,go,1,1,1
"@@ -16,6 +16,15 @@ import (
 )
 
 func SpawnHashStateStage(s *StageState, db ethdb.Database, tmpdir string, quit <-chan struct{}) error {
+	
+	go func() {
+		// we block until we can read something from the channel and then we reset hash state
+		<-quit
+		if err := ResetHashState(db); err != nil {
+			fmt.Errorf(""Unable to reset hashstate %v"", err)
+		}
+	}()
+
 	to, err := s.ExecutionAt(db)
 	if err != nil {
 		return err",%w is used for formatting errors,go,1,1,1
"@@ -74,6 +74,9 @@ func (s *CloudBackupServer) Create(
 		Labels:         req.GetLabels(),
 	})
 	if err != nil {
+		if err == volume.ErrInvalidName {
+			return nil, status.Errorf(codes.AlreadyExists, ""Failed to create backup: %v"", err)
+		}
 		return nil, status.Errorf(codes.Internal, ""Failed to create backup: %v"", err)
 	}
 ","Instead of using the same message, it should be something like ""Backup already exists or invalid name""...",go,1,1,1
"@@ -62,6 +62,14 @@ type blockJournal struct {
 	j          diskJournal
 	refs       map[BlockID]blockRefMap
 	isShutdown bool
+
+	// Tracks the total size of on-disk blocks that will be put to the
+	// server (i.e., does not count reference adds).  It is only
+	// accurate for users of this journal that properly flush entries;
+	// in particular, direct calls to `removeReferences` can cause
+	// this count to deviate from the actual disk usage of the
+	// journal.
+	blockBytes int64
 }
 
 type bserverOpName string","A better name might be `bytesToFlush`, to emphasize that it only matters when flushing.",go,1,1,1
"@@ -982,6 +982,10 @@ func (fbm *folderBlockManager) isQRNecessary(
 		fbm.log.CWarningf(ctx, ""Couldn't get the current session: %+v"", err)
 		return false
 	}
+	// It's ok to treat both MDs written by this process on this
+	// device, and MDs written by other processes (e.g., kbgit) in the
+	// same way.  Other processes are likely to be short-lived, and
+	// probably won't do their own QR, so a conflict is unlikely here.
 	selfWroteHead := session.VerifyingKey == head.LastModifyingWriterVerifyingKey()
 
 	// Don't do reclamation if the head isn't old enough and it wasn't","If the unlikely happen, does it just mean a more expensive operation, but not affect correctness?",go,1,1,1
"@@ -978,7 +978,7 @@ func (mset *Stream) Snapshot(deadline time.Duration, checkMsgs, includeConsumers
 		o.writeState()
 	}
 
-	return store.Snapshot(deadline, checkMsgs, includeConsumers)
+	return store.Snapshot(deadline, includeConsumers, checkMsgs)
 }
 
 const snapsDir = ""__snapshots__""","argument order in stream.Snapshot is different from store.Snapshot, I left as is and just fixed the bug but can fix - probably should",go,1,1,1
"@@ -354,10 +354,17 @@ type Rule struct {
 	// +optional
 	From []NetworkPolicyPeer `json:""from""`
 	// Rule is matched if traffic is intended for workloads selected by
-	// this field. If this field is empty or missing, this rule matches all
-	// destinations.
+	// this field. This field can't be used with ToServices. If this field
+	// and ToServices are both empty or missing this rule matches all destinations.
 	// +optional
 	To []NetworkPolicyPeer `json:""to""`
+	// Rule is matched if traffic is intended for a Service listed in this field.
+	// Currently only ClusterIP types Services are supported in this field. This field
+	// can only be used when AntreaProxy is enabled. This field can't be used with To
+	// or Ports. If this field and To are both empty or missing, this rule matches all
+	// destinations.
+	// +optional
+	ToServices []ServiceReference `json:""toServices""`
 	// Name describes the intention of this rule.
 	// Name should be unique within the policy.
 	// +optional","This is ambiguous IMO. We should use `Rule is matched if traffic is intended for a Service listed in this field`. The current phrasing *kind of* implies that we would enforce the policy when accessing endpoints directly, which is not the case.",go,1,1,1
"@@ -19,7 +19,7 @@ package participation
 import (
         ""path/filepath""
         ""testing""
-
+        ""runtime"" 
         ""github.com/stretchr/testify/require""
 
         ""github.com/algorand/go-algorand/config""",add an empty line after this entry,go,0,0,1
"@@ -12,13 +12,16 @@ import (
 	""google.golang.org/protobuf/encoding/protojson""
 
 	topologyv1 ""github.com/lyft/clutch/backend/api/topology/v1""
+	""github.com/lyft/clutch/backend/service""
 )
 
 const topologyCacheLockId = ""topology:cache""
 
 // Performs leader election by acquiring a postgres advisory lock.
 // Once the lock is acquired topology caching is started.
-func (c *client) acquireTopologyCacheLock(ctx context.Context) {
+func (c *client) acquireTopologyCacheLock() {
+	ctx, ctxCancelFunc := context.WithCancel(context.Background())
+
 	// We create our own connection to use for acquiring the advisory lock
 	// If the connection is severed for any reason the advisory lock will automatically unlock
 	conn, err := c.db.Conn(ctx)","I need to find a better way of handling / canceling the context here, open to any suggestions.",go,1,1,1
"@@ -74,7 +74,7 @@ public interface BAToolsConfig extends Config
 	@ConfigItem(
 		keyName = ""healerMenuOption"",
 		name = ""Healer menu options"",
-		description = ""asd""
+		description = ""Healer menu options""
 	)
 	default boolean healerMenuOption()
 	{",This is not really a descriptive description,java,1,0,1
"@@ -495,14 +495,7 @@ namespace AutoRest.Ruby.Model
         {
             IndentedStringBuilder builder = new IndentedStringBuilder("""");
             builder.AppendLine(""response = {0}_async({1}).value!"", Name, MethodParameterInvocation);
-            if (ReturnType.Body != null)
-            {
-                builder.AppendLine(""response.body unless response.nil?"");
-            }
-            else
-            {
-                builder.AppendLine(""nil"");
-            }
+            builder.AppendLine(""response.body unless response.nil?"");
             return builder.ToString();
         }
 ","@sarangan12 in the previous code, if body wasn't null, then we would return response.body (unless response was null), otherwise we'd return nil, since body was null. With the updated code I see that we're updating the resulting source code, does it change the resulting value? if response.body is null, what do we return? and if it's not, it looks like we're returning the same thing as before. What am I missing? Is there an example that would help see this in action?",java,0,1,0
"@@ -124,9 +124,11 @@ public abstract class FlatteningConfig {
     // flattening.
     Map<String, FlatteningConfig> flatteningConfigs = new LinkedHashMap<>();
 
-    flatteningConfigs.putAll(flatteningConfigsFromGapicConfig);
-    // Let flattenings from proto annotations override flattenings from GAPIC config.
+    // Let flattenings from GAPIC config override flattenings from proto annotations.
     flatteningConfigs.putAll(flatteningConfigsFromProtoFile);
+    flatteningConfigs.putAll(flatteningConfigsFromGapicConfig);
+
+    flatteningConfigs.putAll(flatteningConfigsFromGapicConfig);
 
     return ImmutableList.copyOf(flatteningConfigs.values());
   }",Why duplicate this on line 131?,java,1,0,1
"@@ -1056,4 +1056,8 @@ public class SystemConfig {
 	public boolean directUploadEnabled(Dataset dataset) {
     	return Boolean.getBoolean(""dataverse.files."" + dataset.getDataverseContext().getEffectiveStorageDriverId() + "".upload-redirect"");
 	}
+	
+	public String getUserIpAddressSourceHeaderField() {
+        return System.getProperty(""dataverse.useripaddresssourceheader"", null);
+    }
 }","null is the default default so I think you can use System.getProperty(""dataverse.useripaddresssourceheader"");",java,1,1,1
"@@ -19,7 +19,7 @@ import net.sourceforge.pmd.lang.java.qname.JavaTypeQualifiedName;
  *
  * </pre>
  */
-public class ASTEnumConstant extends AbstractJavaNode implements JavaQualifiableNode {
+public class ASTEnumConstant extends AbstractJavaTypeNode implements JavaQualifiableNode {
 
     private JavaTypeQualifiedName qualifiedName;
 ","I'm not sure how this interacts with pmd 7 - I think enum constants have the type of their enum type (not an anonymous class), but the AnonymousClass node, if any, will have a different type... Something to keep in mind when merging into pmd 7",java,1,1,1
"@@ -58,6 +58,8 @@ public abstract class AbstractAzkabanServlet extends HttpServlet {
   private static final String AZKABAN_FAILURE_MESSAGE =
       ""azkaban.failure.message"";
   private static final long serialVersionUID = -1;
+
+  protected String passwordPlaceholder;
   private AzkabanServer application;
   private String name;
   private String label;",Why passwordPlaceholder is added in AbstractAzkabanServlet instead of LoginAbstractAzkabanServlet?,java,1,0,1
"@@ -104,6 +104,8 @@ public final class UserDictionary implements Dictionary {
     long ord = 0;
     
     for (String[] values : featureEntries) {
+      String surface = values[0].replaceAll("" "", """");
+      String concatenatedSegment = values[1].replaceAll("" "", """");
       String[] segmentation = values[1].replaceAll(""  *"", "" "").split("" "");
       String[] readings = values[2].replaceAll(""  *"", "" "").split("" "");
       String pos = values[3];",maybe replace all white space here (ie including tabs) by using \s?,java,1,0,1
"@@ -73,6 +73,9 @@ final class FilterComparator implements Comparator<Filter>, Serializable {
                 filterToOrder.put(
                         ""org.springframework.security.oauth2.client.web.OAuth2AuthorizationRequestRedirectFilter"",
                                 order.next());
+                filterToOrder.put(
+                                ""org.springframework.security.saml2.provider.service.servlet.filter.SamlServiceProviderMetadataFilter"",
+                                order.next());
                 filterToOrder.put(
                                 ""org.springframework.security.saml2.provider.service.servlet.filter.Saml2WebSsoAuthenticationRequestFilter"",
                                 order.next());",I think this needs to be changed to match the changes made to `Saml2MetadataFilter`'s name and location.,java,1,1,1
"@@ -485,10 +485,16 @@ public class Transaction implements org.hyperledger.besu.plugin.data.Transaction
     }
 
     final BigInteger recId = BigInteger.valueOf(signature.getRecId());
-    if (chainId.isEmpty()) {
-      return recId.add(REPLAY_UNPROTECTED_V_BASE);
+
+    if (transactionType != null && transactionType != TransactionType.FRONTIER) {
+      // EIP-2718 typed transaction, return yParity:
+      return recId;
     } else {
-      return recId.add(REPLAY_PROTECTED_V_BASE).add(TWO.multiply(chainId.get()));
+      if (chainId.isEmpty()) {
+        return recId.add(REPLAY_UNPROTECTED_V_BASE);
+      } else {
+        return recId.add(REPLAY_PROTECTED_V_BASE).add(TWO.multiply(chainId.get()));
+      }
     }
   }
 ",Is it really transaction envelope or EIP1559 transactions ?,java,1,1,1
"@@ -1050,10 +1050,14 @@ public class JDBCConnection implements ObjectStoreConnection {
             ps.setString(2, roleName);
             try (ResultSet rs = executeQuery(ps, caller)) {
                 if (rs.next()) {
-                    return new Role().setName(ZMSUtils.roleResourceName(domainName, roleName))
-                            .setModified(Timestamp.fromMillis(rs.getTimestamp(ZMSConsts.DB_COLUMN_MODIFIED).getTime()))
-                            .setTrust(saveValue(rs.getString(ZMSConsts.DB_COLUMN_TRUST)))
-                            .setAuditEnabled(rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED));
+                    Role r = new Role();
+                    r.setName(ZMSUtils.roleResourceName(domainName, roleName))
+                     .setModified(Timestamp.fromMillis(rs.getTimestamp(ZMSConsts.DB_COLUMN_MODIFIED).getTime()))
+                     .setTrust(saveValue(rs.getString(ZMSConsts.DB_COLUMN_TRUST)));
+                    if (rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED)) {
+                        r.setAuditEnabled(rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED));
+                    }
+                     return r;
                 }
             }
         } catch (SQLException ex) {","I'd like to propose a slightly different implementation to make our intentions clear. I would keep the original code but replace the last line: .setAuditEnabled(rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED)); with .setAuditEnabled(nullIfDefaultValue(rs.getBoolean(ZMSConsts.DB_COLUMN_AUDIT_ENABLED), false)); and then have: Boolean nullIfDefaultValue(boolean flag, boolean defaultValue) { return flag == defaultValue ? null : flag; } this way a reader would know that our intentions is to use null when we have the default value as opposed to trying to understand why we're not setting the value false.",java,1,1,0
"@@ -113,6 +113,7 @@ abstract class Bucket<T> implements Transform<T, Integer> {
             predicate.op(), name, apply(predicate.literal().value()));
 //      case IN:
 //        return Expressions.predicate();
+      case STARTS_WITH:
       default:
         // comparison predicates can't be projected, notEq can't be projected
         // TODO: small ranges can be projected.","I am not sure if a `startsWith` predicate makes sense in case of `Bucket` transforms. Hence, leaving it to be handled by the `default` case. WDYT?",java,1,1,1
"@@ -26,6 +26,7 @@ public class NodeJSSampleTypeNameConverter implements SampleTypeNameConverter {
   /** A map from primitive types in proto to NodeJS counterparts. */
   private static final ImmutableMap<Field.Kind, String> PRIMITIVE_TYPE_MAP =
       ImmutableMap.<Field.Kind, String>builder()
+          .put(Field.Kind.TYPE_UNKNOWN, ""Object"")
           .put(Field.Kind.TYPE_BOOL, ""boolean"")
           .put(Field.Kind.TYPE_INT32, ""number"")
           .put(Field.Kind.TYPE_INT64, ""number"")","Currently PRIMITIVE_TYPE_MAP is used by getTypeNameForElementType, but IIUC this is only used by getTypeName, which I think uses it incorrectly, since Javascript arrays are untyped. I'm thinking neither PRIMITIVE_TYPE_MAP nor getTypeNameForElementType may be necessary.",java,1,1,1
"@@ -120,7 +120,7 @@ public class ShortcutManager {
     public void uninstallFromShortcut(ShortcutDTO shortcutDTO, Consumer<Exception> errorCallback) {
         final InteractiveScriptSession interactiveScriptSession = scriptInterpreter.createInteractiveSession();
 
-        interactiveScriptSession.eval(""include(\""engines.wine.shortcuts.reader\"");"",
+        interactiveScriptSession.eval(""const ShortcutReader = include(\""engines.wine.shortcuts.reader\"");"",
                 ignored -> interactiveScriptSession.eval(""new ShortcutReader()"", output -> {
                     final Value shortcutReader = (Value) output;
                     shortcutReader.invokeMember(""of"", shortcutDTO);","Not really related to this PR but: do we have the engine ID in the places where currently ""wine"" is hard coded?",java,0,1,1
"@@ -145,6 +145,10 @@ public class TemporaryFilesystem {
   }
 
   public boolean deleteBaseDir() {
-    return baseDir.delete();
+    boolean wasDeleted = baseDir.delete();
+    if (wasDeleted) {
+      Runtime.getRuntime().removeShutdownHook(shutdownHook);
+    }
+    return wasDeleted;
   }
 }","I don't think we need to necessarily check if that returned true or not, we should just remove the shutdown hook. Since nothing would check or do anything with this flag anyways.",java,1,1,1
"@@ -246,7 +246,11 @@ public class IcebergPigInputFormat<T> extends InputFormat<Void, T> {
     private Object convertPartitionValue(Type type, Object value) {
       if (type.typeId() == Types.BinaryType.get().typeId()) {
         ByteBuffer buffer = (ByteBuffer) value;
-        return new DataByteArray(buffer.get(new byte[buffer.remaining()]).array());
+        byte[] bytes = new byte[buffer.remaining()];
+        buffer.get(bytes);
+        // Return the input buffer back to its original position.
+        buffer.position(buffer.position() - bytes.length);
+        return new DataByteArray(bytes);
       }
 
       return value;","I updated this one as you requested @rdblue, however I wasn't sure if I should return the input `value` to its original position (vs consuming the remainder of the byte buffer and moving the position to the end).",java,0,0,1
"@@ -216,10 +216,14 @@ public class AddTextFragment extends BaseEditFragment implements TextWatcher, Fo
     public void onShow() {
         activity.changeMode(EditImageActivity.MODE_TEXT);
         activity.mainImage.setImageBitmap(activity.mainBitmap);
+        activity.addTextFragment.getmTextStickerView().mainImage = activity.mainImage;
+        activity.addTextFragment.getmTextStickerView().mainBitmap = activity.mainBitmap;
         mTextStickerView.setVisibility(View.VISIBLE);
         mInputText.clearFocus();
     }
 
+    public TextStickerView getmTextStickerView(){return mTextStickerView;}
+
     public void applyTextImage() {
         if (mSaveTask != null) {
             mSaveTask.cancel(true);",Can this be made static?,java,1,0,1
"@@ -71,6 +71,9 @@ public class DynamicLangApiMethodTransformer {
       apiMethod.pageStreamingView(
           pageStreamingTransformer.generateDescriptor(
               context.getSurfaceInterfaceContext(), method));
+    } else if (context.getMethodConfig().isLongRunningOperation()) {
+      apiMethod.longRunningView(lroTransformer.generateDetailView(context));
+      apiMethod.type(ClientMethodType.OperationOptionalArrayMethod);
     } else {
       apiMethod.type(ClientMethodType.OptionalArrayMethod);
     }","One thing I was chatting to Michael B about, and which is independent of this but may diminish confusion: At the moment, some of the client method type enum values seem to be used in the same way (AFAICT) in different languages even though they we use distinct values. It might be desirable to use the same values across languages when they have the same semantics. This would be analogous to, but independent of, using the same calling form enum value (once we create the enum type) across different languages, where applicable.",java,0,1,0
"@@ -52,5 +52,17 @@ namespace AutoRest.Swagger.Validation
         ///     The severity of this message (ie, debug/info/warning/error/fatal, etc)
         /// </summary>
         public override Category Severity => Category.Warning;
+
+        /// <summary>
+        /// What kind of open api document type this rule should be applied to
+        /// </summary>
+        public override ServiceDefinitionDocumentType ServiceDefinitionDocumentType => ServiceDefinitionDocumentType.ARM;
+
+        /// <summary>
+        /// When to apply the validation rule, before or after it has been merged as a part of 
+        /// its merged document as specified in the corresponding '.md' file
+        /// By default consider all rules to be applied for After only
+        /// </summary>
+        public override ServiceDefinitionDocumentState ValidationRuleMergeState => ServiceDefinitionDocumentState.Individual;
     }
 }",why not consider data-plane here?,java,1,0,1
"@@ -102,10 +102,6 @@ public class CertFailedRefreshNotificationTask implements NotificationTask {
         // certificateRecords := <certificate-entry>[|<certificate-entry]*
         // certificate-entry := <Service Name>;<Provider>;<InstanceID>;<Last refresh time>;<Expiration time>;<Hostname>;
 
-        if (certRecords == null || certRecords.isEmpty()) {
-            return details;
-        }
-
         StringBuilder certDetails = new StringBuilder(256);
         for (X509CertRecord certRecord : certRecords) {
             if (certDetails.length() != 0) {",Going over the tests I realized that it is not possible for certRecords to be null at this point.,java,1,1,1
"@@ -45,6 +45,7 @@ public class Constants {
   public static final int MEMORY_CHECK_RETRY_LIMIT = 720;
   public static final int DEFAULT_PORT_NUMBER = 8081;
   public static final int DEFAULT_SSL_PORT_NUMBER = 8443;
+  public static final int DEFAULT_THREAD_NUMBER = 20;
 
   public static class ConfigurationKeys {
     // These properties are configurable through azkaban.properties",Can we make the name more explicit? It seems too general to me.,java,1,1,1
"@@ -57,12 +57,13 @@ public class FastDownloaderFactory {
 
     final Path fastSyncDataDirectory = dataDirectory.resolve(FAST_SYNC_FOLDER);
     final FastSyncStateStorage fastSyncStateStorage =
-        new FastSyncStateStorage(fastSyncDataDirectory);
+        new FastSyncStateStorage(fastSyncDataDirectory, protocolSchedule);
 
     if (syncConfig.getSyncMode() != SyncMode.FAST) {
       if (fastSyncStateStorage.isFastSyncInProgress()) {
         throw new IllegalStateException(
-            ""Unable to change the sync mode when fast sync is incomplete, please restart with fast sync mode"");
+            ""Unable to change the sync mode when fast sync is incomplete, please restart with fast""
+                + "" sync mode"");
       } else {
         return Optional.empty();
       }",Is it necessary to split these strings into 120 column bits? It increases the line count in an already large PR.,java,1,1,1
"@@ -49,7 +49,12 @@ class PruneColumns extends ParquetTypeVisitor<Type> {
       Type field = fields.get(i);
       Integer fieldId = getId(originalField);
       if (fieldId != null && selectedIds.contains(fieldId)) {
-        builder.addField(originalField);
+        if (field != null) {
+          hasChange = true;
+          builder.addField(field);
+        } else {
+          builder.addField(originalField);
+        }
         fieldCount += 1;
       } else if (field != null) {
         builder.addField(field);",Should I do the empty message only thing here as well? where we copy the struct to be empty?,java,1,1,1
"@@ -97,12 +97,7 @@ public class ExecutorHealthChecker {
       final Optional<Executor> executorOption = entry.getKey();
       if (!executorOption.isPresent()) {
         final String finalizeReason = ""Executor id of this execution doesn't exist."";
-        for (final ExecutableFlow flow : entry.getValue()) {
-          logger.warn(
-              String.format(""Finalizing execution %s, %s"", flow.getExecutionId(), finalizeReason));
-          ExecutionControllerUtils
-              .finalizeFlow(this.executorLoader, this.alerterHolder, flow, finalizeReason, null);
-        }
+        finalizeFlows(entry.getValue(), finalizeReason);
         continue;
       }
 ",I feel the function renaming is long overdue: finalizeFlowsIfExecutorIsUnhealthy() will better reflect what the function does. Also - midway in this function there is a ToDo from Jamie requesting a metric for Http response times? Do you know what is that for?,java,1,1,1
"@@ -223,8 +223,9 @@ public class JDBCStream extends TupleStream implements Expressible {
     for(int columnIdx = 0; columnIdx < metadata.getColumnCount(); ++columnIdx){
       
       final int columnNumber = columnIdx + 1; // cause it starts at 1        
-      final String columnName = metadata.getColumnName(columnNumber);
+      final String columnName = metadata.getColumnLabel(columnNumber);
       String className = metadata.getColumnClassName(columnNumber);
+      String typeName = metadata.getColumnTypeName(columnNumber);
             
       if(directSupportedTypes.contains(className)){
         valueSelectors[columnIdx] = new ResultSetValueSelector() {",This makes sure to use the `AS` value instead of just the original column name.,java,1,1,1
"@@ -28,7 +28,9 @@ import org.springframework.util.StringUtils;
 public class MicroserviceConfigLoader extends YAMLConfigLoader {
   private static final Logger LOGGER = LoggerFactory.getLogger(MicroserviceConfigLoader.class);
 
-  private static final String ADDITIONAL_CONFIG_URL = ""cse.configurationSource.additionalUrls"";
+  private static final String ADDITIONAL_CONFIG_URL = ""servicecomb.configurationSource.additionalUrls"";
+
+  private static final String DEFAULT_FILE_NAME = ""servicecomb.configurationSource.defaultFileName"";
 
   /**
    * Default configuration file name to be used by default constructor. This file should","not compatible? because we only copy config items in configuration source, not in system.property?",java,1,1,1
"@@ -16,9 +16,4 @@ package com.google.api.codegen.transformer.nodejs;
 
 import com.google.api.codegen.transformer.FeatureConfig;
 
-public class NodeJSFeatureConfig extends FeatureConfig {
-  @Override
-  public boolean enableGrpcStreaming() {
-    return true;
-  }
-}
+public class NodeJSFeatureConfig extends FeatureConfig {}",We can rename `FeatureConfig` to `DefaultFeatureConfig` so the languages use default values will not need to create an empty subclass.,java,1,1,1
"@@ -37,6 +37,11 @@ static CommentConfig comment_config = {
 };
 
 namespace csharp {
+struct FieldInfo {
+  std::string name;
+  int array_length;
+};
+
 class CSharpGenerator : public BaseGenerator {
  public:
   CSharpGenerator(const Parser &parser, const std::string &path,",These names are way to generic.. call this `FieldArrayLength` or something. Stick it inside `CsharpGenerator`,java,1,1,1
"@@ -8,16 +8,13 @@ import org.apache.commons.lang3.mutable.MutableInt;
 
 import net.sourceforge.pmd.lang.java.ast.ASTAnyTypeDeclaration;
 import net.sourceforge.pmd.lang.java.ast.ASTMethodOrConstructorDeclaration;
-import net.sourceforge.pmd.lang.java.oom.AbstractMetric;
+import net.sourceforge.pmd.lang.java.ast.JavaParserVisitor;
 import net.sourceforge.pmd.lang.java.oom.Metrics;
-import net.sourceforge.pmd.lang.java.oom.api.ClassMetric;
 import net.sourceforge.pmd.lang.java.oom.api.MetricVersion;
-import net.sourceforge.pmd.lang.java.oom.api.OperationMetric;
 import net.sourceforge.pmd.lang.java.oom.api.OperationMetricKey;
 import net.sourceforge.pmd.lang.java.oom.api.ResultOption;
-import net.sourceforge.pmd.lang.java.oom.metrics.cyclo.CycloPathUnawareOperationVisitor;
-import net.sourceforge.pmd.lang.java.oom.metrics.cyclo.CycloVisitor;
-import net.sourceforge.pmd.lang.java.oom.metrics.cyclo.StandardCycloVisitor;
+import net.sourceforge.pmd.lang.java.oom.metrics.visitors.CycloPathUnawareOperationVisitor;
+import net.sourceforge.pmd.lang.java.oom.metrics.visitors.StandardCycloVisitor;
 
 /**
  * McCabe's Cyclomatic Complexity. Number of independent paths through a block of code [1, 2]. Formally, given that the","Since the version is a enum, we can compare here using `==` directly.",java,1,1,1
"@@ -6,7 +6,7 @@ package net.sourceforge.pmd.lang.java.typeresolution;
 
 import static net.sourceforge.pmd.lang.java.typeresolution.MethodTypeResolution.getApplicableMethods;
 import static net.sourceforge.pmd.lang.java.typeresolution.MethodTypeResolution.getBestMethodReturnType;
-import static net.sourceforge.pmd.lang.java.typeresolution.MethodTypeResolution.getMethodExplicitTypeArugments;
+import static net.sourceforge.pmd.lang.java.typeresolution.MethodTypeResolution.getMethodExplicitTypeArguments;
 import static net.sourceforge.pmd.lang.java.typeresolution.MethodTypeResolution.isMemberVisibleFromClass;
 import static net.sourceforge.pmd.lang.java.typeresolution.typedefinition.TypeDefinitionType.LOWER_WILDCARD;
 import static net.sourceforge.pmd.lang.java.typeresolution.typedefinition.TypeDefinitionType.UPPER_BOUND;",Please don't edit anything in this package and subpackages. Everything is deprecated and will be removed in #2689. The base branch for that pr (the grammar development branch) also edits these files to make them compilable with the new grammar. It's not worth the merge conflicts,java,0,1,1
"@@ -170,6 +170,6 @@ public class TableProperties {
   public static final String MERGE_MODE = ""write.merge.mode"";
   public static final String MERGE_MODE_DEFAULT = ""copy-on-write"";
 
-  public static final String MERGE_WRITE_CARDINALITY_CHECK = ""write.merge.cardinality-check.enabled"";
-  public static final boolean MERGE_WRITE_CARDINALITY_CHECK_DEFAULT = true;
+  public static final String MERGE_CARDINALITY_CHECK_ENABLED = ""write.merge.cardinality-check.enabled"";
+  public static final boolean MERGE_CARDINALITY_CHECK_ENABLED_DEFAULT = true;
 }",To match the property name above.,java,0,0,1
"@@ -25,6 +25,7 @@ public class BaselineErrorProneExtension {
             // Baseline checks
             ""AssertjPrimitiveComparison"",
             ""CatchBlockLogException"",
+            ""ExceptionSpecificity"",
             ""ExecutorSubmitRunnableFutureIgnored"",
             ""FinalClass"",
             ""LambdaMethodReference"",",gotta break this out into the new CatchSpecificity and ThrowSpecificity (also changelog tweak),java,1,1,1
"@@ -317,6 +317,11 @@ public class JsonGenesisConfigOptions implements GenesisConfigOptions {
     return getOptionalLong(""thanosblock"");
   }
 
+  @Override
+  public OptionalLong getMagnetoBlockNumber() {
+    return getOptionalLong(""magnetoBlock"");
+  }
+
   @Override
   public OptionalLong getEcip1049BlockNumber() {
     return getOptionalLong(""ecip1049block"");",Should be lowercase.,java,1,0,1
"@@ -162,14 +162,6 @@ public class QueueFragment extends Fragment {
                 recyclerAdapter.notifyDataSetChanged();
                 break;
             case MOVED:
-                int from = FeedItemUtil.indexOfItemWithId(queue, event.item.getId());
-                int to = event.position;
-                if(from != to) {
-                    queue.add(to, queue.remove(from));
-                    recyclerAdapter.notifyItemMoved(from, to);
-                } else {
-                    // QueueFragment itself sent the event and already moved the item
-                }
                 break;
         }
         onFragmentLoaded();","perhaps I'm daft, how do we handle this case now?",java,1,0,1
"@@ -24,7 +24,6 @@ import org.apache.http.protocol.HttpContext;
 import org.camunda.bpm.client.impl.EngineClientLogger;
 import org.camunda.bpm.client.impl.ExternalTaskClientLogger;
 import org.camunda.bpm.client.interceptor.ClientRequestInterceptor;
-
 import java.io.IOException;
 import java.util.List;
 import java.util.Map;","I think you can revert all changes of this class, so the commit for the PR is clean in the end.",java,1,1,1
"@@ -197,11 +197,16 @@ public class Nutriments implements Serializable {
     private boolean containsMinerals;
 
     public Nutriment get(String nutrimentName){
-        if (!additionalProperties.containsKey(nutrimentName)) {
+        if (nutrimentName.isEmpty() || !additionalProperties.containsKey(nutrimentName)) {
             return null;
         }
 
-        return new Nutriment(additionalProperties.get(nutrimentName).toString(), get100g(nutrimentName), getServing(nutrimentName), getUnit(nutrimentName));
+        try{
+            return new Nutriment(additionalProperties.get(nutrimentName).toString(), get100g(nutrimentName), getServing(nutrimentName), getUnit(nutrimentName));
+        }catch (NullPointerException e){
+        // In case one of the getters was unable to get data as string
+        }
+        return null;
     }
 
     public String getUnit(String nutrimentName){",You should print something to the log here for troubleshooting issues. Even `e.printStackTrace()` would be fine.,java,1,1,1
"@@ -290,7 +290,7 @@ public class IngredientsProductFragment extends BaseFragment implements IIngredi
 
         List<String> allergens = getAllergens();
 
-        if (mState != null && product.getIngredientsText() != null) {
+        if (mState != null && product.getIngredientsText() != null && !product.getIngredientsText().isEmpty()) {
             textIngredientProductCardView.setVisibility(View.VISIBLE);
             SpannableStringBuilder txtIngredients = new SpannableStringBuilder(product.getIngredientsText().replace(""_"", """"));
             txtIngredients = setSpanBoldBetweenTokens(txtIngredients, allergens);",Cant we just have `if (mState != null && !product.getIngredientsText().isEmpty())`,java,1,1,1
"@@ -322,14 +322,14 @@ public class GraphiteReporter extends ScheduledReporter {
     }
 
     private void sendIfEnabled(MetricAttribute type, String name, double value, long timestamp) throws IOException {
-        if (getDisabledMetricAttributes().contains(type)){
+        if (isMetricAttributeDisabled(type)){
             return;
         }
         graphite.send(prefix(name, type.getCode()), format(value), timestamp);
     }
 
     private void sendIfEnabled(MetricAttribute type, String name, long value, long timestamp) throws IOException {
-        if (getDisabledMetricAttributes().contains(type)){
+        if (isMetricAttributeDisabled(type)){
             return;
         }
         graphite.send(prefix(name, type.getCode()), format(value), timestamp);",Let's avoid changes in the classes not directly targeted by this pull request.,java,1,1,1
"@@ -139,14 +139,9 @@ public class ClusterStatus {
       if (collectionVsAliases.containsKey(name) && !collectionVsAliases.get(name).isEmpty()) {
         collectionStatus.put(""aliases"", collectionVsAliases.get(name));
       }
-      try {
-        String configName = zkStateReader.readConfigName(name);
-        collectionStatus.put(""configName"", configName);
-        collectionProps.add(name, collectionStatus);
-      } catch (KeeperException.NoNodeException ex) {
-        // skip this collection because the configset's znode has been deleted
-        // which can happen during aggressive collection removal, see SOLR-10720
-      }
+      String configName = message.getStr(ZkStateReader.COLLECTION_CONFIG_PROP, clusterStateCollection.getConfigName());
+      collectionStatus.put(ZkStateReader.CONFIGNAME_PROP, configName);
+      collectionProps.add(name, collectionStatus);
     }
 
     List<String> liveNodes = zkStateReader.getZkClient().getChildren(ZkStateReader.LIVE_NODES_ZKNODE, null, true);",The message didn't have this before (I assume?); does it now?,java,1,0,1
"@@ -107,6 +107,13 @@ import javax.ws.rs.WebApplicationException;
 import javax.ws.rs.core.Response;
 import static javax.ws.rs.core.Response.Status.BAD_REQUEST;
 import javax.ws.rs.core.StreamingOutput;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
+import static edu.harvard.iq.dataverse.util.json.JsonPrinter.json;
 
 /*
     Custom API exceptions [NOT YET IMPLEMENTED]",Looks like glassfish went a bit nuts doing a refactor,java,1,0,0
"@@ -23,6 +23,8 @@ import javax.annotation.Nullable;
  */
 @AutoValue
 public abstract class InitFieldConfig {
+  private static String randomValueToken = ""$RANDOM"";
+
   public abstract String fieldPath();
 
   @Nullable",Should this be final?,java,1,0,1
"@@ -51,6 +51,7 @@ public class TiConfiguration implements Serializable {
   private static final boolean DEF_WRITE_WITHOUT_LOCK_TABLE = false;
   private static final int DEF_TIKV_REGION_SPLIT_SIZE_IN_MB = 96;
   private static final boolean DEF_USE_TIFLASH = false;
+  private static final int DEF_PARTITION_PER_SPLIT = 10;
 
   private int timeout = DEF_TIMEOUT;
   private TimeUnit timeoutUnit = DEF_TIMEOUT_UNIT;",i'm curious why choose `10`?,java,1,1,1
"@@ -264,6 +264,15 @@ public class AccountSettings {
         s.put(""trashFolderSelection"", Settings.versions(
                 new V(54, new EnumSetting<>(SpecialFolderSelection.class, SpecialFolderSelection.AUTOMATIC))
         ));
+        s.put(""resize_image_enabled"", Settings.versions(
+                new V(56, new BooleanSetting(Account.DEFAULT_RESIZE_IMAGE_ENABLED))
+        ));
+        s.put(""resize_image_circumference"", Settings.versions(
+                new V(56, new StringSetting(Integer.toString(Account.DEFAULT_RESIZE_IMAGE_CIRCUMFERENCE)))
+        ));
+        s.put(""resize_image_quality"", Settings.versions(
+                new V(56, new StringSetting(Integer.toString(Account.DEFAULT_RESIZE_IMAGE_QUALITY)))
+        ));
         // note that there is no setting for openPgpProvider, because this will have to be set up together
         // with the actual provider after import anyways.
 ",All other settings are camelCased. Please don't deviate.,java,1,1,1
"@@ -1497,7 +1497,8 @@ public class MessageCompose extends K9Activity implements OnClickListener,
                 message.setUid(mMessageReference.getUid());
             }
 
-            boolean saveRemotely = recipientPresenter.isAllowSavingDraftRemotely();
+            // TODO more appropriate logic here? not sure
+            boolean saveRemotely = !recipientPresenter.getCurrentCryptoStatus().shouldUsePgpMessageBuilder();
             new SaveMessageTask(getApplicationContext(), mAccount, mContacts, mHandler,
                     message, mDraftId, saveRemotely).execute();
             if (mFinishAfterDraftSaved) {","Maybe CryptoStatus can have a 'willBeEncrypted()'? That's what you're really after, right?",java,1,1,1
"@@ -627,6 +627,7 @@ class ResultSetPersister {
         @Override
         protected IStatus run(DBRProgressMonitor monitor) {
             model.setUpdateInProgress(this);
+            UIUtils.syncExec(viewer::fireResultSetChange); // Update ""save"" and ""cancel"" buttons
             updateStats = new DBCStatistics();
             insertStats = new DBCStatistics();
             deleteStats = new DBCStatistics();","Can we fire this event outside the `DataUpdaterJob` job, so we can avoid using `syncExec` here?",java,1,1,1
"@@ -57,7 +57,7 @@ class Java16ValidatorTest {
     class Record {
 
         @Nested
-        class RecordAsIdentifierForbidden {
+        class RecordAsIdentifierSometimesForbidden {
             @Test
             void recordUsedAsClassName() {
                 String s = ""public class record {}"";",Please keep the tests within the `Java16ValidatorTest` consistent with the ones within the Java14/15 preview validator tests. I fear I misled you within the issue -- my mistake. Perhaps rename this to `RecordAsTypeIdentifierForbidden`?,java,1,1,1
"@@ -63,16 +63,13 @@ public class GleanMetricsService {
         initialized = true;
 
         final boolean telemetryEnabled = SettingsStore.getInstance(aContext).isTelemetryEnabled();
-        if (telemetryEnabled) {
-            GleanMetricsService.start();
-        } else {
-            GleanMetricsService.stop();
-        }
         Configuration config = new Configuration(
                 ConceptFetchHttpUploader.fromClient(client),
                 Configuration.DEFAULT_TELEMETRY_ENDPOINT,
                 BuildConfig.BUILD_TYPE);
-        Glean.INSTANCE.initialize(aContext, true, config);
+
+        Glean.INSTANCE.initialize(aContext, telemetryEnabled, config);
+        setStartupMetrics();
     }
 
     // It would be called when users turn on/off the setting of telemetry.","You should retain this as well: if user toggle telemetry of and then on again, the metrics will be cleared and you'll need to set them again.",java,1,1,1
"@@ -138,8 +138,8 @@ public class ManifestFiles {
     return open(manifest, io, null);
   }
 
-  static ManifestReader<?> open(ManifestFile manifest, FileIO io,
-                                Map<Integer, PartitionSpec> specsById) {
+  public static ManifestReader<?> open(
+      ManifestFile manifest, FileIO io, Map<Integer, PartitionSpec> specsById) {
     switch (manifest.content()) {
       case DATA:
         return ManifestFiles.read(manifest, io, specsById);",nit: this can actually fit on one line,java,1,1,1
"@@ -64,7 +64,7 @@ abstract class MergingSnapshotProducer<ThisT> extends SnapshotProducer<ThisT> {
   private static final Set<String> VALIDATE_DATA_FILES_EXIST_SKIP_DELETE_OPERATIONS =
       ImmutableSet.of(DataOperations.OVERWRITE, DataOperations.REPLACE);
   // delete files can be added in ""overwrite"" or ""delete"" operations
-  private static final Set<String> VALIDATE_REPLACED_DATA_FILES_OPERATIONS =
+  private static final Set<String> VALIDATE_ADDED_DELETE_FILES_OPERATIONS =
       ImmutableSet.of(DataOperations.OVERWRITE, DataOperations.DELETE);
 
   private final String tableName;",I renamed it to match `VALIDATE_ADDED_FILES_OPERATIONS `.,java,1,0,1
"@@ -420,14 +420,15 @@ public final class TreeMap<K, V> implements SortedMap<K, V>, Serializable {
         return createTreeMap(entries.comparator(), iterator().dropWhile(predicate));
     }
 
+    @SuppressWarnings(""unchecked"")
     @Override
-    public boolean containsKey(K key) {
+    public boolean containsKey(Object key) {
         final V ignored = null;
-        return entries.contains(new Tuple2<>(key, ignored));
+        return entries.contains(new Tuple2<>((K) key, ignored));
     }
 
     @Override
-    public boolean containsValue(V value) {
+    public boolean containsValue(Object value) {
         return iterator().map(Tuple2::_2).contains(value);
     }
 ",cast `(K) key` is unsafe,java,1,0,1
"@@ -185,11 +185,11 @@ public class SyncManager {
 	 * @param sync
 	 */
 	public void runSync(final SyncState sync) {
+		updateSync(sync, SyncState.Status.RUNNING, 0, -1 /* don't change */);
 		threadPool.execute(new Runnable() {
 			@Override
 			public void run() {
 				try {
-					updateSync(sync, SyncState.Status.RUNNING, 0, -1 /* don't change */);
 					switch(sync.getType()) {
 					case syncDown: syncDown(sync); break;
 					case syncUp:   syncUp(sync); break;","The first running update is done on the main thread - otherwise, you would see a status of NEW after starting a sync.",java,1,1,1
"@@ -43,6 +43,7 @@ import java.util.concurrent.ThreadFactory;
  */
 public class DBWriter {
     private static final String TAG = ""DBWriter"";
+    private static final String PREF_QUEUE_ADD_TO_FRONT = ""prefQueueAddToFront"";
 
     private static final ExecutorService dbExec;
 ",Wouldn't this be better off in PreferenceController.java?,java,1,1,1
"@@ -231,7 +231,9 @@ abstract class SnapshotProducer<ThisT> implements SnapshotUpdate<ThisT> {
             Snapshot newSnapshot = apply();
             newSnapshotId.set(newSnapshot.snapshotId());
             TableMetadata updated = base.replaceCurrentSnapshot(newSnapshot);
-            taskOps.commit(base, updated);
+            // if the table UUID is missing, add it here. the UUID will be re-created each time this operation retries
+            // to ensure that if a concurrent operation assigns the UUID, this operation will not fail.
+            taskOps.commit(base, updated.withUUID());
           });
 
     } catch (RuntimeException e) {","Just to make sure I understand: table UUID isn't supposed to change once assigned and cannot be set back to null, right?",java,1,1,1
"@@ -67,6 +67,10 @@ public class TextBody implements Body {
         }
     }
 
+    public String getEncoding() {
+        return encoding;
+    }
+
     public void setEncoding(String encoding) {
         mEncoding = encoding;
     }",Does this code compile? Isn't the member variable `mEncoding`?,java,1,1,1
"@@ -33,6 +33,18 @@ public class TransactionPoolOptions
   private static final String ETH65_TX_ANNOUNCED_BUFFERING_PERIOD_FLAG =
       ""--Xeth65-tx-announced-buffering-period-milliseconds"";
 
+  private static final String STRICT_TX_REPLAY_PROTECTION_ENABLED_FLAG =
+      ""--strict-tx-replay-protection-enabled"";
+
+  @CommandLine.Option(
+      names = {STRICT_TX_REPLAY_PROTECTION_ENABLED_FLAG},
+      paramLabel = ""<Boolean>"",
+      description =
+          ""Require transactions submitted via JSON-RPC to use replay protection in accordance with EIP-155 (default: ${DEFAULT-VALUE})"",
+      fallbackValue = ""true"",
+      arity = ""0..1"")
+  private Boolean strictTxReplayProtectionEnabled = false;
+
   @CommandLine.Option(
       names = {TX_MESSAGE_KEEP_ALIVE_SEC_FLAG},
       paramLabel = ""<INTEGER>"",","Ah, so it IS unstable already. Cool, lets prefix with X.",java,1,0,0
"@@ -1367,6 +1367,19 @@ public class JsonRpcHttpServiceTest extends JsonRpcHttpServiceTestBase {
     }
   }
 
+  @Test
+  public void emptyJson_shouldHandleNPE() throws Exception {
+    final RequestBody body = RequestBody.create(JSON, """");
+
+    try (final Response resp = client.newCall(buildPostRequest(body)).execute()) {
+      assertThat(resp.code()).isEqualTo(400);
+      final JsonObject json = new JsonObject(resp.body().string());
+      final JsonRpcError expectedError = JsonRpcError.PARSE_ERROR;
+      testHelper.assertValidJsonRpcError(
+          json, null, expectedError.getCode(), expectedError.getMessage());
+    }
+  }
+
   @Test
   public void requestWithWrongVersionShouldSucceed() throws Exception {
     final String id = ""234"";",Is the original issue caused by an empty body? Does having no content-length in the request headers mean request body is empty?,java,1,1,1
"@@ -32,6 +32,12 @@ import azkaban.utils.JSONUtils;
 import azkaban.utils.Pair;
 import azkaban.utils.Props;
 import com.google.common.collect.Lists;
+import org.apache.commons.lang.StringUtils;
+import org.apache.log4j.Logger;
+import org.joda.time.DateTime;
+
+import javax.inject.Inject;
+import javax.inject.Singleton;
 import java.io.File;
 import java.io.IOException;
 import java.lang.Thread.State;",Is it possible to gradually move away from joda time to java8's time apis?,java,1,1,1
"@@ -72,6 +72,7 @@ public class TestMineBlocks implements JsonRpcMethod {
             Functions.identity(),
             context.getEthHashSolver(),
             Wei.ZERO,
+            0.0,
             blockchain.getChainHeadHeader());
     final Block block = blockCreator.createBlock(retesethClock.instant().getEpochSecond());
 ",Is the ratio at 0 normal in this case?,java,1,1,1
"@@ -837,7 +837,18 @@ class WebDriver(object):
             del png
         return True
 
-    save_screenshot = get_screenshot_as_file
+    def save_screenshot(self, filename):
+        """"""
+        Gets the screenshot of the current window. Returns False if there is
+           any IOError, else returns True. Use full paths in your filename.
+
+        :Args:
+         - filename: The full path you wish to save your screenshot to.
+
+        :Usage:
+            driver.save_screenshot('/Screenshots/foo.png')
+        """"""
+        return self.get_screenshot_as_file(self, filename)
 
     def get_screenshot_as_png(self):
         """"""",This needs to be just return self.get_screenshot_as_file(filename),java,1,1,1
"@@ -203,7 +203,7 @@ public class PasscodeActivity extends Activity implements OnEditorActionListener
     public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
         Log.i(""onEditorAction"", ""view="" + v + "" actionId="" + actionId + "" event="" + event);
         // Processing the editor action only on key up to avoid sending events like pass code manager unlock twice.
-        if (event != null && event.getAction() == KeyEvent.ACTION_UP) {
+        if ((event != null && event.getAction() == KeyEvent.ACTION_UP) || event == null) {
             String pc = entry.getText().toString();
             if (pc.length() > 0 && pc.length() < getMinPasscodeLength()) {
                 error.setText(getMinLengthInstructions(getMinPasscodeLength()));","`event` should never be `null` here, and if it is, it should fall in the `else` block like it does now.",java,1,1,1
"@@ -86,12 +86,11 @@ public class CloudConfigSetService extends ConfigSetService {
 
     // The configSet is read from ZK and populated.  Ignore CD's pre-existing configSet; only populated in standalone
     final String configSetName;
-    try {
-      configSetName = zkController.getZkStateReader().readConfigName(colName);
-      cd.setConfigSet(configSetName);
-    } catch (KeeperException ex) {
-      throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR, ""Trouble resolving configSet for collection "" + colName + "": "" + ex.getMessage());
+    configSetName = zkController.getZkStateReader().getClusterState().getCollection(colName).getConfigName();
+    if (configSetName == null) {
+      throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, ""configName is missing"");
     }
+    cd.setConfigSet(configSetName);
 
     return new ZkSolrResourceLoader(cd.getInstanceDir(), configSetName, parentLoader.getClassLoader(), zkController);
   }","I think we can have getConfigName never return null? That would be ideal, any way.",java,1,1,1
"@@ -37,6 +37,12 @@ module Selenium
         def bridge_class
           Bridge
         end
+
+        def print_page(**options)
+          options[:page_ranges] &&= Array(options[:page_ranges])
+
+          bridge.print_page(options)
+        end
       end # Driver
     end # Firefox
   end # WebDriver",Same here. and all others.,java,0,0,1
"@@ -318,7 +318,7 @@ abstract class BaseTableScan implements TableScan {
     return schema;
   }
 
-  private static String formatTimestampMillis(long millis) {
+  protected static String formatTimestampMillis(long millis) {
     return DATE_FORMAT.format(LocalDateTime.ofInstant(Instant.ofEpochMilli(millis), ZoneId.systemDefault()));
   }
 }",This isn't used. Could you revert this change?,java,1,1,1
"@@ -117,6 +117,9 @@ public abstract class Folder<T extends Message> {
     public void expunge() throws MessagingException
         {}
 
+    public void expungeMessages(List<? extends Message> messages) throws MessagingException {
+    }
+
     /**
      * Populate a list of messages based upon a FetchProfile.  See {@link FetchProfile} for the things that can
      * be fetched.","probably added by accident? \\ edit oh, it's a superclass. derp, nvm.",java,1,0,1
"@@ -486,10 +486,10 @@ public class BlockchainQueries {
    */
   public List<LogWithMetadata> matchingLogs(
       final long fromBlockNumber, final long toBlockNumber, final LogsQuery query) {
-    return LongStream.rangeClosed(fromBlockNumber, toBlockNumber)
-        .mapToObj(blockchain::getBlockHashByNumber)
-        .takeWhile(Optional::isPresent)
-        .flatMap(Optional::stream)
+    return LongStream.rangeClosed(fromBlockNumber, Math.min(toBlockNumber, headBlockNumber()))
+        .mapToObj(blockchain::getBlockHeader)
+        .filter(header -> header.isPresent() && query.couldMatch(header.get().getLogsBloom()))
+        .map(header -> header.get().getHash())
         .flatMap(hash -> matchingLogs(hash, query).stream())
         .collect(Collectors.toList());
   }","Interesting interaction here, if we use a `takeWhile` instead of the `Math.min`, we can actually return more logs in the case where a new block was added while the processing of the rpc call is happening because Java Streams are pull based. I lean towards the `takeWhile` approach because if the user asks for a block that's slightly too high, this could make the difference between them seeing most of what they wanted and everything they wanted (in the case where a block is stored in time for the end of the stream to be reached).",java,1,1,0
"@@ -1990,6 +1990,19 @@ class CSharpGenerator : public BaseGenerator {
           ""Newtonsoft.Json.Formatting.Indented);\n"";
       code += ""  }\n"";
     }
+    if (parser_.root_struct_def_ == &struct_def) {
+      code += ""  public static "" + class_name +
+              "" DeserializeFromFlatBuffers(byte[] fbBuffer) {\n"";
+      code += ""    return "" + struct_def.name + "".GetRootAs"" + struct_def.name +
+              ""(new ByteBuffer(fbBuffer)).UnPack();\n"";
+      code += ""  }\n"";
+      code += ""  public byte[] SerializeToFlatBuffers() {\n"";
+      code += ""    var fbb = new FlatBufferBuilder(1);\n"";
+      code +=
+          ""    fbb.Finish("" + struct_def.name + "".Pack(fbb, this).Value);\n"";
+      code += ""    return fbb.DataBuffer.ToSizedArray();\n"";
+      code += ""  }\n"";
+    }
     code += ""}\n\n"";
   }
 ","1 byte is a really bad default size, it is going to spend a lot of time re-allocating buffers this way. Probably anywhere from 4 to 64 K would be entirely reasonable given that this is very temporary.",java,1,1,1
"@@ -146,6 +146,7 @@ public class AzkabanWebServer extends AzkabanServer implements IMBeanRegistrable
   private final FlowTriggerScheduler scheduler;
   private final FlowTriggerService flowTriggerService;
   private Map<String, TriggerPlugin> triggerPlugins;
+  private final ExecutionLogsCleaner executionLogsCleaner;
 
   @Inject
   public AzkabanWebServer(final Props props,",Does it matter that we are changing the Ctor signature?,java,1,1,1
"@@ -57,7 +57,7 @@ final class ElasticsearchAutocompleteTags implements AutocompleteTags {
     if (indices.isEmpty()) return Call.emptyList();
 
     SearchRequest.Filters filters =
-      new SearchRequest.Filters().addTerm(""tagKey"", key.toLowerCase(Locale.ROOT));
+      new SearchRequest.Filters().addTerm(""tagKey"", key);
 
     SearchRequest request = SearchRequest.create(indices)
       .filters(filters)","Why do we no longer want to normalize (lowercase) the input? Does the change to `keyword` make it a case insensitive search? Or if we want to be case sensitive, we should probably have a test for that.",java,1,1,1
"@@ -122,6 +122,9 @@ public class MockExecutorLoader implements ExecutorLoader {
   @Override
   public void updateExecutableNode(ExecutableNode node)
       throws ExecutorManagerException {
+    if (!nodes.containsKey(node.getId())) {
+      uploadExecutableNode(node, new Props());
+    }
     ExecutableNode foundNode = nodes.get(node.getId());
     foundNode.setEndTime(node.getEndTime());
     foundNode.setStartTime(node.getStartTime());","After updating latest changes from `master`, the test was failing here because the node wasn't found in the map. That could be just concurrency issue, because here `nodes` is just a regular `HashMap` without thread safety.. Or then there's an actual change in behaviour that makes an update before initial upload. I wonder if that would be a problem when running against the actual DB layer..",java,1,1,1
"@@ -76,5 +76,9 @@ public class QueryRequest extends SolrRequest<QueryResponse> {
     return query;
   }
 
+  @Override
+  public String getRequestType() {
+    return SolrRequestType.QUERY.toString();
+  }
 }
 ","Something about this that I think bothers me is that we don't make a differentiation between distinct handlers, so we can't use this to build QoS levels. Like I can't say that RTG should always go through while `/select` might be acceptable to throttle and `/spellcheck` is even lower priority.",java,1,1,1
"@@ -0,0 +1,10 @@
+package com.github.javaparser.ast.nodeTypes;
+
+import com.github.javaparser.ast.Node;
+import com.github.javaparser.ast.expr.Expression;
+
+public interface NodeWithExpression<N extends Node> {
+    Expression getExpression();
+
+    N setExpression(Expression expression);
+}",What are those nodes with Expressions? Are Expressions wrapping other expressions? Any sort of node containing one single expression?,java,1,1,1
"@@ -172,6 +172,16 @@ public class MessageList extends K9Activity implements MessageListFragmentListen
         context.startActivity(intent);
     }
 
+    public static void launch(Context context, Account account) {
+        launch(context);
+
+        long folderId = DI.get(DefaultFolderProvider.class).getDefaultFolder(account);
+
+        LocalSearch search = new LocalSearch();
+        search.addAllowedFolder(folderId);
+        search.addAccountUuid(account.getUuid());
+        actionDisplaySearch(context, search, false, false);
+    }
 
     private enum DisplayMode {
         MESSAGE_LIST,",This line should probably be removed. Otherwise `startActivity()` will be called twice.,java,1,1,1
"@@ -234,6 +234,8 @@ class ModifyingSuggester {
   }
 
   private void tryRemovingChar(String word) {
+    if (word.length() == 1) return;
+
     for (int i = 0; i < word.length(); i++) {
       trySuggestion(word.substring(0, i) + word.substring(i + 1));
     }",We don't accept empty words for lookup anymore,java,1,1,1
"@@ -210,7 +210,6 @@ public final class BaselineErrorProne implements Plugin<Project> {
             // Errorprone 2.3.4 isn't officially compatible with Java13 either
             // https://github.com/google/error-prone/issues/1106
             errorProneOptions.check(""TypeParameterUnusedInFormals"", CheckSeverity.OFF);
-            errorProneOptions.check(""PreferCollectionConstructors"", CheckSeverity.OFF);
         }
 
         if (javaCompile.equals(compileRefaster)) {",calling out that I re-enabled this because it uses the safe qualify method now.,java,1,1,1
"@@ -19,7 +19,10 @@ package org.openqa.selenium.grid.graphql;
 
 import graphql.schema.DataFetcher;
 import graphql.schema.DataFetchingEnvironment;
+
+import org.openqa.selenium.SessionNotCreatedException;
 import org.openqa.selenium.grid.distributor.Distributor;
+import org.openqa.selenium.grid.sessionmap.SessionMap;
 import org.openqa.selenium.internal.Require;
 
 import java.net.URI;",You can safely revert changes to this file.,java,1,0,1
"@@ -64,7 +64,8 @@ public class RlpBlockImporter {
    * @throws IOException On Failure
    */
   public <C> RlpBlockImporter.ImportResult importBlockchain(
-      final Path blocks, final BesuController<C> besuController) throws IOException {
+      final Path blocks, final BesuController<C> besuController, final boolean skipPowValidation)
+      throws IOException {
     final ProtocolSchedule<C> protocolSchedule = besuController.getProtocolSchedule();
     final ProtocolContext<C> context = besuController.getProtocolContext();
     final MutableBlockchain blockchain = context.getBlockchain();",Do you think it's worth it to just have this take a `HeaderValidationMode` instead of the boolean? Same number of args but with a lot more flexibility.,java,1,1,1
"@@ -18,9 +18,9 @@ import net.sourceforge.pmd.lang.java.ast.ASTMemberValuePair;
 import net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration;
 import net.sourceforge.pmd.lang.java.ast.ASTName;
 import net.sourceforge.pmd.lang.java.ast.ASTResultType;
-import net.sourceforge.pmd.lang.java.rule.AbstractLombokAwareRule;
+import net.sourceforge.pmd.lang.java.rule.AbstractJavaRule;
 
-public class UseUtilityClassRule extends AbstractLombokAwareRule {
+public class UseUtilityClassRule extends AbstractJavaRule {
 
     @Override
     public Object visit(ASTClassOrInterfaceBody decl, Object data) {",shouldn't we just extend `AbstractIgnoredAnnotationRule` and default it to `lombok.NoArgsConstructor`?,java,1,1,1
"@@ -251,12 +251,12 @@ public class HiveCatalog extends BaseMetastoreCatalog implements SupportsNamespa
             namespace);
 
     } catch (TException e) {
-      throw new RuntimeException(""Failed to create namespace "" + namespace + "" in Hive MataStore"", e);
+      throw new RuntimeException(""Failed to create namespace "" + namespace + "" in Hive MetaStore"", e);
 
     } catch (InterruptedException e) {
       Thread.currentThread().interrupt();
       throw new RuntimeException(
-          ""Interrupted in call to createDatabase(name) "" + namespace + "" in Hive MataStore"", e);
+          ""Interrupted in call to createDatabase(name) "" + namespace + "" in Hive MetaStore"", e);
     }
   }
 ","Out of curiosity, how do Hive folks prefer to write it? `MetaStore` or `Metastore`?",java,0,0,1
"@@ -121,7 +121,7 @@ public abstract class LoginAbstractAzkabanServlet extends AbstractAzkabanServlet
 
       handleGet(req, resp, session);
     } else {
-      if (hasParam(req, ""ajax"")) {
+      if (isAjaxCall(req)) {
         final HashMap<String, String> retVal = new HashMap<>();
         retVal.put(""error"", ""session"");
         this.writeJSON(resp, retVal);","I agree that it's better this way, but this is a breaking change on our api: anyone using our apis outside the website without specifying the header 'X-Requested-With' (not enforced) in POST requests will start getting json instead of html as a response when session expires which can happen often. Api versioning is the way to conduct these type of changes but unfortunately we haven't planned for that yet. I don't know what the impact of this change is but I prefer not to risk it.",java,1,1,0
"@@ -77,7 +77,7 @@ public class SignatureDeclareThrowsExceptionRule extends AbstractJavaRule {
             }
         }
         if (node.jjtGetNumChildren() != 0 && node.jjtGetChild(0) instanceof ASTExtendsList) {
-            ASTClassOrInterfaceType type = (ASTClassOrInterfaceType) node.jjtGetChild(0).jjtGetChild(0);
+            ASTClassOrInterfaceType type = node.jjtGetChild(0).getFirstChildOfType(ASTClassOrInterfaceType.class);
             if (isJUnitTest(type)) {
                 junitImported = true;
                 return super.visit(node, data);",This block and the one checking the interfaces (above) could be simplified using the methods `getSuperInterfacesTypeNodes` and `getSuperClassTypeNode` of `ASTClassOrInterfaceDeclaration`,java,1,1,1
"@@ -40,6 +40,10 @@ public abstract class DateTimeUtils {
     }
   }
 
+  public static String withTimezone(Date date) {
+      return DATE_FORMAT_WITH_TIMEZONE.format(date);
+  }
+
   public static Date updateTime(Date now, Date newTime) {
     Calendar c = Calendar.getInstance();
     c.setTime(now);","I would also call this method in the `return` statement of the `withTimezone(String dateString)` method above (line 37), so we don't have duplicate methods.",java,1,1,1
"@@ -17,7 +17,9 @@
 
 package org.apache.servicecomb.common.rest.codec.param;
 
+import java.io.UnsupportedEncodingException;
 import java.lang.reflect.Type;
+import java.net.URLDecoder;
 import java.util.Map;
 
 import javax.servlet.http.HttpServletRequest;",remove unused import,java,1,1,1
"@@ -49,8 +49,10 @@ public class IndexKey extends Key {
     for (int i = 0; i < indexColumns.size(); i++) {
       TiIndexColumn col = indexColumns.get(i);
       DataType colTp = tableInfo.getColumn(col.getOffset()).getType();
+      // using convertToTiDBType implicitly since the get method does not convert
+      Object convertedValue = colTp.convertToTiDBType(row.get(col.getOffset(), colTp));
       // truncate index's if necessary
-      Key key = TypedKey.toTypedKey(row.get(col.getOffset(), colTp), colTp, (int) col.getLength());
+      Key key = TypedKey.toTypedKey(convertedValue, colTp, (int) col.getLength());
       keys[i] = key;
     }
     return keys;","I feel like conversion should be done at the upper level. At this stage, row is already converted. Please correct me if my understanding is not quite right.",java,1,1,1
"@@ -3773,11 +3773,7 @@ public class MessagingController {
             return false;
         }
 
-        if (account.isNotifyContactsMailOnly() && !contacts.isAnyInContacts(message.getFrom())) {
-            return false;
-        }
-
-        return true;
+        return !account.isNotifyContactsMailOnly() || contacts.isAnyInContacts(message.getFrom());
     }
 
     public void deleteAccount(Account account) {",I find the old way makes this easier to read.,java,1,1,1
"@@ -1,4 +1,4 @@
-/* Copyright 2018 Google LLC
+/* Copyright 2016 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the ""License"");
  * you may not use this file except in compliance with the License.",Why is the year changing here?,java,1,1,1
"@@ -128,11 +128,13 @@ class GenericReaders {
     }
 
     @Override
+    @SuppressWarnings(""checkstyle:hiddenField"")
     protected Object get(Record struct, int pos) {
       return struct.get(pos);
     }
 
     @Override
+    @SuppressWarnings(""checkstyle:hiddenField"")
     protected void set(Record struct, int pos, Object value) {
       struct.set(pos, value);
     }","I know this rule is a bit controversial but I think it is better to follow it everywhere or ignore it globally. In this particular case, it seems appropriate to follow and, maybe, give another name to the field. It is not really clear the difference between the field and passed object.",java,1,1,1
"@@ -31,6 +31,11 @@ public class NodeSmartContractPermissioningConditions {
     return new WaitForTrueResponse(transactions.isNodeAllowed(address, node));
   }
 
+  public Condition enodeURLIsAllowed(
+      final String address, final String enodeURL, final Node executorNode) {
+    return new WaitForTrueResponse(transactions.isEnodeURLAllowed(address, enodeURL, executorNode));
+  }
+
   public Condition nodeIsForbidden(final String address, final Node node) {
     return new WaitForFalseResponse(transactions.isNodeAllowed(address, node));
   }",s/URL/Url for consistency,java,1,1,1
"@@ -102,11 +102,10 @@ public class SecurityActivity extends ThemedActivity {
                         swActiveSecurity.setChecked(true);
                         SP.putBoolean(getString(R.string.preference_use_password), true);
                         toggleEnabledChild(true);
-                    }
-                    else
-                    setPasswordDialog();
-                }
-                else {
+                        Snackbar.make(findViewById(android.R.id.content), ""Password Set"", Snackbar.LENGTH_SHORT)
+                                .show();
+                    } else setPasswordDialog();
+                } else {
                     editor.putBoolean(getString(R.string.preference_use_password), false);
                     editor.commit();
                     toggleEnabledChild(false);","Cant you use SanckBar Handler here as it is used throughout the code. Also put ""password set"" string into strings.xml instead of hardcoding",java,1,1,1
"@@ -40,6 +40,12 @@ public abstract class MethodDescriptorView {
 
   public abstract List<HeaderRequestParamView> headerRequestParams();
 
+  @Nullable
+  public abstract String requestFormatterName();
+
+  @Nullable
+  public abstract String responseFormatterName();
+
   public boolean hasHeaderRequestParams() {
     return headerRequestParams() != null && !headerRequestParams().isEmpty();
   }","These names aren't needed any more, right?",java,1,0,1
"@@ -74,6 +74,8 @@ public class Dictionary {
 
   static final char[] NOFLAGS = new char[0];
 
+  private static final char HIDDEN_FLAG = (char) 65511; // called 'ONLYUPCASEFLAG' in Hunspell
+
   private static final String ALIAS_KEY = ""AF"";
   private static final String MORPH_ALIAS_KEY = ""AM"";
   private static final String PREFIX_KEY = ""PFX"";",I think you could use an explicit char here? '\uFFE7'? Not sure though because this isn't valid unicode so some validation tools may complain later on... Let's leave it.,java,1,1,1
"@@ -62,11 +62,6 @@ public class BinPacking {
     private final Function<T, Long> weightFunc;
     private final boolean largestBinFirst;
 
-    public PackingIterable(Iterable<T> iterable, long targetWeight, int lookback,
-                           Function<T, Long> weightFunc) {
-      this(iterable, targetWeight, lookback, weightFunc, false);
-    }
-
     public PackingIterable(Iterable<T> iterable, long targetWeight, int lookback,
                            Function<T, Long> weightFunc, boolean largestBinFirst) {
       Preconditions.checkArgument(lookback > 0,","Please revert this change. Even if this isn't used, the class is public and we don't need to make unnecessary breaking changes.",java,1,1,1
"@@ -161,8 +161,8 @@ public class ModelTypeTable implements ModelTypeFormatter {
    * If the given type is not implicitly imported, the add it to the import set, then return the
    * zero value for that type.
    */
-  public String getZeroValueAndSaveNicknameFor(TypeRef type) {
-    return typeNameConverter.getZeroValue(type).getValueAndSaveTypeNicknameIn(typeTable);
+  public String getZeroValueAndSaveNicknameFor(TypeRef type, ZeroValuePurpose purpose) {
+    return typeNameConverter.getZeroValue(type, purpose).getValueAndSaveTypeNicknameIn(typeTable);
   }
 
   /** Returns the imports accumulated so far. */",I think I would prefer to introduce a new function instead of an enum for supporting the distinction you want. Something like `getParamZeroValue`. For my understanding: why is this distinction necessary?,java,1,1,1
"@@ -113,7 +113,7 @@ public abstract class SyncTargetManager {
   protected abstract CompletableFuture<Optional<EthPeer>> selectBestAvailableSyncTarget();
 
   private CompletableFuture<SyncTarget> waitForPeerAndThenSetSyncTarget() {
-    return waitForNewPeer().handle((r, t) -> r).thenCompose((r) -> selectNewSyncTarget());
+    return waitForNewPeer().thenCompose(__ -> selectNewSyncTarget());
   }
 
   private CompletableFuture<?> waitForNewPeer() {",So this is the main change? the rest are all style adjustments?,java,1,1,1
"@@ -159,4 +159,17 @@ public interface ClaimAccessor {
 		}
 		return convertedValue;
 	}
+
+	/**
+	 * Returns the claim value as a {@code T} type.
+	 * It assumes that the given claim has already been converted to type {@code T}.
+	 *
+	 * @param claim the name of the claim
+	 * @param <T> the type of the claim
+	 * @return the claim value
+	 */
+	@SuppressWarnings(""unchecked"")
+	default <T> T getClaim(String claim) {
+		return (T) this.getClaims().get(claim);
+	}
 }",Please move this method just below `getClaims()`,java,1,1,1
"@@ -56,10 +56,10 @@ public class Emailer extends AbstractMailer implements Alerter {
     this.mailSender = props.getString(""mail.sender"", """");
     this.tls = props.getString(""mail.tls"", ""false"");
 
-    final int mailTimeout = props.getInt(""mail.timeout.millis"", 10000);
+    final int mailTimeout = props.getInt(""mail.timeout.millis"", 30000);
     EmailMessage.setTimeout(mailTimeout);
     final int connectionTimeout =
-        props.getInt(""mail.connection.timeout.millis"", 10000);
+        props.getInt(""mail.connection.timeout.millis"", 30000);
     EmailMessage.setConnectionTimeout(connectionTimeout);
 
     EmailMessage.setTotalAttachmentMaxSize(getAttachmentMaxSize());",Does this number matter much? I remember the exception message like `can not connect..`,java,1,1,1
"@@ -36,7 +36,7 @@ public class AzDBTestUtility {
 
     public EmbeddedH2BasicDataSource() {
       super();
-      final String url = ""jdbc:h2:mem:test"";
+      final String url = ""jdbc:h2:mem:test;IGNORECASE=TRUE"";
       setDriverClassName(""org.h2.Driver"");
       setUrl(url);
     }",Does H2 DB not use the DB schema definition files?,java,1,1,1
"@@ -2382,6 +2382,11 @@ CheckedError Parser::DoParse(const char *source, const char **include_paths,
     } else if (IsIdent(""include"") || (opts.proto_mode && IsIdent(""import""))) {
       NEXT();
       if (opts.proto_mode && attribute_ == ""public"") NEXT();
+#ifdef FLATBUFFERS_PLATFORM_NO_FILE_SUPPORT
+      auto name = attribute_;
+      // Early return if platform has no file support
+      return Error(""unable to load include file: "" + name);
+#endif  // FLATBUFFERS_PLATFORM_NO_FILE_SUPPORT
       auto name = flatbuffers::PosixPath(attribute_.c_str());
       EXPECT(kTokenStringConstant);
       // Look for the file in include_paths.",why is this named differently from the define above?,java,1,1,1
"@@ -709,7 +709,7 @@ public final class BlockTreeTermsWriter extends FieldsConsumer {
 
           PendingTerm term = (PendingTerm) ent;
 
-          assert StringHelper.startsWith(term.termBytes, prefix): ""term.term="" + term.termBytes + "" prefix="" + prefix;
+          assert StringHelper.startsWith(term.termBytes, prefix): term + "" prefix="" + prefix;
           BlockTermState state = term.state;
           final int suffix = term.termBytes.length - prefixLength;
           //if (DEBUG2) {",that 'term' class (PendingTerm) actually has a perfectly fine toString method... why not just remove termBytes and let it do its job?,java,1,1,1
"@@ -54,6 +54,8 @@ public class JobTypeManager {
   private final Props globalProperties;
   private final ClusterRouter clusterRouter;
   private JobTypePluginSet pluginSet;
+  // Only used to load keyStore.
+  private Props keyStoreLoadProps = null;
 
   @VisibleForTesting
   public JobTypeManager(final String jobtypePluginDir, final Props globalProperties,",No need to assign null.,java,1,1,1
"@@ -72,10 +72,15 @@ public class SnapshotUtil {
    */
   public static Snapshot oldestSnapshot(Table table) {
     Snapshot current = table.currentSnapshot();
+    Snapshot parent;
     while (current != null && current.parentId() != null) {
-      current = table.snapshot(current.parentId());
+      parent = table.snapshot(current.parentId());
+      if (parent != null) {
+        current = parent;
+      } else {
+        return current;
+      }
     }
-
     return current;
   }
 ",Please remove non-functional changes like this that will cause commit conflicts.,java,1,1,1
"@@ -60,6 +60,19 @@ public class TestStaticTable extends HadoopTableTestBase {
         () -> staticTable.newDelete().deleteFile(FILE_A).commit());
   }
 
+  @Test
+  public void testCannotDoIncrementalScanOnMetadataTable() {
+    table.newAppend().appendFile(FILE_A).commit();
+
+    for (MetadataTableType type : MetadataTableType.values()) {
+      Table staticTable = getStaticTable(type);
+      AssertHelpers.assertThrows(""Static tables do not currently support incremental scans"",
+          UnsupportedOperationException.class,
+          String.format(""Incremental scan is not supported for %s scan of table %s"", type, table.name()),
+          () -> staticTable.newScan().appendsAfter(1));
+    }
+  }
+
   @Test
   public void testHasSameProperties() {
     table.newAppend().appendFile(FILE_A).commit();","I think that a better place for this test is now `TestMetadataTableScans` since it supports all metadata tables. Also, the context message still says ""Static tables . . .""",java,1,1,1
"@@ -148,6 +148,16 @@ public class ParquetDictionaryRowGroupFilter {
       return ROWS_MIGHT_MATCH;
     }
 
+    @Override
+    public <T> Boolean isNaN(BoundReference<T> ref) {
+      return ROWS_MIGHT_MATCH;
+    }
+
+    @Override
+    public <T> Boolean notNaN(BoundReference<T> ref) {
+      return ROWS_MIGHT_MATCH;
+    }
+
     @Override
     public <T> Boolean lt(BoundReference<T> ref, Literal<T> lit) {
       int id = ref.fieldId();","If there is a NaN value, then it would be in the Parquet dictionary. I think that we can implement this for Parquet.",java,1,1,1
"@@ -124,7 +124,7 @@ public class DataSourceUtils {
 		private MySQLBasicDataSource(String host, int port, String dbName, String user, String password, int numConnections) {
 			super();
 			
-			String url = ""jdbc:mysql://"" + (host + "":"" + port + ""/"" + dbName);
+			String url = ""jdbc:mysql://"" + (host + "":"" + port + ""/"" + dbName+""?useUnicode=yes&characterEncoding=UTF-8"");
 			setDriverClassName(""com.mysql.jdbc.Driver"");
 			setUsername(user);
 			setPassword(password);","Please add a space before and after the +, to be consistent with the rest of the file.",java,1,1,1
"@@ -32,7 +32,6 @@ namespace AutoRest.Extensions.Azure
         public const string AzureResourceExtension = ""x-ms-azure-resource"";
         public const string ODataExtension = ""x-ms-odata"";
         public const string ClientRequestIdExtension = ""x-ms-client-request-id"";
-        public const string ExternalExtension = ""x-ms-external"";
 
         //TODO: Ideally this would be the same extension as the ClientRequestIdExtension and have it specified on the response headers,
         //TODO: But the response headers aren't currently used at all so we put an extension on the operation for now",Nothing else was using this?,java,0,0,1
"@@ -327,6 +327,16 @@ class FirefoxProfile(object):
                     rc.append(node.data)
             return ''.join(rc).strip()
 
+        def parse_manifest_json(content):
+            """"""Extracts the details from the contents of a WebExtensions `manifest.json` file.""""""
+            manifest = json.loads(content)
+            return {
+                'id': manifest['applications']['gecko']['id'],
+                'version': manifest['version'],
+                'name': manifest['version'],
+                'unpack': False,
+            }
+
         if not os.path.exists(addon_path):
             raise IOError('Add-on path does not exist: %s' % addon_path)
 ",The id is not mandatory for web extensions. Could you update this to support a web extension without an id?,java,1,1,1
"@@ -89,6 +89,7 @@ public abstract class AbstractHadoopSecurityManager extends HadoopSecurityManage
   protected final ConcurrentMap<String, UserGroupInformation> userUgiMap;
   protected boolean shouldProxy;
   protected boolean securityEnabled;
+  protected final Props props;
   public static final String CHOWN = ""chown"";
   public static final String CHMOD = ""chmod"";
 ","Please remind me: why did we decide to put it here and not in ~~either~~ `KSudoHadoopSecurityManager` (bottom of the hierarchy, would not require any changes to OSS Azkaban) ~~*or* `HadoopSecurityManager` (all the way to the top of the class hierarchy)~~? Why is this in the middle?",java,1,1,1
"@@ -719,6 +719,7 @@ public class CoreContainer {
     createHandler(ZK_PATH, ZookeeperInfoHandler.class.getName(), ZookeeperInfoHandler.class);
     createHandler(ZK_STATUS_PATH, ZookeeperStatusHandler.class.getName(), ZookeeperStatusHandler.class);
     collectionsHandler = createHandler(COLLECTIONS_HANDLER_PATH, cfg.getCollectionsHandlerClass(), CollectionsHandler.class);
+    healthCheckHandler = loader.newInstance(cfg.getHealthCheckHandlerClass(), HealthCheckHandler.class, null, new Class<?>[]{CoreContainer.class}, new Object[]{this});
     infoHandler = createHandler(INFO_HANDLER_PATH, cfg.getInfoHandlerClass(), InfoHandler.class);
     coreAdminHandler = createHandler(CORES_HANDLER_PATH, cfg.getCoreAdminHandlerClass(), CoreAdminHandler.class);
     configSetsHandler = createHandler(CONFIGSETS_HANDLER_PATH, cfg.getConfigSetsHandlerClass(), ConfigSetsHandler.class);",why are we calling loader.newInstance directly instead of createHandler?,java,1,1,1
"@@ -318,7 +318,14 @@ public class ExecutionControllerUtils {
       jobLinkUrl = url.toString();
     } else {
       // If RM job link is invalid or has expired, fetch the job link from JHS or SHS.
-      if (exFlow.getExecutableNode(jobId).getType().equals(SPARK_JOB_TYPE)) {
+      final ExecutableNode node = exFlow.getExecutableNodePath(jobId);
+      if (node == null) {
+        logger.error(
+            ""Invalid job link. Job "" + jobId + "" doesn't exist in "" + exFlow.getExecutionId());
+        return null;
+      }
+
+      if (node.getType().equals(SPARK_JOB_TYPE)) {
         jobLinkUrl =
             azkProps.get(ConfigurationKeys.SPARK_HISTORY_SERVER_JOB_URL).replace
                 (APPLICATION_ID, applicationId);",In which scenario this is a possibility?,java,1,0,1
"@@ -36,9 +36,12 @@ interface LockManager extends AutoCloseable {
 
   /**
    * Release a lock
+   *
+   * @apiNote exception must not be thrown for this method.
+   *
    * @param entityId ID of the entity to lock
    * @param ownerId ID of the owner if the lock
-   * @return if the lock for the entity of the owner is released
+   * @return if the owner held the lock and successfully released it.
    */
   boolean release(String entityId, String ownerId);
 ","Key? I think you might still mean ""lock""?",java,1,1,0
"@@ -73,7 +73,7 @@ public interface RuneLiteConfig extends Config
 	)
 	default boolean enablePlugins()
 	{
-		return true;
+		return false;
 	}
 
 	@ConfigItem(","Not needed, just make hide externals by default in plugin sorter.",java,1,1,1
"@@ -57,7 +57,8 @@ public class BaselineErrorProneExtension {
             ""ArrayEquals"",
             ""MissingOverride"",
             ""UnnecessaryParentheses"",
-            ""PreferJavaTimeOverload"");
+            ""PreferJavaTimeOverload"",
+            ""UnnecessaryLambda"");
 
     private final ListProperty<String> patchChecks;
 ","I recall this creating code that didn't compile, might want to test it on something large and internal (or atlas) first",java,1,1,1
"@@ -103,6 +103,10 @@ public class UserNotificationServiceBean {
     }
 
     public void sendNotification(AuthenticatedUser dataverseUser, Timestamp sendDate, Type type, Long objectId, String comment, AuthenticatedUser requestor, boolean isHtmlContent) {
+        if (dataverseUser.isDisabled()) {
+            logger.info(""An attempt was made to send a "" + type + "" notification to a disabled user: "" + dataverseUser);
+            return;
+        }
         UserNotification userNotification = new UserNotification();
         userNotification.setUser(dataverseUser);
         userNotification.setSendDate(sendDate);",I don't think we need this: disabled users will have no roles. Let's save a few lines of code.,java,1,1,1
"@@ -117,13 +117,16 @@ public class ImageVersion extends BaseModel {
    * table. DEPRECATED - An image type version which is no longer in use is marked as DEPRECATED
    * TEST - This is to represent a TEST version of the image and once the version is tested it can
    * be marked as NEW.
+   * STABLE - When an image version is marked as ACTIVE, the other ACTIVE version(s) are marked as
+   * STABLE as there can be only 1 ACTIVE version at a time.
    */
   public enum State {
     NEW(""new""),
     ACTIVE(""active""),
     UNSTABLE(""unstable""),
     DEPRECATED(""deprecated""),
-    TEST(""test"");
+    TEST(""test""),
+    STABLE(""stable"");
     private final String stateValue;
 
     private State(final String stateValue) {",Let's see if we can use better name for this.,java,1,1,1
"@@ -26,6 +26,7 @@ import org.fossasia.phimpme.R;
 
 import java.lang.reflect.Field;
 import java.lang.reflect.Method;
+
 import java.util.ArrayList;
 
 /**",Un needed one as it's from the java package,java,1,1,0
"@@ -24,12 +24,14 @@ import java.util.Collections;
 import java.util.HashMap;
 import java.util.HashSet;
 import java.util.List;
+import java.util.Locale;
 import java.util.Map;
 import java.util.Set;
 import java.util.TreeMap;
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.TimeUnit;
 import java.util.concurrent.atomic.AtomicLong;
+import java.util.Locale;
 
 import org.apache.solr.client.solrj.cloud.SolrCloudManager;
 import org.apache.solr.client.solrj.cloud.autoscaling.ReplicaInfo;",is this being used?,java,1,0,1
"@@ -968,6 +968,16 @@ public abstract class AbstractTraversableTest extends AbstractValueTest {
         assertThat(of(BigDecimal.ZERO, BigDecimal.ONE).max()).isEqualTo(Option.some(BigDecimal.ONE));
     }
 
+    @Test(expected = NullPointerException.class)
+    public void shouldThrowNPEWhenMaxOfNullAndInt() {
+        System.out.println(of(null, 1).max());
+    }
+
+    @Test(expected = NullPointerException.class)
+    public void shouldThrowNPEWhenMaxOfIntAndNull() {
+        System.out.println(of(1, null).max());
+    }
+
     // -- maxBy(Comparator)
 
     @Test(expected = NullPointerException.class)",I think you can get rid of the `System.out.println`,java,1,1,1
"@@ -77,6 +77,12 @@ public class ExecutorUtil {
     awaitTermination(pool);
   }
 
+  public static void shutdownNowAndAwaitTermination(ExecutorService pool) {
+    if(pool == null) return;
+    pool.shutdownNow(); // Disable new tasks from being submitted; interrupt existing tasks
+    awaitTermination(pool);
+  }
+
   public static void awaitTermination(ExecutorService pool) {
     boolean shutdown = false;
     while (!shutdown) {",missing space after `if`,java,1,1,1
"@@ -89,9 +89,11 @@ public enum Kind {
   TS_CONFIG(""ts_config"", LanguageClass.TYPESCRIPT, RuleType.BINARY),
   DART_PROTO_LIBRARY(""dart_proto_library"", LanguageClass.DART, RuleType.LIBRARY),
   DART_LIBRARY(""_dart_library"", LanguageClass.DART, RuleType.LIBRARY),
-  KOTLIN_LIBRARY(""kotlin_library"", LanguageClass.KOTLIN, RuleType.LIBRARY),
-  KOTLIN_BINARY(""kotlin_binary"", LanguageClass.KOTLIN, RuleType.BINARY),
-  KOTLIN_TEST(""kotlin_test"", LanguageClass.KOTLIN, RuleType.TEST),
+  KT_JVM_LIBRARY(""kt_jvm_library"", LanguageClass.KOTLIN, RuleType.LIBRARY),
+  KT_JVM_BINARY(""kt_jvm_binary"", LanguageClass.KOTLIN, RuleType.BINARY),
+  KT_JVM_TEST(""kt_jvm_test"", LanguageClass.KOTLIN, RuleType.TEST),
+  KT_JVM_IMPORT(""kt_jvm_import"", LanguageClass.KOTLIN, RuleType.UNKNOWN),
+  KOTLIN_STDLIB(""kotlin_stdlib"", LanguageClass.KOTLIN, RuleType.UNKNOWN),
 
   // any rule exposing java_common.provider which isn't specifically recognized
   GENERIC_JAVA_PROVIDER(""generic_java"", LanguageClass.JAVA, RuleType.UNKNOWN),",Why not `RuleType.LIBRARY`?,java,1,1,1
"@@ -101,10 +101,11 @@ public final class Configuration {
         PROP_ROOT + PROP_RULE_STRATEGY_NAME);
   }
 
-  public int getSessionTimeoutInSeconds() {
+  public int getSessionTimeoutInSeconds(String microservice) {
     final int defaultValue = 30;
     // do not support MicroService level now
     String p = getStringProperty(""30"",
+        PROP_ROOT + microservice + ""."" + SESSION_TIMEOUT_IN_SECONDS,
         PROP_ROOT + SESSION_TIMEOUT_IN_SECONDS);
     try {
       return Integer.parseInt(p); // can be negative",this annotation can be deleted.,java,1,1,1
"@@ -148,8 +148,8 @@ public class DBOpenHelper extends SQLiteOpenHelper {
 		dataDir = context.getApplicationInfo().dataDir;
 	}
 
-	 protected void loadLibs(Context context) {
-        SQLiteDatabase.loadLibs(context);
+    protected void loadLibs(Context context) {
+        new SqliteLibraryLoader().loadSqlCipher(context);
     }
 
 	@Override",Use `static` call. There's no need to instantiate this util class every time.,java,1,1,1
"@@ -121,9 +121,12 @@ public class OptimizeManager extends AbstractManager {
     checkIsAuthorizedToReadHistoryAndTenants();
 
     String[] operationTypes = new String[]{
-      UserOperationLogEntry.OPERATION_TYPE_ASSIGN,
-      UserOperationLogEntry.OPERATION_TYPE_CLAIM,
-      UserOperationLogEntry.OPERATION_TYPE_COMPLETE};
+      UserOperationLogEntry.OPERATION_TYPE_SUSPEND_JOB,
+      UserOperationLogEntry.OPERATION_TYPE_ACTIVATE_JOB,
+      UserOperationLogEntry.OPERATION_TYPE_SUSPEND_PROCESS_DEFINITION,
+      UserOperationLogEntry.OPERATION_TYPE_ACTIVATE_PROCESS_DEFINITION,
+      UserOperationLogEntry.OPERATION_TYPE_SUSPEND,
+      UserOperationLogEntry.OPERATION_TYPE_ACTIVATE};
     Map<String, Object> params = new HashMap<>();
     params.put(""occurredAfter"", occurredAfter);
     params.put(""occurredAt"", occurredAt);","There's also the operation type `UserOperationLogEntry.OPERATION_TYPE_SUSPEND_JOB_DEFINITION`. When suspending a job definition, a user can also choose to include all jobs of that definition. Should these operations be exported to Optimize as well?",java,1,1,1
"@@ -79,7 +79,7 @@ public interface CheckedFunction1<T1, R> extends λ<R> {
      * @return a function that applies arguments to the given {@code partialFunction} and returns {@code Some(result)}
      *         if the function is defined for the given arguments, and {@code None} otherwise.
      */
-    static <T1, R> Function1<T1, Option<R>> lift(CheckedFunction1<T1, R> partialFunction) {
+    static <T1, R> Function1<T1, Option<R>> lift(CheckedFunction1<? super T1, R> partialFunction) {
         return t1 -> Try.of(() -> partialFunction.apply(t1)).getOption();
     }
 ","I think we will also need to widen the result type R: `? extends R` for al occurrences (lift, liftTry, recover). Could you also widen the parameters (`? super`for args and `? extends` for return type) for the method `of(...)` of CheckedFunction and Function?",java,1,1,1
"@@ -64,8 +64,6 @@ public class ExtendedBolus implements Interval, DataPointWithLabelInterface {
 
     @DatabaseField
     public int insulinInterfaceID = InsulinInterface.OREF_RAPID_ACTING;
-    @DatabaseField
-    public double dia = Constants.defaultDIA;
 
     @Deprecated
     public ExtendedBolus() {",well changing database fields has lof of sideffects it should be done along with increasing buildnumber and leads to braking backward compatibility,java,1,1,1
"@@ -64,7 +64,7 @@ public enum RpcMethod {
   PRIV_GET_FILTER_LOGS(""priv_getFilterLogs""),
   PRIV_SUBSCRIBE(""priv_subscribe""),
   PRIV_UNSUBSCRIBE(""priv_unsubscribe""),
-  PRIVX_FIND_PRIVACY_GROUP(""privx_findOnChainPrivacyGroup""),
+  PRIVX_FIND_PRIVACY_GROUP(""privx_findFlexiblePrivacyGroup""),
   EEA_SEND_RAW_TRANSACTION(""eea_sendRawTransaction""),
   ETH_ACCOUNTS(""eth_accounts""),
   ETH_BLOCK_NUMBER(""eth_blockNumber""),",this is a breaking change. We would need to support both for a time.,java,1,1,1
"@@ -42,6 +42,9 @@ public class SparkReadOptions {
   // Overrides the table's read.split.open-file-cost
   public static final String FILE_OPEN_COST = ""file-open-cost"";
 
+  // Overrides the table's read.split.by-partition
+  public static final String BY_PARTITION = ""by-partition"";
+
   // Overrides the table's read.split.open-file-cost
   public static final String VECTORIZATION_ENABLED = ""vectorization-enabled"";
 ",Is this useful for a user-facing setting? I don't know when a user would want to set this by hand.,java,1,1,1
"@@ -29,7 +29,6 @@ import org.apache.iceberg.Table;
 import org.apache.iceberg.TableMetadata;
 import org.apache.iceberg.TableOperations;
 import org.apache.iceberg.actions.BaseExpireSnapshotsActionResult;
-import org.apache.iceberg.actions.BaseSparkAction;
 import org.apache.iceberg.actions.ExpireSnapshots;
 import org.apache.iceberg.exceptions.NotFoundException;
 import org.apache.iceberg.exceptions.ValidationException;",Unrelated to this PR? Not a big deal might as well get it in though.,java,0,0,1
"@@ -32,9 +32,9 @@ public final class LinkedHashSet<T> implements Kind1<LinkedHashSet<?>, T>, Set<T
 
     private static final LinkedHashSet<?> EMPTY = new LinkedHashSet<>(LinkedHashMap.empty());
 
-    private final LinkedHashMap<T, T> map;
+    private final LinkedHashMap<T, Object> map;
 
-    private LinkedHashSet(LinkedHashMap<T, T> map) {
+    private LinkedHashSet(LinkedHashMap<T, Object> map) {
         this.map = map;
     }
 ","would `<T, ?>` also work, or just `<T, Object>`?",java,1,1,1
"@@ -109,7 +109,7 @@ public interface CatalogLoader extends Serializable {
 
     @Override
     public Catalog loadCatalog() {
-      return new HiveCatalog(catalogName, uri, warehouse, clientPoolSize, hadoopConf.get(), properties);
+      return CatalogUtil.loadCatalog(HiveCatalog.class.getName(), catalogName, properties, hadoopConf.get());
     }
 
     @Override",Question: Shall we use a constant in `CatalogUtil` for this? What way should we promote? Static import for the constant may make the line a bit shorter.,java,1,1,1
"@@ -114,6 +114,10 @@ public class HiveIcebergMetaHook implements HiveMetaHook {
       hmsTable.getParameters().put(InputFormatConfig.EXTERNAL_TABLE_PURGE, ""TRUE"");
     }
 
+    // For a table created by Hive DDL to be readable by Impala, we need the Input and OutputFormat set explicitly
+    hmsTable.getSd().setInputFormat(HiveIcebergInputFormat.class.getCanonicalName());
+    hmsTable.getSd().setOutputFormat(HiveIcebergOutputFormat.class.getCanonicalName());
+
     // If the table is not managed by Hive catalog then the location should be set
     if (!Catalogs.hiveCatalog(conf)) {
       Preconditions.checkArgument(hmsTable.getSd() != null && hmsTable.getSd().getLocation() != null,","These are going to be overwritten by `HiveTableOperations` depending on whether Hive is enabled. I think the right fix is to set the property to enable Hive on the table when creating an Iceberg table with the meta hook. @pvary, what do you think?",java,0,1,1
"@@ -335,11 +335,11 @@ public class TestLoadBalanceHandler2 {
     ServiceCombServer server2 = server;
     loadBalancer = handler.getOrCreateLoadBalancer(invocation);
     server = loadBalancer.chooseServer(invocation);
-    Assert.assertEquals(server.getEndpoint().getEndpoint(), ""rest://localhost:9090"");
+    Assert.assertEquals(server.getEndpoint().getEndpoint(), ""rest://localhost:9091"");
     ServiceCombLoadBalancerStats.INSTANCE.markSuccess(server2);
     loadBalancer = handler.getOrCreateLoadBalancer(invocation);
     server = loadBalancer.chooseServer(invocation);
-    Assert.assertEquals(server.getEndpoint().getEndpoint(), ""rest://localhost:9090"");
+    Assert.assertEquals(server.getEndpoint().getEndpoint(), ""rest://localhost:9091"");
     TimeUnit.MILLISECONDS.sleep(20);
     loadBalancer = handler.getOrCreateLoadBalancer(invocation);
     server = loadBalancer.chooseServer(invocation);",1.expected value should be the first parameter,java,1,1,1
"@@ -50,14 +50,16 @@ public class GrpcMetadataProviderFactory {
             new JavaPackageMetadataTransformer(
                 ImmutableMap.of(
                     ""LICENSE.snip"", ""LICENSE"",
-                    ""metadatagen/java/grpc/build_grpc.gradle.snip"", ""build.gradle""),
+                    ""metadatagen/java/grpc/build_grpc.gradle.snip"", ""build.gradle"",
+                    ""metadatagen/java/grpc/pom_grpc.xml.snip"", ""pom.xml""),
                 artifactType));
       case PROTOBUF:
         return new JavaGrpcMetadataProvider(
             new JavaPackageMetadataTransformer(
                 ImmutableMap.of(
                     ""LICENSE.snip"", ""LICENSE"",
-                    ""metadatagen/java/grpc/build_protobuf.gradle.snip"", ""build.gradle""),
+                    ""metadatagen/java/grpc/build_protobuf.gradle.snip"", ""build.gradle"",
+                    ""metadatagen/java/grpc/pom_protobuf.xml.snip"", ""pom.xml""),
                 artifactType));
     }
 ",Why generate both gradle and maven files?,java,1,1,1
"@@ -36,6 +36,7 @@ public class UserAuthority implements Authority {
     private static final Logger LOG = LoggerFactory.getLogger(UserAuthority.class);
     static final String ATHENZ_PROP_PAM_SERVICE_NAME = ""athenz.auth.user.pam_service_name"";
 
+    final String userDomain = System.getProperty(""athenz.user_domain"", ""user"");
     final String serviceName = System.getProperty(ATHENZ_PROP_PAM_SERVICE_NAME, ""login"");
     private PAM pam = null;
     ",Not sure what is the reason for this? Is there is a reason why you want to configure the domain name? Most likely you need to define your own authority as oppose to changing the default user authority.,java,1,1,1
"@@ -61,11 +61,11 @@ public class TestBodyProcessor {
   Buffer outputBodyBuffer;
 
   private void createProcessor(Class<?> type) {
-    processor = new BodyProcessor(TypeFactory.defaultInstance().constructType(type));
+    processor = new BodyProcessor(TypeFactory.defaultInstance().constructType(type), false);
   }
 
   private void createRawJsonProcessor() {
-    processor = new RawJsonBodyProcessor(TypeFactory.defaultInstance().constructType(String.class));
+    processor = new RawJsonBodyProcessor(TypeFactory.defaultInstance().constructType(String.class), false);
   }
 
   private void createClientRequest() {",We must not change a test case if it is required. And here should equivalent to true,java,1,1,1
"@@ -148,11 +148,11 @@ public class UiSetupWizardImplementation implements SetupWizard {
     @Override
     public Void presentation(String programName, String programEditor, String applicationHomepage,
             String scriptorName) {
-        final String htmlToShow = ""<body>"" + tr(""This wizard will help you install {0} on your computer"", programName)
-                + "".<br><br>"" + tr(""This program was created by: {0}"", programEditor) + ""<br><br>""
+        final String htmlToShow = ""<body>"" + tr(""Installation Wizard for {0}"", programName)
+                + "".<br><br>"" + tr(""Installation Script by {0}"", programEditor) + ""<br><br>""
                 + tr(""For more information about this program, visit:"")
                 + String.format(""<br><a href=\""%1$s\"">%1$s</a><br><br>"", applicationHomepage)
-                + tr(""This installation program is provided by: {0}"", scriptorName) + ""<br><br>"" + ""<br><br>""
+                + tr(""Installation Script by {0}"", scriptorName) + ""<br><br>"" + ""<br><br>""
                 + tr(""{0} will be installed in: {1}"", programName, applicationUserRoot) + ""<br><br>""
                 + tr(""{0} is not responsible for anything that might happen as a result of using these scripts."",
                         applicationName)",Why uppercase wizard and script?,java,1,1,1
"@@ -200,4 +200,17 @@ public interface ProjectLoader {
       throws ProjectManagerException;
 
   void updateProjectSettings(Project project) throws ProjectManagerException;
+
+  /**
+   * Uploads flow file.
+   */
+  void uploadFlowFile(int projectId, int projectVersion, int flowVersion, File flowFile)
+      throws ProjectManagerException;
+
+  /**
+   * Gets flow file that's uploaded.
+   */
+  File getUploadedFlowFile(int projectId, int projectVersion, int flowVersion, String flowName)
+      throws ProjectManagerException;
+
 }",same here about the argument order.,java,1,0,1
"@@ -464,6 +464,10 @@ public class QpsControllerManagerTest {
     ArchaiusUtils.setProperty(key, value);
   }
 
+  public static void deleteConfig(String key) {
+    ArchaiusUtils.setProperty(key, null);
+  }
+
   private static void setConfigWithDefaultPrefix(boolean isProvider, String key, int value) {
     String configKey = Config.CONSUMER_LIMIT_KEY_PREFIX + key;
     if (isProvider) {",This method never used,java,1,0,1
"@@ -25,6 +25,7 @@ import org.jasig.cas.client.util.CommonUtils;
 
 import org.springframework.beans.factory.InitializingBean;
 import org.springframework.security.cas.ServiceProperties;
+import org.springframework.security.cas.authentication.TriggerCasGatewayException;
 import org.springframework.security.core.AuthenticationException;
 import org.springframework.security.web.AuthenticationEntryPoint;
 import org.springframework.util.Assert;","Among other tangles, this introduces a tangle between between `org.springframework.security.cas.authentication` and `org.springframework.security.cas.web`. In general, authentication package should not rely on web.",java,1,1,1
"@@ -97,6 +97,8 @@ public class SparkCatalog extends BaseCatalog {
     Configuration conf = SparkSession.active().sessionState().newHadoopConf();
     Map<String, String> optionsMap = new TreeMap<>(String.CASE_INSENSITIVE_ORDER);
     optionsMap.putAll(options);
+    optionsMap.put(""app-id"", SparkSession.active().sparkContext().applicationId());
+    optionsMap.put(""user"", SparkSession.active().sparkContext().sparkUser());
     return CatalogUtil.buildIcebergCatalog(name, optionsMap, conf);
   }
 ",Should these keys be defined in `CatalogProperties`?,java,1,1,1
"@@ -156,7 +156,7 @@ public class UiSetupWizardImplementation implements SetupWizard {
                 + tr(""{0} will be installed in: {1}"", programName, applicationUserRoot) + ""<br><br>""
                 + tr(""{0} is not responsible for anything that might happen as a result of using these scripts."",
                         applicationName)
-                + ""<br><br>"" + tr(""Click \""Next\"" to start."") + ""</body>"";
+                + ""<br><br>"" + tr(""Click Next to start."") + ""</body>"";
         return messageSender.runAndWait(message -> setupUi.showHtmlPresentationStep(message, htmlToShow));
     }
 ","Why did you remove the """" here?",java,1,1,1
"@@ -115,7 +115,10 @@ class RemoveSnapshots implements ExpireSnapshots {
         .onlyRetryOn(CommitFailedException.class)
         .run(item -> {
           TableMetadata updated = internalApply();
-          ops.commit(base, updated);
+          // only commit the updated metadata if at least one snapshot was removed
+          if (updated.snapshots().size() != base.snapshots().size()) {
+            ops.commit(base, updated);
+          }
         });
 
     LOG.info(""Committed snapshot changes; cleaning up expired manifests and data files."");",Would it be more precise to check for `if (updated.snapshots().size() < base.snapshots().size())`?,java,1,1,1
"@@ -34,6 +34,8 @@ public class CommonMetrics {
   private final MetricsManager metricsManager;
   private Meter dbConnectionMeter;
   private Meter flowFailMeter;
+  private Meter dispatchFailMeter;
+  private Meter dispatchSuccessMeter;
 
   @Inject
   public CommonMetrics(final MetricsManager metricsManager) {","I think we should have a better way of organizing metrics. Keeping all metrics together in one class seems like putting apples and oranges in one basket. Also, such organization of metrics hints that metrics events can be declared from anywhere else in the code. However, dispatch fail / success should only be controlled by the `ExecutorManager`. Thoughts?",java,1,1,1
"@@ -72,7 +72,7 @@ public class ImageTypeDaoImpl implements ImageTypeDao {
       // insert image type record
       // Passing timestamp from the code base and can be formatted accordingly based on timezone
       final Timestamp currentTimestamp = Timestamp.valueOf(LocalDateTime.now());
-      transOperator.update(INSERT_IMAGE_TYPE, imageType.getName().toLowerCase(),
+      transOperator.update(INSERT_IMAGE_TYPE, imageType.getName(),
           imageType.getDescription(), true, imageType.getDeployable().getName(),
           imageType.getCreatedBy(), currentTimestamp, imageType.getModifiedBy(), currentTimestamp);
       final int imageTypeId = Long.valueOf(transOperator.getLastInsertId()).intValue();","Looks like imageType.getName().toLowerCase() is removed. lowercase is added so that all the image types stored will be in lowercase and the same convention is followed throughout. I think hadoopJava might be causing problem. May be we can keep the original job types name as is, but while processing or passing across different part of the codebase we can use lowercase. Else someone is passing as HadoopJava instead of hadoopJava then then it will not be able to find in the database. So we can follow lowercase lookup and processing to avoid these kind of issues. So while comparing we can do lowercase comparison and we can store in database as is. In that case lowercase removal is fine. I have done changes regarding this and it will be part of the new PR. So no need to change anything here.",java,1,1,0
"@@ -102,12 +102,9 @@ public class LizardmenShamanPlugin extends Plugin
 	@Subscribe
 	public void onChatMessage(ChatMessage event)
 	{
-		if (this.notifyOnSpawn)
+		if (this.notifyOnSpawn && event.getMessage().contains(MESSAGE))
 		{
-			if (event.getMessage().contains(MESSAGE))
-			{
-				notifier.notify(MESSAGE);
-			}
+			notifier.notify(MESSAGE);
 		}
 	}
 ","I think checking messagetype as well may be a bit faster, if you do that before checking the message",java,1,1,1
"@@ -46,8 +46,7 @@ import zipkin2.storage.StorageComponent;
 import zipkin2.storage.Traces;
 
 import static com.linecorp.armeria.common.HttpMethod.GET;
-import static zipkin2.elasticsearch.ElasticsearchVersion.V7_0;
-import static zipkin2.elasticsearch.ElasticsearchVersion.V7_8;
+import static zipkin2.elasticsearch.ElasticsearchVersion.*;
 import static zipkin2.elasticsearch.EnsureIndexTemplate.ensureIndexTemplate;
 import static zipkin2.elasticsearch.VersionSpecificTemplates.TYPE_AUTOCOMPLETE;
 import static zipkin2.elasticsearch.VersionSpecificTemplates.TYPE_DEPENDENCY;",nit say no to wildcards :D,java,1,1,0
"@@ -1007,6 +1007,14 @@ public class ParsingFieldUpdateProcessorsTest extends UpdateProcessorTestBase {
     assertParsedDate(""Friday Oct 7 13:14:15 2005"", Date.from(inst20051007131415()), ""parse-date-patterns-default-config"");
   }
 
+  public void testRfc2616() throws Exception {
+    assertParsedDate(""Fri Oct 7 13:14:15 2005"" , Date.from(inst20051007131415()), ""parse-date-patterns-default-config"");
+  }
+
+  public void testRfc2616Leniency() throws Exception {
+    assertParsedDate(""Fri Oct 07 13:14:15 2005"" , Date.from(inst20051007131415()), ""parse-date-patterns-default-config"");
+  }
+
   public void testParseQuotedDate() throws IOException {
     // also using 2 digit day
     assertParsedDate(""'Fri, 14 Oct 2005 13:14:15 GMT'"",","Should be named testAsctime since that's the format of this input you are testing. When I mentioned RFC2616, that is a spec that in turn refers to multiple formats (including asctime). Also, like I pointed out, need to test with 2 spaces left of a single digit day.",java,1,1,1
"@@ -166,8 +166,8 @@ public class TestHiveMetastore {
         .processor(new TSetIpAddressProcessor<>(handler))
         .transportFactory(new TTransportFactory())
         .protocolFactory(new TBinaryProtocol.Factory())
-        .minWorkerThreads(3)
-        .maxWorkerThreads(5);
+        .minWorkerThreads(5)
+        .maxWorkerThreads(15);
 
     return new TThreadPoolServer(args);
   }","I don't think we should change these values for the majority of Hive tests, or at least Hive Metastore tests, because this has helped us track down connection leaks. It sounds like we should change these for HiveRunner tests, where we have less control of the connections. If Hive itself doesn't pool or close connections, then we would need to bump this up. Could you make this configurable so that we can set it for the tests that need it?",java,1,1,1
"@@ -249,7 +249,9 @@ public class ExecutionControllerUtils {
       exFlow.setEndTime(time);
     }
 
-    exFlow.setStatus(Status.FAILED);
+    if (exFlow.getStatus() != Status.POD_FAILED) {
+      exFlow.setStatus(Status.FAILED);
+    }
   }
 
   /**",Perhaps make this check more generic and switch the status to FAILED if the previous status is already a final one ? Something like `if (!isStatusFinised(exFlow.getStatus())`,java,1,1,1
"@@ -62,6 +62,9 @@ public class TableProperties {
   public static final String SPLIT_LOOKBACK = ""read.split.planning-lookback"";
   public static final int SPLIT_LOOKBACK_DEFAULT = 10;
 
+  public static final String SPLIT_MIN_FILE_WEIGHT = ""read.split.min-file-weight"";
+  public static final long SPLIT_MIN_FILE_WEIGHT_DEFAULT = 4 * 1024 * 1024; // 4MB
+
   public static final String OBJECT_STORE_ENABLED = ""write.object-storage.enabled"";
   public static final boolean OBJECT_STORE_ENABLED_DEFAULT = false;
 ","Weight is called ""size"" in `read.split.target-size`, so I think we should make this similar. How about `read.split.min-size`?",java,1,1,1
"@@ -24,8 +24,8 @@ import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Locale;
-import java.util.Map;
 import java.util.Map.Entry;
+import java.util.function.Supplier;
 import java.util.stream.Collectors;
 
 import org.apache.solr.client.solrj.io.comp.ComparatorOrder;","Why the use of the Supplier? Is this a cosmetic change or is there some functionality here that I'm not seeing? I'm not against a cosmetic change but changes to StreamFactory are going to slow down landing this patch quite a bit because it's such an important class for Streaming Expressions. So if it's purely cosmetic and we want to land the other changes faster, let's do this in another ticket.",java,1,1,1
"@@ -93,7 +93,7 @@ public class Docker {
       throw new WebDriverException(""Unable to pull container: "" + name);
     }
 
-    LOG.info(String.format(""Pull of %s:%s complete"", name, tag));
+    LOG.fine(String.format(""Pull of %s:%s complete"", name, tag));
 
     return findImage(new ImageNamePredicate(name, tag))
         .orElseThrow(() -> new DockerException(",Waiting for the pull takes a long time. This message informs the user that at least one of the images being pulled is available. Please leave.,java,1,1,1
"@@ -86,8 +86,14 @@ public class InitCodeTransformer {
 
   private final ImportSectionTransformer importSectionTransformer;
 
-  // Whether the initialization code should include user-facing comments like TODOs. This should be
-  // false if the initialization code is being used to generate tests, rather than code samples.
+  // Whether the initialization code should include hardcoded comments like TODOs. This
+  // should only be true when generating incode samples.
+  //
+  // This field should be set to false when generating tests because tests do not need to include
+  // user facing comments.
+  //
+  // This field should be set to false when generating standalone samples because comments in
+  // standalone samples are derived from user configurations, not hardcoded.
   private final boolean generateUserFacingComments;
 
   public InitCodeTransformer() {","nits here and below: ""hard-coded"" ""in-code""",java,1,0,1
"@@ -150,4 +150,9 @@ public interface HistoricIncident {
 
   /** The time the historic incident will be removed. */
   Date getRemovalTime();
+
+  /**
+   * Returns the id of the activity on which the last exception occurred.
+   */
+  String getLastFailingActivityId();
 }","Why is named ""Last....""? Isn't it so that an incident is created because of exactly one exception? Hence there will be exactly one activityId, and hence there will be no ""first"" or ""last"" one.",java,1,1,1
"@@ -108,7 +108,7 @@ public class SolrDispatchFilter extends BaseSolrFilter {
   
   private boolean isV2Enabled = !""true"".equals(System.getProperty(""disable.v2.api"", ""false""));
 
-  private final String metricTag = Integer.toHexString(hashCode());
+  private final String metricTag = getClass().getSimpleName() + ""@"" + Integer.toHexString(hashCode());
   private SolrMetricManager metricManager;
   private String registryName;
   private volatile boolean closeOnDestroy = true;",Should use the new method from `SolrMetricProducer`.,java,1,1,1
"@@ -59,7 +59,7 @@ public class GoImportSectionTransformer implements ImportSectionTransformer {
   private boolean isStandardImport(String importPath) {
     // TODO(pongad): Some packages in standard library have slashes,
     // we might have to special case them.
-    if (importPath.equals(""net/http"")) {
+    if (importPath.equals(""net/http"") || importPath.equals(""net/url"")) {
       return true;
     }
     return !importPath.contains(""/"");","I think I found a better way to detect this. We can probably look for a ""."" in the path, so that we'll catch ""github.com/foo/bar"", but not stdlib.",java,1,1,1
"@@ -0,0 +1,13 @@
+package de.danoeh.antennapod.core.sync;
+
+public interface SynchronizationSharedPreferenceKeys {
+    String SELECTED_SYNC_PROVIDER = ""selected_sync_provider"";
+    String IS_SYNC_PROVIDER_CONNECTED = ""provider_is_connected"";
+    String LAST_SUBSCRIPTION_SYNC_TIMESTAMP = ""last_sync_timestamp"";
+    String LAST_EPISODE_ACTIONS_SYNC_TIMESTAMP = ""last_episode_actions_sync_timestamp"";
+    String QUEUED_FEEDS_ADDED = ""sync_added"";
+    String QUEUED_FEEDS_REMOVED = ""sync_removed"";
+    String QUEUED_EPISODE_ACTIONS = ""sync_queued_episode_actions"";
+    String LAST_SYNC_ATTEMPT_TIMESTAMP = ""last_sync_attempt_timestamp"";
+    String LAST_SYNC_ATTEMPT_SUCCESS = ""last_sync_attempt_success"";
+}","Now that you have dedicated classes for getting/setting the preferences, the constants don't need to be accessed from outside these classes, don't they? They can be moved to the classes and made private, then.",java,1,1,1
"@@ -49,8 +49,8 @@ public class TestSelect extends SparkCatalogTestBase {
 
   @Before
   public void createTables() {
-    sql(""CREATE TABLE %s (id bigint, data string, float float) USING iceberg"", tableName);
-    sql(""INSERT INTO %s VALUES (1, 'a', 1.0), (2, 'b', 2.0), (3, 'c', float('NaN'))"", tableName);
+    sql(""CREATE TABLE %s (id bigint, data string, float float, binary binary) USING iceberg"", tableName);
+    sql(""INSERT INTO %s VALUES (1, 'a', 1.0, X''), (2, 'b', 2.0, X'11'), (3, 'c', float('NaN'), X'1111')"", tableName);
 
     this.scanEventCount = 0;
     this.lastScanEvent = null;","Rather than repurposing old test cases, can you create new ones? We want to avoid mixing tests together in confusing ways that look like other failures.",java,1,1,1
"@@ -250,7 +250,8 @@ public class PythonGapicContext extends GapicContext {
 
     // parameter types
     contentBuilder.append(""Args:\n"");
-    for (Field field : this.messages().flattenedFields(method.getInputType())) {
+    for (Field field :
+        removePageTokenFromFields(this.messages().flattenedFields(method.getInputType()), config)) {
       String name = pythonCommon.wrapIfKeywordOrBuiltIn(field.getSimpleName());
       if (config.isPageStreaming()
           && field.equals((config.getPageStreaming().getPageSizeField()))) {",I don't think the call to flattenedFields is necessary here,java,1,1,1
"@@ -25,7 +25,8 @@ namespace Microsoft.Rest.Generator.CSharp.Azure
 
         public AzureCSharpCodeGenerator(Settings settings) : base(settings)
         {
-            _namer = new AzureCSharpCodeNamer();
+
+            _namer = new AzureCSharpCodeNamer(settings);
             IsSingleFileGenerationSupported = true;
             pageClasses = new Dictionary<KeyValuePair<string, string>, string>();
         }",Why an empty line,java,1,0,1
"@@ -56,7 +56,7 @@ public class CloudUtil {
   public static final int DEFAULT_TIMEOUT = 90;
 
   /**
-   * See if coreNodeName has been taken over by another baseUrl and unload core
+   * See if replicaName has been taken over by another baseUrl and unload core
    * + throw exception if it has been.
    */
   public static void checkSharedFSFailoverReplaced(CoreContainer cc, CoreDescriptor desc) {","Update the log on line 80, and the variable name ""cnn"" as well",java,1,1,1
"@@ -153,7 +153,7 @@ public class HomeFragment extends NavigationBaseFragment implements CustomTabAct
         super.onResume();
 
         int productCount = sp.getInt(""productCount"", 0);
-        apiClient.getTotalProductCount()
+        apiClient.getTotalProductCount(getString(R.string.app_name) + "" "" + Utils.getUserAgent(""OTHERS""))
             .subscribeOn(Schedulers.io())
             .observeOn(AndroidSchedulers.mainThread())
             .subscribe(new SingleObserver<Search>() {","We should use a common way to build the header. For instance in openfoodfacts.github.scrachx.openfood.network.OpenFoodAPIService#getProductByBarcodeSingle we use only this info: `client.getProductByBarcodeSingle(product.getCode(), fields, Utils.getUserAgent(Utils.HEADER_USER_AGENT_SEARCH))` I suggest to remove `getString(R.string.app_name) + "" ""` and change Utils.getUserAgent to add a prefix if needed.",java,1,1,0
"@@ -92,10 +92,10 @@ public class SolrCoreMetricManager implements Closeable {
    * are carried over and will be used under the new core name.
    * This method also reloads reporters so that they use the new core name.
    */
-  public void afterCoreSetName() {
+  public void afterCoreRename() {
+    assert core.getCoreDescriptor().getCloudDescriptor() == null;
     String oldRegistryName = solrMetricsContext.getRegistryName();
     String oldLeaderRegistryName = leaderRegistryName;
-    initCloudMode();
     String newRegistryName = createRegistryName(cloudMode, collectionName, shardName, replicaName, core.getName());
     leaderRegistryName = createLeaderRegistryName(cloudMode, collectionName, shardName);
     if (oldRegistryName.equals(newRegistryName)) {",Should it call apiAssumeStandalone()?,java,1,1,1
"@@ -186,6 +186,9 @@ public class TestHiveShell {
     // Tez configuration
     hiveConf.setBoolean(""tez.local.mode"", true);
 
+    // Disable vectorization for HiveIcebergInputFormat
+    hiveConf.setBoolVar(HiveConf.ConfVars.HIVE_VECTORIZATION_ENABLED, false);
+
     return hiveConf;
   }
 }","I think this is fine, but I'm curious: do we plan to add vectorized writes? Or is this not something that we think is important?",java,1,1,1
"@@ -59,6 +59,7 @@ public class JdbcExecutorLoaderTest {
   private static final String user = ""azkaban"";
   private static final String password = ""azkaban"";
   private static final int numConnections = 10;
+  private static final long recentlyFinishedLifetimeMs = 5000;
 
   @BeforeClass
   public static void setupDB() {",upper case. also using duration might be helpful,java,1,1,1
"@@ -37,9 +37,7 @@ public class MaxScoreCollector extends SimpleCollector {
 
   @Override
   public ScoreMode scoreMode() {
-    // Should be TOP_SCORES but this would wrap the scorer unnecessarily since
-    // this collector is only used in a MultiCollector.
-    return ScoreMode.COMPLETE;
+    return ScoreMode.TOP_SCORES;
   }
 
   @Override",why can we make this change?,java,1,0,1
"@@ -30,7 +30,7 @@ import org.junit.Test;
 public class PacketTest {
 
   private static final String VALID_PONG_PACKET =
-      ""53cec0d27af44bdc0471d34c4eb631f74b502df7b5513a80a054f0d619f0417d6ba4fd4d6fb83994b95c6d0ae8b175b068a6bffc397e2b408e797069b9370ce47b153dd884b60108e686546a775ed5f85e71059a9c5791e266bd949d0dcfba380102f83bcb84b4b57a1a82040182765fa046896547d3b4259aa1a67bd26e7ec58ab4be650c5552ef0360caf9dae489d53b845b872dc8880000000000000003"";
+      ""3b3d56e4fcdcf714d6c29b0d521e9f4ec0dd50c73c0bbb9b44758a0a7e416ff30a3ea99de3e78a5cff82ad0a0b82030f78c6eff5a1b2a030276277b6e9b6ad7c35db1a6d5f83586a203b4537d82edc6b2820849a485e55aa06cfc680dc63c22d0002f3cb84b4b57a1a82040182765fa046896547d3b4259aa1a67bd26e7ec58ab4be650c5552ef0360caf9dae489d53b8460e5e7b603"";
   private static final String INVALID_SIGNATURE_PACKET =
       ""43f91d11b3338b4dbdf16db4f9fa25d7b4e2db81e6fd63f8f6884dfaea851e106f8f692c77169b387bde7c38832cf2d37a9b97b1553d07587ebe251ee21ee36e0ed54fd9218e3feea3bd13ca6982b25c204d5186e7ec5373ea664c91d42467b30102f3cb842f3ee37b82040e82765fa04139782abaccbc8fd290a7fde1ff138943fa9659f7bd67f97c97b09893d1ee8a84607806e108"";
 ","Hmm, why is the whole packet different? I was expecting it to just be the last bytes.",java,1,1,1
"@@ -8,14 +8,15 @@ import org.mozilla.vrbrowser.BuildConfig;
 
 public class DeviceType {
     // These values need to match those in Device.h
-    @IntDef(value = { Unknown, OculusGo, OculusQuest, ViveFocusPlus, PicoNeo2, PicoG2 })
+    @IntDef(value = { Unknown, OculusGo, OculusQuest, ViveFocus, ViveFocusPlus, PicoNeo2, PicoG2 })
     public @interface Type {}
     public static final int Unknown = 0;
     public static final int OculusGo = 1;
     public static final int OculusQuest = 2;
-    public static final int ViveFocusPlus = 3;
-    public static final int PicoNeo2 = 4;
-    public static final int PicoG2 = 5;
+    public static final int ViveFocus = 3;
+    public static final int ViveFocusPlus = 4;
+    public static final int PicoNeo2 = 6;
+    public static final int PicoG2 = 7;
 
     private static @Type int mType = Unknown;
 ",Looks like PicoNeo2 should be 6 and PicoGaze should be 5?,java,1,1,1
"@@ -9,8 +9,8 @@ import java.lang.annotation.Retention;
 import java.lang.annotation.RetentionPolicy;
 import java.lang.annotation.Target;
 
-import net.sourceforge.pmd.lang.ast.AbstractNode;
 import net.sourceforge.pmd.lang.ast.Node;
+import net.sourceforge.pmd.lang.ast.impl.AbstractNode;
 
 /**
  * Filters out some methods from the XPath attributes of a node.","In theory, AbstractNode should be irrelevant in this context - AbstractNode should only help to implement the Node API, but should not add to the API... (so no additional methods). Maybe we don't need the NoAttrScope at all? If a intermediate (abstract) class adds a public method, it is public API... so why not expose it as XPath attribute?",java,1,1,1
"@@ -14,4 +14,6 @@
  */
 package com.google.api.codegen.viewmodel;
 
-public interface ApiMethodView {}
+public interface ApiMethodView {
+  String name();
+}",we use the `getX()` naming pattern in general - view models are the exception.,java,1,1,1
"@@ -31,7 +31,7 @@ import org.apache.tuweni.bytes.MutableBytes;
  *
  * <h3>Message structure</h3>
  *
- * The following describes the message structure:
+ * <p>The following describes the message structure:
  *
  * <pre>
  *   authRecipient -&gt; E(remote-pubk,","Seems unrelated, but ok.",java,1,0,1
"@@ -56,6 +56,8 @@ public class TestNamespaceSQL extends SparkCatalogTestBase {
 
   @Test
   public void testCreateNamespace() {
+    // Nessie namespaces are explicit and do not need to be explicitly managed
+    Assume.assumeFalse(catalogName.endsWith(""testnessie""));
     Assert.assertFalse(""Namespace should not already exist"", validationNamespaceCatalog.namespaceExists(NS));
 
     sql(""CREATE NAMESPACE %s"", fullNamespace);",The concept of a namespace is implicit in Nessie and are therefore not managed through the normal `SupportsNamespaces` interface. We skip tests of this interface when the catalog is a `NessieCatalog`.,java,1,1,1
"@@ -32,10 +32,10 @@ import org.openqa.selenium.remote.tracing.HttpTracing;
 import org.openqa.selenium.remote.tracing.Tracer;
 
 import java.net.URL;
+import java.util.Objects;
 import java.util.UUID;
 import java.util.logging.Logger;
 
-import static org.openqa.selenium.net.Urls.fromUri;
 import static org.openqa.selenium.remote.http.Contents.asJson;
 import static org.openqa.selenium.remote.http.HttpMethod.DELETE;
 import static org.openqa.selenium.remote.http.HttpMethod.GET;",We can get rid of this import then.,java,1,1,1
"@@ -69,7 +69,8 @@ public class Table {
 
   protected static int __offset(int vtable_offset, int offset, ByteBuffer bb) {
     int vtable = bb.array().length - offset;
-    return bb.getShort(vtable + vtable_offset - bb.getInt(vtable)) + vtable;
+    return bb.getShort(vtable + vtable_offset - bb.getShort(vtable)) != 0  ?
+      bb.getShort(vtable + vtable_offset - bb.getShort(vtable)) + vtable : 0;
   }
 
   /**",Should `bb.array().length` not be `bb.limit()` to be totally correct? Just in case the backing array isn't fully used?,java,1,1,1
"@@ -349,9 +349,13 @@ public class Camera2 extends android.support.v4.app.Fragment {
                 		Camera.Parameters parameters = preview.mCamera.getParameters();
                 		switch (HDR_STATE){
                     			case HDR_OFF:
-                        			HDR_STATE = HDR_ON;
-                        			camera_hdr.setImageResource(R.drawable.ic_hdr_on_white_24dp);
-                        			parameters.setSceneMode(SCENE_MODE_HDR);
+                        			if (preview.getSupportSceneModes().contains(SCENE_MODE_HDR)) {
+                                        HDR_STATE = HDR_ON;
+                                        camera_hdr.setImageResource(R.drawable.ic_hdr_on_white_24dp);
+                                        parameters.setSceneMode(SCENE_MODE_HDR);
+                                    }else {
+                                        Toast.makeText(ctx, R.string.hdr_unsupported_error,Toast.LENGTH_SHORT).show();
+                                    }
                         			break;
                     			case HDR_ON:
                         			HDR_STATE = HDR_OFF;",Properly intend the code pls.,java,1,0,1
"@@ -71,9 +71,9 @@ public class IDPRequestHandler {
         this.spConfig = spConfig;
         this.userAccount = userAccount;
         basicValidation();
-        loginUrl = spConfig.getLoginUrl();
+        loginUrl = userAccount.getLoginServer();
         if (TextUtils.isEmpty(loginUrl)) {
-            loginUrl = userAccount.getLoginServer();
+            loginUrl = spConfig.getLoginUrl();
         }
         buildRestClient();
     }",This one fixes a corner case bug when you swizzle out to the IDP and then decide to change login hosts.,java,1,1,1
"@@ -275,10 +275,15 @@ public class HiveTableOperations extends BaseMetastoreTableOperations {
       throw new AlreadyExistsException(""Table already exists: %s.%s"", database, tableName);
 
     } catch (TException | UnknownHostException e) {
-      if (e.getMessage() != null && e.getMessage().contains(""Table/View 'HIVE_LOCKS' does not exist"")) {
-        throw new RuntimeException(""Failed to acquire locks from metastore because 'HIVE_LOCKS' doesn't "" +
-            ""exist, this probably happened when using embedded metastore or doesn't create a "" +
-            ""transactional meta table. To fix this, use an alternative metastore"", e);
+      if (e.getMessage() != null) {
+        if (e.getMessage().contains(""Table/View 'HIVE_LOCKS' does not exist"")) {
+          throw new RuntimeException(""Failed to acquire locks from metastore because 'HIVE_LOCKS' doesn't "" +
+              ""exist, this probably happened when using embedded metastore or doesn't create a "" +
+              ""transactional meta table. To fix this, use an alternative metastore"", e);
+        } else if (e.getMessage().contains(""java.net.SocketTimeoutException: Read timed out"")) {
+          commitStatus = CommitStatus.UNKNOWN;
+          throw new CommitStateUnknownException(e);
+        }
       }
 
       throw new RuntimeException(String.format(""Metastore operation failed for %s.%s"", database, tableName), e);","Could we just check for the `cause` field instead of the message string? Or we are in a same situation as with the MetaExceptions, where there is only a string available? Thanks, Peter",java,1,1,1
"@@ -145,9 +145,9 @@ public final class Node<V> {
       for (Map.Entry<Long, Long> entry : idToParent.entrySet()) {
         Node<V> node = idToNode.get(entry.getKey());
         Node<V> parent = idToNode.get(entry.getValue());
-        if (parent == null && rootNode == null) { // handle headless trace
-          rootNode = node;
-        } else if (parent == null) { // attribute missing parents to root
+        if (parent == null) { // handle headless trace
+          if (rootNode == null)
+            rootNode = new Node<>();
           rootNode.addChild(node);
         } else {
           parent.addChild(node);","rootNode = Node.MISSING_ROOT ^^ something like this makes the code more obvious, plus you can search references for Node.MISSING_ROOT, where you can't search references for null",java,1,1,1
"@@ -38,6 +38,7 @@ public class PrettyPrinterConfiguration {
     private String indent = ""    "";
     private String endOfLineCharacter = EOL;
     private Function<PrettyPrinterConfiguration, PrettyPrintVisitor> visitorFactory = PrettyPrintVisitor::new;
+    private int maxEnumConstantsToAlignHorizontally = 5;
 
     public String getIndent() {
         return indent;",We could add a public static constant named `DEFAULT_MAX_ENUM_CONSTANTS_TO_ALIGN_HORIZONTALLY-,java,1,1,1
"@@ -44,7 +44,7 @@ public class NodeStatus {
   public NodeStatus(
       NodeId nodeId,
       URI externalUri,
-      int maxSessionCount,
+      Integer maxSessionCount,
       Set<Slot> slots,
       Availability availability) {
     this.nodeId = Require.nonNull(""Node id"", nodeId);",This change shouldn't be necessary for this PR. Please remove it.,java,1,1,1
"@@ -494,11 +494,10 @@ public final class HashSet<T> implements Set<T>, Serializable {
             final HashSet<T> set = (HashSet<T>) elements;
             return set;
         }
-        final HashArrayMappedTrie<T, T> that = addAll(tree, elements);
-        if (that.size() == tree.size()) {
+        if (Collections.isEmpty(elements) || this.equals(elements)){
             return this;
         } else {
-            return new HashSet<>(that);
+            return new HashSet<>(addAll(tree, elements));
         }
     }
 ",The new way is only better when this HashSet and the elements are equal but it adds an overhead for all other cases. Please restore the previous version.,java,1,1,1
"@@ -154,6 +154,17 @@ public final class BaselineErrorProne implements Plugin<Project> {
                                 errorProneOptions.check(""PreferSafeLoggingPreconditions"", CheckSeverity.OFF);
                                 errorProneOptions.check(""PreconditionsConstantMessage"", CheckSeverity.OFF);
                             }));
+
+            project.getTasks().withType(JavaCompile.class).configureEach(javaCompile -> {
+                ((ExtensionAware) javaCompile.getOptions())
+                        .getExtensions()
+                        .configure(ErrorProneOptions.class, errorProneOptions -> {
+                            // Relax some checks for test code
+                            if (errorProneOptions.isCompilingTestOnlyCode()) {
+                                errorProneOptions.check(""UnnecessaryLambda"", CheckSeverity.OFF);
+                            }
+                        });
+            });
         });
 
         // In case of java 8 we need to add errorprone javac compiler to bootstrap classpath of tasks that perform","is this intentionally only disabled for people that use `java-gradle-plugin`? It feels a little odd to disable it in such a specific case. If we think this UnnecessaryLambda is genuinely not great signal, why not just turn it off for all test code?",java,1,1,1
"@@ -44,12 +44,10 @@ import org.tikv.kvproto.Metapb.Store;
 public class Snapshot {
   private final TiTimestamp timestamp;
   private final TiSession session;
-  private final TiConfiguration conf;
 
   public Snapshot(TiTimestamp timestamp, TiSession session) {
     this.timestamp = timestamp;
     this.session = session;
-    this.conf = session.getConf();
   }
 
   public TiSession getSession() {",why delete this conf?,java,1,0,1
"@@ -95,6 +95,8 @@ class visibility_of(object):
 
 
 def _element_if_visible(element, visibility=True):
+    if isinstance(element, str) or isinstance(element, dict):
+           raise StaleElementReferenceException(""Invalid locator"")
     return element if element.is_displayed() == visibility else False
 
 ",This is not the right exception class. There is an InvalidSelectorException class that covers bad locators.,java,1,1,1
"@@ -0,0 +1,11 @@
+package com.fsck.k9;
+
+
+public class SputnikTest {
+    public   void sputnikTest(){
+        int x= 2+1;
+
+
+        return;
+    }
+}",[Checkstyle] ERROR: '{' is not preceded with whitespace.,java,1,1,1
"@@ -40,6 +40,7 @@ public class WebSocketConfiguration {
   private String authenticationCredentialsFile;
   private List<String> hostsAllowlist = Arrays.asList(""localhost"", ""127.0.0.1"");
   private File authenticationPublicKeyFile;
+  private String authenticationAlgorithm = ""RS256"";
   private long timeoutSec;
   private int maxActiveConnections;
 ",again can we use the JwtAlgorithm type for this,java,1,1,1
"@@ -140,6 +140,19 @@ public class TestTableUpdatePartitionSpec extends TableTestBase {
 
     Assert.assertEquals(""should match evolved spec"", evolvedSpec, table.spec());
     Assert.assertEquals(1002, table.spec().lastAssignedFieldId());
+
+    table.updateSpec()
+        .renameField(""id_bucket_8"", ""id_partition"")
+        .commit();
+
+    evolvedSpec = PartitionSpec.builderFor(table.schema())
+        .withSpecId(3)
+        .bucket(""data"", 16, ""data_bucket"")
+        .bucket(""id"", 8, ""id_partition"")
+        .truncate(""id"", 4, ""id_trunc_4"")
+        .build();
+    Assert.assertEquals(""should match evolved spec"", evolvedSpec, table.spec());
+    Assert.assertEquals(1002, table.spec().lastAssignedFieldId());
   }
 
   @Test",This seems like it should be its own test case. Could you move it?,java,1,1,1
"@@ -311,4 +311,13 @@ public class Constants {
     public static final String START_TIME = ""startTime"";
     public static final String TRIGGER_INSTANCE_ID = ""triggerInstanceId"";
   }
+
+
+  public static class DefaultValue {
+
+    public static final int PROJECT_DIR_CLEANUP_START_THRESHOLD = 90;
+    public static final int PROJECT_DIR_CLEANUP_STOP_THRESHOLD = 60;
+    //128G
+    public static final long PROJECT_DIR_MAX_SIZE = 12800;
+  }
 }",Is it in MB? Should it be 128_000 then?,java,1,1,1
"@@ -142,12 +142,9 @@ namespace AutoRest.Core.Model
         /// <returns>true if the specified object is functionally equal to this object; otherwise, false.</returns>
         public virtual bool StructurallyEquals(IModelType other)
         {
-            if (ReferenceEquals(other, null))
-            {
-                return false;
-            }
-
-            return GetType() == other.GetType() && Name.Equals(other.Name);
+            var ta = JsonConvert.SerializeObject(this);
+            var tb = JsonConvert.SerializeObject(other);
+            return ta == tb;
         }
 
         /// <summary>","Ouch! Some considerations: - this uses the default serialization rules where circular references will throw an exception. We overcome this in the `CodeModel` stuff by generating `$id` and `$ref` fields to allow multiple references to the same object to resolve correctly. - even if you used the serializer settings, two structurally identical objects may not be literally identical, if dictionaries are involved, and the references aren't generated in exactly the same order (since, the first reference shows the entire object, and the second will get a `$ref` to the `$id` of the first.)",java,1,1,0
"@@ -91,11 +91,7 @@ class MetricsHttpService implements MetricsService {
     router.route(""/"").method(HttpMethod.GET).handler(this::handleEmptyRequest);
 
     // Endpoint for Prometheus metrics monitoring.
-    router
-        .route(""/metrics"")
-        .method(HttpMethod.GET)
-        .produces(TextFormat.CONTENT_TYPE_004)
-        .handler(this::metricsRequest);
+    router.route(""/metrics"").method(HttpMethod.GET).handler(this::metricsRequest);
 
     final CompletableFuture<?> resultFuture = new CompletableFuture<>();
     httpServer","Maybe just check for `""text/plain""` instead of completely dropping Prometheus' very specific version?",java,1,1,1
"@@ -539,7 +539,10 @@ class WebElement(object):
     @property
     def rect(self):
         """"""A dictionary with the size and location of the element.""""""
-        return self._execute(Command.GET_ELEMENT_RECT)['value']
+        if self._w3c:
+            return self._execute(Command.GET_ELEMENT_RECT)['value']
+        else:
+            return self.size, self.location
 
     @property
     def screenshot_as_base64(self):",This would return a tuple of two dictionaries. You need to combine them and return a dictionary,java,1,1,1
"@@ -30,14 +30,14 @@ import org.apache.commons.dbutils.ResultSetHandler;
  */
 public interface DatabaseTransOperator {
 
-
   /**
    * returns the last id from a previous insert statement.
    * Note that last insert and this operation should use the same connection.
    *
    * @return the last inserted id in mysql per connection.
+   * @throws SQLException
    */
-  long  getLastInsertId();
+  long getLastInsertId() throws SQLException;
 
   /**
    *",Curious: What is the difference between `DatabaseOperator` and `DatabaseTransOperator`?,java,0,0,1
"@@ -122,6 +122,8 @@ public class TestSetChainParams implements JsonRpcMethod {
     maybeMoveToNumber(params, ""istanbulForkBlock"", config, ""istanbulBlock"");
     maybeMoveToNumber(params, ""muirGlacierForkBlock"", config, ""muirGlacierBlock"");
     maybeMoveToNumber(params, ""berlinForkBlock"", config, ""berlinBlock"");
+    maybeMoveToNumber(params, ""londonForkBlock"", config, ""londonBlock"");
+    maybeMoveToNumber(params, ""muirGlacierForkBlock"", config, ""muirGlacierBlock"");
     maybeMoveToNumber(params, ""chainID"", config, ""chainId"", 1);
 
     maybeMove(genesis, ""author"", chainParamsJson, ""coinbase"");",this needs to be arrowGlacier.,java,1,1,1
"@@ -28,8 +28,7 @@ public class InstrumentedHttpClients {
                                            HttpClientMetricNameStrategy metricNameStrategy) {
         return HttpClientBuilder.create()
                 .setRequestExecutor(new InstrumentedHttpRequestExecutor(metricRegistry, metricNameStrategy))
-                .setConnectionManager(new InstrumentedHttpClientConnectionManager(metricRegistry));
+                .setConnectionManager(InstrumentedHttpClientConnectionManager.builder(metricRegistry).build());
     }
 
-
 }","This change doesn't seem to be very useful, at the end we invoke the same constructor anyway...",java,1,1,1
"@@ -47,6 +47,7 @@ public class SnapshotSummary {
   public static final String PUBLISHED_WAP_ID_PROP = ""published-wap-id"";
   public static final String SOURCE_SNAPSHOT_ID_PROP = ""source-snapshot-id"";
   public static final String REPLACE_PARTITIONS_PROP = ""replace-partitions"";
+  public static final String EXTRA_METADATA_PREFIX = ""extra-metadata."";
 
   private SnapshotSummary() {
   }",happy to change if a different prefix string would be more suitable,java,1,1,1
"@@ -589,6 +589,8 @@ public class JsonRpcHttpService {
               token,
               user -> handleJsonBatchRequest(routingContext, array, user));
         }
+      } catch (final NullPointerException ex) {
+        handleJsonRpcError(routingContext, null, JsonRpcError.PARSE_ERROR);
       } catch (final DecodeException ex) {
         handleJsonRpcError(routingContext, null, JsonRpcError.PARSE_ERROR);
       }",Is there a more appropriate error we can give that's related to incorrect request header?,java,1,1,1
"@@ -98,9 +98,9 @@ final class ClassStats implements ClassMirror {
     @Override
     public boolean hasMatchingOpSig(String name, JavaOperationSigMask mask) {
         // Indexing on signatures optimises this type of request
-        for (JavaOperationSignature sig : operations.keySet()) {
-            if (mask.covers(sig)) {
-                if (operations.get(sig).contains(name)) {
+        for (Entry<JavaOperationSignature, Set<String>> entry : operations.entrySet()) {
+            if (mask.covers(entry.getKey())) {
+                if (operations.get(entry.getKey()).contains(name)) {
                     return true;
                 }
             }","This is wrong, should be `entry.getValue()`",java,1,1,1
"@@ -74,12 +74,12 @@ public class BeanMembersShouldSerializeRule extends AbstractJavaRule {
 
         Map<VariableNameDeclaration, List<NameOccurrence>> vars = node.getScope()
                 .getDeclarations(VariableNameDeclaration.class);
-        for (VariableNameDeclaration decl : vars.keySet()) {
-            AccessNode accessNodeParent = decl.getAccessNodeParent();
-            if (vars.get(decl).isEmpty() || accessNodeParent.isTransient() || accessNodeParent.isStatic()) {
+        for (Map.Entry<VariableNameDeclaration, List<NameOccurrence>> entry : vars.entrySet()) {
+            AccessNode accessNodeParent = entry.getKey().getAccessNodeParent();
+            if (entry.getValue().isEmpty() || accessNodeParent.isTransient() || accessNodeParent.isStatic()) {
                 continue;
             }
-            String varName = trimIfPrefix(decl.getImage());
+            String varName = trimIfPrefix(entry.getKey().getImage());
             varName = varName.substring(0, 1).toUpperCase() + varName.substring(1, varName.length());
             boolean hasGetMethod = Arrays.binarySearch(methNameArray, ""get"" + varName) >= 0
                     || Arrays.binarySearch(methNameArray, ""is"" + varName) >= 0;",I'd add a `VariableNameDeclaration decl = entry.getKey();` here for readability,java,1,1,1
"@@ -88,7 +88,6 @@ public class LoginActivity extends AccountAuthenticatorActivity implements OAuth
 
 		// Setup the WebView.
 		WebView webView = (WebView) findViewById(salesforceR.idLoginWebView());
-		webView.getSettings().setSavePassword(false);
 		EventsObservable.get().notifyEvent(EventType.AuthWebViewCreateComplete, webView);
 		webviewHelper = getOAuthWebviewHelper(this, loginOptions, webView, savedInstanceState);
 		","The ability to save passwords in the `WebView` has been taken away, so this method does nothing anymore.",java,1,1,1
"@@ -191,11 +191,11 @@ public class OpenTelemetryAcceptanceTest extends AcceptanceTestBase {
   @Test
   public void traceReportingWithTraceId() {
 
+    OkHttpClient okClient = new OkHttpClient();
     WaitUtils.waitFor(
         30,
         () -> {
           // call the json RPC endpoint to generate a trace - with trace metadata of our own
-          OkHttpClient okClient = new OkHttpClient();
           Configuration config =
               new Configuration(""okhttp"")
                   .withSampler(",moved this outside the wait so the connection gets reused,java,1,1,1
"@@ -37,6 +37,7 @@ import org.apache.http.impl.client.HttpClients;
 import org.apache.http.message.BasicHeader;
 import org.apache.http.util.EntityUtils;
 import org.camunda.bpm.client.interceptor.impl.RequestInterceptorHandler;
+import org.camunda.bpm.client.listener.ClientInteractionListener;
 import org.camunda.commons.utils.IoUtil;
 
 import com.fasterxml.jackson.core.JsonParseException;","This is not needed here anymore, right?",java,1,1,1
"@@ -69,8 +69,14 @@ public class LinkedHashMapTest extends AbstractMapTest {
 
     @Test
     public void shouldKeepOrder() {
-        CharSeq actual = LinkedHashMap.<Integer, Character> empty().put(3, 'a').put(2, 'b').put(1, 'c').foldLeft(CharSeq.empty(), (s, t) -> s.append(t._2));
-        assertThat(actual).isEqualTo(CharSeq.of(""abc""));
+        List<Character> actual = LinkedHashMap.<Integer, Character> empty().put(3, 'a').put(2, 'b').put(1, 'c').foldLeft(List.empty(), (s, t) -> s.append(t._2));
+        Assertions.assertThat(actual).isEqualTo(List.of('a', 'b', 'c'));
+    }
+
+    @Test
+    public void shouldKeepValuesOrder() {
+        List<Character> actual = LinkedHashMap.<Integer, Character> empty().put(3, 'a').put(2, 'b').put(1, 'c').values().foldLeft(List.empty(), List::append);
+        Assertions.assertThat(actual).isEqualTo(List.of('a', 'b', 'c'));
     }
 
     // -- static narrow","It was a big mistake to override `assers*` methods. They don't check ordering of iterables. It is sufficient for `Map`, but very dangerous for other cases.",java,1,1,1
"@@ -162,7 +162,7 @@ public class CloneVisitor implements GenericVisitor<Visitable, Object> {
 	public Visitable visit(AnnotationMemberDeclaration _n, Object _arg) {
 		NodeList<AnnotationExpr> annotations = cloneList(_n.getAnnotations(), _arg);
 		Type<?> type_ = cloneNode(_n.getType(), _arg);
-		Expression defaultValue = cloneNode(_n.getDefaultValue(), _arg);
+		Expression defaultValue = cloneNode(_n.getDefaultValue().orElse(null), _arg);
 		Comment comment = cloneNode(_n.getComment(), _arg);
 
 		AnnotationMemberDeclaration r = new AnnotationMemberDeclaration(","Consider making an optional-specific ""cloneNode"" for this",java,1,1,1
"@@ -113,7 +113,7 @@ public class UserAccount {
 	 * @param thumbnailUrl Thumbnail URL.
 	 * @param additionalOauthValues Additional OAuth values.
 	 */
-	public UserAccount(String authToken, String refreshToken,
+	UserAccount(String authToken, String refreshToken,
 					   String loginServer, String idUrl, String instanceServer,
 					   String orgId, String userId, String username, String accountName,
 					   String communityId, String communityUrl, String firstName, String lastName,",Package level access to ensure consumers use the `Builder` going forward.,java,1,1,1
"@@ -29,8 +29,11 @@ import org.apache.solr.common.params.CommonParams;
 import org.apache.solr.common.params.ModifiableSolrParams;
 import org.apache.solr.common.util.NamedList;
 import org.apache.solr.SolrTestCaseJ4.SuppressPointFields;
+import org.junit.Assert;
 import org.junit.Test;
 
+import static org.hamcrest.CoreMatchers.containsString;
+
 /**
  * TODO? perhaps use:
  *  http://docs.codehaus.org/display/JETTY/ServletTester",I think we don't need this import. All test cases extend `Assert`,java,1,1,1
"@@ -23,12 +23,18 @@ import com.google.api.codegen.discovery.Schema.Format;
 import com.google.api.codegen.discovery.Schema.Type;
 import com.google.api.codegen.transformer.ImportTypeTable;
 import com.google.api.codegen.util.Name;
+import com.google.api.codegen.util.SymbolTable;
 import com.google.api.codegen.util.TypeName;
 import com.google.api.tools.framework.model.Oneof;
 import com.google.api.tools.framework.model.TypeRef.Cardinality;
 import com.google.common.base.Preconditions;
+import com.google.common.base.Strings;
 import com.google.common.collect.ImmutableList;
+import java.util.AbstractMap;
+import java.util.Comparator;
 import java.util.List;
+import java.util.Map;
+import java.util.TreeMap;
 import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 import javax.annotation.Nullable;",Shouldn't this be unique per-package (namespace)?,java,1,1,1
"@@ -85,7 +85,15 @@ final public class Automata {
     a.finishState();
     return a;
   }
-  
+
+  /**
+   * Returns a new (deterministic) automaton that accepts all binary terms except
+   * the empty string.
+   */
+  public static Automaton makeAnyBinaryExceptEmpty() {
+    return makeCharRange(0, 255);
+  }
+
   /**
    * Returns a new (deterministic) automaton that accepts any single codepoint.
    */",I don't think this is right since this only accepts strings of length 1.,java,1,1,1
"@@ -35,6 +35,7 @@ import org.apache.lucene.util.fst.IntsRefFSTEnum;
 
 import static org.apache.lucene.analysis.ja.dict.BinaryDictionary.ResourceScheme;
 
+//nocommit
 /**
  * Tests of TokenInfoDictionary build tools; run using ant test-tools
  */","""test-tools"" shouldn't be a task. I don't know what it was doing but it should be a regular test, perhaps grouped under a test group (and enabled by a property).",java,1,1,1
"@@ -263,6 +263,7 @@ public abstract class AbstractServiceRegistry implements ServiceRegistry {
 
   @Override
   // TODO: this is for 3rd party invocation, and a better way can be provided
+  // TODO:  microserviceManager.getVersionsByName() can not be used, will delete this in SCB-1949
   public void registerMicroserviceMapping(String microserviceName, String version,
       List<MicroserviceInstance> instances, Class<?> schemaIntfCls) {
     MicroserviceNameParser parser = new MicroserviceNameParser(microservice.getAppId(), microserviceName);",3rd party is a good mechanism must not delete it.,java,1,1,1
"@@ -883,6 +883,17 @@ public class ExecutorServlet extends LoginAbstractAzkabanServlet {
     final String projectName = getParam(req, ""project"");
     final String flowId = getParam(req, ""flow"");
 
+    // check proxy
+    final  Map<String,String> props = getParamGroup(req, ""flowOverride"");
+    if (props != null){
+      for (String key : props.keySet()){
+         if (""user.to.proxy"".equals(key) && !userManager.validateProxyUser(props.get(key), user)){
+              ret.put(""error"", String.format(""User %s can not act as proxy for %s"", user.getUserId(), props.get(key)));
+              return;
+            }
+          }
+    }
+
     final Project project =
         getProjectAjaxByPermission(ret, projectName, user, Type.EXECUTE);
     if (project == null) {","Hi @sthbig , I believe we have this check when job starts to run. What's the advantage having this check here?",java,0,1,1
"@@ -40,6 +40,10 @@ public class RestTemplateCopyHeaderFilter implements HttpClientFilter {
 
     httpHeaders.forEach((key, values) -> {
       for (String value : values) {
+        // null args should not be set to requestEx to avoid NullPointerException in Netty.
+        if (null == value) {
+          continue;
+        }
         requestEx.addHeader(key, value);
       }
     });",Please do some debug log to help the user tracing the setting issue.,java,1,1,1
"@@ -66,7 +66,6 @@ public class VariableSpeedDialog {
                 Log.e(TAG, Log.getStackTraceString(e));
             }
         });
-        builder.forceStacking(true);
         MaterialDialog dialog = builder.show();
         if (Build.VERSION.SDK_INT < 16) {
             View pos = dialog.getActionButton(DialogAction.POSITIVE);",This method was removed by newer lib,java,1,1,1
"@@ -72,8 +72,12 @@ public class DebugOperationTracer implements OperationTracer {
               memory,
               storage,
               frame.getRevertReason(),
-              maybeRefunds));
+              maybeRefunds,
+              frame.isMemoryWritten(),
+              Optional.ofNullable(frame.getCode()),
+              frame.getCurrentOperation().getStackItemsProduced()));
     }
+    frame.setMemoryWritten(false);
   }
 
   private Optional<Map<UInt256, UInt256>> captureStorage(final MessageFrame frame) {",This feels messy - looks like you're using the frame to capture op-level state changes?,java,1,0,1
"@@ -25,7 +25,6 @@ import com.google.common.collect.ImmutableList;
 import com.google.common.collect.ImmutableSet;
 import com.google.common.collect.Range;
 import com.google.protobuf.ByteString;
-import com.pingcap.tikv.codec.KeyUtils;
 import com.pingcap.tikv.expression.ColumnRef;
 import com.pingcap.tikv.expression.Constant;
 import com.pingcap.tikv.expression.Expression;",can we check unsued import in checkstyle?,java,1,1,1
"@@ -19,7 +19,8 @@ package org.apache.lucene.search;
 
 import org.apache.lucene.util.PriorityQueue;
 
-final class HitQueue extends PriorityQueue<ScoreDoc> {
+/** Expert: Priority queue containing hit docs */
+public final class HitQueue extends PriorityQueue<ScoreDoc> {
 
   /**
    * Creates a new instance with <code>size</code> elements. If",This is used in o.a.l.sandbox.search.LargeNumHitsTopDocsCollector.,java,1,0,1
"@@ -371,7 +371,7 @@ public class Dictionary {
         fullStrip = true;
       } else if (""LANG"".equals(firstWord)) {
         language = singleArgument(reader, line);
-        alternateCasing = ""tr_TR"".equals(language) || ""az_AZ"".equals(language);
+        alternateCasing = language.startsWith(""tr"") || language.startsWith(""az"");
       } else if (""BREAK"".equals(firstWord)) {
         breaks = parseBreaks(reader, line);
       } else if (""FORBIDDENWORD"".equals(firstWord)) {",Hmm... I didn't check but can we use Locale to parse it properly to extract the language from country variant?,java,1,1,1
"@@ -52,7 +52,7 @@ public class ValidationServiceClient {
       template.postForObject(urlPrefix + ""/validate"", model, ValidationModel.class);
       TestMgr.check(false, true);
     } catch (InvocationException e) {
-      TestMgr.check(e.getErrorData().toString().contains(""age""), true);
+      TestMgr.check(e.getErrorData().toString().contains(""propertyPath=errorCode.request.age""), true);
     }
 
     try {",It's better to add error code check.,java,1,1,1
"@@ -298,6 +298,9 @@ class RustGenerator : public BaseGenerator {
 
     assert(!cur_name_space_);
 
+    // Generate global namespace imports.
+    GenNamespaceImports();
+
     // Generate all code in their namespaces, once, because Rust does not
     // permit re-opening modules.
     //","Please describe why we do this twice, for future maintainers.",java,1,1,1
"@@ -134,12 +134,16 @@ public class LinguisticNamingRule extends AbstractJavaRule {
         }
     }
 
+    private boolean isBooleanType(String typeImage) {
+        return ""boolean"".equalsIgnoreCase(typeImage) || ""AtomicBoolean"".equals(typeImage);
+    }
+
     private void checkBooleanMethods(ASTMethodDeclaration node, Object data, String nameOfMethod) {
         ASTResultType resultType = node.getResultType();
         ASTType t = node.getResultType().getFirstChildOfType(ASTType.class);
         if (!resultType.isVoid() && t != null) {
             for (String prefix : getProperty(BOOLEAN_METHOD_PREFIXES_PROPERTY)) {
-                if (hasPrefix(nameOfMethod, prefix) && !""boolean"".equalsIgnoreCase(t.getTypeImage())) {
+                if (hasPrefix(nameOfMethod, prefix) && !isBooleanType(t.getTypeImage())) {
                     addViolationWithMessage(data, node, ""Linguistics Antipattern - The method ''{0}'' indicates linguistically it returns a boolean, but it returns ''{1}''"",
                             new Object[] { nameOfMethod, t.getTypeImage() });
                 }",we should probably use typeresolution here just in case...,java,1,1,1
"@@ -115,6 +115,7 @@ public class DOIDataCiteServiceBean extends AbstractIdServiceBean {
      * @param dataset the Dataset whose metadata needs to be modified
      * @param metadata the new metadata for the Dataset
      * @return the Dataset identifier, or null if the modification failed
+     * @throws java.lang.Exception
      */
     @Override
     public String modifyIdentifier(Dataset dataset, HashMap<String, String> metadata) throws Exception {","When adding a `@throws`, I would suggest to add a situation in which the exception is thrown.",java,0,1,1
"@@ -62,7 +62,7 @@ public class TopLevelJoinQuery extends JoinQuery {
 
     final SolrIndexSearcher solrSearcher = (SolrIndexSearcher) searcher;
     final JoinQueryWeight weight = new JoinQueryWeight(solrSearcher, ScoreMode.COMPLETE_NO_SCORES, 1.0f);
-    final SolrIndexSearcher fromSearcher = weight.fromSearcher;
+    final SolrIndexSearcher fromSearcher = weight.toSearcher; // fromIndex isn't specified, so this has to be toSearcher
     final SolrIndexSearcher toSearcher = weight.toSearcher;
 
     try {",but what if `fromIndex` is specified?,java,1,0,1
"@@ -307,6 +307,10 @@ public class SearchIncludeFragment implements java.io.Serializable {
         String allTypesFilterQuery = SearchFields.TYPE + "":(dataverses OR datasets OR files)"";
         filterQueriesFinalAllTypes.add(allTypesFilterQuery);
 
+        if (page == 0) {
+            logger.info(""Variable 'page' was zero. Changing it one. What does this have to do with upgrading from Glassfish 4.1 to Payara 5?"");
+            page = 1;
+        }
         int paginationStart = (page - 1) * paginationGuiRows;
         /**
          * @todo",@pdurbin the log message makes me think we don't know why this is here? Can we find out if this is needed and why? I'd rather be sure of why we're adding in logic than just logging a \_()_/,java,0,1,1
"@@ -100,5 +100,8 @@ public interface PrivacyController {
 
   PrivateTransactionSimulator getTransactionSimulator();
 
-  Optional<Hash> getBlockHashByBlockNumber(Optional<Long> blockNumber);
+  Optional<Hash> getBlockHashByBlockNumber(final Long blockNumber);
+
+  Optional<Hash> getStateRootByBlockNumber(
+      final String privacyGroupId, final String enclavePublicKey, final long blockNumber);
 }",Do we need to expose this method in this interface? Isn't it used internally? I recon we could just find the blockhash from the number inside `getStateRootByBlockNumber()` method.,java,1,1,1
"@@ -32,10 +32,6 @@ public interface Parser {
      */
     TokenManager getTokenManager(String fileName, Reader source);
 
-    /**
-     * Indicates if this parser can actual parse, or if it can only tokenize.
-     */
-    boolean canParse();
 
     /**
      * Parse source code and return the root node of the AST.",we also need to deprecate `Parser::canParse()` on master,java,1,1,1
"@@ -30,6 +30,8 @@ public enum Status {
   SUCCEEDED(50),
   KILLING(55),
   KILLED(60),
+  // EXECUTION_STOPPED refers to a terminating flow status due to crashed executor/container
+  EXECUTION_STOPPED(65),
   FAILED(70),
   FAILED_FINISHING(80),
   SKIPPED(90),",terminal flow status?,java,1,1,0
"@@ -2191,6 +2191,17 @@ public class ZTSImpl implements KeyStore, ZTSHandler {
             return false;
         }
 
+        // validate uriHostname in request matches the uriHostname in cert
+        if (!validateUriHostname(certReq.getUriHostname(), cert)) {
+            return false;
+        }
+
+        // validate InstanceID in request matches the instanceid in the cert
+        if (!validateInstanceId(certReq.getInstanceId(), cert)) {
+            // Todo: minitor the logs, and make this a hard failure in later iteration
+            LOGGER.error(""unable to match request id: {} with cert id: {}"", certReq.getInstanceId(), X509CertUtils.extractRequestInstanceId(cert));
+        }
+
         // validate the ip address if any provided
 
         return verifyCertRequestIP ? certReq.validateIPAddress(cert, ip) : true;",we should not return true here. otherwise we're skipping the last check.,java,1,1,1
"@@ -44,7 +44,7 @@ public class RangeSetBuilder<C extends Comparable> extends DefaultVisitor<RangeS
    * @param loose If prefix length is specified, then filter is loose, so is the range.
    * @return a range set.
    */
-  protected RangeSet<C> comparisonBinaryExprVisit(
+  RangeSet<C> comparisonBinaryExprVisit(
       ComparisonBinaryExpression node, Void context, C literal, boolean loose) {
     NormalizedPredicate predicate = node.normalize();
     RangeSet<C> ranges = TreeRangeSet.create();",naming rule should be verb+noun for a method,java,1,1,1
"@@ -340,6 +340,10 @@ public class NavigationURLBar extends FrameLayout {
             if (!hasProtocol && !urlText.contains("" "") && UrlUtils.isDomain(urlText)) {
                 urlText = ""https://"" + urlText;
                 hasProtocol = true;
+            } else if (!hasProtocol && !urlText.contains("" "") && UrlUtils.isIPUri(urlText)) {
+                String protocol = UrlUtils.isLocalIP(urlText) ? ""http://"" : ""https://"";
+                urlText = protocol + urlText;
+                hasProtocol = true;
             }
             if (hasProtocol) {
                 URL url = new URL(urlText);",I was thinking about ways we could degrade from https:// to http:// in FxR so we always try secure first.,java,1,1,1
"@@ -800,5 +800,13 @@ public class EnginePersistenceLogger extends ProcessEngineLogger {
         preconditionMessage,
         failedOperation.toString());
   }
+  
+  public void logTaskAlreadyFetched(String workerId, Throwable cause) {
+	  logWarn(""091"",
+			  ""Execution Null. External task {}  was already fetched by worker thread {} {}"", 
+			  workerId, 
+			  cause.getMessage(), 
+			  cause);
+  }
 
 }","In the case of optimistic lokcing exception on the task itself, we currently do not log anything. In that sense, I would be ok to also not log anything in this case. If we do want to log though, it should be on level `DEBUG` as this is an expected condition in high concurrency scenarios and doesn't pose a problem that someone must take care of.",java,1,1,1
"@@ -192,7 +192,7 @@ public class ItunesSearchFragment extends Fragment {
         progressBar.setVisibility(View.VISIBLE);
 
         ItunesTopListLoader loader = new ItunesTopListLoader(getContext());
-        disposable = loader.loadToplist(25)
+        disposable = loader.loadToplist(100)
                 .subscribe(podcasts -> {
                     progressBar.setVisibility(View.GONE);
                     topList = podcasts;","I think something like this should be discussed in #3788. We already cause quite a lot of traffic to iTunes and I want to keep it to a minimum, so we do not get locked out one day.",java,0,1,1
"@@ -40,7 +40,7 @@ class AvroFileAppender<D> implements FileAppender<D> {
   AvroFileAppender(Schema schema, OutputFile file,
                    Function<Schema, DatumWriter<?>> createWriterFunc,
                    CodecFactory codec, Map<String, String> metadata) throws IOException {
-    this.stream = file.create();
+    this.stream = file.createOrOverwrite();
     this.writer = newAvroWriter(schema, stream, createWriterFunc, codec, metadata);
   }
 ",This will affect writes for all data and metadata files. Is it safe to do this everywhere?,java,1,1,1
"@@ -398,7 +398,6 @@ public class UserAccountManager {
 		final String userId = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_USER_ID));
 		final String username = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_USERNAME));
 		final String accountName = accountManager.getUserData(account, AccountManager.KEY_ACCOUNT_NAME);
-		final String clientId = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_CLIENT_ID));
 		final String lastName = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_LAST_NAME));
 		final String email = SalesforceSDKManager.decrypt(accountManager.getUserData(account, AuthenticatorService.KEY_EMAIL));
 		final String encFirstName =  accountManager.getUserData(account, AuthenticatorService.KEY_FIRST_NAME);",Unrelated - wasn't being used.,java,0,0,1
"@@ -570,6 +570,12 @@ public class ChatMessageManager
 			return;
 		}
 
+		//guard case for google MoreObjects#firstNonNull
+		if (message.getValue() == null && message.getRuneLiteFormattedMessage() == null)
+		{
+			return;
+		}
+
 		// this updates chat cycle
 		client.addChatMessage(
 			message.getType(),",use two separate if statements as an OR,java,1,1,1
"@@ -17,12 +17,12 @@ import java.io.IOException;
 
 import static org.junit.Assert.assertEquals;
 
-public class Issue1485 {
+public class Issue1485 extends AbstractTest {
 
     @Test
     public void issue1485withoutSpecifyingJARs() throws IOException {
-        File dir = new File(""src/test/resources/issue1485"");
-        File file = new File(""src/test/resources/issue1485/Complex.java"");
+        File dir = adaptPath(""src/test/resources/issue1485"").toFile();
+        File file = adaptPath(""src/test/resources/issue1485/Complex.java"").toFile();
 
         CombinedTypeSolver typeSolver = new CombinedTypeSolver();
         typeSolver.add(new ReflectionTypeSolver());",Try slowly refactoring things from File to Path.,java,1,1,1
"@@ -60,10 +60,10 @@ public final class PMDCommandLineInterface {
     public static String buildUsageText(JCommander jcommander) {
         StringBuilder usage = new StringBuilder();
 
-        String allCommandsDescription = null;
+        StringBuilder allCommandsDescription = null;
         if (jcommander != null && jcommander.getCommands() != null) {
             for (String command : jcommander.getCommands().keySet()) {
-                allCommandsDescription += jcommander.getCommandDescription(command) + PMD.EOL;
+                allCommandsDescription.append(jcommander.getCommandDescription(command)).append(PMD.EOL);
             }
         }
 ",@XenoAmess This introduces a NPE.,java,0,1,1
"@@ -66,6 +66,17 @@ public interface TableScan {
    */
   TableScan project(Schema schema);
 
+  /**
+   * Create a new {@link TableScan} from this that, if data columns where selected
+   * via {@link #select(java.util.Collection)}, controls whether the match to the schema will be done
+   * with case sensitivity.
+   *
+   * MUST be called before {@link #select(java.util.Collection)}!
+   *
+   * @return a new scan based on this with case sensitivity as stated
+   */
+  TableScan caseSensitive(boolean caseSensitive);
+
   /**
    * Create a new {@link TableScan} from this that will read the given data columns. This produces
    * an expected schema that includes all fields that are either selected or used by this scan's",This seems like a problem to me. Can we do everything lazily so that it doesn't matter what order refinement calls are made in?,java,1,0,0
"@@ -61,6 +61,9 @@ public abstract class StaticLangApiView {
 
   public abstract boolean hasLongRunningOperations();
 
+  @Nullable // Used in Java
+  public abstract String stubInterfaceName();
+
   public static Builder newBuilder() {
     return new AutoValue_StaticLangApiView.Builder();
   }","Nullable feels a little icky. I generally think ""NOT IMPLEMENTED"" string is better. Looks like you'll have to change all LanguageTransformers though... Up to you.",java,1,1,1
"@@ -221,7 +221,7 @@ public class VRBrowserActivity extends PlatformActivity implements WidgetManager
     void loadFromIntent(final Intent intent) {
         final Uri uri = intent.getData();
         if (SessionStore.get().getCurrentSession() == null) {
-            String url = (uri != null ? uri.toString() : SessionStore.DEFAULT_URL);
+            String url = (uri != null ? uri.toString() : SessionStore.get().getHomeUri());
             int id = SessionStore.get().createSession();
             SessionStore.get().setCurrentSession(id);
             SessionStore.get().loadUri(url);",I thought about just changing `SessionStore#loadUri` to accept a null `uri` and keeping the conditional logic in that method. would make things a tad more DRY. thoughts?,java,1,1,1
"@@ -112,9 +112,9 @@ public class BlockJoinSelector {
    *  one value per parent among its {@code children} using the configured
    *  {@code selection} type. */
   public static SortedDocValues wrap(final SortedDocValues values, Type selection, BitSet parents, DocIdSetIterator children) {
-    if (values.docID() != -1) {
-      throw new IllegalArgumentException(""values iterator was already consumed: values.docID="" + values.docID());
-    }
+    //if (values.docID() != -1) {
+    //  throw new IllegalArgumentException(""values iterator was already consumed: values.docID="" + values.docID());
+    //}
     return ToParentDocValues.wrap(values, selection, parents, children);
   }
 ","Would be discussed later, if all other issues resolved.",java,1,0,1
"@@ -107,10 +107,14 @@ public class AvroSchemaUtil {
 
   public static boolean isTimestamptz(Schema schema) {
     LogicalType logicalType = schema.getLogicalType();
-    if (logicalType != null && logicalType instanceof LogicalTypes.TimestampMicros) {
+    if (logicalType instanceof LogicalTypes.TimestampMillis || logicalType instanceof LogicalTypes.TimestampMicros) {
       // timestamptz is adjusted to UTC
       Object value = schema.getObjectProp(ADJUST_TO_UTC_PROP);
-      if (value instanceof Boolean) {
+
+      if (value == null) {
+        // not all avro timestamp logical types will have the adjust_to_utc prop, default to not timestamptz
+        return false;
+      } else if (value instanceof Boolean) {
         return (Boolean) value;
       } else if (value instanceof String) {
         return Boolean.parseBoolean((String) value);","How about ""default to timestamp"" or ""default to timestamp without time zone""?",java,1,1,1
"@@ -37,10 +37,11 @@ import org.junit.Test;
 import org.junit.rules.TemporaryFolder;
 
 public abstract class TestReadProjection {
+
   protected abstract Record writeAndRead(String desc,
-                                         Schema writeSchema,
-                                         Schema readSchema,
-                                         Record record) throws IOException;
+      Schema writeSchema,
+      Schema readSchema,
+      Record record) throws IOException;
 
   @Rule
   public TemporaryFolder temp = new TemporaryFolder();",Can you revert the non-functional changes here? This one and the whitespace one above.,java,1,1,1
"@@ -65,7 +65,10 @@ public class HANAStructureAssistant extends JDBCStructureAssistant<JDBCExecution
         GenericSchema parentSchema = parentObject instanceof GenericSchema ? (GenericSchema) parentObject : null;
 
         if (objectType == RelationalObjectType.TYPE_TABLE)
-            findTablesByMask(session, parentSchema, objectNameMask, caseSensitive, maxResults, result);
+        	/* 
+        	 * A TYPE_TABLE is requested in any kind of select statement. Hence it should return tables, views and (public) synonyms
+        	 */
+        	findObjectsByMask(session, parentSchema, objectNameMask, caseSensitive, maxResults, result);
         if (objectType == RelationalObjectType.TYPE_VIEW)
             findViewsByMask(session, parentSchema, objectNameMask, caseSensitive, maxResults, result);
         if (objectType == RelationalObjectType.TYPE_PROCEDURE)","The object types are choosen in the 'DB metadata' search dialog, so here should not find other types. If searching without schema might be ok to include synonyms with correct target object type in the result. A completely different solution would be adding 'Synonym' as searchable object type.",java,1,1,1
"@@ -0,0 +1,14 @@
+/**
+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html
+ */
+
+package net.sourceforge.pmd.util.fxdesigner.model;
+
+/** Exception during XPath evaluation. */
+public class XPathEvaluationException extends RuntimeException {
+
+    XPathEvaluationException(Throwable cause) {
+        super(cause);
+    }
+
+}",is package-private the intended visibility? or you just missed the access modifier?,java,1,1,1
"@@ -1115,6 +1115,19 @@ public class Crypto {
         return extractX509CertSubjectField(x509Cert, BCStyle.O);
     }
 
+    public static boolean isRestrictedCertificate(X509Certificate x509Cert, GlobStringsMatcher globStringsMatcher) {
+        if (globStringsMatcher == null) {
+            LOG.error(""isRestrictedCertificate: Required argument globStringsMatcher is null. Returning true."");
+            return true;
+        }
+        if (x509Cert == null) {
+            LOG.error(""isRestrictedCertificate: Required argument x509Cert is null. Returning true."");
+            return true;
+        }
+        String x509Ou = extractX509CertSubjectOUField(x509Cert);
+        return globStringsMatcher.isMatch(x509Ou);
+    }
+
     private static List<String> extractX509CertSANField(X509Certificate x509Cert, int tagNo) {
         Collection<List<?>> altNames = null;
         try {","we should optimize the use of this function. If I don't have a restricted set, the code parses and gets the ou field anyway and then just does nothing. before doing this we should check if there are any values in our strings matcher and if it's empty, then return false right away without doing anything.",java,1,1,1
"@@ -243,6 +243,12 @@ public class AddProductActivity extends AppCompatActivity {
         final State state = (State) getIntent().getSerializableExtra(""state"");
         offlineSavedProduct = (OfflineSavedProduct) getIntent().getSerializableExtra(""edit_offline_product"");
         Product mEditProduct = (Product) getIntent().getSerializableExtra(""edit_product"");
+
+        if(getIntent().getBooleanExtra(""perform_ocr"",false)) {
+            this.onPageSelected(1);
+            this.performOCR(mEditProduct.getCode(), ""ingredients_"" + mEditProduct.getLang());
+        }
+
         if (state != null) {
             mProduct = state.getProduct();
             // Search if the barcode already exists in the OfflineSavedProducts db",Always include a screenshot when a PR makes visual changes.,java,1,1,1
"@@ -230,4 +230,4 @@ public class Login {
 			return 1; // L: 1317
 		}
 	}
-}
+}",Revert this file,java,1,0,1
"@@ -220,7 +220,7 @@ class JsGenerator : public BaseGenerator {
        it != sorted_namespaces.end(); it++) {
     if (lang_.language == IDLOptions::kTs) {
       if (it->find('.') == std::string::npos) {
-        code += ""import { flatbuffers } from \""./flatbuffers\""\n"";
+        code += ""import { flatbuffers } from \""flatbuffers\""\n"";
         break;
       }
     } else {",Why is this? What effect will this have on other users? @krojew @JoshGalvin,java,0,0,0
"@@ -21,7 +21,11 @@ import java.util.Collection;
 
 /**
  * Provides relevant data for producing metrics on the status of a Proof of Authority (PoA) node.
+ *
+ * @deprecated This interface has been replaced by {@link
+ *     org.hyperledger.besu.plugin.services.query.PoaQueryService}
  */
+@Deprecated
 public interface PoAMetricsService {
 
   /**","nit: Can we check if we're using `PoA` or `Poa` to make sure these new APIs match. I think `Poa` is strictly right according to the style guide but looks really weird to me - I'd expect `PoA`. I can live with it either way, just want to minimise inconsistency.",java,1,1,1
"@@ -76,7 +76,7 @@ class DeleteFileIndex {
     ImmutableMap.Builder<Integer, Types.StructType> builder = ImmutableMap.builder();
     specsById.forEach((specId, spec) -> builder.put(specId, spec.partitionType()));
     this.partitionTypeById = builder.build();
-    this.wrapperById = Maps.newHashMap();
+    this.wrapperById = Maps.newConcurrentMap();
     this.globalSeqs = globalSeqs;
     this.globalDeletes = globalDeletes;
     this.sortedDeletesByPartition = sortedDeletesByPartition;","My only question on this PR is whether we should switch to using a Caffeine loading cache here? I just notice in some places we do that, and in others we just use the concurrent map.",java,1,1,1
"@@ -25,7 +25,7 @@ public interface ValidatorManager {
    * of {@link ValidationReport} with the key being the validator's name and the value being the
    * {@link ValidationReport} generated by that validator.
    */
-  Map<String, ValidationReport> validate(Project project, File projectDir);
+  Map<String, ValidationReport> validate(Project project, File projectDir, String azkabanFlowVersion);
 
   /**
    * The ValidatorManager should have a default validator which checks for the most essential",How do you plan to discover and update all the users of this interface?,java,1,1,1
"@@ -18,17 +18,7 @@ package org.apache.solr.handler;
 
 import java.io.IOException;
 import java.lang.invoke.MethodHandles;
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.Collection;
-import java.util.Collections;
-import java.util.HashMap;
-import java.util.HashSet;
-import java.util.LinkedHashMap;
-import java.util.List;
-import java.util.Locale;
-import java.util.Map;
-import java.util.Set;
+import java.util.*;
 import java.util.concurrent.Callable;
 import java.util.concurrent.ExecutionException;
 import java.util.concurrent.ExecutorService;","I've had this happen recently with IntelliJ, was this intentional?",java,0,0,1
"@@ -324,7 +324,7 @@ class SimpleClusterAbstractionsImpl {
       return new Pair<>(replicas, leader);
     }
 
-    private ReplicaImpl(String replicaName, Shard shard, org.apache.solr.common.cloud.Replica sliceReplica) {
+    ReplicaImpl(String replicaName, Shard shard, org.apache.solr.common.cloud.Replica sliceReplica) {
       this.replicaName = replicaName;
       this.coreName = sliceReplica.getCoreName();
       this.shard = shard;",Why are these no longer `private`?,java,1,1,1
"@@ -105,8 +105,7 @@ public class RegionStoreClient extends AbstractGRPCClient<TikvBlockingStub, Tikv
   // lockResolverClient, after implements the
   // write implementation of tispark, we can change
   // it to private
-  @VisibleForTesting
-  public final LockResolverClient lockResolverClient;
+  @VisibleForTesting public final LockResolverClient lockResolverClient;
   private TikvBlockingStub blockingStub;
   private TikvStub asyncStub;
 ",please undo this change,java,1,0,1
"@@ -78,6 +78,13 @@ public class BftBlockHashing {
             bftExtraDataCodec));
   }
 
+  public Hash calculateHashOfBftBlockForCmsSignature(final BlockHeader header) {
+    final BftExtraData bftExtraData = bftExtraDataCodec.decode(header);
+    return Hash.hash(
+        serializeHeader(
+            header, () -> bftExtraDataCodec.encodeForProposal(bftExtraData), bftExtraDataCodec));
+  }
+
   /**
    * Recovers the {@link Address} for each validator that contributed a committed seal to the block.
    *","Don't think this belongs on the generic BftBlockHashing class, this is quite to specific to the QBFT PKI implementation",java,1,1,1
"@@ -0,0 +1,17 @@
+/**
+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html
+ */
+
+package net.sourceforge.pmd.lang.plsql.ast;
+
+import org.junit.Test;
+
+import net.sourceforge.pmd.lang.plsql.AbstractPLSQLParserTst;
+
+public class ParsingExclusionTest extends AbstractPLSQLParserTst {
+
+    @Test
+    public void parseParsingExclusion() {
+        plsql.parseResource(""ParsingExclusion.sql"");
+    }
+}","I think, we should somehow verify that the AST doesn't contain the excluded elements. In the future, we might improve the parser, so that it can parse scalar subqueries in where conditions.... maybe it's easier to just write really invalid SQL that will be skipped by PMD to verify, it is indeed being skipped....",java,1,1,1
"@@ -65,6 +65,7 @@ public abstract class BaseRewriteDataFilesAction<ThisT>
   private Expression filter;
   private long targetSizeInBytes;
   private int splitLookback;
+  private int itemsPerBin;
   private long splitOpenFileCost;
 
   protected BaseRewriteDataFilesAction(Table table) {",Looks like this is only modifying the old rewrite path and not the new path. We should probably fix it in both places,java,1,1,1
"@@ -705,7 +705,8 @@ public class AzkabanWebServer extends AzkabanServer {
 
   private void startWebMetrics() throws Exception {
 
-    final MetricRegistry registry = MetricsManager.INSTANCE.getRegistry();
+    final MetricRegistry registry = SERVICE_PROVIDER.getInstance(MetricsManager.class)
+        .getRegistry();
 
     // The number of idle threads in Jetty thread pool
     MetricsUtility",Why not just get the MetricsRegistry directly?,java,1,1,1
"@@ -1,5 +1,4 @@
 import { enqueueRender } from './component';
-
 export let i = 0;
 
 /**","Nit: It may be just me, but I feel like having at least one empty line after imports is easier to scan.",js,1,1,1
"@@ -118,6 +118,7 @@ class ConfigScreenComponent extends BaseScreenComponent {
 					const files = await shim.fsDriver().readDirStats(Setting.value('resourceDir'));
 
 					for (const file of files) {
+						if (file.path == 'pluginAssets') continue;
 						const source = `${Setting.value('resourceDir')}/${file.path}`;
 						const dest = `${this.state.profileExportPath}/resources/${file.path}`;
 						reg.logger().info(`Copying profile: ${source} => ${dest}`);",A better fix would be to recursively copy all files and folders. I think there's an option on readDirStats for that,js,1,1,1
"@@ -42,17 +42,6 @@ function missingRequiredChildren(virtualNode, role, required, ownedRoles) {
 
   // combobox exceptions
   if (isCombobox) {
-    // remove 'textbox' from missing roles if combobox is a native
-    // text-type input or owns a 'searchbox'
-    const textTypeInputs = ['text', 'search', 'email', 'url', 'tel'];
-    if (
-      (virtualNode.props.nodeName === 'input' &&
-        textTypeInputs.includes(virtualNode.props.type)) ||
-      ownedRoles.includes('searchbox')
-    ) {
-      required = required.filter(requiredRole => requiredRole !== 'textbox');
-    }
-
     // combobox only needs one of [listbox, tree, grid, dialog] and
     // only the type that matches the aria-popup value. remove
     // all the other popup roles from the list of required",All of this special case should probably be removed. We don't want to check for required owned elements.,js,1,1,1
"@@ -1924,7 +1924,10 @@ describe('Change Streams', function () {
     });
 
     it('when invoked using eventEmitter API', {
-      metadata: { requires: { topology: 'replicaset', mongodb: '>=3.6' } },
+      metadata: {
+        requires: { topology: 'replicaset', mongodb: '>=3.6' },
+        sessions: { skipLeakTests: true }
+      },
       test: function (done) {
         let closed = false;
         const close = _err => {","Note, this test was leaking a session for me locally. Looks like this is because the client can close in the `afterEach` hook before the `changeStream.close` completes. This seems acceptable, so I skipped the leak checker on this test.",js,1,1,1
"@@ -47,6 +47,7 @@ public interface CapabilityType {
   String ELEMENT_SCROLL_BEHAVIOR = ""elementScrollBehavior"";
   String HAS_TOUCHSCREEN = ""hasTouchScreen"";
   String OVERLAPPING_CHECK_DISABLED = ""overlappingCheckDisabled"";
+  String ENABLE_DOWNLOADING = ""chromium:enableDownloading"";
 
   String LOGGING_PREFS = ""loggingPrefs"";
 ",The name `enableDownloading` implies this is a boolean capability. How about `downloadDir`?,js,1,1,1
"@@ -30,7 +30,12 @@ const start = (buildConfig = config.defaultBuildConfig, options) => {
   }
 
   if (process.platform === 'darwin') {
-    util.run(path.join(config.outputDir, 'Brave.app', 'Contents', 'MacOS', 'Brave'), braveArgs, cmdOptions)
+    let product_name = 'Brave-Browser'
+    if (config.channel) {
+      // Capitalize channel name and append it to make product name like Brave-Browser-Beta
+      product_name = product_name + '-' + config.channel.charAt(0).toUpperCase() + config.channel.slice(1)
+    }
+    util.run(path.join(config.outputDir, product_name + '.app', 'Contents', 'MacOS', product_name), braveArgs, cmdOptions)
   } else if (process.platform === 'win32') {
     util.run(path.join(config.outputDir, 'brave.exe'), braveArgs, cmdOptions)
   } else {","this is fine to merge, but I think it probably makes sense to move this logic to config.js",js,1,1,1
"@@ -200,7 +200,7 @@ public class JsonHttpRemoteConfig {
     }
   }
 
-  private UrlMapper getUrlMapper(String method) {
+  protected UrlMapper getUrlMapper(String method) {
     if (""DELETE"".equals(method)) {
       return deleteMapper;
     } else if (""GET"".equals(method)) {","You don't need to expose this method to do what you want. There are already public addNewGetMapping, addNewPostMapping, and addNewDeleteMapping methods.",js,1,1,1
"@@ -123,6 +123,18 @@ SchemaArray.prototype.applyGetters = function (value, scope) {
 
 SchemaArray.prototype.cast = function (value, doc, init) {
   if (Array.isArray(value)) {
+
+    if (!value.length) {
+      var indexes = doc.schema.indexedPaths();
+
+      for (var i = 0, l = indexes.length; i < l; ++i) {
+        var pathIndex = indexes[i][0][this.path];
+        if ('2dsphere' === pathIndex || '2d' === pathIndex) {
+          return;
+        }
+      }
+    }
+
     if (!(value instanceof MongooseArray)) {
       value = new MongooseArray(value, this.path, doc);
     }",we could go even farther and cache this too to avoid the loop.,js,1,1,1
"@@ -1577,7 +1577,7 @@ describe('Insert', function () {
         var collection = db.collection('bson_types_insert_1');
 
         var document = {
-          symbol: new BSONSymbol('abcdefghijkl'),
+          string: 'abcdefghijkl',
           objid: new ObjectId('abcdefghijkl'),
           double: new Double(1),
           binary: new Binary(Buffer.from('hello world')),",BSONExt supports deserializing but not serializing this type (which is acceptable for deprecated types). So to make the bson-ext tests pass I've updated this to a string.,js,1,1,1
"@@ -111,7 +111,7 @@ export function getDomSibling(vnode, childIndex) {
 			// Since updateParentDomPointers keeps _dom pointer correct,
 			// we can rely on _dom to tell us if this subtree contains a
 			// rendered DOM node, and what the first rendered DOM node is
-			return sibling._dom;
+			return sibling._component ? sibling._component.base : sibling._dom;
 		}
 	}
 ","Hi! (Popping in from vacation   for a moment  . I have limited internet so I'll be away, so don't wait for me) My thinking when playing with this method last was that `_dom` was the source of truth and that `c.base` was just a reflection of that value (perhaps one day it is a getter property). Is there a situation where `v._component.base != v._dom`? Perhaps we should fix the code that updates `c.base` and not `v._dom` (assuming my understanding is anywhere near close to meaningful  )?",js,1,1,0
"@@ -139,7 +139,9 @@ var Cursor = function(bson, ns, cmd, options, topology, topologyOptions) {
     // Promise library
     promiseLibrary: promiseLibrary,
     // Current doc
-    currentDoc: null
+    currentDoc: null,
+    // Optional ClientSession
+    session: options.session || null
   };
 
   // Translate correctly","Do we specifically need `null` here, or can we just let it be `undefined`?",js,1,1,1
"@@ -46,7 +46,9 @@ public class HTMLTestResults {
   private final HTMLSuiteResult suite;
 
   private static final String HEADER = ""<html>\n"" +
-      ""<head><style type='text/css'>\n"" +
+      ""<head>\n""+
+      ""<meta charset=\""UTF-8\"">\n""+
+      ""<style type='text/css'>\n"" +
       ""body, table {\n"" +
       ""    font-family: Verdana, Arial, sans-serif;\n"" +
       ""    font-size: 12;\n"" +","Is there a recommended quote style for attributes? I see single and double here, double further down.",js,1,1,1
"@@ -1654,9 +1654,10 @@ class TargetLocator {
    *     when the driver has changed focus to the specified window.
    */
   window(nameOrHandle) {
+    let paramName = this.driver_.getExecutor().w3c ? 'handle' : 'name';
     return this.driver_.schedule(
         new command.Command(command.Name.SWITCH_TO_WINDOW).
-            setParameter('name', nameOrHandle),
+            setParameter(paramName, nameOrHandle),
         'WebDriver.switchTo().window(' + nameOrHandle + ')');
   }
 ",I'd rather just send the parameter twice than break encapsulation here. There's already precedence with webelement IDs,js,1,1,1
"@@ -281,7 +281,7 @@ class Event {
 
       priv.dblClickTimeout[1] = setTimeout(() => {
         priv.dblClickOrigin[1] = null;
-      }, 500);
+      }, 1000);
     }
   }
 ","`1s` as a delay for double click for some users can be a huge difference. Especially when some of them have set (in the OS settings) short delays between clicks. In that case, the table can be perceived as standing out in behavior from the other components or so - which is bad. I wouldn't change that delay. Maybe rewriting it to use the native `dblclick` event could resolve the problem with the delay. Then the touch event could be supported differently? CC @wojciechczerniak",js,0,1,0
"@@ -37,9 +37,13 @@ function query(server, ns, cmd, cursorState, options, callback) {
 
   // If we have explain, we need to rewrite the find command
   // to wrap it in the explain command
-  const explain = Explain.fromOptions(options);
-  if (explain) {
-    findCmd = decorateWithExplain(findCmd, explain);
+  try {
+    const explain = Explain.fromOptions(options);
+    if (explain) {
+      findCmd = decorateWithExplain(findCmd, explain);
+    }
+  } catch (err) {
+    return callback(err);
   }
 
   // NOTE: This actually modifies the passed in cmd, and our code _depends_ on this","NODE-3377 Totally expanding scope here but we're validating too strictly here, this could be a quick fix that goes in this PR, we just need to assert string or boolean.",js,0,1,1
"@@ -133,6 +133,15 @@ storiesOf( 'Tag Manager Module/Settings', module )
 
 		return <Settings isOpen={ true } isEditing={ true } registry={ registry } />;
 	} )
+	.add( 'Edit, with ""Set up a new container""', ( registry ) => {
+		const webContainerVersion = fixtures.liveContainerVersions.web.gaWithVariable;
+		const accountID = webContainerVersion.accountId; // eslint-disable-line sitekit/camelcase-acronyms
+
+		registry.dispatch( STORE_NAME ).receiveGetAccounts( fixtures.accounts );
+		registry.dispatch( STORE_NAME ).receiveGetContainers( [], { accountID } );
+
+		return <Settings isOpen={ true } isEditing={ true } registry={ registry } />;
+	} )
 	.add( 'Edit, with all settings, with existing tag (with access)', ( registry ) => {
 		// eslint-disable-next-line sitekit/camelcase-acronyms
 		const accountID = fixtures.accounts[ 0 ].accountId;","Hah, just noticed that here (and elsewhere in this file) we're using `isOpen={ true }` rather than just `isOpen`. Hardly a big deal, but I'm surprised ESLint didn't warn us-I thought a lot of ESLint rules prefer boolean props to omit the `={ true }` part.  ",js,1,1,1
"@@ -12,12 +12,12 @@ var MongooseError = require('../error.js');
  */
 
 function MissingSchemaError (name) {
-  var msg = 'Schema hasn\'t been registered for model ""' + name + '"".\n'
-          + 'Use mongoose.model(name, schema)';
+  var msg = 'Schema hasn\'t been registered for document.\n'
+          + 'Use mongoose.Document(name, schema)';
   MongooseError.call(this, msg);
   Error.captureStackTrace && Error.captureStackTrace(this, arguments.callee);
   this.name = 'MissingSchemaError';
-};
+}
 
 /*!
  * Inherits from MongooseError.",Error message will be confusing on nodejs side. Perhaps we need a separate MissingSchemaError for client side.,js,1,1,1
"@@ -237,10 +237,6 @@ define([""appSettings"", ""browser"", ""events"", ""htmlMediaHelper"", ""webSettings""], f
             features.push(""voiceinput"");
         }
 
-        if (!browser.tv && !browser.xboxOne) {
-            browser.ps4;
-        }
-
         if (supportsHtmlMediaAutoplay()) {
             features.push(""htmlaudioautoplay"");
             features.push(""htmlvideoautoplay"");",What was this even doing?,js,1,0,0
"@@ -119,10 +119,10 @@ public class Standalone implements CliCommand {
       LoggingOptions loggingOptions = new LoggingOptions(config);
       loggingOptions.configureLogging();
 
-      LOG.info(""Logging configured."");
+      LOG.finest(""Logging configured."");
 
       DistributedTracer tracer = loggingOptions.getTracer();
-      LOG.info(""Using tracer: "" + tracer);
+      LOG.finest(""Using tracer: "" + tracer);
       GlobalDistributedTracer.setInstance(tracer);
 
       EventBusConfig events = new EventBusConfig(config);","Again. This is part of the start up of the server, and the diagnostics are helpful.",js,0,1,1
"@@ -33,13 +33,13 @@ export function createComponent(Ctor, props, context) {
 		inst;
 
 	if (Ctor.prototype && Ctor.prototype.render) {
-		inst = new Ctor(props, context);
+		inst = new /** @type {(props, context) => void} */(Ctor)(props, context);
 		Component.call(inst, props, context);
 	}
 	else {
 		inst = new Component(props, context);
 		inst.constructor = Ctor;
-		inst.render = doRender;
+		inst['render'] = doRender;
 	}
 
 ",This seems strange to me. @rbiggs Can you elaborate on the thinking behind it?,js,0,0,1
"@@ -113,6 +113,10 @@ class FsDriverRN extends FsDriverBase {
 		return RNFS.readFile(path, encoding);
 	}
 
+	async readDir(path) {
+		return RNFS.readDir(path).map(e => e.name);
+	}
+
 	// Always overwrite destination
 	async copy(source, dest) {
 		let retry = false;","As `readDirStats` can be used, we won't need this function anymore.",js,1,1,1
"@@ -43,6 +43,11 @@ color.propTypes = {
   ...bgColor.propTypes,
 }
 
+export const opacity = responsiveStyle({
+  prop: 'opacity',
+  alias: 'o',
+})
+
 // typography
 export const fontFamily = style({
   prop: 'fontFamily',","I think the shorthand should be removed; the existing shorthands are mostly meant for backwards compatibility, and I can't imagine `opacity` being used nearly enough to warrant a new shorthand",js,1,1,1
"@@ -106,7 +106,7 @@ public class BaseServer<T extends BaseServer> implements Server<T> {
       FilterHolder
           filterHolder = servletContextHandler.addFilter(CrossOriginFilter.class, ""/*"", EnumSet
           .of(DispatcherType.REQUEST));
-      filterHolder.setInitParameter(""allowedOrigins"", ""*"");
+      filterHolder.setInitParameter(""allowedMethods"", ""GET,POST,PUT,DELETE,HEAD"");
 
       // Warning user
       LOG.warning(""You have enabled CORS requests from any host. ""","Because the default value of allowedOrigins is * (all origins), so it isn't necessary to set again at all.",js,1,1,1
"@@ -225,7 +225,7 @@ class ColumnSorting extends BasePlugin {
 
     if (sortPossible) {
       const translateColumnToPhysical = ({ column: visualColumn, ...restOfProperties }) =>
-        ({ column: this.hot.toPhysicalColumn(visualColumn), ...restOfProperties });
+        ({ column: this.hot.renderedToPhysicalColumn(visualColumn), ...restOfProperties });
       const internalSortStates = arrayMap(destinationSortConfigs, columnSortConfig => translateColumnToPhysical(columnSortConfig));
 
       this.columnStatesManager.setSortStates(internalSortStates);","I don't see why this should be translated from `rendered` indexes. `sortConfig` should be consistent with any other public API and use visual indexes. Even if some columns are hidden they can be sorted from API, or sorted prior to hiding them.",js,1,1,1
"@@ -51,8 +51,11 @@
       };
     }
 
+    // IE 10 doesn’t support console.debug
+    var consoleDebug = console.debug || console.log
+
     console.log = customLog(console.log.bind(console), document.getElementById(""console-log""));
-    console.debug = customLog(console.log.bind(console), document.getElementById(""console-log""));
+    console.debug = customLog(consoleDebug.bind(console), document.getElementById(""console-log""));
     console.warn = customLog(console.warn.bind(console), document.getElementById(""console-log""));
     console.error = customLog(console.error.bind(console), document.getElementById(""console-log""));
   </script>","I guess we don't need `console.log =` here then, because `.debug` calls `.log` when needed? But it's a minor detail, it's not hurting anything.",js,1,1,1
"@@ -1,2 +1,9 @@
-/** Virtual DOM Node */
+/**
+ * Virtual DOM Node
+ * @typedef VNode
+ * @property {string | Function} nodeName The string of the DOM node to create or Component constructor to render
+ * @property {Array<VNode | string>} children The children of node
+ * @property {string | number | undefined} key The key used to identify this VNode in a list
+ * @property {object} attributes The properties of this VNode
+ */
 export function VNode() {}",We should use either `undefined` or `void` throughout all our docs,js,1,1,1
"@@ -1731,5 +1731,15 @@ $(document).ready(function() {
             app.addMenu(""management"", {code: ""plugins"", url: ""#/manage/plugins"", text: ""plugins.title"", icon: '<div class=""logo-icon fa fa-puzzle-piece""></div>', priority: 30});
         }
         app.addMenu(""management"", {code: ""configurations"", url: ""#/manage/configurations"", text: ""plugins.configs"", icon: '<div class=""logo-icon ion-android-options""></div>', priority: 40});
+
+        var isCurrentHostnameIP = /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(window.location.hostname);
+        if (!isCurrentHostnameIP && countlyGlobal.domain === """") {
+            countlyPlugins.updateConfigs({""api"": {""domain"": window.location.hostname}}, function(err) {
+                if (err) {
+                    // throw err
+                    console.log('An error has occurred: ', err);
+                }
+            });
+        }
     }
 });",Eslint was complaining about this line. Normally we do it like that: 1)If error happens after user action - we show styled notification. 2)If it happens in background - then we just ignore it silently. (So do not log it in console),js,1,1,1
"@@ -52,7 +52,8 @@ describe('preconditions', function() {
       $.checkArgumentType(1, PrivateKey);
     } catch (e) {
       error = e;
-      e.message.should.equal('Invalid Argument for (unknown name), expected PrivateKey but got number');
+      var fail = !(~e.message.indexOf('Invalid Argument for (unknown name)'));
+      fail.should.equal(false);
     }
     should.exist(error);
   });",what is `e.message` in other browsers? I'm worried this assertion is failing there,js,1,1,1
"@@ -5,7 +5,7 @@ if (ariaHeadingLevel !== null) {
 	return true;
 }
 
-var headingLevel = node.tagName.match(/H(\d)/);
+var headingLevel = node.nodeName.match(/H(\d)/);
 
 if (headingLevel) {
 	this.data(parseInt(headingLevel[1], 10));",do you need `toUpperCase()` here?,js,1,0,1
"@@ -19848,4 +19848,4 @@ var reactDom = ReactDOM$3.default || ReactDOM$3;
 
 return reactDom;
 
-})));
+})));",Why would this file have changed?,js,1,0,1
"@@ -55,6 +55,10 @@ var serverAccounting = false;
 var servers = {};
 var BSON = retrieveBSON();
 
+function topologyId(server) {
+  return server.s.parent == null ? server.id : server.s.parent.id;
+}
+
 /**
  * Creates a new Server instance
  * @class","is there ever a chance that `server.s` is null? Mu guess is no, but idk.",js,1,1,0
"@@ -32,7 +32,7 @@ const getFixer = () => {
  * The function `buildDependencyGetter` is the best place to care about that.
  *
  * @param {string} version The current selected documentation version.
- * @returns {function({dependency:string}):[string,string[],string]} [jsUrl, dependentVars[]?, cssUrl?].
+ * @returns {Function}
  */
 const buildDependencyGetter = (version) => {
   const { handsontableJs, handsontableCss, languagesJs } = getHotUrls(version);",Why this was changes? AFAIK it was correct,js,1,0,1
"@@ -52,10 +52,12 @@ function DashboardClicksWidget() {
 		const isDomainProperty = select( STORE_NAME ).isDomainProperty();
 		const referenceSiteURL = untrailingslashit( select( CORE_SITE ).getReferenceSiteURL() );
 
+		const dateRange = select( CORE_USER ).getDateRangeDates( { compare: true, offsetDays: 1 } );
 		const args = {
 			dimensions: 'date',
-			compareDateRanges: true,
-			dateRange: select( CORE_USER ).getDateRange(),
+			// Combine both date ranges into one single date range.
+			startDate: dateRange.compareStartDate,
+			endDate: dateRange.endDate,
 		};
 		const serviceBaseURLArgs = {
 			resource_id: propertyID,","Can you add a `DATE_RANGE_OFFSET` constant to `assets/js/modules/search-console/datastore/constants.js` and use that in all these locations? This way we put the offset for this module in one place, similarly how it was done for AdSense and Analytics in #2459.",js,0,1,1
"@@ -45,7 +45,10 @@ describe('Operation (Promises)', function() {
         var db = client.db(configuration.db);
         // LINE var MongoClient = require('mongodb').MongoClient,
         // LINE   test = require('assert');
-        // LINE MongoClient.connect('mongodb://localhost:27017/test', function(err, client) {
+        // LINE const client = new MongoClient('mongodb://localhost:27017/test');
+        // LINE client.connect().then(() => {
+        // LINE const client = new MongoClient('mongodb://localhost:27017/test');
+        // LINE client.connect().then(() => {
         // LINE   var db = client.db('test);
         // REPLACE configuration.writeConcernMax() WITH {w:1}
         // REMOVE-LINE done();",do you also need this repeated here?,js,1,0,1
"@@ -21,7 +21,7 @@ import options from '../options';
  * @param {import('../internal').Component | null} ancestorComponent The direct
  * parent component
  */
-export function diff(dom, parentDom, newVNode, oldVNode, context, isSvg, excessDomChildren, mounts, ancestorComponent) {
+export function diff(dom, parentDom, newVNode, oldVNode, context, isSvg, excessDomChildren, mounts, ancestorComponent, force) {
 
 	// If the previous type doesn't match the new type we drop the whole subtree
 	if (oldVNode==null || newVNode==null || oldVNode.type!==newVNode.type) {",The JSDoc block of `diff()` needs to be updated for the new parameter,js,1,1,1
"@@ -41,7 +41,7 @@ class MergedCellsCollection {
    * @return {String}
    */
   static IS_OVERLAPPING_WARNING(newMergedCell) {
-    return toSingleLine`The merged cell declared at [${newMergedCell.row}, ${newMergedCell.col}] overlaps with the other declared merged 
+    return toSingleLine`The merged cell declared at [${newMergedCell.row}, ${newMergedCell.col}] overlaps with the other declared merged
       cell. The overlapping merged cell was not added to the table, please fix your setup.`;
   }
 ","The space between ""merged"" and ""cell"" shouldn't be removed, after this change the warning contains merged words. `The merged cell declared at [29, 1] overlaps with the other declared mergedcell. The overlapping merged cell was not added to the table, please fix your setup.`",js,1,1,1
"@@ -74,7 +74,7 @@ function DateRangeSelector() {
 	const handleMenuItemSelect = useCallback( ( index ) => {
 		setDateRange( Object.values( ranges )[ index ].slug );
 		setMenuOpen( false );
-	}, [ handleMenu ] );
+	}, [ ranges, setDateRange ] );
 
 	const currentDateRangeLabel = ranges[ dateRange ]?.label;
 	const menuItems = Object.values( ranges ).map( ( range ) => range.label );","Shame, I'd have expected it to know the dispatch functions (eg `setDateRange`) shouldn't ever change. Maybe it's only smart enough to do that with actual Redux and not WP Data. But it's no biggie!  ",js,1,1,1
"@@ -0,0 +1,11 @@
+const path = require('path');
+
+module.exports = {
+	mode: 'development',
+  watch: true,
+	entry: './lib/index.js',
+	output: {
+		path: path.resolve(__dirname, 'dist'),
+		filename: 'axe.js'
+	}
+};","Please feel free to suggest / write a better Webpack config, I'm still new to it.",js,0,0,1
"@@ -90,3 +90,18 @@ Blockly.Blocks['math_positive_number'] = {
     this.setOutputShape(Blockly.OUTPUT_SHAPE_ROUND);
   }
 };
+
+Blockly.Blocks['math_angle'] = {
+  /**
+   * Block for angle picker.
+   * @this Blockly.Block
+   */
+  init: function() {
+    this.setHelpUrl(Blockly.Msg.MATH_NUMBER_HELPURL);
+    this.setColour(Blockly.Blocks.math.HUE);
+    this.appendDummyInput()
+        .appendField(new Blockly.FieldAngle('90'), 'NUM');
+    this.setOutput(true, 'Number');
+    this.setOutputShape(Blockly.OUTPUT_SHAPE_ROUND);
+  }
+};",Prefer jsonInit--everything here should be doable with json.,js,1,1,1
"@@ -231,3 +231,6 @@ export UtilityIcon from './utilities/utility-icon';
 
 export SLDSTree from './tree';
 export Tree from './tree';
+
+// Library utilities
+export log from '../utilities/log';",what is this export used for?,js,1,1,1
"@@ -86,7 +86,7 @@ global._googlesitekitBaseData = {
 	blogPrefix: 'wp_',
 	ampMode: false,
 	isNetworkMode: false,
-	isFirstAdmin: true,
+	isOwner: true,
 	splashURL: 'http://example.com/wp-admin/admin.php?page=googlesitekit-splash',
 	proxySetupURL: 'https://sitekit.withgoogle.com/site-management/setup/?scope=openid%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fsiteverification%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fwebmasters%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fanalytics%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fanalytics.readonly%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fanalytics.manage.users%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fanalytics.edit&supports=credentials_retrieval%20short_verification_token%20file_verification&nonce=&site_id=storybooksiteid.apps.sitekit.withgoogle.com',
 	proxyPermissionsURL: 'https://sitekit.withgoogle.com/site-management/permissions/?token=storybooktoken&site_id=storybooksiteid.apps.sitekit.withgoogle.com',",This should probably be kept since it's currently included in `_googlesitekitBaseData`.,js,1,1,1
"@@ -0,0 +1,4 @@
+const title = virtualNode.children.find(({ props }) => {
+	return props.nodeName === 'title';
+});
+return !!title && title.actualNode.textContent.trim() !== '';",Minor nitpick: `title` is a bit confusing as I though it was the actual text of the title and not the virtualNode of the `title` element.,js,1,1,1
"@@ -123,6 +123,17 @@ exports.utils = require('./utils.js');
  */
 exports.Document = DocumentProvider();
 
+/**
+ * function stub for model
+ *
+ * @method model
+ * @api public
+ * @return {object} an empty object
+ */
+exports.model = function() {
+  return {};
+};
+
 /*!
  * Module exports.
  */",Why not `return null` or something like that? I'm hesitant to just return an empty object because then it will have an inconsistent and incompatible return type vs `model()` in server land.,js,1,1,1
"@@ -9,6 +9,8 @@ const Note = require('lib/models/Note.js');
 const Resource = require('lib/models/Resource.js');
 const urlValidator = require('valid-url');
 const { _ } = require('lib/locale.js');
+const http = require('http');
+const https = require('https');
 
 function shimInit() {
 	shim.fsDriver = () => {",These 2 lines can only be run when not on on mobile.,js,1,0,1
"@@ -7,11 +7,13 @@ import { diff, mounts, diffLevel, flushMounts, recollectNodeTree, removeChildren
 import { createComponent, collectComponent } from './component-recycler';
 import { removeNode } from '../dom/index';
 
-/** Set a component's `props` (generally derived from JSX attributes).
- *	@param {Object} props
- *	@param {Object} [opts]
- *	@param {boolean} [opts.renderSync=false]	If `true` and {@link options.syncComponentUpdates} is `true`, triggers synchronous rendering.
- *	@param {boolean} [opts.render=true]			If `false`, no render will be triggered.
+/**
+ * Set a component's `props` and possibly re-render the component
+ * @param {import('../component').Component} component The Component to set props on
+ * @param {object} props The new props
+ * @param {number} opts Render options - specifies how to re-render the component
+ * @param {object} context The new context
+ * @param {boolean} mountAll Whether or not to immediately mount all components
  */
 export function setComponentProps(component, props, opts, context, mountAll) {
 	if (component._disable) return;",Makes we wonder if we should rename `opts` to something like `render mode` or something similar.,js,1,1,1
"@@ -156,6 +156,12 @@ class FsDriverRN extends FsDriverBase {
 		handle.offset += length;
 		return output ? output : null;
 	}
+
+	async fileSize(filePath) {
+		const stats = await RNFetchBlob.fs.stat(filePath);
+		return stats.size;
+	}
+
 }
 
 module.exports.FsDriverRN = FsDriverRN;","Same, you don't need to create a new method, you can simply use the existing `stat()` method.",js,0,1,1
"@@ -216,6 +216,18 @@ describe( 'modules/analytics properties', () => {
 				expect( registry.stores[ STORE_NAME ].store.getState().primaryPropertyType ).toBe( type );
 			} );
 		} );
+
+		describe( 'matchPropertyByURL', () => {
+			it( 'should return a correct property that has matching website URL', async () => {
+				const property = await registry.dispatch( STORE_NAME ).matchPropertyByURL( fixtures.propertiesProfiles.properties, 'http://wrhwh.com' );
+				expect( property ).toEqual( fixtures.propertiesProfiles.properties[ 0 ] );
+			} );
+
+			it( 'should return NULL when URL does not match', async () => {
+				const property = await registry.dispatch( STORE_NAME ).matchPropertyByURL( fixtures.propertiesProfiles.properties, 'http://wrongsite.com' );
+				expect( property ).toBeNull();
+			} );
+		} );
 	} );
 
 	describe( 'selectors', () => {",I'd prefer not to use the fixture here if we can as it makes it harder to understand; can we create a little property factory here as a helper so we can see which properties+URLs are involved? Perhaps we should also add a case or two to show that it matches with URL normalization as well?,js,1,1,1
"@@ -54,6 +54,8 @@ describe('Aggregation', function () {
         var collection = db.collection('shouldCorrectlyExecuteSimpleAggregationPipelineUsingArray');
         // Insert the docs
         collection.insertMany(docs, { w: 1 }, function (err, result) {
+          if (err) console.dir(err);
+
           expect(result).to.exist;
           expect(err).to.not.exist;
 ",Is this `console.dir` left over from debugging something?,js,1,1,1
"@@ -837,7 +837,18 @@ class WebDriver(object):
             del png
         return True
 
-    save_screenshot = get_screenshot_as_file
+    def save_screenshot(self, filename):
+        """"""
+        Gets the screenshot of the current window. Returns False if there is
+           any IOError, else returns True. Use full paths in your filename.
+
+        :Args:
+         - filename: The full path you wish to save your screenshot to.
+
+        :Usage:
+            driver.save_screenshot('/Screenshots/foo.png')
+        """"""
+        return self.get_screenshot_as_file(self, filename)
 
     def get_screenshot_as_png(self):
         """"""",This needs to be just return self.get_screenshot_as_file(filename),js,1,1,1
"@@ -435,7 +435,7 @@ describe('ReadConcern', function() {
   });
 
   it('Should set majority readConcern aggregate command but ignore due to out', {
-    metadata: { requires: { topology: 'replicaset', mongodb: '>= 3.2' } },
+    metadata: { requires: { topology: 'replicaset', mongodb: '>= 3.2 < 4.1' } },
 
     test: function(done) {
       var listener = require('../..').instrument(function(err) {",I didn't realize we could do this!,js,1,0,1
"@@ -607,8 +607,8 @@ function decorateWithCollation(command, target, options) {
  * @param {object} command the command on which to apply the read concern
  * @param {Collection} coll the parent collection of the operation calling this method
  */
-function decorateWithReadConcern(command, coll) {
-  let readConcern = Object.assign({}, command.readConcern || {});
+function decorateWithReadConcern(command, coll, options) {
+  let readConcern = Object.assign({}, command.readConcern || (options ? options.readConcern : {}));
   if (coll.s.readConcern) {
     Object.assign(readConcern, coll.s.readConcern);
   }",I think you can just do `options ? options.readConcern : undefined` to reduce the extra needless allocation,js,1,1,1
"@@ -14,11 +14,12 @@ class Handle {
     /** constructor **/
     constructor() {
         log.i('Starting job handle in %d', process.pid);
-        this.db = manager.singleDefaultConnection();
-        this.classes = {}; // {'job name': Constructor}
-        this.files = {}; // {'ping': '/usr/local/countly/api/jobs/ping.js'}
-        scan(this.db, this.files, this.classes);
-
+        manager.singleDefaultConnection().then((db) => {
+            this.db = db;
+            this.classes = {}; // {'job name': Constructor}
+            this.files = {}; // {'ping': '/usr/local/countly/api/jobs/ping.js'}
+            scan(this.db, this.files, this.classes);
+        });
     }
 
     /**",Why do we still need `manager.singleDefaultConnection`?,js,1,1,1
"@@ -77,8 +77,8 @@ public class LocalNewSessionQueuer extends NewSessionQueuer {
   }
 
   @Override
-  public Optional<HttpRequest> remove() {
-    return sessionRequests.poll();
+  public Optional<HttpRequest> remove(RequestId id) {
+    return sessionRequests.poll(id);
   }
 
   @Override",`poll` and `remove` have different meanings.,js,1,0,1
"@@ -0,0 +1,14 @@
+/**
+ * External dependencies
+ */
+import { storiesOf } from '@storybook/react';
+
+/**
+ * Internal dependencies
+ */
+import UserInputApp from '../assets/js/components/user-input/UserInputApp';
+
+storiesOf( 'User Input', module )
+	.add( 'User Input Page', () => {
+		return <UserInputApp />;
+	} );","While this component doesn't use the datastore yet since it's just scaffolded, let's already wrap this in a `WithDataRegistry` component, to which we can pass a default registry created via `createTestRegistry()`.",js,1,1,1
"@@ -1,8 +1,12 @@
 import { options, Fragment, Component } from 'preact';
 
 export function initDevTools() {
-	if (typeof window != 'undefined' && window.__PREACT_DEVTOOLS__) {
-		window.__PREACT_DEVTOOLS__.attachPreact('10.4.1', options, {
+	const hook =
+		typeof window != 'undefined' &&
+		(window.__PREACT_DEVTOOLS__ || window.parent.__PREACT_DEVTOOLS__);
+
+	if (hook) {
+		hook.attachPreact('10.4.1', options, {
 			Fragment,
 			Component
 		});","kinda wondering if we could import the version from `package.json` and then inline during build, but not relevant for this PR",js,0,1,1
"@@ -5,7 +5,7 @@ describe('color-contrast code highlighting test', function() {
   function run(done) {
     axe.run(
       '#fixture',
-      { runOnly: { type: 'rule', values: ['color-contrast'] } },
+      { runOnly: { type: 'rule', values: ['color-contrast-enhanced', 'color-contrast'] } },
       function(err, r) {
         assert.isNull(err);
         results = r;","For clarity, I prefer we give color-contrast-enhanced its own set of integration tests, focused specifically on showing the higher contrast values are properly applied. This PR has no test that shows that a test with 6:1 fails this rule for example.",js,0,1,1
"@@ -556,14 +556,15 @@ describe('Cursor', function() {
           }
 
           function finished() {
-            collection.find(function(err, cursor) {
-              test.equal(null, err);
+            (function() {
+              const cursor = collection.find();
+
               test.throws(function() {
                 cursor.each();
               });
 
               client.close(done);
-            });
+            })();
           }
 
           insert(function() {",Why the IIFEs here? Are you trying to control variables? They should be lexically scoped since you're using `const`,js,1,1,1
"@@ -19,4 +19,6 @@ exports.Date = require('./date');
 
 exports.ObjectId = require('./objectid');
 
+exports.ObjectId = require('./dbref');
+
 exports.Mixed = require('./mixed');",Should be `exports.DBRef` i guess.,js,1,0,1
"@@ -108,7 +108,7 @@ exports.getRequestPath = (item) => {
   } else if (item.file_type) {
     return `${encodeURIComponent(item.meeting_id)}?recordingId=${encodeURIComponent(item.id)}`
   }
-  return `${encodeURIComponent(item.uuid)}`
+  return `${encodeURIComponent(encodeURIComponent(item.uuid))}`
 }
 
 exports.getStartDate = (item) => {",what kind of files does the `uuid` case match? Can we just always send `item.id` instead?,js,1,1,1
"@@ -91,7 +91,7 @@ export default function AdsConversionIDTextField() {
 			</TextField>
 
 			<p>
-				{ __( 'Insert your Ads Conversion ID here if you want Site Kit to place the snippet on your site', 'google-site-kit' ) }
+				{ __( 'If you’re using Google Ads, insert your Ads conversion ID if you’d like Site Kit to place the snippet on your site', 'google-site-kit' ) }
 			</p>
 		</div>
 	);","@felixarntz looks like maybe a good place to add a ""Learn more"" link - what do you think?",js,0,1,1
"@@ -198,7 +198,7 @@ public class LocalDistributor extends Distributor {
       Host host = new Host(bus, node);
       host.update(status);
       hosts.add(host);
-      LOG.info(String.format(""Added node %s."", node.getId()));
+      LOG.finest(String.format(""Added node %s."", node.getId()));
       host.runHealthCheck();
 
       Runnable runnable = host::runHealthCheck;",This change is incorrect.,js,1,0,1
"@@ -20,7 +20,7 @@ module.exports = function castBulkWrite(originalModel, op, options) {
       const model = decideModelByObject(originalModel, op['insertOne']['document']);
 
       const doc = new model(op['insertOne']['document']);
-      if (model.schema.options.timestamps != null) {
+      if (doc.initializeTimestamps) {
         doc.initializeTimestamps();
       }
       if (options.session != null) {",Shouldn't this be `if (model.schema.options.timestamps)` ?,js,1,1,1
"@@ -50,6 +50,8 @@ export default function SetupFormGA4() {
 	const { setValues } = useDispatch( CORE_FORMS );
 	const { setUseSnippet } = useDispatch( MODULES_ANALYTICS_4 );
 
+	const shouldShowAssociatedPropertyNotice = useSelect( ( select ) => select( MODULES_ANALYTICS_4 ).getPropertyID() );
+
 	useMount( () => {
 		selectProperty( PROPERTY_CREATE );
 		setValues( FORM_SETUP, { profileName: _x( 'All Web Site Data', 'default Analytics view name', 'google-site-kit' ) } );","We may want to actually assign this to a `ga4Property` variable first and then include the same conditions as below `accountID && accountID !== ACCOUNT_CREATE && ga4PropertyID`. These should be consistent between all three scenarios: 1. UA scenario: require account not empty and not create, and require UA property not empty 2. GA4 scenario: require account not empty and not create, and require GA4 property not empty 3. GA4-transitional scenario: require account not empty and not create, and require UA property _or_ GA4 property not empty",js,1,1,0
"@@ -1,2 +1,3 @@
 var parent = axe.commons.dom.getComposedParent(node);
-return parent.nodeName.toUpperCase() === 'DL';
+return parent.nodeName.toUpperCase() === 'DL' && !parent.getAttribute('role');
+","Should this allow `<dl role=""list"">`?",js,1,1,1
"@@ -0,0 +1,2 @@
+var mains = document.querySelectorAll('main,[role=main]');
+return mains.length<=1;","As above, use `axe.utils.querySelectorAll` instead, so you can query shadow DOM trees.",js,1,1,1
"@@ -0,0 +1,12 @@
+/**
+ * Restores var names transformed by babel's let block scoping
+ */
+export default (file, api) => {
+	let j = api.jscodeshift;
+	let code = j(file.source);
+
+	code.findVariableDeclarators().filter(d => /^_i/.test(d.value.id.name)).renameTo('i');
+	code.findVariableDeclarators('_key').renameTo('key');
+
+	return code.toSource({ quote: 'single' });
+};","Slight chance this might collide with other variables, right? It's okay if it does, just wasn't sure if it was doing scope analysis to avoid it.",js,1,1,1
"@@ -272,8 +272,9 @@ Blockly.Msg.CATEGORY_EVENTS = 'Events';
 Blockly.Msg.CATEGORY_CONTROL = 'Control';
 Blockly.Msg.CATEGORY_SENSING = 'Sensing';
 Blockly.Msg.CATEGORY_OPERATORS = 'Operators';
-Blockly.Msg.CATEGORY_VARIABLES = 'Variables';
+Blockly.Msg.CATEGORY_VARIABLES = 'Data';
 Blockly.Msg.CATEGORY_MYBLOCKS = 'My Blocks';
+Blockly.Msg.CATEGORY_EXTENSIONS = 'Extensions';
 
 // Context menus
 Blockly.Msg.DUPLICATE = 'Duplicate';","This is the label that translators are currently translating, and in Scratch 3.0 it should be 'Variables', so we shouldn't change this value.",js,1,1,1
"@@ -0,0 +1,11 @@
+import React from 'react';
+import ReactDOM from 'react-dom';
+import './index.css';
+import App from './App';
+
+ReactDOM.render(
+  <React.StrictMode>
+    <App />
+  </React.StrictMode>,
+  document.getElementById('root')
+);","@jansiegel Should we remove StrictMode? This will trigger a warning with our current wrapper and ""UNSAFE"" use",js,0,1,1
"@@ -95,7 +95,7 @@ class Uppy {
       meta: Object.assign({}, this.opts.meta),
       info: {
         isHidden: true,
-        type: '',
+        type: 'info',
         msg: ''
       }
     }",This property name was changed to `message` further down but not here,js,1,1,1
"@@ -185,8 +185,8 @@ function mountDOMElement(dom, internal, globalContext, isSvg, commitQueue) {
 			if (!isHydrating && newHtml.__html) {
 				dom.innerHTML = newHtml.__html;
 			}
-			internal._children = [];
-		} else if ((i = internal.props.children) != internal._children) {
+			internal._children = null;
+		} else if ((i = internal.props.children) != null) {
 			mountChildren(
 				dom,
 				Array.isArray(i) ? i : [i],","When mounting, `internal._children` is always `null` at this point since `mountChildren` hasn't been called on this internal yet. So this condition was only true when `props.children == null`. So I simplified this check to just use `null` directly. Also, there isn't a reason to have this check in `patch` cuz `props.children` is always an array VNodes and `internal._children` is always an array of Internals so they will never be equal.",js,1,1,1
"@@ -71,6 +71,8 @@ export default class Realm {
 
         [
             'path',
+            'readOnly',
+            'schema',
             'schemaVersion',
         ].forEach((name) => {
             Object.defineProperty(this, name, {get: util.getterForProperty(name)});",I think `readonly` would be nicer IMHO,js,1,1,1
"@@ -24,12 +24,16 @@ const test = (suite, buildConfig = config.defaultBuildConfig, options) => {
   config.update(options)
 
   const braveArgs = [
-    '--enable-logging'
+    '--enable-logging=stderr'
   ]
 
   // Android doesn't support --v
   if (config.targetOS !== 'android') {
     braveArgs.push('--v=' + options.v)
+
+    if (options.vmodule) {
+      braveArgs.push('--vmodule=' + options.vmodule)
+    } 
   }
 
   if (options.filter) {",logs are only exposed if test fails,js,1,0,1
"@@ -1122,6 +1122,7 @@ define([""playbackManager"", ""dom"", ""inputManager"", ""datetime"", ""itemHelper"", ""med
                     }
                     break;
                 case ""k"":
+                case ""Space"":
                     playbackManager.playPause(currentPlayer);
                     showOsd();
                     break;","Not directly related to this PR, but why is this K instead of something sensible like P ? (I get that JKL are homerow, next to each other and all, but for discovery by most users, K makes no sense)",js,0,1,1
"@@ -52,12 +52,8 @@ addFilter(
 	fillFilterWithComponent( DashboardZeroData )
 );
 
-let isAdBlockerActive = () => {};
-
 export const registerStore = ( registry ) => {
 	registerDatastore( registry );
-	// TODO: fix hack
-	isAdBlockerActive = () => registry.__experimentalResolveSelect( STORE_NAME ).isAdBlockerActive();
 };
 
 export const registerModule = ( modules ) => {",The `registerStore` function can be re-exported directly from `datastore` now rather than aliasing to add this hack. See other stores for how this looks like.,js,1,1,1
"@@ -1,3 +1,5 @@
+export const root = typeof window === 'undefined' ? global : window;
+
 /** Copy own-properties from `props` onto `obj`.
  *	@returns obj
  *	@private","I was getting ""window is undefined"" errors. I couldn't see a convention around this in the source, though.",js,1,1,1
"@@ -62,6 +62,7 @@ goog.require('Blockly.inject');
 goog.require('Blockly.utils');
 goog.require('goog.color');
 
+goog.require('Blockly.ScratchMsgs');
 
 // Turn off debugging when compiled.
 /* eslint-disable no-unused-vars */",Move this between `ggog.require('Blockly.Procedures');` and `goog.require('Blockly.Toolbox');`,js,1,1,1
"@@ -48,9 +48,9 @@ import { Cell, Row } from '../../material-components';
 import { trackEvent } from '../../util';
 const { useSelect, useDispatch } = Data;
 
-export default function UserInputQuestionnaire() {
-	const steps = [ ...USER_INPUT_QUESTIONS_LIST, 'preview' ];
+const steps = [ ...USER_INPUT_QUESTIONS_LIST, 'preview' ];
 
+export default function UserInputQuestionnaire() {
 	const [ activeSlug, setActiveSlug ] = useQueryArg( 'question', steps[ 0 ] );
 	const [ shouldScrollToActiveQuestion, setShouldScrollToActiveQuestion ] = useState( false );
 	const [ redirectURL ] = useQueryArg( 'redirect_url' );",move out of component so does not become a dynamic dependency,js,1,1,1
"@@ -415,7 +415,7 @@ exports[""should correctly connect to mongodb using domain socket""] = {
   // The actual test we wish to run
   test: function(configuration, test) {
     var MongoClient = configuration.require.MongoClient;
-    MongoClient.connect('mongodb:///tmp/mongodb-27017.sock/test', function(err, client) {
+    MongoClient.connect('mongodb://%2Ftmp%2Fmongodb-27017.sock/test', function(err, client) {
       test.equal(null, err);
       test.done();
     });","what's going on here? I don't think its correct that we require users to escape their own local domain socket paths, are you saying it doesn't pass the connection string tests to do so? We might need to file a spec ticket against that then",js,1,1,1
"@@ -190,6 +190,16 @@ Blockly.WorkspaceSvg.prototype.startScrollY = 0;
  */
 Blockly.WorkspaceSvg.prototype.dragDeltaXY_ = null;
 
+/***
+ * Distance to scroll when a mouse wheel event is received and
+ * its delta mode is line (0x1) instead of pixel (0x0). In these
+ * cases, a single ""scroll"" has a delta of 1, which makes the
+ * workspace scroll very slowly (just one pixel). To compensate,
+ * that delta is multiplied by this value.
+ * @type {number}
+ */
+Blockly.WorkspaceSvg.prototype.lineScrollMultiplier = 15;
+
 /**
  * Current scale.
  * @type {number}","Is there a better place to put this constant, or is putting it here right?",js,1,1,1
"@@ -1,10 +1,8 @@
 import { run } from '@ember/runloop';
-import { getOwner } from '@ember/application';
 import { hash } from 'rsvp';
 import Service, { inject as service } from '@ember/service';
 import Ember from 'ember';
 import config from '../config/environment';
-import { walkConfigs, setRTL } from '../utils/locale-utils';
 
 export const DEFAULT_LANGUAGE = config.intl.defaultLocale || 'en';
 ",These were removed along with the corresponding files since they don't relate to `ember-intl` anymore and were caught in my find/replace for `ember-i18n` to `ember-intl`. Is there a way I can verify that RTL is working properly with `ember-intl` in the same way it was before with `ember-i18n`?,js,1,1,1
"@@ -1118,7 +1118,7 @@ window.ConfigurationsView = countlyView.extend({
             return input;
         }
         else if (typeof value === ""number"") {
-            return ""<input type='number' id='"" + id + ""' value='"" + value + ""' max='2147483647' min='0' onkeyup='this.value= (parseInt(this.value) > 2147483647) ? 2147483647 : this.value;'/>"";
+            return ""<input type='number' id='"" + id + ""' value='"" + value + ""'/>"";
         }
         else {
             return ""<input type='text' id='"" + id + ""' value='"" + value + ""'/>"";",I think we agreed to leave this one,js,0,0,1
"@@ -36,7 +36,7 @@ export default AbstractEditController.extend({
 
     showDeleteItem(item) {
       let i18n = get(this, 'i18n');
-      let message = i18n.t('incident.messages.deleteItem');
+      let message = i18n.t('messages.delete_singular', { name: 'item' });
       let title = i18n.t('incident.titles.deleteItem');
       this.displayConfirm(title, message, 'deleteItem', Ember.Object.create({
         itemToDelete: item",This code is passing a non localized string when it should be passing in a localized string or it should use the name of the item being deleted.,js,1,1,1
"@@ -228,6 +228,18 @@ var request = require(""request"");
         options.db.collection(""long_tasks"").findOne({_id:options.id}, callback);
     };
     
+    /**
+    * Edit specific task
+    * @param {object} options - options for the task
+    * @param {object} options.db - database connection
+    * @param {object} options.task_id - ID of the target task 
+    * @param {string} options.data - data of the task want to modify
+    */
+    taskmanager.editTask = function(options, callback){
+        options.db = options.db || common.db;
+        options.db.collection(""long_tasks"").update({_id: options.task_id}, {$set: options.data}, callback);
+    };
+    
     /**
     * Check task's status
     * @param {object} options - options for the task","Let's keep parameter naming consistent with other methods, like `saveResult`, so not task_id, but id, etc",js,1,1,1
"@@ -154,7 +154,7 @@ module.exports = class Tus extends Plugin {
       }
 
       optsTus.onSuccess = () => {
-        this.uppy.emit('upload-success', file, upload, upload.url)
+        this.uppy.emit('upload-success', file, null, upload.url)
 
         if (upload.url) {
           this.uppy.log('Download ' + upload.file.name + ' from ' + upload.url)",we can drop the upload.urls here and instead pass an object that contains the `uploadURL` like in xhrupload,js,1,1,1
"@@ -574,8 +574,15 @@ define(['appSettings', 'userSettings', 'playbackManager', 'connectionManager', '
 
             events.trigger(instance, ""playbackstop"", [state]);
 
+            var state = instance.lastPlayerData.PlayState || {};
+            var volume = state.VolumeLevel;
+            var mute = state.IsMuted;
+
             // Reset this so the next query doesn't make it appear like content is playing.
             instance.lastPlayerData = {};
+            instance.lastPlayerData.PlayState = {};
+            instance.lastPlayerData.PlayState.VolumeLevel = volume;
+            instance.lastPlayerData.PlayState.IsMuted = mute;
         });
 
         events.on(instance._castPlayer, ""playbackprogress"", function (e, data) {",should we add a default like `|| 0.5`?.. and `false` to `mute`?,js,1,1,1
"@@ -24,7 +24,7 @@ class ChromiumService(service.Service):
     """"""
 
     def __init__(self, executable_path, port=0, service_args=None,
-                 log_path=None, env=None, start_error_message=None):
+                 log_path=None, env=None, start_error_message=None, create_no_window=False):
         """"""
         Creates a new instance of the Service
 ",This would be better served as a method/property that is set when people don't want to a window.,js,1,1,1
"@@ -19,6 +19,7 @@ import getHours from ""date-fns/getHours"";
 import getDay from ""date-fns/getDay"";
 import getDate from ""date-fns/getDate"";
 import dfgetWeek from ""date-fns/getWeek"";
+import getISOWeek from ""date-fns/getISOWeek"";
 import getMonth from ""date-fns/getMonth"";
 import getQuarter from ""date-fns/getQuarter"";
 import getYear from ""date-fns/getYear"";",Is this still being used?,js,1,0,1
"@@ -86,7 +86,7 @@ Mongoose.prototype.STATES = STATES;
  * Currently supported options are:
  * - 'debug': prints the operations mongoose sends to MongoDB to the console
  * - 'bufferCommands': enable/disable mongoose's buffering mechanism for all connections and models
- * - 'useFindAndModify': true by default. Set to `false` to make `findOneAndUpdate()` and `findOneAndRemove()` use native `findOneAndUpdate()` rather than `findAndModify()`.
+ * - 'useFindAndModify': false by default. Set to `true` to make `findOneAndUpdate()` and `findOneAndRemove()` use legacy `findAndModify()` rather than native methods`.
  * - 'cloneSchemas': false by default. Set to `true` to `clone()` all schemas before compiling into a model.
  * - 'applyPluginsToDiscriminators': false by default. Set to true to apply global plugins to discriminator schemas. This typically isn't necessary because plugins are applied to the base schema and discriminators copy all middleware, methods, statics, and properties from the base schema.
  * - 'objectIdGetter': true by default. Mongoose adds a getter to MongoDB ObjectId's called `_id` that returns `this` for convenience with populate. Set this to false to remove the getter.","I'm wary of changing `useFindAndModify` to false by default in a minor release, especially in light of the issue with `overwrite: true` that you found. I was not aware of that difference, which makes me wonder if there are other compatibility concerns that we're missing.",js,1,1,1
"@@ -22,6 +22,7 @@ from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
 
 
 class Options(object):
+    KEY = ""goog:chromeOptions""
 
     def __init__(self):
         self._binary_location = ''",nice touch since Google likes to change things every now and then.,js,1,0,1
"@@ -287,6 +287,10 @@ function operand (self, where, delta, data, val, op) {
   // disabled versioning?
   if (false === self.schema.options.versionKey) return;
 
+  // path excluded from versioning
+  var notVersionedPaths = self.schema.options.notVersionedPaths;
+  if (notVersionedPaths && notVersionedPaths.indexOf(data.path) >= 0) return;
+
   // already marked for versioning?
   if (VERSION_ALL === (VERSION_ALL & self.$__.version)) return;
 ","IMO `notVersionedPaths` should be stored as a map, no sense in storing it as an array if you only use it for lookups",js,1,1,1
"@@ -24,6 +24,8 @@ import isPlainObject from 'lodash/isPlainObject';
 // Export codes and reasons.
 export const ERROR_CODE_MISSING_REQUIRED_SCOPE = 'missing_required_scopes'; // When scopes are missing.
 export const ERROR_REASON_INSUFFICIENT_PERMISSIONS = 'insufficientPermissions';
+export const ERROR_CODE_INSUFFICIENT_MODULE_DEPENDENCIES = 'insufficient_module_dependencies';
+export const ERROR_CODE_ADBLOCKER_ACTIVE = 'adblocker_active';
 
 /**
  * Checks if the provided object is an instance of WP_Error class.","I think it'd be more appropriate to define these in the areas where they're used. The first one could go into `assets/js/googlesitekit/modules/datastore/constants.js`, the latter into a new `assets/js/modules/adsense/constants.js`?",js,1,1,1
"@@ -163,4 +163,16 @@ describe('Key', function() {
     });
   });
 
+  describe('bug in linux', function() {
+    it.only('should assign private key properly', function(){
+      var key = new Key();
+      var hex = '00ee983aa0421869418db3c50646728ce67db5a49d6cd853855854ae63fe7bce';
+      var pk = new Buffer(hex, 'hex');
+      pk.toString('hex').should.equal(hex);
+      key.private = pk;
+      key.private.toString('hex').should.equal(hex);
+
+    });
+  });
+
 });","The description here should probably read ""should assign private key starting with 0 properly""",js,1,1,1
"@@ -0,0 +1,3 @@
+module.exports.spliceURL = function spliceURL() {
+  return Array.from(arguments).reduce((lastResult, current) => lastResult + current).replace(/([^:])(\/)+(.)/g, `$1/$3`);
+};",Why use arguments instead normal parameters?,js,1,1,0
"@@ -90,10 +90,11 @@ export const createInfoStore = ( slug, {
                                 return undefined;
                         }
 
-                        const noSetupQueryArgs = ! requiresSetup ? {
-                                notification: 'authentication_success',
-                                reAuth: undefined,
-                        } : {};
+                        const noSetupQueryArgs = {};
+                        if ( ! requiresSetup && reAuth === true ) {
+                                noSetupQueryArgs.notification = 'authentication_success';
+                                noSetupQueryArgs.reAuth = undefined;
+                        }
 
                         const redirectURL = select( storeName ).getAdminScreenURL( { slug, reAuth, ...noSetupQueryArgs } );
                         if ( redirectURL === undefined ) {","If this fixes something that wasn't working properly, please update `create-info-store.test.js`.",js,1,1,1
"@@ -60,6 +60,8 @@ describe('axe.utils.parseCrossOriginStylesheet', function() {
 	});
 
 	it('rejects when given url to fetch is not found', function(done) {
+		this.timeout(6000);
+
 		var importUrl =
 			'https://make-up-a-website-that-does-not-exist.com/style.css';
 		var options = {",Test needs to pass the `preload.timeout` option,js,1,1,1
"@@ -51,7 +51,10 @@ const getConfigFromEnv = () => {
       },
       zoom: {
         key: process.env.COMPANION_ZOOM_KEY,
-        secret: getSecret('COMPANION_ZOOM_SECRET')
+        secret: getSecret('COMPANION_ZOOM_SECRET'),
+        custom: {
+          verificationToken: getSecret('COMPANION_ZOOM_VERIFICATION_TOKEN')
+        }
       },
       s3: {
         key: process.env.COMPANION_AWS_KEY,","`verificationToken` is a required option, right? can we put it on the `zoom` options object itself instead of inside `custom`?",js,1,1,1
"@@ -1,3 +1,19 @@
+function createContentHidden() {
+	'use strict';
+	var group = document.createElement('div');
+	group.innerHTML = '<label id=""mylabel"">Label</label><input aria-labelledby=""mylabel"" type=""text"" />';
+	return group;
+}
+
+function makeShadowTreeHidden(node) {
+	'use strict';
+	var root = node.attachShadow({mode: 'open'});
+	var div = document.createElement('div');
+	div.className = 'parent';
+	root.appendChild(div);
+	div.appendChild(createContentHidden());
+}
+
 describe('axe.utils.isHidden', function () {
 	'use strict';
 ","What makes this tree hidden? I don't see any special CSS that would hide it, or a closed mode. I do see `display: none` in the test, perhaps it's just a confusing function name?",js,1,1,1
"@@ -66,7 +66,7 @@ describe('liftFN', function() {
     );
   });
 
-  it('retain order of arguments', function() {
+  it('retains order of arguments', function() {
     assert.isTrue(
       R.equals(
         RA.liftFN(3, add3)(Maybe.Some('a'), Maybe.Some('b'), Maybe.Some('c')),",should retain order of arguments,js,1,1,1
"@@ -74,7 +74,7 @@ public class SeleniumServer extends JettyServer {
           getClass().getClassLoader())
           .asSubclass(Routable.class);
       Constructor<? extends Routable> constructor = rcHandler.getConstructor(ActiveSessions.class);
-      LOG.info(""Bound legacy RC support"");
+      LOG.finest(""Bound legacy RC support"");
       return constructor.newInstance(sessions);
     } catch (ReflectiveOperationException e) {
       // Do nothing.",This informational message is important to users. Please leave.,js,1,1,1
"@@ -47,6 +47,12 @@ module Selenium
           @bridge.send_command(cmd: cmd, params: params)
         end
 
+        def print_page(**options)
+          options[:page_ranges] &&= Array(options[:page_ranges])
+
+          bridge.print_page(options)
+        end
+
         private
 
         def debugger_address",the bridge here isn't defined as an accessor / reader to try mask it better. So you need to directly call the iVar `@bridge` here.,js,1,1,1
"@@ -692,6 +692,8 @@ define(['browser'], function (browser) {
         var h264Profiles = 'high|main|baseline|constrained baseline';
 
         if (browser.tizen || browser.web0s ||
+            // iOS 12 incorrectly reports support
+            !(browser.iOS && browser.iOSVersion < 13) &&
             videoTestElement.canPlayType('video/mp4; codecs=""avc1.640833""').replace(/no/, '')) {
             maxH264Level = 51;
         }",Making a function like `canPlayH264Level51` or something would simplify the complexity of this a bit.,js,1,1,1
"@@ -1,6 +1,6 @@
 import { options as rawOptions } from 'preact';
 
-/** @type {import('../../src/internal').Options} */
+/** @type {import('preact/src/internal').Options} */
 let options = rawOptions;
 
 let oldVNode = options.vnode;","Technically with the jsconfig.json, this is now possible, but felt out of scope for this PR.",js,0,1,1
"@@ -35,6 +35,12 @@ export default AuthenticatedRoute.extend(styleBody, CurrentUserSettings, Paginat
                 });
             }
 
+            // we need to load the roles into ember cache
+            // invites return role_id only and we do not offer a /role/:id endpoint
+            modelPromises.roles = this.get('store').query('role', {permissions: 'assign'}).then((roles) => {
+                return roles;
+            });
+
             return RSVP.hash(modelPromises);
         });
     },",Is the `{permissions: 'assign'}` needed here? It would be preferable to load all roles so that the role of team members can be displayed even if the current user doesn't have permission to assign those roles to new users.,js,1,1,1
"@@ -76,6 +76,7 @@ storiesOf( 'Analytics Module/Settings', module )
 		decorators: [
 			withRegistry,
 		],
+		padding: 0,
 	} )
 	.add( 'View, open with all settings', ( args, { registry } ) => {
 		registry.dispatch( STORE_NAME ).receiveGetSettings( {",Same with the settings. We need to use the default padding for all settings stories in all modules.,js,1,1,1
"@@ -64,10 +64,10 @@ function assertArity(args, requiredArity) {
  * @param {object} [validationOptions] Options for the validation itself.
  * @param {Logger} [validationOptions.logger] A logger instance to use if validation fails.
  * @param {string} [validationOptions.optionsValidationLevel] The level at which to validate the providedOptions ('none', 'warn', or 'error').
- * @param {boolean} [warnOnUnknownOptions=false] If true, warn on any option that is not in the schema.
+ * @param {string} [validationOptions.unknownOptionsWarningLevel] The level at which to handle unknown options ('none', 'warn', or 'error').
  * @return {object} returns a frozen object of validated options
  */
-function validate(optionsSchema, providedOptions, validationOptions, warnOnUnknownOptions) {
+function validate(optionsSchema, providedOptions, validationOptions) {
   let optionsValidationLevel = VALIDATION_LEVEL_WARN;
   let logger;
 ",The changes in `options_validator` supersede the changes in #1898. I can separate these changes out into a different PR if that would be better for readability and commit history.,js,0,1,1
"@@ -272,7 +272,7 @@ function* webpackConfig( env, argv ) {
 		},
 		plugins: [
 			new ProvidePlugin( {
-				React: 'react',
+				React: '@wordpress/element',
 			} ),
 			new WebpackBar( {
 				name: 'Module Entry Points',","Is this needed? I removed it and everything still built fine. It's minor, and I know it _is_ needed in the Jest tests and in Storybook, but maybe we should remove it here.",js,1,1,1
"@@ -125,8 +125,8 @@ function generateTopologyTests(testSuites, testContext, filter) {
       describe(suiteName, {
         metadata: { requires },
         test: function () {
-          beforeEach(() => prepareDatabaseForSuite(testSuite, testContext));
-          afterEach(() => testContext.cleanupAfterSuite());
+          // beforeEach(() => );
+          // afterEach();
 
           testSuite.tests.forEach(spec => {
             it(spec.description, function () {","hm this looks wrong, did you meant to revert?",js,1,1,1
"@@ -290,11 +290,11 @@ export default Controller.extend(SettingsMenuMixin, {
          * Action sent by post settings menu view.
          * (#1351)
          */
-        setPublishedAt(userInput) {
+        setPublishedAtUTC(userInput) {
             if (!userInput) {
-                // Clear out the publishedAt field for a draft
+                // Clear out the publishedAtUTC field for a draft
                 if (this.get('model.isDraft')) {
-                    this.set('model.publishedAt', null);
+                    this.set('model.publishedAtUTC', null);
                 }
                 return;
             }","This may be a little confusing as we get date from `parseDateString` that is actually in the blog's timezone, not in UTC. We actually convert it into UTC further down on line 319. I would suggest two variables here, one that holds the blog-timezone value and one that holds the UTC value.",js,1,1,1
"@@ -73,5 +73,6 @@ storiesOf( 'Global/ReportTable', module )
 				/>
 			</Layout>
 		);
-	} )
-;
+	}, {
+		padding: 0,
+	} );","Same here. Please, use the default padding.",js,1,1,1
"@@ -23,7 +23,7 @@ const resolve = (list, child, node) => {
 		// mark the child as completely resolved by deleting it from ._map.
 		// This is used to figure out when *all* children have been completely
 		// resolved when revealOrder is 'together'.
-		list._map.delete(child);
+		list._map.delete(child._node);
 	}
 
 	// If revealOrder is falsy then we can do an early exit, as the","Something is wrong here, since we'll only delete one and the second one isn't present in the _map (wrong ref?)",js,1,1,1
"@@ -422,8 +422,7 @@ module.exports = class ProviderView {
 
   handleAuth () {
     const authState = btoa(JSON.stringify({ origin: getOrigin() }))
-    // @todo remove this hardcoded version
-    const clientVersion = encodeURIComponent('@uppy/companion-client=1.0.2')
+    const clientVersion = encodeURIComponent(`@uppy/companion-client=${ProviderView.VERSION}`)
     const link = `${this.provider.authUrl()}?state=${authState}&uppyVersions=${clientVersion}`
 
     const authWindow = window.open(link, '_blank')",Hmm this should've been `@uppy/provider-views` I guess! Can we still change it now with back compat or will we just have to suck it up? :P,js,1,1,0
"@@ -198,9 +198,11 @@ export function initDebug() {
 	};
 
 	options.diffed = (vnode) => {
+		if (oldDiffed) oldDiffed(vnode);
+
 		if (vnode._component && vnode._component.__hooks) {
 			let hooks = vnode._component.__hooks;
-			hooks._list.forEach(hook => {
+			(hooks._list || []).forEach(hook => {
 				if (hook._callback && (!hook._args || !Array.isArray(hook._args))) {
 					/* istanbul ignore next */
 					console.warn(",Moving this up top ensures the call for the older one first.,js,1,1,1
"@@ -89,7 +89,14 @@ Query.prototype.bind = function bind (model, op, updateArg) {
   this.op = op;
 
   if (op == 'update' || op == 'findOneAndUpdate') {
-    merge(this._updateArg, updateArg || {});
+    // allow update to be a Document
+    if(updateArg instanceof Document) {
+      updateArg = updateArg.toObject();
+      delete updateArg._id;
+      merge(this._updateArg, updateArg);
+    } else {
+      merge(this._updateArg, updateArg || {});
+    }
   }
 
   return this;",why are we deleting the _id?,js,1,0,1
"@@ -194,7 +194,17 @@ Blockly.Xml.blockToDom = function(block, opt_noId) {
     var commentElement = goog.dom.createDom('comment', null, commentText);
     if (typeof block.comment == 'object') {
       commentElement.setAttribute('pinned', block.comment.isVisible());
-      var hw = block.comment.getBubbleSize();
+      var hw;
+      if (block.comment instanceof Blockly.ScratchBlockComment) {
+        commentElement.setAttribute('type', 'scratch');
+        var xy = block.comment.getXY();
+        commentElement.setAttribute('x', xy.x);
+        commentElement.setAttribute('y', xy.y);
+        commentElement.setAttribute('minimized', block.comment.isMinimized());
+        hw = block.comment.getHeightWidth();
+      } else {
+        hw = block.comment.getBubbleSize();
+      }
       commentElement.setAttribute('h', hw.height);
       commentElement.setAttribute('w', hw.width);
     }",Make these into helper functions.,js,1,0,1
"@@ -294,6 +294,13 @@ Query.prototype.cast = function (model, obj) {
               continue;
             }
 
+            if ('$regex' === $cond) {
+              if ('RegExp' !== nested.constructor.name) {
+                throw new Error(""$type parameter must be RegExp"");
+              }
+              continue;
+            }
+
             if ('$not' === $cond) {
               this.cast(model, nested);
             } else {",we should probably cast strings to regexps here.,js,1,0,1
"@@ -240,6 +240,12 @@ class Server extends EventEmitter {
     }
 
     wireProtocol.command(this, ns, cmd, options, (err, result) => {
+      if (err && err instanceof MongoNetworkError) {
+        if (options.session) {
+          options.session.serverSession.isDirty = true;
+        }
+      }
+
       if (err && isSDAMUnrecoverableError(err)) {
         this.emit('error', err);
       }",`if (err && err instanceof MongoNetworkError && options.session)`,js,1,0,0
"@@ -907,6 +907,8 @@ export const showErrorNotification = ( ErrorComponent, props = {} ) => {
 export const decodeHtmlEntity = ( str ) => {
 	const decoded =  str.replace( /&#(\d+);/g, function( match, dec ) {
 		return String.fromCharCode( dec );
+	} ).replace( /(\\)/g, function( ) {
+		return '';
 	} );
 
 	return unescape( decoded );","No need for a function here, this can simply become `.replace( /(\\)/g, '' )`",js,1,1,1
"@@ -142,6 +142,7 @@ module.exports = class DragDrop extends Plugin {
     const restrictions = this.uppy.opts.restrictions
     return (
       <input
+        id={'uppy-input-' + this.id}
         class=""uppy-DragDrop-input""
         type=""file""
         tabindex={-1}",we might want to do `this.uppy.id + this.id` in case someone has two instances of uppy with drag-drop,js,1,1,1
"@@ -0,0 +1,5 @@
+package org.openqa.selenium.grid.session.remote;
+
+public class SessionTest {
+
+}",And another empty test. Please remove until there's content.,js,1,1,1
"@@ -201,7 +201,7 @@ TransactionBuilder.prototype._setInputMap = function() {
     var scriptType = scriptPubKey.classify();
 
     if (scriptType === Script.TX_UNKNOWN)
-      throw new Error('unkown output type at:' + i +
+      throw new Error('Unknown script pubkey type at:' + i +
         ' Type:' + scriptPubKey.getRawOutType());
 
     inputMap.push({","I would say 'Unknown scriptPubKey', which is not the same as 'Unkown script pubkey'",js,1,1,1
"@@ -1348,6 +1348,13 @@ Blockly.WorkspaceSvg.prototype.zoomCenter = function(type) {
   var metrics = this.getMetrics();
   var x = metrics.viewWidth / 2;
   var y = metrics.viewHeight / 2;
+  if (this.options.toolboxPosition == Blockly.TOOLBOX_AT_LEFT) {
+    x = x + 250;
+  } else if (this.options.toolboxPosition == Blockly.TOOLBOX_AT_RIHT) {
+    x = x + 250;
+  } else if (this.options.toolboxPosition == Blockly.TOOLBOX_AT_TOP) {
+    y = y + 158;
+  }
   this.zoom(x, y, type);
 };
 ",Looks like there's a typo for `TOOLBOX_AT_RIGHT` here.,js,1,1,1
"@@ -108,10 +108,11 @@ module Selenium
 
         def initialize(source, duration, x, y, element: nil, origin: nil)
           super(source)
+
           @duration = duration * 1000
           @x_offset = x
           @y_offset = y
-          @origin = element || origin
+          @origin = origin || POINTER
         end
 
         def type",Should be `@origin = element || origin || POINTER`,js,1,0,1
"@@ -46,12 +46,12 @@ describe( 'trackAPIError', () => {
 				code: 'test-error-code',
 			},
 		} );
-		expect( dataLayerPushSpy ).toHaveBeenCalledTimes( 1 );
+		expect( dataLayerPushSpy ).toHaveBeenCalledTimes( 3 );
 		const [
 			event,
 			eventName,
 			eventData,
-		] = dataLayerPushSpy.mock.calls[ 0 ][ 0 ];
+		] = dataLayerPushSpy.mock.calls[ 2 ][ 0 ];
 		expect( event ).toEqual( 'event' );
 		expect( eventName ).toEqual(
 			'test-method:test-type/test-identifier/data/test-datapoint'",@ivankruchkoff this looks unexpected. Why would more events tracked be expected here?,js,0,1,1
"@@ -27,6 +27,16 @@ export function initDebug() {
 			);
 		}
 
+		Object.keys(vnode.props).forEach((key) => {
+			if (key[0]==='o' && key[1]==='n' && typeof vnode.props[key]!=='function') {
+				throw new Error(
+					`Component's ""${key}"" property should be a function,
+					but got [${typeof vnode.props[key]}] instead\n` +
+					serializeVNode(vnode)
+				);
+			}
+		});
+
 		// Check prop-types if available
 		if (typeof vnode.type==='function' && vnode.type.propTypes) {
 			checkPropTypes(vnode.type.propTypes, vnode.props, getDisplayName(vnode), serializeVNode(vnode));","Kind off afraid about the performance impact of this, since `Object.keys` iterates over the object and then we iterate over that created array. If this happens on every rerender...",js,1,1,0
"@@ -12,6 +12,14 @@ const { _ } = require('lib/locale.js');
 const http = require('http');
 const https = require('https');
 const toRelative = require('relative');
+const { Database } = require('lib/database.js');
+
+let keytar;
+try {
+	keytar = require('keytar');
+} catch (err) {
+	keytar = null;
+}
 
 function shimInit() {
 	shim.fsDriver = () => {",`keytar` is installed and always available so no need for a try/catch block,js,1,1,1
"@@ -35,6 +35,8 @@ import { createElement, Fragment } from '@wordpress/element';
  *
  * @param {Component} NewComponent The new component to append to the filtered component.
  *
+ * @return {ReactElement} Filtered component with appended component.
+ *
  */
 export const createAddToFilter = ( NewComponent ) => {
 	return ( OriginalComponent ) => {","I believe we should be using `WPElement` instead since React is essentially provided through we're using `@wordpress/element`, but I'm not 100% sure about that now that we're using our own bundles. @tofumatt ?",js,1,1,1
"@@ -477,7 +477,7 @@ class Uppy {
   retryAll () {
     const updatedFiles = Object.assign({}, this.getState().files)
     const filesToRetry = Object.keys(updatedFiles).filter(file => {
-      return updatedFiles[file].error
+      return updatedFiles[file].error.message
     })
 
     filesToRetry.forEach((file) => {","Should we be checking if `error.message` exists first? What if string is returned from somewhere? Though I think we have an Eslint rule for that now, an extra check would not be too bad?",js,1,1,1
"@@ -26,9 +26,13 @@ const port = process.env.PORT || 8002;
 app.use(
 	'/assets',
 	express.static(
-		`${rootPath}/node_modules/@salesforce-ux/design-system/assets/`
+		path.join(
+			__dirname,
+			`${rootPath}/node_modules/@salesforce-ux/design-system/assets/`
+		)
 	)
 );
+app.use('/assets', express.static(path.join(__dirname, `${rootPath}/assets/`)));
 app.use(express.static(`${rootPath}/storybook-based-tests`));
 
 console.log(`","HItting ""JavaScript heap out of memory"" error when running `npm run test:snapshot ` on local right now, but this fix should allow the snapshot tests that compare image snapshots to pass after the SLDS upgrade. The image diffs were due to the new background: #b0c4df",js,1,1,1
"@@ -315,7 +315,17 @@ function diffAttributes(dom, attrs, old) {
 	// add new & update changed attributes
 	if (attrs) {
 		for (let name in attrs) {
-			if (name!=='children' && name!=='innerHTML' && (!(name in old) || attrs[name]!==(name==='value' || name==='checked' ? dom[name] : old[name]))) {
+			if (
+				name!=='children' &&  // break if attributeName is children
+				name!=='innerHTML' &&  // break if attributeName is innerHTML
+				(
+					( name=== 'dangerouslySetInnerHTML' ) || // continue if attributeName is dangerouslySetInnerHTML
+					(
+						!(name in old) ||  // continue if attr doesn't exists
+						attrs[name] !== (name==='value' || name==='checked' ? dom[name] : old[name]) // continue if attr is different
+					)
+				)
+			) {
 				setAccessor(dom, name, old[name], old[name] = attrs[name], isSvgMode);
 			}
 		}",This line is the essence of PR #454,js,0,1,1
"@@ -25,3 +25,4 @@ class ChromeRemoteConnection(RemoteConnection):
         self._commands[""launchApp""] = ('POST', '/session/$sessionId/chromium/launch_app')
         self._commands[""setNetworkConditions""] = ('POST', '/session/$sessionId/chromium/network_conditions')
         self._commands[""getNetworkConditions""] = ('GET', '/session/$sessionId/chromium/network_conditions')
+        self._commands['ExecuteCDP'] = ('POST', '/session/$sessionId/goog/cdp/execute')",Should this be camelCase to match the above commands? I am not the expert here so maybe Lucas or David can chime in.,js,0,1,1
"@@ -13,14 +13,16 @@ define(['apphost', 'globalize', 'connectionManager', 'itemHelper', 'appRouter',
             if (options.play !== false) {
                 commands.push({
                     name: globalize.translate('Play'),
-                    id: 'resume'
+                    id: 'resume',
+                    icon: ""play_arrow""
                 });
             }
 
             if (options.playAllFromHere && item.Type !== 'Program' && item.Type !== 'TvChannel') {
                 commands.push({
                     name: globalize.translate('PlayAllFromHere'),
-                    id: 'playallfromhere'
+                    id: 'playallfromhere',
+                    icon: ""play_arrow""
                 });
             }
         }",can we use consistent quotes please (here and in other places)?,js,1,1,1
"@@ -214,6 +214,14 @@ define(['browser'], function (browser) {
                 break;
             case 'avi':
                 supported = browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;
+                // New Samsung TV don't support XviD/DivX
+                if (browser.tizen) {
+                    videoCodecs.push('h264');
+                    if (canPlayH265(videoTestElement, options)) {
+                        videoCodecs.push('h265');
+                        videoCodecs.push('hevc');
+                    }
+                }
                 break;
             case 'mpg':
             case 'mpeg':",Why not just remove Tizen from the `supported` variable?,js,1,1,1
"@@ -278,7 +278,7 @@ export const createSettingsStore = ( type, identifier, datapoint, {
 		 * @return {Object} Redux-style action.
 		 */
 		actions[ `set${ pascalCaseSlug }` ] = ( value ) => {
-			invariant( typeof value !== 'undefined', 'value is required.' );
+			invariant( typeof value !== 'undefined', `value is required for calls to set${ pascalCaseSlug }().` );
 
 			return {
 				payload: { value },","I added this to assist in debugging; because these method names are dynamically generated, this makes it a lot easier to discover which method is throwing the error, which at first made narrowing down the `invariant` call cumbersome.",js,1,1,1
"@@ -372,7 +372,7 @@ define([""dom"", ""browser"", ""layoutManager""], function (dom, browser, layoutManage
      */
     function useSmoothScroll() {
 
-        if (browser.tizen) {
+        if (browser.tizen || browser.web0s || browser.firefox || browser.chrome) {
             return true;
         }
 ","I know lots of people don't like smooth scroll, so we can't just enable it everywhere by default.",js,1,1,1
"@@ -166,7 +166,14 @@ export function diff(parentDom, newVNode, oldVNode, context, isSvg, excessDomChi
 	return newVNode._dom;
 }
 
+/**
+ * @param {Array<import('../internal').Component>} commitQueue List of components
+ * which have callbacks to invoke in commitRoot
+ * @param {import('../internal').VNode} root
+ */
 export function commitRoot(commitQueue, root) {
+	if (options._commit) options._commit(root, commitQueue);
+
 	commitQueue.some(c => {
 		try {
 			commitQueue = c._renderCallbacks;","If we need a post commit option, we should probably call it `_committed` following our existing option naming pattern",js,1,1,1
"@@ -1,5 +1,11 @@
 /*global dom */
 
+/**
+ * Finds the first Element with the given attribute
+ * @param {Element} node
+ * @param {String} attr Attribute name
+ * @return {Element}
+ */
 dom.getElementByReference = function (node, attr) {
 	let fragment = node.getAttribute(attr);
 ",not enough of a description to understand what the function is really doing,js,1,1,1
"@@ -24,7 +24,7 @@ if (!_rng && _crypto && _crypto.getRandomValues) {
 }
 
 try {
-  if (!_rng && require) {
+  if (!_rng) {
     const nodeCrypto = require('crypto');
     _rng = () => nodeCrypto.randomBytes(16);
   }",This change worries me. How does this change effect other supported environments?,js,1,1,1
"@@ -107,7 +107,7 @@ define([""globalize"", ""dom"", ""emby-checkbox"", ""emby-select"", ""emby-input""], funct
         if (!plugins.length) return html;
 
         html += '<div class=""metadataFetcher"" data-type=""' + availableTypeOptions.Type + '"">';
-        html += '<h3 class=""checkboxListLabel"">' + globalize.translate(""LabelTypeMetadataDownloaders"", availableTypeOptions.Type) + ""</h3>"";
+        html += '<h3 class=""checkboxListLabel"">' + globalize.translate(""LabelTypeMetadataDownloaders"", globalize.translate(availableTypeOptions.Type)) + ""</h3>"";
         html += '<div class=""checkboxList paperList checkboxList-paperList"">';
         for (var i = 0; i < plugins.length; i++) {
             var plugin = plugins[i];",This does not look right...,js,1,0,1
"@@ -455,6 +455,9 @@ class Realm {
  *   This is not supported for `""list""` properties of object types and `""linkingObjects""` properties.
  * @property {boolean} [indexed] - Signals if this property should be indexed. Only supported for
  *   `""string""`, `""int""`, and `""bool""` properties.
+ * @property {string} [alias] - an alias in JavaScript for the underlying name in the Realm file. If set, this must be
+ *   used when reading/writing the property or making queries against it. Trying to use the internal name will throw
+ *   an exception.
  */
 
 /**","""internal name"" might be a little unclear here. Maybe ""underlying name"" is better.",js,1,1,1
"@@ -66,15 +66,9 @@ const groupFunction =
  * @param {Collection~bulkWriteOpCallback} [callback] The command result callback
  */
 function bulkWrite(coll, operations, options, callback) {
-  // Add ignoreUndfined
-  if (coll.s.options.ignoreUndefined) {
-    options = Object.assign({}, options);
-    options.ignoreUndefined = coll.s.options.ignoreUndefined;
-  }
-
   // Create the bulk operation
   const bulk =
-    options.ordered === true || options.ordered == null
+    options.ordered === true
       ? coll.initializeOrderedBulkOp(options)
       : coll.initializeUnorderedBulkOp(options);
 ",Want to double check: this was done b/c we will always have a default value of `ordered: true` unless otherwise specified?,js,1,1,1
"@@ -4,7 +4,7 @@ import globalize from '../../scripts/globalize';
 import layoutManager from '../layoutManager';
 import { playbackManager } from '../playback/playbackmanager';
 import playMethodHelper from '../playback/playmethodhelper';
-import syncPlayManager from '../syncPlay/syncPlayManager';
+import SyncPlay from 'SyncPlay';
 import './playerstats.css';
 import ServerConnections from '../ServerConnections';
 ",This import seems invalid. Should probably be a relative path?,js,1,1,1
"@@ -31,6 +31,12 @@ class DashboardModal extends React.Component {
     } else if (!prevProps.open && this.props.open) {
       this.plugin.openModal()
     }
+
+    for (const key of Object.keys(this.props)) {
+      if (this.props[key] !== prevProps[key] && key in this.plugin.opts) {
+        this.plugin[key] = this.props[key]
+      }
+    }
   }
 
   componentWillUnmount () {",Are we sure we want to do this for everything? This may have unexpected consequences in the future. Perhaps it's better to just explicitly update the value in question.,js,1,1,1
"@@ -84,7 +84,7 @@ class GhostTable {
    * Add a row consisting of the column headers.
    */
   addColumnHeadersRow(samples) {
-    if (this.hot.getColHeader(0) != null) {
+    if (this.hot.getColHeader(0) !== null && this.hot.getColHeader(0) !== void 0) {
       const rowObject = {row: -1};
       this.rows.push(rowObject);
 ","Could you cache result of the `this.hot.getColHeader(0)` method? This prevents firing `""modifyColHeader""` and `""modifyCol""` hooks twice for the same column index.",js,1,1,1
"@@ -1,5 +1,10 @@
-return !!(
-	node.getAttribute('lang') ||
-	node.getAttribute('xml:lang') ||
-	''
-).trim();
+const { isXHTML } = axe.utils;
+
+const langValue = (node.getAttribute(`lang`) || '').trim();
+const xmlLangValue = (node.getAttribute(`xml:lang`) || '').trim();
+
+if (!langValue && !isXHTML(document)) {
+	return false;
+}
+
+return !!(langValue || xmlLangValue);",Just curious: why use backticks (\`) here rather than quotes?,js,1,1,1
"@@ -50,7 +50,7 @@ define(['backdrop', 'userSettings', 'libraryMenu'], function (backdrop, userSett
                         return i;
                     }));
                 } else {
-                    backdrop.clear();
+                    backdrop.clearBackdrop();
                 }
             });
         }",I think `clear` was better than `clearBackdrop` since the filename already indicates the object.,js,1,1,1
"@@ -20,6 +20,8 @@
  * External dependencies
  */
 import invariant from 'invariant';
+import mapValues from 'lodash/mapValues';
+import memize from 'memize';
 
 /**
  * WordPress dependencies","Note that while `memize` was added to `package.json`, it's already a dependency of `@wordpress/data` so this just makes it safe to use without really adding anything to the bundle.",js,1,1,1
"@@ -118,7 +118,8 @@ export function setProperty(dom, name, value, oldValue, isSvg) {
 			name in dom
 		) {
 			try {
-				dom[name] = value == null ? '' : value;
+				const newValue = value == null ? '' : value;
+				if (dom[name] !== newValue) dom[name] = newValue;
 				// labelled break is 1b smaller here than a return statement (sorry)
 				break o;
 			} catch (e) {}","On a side note, this is a bug fix. I noticed this in my debugging sessions. For whatever reason, preact is setting the class name in dom even though it is identical and that causes a layout shift. This fixes it.",js,1,1,1
"@@ -420,6 +420,8 @@ ReplSetState.prototype.update = function(server) {
   //
   if (!this.primary && ismaster.ismaster && ismaster.setName) {
     var ismasterElectionId = server.lastIsMaster().electionId;
+    this.setName = this.setName.trim();
+    ismaster.setName = ismaster.setName.trim();
     if (this.setName && this.setName !== ismaster.setName) {
       this.topologyType = TopologyType.ReplicaSetNoPrimary;
       return new MongoError(",Why are we modifying `ismaster`?,js,1,1,1
"@@ -35,6 +35,9 @@ const { BundleAnalyzerPlugin } = require( 'webpack-bundle-analyzer' );
 const CreateFileWebpack = require( 'create-file-webpack' );
 const ManifestPlugin = require( 'webpack-manifest-plugin' );
 const features = require( './feature-flags.json' );
+const formattedFeaturesToPHPArray = Array.isArray( features )
+	? features.map( ( feature ) => `'${ feature }'` ).join( ',' )
+	: '';
 
 const projectPath = ( relativePath ) => {
 	return path.resolve( fs.realpathSync( process.cwd() ), relativePath );",We don't need the array check here because it's our own import which isn't dynamic so we can rely on it always being an array. If it wasn't something is probably wrong and it's probably better for it to fail here,js,1,1,1
"@@ -85,6 +85,10 @@ const fetchGetPropertiesStore = createFetchStore( {
 		);
 	},
 	reducerCallback( state, properties, { accountID } ) {
+		if ( ! Array.isArray( properties ) ) {
+			return state;
+		}
+
 		return {
 			...state,
 			properties: {","Curious, why is this necessary here? Shouldn't `properties` always expected to be an array? If this check is needed, I wonder if we have a problem elsewhere.",js,1,1,1
"@@ -40,7 +40,8 @@ export function setAccessor(node, name, old, value, isSvg) {
 		}
 		if (value && typeof value==='object') {
 			if (!isString(old)) {
-				for (let i in old) if (!(i in value)) node.style[i] = '';
+				for (let i in old)
+					if (!(i in value) || value[i] == null || value[i] === false) node.style[i] = '';
 			}
 			for (let i in value) {
 				node.style[i] = typeof value[i]==='number' && !NON_DIMENSION_PROPS[i] ? (value[i]+'px') : value[i];",Can skip the `in` check now I think,js,1,0,1
"@@ -480,6 +480,12 @@ plugins.setConfigs(""crashes"", {
                                 }];
                                 plugins.dispatch(""/plugins/drill"", {params: params, dbAppUser: dbAppUser, events: events});
 
+                                const hooksData = {
+                                    params: {...params}
+                                };
+                                hooksData.params.qstring.events = events;
+                                plugins.dispatch(""/hooks/incoming_data"", hooksData);
+
 
                                 const processCrash = function(userAll) {
                                     var groupSet = {};","Hello, instead of having a separate event for incoming data, maybe hooks can reuse this event that we already have and all future manual events will use it to write data to drill either way :)",js,1,1,1
"@@ -88,7 +88,7 @@ public class Docker {
 
     findImage(new ImageNamePredicate(name, tag));
 
-    LOG.info(String.format(""Pulling %s:%s"", name, tag));
+    LOG.finest(String.format(""Pulling %s:%s"", name, tag));
 
     HttpRequest request = new HttpRequest(POST, ""/images/create"");
     request.addQueryParameter(""fromImage"", name);",This will always need to be displayed to users.,js,1,1,1
"@@ -271,6 +271,10 @@ class Connection extends EventEmitter {
 
       // Iterate over all buffers and write them in order to the socket
       for (let i = 0; i < buffer.length; i++) {
+        this.socket.on('error', function(){
+          console.log(""CLIENT HAS ERRORED"");
+          break;
+        });
         this.socket.write(buffer[i], 'binary');
       }
 ",This will add an error listener per buffer in the BufferList passed to write and the break on line 276 won't have an effect on the synchronous for loop as the socket can emit the error event at a time later than when the loop is run.,js,1,1,1
"@@ -230,6 +230,7 @@ const defaultReplacements = [
   [/Chrome/g, 'Brave'],
   [/Google LLC. All rights reserved./g, 'The Brave Authors. All rights reserved.'],
   [/Google/g, 'Brave'],
+  [/Brave Safe Browsing/g, 'Google Safe Browsing'],
   [/You're incognito/g, 'This is a private window'],
   [/an incognito/g, 'a private'],
   [/an Incognito/g, 'a Private'],","This could probably be merged with the previous rule using negative-look-ahead, e.g. `Google(?! Safe Browsing?)`. But it could be argued this way is more readable, so I'm ok with it.",js,1,1,1
"@@ -29,7 +29,17 @@ export function initDebug() {
 		let children = props && props.children;
 
 		if (type===undefined) {
-			throw new Error('Undefined component passed to createElement()\n'+serializeVNode(vnode));
+			throw new Error('Undefined component passed to createElement()\n\n'+
+			'You likely forgot to export your component or might have mixed up default and named imports'+
+			serializeVNode(vnode));
+		}
+		else if (type!=null && typeof type==='object') {
+			if (type._lastDomChild!==undefined && type._dom!==undefined) {
+				let info = 'Did you accidentilly passed a JSX Literal as JSX twice?';
+				throw new Error('Invalid type passed to createElement(): '+type+'\n\n'+info+'\n\n'+serializeVNode(type));
+			}
+
+			throw new Error('Invalid type passed to createElement(): '+(Array.isArray(type) ? 'array' : type));
 		}
 
 		if (",I think this should be `accidentally`,js,1,1,1
"@@ -401,8 +401,11 @@ function ($timeout, gridUtil, uiGridConstants, uiGridColumnMenuService, $documen
           $scope.hideMenu( true );
 
           if ($scope.col) {
-            //Focus on the menu button
-            gridUtil.focus.bySelector($document, '.ui-grid-header-cell.' + $scope.col.getColClass()+ ' .ui-grid-column-menu-button', $scope.col.grid, false);
+            //Focus on the menu button if this is shown, otherwise focus the column header
+            var elementToFocus = '.ui-grid-header-cell.' + $scope.col.getColClass();
+            elementToFocus += ($scope.grid.options.showColumnMenuButtons && $scope.col.colDef.showColumnMenuButton !== false)? 
+              ' .ui-grid-column-menu-button' : ' .ui-grid-header-cell-primary-focus';
+            gridUtil.focus.bySelector($document, elementToFocus, $scope.col.grid, false);
           }
         }
       });","This is redundant. if $scope.grid.options.showColumnMenuButton returns truthy, then it is obviously different than false. You only need one of these checks.",js,1,1,1
"@@ -822,7 +822,7 @@ const htmlElms = {
   },
   svg: {
     contentTypes: ['embedded', 'phrasing', 'flow'],
-    allowedRoles: ['application', 'document', 'img'],
+    allowedRoles: true,
     chromiumRole: 'SVGRoot',
     namingMethods: ['svgTitleText']
   },",Is this the only change we need to make for an updated ARIA in HTML?,js,1,1,1
"@@ -13,13 +13,16 @@ import options from './options';
  */
 export function render(vnode, parentDom, replaceNode) {
 	if (options._root) options._root(vnode, parentDom);
-	let oldVNode = parentDom._children;
+	let oldVNode = replaceNode ?
+		replaceNode._children || parentDom._children :
+		parentDom._children;
+
 	vnode = createElement(Fragment, null, [vnode]);
 
 	let mounts = [];
 	diff(
 		parentDom,
-		replaceNode ? vnode : (parentDom._children = vnode),
+		replaceNode ? (replaceNode._children = vnode) : (parentDom._children = vnode),
 		oldVNode || EMPTY_OBJ,
 		EMPTY_OBJ,
 		parentDom.ownerSVGElement !== undefined,","This `||` is needed for the case when we first did `render(x, y, undefined)` and transition to a render with replaceNode. The second is needed for when we use replaceNode twice in a row.",js,1,1,1
"@@ -20,10 +20,10 @@
  * A single module. Keeps track of its own active state and settings.
  */
 
-function Spinner( { isSaving } ) {
+function Spinner( { isSaving, className } ) {
 	return (
 		<span
-			className=""spinner""
+			className={ [ 'spinner', className ].join( ' ' ) }
 			style={ {
 				display: ( isSaving ? 'inline-block' : 'none' ),
 				float: 'none',",Please use the `classnames` package for dynamic class names. We already use it in many places and is our go-to utility for this kind of thing,js,1,1,1
"@@ -181,7 +181,8 @@ export async function getAdSenseAccountStatus( statusUpdateCallback, existingTag
 				for ( let account of accounts ) {
 					const accountId = account.id;
 					const urlchannels = await data.get( 'modules', 'adsense', 'urlchannels', { clientId: accountId } ).then( res => res ).catch( e => e );
-					const matches = urlchannels && urlchannels.length ? filter( urlchannels, { urlPattern: googlesitekit.admin.siteURL } ) : [];
+					const parsedUrl = new URL( googlesitekit.admin.siteURL );
+					const matches = urlchannels && urlchannels.length ? filter( urlchannels, { urlPattern: parsedUrl.hostname } ) : [];
 
 					if ( 0 === matches.length ) {
 						accountStatus  = 'account-pending-review';",Can you provide more background on this change?,js,1,0,1
"@@ -41,8 +41,9 @@ import WidgetCellWrapper from './WidgetCellWrapper';
 import { isInactiveWidgetState } from '../util/is-inactive-widget-state';
 import InViewProvider from '../../../components/InViewProvider';
 const { useSelect } = Data;
+const DEFAULT_CLASS_APPENDIX = '--boxes'
 
-export default function WidgetAreaRenderer( { slug, totalAreas } ) {
+export default function WidgetAreaRenderer( { slug = DEFAULT_CLASS_APPENDIX, totalAreas } ) {
 	const widgetAreaRef = useRef();
 	const intersectionEntry = useIntersection( widgetAreaRef, {
 		rootMargin: '0px',","@shayannosrat I don't think the problem here is related to the `slug` - it's related to the `style` of the widget area. `boxes` is a widget area style, not a widget area slug. We need to investigate why the `style` variable in this component can be `undefined` - it never should be.",js,0,1,1
"@@ -127,8 +127,8 @@ module.exports = function(config) {
 						exclude: /node_modules/,
 						loader: 'babel-loader',
 						options: {
-							comments: false,
-							compact: true,
+							// comments: false,
+							// compact: true,
 							plugins: coverage ?
 								[['istanbul', {
 									exclude: [",Note to self: Undo before checking in,js,0,0,1
"@@ -0,0 +1,19 @@
+const uniqueLandmarks = [];
+results.forEach(currentResult => {
+	const findMatch = someResult => {
+		return (
+			currentResult.data.role === someResult.data.role &&
+			currentResult.data.label === someResult.data.label
+		);
+	};
+
+	const foundResultIndex = uniqueLandmarks.findIndex(findMatch);
+	if (foundResultIndex === -1) {
+		uniqueLandmarks.push(currentResult);
+	} else {
+		currentResult.result = false;
+		uniqueLandmarks[foundResultIndex].result = false;
+	}
+});
+
+return results;",We should be adding the information about the currentResult to the matching item as a `relatedNode` that way we only return one fail for each duplicated role and name and we can see the others directly in the result.,js,1,1,1
"@@ -0,0 +1,3 @@
+const isFocusable = virtualNode.isFocusable;
+
+return isFocusable;",Why not just return `virtualNode.isFocusable`?,js,1,0,1
"@@ -0,0 +1,12 @@
+import memory from 'rollup-plugin-memory';
+import rollupConfig from './rollup.config';
+
+export default Object.assign({}, rollupConfig, {
+	plugins: [
+		memory({
+			path: 'src/preact',
+			contents: `import { h } from './preact';export * from './preact';export { h as createElement };`
+		}),
+		...rollupConfig.plugins.slice(1)
+	]
+});","Wondering if it's worth pulling this into a file (`src/aliases.js`?) for visibility. Or if there's anything else we might add in the future, it'd be easier in a file. Thoughts?",js,1,1,1
"@@ -29,7 +29,13 @@
 
 	var fixture = document.getElementById('fixture');
 	Object.keys(tests).forEach(function(ruleId) {
-		describe(ruleId, function() {
+		// don't run deprecated rules
+		var rule = axe._audit.rules.find(function(rule) {
+			return rule.id === ruleId;
+		});
+		var deprecated = rule.tags.indexOf('deprecated') !== -1;
+
+		(deprecated ? describe.skip : describe)(ruleId, function() {
 			tests[ruleId].forEach(function(test) {
 				var testName = test.description || ruleId + ' test';
 				describe(testName, function() {","If `rules.find()` somehow doesn't match, this will throw, since `rule` will be `undefined`. Do we want to guard against this?",js,1,1,1
"@@ -32,6 +32,8 @@ export function Component(props, context) {
 	 */
 	this.props = props;
 
+	this._nextState =
+
 	/**
 	 * @public
 	 * @type {object}",@KevinDoughty Perhaps a bad push?,js,0,0,1
"@@ -53,6 +53,10 @@ export default function UserInputKeywords( { slug, max } ) {
 		values.push( '' );
 	}
 
+	// Store values in local state to prevent
+	// https://github.com/google/site-kit-wp/issues/2900#issuecomment-814843972.
+	const [ localValues, setLocalValues ] = useState( [ '' ] );
+
 	// Need to make sure that dependencies list always has the same number of elements.
 	const dependencies = values.concat( Array( max ) ).slice( 0, max );
 ",Shouldn't the initial state be `values`?,js,1,1,1
"@@ -0,0 +1,12 @@
+let nodeText = axe.commons.text.accessibleText(node);
+let nodeDescripbedBy = axe.commons.aria.ariaDescribedby(node);
+
+let elems = axe.utils.querySelectorAll(axe._tree, 'a[href]');
+return !Array.prototype.slice.call(elems).some(function(element) {
+  return (
+    nodeText === axe.commons.text.accessibleText(element.actualNode) &&
+    nodeDescripbedBy === axe.commons.aria.ariaDescribedby(element.actualNode) &&
+    node.title === element.actualNode.title &&
+    node.href !== element.actualNode.href
+  );
+});","nitpick, spelling mistake - `nodeDescibedBy`",js,1,1,1
"@@ -41,7 +41,11 @@ function getAttributeNameValue(node, at) {
 				return;
 			}
 		} else {
-			atnv = escapeSelector(at.name) + '=""' + node.getAttribute(name) + '""';
+			atnv =
+				escapeSelector(at.name) +
+				'=""' +
+				escapeSelector(node.getAttribute(name)) +
+				'""';
 		}
 	} else {
 		atnv = escapeSelector(name) + '=""' + escapeSelector(at.value) + '""';","At L39 above, is it worth doing `escapeSelector(value)` as well?",js,1,1,1
"@@ -51,12 +51,15 @@ export default function SetupFormGA4Transitional() {
 	const propertyID = useSelect( ( select ) => select( STORE_NAME ).getPropertyID() );
 	const profileID = useSelect( ( select ) => select( STORE_NAME ).getProfileID() );
 
+	const ga4PropertyID = useSelect( ( select ) => select( MODULES_ANALYTICS_4 ).getPropertyID() );
 	const ga4ExistingTag = useSelect( ( select ) => select( MODULES_ANALYTICS_4 ).getExistingTag() );
 	const ga4MeasurementID = useSelect( ( select ) => select( MODULES_ANALYTICS_4 ).getMeasurementID() );
 
 	const { setUseSnippet: uaSetUseSnippet } = useDispatch( STORE_NAME );
 	const { setUseSnippet: ga4SetUseSnippet } = useDispatch( MODULES_ANALYTICS_4 );
 
+	const shouldShowAssociatedPropertyNotice = propertyID || ga4PropertyID;
+
 	useEffect( () => {
 		uaSetUseSnippet( existingTag !== propertyID );
 		ga4SetUseSnippet( ga4ExistingTag !== ga4MeasurementID );","See above, let's make this consistent with the other two scenarios: `accountID && accountID !== ACCOUNT_CREATE && ( propertyID || ga4PropertyID )`",js,1,1,1
"@@ -1,8 +1,11 @@
-/*global dom */
+/* global dom */
 /**
  * Get an element's parent in the composed tree
- * @param   DOMNode   Element
- * @return  DOMNode   Parent element
+ * @method getComposedParent
+ * @memberof axe.commons.dom
+ * @instance
+ * @param {Node} element
+ * @return {Node|null} Parent element or Null for root node
  */
 dom.getComposedParent = function getComposedParent (element)  {
   if (element.assignedSlot) {",I am surprised we did not rename this to `getFlattenedParent`!! Anyhoo - we should at least change the description to read `get an element's parent in the flattened tree`,js,1,1,1
"@@ -1119,7 +1119,7 @@ class BulkOperationBase {
         callback,
         new BulkWriteError(
           toError({
-            message: 'write operation failed',
+            message: this.s.bulkResult.writeErrors[0].errmsg,
             code: this.s.bulkResult.writeErrors[0].code,
             writeErrors: this.s.bulkResult.writeErrors
           }),",What happens if `this.s.bulkResult.writeErrors[0]` or its `errmsg` doesn't exist? Let's check that the `errmsg` exists and use the default `write operation failed` message if not.,js,1,1,1
"@@ -64,6 +64,7 @@ class Uppy {
         connectedToInternet: 'Connected to the Internet',
         // Strings for remote providers
         noFilesFound: 'You have no files or folders here',
+        loadMore: 'Load more',
         selectX: {
           0: 'Select %{smart_count}',
           1: 'Select %{smart_count}'",do we still need this?,js,1,0,1
"@@ -448,7 +448,7 @@ class Uppy {
       this.scheduledAutoProceed = setTimeout(() => {
         this.scheduledAutoProceed = null
         this.upload().catch((err) => {
-          console.error(err.stack || err.message || err)
+          onError(err.stack || err.message || err)
         })
       }, 4)
     }","`upload()` already logs an error and shows the informer, so we don't need to use `onError` here. (`console.error` is probably not that necessary either)",js,1,1,1
"@@ -21,7 +21,7 @@ export function render(vnode, parentDom, replaceNode) {
 	diffChildren(
 		parentDom,
 		replaceNode ? vnode : (parentDom._prevVNode = vnode),
-		replaceNode ? undefined : oldVNode,
+		oldVNode,
 		EMPTY_OBJ,
 		parentDom.ownerSVGElement !== undefined,
 		replaceNode",what was the point of having undefined here?,js,1,1,1
"@@ -0,0 +1,14 @@
+
+import { wpApiFetch } from './wp-api-fetch';
+
+/**
+ *
+ * @param {*} config
+ */
+export async function setAuthToken( token = 'test-access-token' ) {
+	return await wpApiFetch( {
+		path: 'google-site-kit/v1/e2e/auth/access-token',
+		method: 'post',
+		data: { token },
+	} );
+}",Empty line before and no `Internal dependencies` docblock (mandatory anyway once #217 lands).,js,0,1,1
"@@ -40,7 +40,7 @@ public class BazelBuild {
     if (target == null || """".equals(target)) {
       throw new IllegalStateException(""No targets specified"");
     }
-    log.info(""\nBuilding "" + target + "" ..."");
+    log.finest(""\nBuilding "" + target + "" ..."");
 
     ImmutableList.Builder<String> builder = ImmutableList.builder();
     builder.add(""bazel"", ""build"", target);",This is to let people know that the tooling is doing something during a build. Please leave.,js,1,1,1
"@@ -62,6 +62,18 @@ class AdSensePerformanceWidget extends Component {
 					maxAge: getTimeInSeconds( 'day' ),
 					context: [ 'Single', 'Dashboard' ],
 					callback: ( result ) => {
+
+						// If there are no impressions, the site is not yet displaying ads.
+						if (
+							result && result.totals &&
+							(
+								null === result.totals[2] ||
+								0    === result.totals[2]
+							)
+						) {
+							handleZeroData();
+						}
+
 						this.setState( {
 							twentyEightDays: result,
 						} );","Instead of defining a custom condition here, I think it makes sense to rely on `isDataZeroAdSense()` as well. The current check here only checks for impressions, what if there's other data that is greater than zero (see the `isDataZeroAdSense()` function you created)? Just to clarify, of course, whatever this code here is changed to, should also apply to the below `earning-prev28days` callback logic.",js,1,1,1
"@@ -0,0 +1,17 @@
+/**
+ * Internal dependencies
+ */
+import { switchUserToAdmin, switchUserToTest, visitAdminPage } from '@wordpress/e2e-test-utils';
+
+const PLUGIN_SLUG = 'e2e-tests-reset-plugin';
+
+/**
+ * Reset Site Kit using utility plugin.
+ */
+export async function resetSiteKit() {
+	await switchUserToAdmin();
+	await visitAdminPage( 'plugins.php' );
+	await page.click( `tr[data-slug=""${ PLUGIN_SLUG }""] .activate a` );
+	await page.waitForSelector( `tr[data-slug=""${ PLUGIN_SLUG }""]` );
+	await switchUserToTest();
+}",There's a `activatePlugin` utility that can be used for this. So `resetSiteKit()` basically turns into `await activatePlugin( 'e2e-tests-reset-plugin' )`,js,1,1,1
"@@ -159,9 +159,10 @@ Config.prototype.buildArgs = function () {
     // Minimal symbols for target Linux x86, because ELF32 cannot be > 4GiB
     args.symbol_level = 1
   }
-  
-  if (this.targetArch === 'x64' && process.platform === 'linux') {
-    // Include vaapi support 
+
+  if (this.targetArch === 'x64' && process.platform === 'linux' &&
+    this.targetOS !== 'android') {
+    // Include vaapi support
     args.use_vaapi = true
   }
 ",Why are we ever setting this to true? The docs say that this is only for ChromeOS,js,1,1,1
"@@ -0,0 +1,7 @@
+import { getImplicitRole } from '../commons/aria';
+
+function presentationRoleConflictMatches(node) {
+  return getImplicitRole(node) !== null;
+}
+
+export default presentationRoleConflictMatches;","Can you use the virtualNode here instead? We've been moving our rules over to exclusively use virtualNode. Tests can run dramatically faster if the DOM isn't involved, and not all situations where axe-core is used needs to build a complete DOM tree.",js,1,1,1
"@@ -406,7 +406,8 @@ export function unmount(vnode, parentVNode, skipRemove) {
 	if (options.unmount) options.unmount(vnode);
 
 	if ((r = vnode.ref)) {
-		applyRef(r, null, parentVNode);
+		if (!vnode.ref.current || vnode.ref.current === vnode._dom)
+			applyRef(r, null, parentVNode);
 	}
 
 	let dom;","It seems like we can either drop the `r` assignment altogether, or use it for L409 as well? Also - it seems like we can skip nulling the ref if it's already null? (when `!vnode.ref.current`)",js,1,1,1
"@@ -1,8 +1,10 @@
 import styled from 'styled-components'
 import System from './System'
 
-const create = new System({
-  createComponent: type => (...args) => styled(type)([], ...args)
+export const createSystem = (styledFn) => new System({
+  createComponent: type => (...args) => styledFn(type)([], ...args)
 })
 
+const create = createSystem(styled)
+
 export default create","Thanks for this! I was first considering exporting the `System` class itself, since it might eventually take more arguments that the `createComponent` argument. I think also having the empty array as the first argument is only necessary for styled-components, so I'd want to make sure that part is really customizable. The `createComponent` function could also be leveraged to do more than only swap out css-in-js libraries, if that makes sense...",js,1,1,0
"@@ -5,8 +5,15 @@ describe('aria-errormessage', function() {
 	var shadowSupported = axe.testUtils.shadowSupport.v1;
 	var shadowCheckSetup = axe.testUtils.shadowCheckSetup;
 	var checkContext = axe.testUtils.MockCheckContext();
+	var attrData = Object.assign(
+		{},
+		axe.commons.aria.lookupTable.attributes['aria-errormessage']
+	);
 
 	afterEach(function() {
+		axe.commons.aria.lookupTable.attributes[
+			'aria-errormessage'
+		] = Object.assign({}, attrData);
 		fixture.innerHTML = '';
 		checkContext.reset();
 	});",Do we do this object assignment anywhere else? Maybe it makes sense to abstract into a utility that we can reuse?,js,1,1,1
"@@ -105,7 +105,7 @@ public class RequestHandler implements Comparable<RequestHandler> {
   public void process() {
     switch (request.getRequestType()) {
       case START_SESSION:
-        log.info(""Got a request to create a new session: ""
+        log.finest(""Got a request to create a new session: ""
                  + new DesiredCapabilities(request.getDesiredCapabilities()));
         try {
           registry.addNewSessionRequest(this);",This change is unhelpful to users.,js,1,0,1
"@@ -237,6 +237,8 @@ class WebDriver(RemoteWebDriver):
         Returns identifier of installed addon. This identifier can later
         be used to uninstall addon.
 
+        :param path: Full path to the addon that will be installed.
+
         :Usage:
             driver.install_addon('firebug.xpi')
         """"""",Can you update the `Usage` to be an absolute path as well? Something like `/path/to/firebug.xpi`,js,1,1,1
"@@ -19,11 +19,13 @@
 export const STORE_NAME = 'modules/pagespeed-insights';
 export { STORE_NAME as MODULES_PAGESPEED_INSIGHTS };
 
-// Form ID for PageSpeed widget.
-export const FORM_DASH_WIDGET = 'pagespeedDashboardWidget';
 // Report strategies.
 export const STRATEGY_MOBILE = 'mobile';
 export const STRATEGY_DESKTOP = 'desktop';
 // Report data sources.
 export const DATA_SRC_LAB = 'data_lab';
 export const DATA_SRC_FIELD = 'data_field';
+
+// Dashboard widgets using the UI store.
+export const WIDGET_STRATEGY = 'dashboardPageSpeedWidgetStrategy';
+export const WIDGET_DATA_SOURCE = 'dashboardPageSpeedWidgetDataSource';","Let's use a consistent naming format for these key variables across the plugin. I like to keep the constant names short, but maybe we should prefix them to indicate that they are fields for the `core/ui` store. The alternative would be to go with super-verbose names (like what is used for the actual values of these constants), but since these constants are usually not mixed between different components, it should be okay keeping their names short. How about renaming these to `UI_STRATEGY` and `UI_DATA_SOURCE`?",js,1,1,0
"@@ -1229,6 +1229,14 @@ class WebDriver {
     if (target && cdpTargets.indexOf(target.toLowerCase()) === -1) {
       throw new error.InvalidArgumentError('invalid target value')
     }
+
+    if (debuggerAddress.match(/\/se\/cdp/)) {
+      if (debuggerAddress.match(""ws:\/\/"", ""http:\/\/"")) {
+        return debuggerAddress.replace(""ws:\/\/"", ""http:\/\/"") 
+      }
+      return debuggerAddress
+    }
+
     const path = '/json/version'
     let request = new http.Request('GET', path)
     let client = new http.HttpClient('http://' + debuggerAddress)",if we are returning the `ws` here when passing in `se:cdp` we can just return it straight or do we have to make a request to get the `ws` address?,js,1,1,1
"@@ -0,0 +1,11 @@
+(() => {
+  const docusaurusVersions = ['9.0'];
+  const legacyVersions = ['8.3.0', '8.2.0', '8.1.0', '8.0.0', '7.4.2', '7.4.1', '7.4.0', '7.3.0', '7.2.2', '7.2.1', '7.2.0', '7.1.1', '7.1.0', '7.0.3', '7.0.2', '7.0.1', '7.0.0', '6.2.2', '6.2.1', '6.2.0', '6.1.1', '6.1.0', '6.0.1', '6.0.0', '5.0.2', '5.0.1', '5.0.0', '4.0.0', '3.0.0', '2.0.0', ['1.18.1', '0.38.1'], ['1.18.0', '0.38.0'], ['1.17.0', '0.37.0'], ['1.16.0', '0.36.0'], ['1.15.1', '0.35.1'], ['1.15.0', '0.35.0'], ['1.14.3', '0.34.3'], ['1.14.2', '0.34.2'], ['1.14.1', '0.34.1'], ['1.14.0', '0.34.0']];
+  const versions = [...docusaurusVersions, ...legacyVersions];
+
+  if (window.location.hostname === 'dev.handsontable.com') {
+    versions.unshift('next');
+  }
+
+  docVersions && docVersions(versions);
+})();","probably redundant file, please verify",js,1,0,1
"@@ -438,7 +438,12 @@ describe('Connection Pool', function () {
     });
 
     loadSpecTests('connection-monitoring-and-pooling').forEach(test => {
-      it(test.description, function () {
+      const itFn =
+        test.description ===
+        'must aggressively timeout threads enqueued longer than waitQueueTimeoutMS'
+          ? it.skip
+          : it;
+      itFn(test.description, function () {
         const operations = test.operations;
         const expectedEvents = test.events || [];
         const ignoreEvents = test.ignore || [];","This test has been flaky for a long time, if we're okay with skipping I can make a ticket to take a look at this later.",js,1,0,1
"@@ -81,6 +81,7 @@ module.exports = function Dashboard (props) {
       onDrop={props.handleDrop}
     >
       <div
+        aria-hidden=""true""
         className=""uppy-Dashboard-overlay""
         tabIndex={-1}
         onClick={props.handleClickOutside}",Why was this added?,js,1,0,1
"@@ -98,6 +98,8 @@ Blockly.DataCategory.addDataVariable = function(xmlList, variable) {
   //    <field name=""VARIABLE"">variablename</field>
   // </block>
   Blockly.DataCategory.addBlock(xmlList, variable, 'data_variable', 'VARIABLE');
+  // In the flyout, this ID must match variable ID for monitor syncing reasons
+  xmlList[xmlList.length - 1].setAttribute('id', variable.getId());
 };
 
 /**","LG but add an id to the xml on line 97 (`id=""variableId""` or something similar)",js,1,1,1
"@@ -539,7 +539,13 @@ class WebElement(object):
     @property
     def rect(self):
         """"""A dictionary with the size and location of the element.""""""
-        return self._execute(Command.GET_ELEMENT_RECT)['value']
+        if self._w3c:
+            return self._execute(Command.GET_ELEMENT_RECT)['value']
+        else:
+            rect = self.size.copy()
+            rect.update(self.location)
+            return rect
+
 
     @property
     def screenshot_as_base64(self):",flake8 is going to fail on this having 2 lines,js,1,1,1
"@@ -12,6 +12,7 @@ function autocompleteAppropriateEvaluate(node, options, virtualNode) {
   const allowedTypesMap = {
     bday: ['text', 'search', 'date'],
     email: ['text', 'search', 'email'],
+    username: ['email'],
     'street-address': ['text'], // Issue: https://github.com/dequelabs/axe-core/issues/1161
     tel: ['text', 'search', 'tel'],
     'tel-country-code': ['text', 'search', 'tel'],",I believe to fix the test we'll need this to also include `text` and probably `search`. Otherwise it's restricted to just `type=email`.,js,1,1,1
"@@ -113,9 +113,9 @@ export function diffChildren(
 
 		newDom = childInternal._dom;
 
-		if (childVNode.ref) {
+		if (childVNode.ref || oldVNodeRef) {
 			if (!refs) refs = [];
-			childInternal.ref = childVNode.ref
+			childInternal.ref = childVNode.ref;
 			refs.push(
 				oldVNodeRef,
 				childVNode.ref,","Wondering if we even need the conditional here, or could just always assign.",js,1,1,1
"@@ -1,14 +1,16 @@
+import { translationMacro as t } from 'ember-i18n';
 import AbstractModuleRoute from 'hospitalrun/routes/abstract-module-route';
 import FulfillRequest from 'hospitalrun/mixins/fulfill-request';
 import InventoryId from 'hospitalrun/mixins/inventory-id';
 import InventoryLocations from 'hospitalrun/mixins/inventory-locations'; // inventory-locations mixin is needed for fulfill-request mixin!
 export default AbstractModuleRoute.extend(FulfillRequest, InventoryId, InventoryLocations, {
   addCapability: 'add_inventory_item',
+  buttonText: t('navigation.subnav.inventoryReceived'),
   additionalButtons: function() {
     if (this.currentUserCan(this.get('addCapability'))) {
       return [{
         buttonAction: 'newInventoryBatch',
-        buttonText: '+ inventory received',
+        buttonText: this.get('buttonText'),
         class: 'btn btn-primary'
       }];
     }","This buttonText should use a separate localization entry, not reuse the one from the subnav (the text is intentionally lowercase for the button).",js,1,1,1
"@@ -40,12 +40,7 @@ function getAttributeNameValue(node, at) {
   if (name.indexOf('href') !== -1 || name.indexOf('src') !== -1) {
     const friendly = getFriendlyUriEnd(node.getAttribute(name));
     if (friendly) {
-      const value = encodeURI(friendly);
-      if (value) {
-        atnv = escapeSelector(at.name) + '$=""' + escapeSelector(value) + '""';
-      } else {
-        return;
-      }
+      atnv = escapeSelector(at.name) + '$=""' + friendly + '""';
     } else {
       atnv =
         escapeSelector(at.name) +",Need to make the same change on line 48,js,1,0,1
"@@ -46,13 +46,13 @@ export function createMethod(type, name, mutates) {
             throw new TypeError(name + ' method was called on an object of the wrong type!');
         }
 
-        let result = rpc.callMethod(realmId, id, name, Array.from(arguments));
-
-        if (mutates) {
-            fireMutationListeners(realmId);
+        try {
+            return rpc.callMethod(realmId, id, name, Array.from(arguments));
+        } finally {
+            if (mutates) {
+                fireMutationListeners(realmId);
+            }
         }
-
-        return result;
     };
 }
 ",what gets returns if this throws?,js,1,1,1
"@@ -1,5 +1,14 @@
+import windowIsTopMatches from './window-is-top-matches';
+
 function bypassMatches(node) {
-	return !!node.querySelector('a[href]');
+	// the top level window should have an anchor
+	if (windowIsTopMatches(node)) {
+		return !!node.querySelector('a[href]');
+	}
+
+	// all iframes do not need an anchor but should be checked for bypass
+	// elements (headings, landmarks, etc.)
+	return true;
 }
 
 export default bypassMatches;",I'm kind of confused about what you are trying to accomplish here. I don't see how pages having native links is relevant to whether or not they need a mechanism for bypassing repeating content.,js,1,1,1
"@@ -83,15 +83,16 @@ function HelpMenu( { children } ) {
 					ref={ menuRef }
 					menuOpen={ menuOpen }
 					id=""googlesitekit-help-menu""
+					onSelected={ () => {} }
 				>
 					{ children }
-					<HelpMenuLink href=""https://sitekit.withgoogle.com/documentation/fix-common-issues/"">
+					<HelpMenuLink gaEventLabel=""fix_common_issues"" href=""https://sitekit.withgoogle.com/documentation/fix-common-issues/"">
 						{ __( 'Fix common issues', 'google-site-kit' ) }
 					</HelpMenuLink>
-					<HelpMenuLink href=""https://sitekit.withgoogle.com/documentation/"">
+					<HelpMenuLink gaEventLabel=""documentation"" href=""https://sitekit.withgoogle.com/documentation/"">
 						{ __( 'Read help docs', 'google-site-kit' ) }
 					</HelpMenuLink>
-					<HelpMenuLink href=""https://wordpress.org/support/plugin/google-site-kit/"">
+					<HelpMenuLink gaEventLabel=""support_forum"" href=""https://wordpress.org/support/plugin/google-site-kit/"">
 						{ __( 'Get support', 'google-site-kit' ) }
 					</HelpMenuLink>
 				</Menu>","Instead of adding an empty function here, let's better add it as a default prop in the Menu component itself.",js,1,1,1
"@@ -93,7 +93,7 @@ Blockly.WorkspaceDragSurfaceSvg.prototype.createDom = function() {
     'xmlns:html': Blockly.HTML_NS,
     'xmlns:xlink': 'http://www.w3.org/1999/xlink',
     'version': '1.1',
-    'class': 'blocklyWsDragSurface'
+    'class': 'blocklyWsDragSurface blocklyOverflowVisible'
   }, null);
   this.container_.appendChild(this.SVG_);
 };",To fix an eslint warning (comma-dangle) delete the trailing comma.,js,1,1,1
"@@ -143,8 +143,10 @@ function Cursor(bson, ns, cmd, options, topology, topologyOptions) {
     promiseLibrary: promiseLibrary,
     // Current doc
     currentDoc: null,
+    // expicitlyDoNotUseSession
+    expicitlyDoNotUseSession: options.expicitlyDoNotUseSession,
     // Optional ClientSession
-    session: options.session
+    session: options.explicitlyDoNotUseSession ? undefined : options.session
   };
 
   // Translate correctly",typo: `expicitly` should be `explicitly`,js,1,1,1
"@@ -34,15 +34,12 @@ define(['apphost', 'userSettings', 'browser', 'events', 'pluginManager', 'backdr
             id: ""dark"",
             isDefault: true,
             isDefaultServerDashboard: true
-        }, {
-            name: ""Emby"",
-            id: ""emby""
         }, {
             name: ""Light"",
             id: ""light""
         }, {
             name: ""Purple Haze"",
-            id: ""purple-haze""
+            id: ""purplehaze""
         }, {
             name: ""Windows Media Center"",
             id: ""wmc""",why not rename to `emerald`?,js,1,0,1
"@@ -1,9 +1,8 @@
-const { h } = require('preact')
+const { h, Fragment } = require('preact')
 
-// TODO use Fragment when upgrading to preact X
 const Breadcrumb = (props) => {
   return (
-    <span>
+    <Fragment>
       <button
         type=""button""
         className=""uppy-u-reset""",I believe this can be simplified even further by just using `<>` and `</>` instead of having to import Fragment,js,1,1,1
"@@ -38,7 +38,7 @@ module.exports = {
   i18n: i18nConfig,
   plugins: [
     'docusaurus-plugin-sass',
-    isProductionDeployment && ['docusaurus-plugin-sentry', { dsn: 'a7bc89ee3f284570b1d9a47e600e7597' }]
+    isProductionDeployment && ['docusaurus-plugin-sentry', { DSN: 'a7bc89ee3f284570b1d9a47e600e7597' }]
   ].filter(Boolean),
   webpack: {
     jsLoader: (isServer) => ({","hehe, javascript :D and his case sensitive",js,1,0,0
"@@ -1,5 +1,8 @@
+import cache from '../core/base/cache';
+
 function windowIsTopMatches(node) {
 	return (
+		cache.get('isTopWindow') ||
 		node.ownerDocument.defaultView.self === node.ownerDocument.defaultView.top
 	);
 }","Why not pass the options around, or record what we think is the top level in the context object and pass that around? This is basically using the cache as a way to create global variables. Global variables is something we're trying to get out of, lets not add more of them.",js,1,1,1
"@@ -580,19 +580,6 @@ module.exports = [
 			},
 		},
 	},
-	{
-		id: 'wordpress--wordpress-activation',
-		kind: 'WordPress',
-		name: 'WordPress Activation',
-		story: 'WordPress Activation',
-		parameters: {
-			fileName: './stories/wp-activation.stories.js',
-			options: {
-				hierarchyRootSeparator: '|',
-				hierarchySeparator: {},
-			},
-		},
-	},
 	{
 		id: 'wordpress--wordpress-dashboard',
 		kind: 'WordPress',",Thanks so much for this fix! I wouldn't have thought to look in that folder to fix the tests!,js,1,0,1
"@@ -330,6 +330,10 @@ var jsonpatch;
             generate(observer);
             clearTimeout(observer.next);
             removeObserverFromMirror(mirror, observer);
+            if (mirror.observers.length === 0)
+            {
+                beforeDict.splice(beforeDict.indexOf(mirror), 1);
+            }
             if (typeof window !== 'undefined') {
                 if (window.removeEventListener) {
                     window.removeEventListener('mousedown', fastCheck);",Incorrect format - braces must be on this same line after the preceding closing brace.,js,1,1,1
"@@ -23,14 +23,13 @@ import Data from 'googlesitekit-data';
 import authentication from './authentication';
 import dateRange from './date-range';
 import disconnect from './disconnect';
+import inputSettings from './input-settings';
 import { createErrorStore } from '../../data/create-error-store';
 import notifications from './notifications';
 import permissions from './permissions';
 import userInfo from './user-info';
 import { STORE_NAME } from './constants';
 
-export { STORE_NAME };
-
 const store = Data.combineStores(
 	Data.commonStore,
 	authentication,","Nitpicking, but let's call this file `user-input-settings.js` since ""User Input"" is kind of a semi-internal codename for this feature. ""input"" on its own therefore isn't as clear here.",js,1,1,1
"@@ -30,7 +30,7 @@ storiesOf( 'Dashboard', module )
 		<DashboardModuleHeader
 			title={ __( 'Module Header', 'google-site-kit' ) }
 			description={ __( 'Description of Module', 'google-site-kit' ) }
-			timePeriod={ __( 'Last 28 Days', 'google-site-kit' ) }
+			timePeriod={ __( 'Last 28 days', 'google-site-kit' ) }
 		/>
 	) )
 	.add( 'All Traffic', () => {",I think we might want to keep title case here.,js,1,1,1
"@@ -132,10 +132,8 @@ export function diff(parentDom, newVNode, oldVNode, context, isSvg, excessDomChi
 
 			c.base = newVNode._dom;
 
-			while (tmp=c._renderCallbacks.pop()) {
-				if (c._nextState) { c.state = c._nextState; }
-				tmp.call(c);
-			}
+			tmp = c._renderCallbacks; c._renderCallbacks=[];
+			tmp.some(cb => cb.call(c));
 
 			// Don't call componentDidUpdate on mount or when we bailed out via
 			// `shouldComponentUpdate`",Nit: let's newline this,js,1,1,1
"@@ -2,9 +2,12 @@ if (node.getAttribute('id')) {
 	const root = axe.commons.dom.getRootNode(node);
 	const id = axe.commons.utils.escapeSelector(node.getAttribute('id'));
 	const label = root.querySelector(`label[for=""${id}""]`);
+	const isLabelVisible = label && axe.commons.dom.isVisible(label);
 
-	if (label && !axe.commons.dom.isVisible(label)) {
-		return true;
+	if (isLabelVisible === false) {
+		const name = axe.commons.text.accessibleTextVirtual(virtualNode).trim();
+		const isNameEmpty = name === '';
+		return isNameEmpty;
 	}
 }
 return false;",I think this now fails if there is no label. Should probably just put the if statement back to the way it was.,js,1,1,1
"@@ -77,7 +77,7 @@ const nordStyle = {
 	htmlCodeBorderColor: nord[2],
 	htmlCodeColor: nord[13],
 
-	editorTheme: 'chaos',
+	editorTheme: 'terminal',
 	codeThemeCss: 'atom-one-dark-reasonable.css',
 };
 ","In AceEditor.tsx, you've added the ""tomorrow"" theme, and ""twilight"" was already present, however you didn't add ""terminal"". Isn't it an issue?",js,1,1,1
"@@ -9,3 +9,14 @@ export function assign(obj, props) {
 	for (let i in props) obj[i] = props[i];
 	return /** @type {O & P} */ (obj);
 }
+
+/**
+ * Remove a child node from its parent if attached. This is a workaround for
+ * IE11 which doesn't support `Element.prototype.remove()`. Using this function
+ * is smaller than including a dedicated polyfill.
+ * @param {Node} node The node to remove
+ */
+export function removeNode(node) {
+	let parentNode = node.parentNode;
+	if (parentNode) parentNode.removeChild(node);
+}",This is an opportunity with a module build to remove the additional method via build system transform.,js,1,1,1
"@@ -19,6 +19,7 @@
 ""use strict"";
 
 const {promisify} = require(""./utils.js"");
+const { realpath } = require(""fs"");
 
 const instanceMethods = {
     logIn(credentials) {",This looks like an auto-complete error? :),js,1,1,1
"@@ -105,7 +105,7 @@ class SearchConsole extends Component {
 						propertyMatches[ 0 ].siteUrl
 					);
 				} else {
-					errorMessage = __( 'We found no verified accounts, would you like to verify this URL?', 'google-site-kit' );
+					errorMessage = __( 'We did not find a Search Console property for this site, would you like to create one?', 'google-site-kit' );
 				}
 
 				setErrorMessage( errorMessage );","Can you change the message to `Your site has not yet been added to Search Console. Would you like to add it now?` please, which is found in #600?",js,0,1,1
"@@ -32,9 +32,10 @@ describe('createElement(jsx)', () => {
 		expect(<Test />).to.have.property('type', Test);
 	});
 
-	it('should set VNode._self property to prevent json injection', () => {
+	it('should set VNode.constructor property to prevent json injection', () => {
 		const vnode = <span />;
-		expect(vnode._self).to.equal(vnode);
+		// eslint-disable-next-line no-proto
+		expect(vnode.constructor).to.equal(undefined);
 	});
 
 	it('should set VNode#props property', () => {",Guess this one is a left over from the proto approach?,js,1,1,1
"@@ -9,6 +9,10 @@ const databaseNamespace = require('./shared').databaseNamespace;
 const isTransactionCommand = require('../transactions').isTransactionCommand;
 const applySession = require('../sessions').applySession;
 
+function isClientEncryptionEnabled(server) {
+  return server && server.s && server.s.options && server.s.options.autoEncrypter;
+}
+
 function command(server, ns, cmd, options, callback) {
   if (typeof options === 'function') (callback = options), (options = {});
   options = options || {};","This could be follow-on work, but it would be nice to have `server.autoEncrypter` similar to `collection.readConcern` so we don't have to do this long check here.",js,1,1,1
"@@ -189,8 +189,8 @@ Blockly.Css.CONTENT = [
   '}',
 
   '.blocklyDragging>.blocklyPath {',
-    'fill-opacity: .8;',
-    'stroke-opacity: .8;',
+    // 'fill-opacity: .8;',
+    // 'stroke-opacity: .8;',
   '}',
 
   '.blocklyDisabled>.blocklyPath {',",Can we completely remove this?,js,1,0,1
"@@ -38,6 +38,8 @@ namespace VuFind\Sitemap;
  */
 class Sitemap extends AbstractFile
 {
+    const XHTML_NAMESPACE = 'xmlns:xhtml=""http://www.w3.org/1999/xhtml""';
+
     /**
      * Frequency of URL updates (always, daily, weekly, monthly, yearly, never)
      *",We should set this public or protected to keep PHPStan happy when we raise its level in the future.,php,1,1,1
"@@ -22,11 +22,13 @@ class MediaManager extends BaseDocumentManager
     {
         // BC compatibility for $context parameter
         if ($andFlush && is_string($andFlush)) {
+            @trigger_error(sprintf('Since version 2.2.7, passing context in argument 2 for %s() is deprecated and support for it will be removed in 3.0. Use %s::setContext() instead.', __METHOD__, $this->class), E_USER_DEPRECATED);
             $entity->setContext($andFlush);
         }
 
         // BC compatibility for $providerName parameter
         if (3 == func_num_args()) {
+            @trigger_error(sprintf('Since version 2.2.7, passing provider name in argument 3 for %s() is deprecated and support for it will be removed in 3.0. Use %s::setProviderName() instead.', __METHOD__, $this->class), E_USER_DEPRECATED);
             $entity->setProviderName(func_get_arg(2));
         }
 ",please line break this!,php,1,1,0
"@@ -142,12 +142,12 @@ class BrandFacade
     /**
      * @param int $brandId
      */
-    public function deleteById($brandId)
+    public function deleteById(int $brandId): void
     {
         $brand = $this->brandRepository->getById($brandId);
         $this->em->remove($brand);
-
         $this->dispatchBrandEvent($brand, BrandEvent::DELETE);
+        $this->friendlyUrlFacade->removeFriendlyUrlsForAllDomains('front_brand_detail', $brandId);
 
         $this->em->flush();
     }",Can you please state this change in upgrade notes as it's BC break? (also please update PR description - BC breaks: yes),php,0,1,1
"@@ -110,7 +110,7 @@ array_map(
                 );
                 exit(1);
             }
-        } elseif (substr($arg, 0, 2) === '-' && $arg !== '-' && $arg !== '--') {
+        } elseif (substr($arg, 0, 1) === '-' && $arg !== '-' && $arg !== '--') {
             $arg_name = preg_replace('/=.*$/', '', substr($arg, 1));
 
             if (!in_array($arg_name, $valid_short_options) && !in_array($arg_name . ':', $valid_short_options)) {","The bug fix in this PR was noticed when looking at a check that `in_array()` is always explicitly passed a third argument for $strict. It doesn't matter now, but might matter if `-0` becomes an option, because `'0' == '0e1'` (strings are cast to numbers to compare if both are numeric)",php,1,1,1
"@@ -376,6 +376,13 @@ class AdminController extends Controller
      */
     protected function createEditForm($entity, array $entityProperties)
     {
+        $servicename = sprintf('form.type.%s', strtolower($this->entity['name']));
+
+		if($this->get('service_container')->has($servicename))
+		{
+			return $this->createForm( $this->get($servicename), $entity	);
+		}
+        
         $form = $this->createFormBuilder($entity, array(
             'data_class' => $this->entity['class'],
         ));","Maybe this should be prefixed with the `easyadmin` namespace ? (**_i.e**_: easyadmin.form.type.<entityname>) Or something more appropriate, as the form will not really be part of the bundle.",php,1,1,1
"@@ -1227,7 +1227,7 @@ bool CLIENT_STATE::enforce_run_list(vector<RESULT*>& run_list) {
     // and prune those that can't be assigned
     //
     assign_coprocs(run_list);
-    bool scheduled_mt = false;
+    //bool scheduled_mt = false;
 
     // prune jobs that don't fit in RAM or that exceed CPU usage limits.
     // Mark the rest as SCHEDULED",Can this line be removed?,php,1,0,1
"@@ -31,10 +31,9 @@ class ImportErrorsGrid extends AbstractGrid
         $id->setVisible(false);
         $this->addColumn('id', $id);
 
-        $this->addColumn('line', new NumericColumn('line', 'Record number', new NumericFilter()));
         $this->addColumn('created_at', new TextColumn('created_at', 'Created at', new DateFilter()));
         $this->addColumn('message', new TextColumn('message', 'Error description', new TextFilter()));
 
-        $this->orderBy('line', 'ASC');
+        $this->orderBy('id', 'ASC');
     }
 }",If `id` is not numeric I thing is better order by column `created_at`?,php,1,1,1
"@@ -50,7 +50,7 @@ class SolrConfigStatus implements StatusProviderInterface
      *
      * @var string
      */
-    const RECOMMENDED_SOLRCONFIG_VERSION = 'tx_solr-4-0-0--20160406';
+    const RECOMMENDED_SOLRCONFIG_VERSION = 'tx_solr-6-0-0--20160725';
 
     /**
      * Compiles a collection of solrconfig version checks against each configured","solrconfig didn't change, did it?",php,1,0,1
"@@ -160,6 +160,11 @@ class Configuration implements ConfigurationInterface
     private function addGlobalOptionsSection(ArrayNodeDefinition $rootNode)
     {
         $rootNode
+            ->beforeNormalization()
+                ->ifTrue(function ($v) { return isset($v['default_templates']); })
+                ->thenInvalid('The ""default_templates"" key is reserved for internal use and cannot be defined. It contains the templates to use when no entity configuration is available (for example in exception pages).')
+            ->end()
+
             ->children()
                 ->scalarNode('site_name')
                     ->defaultValue('Easy Admin')","Why ""exposing"" it in the bundle's configuration if it's only available as of processed metadata ?",php,1,1,1
"@@ -89,7 +89,7 @@ class CartFacadeDeleteOldCartsTest extends TransactionFunctionalTestCase
 
     /**
      * @param int $productId
-     * @return \Shopsys\ShopBundle\Model\Product\Product
+     * @return \Shopsys\FrameworkBundle\Model\Product\Product
      */
     private function getProductById($productId)
     {",symfony extension for new PR ?,php,0,1,1
"@@ -21,7 +21,7 @@ class ArticleTest extends TransactionFunctionalTestCase
     private $articleFactory;
 
     /**
-     * @var \Doctrine\ORM\EntityManager
+     * @var \Shopsys\FrameworkBundle\Component\EntityExtension\EntityManagerDecorator
      */
     private $em;
 ",OK now it make sense and also that `flush($entityInstance)`,php,1,0,1
"@@ -119,7 +119,13 @@ final class VimeoProvider extends BaseVideoProvider
 
     public function getReferenceUrl(MediaInterface $media): string
     {
-        return sprintf('https://vimeo.com/%s', $media->getProviderReference());
+        $providerReference = $media->getProviderReference();
+
+        if (null === $providerReference) {
+            return '';
+        }
+
+        return sprintf('https://vimeo.com/%s', $providerReference);
     }
 
     protected function fixBinaryContent(MediaInterface $media): void",Same thing about references to videos.,php,0,1,1
"@@ -93,6 +93,10 @@ class ForeachAnalyzer
 
         if ($stmt->valueVar instanceof PhpParser\Node\Expr\Variable && is_string($stmt->valueVar->name)) {
             $safe_var_ids['$' . $stmt->valueVar->name] = true;
+            $statements_analyzer->foreach_var_locations['$' . strtolower($stmt->valueVar->name)][] = new CodeLocation(
+                $statements_analyzer,
+                $stmt->valueVar
+            );
         } elseif ($stmt->valueVar instanceof PhpParser\Node\Expr\List_) {
             foreach ($stmt->valueVar->items as $list_item) {
                 if (!$list_item) {",why are you normalising the variable name? Variables in PHP are case-sensitive.,php,1,1,1
"@@ -951,11 +951,10 @@ class UpdateManager
         return base64_encode(hash_hmac('sha512', http_build_query($data, '', '&'), base64_decode($secret), true));
     }
 
-    //
-    // Internals
-    //
-
-    protected function getMigrationTableName()
+    /**
+     * @return string
+     */
+    public function getMigrationTableName()
     {
         return Config::get('database.migrations', 'migrations');
     }",Please check to make sure your linters haven't screwed with OctoberCMS stuff before making PRs ;),php,1,1,1
"@@ -45,6 +45,7 @@ final class Version20190818160000 extends AbstractErgonodeMigration
             'Ergonode\Workflow\Domain\Event\Workflow\WorkflowStatusRemovedEvent' => 'Deleted status from workflow',
             'Ergonode\Workflow\Domain\Event\Workflow\WorkflowTransitionAddedEvent' => 'Added transition to workflow',
             'Ergonode\Workflow\Domain\Event\Workflow\WorkflowTransitionRemovedEvent' => 'Deleted transition from workflow',
+            'Ergonode\Workflow\Domain\Event\Workflow\WorkflowDeletedEvent' => 'Workflow deleted',
         ]);
     }
 ",There should be also translations for event,php,1,1,1
"@@ -2038,11 +2038,6 @@ class ClassTemplateTest extends TestCase
                         public function __construct(Foo $v) {
                             $this->vector = $v;
                         }
-
-                        public function getIterator(): Iterator
-                        {
-                            yield from $this->vector;
-                        }
                     }',
                 [],
                 ['TooManyTemplateParams']",Why are you removing this? The test isn't testing anything proper without this yield,php,1,1,1
"@@ -557,14 +557,14 @@ class Layout_Blog extends Base_Customizer {
 		);
 
 		if ( empty( $value ) ) {
-			return $allowed;
+			return wp_json_encode( $allowed );
 		}
 
 		$decoded = json_decode( $value, true );
 
 		foreach ( $decoded as $val ) {
 			if ( ! in_array( $val, $allowed, true ) ) {
-				return $allowed;
+				return wp_json_encode( $allowed );
 			}
 		}
 ","Same thing here: the sanitize function should only confirm that the format is proper, not adapt it.",php,1,1,1
"@@ -103,4 +103,14 @@ class Missing extends DefaultRecord
         $title = parent::getShortTitle();
         return empty($title) ? $this->determineMissingTitle() : $title;
     }
+
+    /**
+     * Get an array of all the formats associated with the record.
+     *
+     * @return array
+     */
+    public function getFormats()
+    {
+        return ['other'];
+    }
 }","As a side effect, I think this is going to cause an untranslated ""other"" text to appear next to placeholder entries for missing records in lists. Would it be better to use 'Unknown' here to leverage existing translations, or does that not work in other ways?",php,1,1,1
"@@ -17,11 +17,15 @@ use Nette\Utils\Strings;
 class ErgoPrinter extends Printer
 {
     /**
+     * {@inheritdoc}
+     *
      * @var string
      */
     protected $indentation = '    ';
 
     /**
+     * {@inheritdoc}
+     *
      * @var int
      */
     protected $linesBetweenMethods = 1;",Why whithout type?,php,1,0,1
"@@ -13,7 +13,7 @@ class Currency
     const CODE_CZK = 'CZK';
     const CODE_EUR = 'EUR';
 
-    const DEFAULT_EXCHANGE_RATE = 1;
+    const DEFAULT_EXCHANGE_RATE = '1';
 
     /**
      * @var int","to me, it looks more like recasting than fixing typehint, but OK does make sense to join `Currency DEFAULT_EXCHANGE_RATE` into `Currency::$DEFAULT_EXCHANGE_RATE` ?",php,1,1,1
"@@ -456,6 +456,11 @@ func writeDrupal6DdevSettingsFile(settings *DrupalSettings, filePath string) err
 // WriteDrushrc writes out drushrc.php based on passed-in values.
 // This works on Drupal 6 and Drupal 7 or with drush8 and older
 func WriteDrushrc(app *DdevApp, filePath string) error {
+	// Ignore because this is a settings file.
+	if app.DisableSettingsManagement {
+		return nil
+	}
+
 	if fileutil.FileExists(filePath) {
 		// Check if the file is managed by ddev.
 		signatureFound, err := fileutil.FgrepStringInFile(filePath, DdevFileSignature)","This isn't incorrect IMO, but I think it would be better to fix this in drupal7PostStartAction and also in drupal6PostStartAction. It seems to me like those were both somehow neglected on this. Use drupal8PostStartAction as example. Congrats on your first golang PR! Please make sure to test it manually.",php,1,1,1
"@@ -32,8 +32,11 @@ class ActionConfigPass implements ConfigPassInterface
     {
         $backendConfig = $this->processDisabledActions($backendConfig);
         $backendConfig = $this->normalizeActionsConfig($backendConfig);
+        $backendConfig = $this->normalizeBatchActionsConfig($backendConfig);
         $backendConfig = $this->resolveActionInheritance($backendConfig);
+        $backendConfig = $this->resolveBatchActionInheritance($backendConfig);
         $backendConfig = $this->processActionsConfig($backendConfig);
+        $backendConfig = $this->processBatchActionsConfig($backendConfig);
 
         return $backendConfig;
     }","(To facilitate the review) all new code related to this file is a copy-paste of `*ActionsConfig()` methods, removing the `foreach($this->views as $view)` statements and hardcoding the `list` view value.",php,0,1,1
"@@ -10,15 +10,15 @@ return [
         'invalid_file_extension' => 'Extensión de archivo inválida: :invalid. Las extensiones permitidas son: :allowed.',
         'error_deleting' => 'Error borrando el archivo template "":name"". Por favor, revisa los permisos de escritura.',
         'delete_success' => 'Los templates fueron borrados satisfactoriamente: :count.',
-	'file_name_required' => 'Falta el nombre del campo del archivo.',
-	'safe_mode_enabled' => 'Modo seguro esta actualmente activado.'
+    'file_name_required' => 'Falta el nombre del campo del archivo.',
+    'safe_mode_enabled' => 'Modo seguro esta actualmente activado.'
     ],
     'dashboard' => [
         'active_theme' => [
             'widget_title_default' => 'Sitio Web',
             'online' => 'en línea',
             'maintenance' => 'en mantenimiento',
-	    'manage_themes' => 'Gestionar plantilla'
+        'manage_themes' => 'Gestionar plantilla'
         ]
     ],
     'theme' => [","Why was this merged @daftspunk? This isn't even consistent reformatting, it looks automated to me.",php,0,1,1
"@@ -13,6 +13,9 @@ use Shopsys\FrameworkBundle\Model\Product\Exception\ProductNotFoundException;
 use Shopsys\FrameworkBundle\Model\Product\Product;
 use Shopsys\FrameworkBundle\Model\Product\ProductFacade;
 
+/**
+ * @deprecated Use ProductByUuidResolver instead
+ */
 class ProductResolver implements ResolverInterface, AliasedInterface
 {
     /**",I am missing reason why is this class renamed. It is just obout naming or it has some other reason I do not see now?,php,1,1,1
"@@ -42,7 +42,7 @@ trait PsalmRunnerTrait
             $process->mustRun();
         } else {
             $process->run();
-            $this->assertGreaterThan(0, $process->getExitCode());
+            $this->assertEquals(2, $process->getExitCode());
         }
 
         return [","As Psalm now always return exit code 2 when it detects issues, we expect that when `$shouldFail === true`, and let unexpected exceptions be reported as test failures.",php,1,1,1
"@@ -195,7 +195,9 @@ BEGIN_EVENT_TABLE (CAdvancedFrame, CBOINCBaseFrame)
     EVT_MENU(ID_HELPBOINCMANAGER, CAdvancedFrame::OnHelpBOINC)
     EVT_MENU(ID_HELPBOINCWEBSITE, CAdvancedFrame::OnHelpBOINC)
     EVT_MENU(wxID_ABOUT, CAdvancedFrame::OnHelpAbout)
+#ifdef ENABLE_NEW_VERSION_CHECK
     EVT_MENU(ID_CHECK_VERSION, CAdvancedFrame::OnCheckVersion)
+#endif
     EVT_MENU(ID_REPORT_BUG, CAdvancedFrame::OnReportBug)
     EVT_HELP(wxID_ANY, CAdvancedFrame::OnHelp)
     // Custom Events & Timers","As I told you before, there are two additional OSs we support: Windows and OSX. If you build BOINC Manager for linux to control BOINC client for linux - this works perfect. But if you decide to control BOINC client for Windows or OSX with BOINC Manager for Linux - then you'll have no way to check for a new version of BOINC client for that particular OS. The same if applicable for BOINC Manager for Windows or OSX, I'll have an option to check for a new version that will do basically nothing because this functionality just dropped from the BOINC client for linux.",php,0,1,0
"@@ -77,7 +77,7 @@ static void get_user_agent_string() {
     );
     if (strlen(gstate.client_brand)) {
         char buf[256];
-        snprintf(buf, sizeof(buf), "" (%s)"", gstate.client_brand);
+        snprintf(buf, sizeof(buf), "" (%.80s)"", gstate.client_brand);
         safe_strcat(g_user_agent_string, buf);
     }
 }",Why this is cut to 80 symbols?,php,1,1,1
"@@ -30,7 +30,7 @@ var DBATag = ""v0.2.0""
 var RouterImage = ""drud/nginx-proxy"" // Note that this is overridden by make
 
 // RouterTag defines the tag used for the router.
-var RouterTag = ""v0.3.0"" // Note that this is overridden by make
+var RouterTag = ""router-expose"" // Note that this is overridden by make
 
 // COMMIT is the actual committish, supplied by make
 var COMMIT = ""COMMIT should be overridden""",Update to real tag before pull.,php,1,1,1
"@@ -29,6 +29,19 @@ class Customer
      */
     protected $billingAddresses;
 
+    /**
+     * @var \Shopsys\FrameworkBundle\Model\Customer\DeliveryAddress[]|\Doctrine\Common\Collections\Collection
+     *
+     * @ORM\OneToMany(targetEntity=""Shopsys\FrameworkBundle\Model\Customer\DeliveryAddress"", mappedBy=""customer"", cascade={""persist""})
+     */
+    protected $deliveryAddresses;
+
+    public function __construct()
+    {
+        $this->billingAddresses = new ArrayCollection();
+        $this->deliveryAddresses = new ArrayCollection();
+    }
+
     /**
      * @param \Shopsys\FrameworkBundle\Model\Customer\BillingAddress $billingAddress
      */",I'm not sure if this change doesn't break the application.. because before it would set billing addresses to an empty collection and then add one. Now it seems that there could be more addresses,php,1,1,1
"@@ -11,12 +11,16 @@
 
 namespace Sonata\MediaBundle\CDN;
 
+use Symfony\Bundle\FrameworkBundle\Templating\Helper\AssetsHelper;
+
 class Server implements CDNInterface
 {
+    protected $path;
+
     /**
-     * @var string
+     * @var AssetsHelper
      */
-    protected $path;
+    private $assetsHelper;
 
     /**
      * @param string $path",this is a BC break,php,1,0,1
"@@ -123,4 +123,9 @@ interface ProductOnCurrentDomainFacadeInterface
      * @return array
      */
     public function getProductsOnCurrentDomain(int $limit, int $offset, string $orderingModeId): array;
+
+    /**
+     * @return int
+     */
+    public function getProductsCountOnCurrentDomain(): int;
 }",Should it be called `getAllListableProductCount...`?,php,1,1,1
"@@ -35,8 +35,11 @@ class CurlDownloader implements DownloaderInterface
      *
      * @throws DownloaderException
      */
-    public function download(string $url, array $headers = []): string
+    public function download(string $url, array $headers = [], string $acceptedHeaderTypes = null): string
     {
+        if (null !== $acceptedHeaderTypes) {
+            throw new DownloaderException('CurlDownloader not supported param `acceptedHeaderTypes`');
+        }
         $ch = curl_init();
         curl_setopt($ch, CURLOPT_HEADER, 0);
         curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);","IMHO acceptedHeaderTypes should be array not string, or I miss somthing ??",php,1,1,1
"@@ -26,7 +26,7 @@ class IndependentTransportVisibilityCalculationTest extends TransactionFunctiona
     private $independentTransportVisibilityCalculation;
 
     /**
-     * @var \Shopsys\FrameworkBundle\Model\Transport\TransportDataFactoryInterface
+     * @var \App\Model\Transport\TransportDataFactory
      * @inject
      */
     private $transportDataFactory;",Why is it necessary to replace interfaces with class?,php,1,1,1
"@@ -16,9 +16,7 @@ use Sonata\MediaBundle\Model\MediaInterface;
 interface GeneratorInterface
 {
     /**
-     * @abstract
-     *
-     * @param \Sonata\MediaBundle\Model\MediaInterface $media
+     * @param MediaInterface $media
      *
      * @return string
      */",why removing this? @core23 ping @Soullivaneuh,php,0,0,1
"@@ -237,6 +237,7 @@ class ReturnTypeAnalyzer
             foreach ($inferred_return_type_parts as $inferred_return_type_part) {
                 if ($inferred_return_type_part->isVoid()) {
                     $unsafe_return_type = true;
+                    break;
                 }
             }
         }",Loops that only flags a variable should break as soon as possible to avoid useless iterations.,php,1,1,1
"@@ -1,6 +1,7 @@
 <?php
 namespace Psalm\Tests;
 
+use Person;
 use Psalm\Tests\Traits\InvalidCodeAnalysisTestTrait;
 use Psalm\Tests\Traits\ValidCodeAnalysisTestTrait;
 ","Not sure how that will play out, this is not an existing class",php,1,1,1
"@@ -158,14 +158,6 @@ class Controller extends ControllerBase
          */
         $this->user = BackendAuth::getUser();
 
-        /*
-         * Media Manager widget is available on all back-end pages
-         */
-        if ($this->user && $this->user->hasAccess('media.*')) {
-            $manager = new MediaManager($this, 'ocmediamanager');
-            $manager->bindToController();
-        }
-
         $this->extendableConstruct();
     }
 ",@alxy @bennothommo doesn't this mean that the MediaManager widget is now bound to the controller once for every single instance of a field that uses it? That seems a bit excessive.,php,0,1,1
"@@ -60,8 +60,11 @@ class DbalLogQuery implements LogQueryInterface
     private function getQuery(): QueryBuilder
     {
         return $this->connection->createQueryBuilder()
-            ->select('es.id, event, payload, recorded_at, recorded_by AS author_id, coalesce(u.first_name || \' \' || u.last_name, \'System\') AS author')
-            ->leftJoin('es', 'users', 'u', 'u.id = es.recorded_by')
-            ->from('event_store', 'es');
+            ->select('es.id, payload, recorded_at, recorded_by AS author_id')
+            ->addSelect('coalesce(u.first_name || \' \' || u.last_name, \'System\') AS author')
+            ->addSelect('ese.translation_key as event')
+            ->from('event_store', 'es')
+            ->join('es', 'event_store_event', 'ese', 'es.event = ese.id')
+            ->leftJoin('es', 'users', 'u', 'u.id = es.recorded_by');
     }
 }",It be better if you name event_id instead of event id in name give you information about relation,php,1,1,1
"@@ -1416,13 +1416,12 @@ void process_request(char* code_sign_key) {
             if (config.min_sendwork_interval) {
                 double diff = dtime() - last_rpc_time;
                 if (diff < config.min_sendwork_interval) {
-                    double t_left = config.min_sendwork_interval - diff;
                     ok_to_send_work = false;
                     log_messages.printf(MSG_NORMAL,
-                        ""Not sending work - last request too recent, please wait: %f\n"", t_left
+                        ""Not sending work - last request too recent, please wait: %f\n"", config.min_sendwork_interval
                     );
                     sprintf(buf,
-                        ""Not sending work - last request too recent, please wait: %d sec"", (int)t_left
+                        ""Not sending work - last request too recent, please wait: %d sec"", (int)config.min_sendwork_interval
                     );
                     g_reply->insert_message(buf, ""low"");
 ","This means that user will always see the, let's say, 'default' delay interval even if there is less time left before he can do next request. E.g. There is a default delay of 60 sec. User waits 59 seconds, make another request and see the message that he should wait for 60 seconds more while in fact he had to wait only 1 second before doing next request. Isn't this misleading a little bit?",php,1,1,1
"@@ -28,14 +28,12 @@ class AttributeGroupGrid extends AbstractGrid
      */
     public function init(GridConfigurationInterface $configuration, Language $language): void
     {
-        $filters = $configuration->getFilters();
-
-        $id = new TextColumn('id', 'Id', new TextFilter($filters->get('id')));
+        $id = new TextColumn('id', 'Id', new TextFilter());
         $id->setVisible(false);
         $this->addColumn('id', $id);
-        $this->addColumn('code', new TextColumn('code', 'Code', new TextFilter($filters->get('code'))));
-        $this->addColumn('name', new TextColumn('name', 'Name', new TextFilter($filters->get('name'))));
-        $this->addColumn('elements_count', new IntegerColumn('elements_count', 'Elements Count', new TextFilter($filters->get('elements_count'))));
+        $this->addColumn('code', new TextColumn('code', 'Code', new TextFilter()));
+        $this->addColumn('name', new TextColumn('name', 'Name', new TextFilter()));
+        $this->addColumn('elements_count', new IntegerColumn('elements_count', 'Elements Count', new TextFilter()));
 
         $links = [
             'get' => [",In TextColum u can use TextFilter as class default. Less coding :),php,1,1,1
"@@ -51,16 +51,14 @@ class DbalConditionSetQuery implements ConditionSetQueryInterface
     /**
      * @return array
      */
-    public function findNumericConditionRelations(AttributeId $attributeId): array
+    public function findAttributeIdConditionRelations(AttributeId $attributeId): array
     {
         $qb = $this->connection->createQueryBuilder();
 
         $records = $qb->select('id')
             ->from(self::TABLE)
-            ->where($qb->expr()->eq('conditions->0->>\'type\'', ':type'))
-            ->where($qb->expr()->eq('conditions->0->>\'attribute\'', ':attribute_id'))
-            ->setParameter(':type', 'NUMERIC_ATTRIBUTE_VALUE_CONDITION')
-            ->setParameter(':attribute_id', $attributeId->getValue())
+            ->where('conditions::text ILIKE :attribute_id')
+            ->setParameter(':attribute_id', '%'.$attributeId->getValue().'%')
             ->execute()
             ->fetchAll(\PDO::FETCH_COLUMN);
 ",I don't really like the solution. Though unlikely it may occur that there will be text or id assigned to another type of entity matching. What is the reasoning for that?,php,1,1,1
"@@ -25,6 +25,9 @@ func TestWriteDrupalConfig(t *testing.T) {
 	err = WriteDrupalConfig(drupalConfig, file.Name())
 	assert.NoError(t, err)
 
+	os.Chmod(dir, 0755)
+	os.Chmod(file.Name(), 0666)
+
 	err = os.RemoveAll(dir)
 	assert.NoError(t, err)
 }",Please check the return on these.,php,1,1,1
"@@ -23,14 +23,14 @@ class CacheDownloaderDecorator implements DownloaderInterface
         $this->directory = sprintf('%s/var/downloader', $appKernel->getProjectDir());
     }
 
-    public function download(string $url, array $headers = []): string
+    public function download(string $url, array $headers = [], string $acceptedHeaderTypes = null): string
     {
         $data = parse_url($url);
 
         $filename = sprintf('%s/%s%s', $this->directory, $data['host'], $data['path']);
 
         if (!file_exists($filename)) {
-            $content = $this->downloader->download($url, $headers);
+            $content = $this->downloader->download($url, $headers, $acceptedHeaderTypes);
             if ($content) {
                 $this->saveFile($filename, $content);
             }",As far as I know it is about limiting the allowed mime formats ? So maybe it is better to call it AcceptedMimeTypes or AcceptetContenType ?,php,1,1,1
"@@ -554,7 +554,7 @@ class SimpleAssertionReconciler extends Reconciler
                 if (!$array_atomic_type instanceof TNonEmptyArray
                     || ($array_atomic_type->count < $min_count)
                 ) {
-                    if ($array_atomic_type->getId() === 'array<never, never>') {
+                    if (!$array_atomic_type->isEmptyArray()) {
                         $existing_var_type->removeType('array');
                     } else {
                         $non_empty_array = new TNonEmptyArray(",You inverted the condition here.,php,1,1,1
"@@ -94,8 +94,9 @@ void CLIENT_STATE::check_app(APP& p) {
 }
 
 void CLIENT_STATE::check_file_info(FILE_INFO& p) {
-    if (p.pers_file_xfer) check_pers_file_xfer_pointer(p.pers_file_xfer);
-    if (p.result) check_result_pointer(p.result);
+    if (p.pers_file_xfer) {
+        check_pers_file_xfer_pointer(p.pers_file_xfer);
+    }
     check_project_pointer(p.project);
 }
 ","Last question before merge - it looks like this was a refactor to put parenthesis around the if statement. However, it also removed the line `if (p.result) check_result_pointer(p.result);` was that intended?",php,1,1,1
"@@ -25,12 +25,16 @@ use Thelia\Core\Security\SecurityContext;
 use Thelia\Exception\TheliaProcessException;
 use Thelia\Mailer\MailerFactory;
 use Thelia\Model\AddressQuery;
+use Thelia\Model\Base\ProductDocumentQuery;
 use Thelia\Model\Cart as CartModel;
 use Thelia\Model\ConfigQuery;
 use Thelia\Model\Currency as CurrencyModel;
 use Thelia\Model\Customer as CustomerModel;
 use Thelia\Model\Lang as LangModel;
 use Thelia\Model\Map\OrderTableMap;
+use Thelia\Model\MessageQuery;
+use Thelia\Model\MetaData as MetaDataModel;
+use Thelia\Model\MetaDataQuery;
 use Thelia\Model\Order as ModelOrder;
 use Thelia\Model\OrderAddress;
 use Thelia\Model\OrderProduct;","Be careful, you use the base model",php,1,1,1
"@@ -8,7 +8,7 @@ use Cms\Classes\Controller;
 use Cms\Classes\ComponentBase;
 use Illuminate\Pagination\Paginator;
 use Illuminate\Support\Collection;
-use Illuminate\Support\Debug\HtmlDumper;
+use Symfony\Component\VarDumper\Dumper\HtmlDumper;
 use Symfony\Component\VarDumper\Cloner\VarCloner;
 use October\Rain\Database\Model;
 ",Does this require a class alias setup in the library?,php,1,1,1
"@@ -9,7 +9,7 @@ use Cms\Contracts\CmsObject as CmsObjectContract;
 use ApplicationException;
 use ValidationException;
 use Exception;
-
+use Cms\Classes\Theme;
 /**
  * This is a base class for all CMS objects - content files, pages, partials and layouts.
  * The class implements basic operations with file-based templates.",Why is this necessary? The Theme class exists within this namespace.,php,1,1,1
"@@ -308,7 +308,11 @@ class ProjectAnalyzer
         $file_extensions = $this->config->getFileExtensions();
 
         foreach ($this->config->getProjectDirectories() as $dir_name) {
-            $file_paths = $this->file_provider->getFilesInDir($dir_name, $file_extensions);
+            $file_paths = $this->file_provider->getFilesInDir(
+                $dir_name,
+                $file_extensions,
+                [$this->config, 'isInProjectDirs']
+            );
 
             foreach ($file_paths as $file_path) {
                 if ($this->config->isInProjectDirs($file_path)) {","With the filter pushed down to the iterator, do we still need to check whether the returned file paths are in project / extra dirs?",php,1,1,1
"@@ -54,7 +54,7 @@ class DbalBatchActionQuery implements BatchActionQueryInterface
             $record['all'],
             $record['processed'],
             new \DateTime($record['created_at']),
-            $record['all'] === $record['processed'] ? new \DateTime($record['last_processed_at']) : null
+            $record['all'] === $record['processed'] ? new \DateTime($record['last_processed_at'] ?? $record['created_at']) : null
         );
 
         foreach ($this->getEntries($id, $language) as $entry) {",This seems redundant and not related,php,1,0,1
"@@ -8,7 +8,7 @@
  * @package Neve
  */
 
-define( 'NEVE_VERSION', '2.11.6' );
+define( 'NEVE_VERSION', '3.0.0' );
 define( 'NEVE_INC_DIR', trailingslashit( get_template_directory() ) . 'inc/' );
 define( 'NEVE_ASSETS_URL', trailingslashit( get_template_directory_uri() ) . 'assets/' );
 define( 'NEVE_MAIN_DIR', get_template_directory() . '/' );",Let's make sure this is set to the old version before we merge it,php,1,1,1
"@@ -535,6 +535,10 @@ class MediaLibrary
     {
         $path = $this->validatePath($path);
 
+        if (Config::get('cms.storage.media.disk') === 'local') {
+            return $this->storagePath . $path;
+        }
+
         $fullPath = $this->storagePath.implode(""/"", array_map(""rawurlencode"", explode(""/"", $path)));
 
         return Url::to($fullPath);",Shouldn't you put the check after this line and return fullPath instead?,php,1,1,1
"@@ -96,7 +96,9 @@ class ContentEditController extends BaseController
 
     private function updateFieldFromPost(string $key, $postfield, Content $content): void
     {
-        if (! $field = $content->getField($key)) {
+        if ($content->getField($key)) {
+            $field = $content->getField($key);
+        } else {
             $fields = collect($content->getDefinition()->get('fields'));
             $field = Field::factory($fields->get($key)['type']);
             $field->setName($key);",do we have $content->hasField($key) ?,php,1,1,1
"@@ -22,7 +22,7 @@ use Sonata\MediaBundle\Model\MediaInterface;
 class SimpleResizer implements ResizerInterface
 {
     /**
-     * @var ImagineInterface
+     * @var ImagineInterface.
      */
     protected $adapter;
 ",Please remove the `.`,php,1,1,1
"@@ -33,6 +33,7 @@ class DbalDataSetFactory
         $result->select('*');
         $result->from(sprintf('(%s)', $queryBuilder->getSQL()), 't');
         $result->setParameters($queryBuilder->getParameters(), $queryBuilder->getParameterTypes());
+        $result->distinct();
 
         return new DbalDataSet($result, $this->filterBuilderProvider);
     }",Why distinct in main factory ? IMHO use distinct in this case can by only hiding a problem not a resolving it. Are we sure that fetching duplicated data is not inserting or query problem ??,php,1,1,1
"@@ -127,7 +127,8 @@ class ProductPriceCalculation
 
         $minimumPrice = null;
         foreach ($prices as $price) {
-            if ($minimumPrice === null || $price->getPriceWithoutVat() < $minimumPrice->getPriceWithoutVat()) {
+            /** @var \Shopsys\FrameworkBundle\Model\Pricing\Price|null $minimumPrice */
+            if ($minimumPrice === null || $price->getPriceWithoutVat()->isLessThan($minimumPrice->getPriceWithoutVat())) {
                 $minimumPrice = $price;
             }
         }",I think even `Price` should have `isLessThan` method,php,1,1,1
"@@ -215,9 +215,13 @@ class IndexingConfigurationSelectorField {
 			)
 		);
 
-		$selectFieldRenderer = $formEngine = GeneralUtility::makeInstance('TYPO3\\CMS\\Backend\\Form\\FormEngine');
-		if (!method_exists($selectFieldRenderer, 'getSingleField_typeSelect_checkbox')) {
-			if (class_exists('TYPO3\\CMS\Backend\\Form\\Element\\SelectElement')) {
+		$selectFieldRenderer = $formEngine = NULL;
+		if (class_exists('TYPO3\\CMS\\Backend\\Form\\FormEngine')) {
+			$selectFieldRenderer = $formEngine = GeneralUtility::makeInstance('TYPO3\\CMS\\Backend\\Form\\FormEngine');
+		}
+
+		if (!isset($selectFieldRenderer) || !method_exists($selectFieldRenderer, 'getSingleField_typeSelect_checkbox')) {
+			if (class_exists('TYPO3\\CMS\Backend\\Form\\Element\\SelectElement') && isset($formEngine)) {
 				// TYPO3 CMS 7.2
 				$selectFieldRenderer = GeneralUtility::makeInstance('TYPO3\\CMS\Backend\\Form\\Element\\SelectElement', $formEngine);
 			} elseif (class_exists('TYPO3\\CMS\\Backend\\Form\\Element\\SelectCheckBoxElement')) {",There is an Backslash missing `TYPO3\\CMS\Backend...`,php,1,1,1
"@@ -20,7 +20,7 @@ return [
     'alpha_dash'           => 'Este campo pode conter apenas letras, números, traços e o caractere de sublinhado.',
     'alpha_num'            => 'Este campo pode conter apenas letras e números',
     'array'                => 'Este campo deve ser uma matriz.',
-    'attached'             => 'This field is already attached.',
+    'attached'             => 'Este campo já está ligado.',
     'before'               => 'Esta deve ser uma data anterior a :date.',
     'before_or_equal'      => 'Esta deve ser uma data anterior ou igual a :date.',
     'between'              => [",I believe it should be 'Este campo j est anexado.' just like in locales/pt/validation.php,php,1,1,1
"@@ -27,7 +27,7 @@ final class CategoryManager implements CategoryManagerInterface
      */
     private $categoryManager;
 
-    public function __construct(ManagerInterface $categoryManager)
+    public function __construct(?ManagerInterface $categoryManager = null)
     {
         $this->categoryManager = $categoryManager;
     }",why it this change needed?,php,1,0,1
"@@ -853,6 +853,19 @@ class DefaultRecord extends AbstractBase
         return $params;
     }
 
+    /**
+     * Get an alternate display title.
+     *
+     * @return string
+     */
+    public function getAlternateDisplayTitle()
+    {
+        $format = '%s %s';
+        $short = $this->fields['alt_title_short'] ?? '';
+        $sub = $this->fields['alt_title_sub'] ?? '';
+        return sprintf($short, $sub);
+    }
+
     /**
      * Get the OpenURL parameters to represent this record (useful for the
      * title attribute of a COinS span tag).","I did this for convenience but maybe this should be split out into two functions like the corresponding ""normal"" fields are? Or maybe the corresponding fields could be combined into 1 function, e.g. `getDisplayTitle`? I wasn't sure what to do here so I just did something quick and easy. I'm not sure if it's problematic though.",php,0,0,1
"@@ -73,6 +73,7 @@ class EasyAdminExtension extends Extension
         $backendConfiguration['entities'] = $this->getEntitiesConfiguration($backendConfiguration['entities']);
         $backendConfiguration = $this->processEntityActions($backendConfiguration);
         $backendConfiguration = $this->processEntityTemplates($backendConfiguration);
+        $backendConfiguration['default_entity_name'] = $this->getFirstEntityName($backendConfiguration);
 
         $container->setParameter('easyadmin.config', $backendConfiguration);
 ","If you create it at runtime, why not allowing it in the EasyAdmin user configuration?",php,1,1,1
"@@ -66,7 +66,7 @@ class StatusGridBuilder implements GridBuilderInterface
                     'method' => Request::METHOD_DELETE,
                 ],
             ]))
-            ->orderBy('code', 'DESC');
+            ->orderBy('index', 'ASC');
 
         return $grid;
     }",Its working without changing in DbalStatusGridQuery:getGridQuery ?,php,1,1,1
"@@ -192,7 +192,17 @@ class MultiBackend extends AbstractBase implements \Zend\Log\LoggerAwareInterfac
     {
         $items = [];
         foreach ($ids as $id) {
-            $items[] = $this->getStatus($id);
+            try {
+                $items[] = $this->getStatus($id);
+            } catch (ILSException $e) {
+                $items[] = [
+                    [
+                        'id' => $id,
+                        'error' => 'An error has occurred',
+                        'availability_message' => 'status_unknown_message'
+                    ]
+                ];
+            }
         }
         return $items;
     }","If you find a way to display the full unknown message above, it may be necessary to devise a different mechanism for filling it in in this situation. Maybe any entry with 'error' set automatically gets 'availability_message' set to unknown.",php,1,1,1
"@@ -39,6 +39,8 @@
 #include <vector>
 #include <string>
 #include <cstring>
+#include <tuple>
+#include <set>
 #endif
 
 #if HAVE_XSS",I'm not sure this is available in VS2010,php,1,1,1
"@@ -11,7 +11,9 @@ use Symfony\Component\Console\Output\OutputInterface;
 
 class DatabaseDumpCommand extends Command
 {
+    /** @access private */
     const ARG_OUTPUT_FILE = 'outputFile';
+    /** @access private */
     const OPT_PGDUMP_BIN = 'pgdump-bin';
 
     /**","Shouldn't argument names be public? I'd guess they might come handy when calling the command programatically or during an extension. As an example, take a look at `ServerStartWithCustomRouterCommand` which would definitely use a `ServerStartCommand::ARG_ROUTER` constant if it were declared (now it uses only the literal string `'router'`). Or did you have some other reason for the private visibility in mind?",php,1,1,0
"@@ -52,7 +52,7 @@ final class Metadata implements MetadataInterface
     ) {
         $this->title = $title;
         $this->description = $description;
-        $this->image = null !== $image ? $image : 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAADnCAYAAADl9EEgAAAXfWlDQ1BJQ0MgUHJvZmlsZQAAWAmtWWVYVU3Xnn0KOBy6u7u7u7sbgUN3NyopUkoISIoggqCCQYmIiCCCiKACBiAhkiqooAjIu0F93ufH9/779nWdvW/W3GvNmlkzs/daAMDQgg8NDUSQAxAUHBluqafJbu/gyE7wFhACKkAHhAEG7xERqmFubgz+57U9AaDDxhcih7b+J+3/bqDw9IrwAAAyh5vdPSM8gmDcAgCizSM0PBIA1KE9rpjI0EOcB2PqcNhBGNceYp/fuOMQu//Gw0cca0stmDMLACEOjw/3AQC3DsvZoz18YDskOAAwlMGefsEAULHDWNXDF+8JAIMbzBEOCgo5xDkw5nf/lx2ff2E83v0fm3i8zz/491hgTbhjbb+I0EB83NEf/5+3oMAoeL6OLlr4jguN1LSEn/TwvNH7RRpYw5gaxuK+Ufo2f7B2vK+13SEXltsHu5uawZgSxp4eEVrwXALYDhQdEGJ0aOeQk+Pppa0DY3hVQCUR0VZ/8ZV4Xy3TPxx7f7zhYcxIYU4HPhxGv/t9FBppfujDoc03wYGmxn/whne47qF9WI7AeEXoWMEY9gHBHBlufSiHfUaIevvpGsAY7hehGRp4tOYOOZbhUZaHY+GGsadXsM1f3QxPvLYRLGeG5WXAGGgBbcAO30NAIPwLB37AE37+lXv8S24F4sFHEAy8QASsccRw9UsJ/4uBLsDD+j5wu8gffc0jiReIhrX2//JG1tvX/+I/Ou7/aOiC90c2/lgQvyq+Ir73l81O9tcvjA5GG6OP0cUI/JXAPf0eRfiRf0bwaLxAFGzLC+77rz//HlXUP4x/S3/PgeWRVgDM8PvbN7A98szvH1tG/8zMn7lA8aIkUTIoTZQKShWlANhRtChGIIKSRsmjNFBqKCW4TeFf8/xH64//IsD7aK6ij7wPAB9gz+FdHekVGwnHCmiFhMaF+/n4RrJrwKeFlzC7QbCHqDC7pLiEBDg8ew45AHy1PDpTINpn/5V5LQOgDK8NotH/yvzPAdDYDwBd1n9lvE7w/hUG4OZzj6jw6N/2UIcPNMACMnilMQBWwAX44fFLAlmgBNSBDjAEZsAaOAAX4AF8YX/DQQw4DpJBOsgGeaAIlIEqcAlcAdfBLdAOusAD8Ag8AaNgHLwFs2ARrIENsA12IQgigEggKogBYoN4ICFIEpKHVCEdyBiyhBwgN8gHCoaioONQKpQNFUBlUDXUAN2E7kAPoEFoDHoNzUEr0BfoJwKJwCGoESwIXoQYQh6hgTBCWCOOIXwQYYh4RBriLKIEUYO4hmhDPEA8QYwjZhFriC0kQBIjaZEcSBGkPFILaYZ0RHojw5EnkVnIYmQNsgnZiRxAvkDOIteROygMigrFjhKBY6mPskF5oMJQJ1E5qDLUFVQbqg/1AjWH2kD9QpOgmdFCaEW0Adoe7YOOQaeji9F16FZ0P3ocvYjexmAwtBg+jBy8fh0w/pgETA6mEtOM6cGMYRYwWwQEBAwEQgQqBGYEeIJIgnSCUoJrBPcJnhMsEvwgJCZkI5Qk1CV0JAwmTCEsJmwk7CZ8TrhEuEtETsRDpEhkRuRJFEeUS1RL1En0jGiRaBdLgeXDqmCtsf7YZGwJtgnbj53CfiUmJuYkViC2IPYjTiIuIb5B/Jh4jngHR4kTxGnhnHFRuLO4elwP7jXuKwkJCS+JOokjSSTJWZIGkockMyQ/SKlIRUkNSD1JE0nLSdtIn5N+IiMi4yHTIHMhiycrJrtN9oxsnZyInJdcixxPfpK8nPwO+ST5FgUVhQSFGUUQRQ5FI8UgxTIlASUvpQ6lJ2Ua5SXKh5QLVEgqLiotKg+qVKpaqn6qRWoMNR+1AbU/dTb1deoR6g0aShppGluaWJpymns0s7RIWl5aA9pA2lzaW7QTtD/pWOg06LzoMuma6J7Tfadnolen96LPom+mH6f/ycDOoMMQwJDP0M4wzYhiFGS0YIxhvMDYz7jORM2kxOTBlMV0i+kNM4JZkNmSOYH5EvMw8xYLK4seSyhLKctDlnVWWlZ1Vn/WQtZu1hU2KjZVNj+2Qrb7bKvsNOwa7IHsJex97BsczBz6HFEc1RwjHLucfJw2nCmczZzTXFgueS5vrkKuXq4NbjZuE+7j3Fe53/AQ8cjz+PKc5xng+c7Lx2vHe5q3nXeZj57PgC+e7yrfFD8Jvxp/GH8N/0sBjIC8QIBApcCoIEJQRtBXsFzwmRBCSFbIT6hSaEwYLawgHCxcIzwpghPREIkWuSoyJ0oraiyaItou+kmMW8xRLF9sQOyXuIx4oHit+FsJSglDiRSJTokvkoKSHpLlki+lSKR0pRKlOqQ2pYWkvaQvSL+SoZIxkTkt0yuzLysnGy7bJLsixy3nJlchNylPLW8unyP/WAGtoKmQqNClsKMoqxipeEvxs5KIUoBSo9KyMp+yl3Kt8oIKpwpepVplVpVd1U31ouqsGocaXq1GbV6dS91TvU59SUNAw1/jmsYnTXHNcM1Wze9ailontHq0kdp62lnaIzqUOjY6ZTozupy6PrpXdTf0ZPQS9Hr00fpG+vn6kwYsBh4GDQYbhnKGJwz7jHBGVkZlRvPGgsbhxp0mCBNDk3MmU6Y8psGm7WbAzMDsnNm0OZ95mPldC4yFuUW5xQdLCcvjlgNWVFauVo1W29aa1rnWb234baJsem3JbJ1tG2y/22nbFdjN2ovZn7B/4sDo4OfQ4UjgaOtY57jlpONU5LToLOOc7jxxjO9Y7LFBF0aXQJd7rmSueNfbbmg3O7dGtz28Gb4Gv+Vu4F7hvuGh5XHeY81T3bPQc8VLxavAa8lbxbvAe9lHxeecz4qvmm+x77qfll+Z36a/vn+V//cAs4D6gINAu8DmIMIgt6A7wZTBAcF9IawhsSFjoUKh6aGzYYphRWEb4UbhdRFQxLGIjkhq+CNvOIo/6lTUXLRqdHn0jxjbmNuxFLHBscNxgnGZcUvxuvGXE1AJHgm9xzmOJx+fO6FxovokdNL9ZG8iV2Ja4mKSXtKVZGxyQPLTFPGUgpRvqXapnWksaUlpC6f0Tl1NJ00PT588rXS6KgOV4ZcxkimVWZr5K8szayhbPLs4ey/HI2fojMSZkjMHZ73PjuTK5l7Iw+QF503kq+VfKaAoiC9YOGdyrq2QvTCr8FuRa9FgsXRx1Xns+ajzsyXGJR2l3KV5pXtlvmXj5ZrlzRXMFZkV3ys9K59fUL/QVMVSlV3186LfxVfVetVtNbw1xZcwl6Ivfai1rR24LH+5oY6xLrtuvz64fvaK5ZW+BrmGhkbmxtyriKtRV1euOV8bva59vaNJpKm6mbY5+wa4EXVj9abbzYlbRrd6b8vfbmrhaalopWrNaoPa4to22n3bZzscOsbuGN7p7VTqbL0rere+i6Or/B7NvdxubHda98H9+PtbPaE96w98Hiz0uva+fWj/8GWfRd9Iv1H/40e6jx4OaAzcf6zyuGtQcfDOkPxQ+xPZJ23DMsOtT2Weto7IjrQ9k3vWMaow2jmmPNb9XO35gxfaLx69NHj5ZNx0fGzCZuLVpPPk7CvPV8uvA19vvol+s/s2aQo9lTVNPl08wzxT807gXfOs7Oy9Oe254Xmr+bcLHgtr7yPe7y2mfSD5ULzEttSwLLnctaK7MrrqtLq4Frq2u57+keJjxSf+Ty2f1T8Pb9hvLG6Gbx58yfnK8LX+m/S33i3zrZntoO3d71k/GH5c2ZHfGfhp93NpN2aPYK9kX2C/85fRr6mDoIODUHw4/uhbAAnfEd7eAHyph3MBBzgHGAUAS/o7NzhiAICEYA6MbSEdhAZSHkWPxmIICcQJHYhSsfdxGBI8aTs5liKQcohahqaCDtAHMIwwyTLnsayxqbPncoxxYbkVeBx4A/iC+J0FNAVZBDeFHgmXigSIqoiRiL0Tb5ZIkrSQ4pD6KH1H5pSshRyz3KJ8k0KsooYSVumFcoWKp6qw6he1dvXjGpqaOM13Wt3ajTqVuvl6J/XxBmqG9IabRsPGTSaVptVmXeYLlmgrBmtGG3JbpO2e3a4DcCRyInUmOYY6tuUy7zrq1oO/7V7nUeqZ5RXn7eNj7avpJ+0vGMARyBBEFowM/hYyHzoadje8NuJsZGJUenRrLCrOK77nODjBe1Ix0SDJKTkq5WxqUVrCKelTC+m5p80zeDKJs0A2IofiDP9Z1VzTPLt8xwLHc/aFtkXWxRbnTUuMSvXKNMtVKxQqpS6IVAleFK82qkm9NHvZoO5a/VoDRSPPVYlrSte1m0ya7W643vS9FXo7puVka0rbqfaMjuw7uZ1Fdyu66u61dPffn+yZfTDR2/zQu4++73F/8aOYAe/HxwbthiyeGA3rPdUfsX4WNnpx7PUL4pdi41oTBpM6r+Rf87whfbPzdnnq1fSDmUvvUmd95mzmTRdM3pstmn0wXFJYplueXclalV6dXbuyHv9R/xPhp4bPep8XNi5txn5x+Wr2zWTLf7v3x+mf7fvaBwd/4i+BRCFXULPoBcwGIZJIFutLXIGbJRUkiyF/RMlAFUf9klaSLoV+mlGGKZ15lJWRzZ49n6OLc4pri3ubZ5X3Kd8l/nABVUFCwZdCVcL+IjIiv0QfiZ0Vt5Ngk1iSbJKKllaRgWT6ZbPkzOSp5CcUShWdlFiUpuBV4KzKoDqpdl7dSYNXY1dzXOumdo6Ol66yHoXeB/0ugyLDaCMvY3cTX9MQsyBzdwszSyUrQWsmG1JbhO223ZL9hMNDxyancuesY/Eufq72btp4MXd6D8hj1XPcq8+71afOt9gvzT8kwCFQPYgvmAReCXOhM2HfIjgiXaNKox/EvIpdiFuP3zlOfIL1JH8iexIm6V1ya0puaniayymbdPvTfhmpmZVZ17Nbc9rOtJy9mXs9ryH/csHFc+WFRUW5xZnnU0riSkPKfMr9KpIq71cJXLxSw3epoPbF5Z160iuMDVyNgvA6kLuu2qTdbHLD4WbgrfTbl1q6W8faZtqXO752Iu/SdQndU+pWvy/Xw/EA8WC+d+Bha199f/mjvIFTj+MHw4cin2QOd43QPjsxOv2c8YXaS+tx74mkycuvnr3+9pZySmTaeCb03fnZu3PP52cW5t+vfUDD0U9eGVujWBf/KPOJ9zPZ5x8bHzYnvwx9vfOteitx2/Y73/ftH1078T+VdnF72vsrf+IvCq0hKpEuKAE0AXoTs0KwSjhPtEmMxfGQaJA6kiWTX6MYozyg5qHRofWnO0VfxdDC2M/0mPkRy13WarZYdk32nxy1nEaca1wZ3HzcvTwuPDu8hXzifEP8PgIEAvWC+oJLQunC/ML9Ih6iQLRSTFnslXgU/HXTLGksuSyVKs0q3SFjKbMue0qOTa4d/mpZVkhUpFW8qqSh9FzZQ/mTSoIqgWq5mrTahHq8BqtGh6aZ5mstX60D7Rodc10i3Yd6x/Wl9VcNagydjeiNJoyLTKxMyUwHzVLNlcy/WTRbBljxWb23rrY5Zstg+9Iu117f/sCh1THQidtp2rn4mOmxbZdCVx7XFjcNtzf4WHdO91fwOeLrpect56Pga+CH9w8KwAeqBZEHTQVfDgkKlQndC3sYnhVhHkkT+TaqKtozhjfmQ+yFOJ24qfjABOqEF8fvnug+2Zf4MOlOckNKcWpqWsgpp3Sd04IZ6IyXmaVZjtnc2bs5s2eenr2TezHvZL5TgeI5xnM7hRNFt4rPnz9TUlBaXXa7/FHFq8rVC7sXSarZa6Qu6dc6Xw6pO1mfeSWnIakRf1XuGum1L9c/Nu3cwN1kvSV527wlobWl7UeHwp3QztK7N7o67t3tHry/9UCv906fVf/WQPGg1NDL4TMjbqMGzzVeak4EviadWpsfWd36tnMY/981osN3AkYWgHPJANinA2CjBkB+HwC843DeiQXAnAQAawWA4PUGCNwwgBTn/nl/QAAJMIAYUMD1GTbAB8SBIlyjMAOOcI4cAWeXueACaALd4BmYA9/gzJEZkoD0IFcoBsqHrkGPoQ8IDIIfYYyIQFTCed4BnNdFI+8gf6H0UOdQ82gpdAb6HUYRU4rZhTOsIUI5wnoiJqJ8LDE2kxhLnIdjxNWTSJN0kaqQdpLJk90l1yd/SxFJSU55nUqbaozamnqMxozmOa0r7Q+6UnoV+hmGE4xMjJ1MLsxEzF0s0azSrF/ZbrGHc8hw7HEOcBVz+/Io85LyzvLd5s8QcBfUEOIVJhXeFfkk+l5sXLxVIkFSQnJGKkNaRvqzTIdsgVycvKeCsaK4Ep0yqYqoarm6kMYZzUGtzzqEujR6DPrMBtyG0kamxmEmJaZ9Zl8suCztrM5aD9ii7LTt0x2GnWid3Y81urx3w+Ap3DHuWx6LnlNeqz5kvkZ+Rf5LgcpBhcGfQg3DGiNwkWFRb2J0YzviRRLqTrCfLE+iTc5PxaYln9o67Z+xlpWdE3S2NZ/iHGPhx+KGEtcy2vLRyjNVehe3anJrqS9n1G1fCWj4cjXvuk4zxY3NWx9altvWOpY6F7o279M90Hro0u82YDWo9kTsqcAz2bHgFz8mUW+IpqreUc11L5IuH1/T+Nj8efeL7Dfdbez3Mz+GdpZ/Lu6+3mvZz/vlfiB+dH4cxp8ArqlRwjUHDiAIpIAK0IfrDG5whSEBZIJS0ADuwHWEabABoSFGSPwo+nFQIXQDGoE+IsgQUghHRCriFmIRyYZ0RdYi11GyqDTUOFoAnYyegmNfTgAIfAnGCXUIO4jEiBqxAthrxNLE93HmuAWSWFIi0iIyDrIbcP76liKGkpayncqW6iP1CRosTQmtCO0QXQg9HX0Pgx8jNWMPUwgzN/MUSymrPRs922v2Sg5PTnEuwPWS+ypPGq8znzScy60KDAveht9iuSKposfFIsU9JNQlcZIjUlnSRjJ0Mpuyr+UG5NsUahRzlOKVo1UyVTvUvmtIaXpqZWvX6bTp3tW7q3/PYNBwzhhhImhqa3bKvN1i3Yrb2tWm0nbGntPB37HNmeCYnUuZa7/bGL7XvcEjw9PPy9Jb38fBN8WvJ4Ak0D2oK4QxND5sOkIzsiGaLCY09kk8R0L08dGTMom1yUwphWnYUwnp6xn4zPns+DPiuYi86YKbhdHF0ue/lN4sj6pUvPDzYl2N5KXK2qU6vnrfKzca6a5WXFdp+nij9JbC7ZFWfNtuR02nRRe413DfuGezt6rP/ZHiY44h1JOnT6OfYUaznuNe1Iy7Tpq8DnxbP700yzZv/j75Q/cK3VreJ96Np18Lt3N2DHYl9y7sv/+1+Sf+KEAE1zPp4egLwbUmLWAOV5iCwAl451eDFvAYzMD7HgfxQurQMSgBKofuQXMIIjjqeEQRYhRJg/RC3kMxo5JQq2gH9FOMFuYeXE95QGhMOE0UgSXD3iC2xSFx7SRhpBKkP8j6yUspoigdqAyoDWksaA3p5OgFGGQYXZnimCNZ3Fmt2UzZTThMOI25TLgteVx5I/jO8DcKPBZcESYRkRP1FisTn5BklPKUbpbZlTOXf6qYqeygilbLU9/TNNJKhSPYrtul160/YrBrZGTcZipqds1C1LLNWstmwi7IAet4zdnWhcKN2N3V08nrvY+Sb7bfhwDLwOFgk5DnYU7hy5EJ0awxM3GPEnpOVCbaJP1MqU6zTWc7vZF5LzvnjHeuXj5DwZNC76Lt86mlFGU1FbKVT6u8q6Gailr5y+P1UQ1MjY+vJTbp3RC7pduS2FbTkdvp0EV3b/J++QOHhwR9lx9JD9wd1BmaHI4dERtFjm28WB4fm8x/zfem8u2vaZ2ZrHdP5sjmbRYuvl/5ILEUsHxx5fHq6jr6I/Mn8c/aG3ab+C+eX82/cX7b2jqzzbzd+F3he9n3nR92P9p2aHfCd9p2dn+q/0z7ObhLumu1e353dI9wT30vdu/m3so+x77DfsH+0P7+L4lfnr/O/3ry69eBxIHXQcnB8GH8I7ylJA/fHgDCacLlx5mDg6+8ABAUALCff3CwW3NwsH8JTjamAOgJ/P1/h0MyBq5xVmwcoiGOXI7D57+v/wDYS4aShLvGpgAAAdVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpDb21wcmVzc2lvbj4xPC90aWZmOkNvbXByZXNzaW9uPgogICAgICAgICA8dGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPjI8L3RpZmY6UGhvdG9tZXRyaWNJbnRlcnByZXRhdGlvbj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjl0tmoAACcLSURBVHgB7V0LvE1VGl/kmp5IEslrIqEQpcdIuDUeeZVL6DFRpJIk5ZVUE8pQjcTElNKQR4qiUnlWqIbkEcKQ8cgrjwpFNf6r9p3j3L32c621197n+36/c8+5e6+91rf/6/zPWnut75Hv12PCQsqRI0dC1hCfy0844QSWP39+R4V//vln9ssvvziWkX0SOkE3P5JJ/eYHFxllvXxP3NrJ54echw8fZm+//Tb74IMP2JIlS9j69evZgQMHmAR+u+lpzPnnn3+e3XbbbY76dO/enY0YMcKxjMyT+fLl431RtmxZz9XiB+QPf/iD5/JU0D8CJ510EkOfXHjhhax+/fqsZcuWrHjx4p4rKuCl5I4dO9jQoUPZmDFj2Pfff+/lksSWOXr0qOu9ffvtt65lZBZo2LAh/xL4qVO3jn50S0rZQ4cOsTVr1vDXlClTWNeuXVmLFi1Yv379WI0aNVxv03F+hhHx2WefZRUrVmRPP/10xhMTaGLEcZO9e/e6FZF6/r777vNd365du3xfQxeEQwCPOm+88Qa7+OKL2R133MG+++47xwqF5MSFzZo1Y+j4gwcPOlaSSSe9kFPnqFS1alWWnZ3tuwu2bt3q+xq6QB4CL7zwAqtZsyb78ssvhZXakhNfrnr16rF3331XeGGmnvjxxx9db10nOXv06OGqj10BIqcdKnqPbdy4kdWpU4d99tlntg3nISe+fE2bNmVffPGF7QWZftBtKgJ8dE1rS5Uqxdq3bx+oS4icgWCTfhEWVBs3bszWrVuXp+485MQ09tNPP81TkA78hoAXcu7fv18LXL169WJZWVmB2sKvNokZCOzbt4/l5OQw7IakynHknDdvHhs9enTqefqchgB+6dxEx/4hluTdtnSc9NywYYPTaTqnGYFVq1axgQMHHtfqceQMsup3XG0Z8I/byKmDmIC5b9++ofYpsUdNYhYCf/vb31jq40YuObH4s2LFCrO0NVAbN3L+9NNPyrUuXbo069y5c+B2sP+2ffv2wNfThWoQwB46tiwtySXniy++aB2jdwcEdu/e7XCWMR3kfOSRR1jBggUd9XA66bR873QdnVOPwCuvvMIsQxdOTkzFYJZH4o7Ali1bHAt52WpxrMDlZJUqVdjNN9/sUsr59MqVK50L0NnIENizZw9bvHgxb5+Tc+nSpXlWiiLTzvCGd+7cyZxWY61fPVW3gWmPm+G9W9tETjeEoj2/YMECrgAnJ01z/HWG0x6wX88QPy03adIkkDVQehvLli1LP0T/G4SAxUdOzm3bthmkmvmqLFy4UKhk0H1HYYW/nyhQoAB76qmn3Iq5noe9NDyKSMxFwFqx5eTMdE8Tv9300UcfCS8BiVRI7969WYUKFUJXjf1NL3u1oRuiCgIjYPGRk9OLMXfglhJ4IUZOkTO1CnKWL1+e9enTRwqSZP0lBUallVjfLU5OpS0lsHKMPKKpoQpywsFblmO006ifwK6K9S0ROQN236xZs2yvDLP/aFdhp06dWIMGDexOBTpmrQQGupgu0ooAkTMg3CJyYpsD4SlkyDnnnMOGDBkioypeB/bQ4JlPEg8EiJwB++mTTz4R7ncWLlw4YK3/vwxxgcaNG8dOO+20/x8M+QmODSTxQYDIGbCv8NCOQGd2UqhQIbvDvo5hdbZu3bq+rnErLBrt3a6j89EgQOQMgfs777xje3XYkfPSSy9lAwYMsK07zEEiZxj09F9L5AyBuSiMSxhyFitWjE2ePJnJXvVdvXr1ce5IIW6bLtWEAJEzBNDffPON7QJL0aJFA9WKxSQQE+FHZMu0adNkV0n1KUaAyBkS4Llz5+apwU/g4NSLEYZU9nOmVT9CMpLECwEiZ8j+siNniRIlfNfas2dPHsvU94UeLoCtJjyPSOKFAJEzZH/Nnz8/Tw1nn312nmNOB9q1a8cGDx7sVCTUOUyVSeKHAJEzZJ9hYz/dARthRLxKq1at2EsvvcSwr6lKxo8fr6pqqlchAkROCeB+/vnnx9XilZytW7dmII5KH9C1a9cy8t88rnti8w+RU0JXpX/5y5Qp4zoS3nPPPWzChAnSt0zSbwcxaUjiiQCRU0K/WZ7rVlUwfoddrJ3AGXvkyJE8yprKqSzaRsgUCtxm1wvxOEbklNBPmzdvzlOLnWM0gnMtWrQoVFjLPA05HJg5cyZDzCOSeCJA5JTQb3bp9EBES8444wyGgMHYzvCSl9G6Luw7/EBJ4ouAmpga8cUjkOZ2gaYvv/xyBtIiSU2bNm2kOUt7VRALQe+9957X4lTOQASInIo6pW3btgyvqOSZZ56JqmlqVxICNK2VAKQs52oJqvAqkB8UvqAk8UaAyCmh/0qWLCmhFnlVYNRUHXlenrZUkwgBIqcIGR/HK1eu7KO02qKIRj98+HC1jVDtWhAgckqAuX79+hJqkVMFiGnFPZVTI9USFQJEzpDIn3zyyax58+Yha5FzOfY0hw4dKqcyqiVyBIicIbugQ4cOUoNwhVEHCXV/+OGHMFXQtQYhQOQM0RlYpQUhTBAEG4N3C0lyECByhujLfv36sbPOOitEDXIu3bt3L+vYsaOcyqgWYxAgcgbsCpjhIXpB1IKsYX/5y18YZYqLuifkt0/kDIAp8pZgk192hLwAqvAICpSVPAhy5l9D5AzQR3D5SjVsD1CFlEvefPNN9vDDD0upiyoxDwEip88+6dy5M59G+rxMenF4uNx4443S66UKzUGAyOmjL+rVq2eE9c2mTZvYtddeyw4dOuRDeyoaNwSInB577Pzzz2evvfZa5M+ZCCjWqFEj7o7mUXUqFlMEiJweOg6G7Ui9UKRIEQ+l1RXBSNmsWTO2fv16dY1QzcYgQOR06YrTTz+dOy2LYgK5XC7t9M8//8z9QyltvDRIja+IyOnQRaeeeipDZi4TvE66dOnCEBOIJHMQIHIK+hoG7UjxV7NmTUEJfYexXTJ27Fh9DVJLRiBA5LTpBhATIybiAEUto0aNYoMGDYpaDWo/AgSInGmgg5hY/DGBmDNmzGDdunVL05D+zRQEiJwpPQ0vE0xlr7jiipSj0XxEigcECIPtLElmIkDk/L3fTznlFD6V/dOf/hT5N2HHjh2sRYsW7PDhw5HrQgpEhwCFxjyG/WmnncaJWbt27eh64veWjxw5wpB5jLxMIu+KyBXIeHIWLlyYvf/++0asyuLb0KdPH7Z48eLIvxikQPQIZDQ5ixYtyhBBoFq1atH3xDENsABEwaCN6AojlMhYchYrVozNnj2bVa1a1YiOQCDoTp06GaELKWEGAhlJzjPPPJPNmTPHCMsf62tw7733kjG7BQa9cwQyjpwYMefOncvgZWKKfPzxx+zVV181RR3SwxAEMmorBc+YphET34Pu3bsb8nUgNUxCIGPIWahQIb4qa4IRe+oXAEYPMDggIQTSEcgIciIgF4JgVa9ePf3+I/9/yJAhketACpiJQOLJmT9/fjZlyhR22WWXGdcD//nPf9iHH35onF6kkBkIJJ6cI0aMYE2aNDED7TQtJk2alHaE/iUE/o9AosnZo0cPhmh5pgosk0gIARECiSUnDMeffPJJ0X1HfvyXX35h//73vyPXgxQwF4FEkrNWrVrsX//6F8uXL5+xyG/evJkdPHjQWP1IsegRSBw5ESlv2rRpDL6ZJgvcwkgIAScEEkVObJlMnz6dgaCmy759+0xXkfSLGIFEkfPll182xvVr3rx57OjRo8LuxRYPCSHghEBiviGIUJeTk+N0r9rOYfS+5ppr2E033SQMM4JRnoQQcEIgEeREFPT+/fs73ae2c/Pnz8+N/YP0DcOGDbNtu3jx4rbH6SAhYCEQe3JWrFiR58o0YWUWNrLNmzdnCDViCbJfb9y40fo3971UqVK5n+kDIWCHQKzJiaBcWJlFDKCoZfXq1axhw4bshx9+OE4VpFGwy6EJnUuUKHFcWfqHEEhFINbkfOWVV1ilSpVS7yeSz+vWrWPZ2dkM0QzsZPLkyWz79u15Tl144YV5jtEBQsBCILbk7NmzJ59CWjcS1TumrA0aNGA7d+4UqoDREyvJ6WKiMX66jvR/dAjEkpyIxv74449Hh9rvLf/3v//lxLQbFdOVmzp1avohZkKM3DxK0QFjEIgdOZGSb+LEiZEnsQUxkeka714Ei0Xpo2udOnVYwYIFvVxOZTIQgdiREzazUa90WsT8+uuvfX1lsM2SKieeeCK76qqrUg/RZ0IgF4FYkfO+++7jK6K52kfwYcuWLax+/frMLzGhql3i2+uuuy6Cu6Am44BAbMh5wQUXsIEDB0aKKYiJqeymTZsC6bFixYo817Vs2dJo75k8CtMBbQjEgpxZWVncBSzK57OwxESPLl++PE/HwlIIz54khEA6ArEg5+DBgxlGzqjEesYMOmJaemNBaPfu3da/ue+m2ATnKkQfjEDAeHJeeeWVDNHQoxIQE8+YYYlp6b927VrrY+5769ataWqbiwZ9sBAwmpyYzo4ePTqyL+7WrVulEhOgI+JeumBqCwsjEkIgFQGjyQmbVBi2RyEwLJA5Ylr3YEdOnGvfvr1VhN4JAY6AseTEM+YDDzwQSTchhAhM8kRECqOUnYcK6sOWSpQLXmHuia5Vg4CR5IT715gxYyKxAtq1axcnJozZVYiInPBSadSokYomqc6YImAkOW+99VZ2ySWXaIcUcX0QwcBu0UaWMiJyon5atZWFcjLqMY6cp556Khs0aJB2dL///nvWuHFjtnLlSqVt41k21Rk7tbGmTZtGMltI1YE+m4OAceTs1asXQ3JbnXL48GGGINSfffaZ8mZ//fVXhpi1doJMaLRqa4dMZh4zipyIDKA7VyUi5LVp04alG6Wr/Do4LTTRc6dK5ONVt1Hk7NOnj/Zg0LfffjtPD6iz27788kthc1glJiEEgIAx5MSoCaLoFATfgguablm1apWwySpVqjA8d5MQAsaQE+5gOmO5jho1KrJER07kxDYSxRYiYgIBI8iJKHqdOnXS1iMI+tytWzdt7aU3BHJiYUgkFSpUEJ2i4xmEgBHkhOkaVip1yNKlS1m7du0cyaFaD2zbOD13ilarkcIBP2Qnn3wyO+GEE1SrSfVHjECBiNvnzXfs2FGLGjDLw5bJTz/9pKU9p0YWLFjAqlatalsEmbjLly/PypYty8qUKcMTM+E5NH3aj6h+3333HYOBPrxn8IJDN+IVLVu2jB06dMi2fjoYDwQiJ2flypW1WAOBkNdff71t/Ngouurtt99md955p23TiLaAl5tg9CxSpAh/pRMd02aQdNasWfy1cOFChoS9JPFBIHJy6ho1QYRPPvkk8p7BSAhLJIzgKgULSzVr1uQvbFHBZvjVV1/lqSswqpKYj0Ckz5z45UcmLtXy3HPP2QZ1Vt2uVT+mox06dOABvmCAAH3+/Oc/W6e1vOM5FotgSHW/ePFi1qpVq8j8ZLXccAIaiZScdevWVW6qh6nd/fffH0lXYeFmwIABbNu2bdzLBiOZCXLxxRezSZMmsa+++ordeOONJqhEOtggECk5kZFLpWBV9IYbbnBMYquifUwpu3TpwtavX89TExYuXFhFM6HrxKIT0kTAphg/lCRmIZBocuI508mOVUVX4Jlyzpw5bMSIESwuOTgvuugirjN8aE3I2KaiX+JYZ2TkRKQDbBWoEowIWADRKW3btuXhLxGULI6C52IYSFx99dVxVD9xOkdGTmSjViWIMavbAujRRx/ldrpxt4s9++yzuSMAMoVjek4SHQKRkRPBs1QJprPpSWxVtQWrHRjPw4g+KYJ7wkLWW2+9xa2RknJfcbuPSMiJzr/00kuVYIUMZO+8846SutMrxciCBL6YziZR4FsKSyaROWES79mke4qEnNWrV+c2orKB2LNnj9bp7NixY/lqsOz7MKm+GjVqsEWLFrFy5cqZpFZG6BIJOVXlBunRo4cw9bvs3sQzmQ4DCtl6B6kPxMQK9DnnnBPkcromIAKRkFNFRuclS5aw8ePHB4TB32WIMYuA15kk1hYRnOJJ9CAQCTmrVasm/e50BaDG9g+ms5m4kvnHP/6RzZgxgyHpL4l6BLSTE/a05557rtQ7g4cHFi5Ui7UAFPftkjA44Rl0woQJGfnjFAa3INdqJ+d5550n1VEYblAIp6lDevbsya644godTRndBswuM21aH0WHaCcnAljJlHHjxrHVq1fLrNK2LmzOYxGI5DcEsK9br149gkMhAtrJCedqWYJRE4l1dcjQoUNpQz4FaMv4omjRoilH6aNMBLSTE6t+smTq1Klsw4YNsqoT1nPZZZfxwNPCAhl6Aiu3w4cPz9C7V3/b2skpcyl+2LBh6hE61gJM2UjsEYB1FGIekchHQDs5S5YsKeUu4NGPl2pBtjNkHiMRIzBy5Mg8wcfEpemMVwS0k1PWyIlQHzqkd+/eOpqJdRuwHMJKNolcBLQG+MI+oQwHZEQ4mDJlilwkbGrDCi3S8pkgCLeCCHrwtsFCGEKgwCAdL5ADW1RYpIlKHnzwQR6KZefOnVGpkLh2tZITga5kBEN+/fXXGdL2qRbkbpGhrww9582bx5ysoE466SSGiAbYh0UI0Nq1a8to1nMdCHb90EMPaXU88KxcTAtq/amVZfalK/mQrrCd+O4gbKfTPqrbKjcCSGNkxZYPCAozQ5BF50gGvGTMjGLKJelqx46ce/fuZRhFVAu2T1R7YWCKiq0ITEnhDIA9W0RwtxM3cqZfgyjwTzzxBHf16tq1K/vmm2/Si0j/Hz++9OwpD9bYkROG1zoil+fk5MhDOa0mkPKxxx7jqRbg5pYahEyUQ8UvOa0mEen+H//4Bzv//PP5u1MCJeuaMO9ISIUpNkl4BLSSMz3XRxD1QU4dguc22QJiwKMFIyXIuX///jxNiEwRzzrrrFDeIFhEwwgKkzvkjFEliN6XKX6uqjC06tVKTiTeCSP4csPpV7XAayboSCXS7euvv+ZR7TCyOJFDNHKiXhmpAT/++GNWq1Ytpakp7rrrLhEMdNwHAlrJGTbr1fLlyxmeOVVLdna21CYQ1wgJcefPn+9arxM5K1as6Hq9lwJ4/sQIqirWEu5Vhc+ul3tLUhmt5Ay7/aHDZxOdKysyIGYK2P/DNO/gwYOevjc6yAlFjhw5whDRYebMmZ708lsIOVBJwiGglZxhR85PP/003N16vFrGHiEWYrCo9NRTT3ls9bdiyLEpwgmLOjLl6NGjPKERprqyJakRCWXj5FSfVnKGHTmR00O1IK9J2Ej0GCURNBtxX/0KnqvXrFlje5mKqSIIisWvzZs327YZ9GDp0qUZoiySBEdAKzmxBXLgwIFA2mI0QWIg1QIrmzCCqWzr1q3Z7NmzA1ezcuVK22vhC6vCRA8hRTHFxVRXpiAPKUlwBLSSE2pu3749kLZIV6dDwk4dEW0e2aTDCBa+7ARbUbIWhdLr/+KLLxhSSsgUImc4NGNDTtFUL9zt570aEeaCClynXnzxxaCX514nIicKqJjaWg0/+eSTPB2g9X/Yd0T1l7G3HVaPuF4fG3KmWtGoBBs5K4PIihUrpCXpRV0iUUlOPO/efffdDO8ypECBAgyJekmCIRAbcsJWVIcEsafFogoyRMt6ZoOx+u7du21vF3uIKmXp0qU89KWsNi6//HJZVWVcPdrJGXRRB6nbdcjpp5/uuxkkynXan/Rd4bELRKOnypHT0rNv377Sfmho5LRQ9f+unZwi21E31XW5PvmNJrdr1y4lMYZEz50wKyxUqJAbXKHOY5YiK/Fw1apVQ+mSyRfHhpxBt2D8di72Of3IM888oyQXqIic0A1xjVQL/EJlCOyBTXFYl3E/OuvQTk48SwWxj4VXhQ7x80XCD4aqWEZO5JRhweSGJabpc+fOdSvmej4rK4sFXWRzrTzhBbSTE3gGeT7TlanaT38jca6qHw0YImChyU50kBPtvvzyy3bN+z4GayES/whEQs4gZniylvf9QyS+QmW4FKz8in7EdJETQbtl/CiWKlVKDCKdESIQCTkR68ZU8Wr/u3HjRqkb9nZ4YFvDTuB4reMLD5NJZHALK4hiSOIfgdiQU1c+zH379nlC8f333/dULkwhETlRp67RUwY5ixQpEgaGjL02EnLC2ReuUX4EcVp1iFdyenGcDquvCeR89913Q1sMIXQJiX8EIiEn1PTrQ6h6b8+Czut+6qJFi6xLlL0vW7ZMGMwMdqs6BPu4omdfr+1ncrJhrxjZlYuMnH5DZOgiJ54l3QSO1H5Hfrc67c7j+Xft2rV2p/hep59tH9tKPB5ETN0wAhtbEv8IREZOv9MlWQmQ3CDyQk4Y4etaPRZNbRF+Upczc1hy6sLKrW/jdj4ycsLB10+WMF17ZV5sf4P6pAb5cojIibp0GZUjT0sY0RFnOIx+pl4bGTkBiJ/gUrJDVYo6xIkM1jWiGD/WeZnvTvog7YIOWbduXahmfvzxx1DXZ+rFkZJz+vTpnnEPG6HAa0P4IrpZ/egkJ0Yt0bRQFzmRIgILQ0EliLlm0LaSdF2k5IRblNeVwAsuuEAL7iCC02gFJWAvqkvwQyFyNMdUX9ez+KZNmwLfstftqcANJPTCSMkJTL2awMEixq/HSNA+++CDDxwv9etW5liZh5NOPxa6njvDjJxYXyDxj0Dk5JwwYYJw2pZ+O8j8pUPcAnSZRE5dU9sw5EQqChL/CEROzi1btrCPPvrIk+ZIk6dDMFKJwoSg/XLlyjFd5oRoz2nk1PWDFea5McyUGPefqRI5OQH8888/7wn/unXreioXthCeOydPniysBqaEIKgucSIn4uzq2OQPGh8JWNLIGeybYgQ5p0yZ4im5K56vdFkKwVfTSVQH2kptG6OWKCI7Qk+GDYSd2pboc9AMcTDqoK0UEarOx40gJzoeCV7dBOZqjRo1cism5Tx8Tp0CWV911VVS2vFaiZMPrI6pbVBDAgSrJgmGgBHkhOogJ2xW3aRly5ZuRaSdf/rpp4V1tWjRQnhOxYmoyRnUeB3G+yTBEDCGnFiAwcqtmyBB0CmnnOJWTMp5hOkQrVLimfPqq6+W0o6XSpwyrOnYTgnq9rV48WIvt0dlbBAwhpzQbeDAgcK4OZbuMPhu1aqV9a/Sd4zkTqNn//79lbafWvmSJUuEW04wbSxevHhqcemfg+wxYxHJr2ugdMVjXKFR5MTigdtCDLBG6nZdgtCXosUYbO107NhRiyqI5SNyH4MCqv07g0TCh2OD17AvWkCMWSNGkRPYPf74466jJ6ZxOlYooQ9Gz969e+OjrSA5rq7AyU7PnTVr1rTVT9bBII4HOkK5yLo/E+sxjpzYE3vppZdcserWrZtrGVkFsOcp+qJhoQRxdnS4tEVFzoIFCzIEFfMrb7zxht9LqHwKAsaRE7o9/PDDDJ4QTtKuXTuthgC33nor+/bbb21Vgt0vnq2qVKlie17WQadFIZUjJ5wO/FpE4RFFlO9FFh5Jr8dIciKOz1//+ldH7GEV069fP8cyMk/u2LGDde7cWVglwj8i5GdOTo6wTNgT2DMUWerAO+XMM88M24Tt9UEeIV577TXbuuigdwSMJCfU//vf/+64AIIyN998M6tUqRI+apFp06Y5Zn/GFHfixIls7NixLOjWg9ONgJhOo5Gq0TNIpjAZSYSdsMiEc8aSE1ZD3bt3d+wDjJ5YkNEpGNHd3Nzwo7Fq1Sol1kxRPHc2aNDAF8SY4oeNnuCrwYQWNpacwBuLMG6p6Bo2bMgaN26stXtuu+02BntgJ8E0d8aMGTzfSJCcn6K6dZMTq7TnnnuuSB3b414dGWwvpoO5CBhNTmjZtWtX5hZQa+TIkUxX0GnohFG9ffv2fPqK/50EGa+RlKhJkyZOxTyfcyJnjRo1PNfjtaBfvbEQhKk9SXgEjCfn/v37HRdiAAG2MYYMGRIeDR81wBUKxhAPPfQQJ6vTpdiGePPNN9ngwYN9r3qm14uwLgcPHkw/zP+HSeGJJ55oey7oQayK+xHcY1AjeT/tZEJZ48mJTkAAare9zzvuuEPJM57bl+CJJ57gNrZIMeEmDzzwAJ/m+t2WSK3XKcYR6q1cuXJq8VCf8aPnx8F9w4YN0tIGhlI8IRfHgpzAGkYHTuZr+GLCUL1EiRLau+bDDz9k2AscPXq066iB6fAjjzwSSkenqa3MvVanrSO7G7jrrrtcZxF219ExewRiQ05M5WDw7pQv8owzzuARDHREBkiHExHm8OWEjatbkqNevXqxihUrplfh+X8d5ISDQZcuXTzrhIW72bNney5PBd0RiA05cStr1qxxNXpHwCuMYFEJ4sxmZ2fzFH1Y0bWLIIAfj9tvvz2wik7kDEP6VIUwanpdZd62bRu79957Uy+nzxIQiBU5cb+wc3322Wcdb/2WW25hffr0cSyj+iTi/mAxBaZ9d955J0O4zdQ08mEiKWBFVBRwSwY54R7m1foK99S2bVuhaaNqnJNcf+zIic64//77+SKRU8fAWACLRFELnMjHjBnDF6sw7YaDdt++fZmTnawXnUV5ZvzuSdq1hWdir+E/cS8mZyq3u7+4HIslObFU37p1a9dESCNGjOAmfqZ0Bp6X582bx7d9wnrViKa22O8N43iNeER4dvYieHzQbaHlRa+klIklOQE+nHivvfZaYaoClMEKLmw8/Sxs4Lo4iIic0L1cwLCdsA0eP34885L386233mJ33313HKCKrY6xJScQR5h/RONz2mMEQTGCRv0MKvsb4kTOIL6l+fPn58QsW7asq6rvvfcea9OmjTBsimsFVMATArEmJ+4QSX7q1avHsGLoJHgGhbdIFNssTnoFPYcfJJFZYxBywh4WMxE3gUEIIg+KXNfcrqfz3hGIPTlxq0h4C4IitYOTwFtk7ty52jJzOeki45xo9PRDToyYCEvaoUMHV5WwUn7dddcRMV2RklMgEeQEFNYIKgrGZcGF+EOIpaorOLXVrop3ETnhEeNF8IyJZ0cve66IQgjrptTtIC9tUJngCCSGnIAACXNghOCWJh1bGvhSPvfcc1q9WYJ3k/2VInJ6iYhwzTXXcMdtuNw5CciIhR/YBZPoRSBR5AR0eBZDwiP4UjoJFoqwDwp3rriOoiJyOm2lwPYWwbvx7Og2/cUeLUhM/plO3yR15xJHTkCFtPB4Nho+fLgrcnAmBpHh0lWhQgXX8iYVgDudXdbr9JETEfKxuoowK4hDhM9uAiOJWrVqMRj1k0SDQCLJCSjhWtWjRw+GqHlOxvIW7HAqRnweOG7D5C4uYjd6YtqOWQF+nLAAhpQSGC2bNm3qyZ8U0/0rr7ySbd26NS4wJFLPxJLT6i3E+0GAKqfAWFbZrKws7tiN+DcgqQw7VatuVe92ZoBYgQXBYOkDkiHurBfBSAzLKxix2xnse6mDyshDIPHkBFQgW+3atT17q+DLDK8MRB2YOXMm3//zYjUjr1u81ySysfVew28lMQIjeh8FgvaLnLryGUFOwIdNc4wkWPzBqq4XwaIRVjOnT5/O91CxnQB/TRw3ReD9EjYsCOxj69SpQxmoTenU3/XIGHJauMN1C7lNhg0b5mvqhkWWe+65h0d2hzXSP//5Tz4FDJKmwNIl6Dum24gAOG7cOO7jimlsEIGDOPKdPvjgg76wCNIWXeMfgXzHFk5+RedkondB9erV+aKJnzg5dhAjdg7yUGIlFC9Mh7Glg0WpMIIfBKwgn3feeaxatWp82okIezICVi9fvpyvaCM3DYlZCOB7iZSPBcxSS682IBKcnmFTOmjQoMDZwuBDiRfCYFqC7GSwVsIL+4XIs4IXvGmwsY8Xpsdw8UJIEGx3gIwYifFCyj1Y8KgQPFfClJHS86lAV16dGU1OC0Ys+iBT2E033cQGDBjAygV0ubLqwzsWlTDqmbZ3CoMCxAIOO6qn3it9VoNAsIcVNbpEWiu+rEjci+e5G264gU9TI1VIQeMwcIcpHhFTAbgKqiRypoGKL+7UqVP56iWM5OGJgSlq3GXWrFl8QSvu95FJ+hM5HXobe3/wxEAsXOx7zjsWYiTstoVDc8pOIdcpPE9oxFQGsZKKiZweYD1w4AAPd4LgXIgUALNAjESitAgeqtRaBAHGRI7ZWhWhxnwhQAtCvuBi/EsOm1W8EFUBLmrw3MCqL5bAseqqS2Azi9Ed2zhYFRalrIAHCkn8ECByhugzbIcsWLCAv1ANtkbKly/PsBcJoiJFA/7H6m+hQoUCtYTtDhigYz8SZoh4Ifcn9imRbTtVsNqM0T1d4FxOEj8EiJwS+wzPdHDhwuv1118/rmbsZcLPslixYpyo2MNERjBY9+AFooOIeMFyB3ui2B+FMbpXQTbwdHJiSi4KQO21XioXDQJETk24w8cUo59KixxMX2GtlBpYOn101XS71IwEBGhBSAKIJlWR/tyZhG0gk/DVqQuRUyfaGtpCGsTU7R4KYakBdEVNEDkVARtVtfCYmTNnTm7zQT1WciugD5EhQOSMDHp1DU+cODG38vR4Qrkn6IPxCBA5je8i/wrCOdwKM0Lk9I+fKVdwcprk2W8KMHHWA1snVnZtGEoQQePZm5yc8CkkSRYCCINpCSI/kMQHAYuPnJwIpUiSLARg+2sJoiiQxAcBGKpAODkrVaoUH81JU08IwBjBMniAKSFJfBBAWBoIJyfCRtJzZ3w6z6um1ugZNkaS1/aonBwE4EcM4eQsXLgwD/kop2qqxRQE4H8KQaiUKKIE8sbpjy8EsIBXv359fg0nJz4h4BNJshBYuHBh7g3BpY3EfASaNWvGMFhCjiNn0aJFzdeeNPSMAJIJW/lO3FL9ea6UCipFAI78luSSE8u3/fv3t47Te0IQsEbPxo0bJ+SOknsbCNFqPW/iLnPJiX+QrgBp30iSgwDSNUDgS0p9a26/wr83PWXlceREsp5JkyaxIkWKmHsXpJkvBBA425LmzZtbH+ndMAReeOEFHp8qVa3jyIkTCKmBIMvw3CeJPwKp5Lz++uvjf0MJvAPk7WnVqlWeO8tDTpRAJi0kXbUsFfJcRQdigwAiIezZs4frW7lyZeMi0McGSAWKwp1v1KhRPB+qXfW25ERBJJz9/PPPWXZ2tt11dCxGCCAomCV2v9DWOXrXhwBCrMI5oVOnTsJGheTEFSVLluTxWZGy3DIpEtZEJ4xFIJWcOTk5xuqZCYphPefRRx/lERRTV2bt7t2RnNYFbdq04ZUhgNQtt9zCSWudo3fzEVi/fn2ukhdddBFfV8g9QB+UI4BYxk2aNOGByWHv3K9fPx550a1hnp/TrZDd+Z07dzJ0OsI4Uio5O4TMOVa6dGl2ySWX5Cq0cuVK9tVXX+X+Tx/kI5CVlcXzqGKBtUyZMjz8qd9WApPTb0NUnhAgBPwh8D8I22yw4XkRvwAAAABJRU5ErkJggg==';
+        $this->image = $image;
         $this->domain = $domain;
         $this->options = $options;
     }",Why did you change this?,php,1,0,1
"@@ -11,8 +11,6 @@
 
 namespace Sonata\MediaBundle\Tests\Command;
 
-use Sonata\ClassificationBundle\Model\CategoryManagerInterface;
-use Sonata\ClassificationBundle\Model\ContextManagerInterface;
 use Sonata\MediaBundle\Command\FixMediaContextCommand;
 use Sonata\MediaBundle\Provider\Pool;
 use Symfony\Component\Console\Application;",We can keep the imports.,php,1,1,1
"@@ -65,10 +65,9 @@ class DisplayLanguageOptionFactory implements FactoryInterface
         if (!empty($options)) {
             throw new \Exception('Unexpected options sent to factory.');
         }
-        // We want to construct a separate translator instance for this helper,
-        // since it configures different language/locale than the core shared
-        // instance!
-        $factory = new \VuFind\I18n\Translator\TranslatorFactory();
-        return new $requestedName($factory($container, Translator::class));
+        $translator = $container->get(Translator::class);
+        // Add a special locale used just for this plugin:
+        $translator->addTranslationFile('ExtendedIni', null, 'default', 'native');
+        return new $requestedName($translator);
     }
 }","Perhaps it makes more sense to put this in the actual TranslatorFactory; I'm torn between doing that (which is probably more straightforward) and leaving it here (since it ties the loading of the translations to the use of the helper that needs them). Any thoughts/preferences, @EreMaijala?",php,0,1,1
"@@ -343,7 +343,7 @@ class GalleryController
             'csrf_protection' => false,
         ));
 
-        $form->bind($request);
+        $form->handleRequest($request);
 
         if ($form->isValid()) {
             $galleryHasMedia = $form->getData();",Not related to this PR. Please create a separate one.,php,0,0,1
"@@ -15,6 +15,11 @@ namespace Sonata\ClassificationBundle\Model;
 
 interface ContextInterface
 {
+    /**
+     * @return mixed
+     */
+    public function getId();
+
     public function getName(): ?string;
 
     /**",isnt this a bc break?,php,1,0,1
"@@ -27,11 +27,8 @@ final class ForbiddenSuperGlobalSniff implements Sniff
     {
         return [T_VARIABLE];
     }
-
-    /**
-     * @param int $position
-     */
-    public function process(File $file, $position): void
+    
+    public function process(File $file, int $position): void
     {
         $currentToken = $file->getTokens()[$position];
 ",Should be fixed,php,1,0,1
"@@ -187,9 +187,9 @@ function show_status_html($x) {
     end_table();
     
     global $server_version;
-    global $git_commit;
-    if ( isset($server_version) && isset($git_commit) ) {
-        echo ""Server version: $server_version (<a href=https://github.com/BOINC/boinc/commit/$git_commit>$git_commit</a>)<br>"";
+    global $git_url;
+    if ( isset($server_version) && isset($git_url) ) {
+        echo ""Server version: <a href=\""$git_url\"">$server_version</a><br>"";
     }
 
     if ($j->db_revision) {","I recommend to make the link optional but always show the version (if available). Right now `$git_url` is set in a way that makes the following assumptions: - the source repo was cloned via `https`, not `ssh` - the source repo's relevant remote is called ""origin"" I think that both assumptions shouldn't be made. At least the code should prepare for the case that they're no met, i.e. make the link/URL optional and don't just assume you got a ""working"" `$git_url`.",php,1,1,0
"@@ -3,7 +3,7 @@ namespace Psalm\Tests\Provider;
 
 use PhpParser;
 
-class ParserInstanceCacheProvider extends \Psalm\Provider\ParserCacheProvider
+class ParserInstanceCacheProvider extends \Psalm\Internal\Provider\ParserCacheProvider
 {
     /**
      * @var array<string, string>",nit: Would it make more sense to move tests/Provider to tests/Internal/Provider (etc.) so that Psalm\Tests\Internal\Foo contains overrides of Psalm\Internal\Foo (e.g. if both Psalm\Provider and Psalm\Internal\Provider exist later),php,1,1,1
"@@ -9954,7 +9954,8 @@ return [
 'preg_filter' => ['null|string|string[]', 'regex'=>'mixed', 'replace'=>'mixed', 'subject'=>'mixed', 'limit='=>'int', '&w_count='=>'int'],
 'preg_grep' => ['array', 'regex'=>'string', 'input'=>'array', 'flags='=>'int'],
 'preg_last_error' => ['int'],
-'preg_match' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_subpatterns='=>'string[]', 'flags='=>'int', 'offset='=>'int'],
+'preg_match' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_subpatterns='=>'string[]', 'flags='=>'0|', 'offset='=>'int'],
+'preg_match\'1' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_subpatterns='=>'array', 'flags='=>'int', 'offset='=>'int'],
 'preg_match_all' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_subpatterns='=>'array', 'flags='=>'int', 'offset='=>'int'],
 'preg_quote' => ['string', 'str'=>'string', 'delim_char='=>'string'],
 'preg_replace' => ['string|string[]|null', 'regex'=>'string|array', 'replace'=>'string|array', 'subject'=>'string|array', 'limit='=>'int', '&w_count='=>'int'],","Typing flags as `0` doesn't work, but `0|` does. Is this a bug in `Type::parseTokens()`?",php,1,1,1
"@@ -23,7 +23,7 @@ class LocalTest extends TestCase
         $local = new Local('/tmp');
 
         // check if OS is Mac OS X where /tmp is a symlink to /private/tmp
-        $result = 'Darwin' === php_uname('s') ? '/private/tmp' : '/tmp';
+        $result = 'Darwin' === PHP_OS ? '/private/tmp' : '/tmp';
 
         $this->assertSame($result, $local->getDirectory());
     }",I wonder if this could be simplified by using `sys_get_tmp_dir()`,php,1,1,1
"@@ -23,8 +23,12 @@ var (
 	plugin   = ""local""
 	// 1 week
 	updateInterval = time.Hour * 24 * 7
+	siteName       string
+	serviceType    string
 )
 
+const netName = ""ddev_default""
+
 // RootCmd represents the base command when called without any subcommands
 var RootCmd = &cobra.Command{
 	Use:   ""ddev"",",It feels like we should be working to reduce/eliminate our global vars. I'm not sure it adds much here. Any objection to just removing it?,php,1,1,1
"@@ -1,4 +1,5 @@
 <?php namespace System\Traits;
+use October\Rain\Exception\ValidationException;
 
 /**
  * Property container trait","Doesn't look like this needs to be here, no exceptions are thrown.",php,1,1,1
"@@ -6,10 +6,10 @@ use Ivory\CKEditorBundle\Form\Type\CKEditorType;
 use Shopsys\FormTypesBundle\MultidomainType;
 use Shopsys\ShopBundle\Component\Domain\Config\DomainConfig;
 use Shopsys\ShopBundle\Component\Domain\Domain;
-use Shopsys\ShopBundle\Component\Form\InvertChoiceTypeExtension;
 use Shopsys\ShopBundle\Component\Plugin\PluginCrudExtensionFacade;
 use Shopsys\ShopBundle\Form\DomainsType;
 use Shopsys\ShopBundle\Form\FileUploadType;
+use Shopsys\ShopBundle\Form\InvertChoiceTypeExtension;
 use Shopsys\ShopBundle\Form\Locale\LocalizedType;
 use Shopsys\ShopBundle\Form\UrlListType;
 use Shopsys\ShopBundle\Model\Category\Category;","commit message word order should be ""InvertChoiceTypeExtension moved from...""",php,0,0,1
"@@ -53,7 +53,10 @@ class Bootstrap
         }
 
         $kernel = new AppKernel($this->environment, EnvironmentType::isDebug($this->environment));
-        Request::setTrustedProxies(['127.0.0.1'], Request::HEADER_X_FORWARDED_ALL);
+
+        $kernel->boot();
+        $trustedProxies = $kernel->getContainer()->getParameter('trusted_proxies');
+        Request::setTrustedProxies($trustedProxies, Request::HEADER_X_FORWARDED_ALL);
         if ($this->console) {
             $input = new ArgvInput();
             $output = new ConsoleOutput();",kernel->boot seems to have bad impact on symfony console somehow,php,1,1,1
"@@ -18,6 +18,7 @@ use Thelia\Core\Event\TheliaEvents;
 use Thelia\Core\Security\Resource\AdminResources;
 use Thelia\Exception\CustomerException;
 use Thelia\Form\Definition\AdminForm;
+use Thelia\Model\Customer;
 use Thelia\Model\CustomerQuery;
 use Thelia\Tools\Password;
 ",This class seems never used.,php,1,1,1
"@@ -33,6 +33,6 @@ class Context extends BaseContext
 
     public function getId()
     {
-        return $this->id;
+        return $this->id ?? '';
     }
 }",Isn't better to return null if there is no id and check for null value if needed ?,php,1,1,1
"@@ -232,6 +232,8 @@ class FormController extends ControllerBehavior
 
         $this->initForm($model);
 
+        $model->forceFill($this->formWidget->getSaveData());
+
         $this->controller->formBeforeSave($model);
         $this->controller->formBeforeCreate($model);
 ",Why is this required?,php,1,0,1
"@@ -252,6 +252,13 @@ class Controller
             $result = $event;
         }
 
+        /*
+         * Set a default samesite config value for invalid values
+         */
+        if (!in_array(strtolower(Config::get('session.same_site', 'lax')), ['lax', 'strict', 'none'])) {
+            Config::set('session.same_site', 'Lax');
+        }
+
         /*
          * Prepare and return response
          * @see \System\Traits\ResponseMaker",@ayumi-cloud this should be done in the System service provider,php,0,1,1
"@@ -98,6 +98,12 @@ class IssueData
      */
     public $error_level;
 
+    /**
+     * @var int
+     * @readonly
+     */
+    public $shortcode;
+
     /**
      * @var string
      * @readonly",Added this so it can be used to send the error code to the client.,php,0,0,1
"@@ -121,7 +121,9 @@ class FieldExtension extends AbstractExtension
 
     public function getType(Field $field): string
     {
-        return $field->getType() ?? $field->getDefinition()->get('type');
+        // Note, this used to be a ternary, with `?? $field->getDefinition()->get('type');`. I'm not sure
+        // how/when this would trigger, since $field->getType always returns a value. 🤔💭
+        return $field->getType();
     }
 
     /**","Hm, looks like it was left as a ""safe"" choice in #1709 . Which means it's probably safe as-is now.",php,0,1,1
"@@ -128,7 +128,6 @@ class GalleryAdmin extends AbstractAdmin
             ->end()
             ->with('Gallery')
                 ->add('galleryHasMedias', 'sonata_type_collection', array(
-                        'cascade_validation' => true,
                     ), array(
                         'edit' => 'inline',
                         'inline' => 'table',",Why remove this?,php,1,0,1
"@@ -15,7 +15,14 @@ namespace Thelia\Coupon;
 use Symfony\Component\DependencyInjection\ContainerInterface;
 use Thelia\Condition\Implementation\ConditionInterface;
 use Thelia\Coupon\Type\CouponInterface;
+use Thelia\Log\Tlog;
+use Thelia\Model\AddressQuery;
+use Thelia\Model\Base\CouponModule;
 use Thelia\Model\Coupon;
+use Thelia\Model\CouponCountry;
+use Thelia\Model\CouponCustomerCount;
+use Thelia\Model\CouponCustomerCountQuery;
+use Thelia\Model\Order;
 
 /**
  * Manage how Coupons could interact with a Checkout","Be careful, base model is imported here.",php,1,0,1
"@@ -887,13 +887,18 @@ func (app *DdevApp) Down(removeData bool) error {
 		return fmt.Errorf(""failed to remove %s: %v"", app.GetName(), err)
 	}
 
-	// Remove data/database if we need to.
+	// Remove data/database/hostname if we need to.
 	if removeData {
+		if err = app.RemoveHostsEntries(); err != nil {
+			return fmt.Errorf(""failed to remove hosts entries: %v"", err)
+		}
+
 		// Check that app.DataDir is a directory that is safe to remove.
 		err = validateDataDirRemoval(app)
 		if err != nil {
 			return fmt.Errorf(""failed to remove data/database directories: %v"", err)
 		}
+
 		// mysql data can be set to read-only on linux hosts. PurgeDirectory ensures files
 		// are writable before we attempt to remove them.
 		if !fileutil.FileExists(app.DataDir) {",I think it's worth just a small conversation on whether we should just do this on regular rm as well. I guess the argument against is that people hit sudo too often.,php,1,1,1
"@@ -101,7 +101,6 @@ class Faceting implements Modifier
      */
     protected function buildFacetingParameters()
     {
-        $facetParameters = array();
         foreach ($this->allConfiguredFacets as $facetName => $facetConfiguration) {
             $facetName = substr($facetName, 0, -1);
 ",This initializes the variable and should not be removed. If at all it should be moved to before line 109,php,0,1,1
"@@ -80,11 +80,13 @@ class FileProvider extends BaseProvider implements FileProviderInterface
 
     public function getReferenceImage(MediaInterface $media): string
     {
-        return sprintf(
-            '%s/%s',
-            $this->generatePath($media),
-            $media->getProviderReference()
-        );
+        $providerReference = $media->getProviderReference();
+
+        if (null === $providerReference) {
+            return '';
+        }
+
+        return sprintf('%s/%s', $this->generatePath($media), $providerReference);
     }
 
     public function getReferenceFile(MediaInterface $media): GaufretteFile",Same thing about reference to videos here.,php,0,0,1
"@@ -151,7 +151,7 @@ func sentryNotSetupWarning() {
 // from the last saved version. If it is, prompt to request anon ddev usage stats
 // and update the info.
 func checkDdevVersionAndOptInSentry() error {
-	if !output.JSONOutput && version.COMMIT != globalconfig.DdevGlobalConfig.LastUsedVersion && globalconfig.DdevGlobalConfig.InstrumentationOptIn == false {
+	if !output.JSONOutput && version.COMMIT != globalconfig.DdevGlobalConfig.LastUsedVersion && globalconfig.DdevGlobalConfig.InstrumentationOptIn == false && os.Getenv(""DDEV_NO_SENTRY"") == """" {
 		allowStats := util.Confirm(""It looks like you have a new ddev release.\nMay we send anonymous ddev usage statistics and errors?\nTo know what we will see please take a look at\nhttps://ddev.readthedocs.io/en/latest/users/cli-usage/#opt-in-usage-information\nPermission to beam up?"")
 		if allowStats {
 			globalconfig.DdevGlobalConfig.InstrumentationOptIn = true","I think it'd be a good idea to define the environment variable name as a constant in values.go because it's hard-coded in several places, but that's a small point.",php,1,1,1
"@@ -318,11 +318,11 @@ class CallChecker
                     $stmt->args,
                     $method_id,
                     $function_params,
+                    $code_location,
+                    $context->check_variables,
                     $function_storage,
                     null,
-                    $generic_params,
-                    $code_location,
-                    $context->check_variables
+                    $generic_params
                 ) === false) {
                     // fall through
                 }",These arguments were shifted around because PSR-2 requires that method arguments with default values go at the end of the list.,php,1,1,1
"@@ -32,6 +32,7 @@
 #include ""MainDocument.h""
 #include ""version.h""
 
+#include <wx/settings.h>
 
 ////@begin XPM images
 #include ""res/skins/default/graphic/background_image.xpm""",This is to bring in `wxSystemSettings`.,php,1,1,1
"@@ -0,0 +1,18 @@
+<?php
+
+declare(strict_types=1);
+
+namespace Bolt\Widget;
+
+use Symfony\Component\HttpFoundation\Response;
+
+/**
+ * Interface ResponseAware - Widgets that make use of the Response to provide
+ * their functionality need to implement this interface.
+ */
+interface ResponseAware
+{
+    public function setResponse(?Response $response = null): WidgetInterface;
+
+    public function getResponse(): ?Response;
+}",responses are not optional here,php,1,1,1
"@@ -78,4 +78,17 @@ return [
 
     'prefix' => 'october',
 
+    /*
+    |--------------------------------------------------------------------------
+    | Disable Request Cache
+    |--------------------------------------------------------------------------
+    |
+    | The request cache remembers cache retrievals from your cache store
+    | in memory to speed up consecutive retrievals within the same request.
+    | It is recommended you leave this on both in production and development.
+    |
+    */
+
+    'disableRequestCache' => false,
+
 ];","Change `remembers` to `stores`, `your` to `the`, and replace the last line with `Set to true to disable this in-memory request cache` please. Thanks!",php,1,1,1
"@@ -30,8 +30,9 @@ class Config
     /** @var string */
     private $projectDir;
 
-    public function __construct(Stopwatch $stopwatch, $projectDir, CacheInterface $cache)
+    public function __construct(Stopwatch $stopwatch, string $projectDir, CacheInterface $cache)
     {
+        // @todo move stopwatch to decorator or remove it completely
         $this->stopwatch = $stopwatch;
         $this->cache = $cache;
         $this->projectDir = $projectDir;","I've added it to see what the impact of parsing the config was. If we're content with it now, we can remove it.",php,1,1,1
"@@ -54,11 +54,12 @@ abstract class AbstractCrudController extends BaseAdminController
      *
      * @param string $visibilityToggleEventIdentifier the dispatched visibility toggle TheliaEvent identifier, or null if the object has no visible options. Example: TheliaEvents::MESSAGE_TOGGLE_VISIBILITY
      * @param string $changePositionEventIdentifier   the dispatched position change TheliaEvent identifier, or null if the object has no position. Example: TheliaEvents::MESSAGE_UPDATE_POSITION
+     * @param string $moduleCode The module code for ACL
      */
     public function __construct(
         $objectName,
-        $defaultListOrder = null,
-        $orderRequestParameterName = null,
+        $defaultListOrder,
+        $orderRequestParameterName,
         $resourceCode,
         $createEventIdentifier,
         $updateEventIdentifier,","I don't agree, don't change the signature. I know it's an issue on scrutinizer but we have to deal with it.",php,1,1,1
"@@ -1024,6 +1024,13 @@ class ArrayAccessTest extends TestCase
                         return $p[""name""];
                     }'
             ],
+            'unsetListKeyedArrayDisableListFlag' => [
+                '<?php
+                $a = [""a"", ""b""];
+                unset($a[0]);
+                ',
+                'assertions' => ['$a===' => 'array{1: ""b""}']
+            ],
         ];
     }
 ",This can be improved by keeping the flag when _last_ element is being unset.,php,1,1,1
"@@ -19,7 +19,8 @@ return [
     'password_hash' => ['string|null', 'password'=>'string', 'algo'=>'int|string|null', 'options='=>'array'],
     'password_needs_rehash' => ['bool', 'hash'=>'string', 'algo'=>'int|string|null', 'options='=>'array'],
     'proc_open' => ['resource|false', 'command'=>'string|array', 'descriptorspec'=>'array', '&w_pipes'=>'resource[]', 'cwd='=>'?string', 'env='=>'?array', 'other_options='=>'array'],
-    'ReflectionProperty::getType' => ['?ReflectionType'],
+    'ReflectionProperty::getType' => ['?ReflectionNamedType'],
+    'ReflectionParameter::hasType' => ['bool'],
 ],
 'old' => [
     'gzread' => ['string|0', 'stream'=>'resource', 'length'=>'int'],","`ReflectionParameter::hasType()` is available since 7.0, and I don't think its return type has ever changed. So this does not belong in 7.4 delta.",php,1,1,1
"@@ -33,7 +33,7 @@ class CurrentCategoryResolver
     /**
      * @param \Symfony\Component\HttpFoundation\Request $request
      * @param int $domainId
-     * @return \Shopsys\ShopBundle\Model\Category\Category|null
+     * @return \Shopsys\FrameworkBundle\Model\Category\Category|null
      */
     public function findCurrentCategoryByRequest(Request $request, $domainId)
     {",why? maybe another phpstan extension ?,php,1,1,1
"@@ -25,9 +25,6 @@ class MissingLocaleException extends Exception
         parent::__construct($message, 0, $previous);
     }
 
-    /**
-     * @return string
-     */
     public function getLocale()
     {
         return $this->locale;",This should not have been removed!,php,1,0,1
"@@ -10608,7 +10608,7 @@ return [
 'RdKafka\ProducerTopic::__construct' => ['void'],
 'RdKafka\ProducerTopic::getName' => ['string'],
 'RdKafka\ProducerTopic::produce' => ['void', 'partition'=>'int', 'msgflags'=>'int', 'payload'=>'string', 'key='=>'?string'],
-'RdKafka\ProducerTopic::producev' => ['void', 'partition'=>'int', 'msgflags'=>'int', 'payload'=>'string', 'key='=>'?string', 'headers'=>'?array<string, string>', 'timestamp_ms'=>'?int'],
+'RdKafka\ProducerTopic::producev' => ['void', 'partition'=>'int', 'msgflags'=>'int', 'payload'=>'string', 'key='=>'?string', 'headers='=>'?array<string, string>', 'timestamp_ms='=>'?int', 'opaque='=>'?string'],
 'RdKafka\Queue::__construct' => ['void'],
 'RdKafka\Queue::consume' => ['?RdKafka\Message', 'timeout_ms'=>'string'],
 'RdKafka\Topic::getName' => ['string'],","`$opaque` is only available with RdKafka 5.0, right? This raises an interesting question that went largely ignored before: should we split callmaps for non-core extensions out into their own files and version them based on the extension version? PECL extensions have their own version cycle, not bound to PHP release lifecycle. E.g. RdKafka 4.1 supports PHP 5.6 - 7.\*, while 5.0 supports an overlapping range of 7.\* - 8.\*. So when running on 7.4 you could have either 4.1 or 5.0, but we're forced to choose a single signature to put into 7.4 callmap. @muglug @orklah thoughts?",php,0,1,0
"@@ -13,7 +13,7 @@ declare(strict_types=1);
 
 namespace Sonata\MediaBundle\Document;
 
-use Sonata\DatagridBundle\Pager\PagerInterface;
+use Sonata\AdminBundle\Datagrid\PagerInterface;
 use Sonata\Doctrine\Document\BaseDocumentManager;
 use Sonata\MediaBundle\Model\MediaManagerInterface;
 ",This looks wrong. You should use the bundle without the admin stuff,php,1,1,1
"@@ -76,6 +76,7 @@ class OverviewModuleController extends AbstractModuleController
     {
         $connectedHosts = [];
         $missingHosts = [];
+        $invalidPath = [];
 
         foreach ($this->connections as $connection) {
             $coreUrl = $connection->getScheme() . '://' . $connection->getHost() . ':' . $connection->getPort() . $connection->getPath();",should be plural,php,1,1,1
"@@ -583,9 +583,12 @@ class Manager implements \LmcRbacMvc\Identity\IdentityProviderInterface
         // Depending on verification setting, either do a direct update or else
         // put the new address into a pending state.
         if ($this->config->Authentication->verify_email ?? false) {
-            $user->pending_email = $email;
+            // If new email address is the current address, just reset any pending
+            // email address:
+            $user->pending_email = ($email === $user->email) ? '' : $email;
         } else {
             $user->updateEmail($email, true);
+            $user->pending_email = '';
         }
         $user->save();
         $this->updateSession($user);","@EreMaijala, I simplified this with a ternary operator. Any objections?",php,0,1,1
"@@ -488,11 +488,13 @@ class Controller
 
         $useCache = !Config::get('cms.twigNoCache');
         $isDebugMode = Config::get('app.debug', false);
+        $strictVariables = (Config::get('cms.enableTwigStrictVariables', null) !== null) ?: $isDebugMode;
         $forceBytecode = Config::get('cms.forceBytecodeInvalidation', false);
 
         $options = [
             'auto_reload' => true,
             'debug' => $isDebugMode,
+            'strict_variables' => $isDebugMode,
         ];
 
         if ($useCache) {","This needs to be `$strictVariables`, please test each config value and ensure that they're working as intended (true = enabled, false = disabled, null = value of app.debug)",php,1,1,1
"@@ -31,7 +31,12 @@ class FormTabs implements IteratorAggregate, ArrayAccess
      * @var string Default tab label to use when none is specified.
      */
     public $defaultTab = 'backend::lang.form.undefined_tab';
-
+    
+    /**
+     * @var string List of icons for their corresponding tabs.
+     */
+    public $icons;
+    
     /**
      * @var bool Should these tabs stretch to the bottom of the page layout.
      */",This would be an array right? Also could you add the expected array structure here in the form of `['tab-name' => 'icon-class']`?,php,1,1,1
"@@ -125,7 +125,7 @@ final class GalleryListBlockService extends AbstractBlockService implements Edit
         $order = $blockContext->getSetting('order');
         \assert(\is_string($order));
         $sortDirection = $blockContext->getSetting('sort');
-        \assert(\is_string($sortDirection));
+        \assert(\is_string($sortDirection) && \in_array($sortDirection, ['asc', 'desc'], true));
         $template = $blockContext->getTemplate();
         \assert(\is_string($template));
 ",is_string check might no be needed then,php,1,1,1
"@@ -801,9 +801,11 @@ namespace vboxmanage {
                 return deregister_vm(false);
             } else {
                 command  = ""closemedium dvd \"""" + virtual_machine_slot_directory + ""/"" + iso_image_filename + ""\"" "";
+                // coverity[CHECKED_RETURN]
                 vbm_popen(command, output, ""remove virtual ISO 9660 disk"", false);
                 if (enable_cache_disk) {
                      command  = ""closemedium disk \"""" + virtual_machine_slot_directory + ""/"" + cache_disk_filename + ""\"" "";
+                     // coverity[CHECKED_RETURN]
                      vbm_popen(command, output, ""remove virtual cache disk"", false);
                 }
             }","@ChristianBeer, Personally I don't like stuff like this. Are these checks so critical and important that we need to say to coverity that we are ok with this? As far as I know, we don't have a mission to achieve 0 messages from any static analyzer, so why do we need this?",php,0,1,1
"@@ -214,10 +214,17 @@ class QueryController implements ContainerInjectionInterface {
   }
 
   /**
-   * Add the header row.
+   * Add the header row, from specified properties, if any, or the schema.
    */
   private function addHeaderRow(array &$data) {
-    $header_row = array_keys(reset($data['schema'])['fields']);
+
+    if (!empty($data['query']['properties'])) {
+      $header_row = $data['query']['properties'];
+    }
+    else {
+      $header_row = array_keys(reset($data['schema'])['fields']);
+    }
+
     if (is_array($header_row)) {
       array_unshift($data['results'], $header_row);
     }",@thierrydallacroce possible to provide test coverage for this condition?,php,0,1,1
"@@ -66,10 +66,6 @@ echo ""<project_config>
     <web_rpc_url_base>"".secure_url_base().""</web_rpc_url_base>
 "";
 
-if ( isset($git_commit) ) {
-    echo ""<git_commit>$git_commit</git_commit>\n"";
-}
-
 if ( isset($server_version) ) {
     echo ""<server_version>$server_version</server_version>\n"";
 }",Does this mean that the project config should not communicate any codebase details anymore? Why not replace this with the newly generated common tag base?,php,1,1,1
"@@ -50,7 +50,7 @@ interface MediaProviderInterface
     /**
      * return the format settings.
      *
-     * @return array<string, mixed>|false the format settings
+     * @return array|false the format settings
      *
      * @phpstan-return FormatOptions|false
      */",you could have kept the precision,php,1,1,1
"@@ -17,7 +17,7 @@ const SiteNotFound = ""not found""
 const SiteDirMissing = ""app directory missing""
 
 // SiteConfigMissing defines the string used to denote when a site is missing its .ddev/config.yml file.
-const SiteConfigMissing = "".ddev/config.yml missing""
+const SiteConfigMissing = "".ddev/config.yaml missing""
 
 // SiteStopped defines the string used to denote when a site is in the stopped state.
 const SiteStopped = ""stopped""","Hmm, thought this would happen if .ddev was missing or docker_compose.yml was missing? Fine with me, don't think it's that important.",php,1,1,1
"@@ -76,6 +76,7 @@ class ServiceProvider extends ModuleServiceProvider
             $combiner->registerBundle('~/modules/backend/formwidgets/fileupload/assets/less/fileupload.less');
             $combiner->registerBundle('~/modules/backend/formwidgets/nestedform/assets/less/nestedform.less');
             $combiner->registerBundle('~/modules/backend/formwidgets/richeditor/assets/js/build-plugins.js');
+            $combiner->registerBundle('~/modules/backend/formwidgets/colorpicker/assets/less/colorpicker.less');
 
             /*
              * Rich Editor is protected by DRM",@w20k widget assets are recompiled when they're registered like this and then `php artisan october:util compile` is run.,php,0,1,1
"@@ -1157,10 +1157,8 @@ class RelationController extends ControllerBehavior
             }
         }
         elseif ($this->viewMode == 'single') {
-            $this->viewModel = $this->manageWidget->model;
-
             $this->viewWidget->setFormValues($saveData);
-            $this->viewModel->save(null, $this->manageWidget->getSessionKey());
+            $this->viewWidget->model->save(null, $this->manageWidget->getSessionKey());
         }
 
         return $this->relationRefresh();",Why wouldn't you just change this line to `$this->viewWidget->model`?,php,1,1,1
"@@ -57,7 +57,7 @@ class IdUserProvider implements UserProviderInterface
     /**
      * {@inheritdoc}
      */
-    public function refreshUser(UserInterface $user): User
+    public function refreshUser(UserInterface $user): UserInterface
     {
         return $this->loadUserByUsername($user->getUsername());
     }",PHPStan claims it's incorrect? It's legit by PHP...,php,1,1,1
"@@ -119,10 +119,6 @@ class SonataMediaExtension extends Extension
         $pool = $container->getDefinition('sonata.media.pool');
         $pool->replaceArgument(0, $config['default_context']);
 
-        // this shameless hack is done in order to have one clean configuration
-        // for adding formats ....
-        $pool->addMethodCall('__hack__', $config);
-
         $strategies = array();
 
         foreach ($config['contexts'] as $name => $settings) {",Why isolate this in a method?,php,1,1,1
"@@ -27,11 +27,11 @@ interface CategoryManagerInterface
     public function getRootCategory($context);
 
     /**
-     * @param bool|true $loadChildren
+     * @param bool $loadChildren
      *
      * @return CategoryInterface[]
      */
-    public function getRootCategories($loadChildren);
+    public function getRootCategories($loadChildren = true);
 
     /**
      * @param int $categoryId","this is a BC break, we should add an UPGRADE note",php,1,1,1
"@@ -653,8 +653,7 @@ func drupalEnsureWritePerms(app *DdevApp) error {
 
 	for _, o := range makeWritable {
 		stat, err := os.Stat(o)
-		// If the file doesn't exist, don't try to set the permissions.
-		if os.IsNotExist(err) {
+		if err != nil {
 			continue
 		}
 ","I'm pretty sure this should emit a util.Warning*(), since we're skipping by here and never hitting anything that will give them a warning about what's happened.",php,1,1,1
"@@ -89,9 +89,7 @@ final class CropResizer implements ResizerInterface
     }
 
     /**
-     * @param array<string, int> $settings
-     *
-     * @phpstan-param array{width: int, height: int} $settings
+     * @param array<string, mixed> $settings
      */
     private function createTargetBox(array $settings): Box
     {",Why losing this ?,php,1,0,1
"@@ -3,16 +3,14 @@
 namespace App;
 
 use Roots\Sage\Container;
-use Illuminate\Contracts\Container\Container as ContainerContract;
 
 /**
  * Get the sage container.
  *
  * @param string $abstract
  * @param array  $parameters
- * @param ContainerContract $container
- * @return ContainerContract|mixed
- * @SuppressWarnings(PHPMD.StaticAccess)
+ * @param Container $container
+ * @return Container|mixed
  */
 function sage($abstract = null, $parameters = [], ContainerContract $container = null)
 {",@QWp6t Still have a reference to `ContainerContract` (removed from `use`)! :smiley:,php,0,1,1
"@@ -0,0 +1,18 @@
+<?php
+use October\Rain\Database\Schema\Blueprint;
+use October\Rain\Database\Updates\Migration;
+class DbSystemMailLayoutsInlineCss extends Migration
+{
+    public function up()
+    {
+        Schema::table('system_mail_layouts', function (Blueprint $table) {
+            $table->boolean('inline_css')->default(true);
+        });
+    }
+    public function down()
+    {
+        Schema::table('system_mail_layouts', function (Blueprint $table) {
+           $table->dropColumn('inlince_css');
+        });
+    }
+}",Think this should be `inline_css`,php,1,1,1
"@@ -12,8 +12,9 @@ interface ProductFactoryInterface
 
     /**
      * @param \Shopsys\FrameworkBundle\Model\Product\ProductData $data
+     * @param \Shopsys\FrameworkBundle\Model\Product\Product $mainProduct
      * @param \Shopsys\FrameworkBundle\Model\Product\Product[] $variants
      * @return \Shopsys\FrameworkBundle\Model\Product\Product
      */
-    public function createMainVariant(ProductData $data, array $variants): Product;
+    public function createMainVariant(ProductData $data, Product $mainProduct, array $variants): Product;
 }",docs do not mention the change of `createMainVariant` interface - I believe they should,php,1,1,1
"@@ -99,7 +99,7 @@ class SonataMediaExtension extends Extension implements PrependExtensionInterfac
         $loader->load('serializer.xml');
         $loader->load('command.xml');
 
-        if (!in_array(strtolower($config['db_driver']), ['doctrine_orm', 'doctrine_mongodb', 'doctrine_phpcr'])) {
+        if (!in_array(strtolower($config['db_driver']), ['doctrine_orm', 'doctrine_mongodb', 'doctrine_phpcr', 'no_driver'])) {
             throw new \InvalidArgumentException(sprintf('SonataMediaBundle - Invalid db driver ""%s"".', $config['db_driver']));
         }
 ","can we extract this array into a `const` maybe, what do @sonata-project/contributors think?",php,0,1,1
"@@ -24,14 +24,14 @@ return [
         ],
         'access_denied' => [
             'label' => 'Hozzáférés megtagadva',
-            'help' => 'Ön nem rendelkezik a szükséges engedélyekkel ennek a lapnak a megtekintéséhez.',
+            'help' => 'Nem rendelkezik a szükséges engedélyekkel ennek a lapnak a megtekintéséhez.',
             'cms_link' => 'Vissza a látogatói oldalra'
         ],
         'no_database' => [
             'label' => 'Az adatbázis nem elérhető',
             'help' => 'Kérjük ellenőrizze a hozzáférési adatok helyességét majd próbálja újra betölteni az oldalt.',
             'cms_link' => 'Vissza a weboldalra'
-        ],
+        ]
     ],
     'partial' => [
         'not_found_name' => ""A(z) ':name' részlap nem található."",","All array elements should have a trailing comma in the language files, this makes it much easier to update them in the future. I'm not going to force people to add them but I do draw the line at them being removed @gergo85   (@w20k @bennothommo FYI)",php,0,1,1
"@@ -89,9 +89,7 @@ class ScalarTypeComparator
         }
 
         if ($container_type_part instanceof TNonspecificLiteralString
-            && ($input_type_part instanceof TLiteralString
-                || $input_type_part instanceof TNonspecificLiteralString
-                || $input_type_part instanceof TNonEmptyNonspecificLiteralString)
+            && ($input_type_part instanceof TLiteralString || $input_type_part instanceof TNonspecificLiteralString)
         ) {
             return true;
         }",TNonEmptyNonspecificLiteralString is a child of TNonspecificLiteralString just above,php,1,0,1
"@@ -115,7 +115,7 @@ abstract class BaseMediaAdmin extends AbstractAdmin
                     );
                 } else {
                     $media->setProviderName(
-                        $this->getRequest()->get($uniqid['providerName'])
+                        $this->getRequest()->get($uniqid)['providerName']
                     );
                 }
             } else {","Function array dereferencing does not work on old versions of php, you will have to change that (that's why the build fails)",php,1,1,1
"@@ -50,6 +50,11 @@ class CheckPermission extends BaseInstall
         'upload_max_filesize' => 2097152
     );
 
+    protected $phpExpectedVerions = array(
+        'min' => '5.5',
+        'max' => '7.4'
+    );
+
     protected $extensions = array(
         'curl',
         'fileinfo',","Maybe putting 7.3 here, and checking max version with > instead of >= would be more clear to the reader",php,1,1,1
"@@ -65,4 +65,14 @@ class Search2recordController extends AbstractRecord
         return isset($config->Record->next_prev_navigation)
             && $config->Record->next_prev_navigation;
     }
+
+    /**
+     * Get the Hierarchy Type (false if none)
+     *
+     * @return string|bool
+     */
+    public function getHierarchyType()
+    {
+        return 'Search2';
+    }
 }",Does this method do anything? I'm not seeing any getHierarchyType method used/defined in the core code's controllers -- this seems to be a record driver mechanism.,php,1,1,1
"@@ -23,4 +23,9 @@ interface AccountQueryInterface
      * @return UserId[]
      */
     public function findUserIdByRoleId(RoleId $roleId): array;
+
+    /**
+     * @return array
+     */
+    public function getUsers(): array;
 }",This brings nothing to the table. Can you specify a type perhaps?,php,1,1,1
"@@ -193,7 +193,7 @@ int FILE_INFO::verify_file(
     //
     if (download_gzipped && !boinc_file_exists(pathname)) {
         char gzpath[MAXPATHLEN];
-        snprintf(gzpath, sizeof(gzpath), ""%s.gz"", pathname);
+        snprintf(gzpath, sizeof(gzpath), ""%.2048s.gz"", pathname);
         if (boinc_file_exists(gzpath) ) {
             if (allow_async && nbytes > ASYNC_FILE_THRESHOLD) {
                 ASYNC_VERIFY* avp = new ASYNC_VERIFY;","`pathname` is 4096 symbols long. `gzpath` too. Maybe it worth to change this: `""%.2048s.gz"", pathname` to this: `""%.*s.gz"", sizeof(gzpath)-3, pathname` ?",php,1,1,1
"@@ -121,16 +121,16 @@ class ImageRepository
     }
 
     /**
-     * @param array $entities
+     * @param array $entitiesOrEntityIds
      * @param string $entityName
      * @return \Shopsys\FrameworkBundle\Component\Image\Image[]
      */
-    public function getMainImagesByEntitiesIndexedByEntityId(array $entities, $entityName)
+    public function getMainImagesByEntitiesIndexedByEntityId(array $entitiesOrEntityIds, $entityName)
     {
         $queryBuilder = $this->getImageRepository()
             ->createQueryBuilder('i')
             ->andWhere('i.entityName = :entityName')->setParameter('entityName', $entityName)
-            ->andWhere('i.entityId IN (:entities)')->setParameter('entities', $entities)
+            ->andWhere('i.entityId IN (:entities)')->setParameter('entities', $entitiesOrEntityIds)
             ->addOrderBy('i.position', 'desc')
             ->addOrderBy('i.id', 'desc');
 ",Please extract this change to a refactoring commit,php,0,1,1
"@@ -985,10 +985,14 @@ class MediaManager extends WidgetBase
 
             $path = Input::get('path');
             $path = MediaLibrary::validatePath($path);
-
+            
+            $realpath = empty(trim($uploadedFile->getRealPath())) 
+                            ? $uploadedFile->getPath().DIRECTORY_SEPARATOR.$uploadedFile->getFileName() 
+                            : $uploadedFile->getRealPath()
+                        ;
             MediaLibrary::instance()->put(
                 $path.'/'.$fileName,
-                File::get($uploadedFile->getRealPath())
+                File::get($realpath))
             );
 
             die('success');",You have an extra `)` in `File::get($realpath))`. Please remove it.,php,1,1,1
"@@ -0,0 +1,5 @@
+<?php
+
+if (file_exists(__DIR__.'/../var/cache/dev/Bolt_KernelDevDebugContainer.preload.php')) {
+    require __DIR__.'/../var/cache/dev/Bolt_KernelDevDebugContainer.preload.php';
+}","This file is not needed. I don't know where it came from, but I occasionally see it popping up on my end as well. Regardless, we can remove it here.",php,1,1,1
"@@ -124,6 +124,12 @@ class ContentTypesParser extends BaseParser
             $contentType['singleton'] = false;
         }
 
+        if ($contentType['singleton']) {
+            $contentType['listing_records'] = 1;
+        } elseif (isset($contentType['listing_records']) === false) {
+            $contentType['listing_records'] = 6;
+        }
+
         if (! isset($contentType['locales'])) {
             $contentType['locales'] = [];
         } elseif (is_string($contentType['locales'])) {",shouldn't it default to what is set in main config?,php,1,1,1
"@@ -10273,7 +10273,7 @@ return [
 'preg_filter' => ['null|string|string[]', 'pattern'=>'mixed', 'replacement'=>'mixed', 'subject'=>'mixed', 'limit='=>'int', '&w_count='=>'int'],
 'preg_grep' => ['array|false', 'pattern'=>'string', 'array'=>'array', 'flags='=>'int'],
 'preg_last_error' => ['int'],
-'preg_match' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_matches='=>'string[]', 'flags='=>'0|', 'offset='=>'int'],
+'preg_match' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_matches='=>'string[]', 'flags='=>'0', 'offset='=>'int'],
 'preg_match\'1' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_matches='=>'array', 'flags='=>'int', 'offset='=>'int'],
 'preg_match_all' => ['int|false', 'pattern'=>'string', 'subject'=>'string', '&w_matches='=>'array', 'flags='=>'int', 'offset='=>'int'],
 'preg_quote' => ['string', 'str'=>'string', 'delimiter='=>'string'],",Why flags are 0 here?,php,1,1,1
"@@ -205,6 +205,7 @@ class SonataMediaExtension extends Extension
             'targetEntity'  => $config['class']['gallery_has_media'],
             'cascade'       => array(
                 'persist',
+                'remove'
             ),
             'mappedBy'      => 'media',
             'orphanRemoval' => false,","that means that all media in a gallery are deleted when the gallery is deleted. is that the intention, can media only be in one single gallery? this affects all doctrine flavors, right? does it make sense for orm and mongo too?",php,1,1,1
"@@ -55,6 +55,7 @@ final class ThumbnailCompilerPassTest extends TestCase
 
 final class TestUncallableAddResizerMethod
 {
+    // @phpstan-ignore-next-line
     private function addResizer(): void
     {
     }",Can you explain why ?,php,1,0,1
"@@ -3,7 +3,6 @@
 namespace Shopsys\FrameworkBundle\Controller\Admin;
 
 use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
-use Shopsys\FrameworkBundle\Component\Controller\AdminBaseController;
 use Shopsys\FrameworkBundle\Model\Mail\MailTemplateFacade;
 use Shopsys\FrameworkBundle\Model\Statistics\StatisticsFacade;
 use Shopsys\FrameworkBundle\Model\Statistics\StatisticsProcessingFacade;","the blank line should not be here. Also, there is a typo in commit message - ""jut"" instead of ""just""",php,1,1,1
"@@ -86,10 +86,10 @@ class OrderItemFacade
         $product = $this->productRepository->getById($productId);
         $orderDomainConfig = $this->domain->getDomainConfigById($order->getDomainId());
 
-        $productPrice = $this->productPriceCalculationForUser->calculatePriceForUserAndDomainId(
+        $productPrice = $this->productPriceCalculationForUser->calculatePriceForCustomerUserAndDomainId(
             $product,
             $order->getDomainId(),
-            $order->getCustomer()
+            $order->getCustomerUser()
         );
 
         $orderProduct = $this->orderItemFactory->createProduct(",Maybe `ProductPriceCalculationForUser` should be also renamed to `productPriceCalculationForCustomerUser`,php,1,1,1
"@@ -34,6 +34,17 @@ class Configuration implements ConfigurationInterface
             ->children()
                 ->scalarNode('db_driver')->isRequired()->end()
                 ->scalarNode('default_context')->isRequired()->end()
+                ->arrayNode('admin_format')
+                    ->info('Configures the thumbnail preview for the admin')
+                    ->addDefaultsIfNotSet()
+                    ->children()
+                        ->scalarNode('width')->defaultValue(200)->end()
+                        ->scalarNode('height')->defaultValue(false)->end()
+                        ->scalarNode('quality')->defaultValue(90)->end()
+                        ->scalarNode('format')->defaultValue('jpg')->end()
+                        ->scalarNode('constraint')->defaultValue(true)->end()
+                    ->end()
+                ->end()
             ->end()
         ;
 ",maybe `->info()` would be great for what this is used,php,1,1,1
"@@ -109,8 +109,12 @@ class ArrayAnalyzer
         }
 
         if ($array_creation_info->all_list) {
-            $array_type = new Type\Atomic\TNonEmptyList($item_value_type ?: Type::getMixed());
-            $array_type->count = count($stmt->items);
+            if (empty($array_creation_info->item_key_atomic_types)) {
+                $array_type = new Type\Atomic\TList($item_value_type ?: Type::getMixed());
+            } else {
+                $array_type = new Type\Atomic\TNonEmptyList($item_value_type ?: Type::getMixed());
+                $array_type->count = count($array_creation_info->property_types);
+            }
 
             $stmt_type = new Type\Union([
                 $array_type,","Not sure if this is correct, but I'm also not sure what would be correct. `count($stmt->items)` is clearly wrong with unpacked arrays. Should `count` be renamed to `min_count` as well?",php,1,1,1
"@@ -848,9 +848,9 @@ return [
 'closelog' => ['bool'],
 'Closure::bind' => ['Closure', 'old'=>'Closure', 'to'=>'object|null', 'scope='=>'object|string'],
 'Closure::bindTo' => ['Closure', 'new'=>'object|null', 'newscope='=>'object|string'],
-'Closure::call' => ['Closure', 'to'=>'object', 'parameter='=>'', '...='=>''],
+'Closure::call' => ['mixed', 'to'=>'object', 'parameter='=>'mixed', '...='=>'mixed'],
 'Closure::__construct' => [''],
-'Closure::__invoke' => ['', '...=' => ''],
+'Closure::__invoke' => ['mixed', '...=' => 'mixed'],
 'Closure::fromCallable' => ['Closure', 'callable'=>'callable'],
 'Collator::asort' => ['bool', 'arr'=>'array', 'sort_flag='=>'int'],
 'collator_asort' => ['bool', 'coll='=>'collator', 'arr'=>'array', 'sort_flag='=>'int'],","for brevity, `''` means `mixed`, so you can remove the *other* changes here",php,1,1,1
"@@ -102,18 +102,9 @@ return [
 
             return $contents;
         },
-        function ($filePath, $prefix, $contents) {
-            $ret = str_replace(
-                $prefix . '\Psalm\Plugin\\',
-                'Psalm\Plugin\\',
-                $contents
-            );
-            return $ret;
-        },
     ],
     'whitelist' => [
         \Composer\Autoload\ClassLoader::class,
-        'Psalm\Plugin\*',
     ],
     'files-whitelist' => [
         'src/Psalm/Internal/PropertyMap.php',",Wouldn't these changes cause problems running plugins with phar-packaged Psalm?,php,1,1,1
"@@ -23,8 +23,13 @@
 
 namespace Thelia\Model;
 
+use Propel\Runtime\Propel;
 use Thelia\Model\Base\Coupon as BaseCoupon;
+use Thelia\Model\Base\CouponCountryQuery;
+use Thelia\Model\Base\CouponModuleQuery;
 use Thelia\Model\Exception\InvalidArgumentException;
+use Thelia\Model\Map\CouponTableMap;
+use Thelia\Model\Tools\ModelEventDispatcherTrait;
 
 /**
  * Used to provide an effect (mostly a discount)",Base model is imported here.,php,1,0,1
"@@ -66,7 +66,7 @@ class UserDataFixture extends AbstractReferenceFixture implements DependentFixtu
         $customersData = $this->loaderService->getCustomersDataByDomainId(Domain::FIRST_DOMAIN_ID);
 
         foreach ($customersData as $customerData) {
-            $customerData->userData->createdAt = $this->faker->dateTimeBetween('-1 week', 'now');
+            $customerData->userData->createdAt = $this->faker->dateTimeBetween('-2 week', 'now');
 
             $customer = $this->customerFacade->create($customerData);
 ",so you would need to regenerate demodata regularly to have the same statistics.....,php,1,0,1
"@@ -66,6 +66,13 @@ abstract class Results
      */
     protected $startRecordOverride = null;
 
+    /**
+     * Offset override (only for use in very rare cases)
+     *
+     * @var string
+     */
+    protected $startRecordOffset = null;
+
     /**
      * Array of results (represented as Record Driver objects) retrieved on latest
      * search","I find this all a bit confusing; I wonder if it would be better to implement this entirely within the Solr/Results.php, and just go ahead and call it CursorMark. We can refactor it to something more generic in future if we find a common use case... but I think it might be premature to try to find a generic approach to something this specific in function.",php,1,1,1
"@@ -136,6 +136,17 @@ class User extends UserBase
     public function afterLogin()
     {
         parent::afterLogin();
+        /**
+         * @event backend.user.login
+         * Provides an opportunity to interact with the Backend User model after the user has logged in
+         *
+         * Example usage:
+         *
+         *     Event::listen('backend.user.login', function ((\Backend\Models\User) $user) {
+         *         Flash::success(sprintf('Welcome %s!', $user->getFullNameAttribute()));
+         *     });
+         *
+         */
         Event::fire('backend.user.login', [$this]);
     }
 ",extra line of whitespace before the start of the docblock please,php,1,1,1
"@@ -47,6 +47,15 @@ collect([
  * Render page using Blade
  */
 add_filter('template_include', function ($template) {
+    collect(['get_header', 'wp_head'])->each(function ($tag) {
+        ob_start();
+        do_action($tag);
+        $c = ob_get_clean();
+        remove_all_actions($tag);
+        add_action($tag, function () use ($c) {
+            echo $c;
+        });
+    });
     $data = collect(get_body_class())->reduce(function ($data, $class) use ($template) {
         return apply_filters(""sage/template/{$class}/data"", $data, $template);
     }, []);","Can we use a variable a little bit better than ""`$c`""?",php,1,1,1
"@@ -295,13 +295,14 @@ class NonDivArithmeticOpAnalyzer
             && $right_type_part instanceof TLiteralInt
             && ($left instanceof PhpParser\Node\Scalar
                 || $left instanceof PhpParser\Node\Expr\ConstFetch
-                || $left instanceof PhpParser\Node\Expr\ClassConstFetch)
+                || $left instanceof PhpParser\Node\Expr\ClassConstFetch
+                || $left instanceof PhpParser\Node\Expr\BinaryOp)
             && ($right instanceof PhpParser\Node\Scalar
                 || $right instanceof PhpParser\Node\Expr\ConstFetch
-                || $right instanceof PhpParser\Node\Expr\ClassConstFetch)
+                || $right instanceof PhpParser\Node\Expr\ClassConstFetch
+                || $right instanceof PhpParser\Node\Expr\BinaryOp)
         ) {
             // time for some arithmetic!
-
             $calculated_type = null;
 
             if ($parent instanceof PhpParser\Node\Expr\BinaryOp\Plus) {","Shouldn't this be any expression really? E.g. `(true ? 1 : 2) | 22` would not have `$left` as binary op, but it still can be calculated, I suppose.",php,1,1,1
"@@ -251,11 +251,11 @@ const ConfigInstructions = `
 # These values specify the destination directory for ddev ssh and the
 # directory in which commands passed into ddev exec are run.
 
-# omit_containers: [""dba"", ""ddev-ssh-agent""]
-# would omit the dba (phpMyAdmin) and ddev-ssh-agent containers. Currently
-# only those two containers can be omitted here.
-# Note that these containers can also be omitted globally in the
-# ~/.ddev/global_config.yaml or with the ""ddev config global"" command.
+# omit_containers: [""db"", dba"", ""ddev-ssh-agent""]
+# Currently only these containers are supported. Some containers can also be
+# omitted globally in the ~/.ddev/global_config.yaml. Note that if you omit
+# the ""db"" container, several standard features of ddev that access the
+# database container will be unusuable.
 
 # nfs_mount_enabled: false
 # Great performance improvement but requires host configuration first.","Sorry, typo s/unusuable/unusable/",php,1,1,1
"@@ -114,8 +114,9 @@ abstract class BaseMediaAdmin extends AbstractAdmin
                         $this->getRequest()->get(sprintf('%s[providerName]', $uniqid), null, true)
                     );
                 } else {
+                    $provider = $this->getRequest()->get($uniqid);
                     $media->setProviderName(
-                        $this->getRequest()->get($uniqid['providerName'])
+                        $provider['providerName']
                     );
                 }
             } else {",Now it can be single line.,php,1,1,1
"@@ -74,8 +74,8 @@ class ExtensionConfigurationTest extends UnitTest
             ['useConfigurationMonitorTables' => 'pages, tt_content']
         );
         $expectedResult = [
-            'pages' => true,
-            'tt_content' => true
+            'pages' => 0,
+            'tt_content' => 1
         ];
         $this->assertEquals($expectedResult, $configurationUseConfigurationTrackRecordsOutsideSiteroot->getIsUseConfigurationMonitorTables());
     }",Is this really a wanted change? Becuase pages should also be 1 from my thinking and also we change the values from boolean to int?,php,1,1,1
"@@ -0,0 +1,16 @@
+<?php
+
+declare(strict_types=1);
+
+namespace Bolt\Widget;
+
+use Psr\SimpleCache\CacheInterface;
+
+/**
+ * Interface CacheAware - Widgets that make use of caching need to implement
+ * this interface, in order to have their contents cached.
+ */
+interface CacheAware extends WidgetInterface
+{
+    public function setCacheInterface(CacheInterface $config): void;
+}",setCache* or setCacheAdapter*,php,1,0,0
"@@ -14,6 +14,7 @@ class TArray extends \Psalm\Type\Atomic
 
     /**
      * @var array{\Psalm\Type\Union, \Psalm\Type\Union}
+     * @psalm-suppress NonInvariantPropertyType
      */
     public $type_params;
 ",Maybe this and similar properties can be deleted from the code and we can just use the properties declared in the parent classes?,php,1,1,1
"@@ -1470,7 +1470,7 @@ function neve_is_new_builder() {
  * @since 3.0.0
  */
 function neve_is_new_skin() {
-	return get_theme_mod( 'neve_new_skin', false ) === 'new';
+	return get_theme_mod( 'neve_new_skin', 'new' ) === 'new';
 }
 
 /**",@abaicus I think here we should check if neve_new_skin != 'old' since we are setting explicitly the legacy flag,php,0,1,1
"@@ -67,17 +67,7 @@ class ControllerListener
             return;
         }
 
-        $customController = $entity['controller'];
-        $controllerMethod = $currentController[1];
-
-        // build the full controller name depending on its type
-        if (class_exists($customController)) {
-            // 'class::method' syntax for normal controllers
-            $customController .= '::'.$controllerMethod;
-        } else {
-            // 'service:method' syntax for controllers as services
-            $customController .= ':'.$controllerMethod;
-        }
+        $customController = $entity['controller'].'::'.$currentController[1];
 
         $request->attributes->set('_controller', $customController);
         $newController = $this->resolver->getController($request);",This must probably still take into account the installed version of the HttpKernel component. IIRC EasyAdminBundle is compatible with older versions that don't allow the syntax with two colons for controller services.,php,1,1,1
"@@ -73,6 +73,8 @@ class EasyAdminExtension extends AbstractTypeExtension
      * To be replaced by the usage of the request stack when 2.3 support is dropped.
      *
      * @param Request|null $request
+     *
+     * @return null
      */
     public function setRequest(Request $request = null)
     {","Maybe this one can be ignored, gives no value.",php,1,1,1
"@@ -227,7 +227,7 @@ function roots_nice_search_redirect() {
 
   $search_base = $wp_rewrite->search_base;
   if (is_search() && !is_admin() && strpos($_SERVER['REQUEST_URI'], ""/{$search_base}/"") === false) {
-    wp_redirect(home_url(""/{$search_base}/"" . urlencode(get_query_var('s'))));
+	  wp_redirect(esc_url_raw(home_url(""/{$search_base}/"" . get_query_var('s'))));
     exit();
   }
 }","woops? (spacing) just remembered this file is in soil now, anyway. could you submit a PR over there for this one?",php,1,1,1
"@@ -401,7 +401,10 @@ class FileProvider extends BaseProvider
             $media->setProviderReference($this->generateReferenceName($media));
         }
 
-        if ($media->getBinaryContent() instanceof File) {
+        if ($media->getBinaryContent() instanceof UploadedFile) {
+            $media->setContentType($media->getBinaryContent()->getClientMimeType());
+            $media->setSize($media->getBinaryContent()->getSize());
+        } elseif ($media->getBinaryContent() instanceof File) {
             $media->setContentType($media->getBinaryContent()->getMimeType());
             $media->setSize($media->getBinaryContent()->getSize());
         }",Can the client mimetype be null?,php,1,1,1
"@@ -669,6 +669,12 @@ func TestDdevXdebugEnabled(t *testing.T) {
 	runTime := util.TimeTrack(time.Now(), fmt.Sprintf(""%s %s"", site.Name, t.Name()))
 
 	phpVersions := nodeps.ValidPHPVersions
+
+	// arm64 builds from deb.sury.org do not have xdebug in php5.6
+	if runtime.GOARCH == ""arm64"" {
+		t.Log(""Skipping php5.6 test on arm64 because deb.sury.org packages do not include it currently"")
+		delete(phpVersions, ""5.6"")
+	}
 	phpKeys := make([]string, 0, len(phpVersions))
 	for k := range phpVersions {
 		phpKeys = append(phpKeys, k)","Silly me. This shouldn't be done in the tests, but instead in the actual definition of ValidPHPVersions on arm64. Same with Mysql and MariaDB.",php,0,1,1
"@@ -14,8 +14,10 @@ var (
 	DdevBin      = ""ddev""
 	DevTestSites = []testcommon.TestSite{
 		{
-			Name:        ""drupal8"",
-			DownloadURL: ""https://github.com/drud/drupal8/archive/v0.2.2.tar.gz"",
+			Name:      ""drupal8"",
+			SourceURL: ""https://github.com/drud/drupal8/archive/v0.2.2.tar.gz"",
+			FileURL:   ""https://github.com/drud/drupal8/releases/download/v0.2.2/files.tar.gz"",
+			DBURL:     ""https://github.com/drud/drupal8/releases/download/v0.2.2/db.tar.gz"",
 		},
 	}
 )",This is currently a db.tar.gz with just one .sql file in it. It might be worth another test (or maybe I'll find one) that has more than one sql file in it.,php,1,1,1
"@@ -210,10 +210,18 @@ class FileProvider extends BaseProvider implements FileProviderInterface
 
     public function generatePrivateUrl(MediaInterface $media, $format)
     {
-        if (MediaProviderInterface::FORMAT_REFERENCE === $format) {
+        if (self::FORMAT_REFERENCE === $format) {
             return $this->getReferenceImage($media);
         }
 
+        // throw new \InvalidArgumentException(sprintf(
+        //     'Argument 2 passed to ""%s()"" only accepts the value ""%s"", ""%s"" given.',
+        //     __METHOD__,
+        //     self::FORMAT_REFERENCE,
+        //     $format
+        // ));
+        // NEXT_MAJOR: Uncomment the previous exception and remove the `return false` statement.
+
         return false;
     }
 ",Should we trigger a deprecation then ?,php,1,1,1
"@@ -132,7 +132,8 @@ if (TYPO3_MODE == 'BE') {
         'solr::clearSolrConnectionCache',
         'ApacheSolrForTypo3\\Solr\\ConnectionManager->updateConnections'
     );
-
+}
+if ((TYPO3_MODE == 'BE') || ((TYPO3_MODE == 'FE') && isset($_POST['TSFE_EDIT']))) {
     // the order of registering the garbage collector and the record monitor is important!
     // for certain scenarios items must be removed by GC first, and then be re-added to to Index Queue
 ",Can you make two changes here: 1) You don't need the braces around `TYPO3_MODE == 'FE'` 2) Please use triple equal signs for comparison `===`,php,1,1,1
"@@ -26,7 +26,7 @@ return [
         'se' => 'Swedish',
         'sk' => 'Slovak (Slovakia)',
         'tr' => 'Turkish',
-        'zh-cn' => 'Chinese (China)',
+        'zh-cn' => '简体中文',
         'el' => 'Greek'
     ],
     'directory' => [","This should be the word ""Chinese"" in English",php,1,1,1
"@@ -42,6 +42,16 @@ class ExportGridBuilder implements GridBuilderInterface
                         'export' => '{id}',
                     ],
                 ],
+                'download' => [
+                    'privilege' => 'CHANNEL_READ',
+                    'show' => ['system' => false],
+                    'route' => 'ergonode_channel_export_download',
+                    'parameters' => [
+                        'language' => $language->getCode(),
+                        'channel' => '{channel_id}',
+                        'export' => '{id}',
+                    ],
+                ],
             ]))
             ->orderBy('started_at', 'DESC');
 ",This will add this action to every export and not every export will have file to download..,php,1,1,1
"@@ -66,8 +66,14 @@ class AdminController extends Controller
             return $forbiddenActionResponse;
         }
 
+        $entity = $request->query->get('entity');
+        if (isset($this->entity['role']) &&
+            !$this->get('security.context')->isGranted($this->entity['role'])) {
+                throw $this->createAccessDeniedException();
+        }
+
         // for now, the homepage redirects to the 'list' action and view of the first entity
-        if (null === $request->query->get('entity')) {
+        if (null === $entity) {
             return $this->redirect($this->generateUrl('admin', array(
                 'action' => $action,
                 'entity' => $this->getNameOfTheFirstConfiguredEntity(),","This would need a bridge/alternative to fit to SF2.7+, because the `security.context` is going to disappear",php,1,1,1
"@@ -15,7 +15,8 @@ namespace Sonata\MediaBundle\Security;
 
 use Sonata\MediaBundle\Model\MediaInterface;
 use Symfony\Component\HttpFoundation\Request;
-use Symfony\Component\Translation\TranslatorInterface;
+use Symfony\Component\Translation\TranslatorInterface as LegacyTranslatorInterface;
+use Symfony\Contracts\Translation\TranslatorInterface;
 
 /**
  * @final since sonata-project/media-bundle 3.21.0","We usually use references to the argument number instead its name. Additionally, we use the term ""argument"" instead of ""parameter"".",php,1,1,1
"@@ -17,7 +17,9 @@
 
 from abc import ABCMeta, abstractmethod
 import os
+from typing import Optional
 from selenium.webdriver.common.utils import keys_to_typing
+from selenium.types import AnyKey
 
 
 class FileDetector(metaclass=ABCMeta):","just realised... This breaks things since there is not selenium types module, is there a PR for this?",py,0,1,1
"@@ -3,10 +3,15 @@
 
 import collections
 import functools
+from typing import TYPE_CHECKING, Dict, List, Union
 
 from pylint import reporters
 from pylint.lint.utils import _patch_sys_path
 from pylint.message import Message
+from pylint.typing import CheckerStats
+
+if TYPE_CHECKING:
+    from typing import Counter  # typing.Counter added in Python 3.6.1
 
 try:
     import multiprocessing","This could also be a `sys.version_info` guard with import from `typing_extensions`. In that case the quotes around `Counter` wouldn't be necessary. Leave that up to you, if you what to change it. Support for `3.6` will end soon anyway, so might not be that important.",py,1,1,1
"@@ -82,6 +82,9 @@ class KMSScannerTest(unittest_utils.ForsetiTestCase):
 
             crypto_key.data = fake_kms_scanner_data.NON_ROTATED_CRYPTO_KEY_DATA
 
+            crypto_key.data = (
+                fake_kms_scanner_data.NON_ROTATED_CRYPTO_KEY_STATE_DATA)
+
             session.commit()
 
     def setUp(self):",why do we set the crypto_key.data twice? (here and two lines above),py,1,1,1
"@@ -360,6 +360,10 @@ DATA = collections.OrderedDict([
          SettingValue(typ.Bool(), 'false'),
          ""Hide the tabbar if only one tab is open.""),
 
+        ('perm-hide',
+         SettingValue(typ.Bool(), 'false'),
+         ""Hide permanently.""),
+
         ('wrap',
          SettingValue(typ.Bool(), 'true'),
          ""Whether to wrap when changing tabs.""),","I think `perm-` is a bit confusing. I'd prefer `always-hide`. Alternatively, renaming `auto-hide` to `hide-auto` and `perm-hide` to `hide-always` would sort them correctly. What's your opinion on this?",py,1,1,1
"@@ -30,6 +30,11 @@ try:
 except ImportError:
     something = None
 
+try:
+    from collections import something
+except ModuleNotFoundError:
+    something = None
+
 try:
     from collections import anything # [no-name-in-module]
 except ValueError:",Could you recheck some of these tests? Some are non-sensical (such as this one) in that they never occur in actual runtime `python`. Since `collections` can be found this will/should never raise a `ModuleNotFoundError` and only raise a `ImportError`. I think we shouldn't bloat our tests with unfeasible examples.,py,1,1,1
"@@ -1062,11 +1062,13 @@ class DynamicMap(HoloMap):
         self[key] = val
 
 
-    def map(self, map_fn, specs=None, clone=True):
+    def map(self, map_fn, specs=None, clone=True, link_inputs=True):
         """"""
         Recursively replaces elements using a map function when the
         specification applies. Extends regular map with functionality
-        to dynamically apply functions.
+        to dynamically apply functions. By default all streams are
+        still linked to the mapped object, to disable linked streams
+        set linked_inputs=False.
         """"""
         deep_mapped = super(DynamicMap, self).map(map_fn, specs, clone)
         if isinstance(deep_mapped, type(self)):",Seems useful though I just want to check this feature is unrelated to the rest of the PR...,py,0,0,0
"@@ -443,7 +443,9 @@ class SparkFrameMethods(object):
         """"""
         from databricks.koalas.frame import CachedDataFrame
 
-        self._kdf._internal = self._kdf._internal.resolved_copy
+        self._kdf._update_internal_frame(
+            self._kdf._internal.resolved_copy, requires_same_anchor=False
+        )
         return CachedDataFrame(self._kdf._internal)
 
     def persist(self, storage_level=StorageLevel.MEMORY_AND_DISK):",When do we need to set `requires_same_anchor=False`?,py,1,1,1
"@@ -119,6 +119,7 @@ install_requires = [
     ""invenio-documents>=0.1.0.post2"",
     ""invenio-upgrader>=0.1.0"",
     ""invenio-unapi>=0.1.0"",
+    ""invenio-jsonschemas>=0.0.0"",
     ""itsdangerous>=0.24"",
     ""jellyfish>=0.3.2"",
     ""Jinja2>=2.7"",",it's not required dependency,py,1,0,1
"@@ -0,0 +1,15 @@
+# Licensed under the GPL: https://www.gnu.org/licenses/old-licenses/gpl-2.0.html
+# For details: https://github.com/PyCQA/pylint/blob/main/LICENSE
+
+import sys
+
+from pylint.reporters import BaseReporter
+
+
+def test_deprecation_set_output(recwarn):
+    """"""TODO remove in 3.0""""""  # pylint: disable=fixme
+    reporter = BaseReporter()
+    reporter.set_output(sys.stdout)
+    warning = recwarn.pop()
+    assert ""set_output' will be removed in 3.0"" in str(warning)
+    assert reporter.out == sys.stdout",Is this file at the right place? I would have expected this test in ``tests/unittest_reporting.py``.,py,1,1,1
"@@ -45,6 +45,7 @@ import sys
 import time
 
 import pkg_resources
+from prometheus_client import CONTENT_TYPE_LATEST
 import tornado.httpserver
 import tornado.ioloop
 import tornado.netutil","This breaks because we are missing `prometheus_client` as a dependency in `setup.py`. So instead of pulling the dependency, we can hardcode the string.",py,1,1,1
"@@ -8,14 +8,14 @@
 Bluetooth layers, sockets and send/receive functions.
 """"""
 
+import ctypes
 import socket
 import struct
 import array
-from ctypes import *
 from select import select
 
 from scapy.config import conf
-from scapy.data import DLT_BLUETOOTH_HCI_H4
+from scapy.data import DLT_BLUETOOTH_HCI_H4, DLT_BLUETOOTH_HCI_H4_WITH_PHDR
 from scapy.packet import *
 from scapy.fields import *
 from scapy.supersocket import SuperSocket","This is some cleanup: previously importing scapy ==> import all types from ctypes, because of its usage in bluetooth.py",py,1,1,1
"@@ -471,6 +471,9 @@ class RemoteConnection(object):
             request.add_header('Accept', 'application/json')
             request.add_header('Content-Type', 'application/json;charset=UTF-8')
 
+            base64string = base64.b64encode('%s:%s' % (parsed_url.username, parsed_url.password))
+            request.add_header(""Authorization"", ""Basic %s"" % base64string)
+
             if password_manager:
                 opener = url_request.build_opener(url_request.HTTPRedirectHandler(),
                                                   HttpErrorHandler(),","This will always add the authorization header to the request object. Is this the right scope for these two lines? If username/password are not defined, it will encode 'Basic :'",py,1,1,1
"@@ -390,6 +390,8 @@ class Similar:
 
     def run(self) -> None:
         """"""start looking for similarities and display results on stdout""""""
+        if self.min_lines == 0:
+            sys.exit(0)
         self._display_sims(self._compute_sims())
 
     def _compute_sims(self) -> List[Tuple[int, Set[LinesChunkLimits_T]]]:","Here, it won't work! Use `return` instead.",py,1,1,0
"@@ -170,7 +170,11 @@ class UIATextRangeAttributeValueFetcher(object):
 		self.textRange=textRange
 
 	def getValue(self,ID,ignoreMixedValues=False):
-		val=self.textRange.getAttributeValue(ID)
+		try:
+			val=self.textRange.getAttributeValue(ID)
+		except COMError:
+			# #7124: some text attributes are not supported in  older Operating Systems 
+			return UIAHandler.handler.reservedNotSupportedValue
 		if not ignoreMixedValues and val==UIAHandler.handler.ReservedMixedAttributeValue:
 			raise UIAMixedAttributeError
 		return val","Is this something that would be helpful to log? Would that cause a lot of noise in the log? I'm considering a case where we are investigating why something does not work in a particular OS for instance. What happens when `reservedNotSupportedValue` is returned, is this handled gracefully in all cases?",py,1,1,1
"@@ -421,11 +421,10 @@ class NVDAObject(documentBase.TextContainerObject, baseObject.ScriptableObject,
 	#: Type definition for auto prop '_get_role'
 	role: int
 
-	def _get_role(self) -> int:
+	def _get_role(self) -> controlTypes.Role:
 		""""""The role or type of control this object represents (example: button, list, dialog).
-		@return: a ROLE_* constant from L{controlTypes}
 		""""""  
-		return controlTypes.ROLE_UNKNOWN
+		return controlTypes.Role.UNKNOWN
 
 	def _get_roleText(self):
 		""""""",This is not correct anymore as the type of the role has changed to `controlTypes.Role`,py,1,1,1
"@@ -607,6 +607,10 @@ public class RegistrationRequest {
           + HUB_HOST + "" X -"" + HUB_PORT + "" 5555. The specified config was -"" + HUB_HOST + "" ""
           + hub + "" -"" + HUB_PORT + "" "" + port);
     }
+    
+    if(port==-1){
+    	throw new GridConfigurationException(""No port was specified in -hub parameter. Example - http://""+hub+"":4444/grid/register"");
+    }
   }
 
 ","I think if they _don't_ specify a port, we should assume grid default (which is 4444)",py,1,1,1
"@@ -52,6 +52,8 @@ class ApiritifNoseExecutor(SubprocessedExecutor):
     def __init__(self):
         super(ApiritifNoseExecutor, self).__init__()
         self._tailer = FileReader(file_opener=lambda _: None, parent_logger=self.log)
+        self._iteration_number = None
+        self._iteration_start = None
 
     def reporting_setup(self, prefix=None, suffix=None):
         if not self.reported:",Why store these fields at all? Why not just make iteration listener to receive `iteration_started(time)` and `iteration_ended(time)` so it decides itself what to store and do?,py,1,1,1
"@@ -248,12 +248,12 @@ def snmpwalk(dst, oid=""1"", community=""public""):
     try:
         while True:
             r = sr1(IP(dst=dst)/UDP(sport=RandShort())/SNMP(community=community, PDU=SNMPnext(varbindlist=[SNMPvarbind(oid=oid)])),timeout=2, chainCC=1, verbose=0, retry=2)
-            if ICMP in r:
-                print(repr(r))
-                break
             if r is None:
                 print(""No answers"")
                 break
+            if ICMP in r:
+                print(repr(r))
+                break
             print(""%-40s: %r"" % (r[SNMPvarbind].oid.val,r[SNMPvarbind].value))
             oid = r[SNMPvarbind].oid
             ",How about `r.show()`,py,1,0,1
"@@ -118,6 +118,9 @@ def get_argparser():
                        action='append')
     debug.add_argument('--qt-flag', help=""Pass an argument to Qt as flag."",
                        nargs=1, action='append')
+    debug.add_argument('--debug-flag', type=debug_flag_error,
+                       help=""Pass name of debugging feature to be turned on."",
+                       nargs=1, action='append')
     parser.add_argument('command', nargs='*', help=""Commands to execute on ""
                         ""startup."", metavar=':command')
     # URLs will actually be in command",You'll also need to add a `dest='debug_flags'` here - otherwise you'd need to adjust the checks to do `... in self._args.debug_flag:` which reads a bit odd.,py,1,1,1
"@@ -4,7 +4,6 @@
 #See the file COPYING for more details.
 
 from baseObject import AutoPropertyObject, ScriptableObject
-from scriptHandler import isScriptWaiting
 import config
 import textInfos
 import speech",I think you can do the same with `speech`,py,1,0,1
"@@ -269,6 +269,14 @@ class Stream(param.Parameterized):
         return repr(self)
 
 
+class Next(Stream):
+    """"""
+    Example of an empty stream that can be used to trigger generators or
+    callbacks that take no arguments.
+    """"""
+    pass
+
+
 class Counter(Stream):
     """"""
     Simple stream that automatically increments an integer counter",Not strictly necessary as you could use ``Stream``. Another possible name could be ``Trigger``.,py,1,1,1
"@@ -103,6 +103,10 @@ class ElementOperation(Operation):
        first component is a Normalization.ranges list and the second
        component is Normalization.keys. """""")
 
+    link_inputs = param.Boolean(default=False, doc=""""""
+         Whether a plot created from the output of this operation
+         should be linked to the inputs of this operation."""""")
+
     streams = param.List(default=[], doc=""""""
         List of streams that are applied if dynamic=True, allowing
         for dynamic interaction with the plot."""""")","Needs a *lot* more explanation as almost none of the required concepts exist at this level: 1. An operation doesn't create plots, it generates a data-structure. 2. Specifically, linking is about streams which relates to DynamicMap so this should say something about when the operation is dynamic. 3. Linked streams only exist for specific backends. As a very rough suggestion, it should be something along the lines of: > 'If the operation is dynamic, this switch specifies whether or not linked streams should be defined from the operation inputs. Only applies when rendering the output with backends that support linked streams. For example ... '",py,1,1,0
"@@ -1095,7 +1095,7 @@ class Resource:
                         send_alert(self.request, message, url)
                     operator = COMPARISON.LT
 
-                if value == """":
+                if value == """" or (not isinstance(value, int) and not isinstance(value, str)):
                     raise_invalid(self.request, **error_details)
 
                 filters.append(Filter(self.model.modified_field, value, operator))",`isinstance()` can take a tuple as a second argument,py,1,1,1
"@@ -15,12 +15,12 @@
 """"""Scanner for Enabled APIs.""""""
 
 import json
-import sys
 
 from google.cloud.forseti.common.gcp_type.project import Project
 from google.cloud.forseti.common.util import logger
 from google.cloud.forseti.scanner.audit import enabled_apis_rules_engine
 from google.cloud.forseti.scanner.scanners import base_scanner
+from google.cloud.forseti.common.util import errors as util_errors
 
 LOGGER = logger.get_logger(__name__)
 ",Can you please alpha-sort this import?,py,1,0,1
"@@ -212,3 +212,12 @@ class ExtraPropertiesValidationTest(BaseWebTestWithSchema, unittest.TestCase):
         self.app.patch_json(record_url,
                             {'data': record},
                             headers=self.headers)
+
+    def test_additional_properties_are_rejected(self):
+        record_id = '5443d83f-852a-481a-8e9d-5aa804b05b08'
+        record = VALID_RECORD.copy()
+        record['extra'] = 'blah!'
+        self.app.put_json('%s/%s' % (RECORDS_URL, record_id),
+                          {'data': record},
+                          headers=self.headers,
+                          status=400)",I would also validate that the error message give enough feedback for the user to solve the issue.,py,1,1,1
"@@ -133,7 +133,7 @@ def makePgettext(translations):
 				return message
 	else:
 		def pgettext(context, message):
-			return unicode(message)
+			return message
 	return pgettext
 
 def getWindowsLanguage():","Why do we have this else statement? Shouldn't this fail if translations is not an instance of gettext.GNUTranslations? If not, what else do we expect and how should that be handled?",py,1,1,1
"@@ -470,8 +470,10 @@ class BacktrackingTM(ConsolePrinterMixin, Serializable):
     proto.lrnIterationIdx = self.lrnIterationIdx
     proto.iterationIdx = self.iterationIdx
     proto.segID = self.segID
-    if self.currentOutput is not None:
-      proto.currentOutput = self.currentOutput.tolist()
+    if self.currentOutput is None:
+      proto.currentOutput.none = None
+    else:
+      proto.currentOutput.list = self.currentOutput.tolist()
     proto.pamCounter = self.pamCounter
     proto.collectSequenceStats = self.collectSequenceStats
     proto.resetCalled = self.resetCalled",I don't understand this. Is it a workaround to allow a proto to contain a null value? I see this pattern in several other places.,py,1,1,1
"@@ -304,7 +304,7 @@ public class DefaultGridRegistry extends BaseGridRegistry implements GridRegistr
     if (proxy == null) {
       return;
     }
-    LOG.info(""Registered a node "" + proxy);
+    LOG.finest(""Registered a node "" + proxy);
     try {
       lock.lock();
 ",This is wildly unhelpful to users --- they need to know when a proxy has been registered.,py,1,1,1
"@@ -46,7 +46,7 @@ def open_browser(url: str) -> bool:
     browsers = (
         ""windows-default"", ""macosx"",
         ""wslview %s"",
-        ""x-www-browser %s"", ""gnome-open %s"",
+        ""x-www-browser %s"", ""gnome-open %s"", ""xdg-open"",
         ""google-chrome"", ""chrome"", ""chromium"", ""chromium-browser"",
         ""firefox"", ""opera"", ""safari"",
     )",Is this related to the Docker change? I don't think this even works when mitmproxy is running inside a container...,py,1,1,1
"@@ -0,0 +1,15 @@
+# -*- coding: utf-8 -*-
+
+# Licensed under the GPL: https://www.gnu.org/licenses/old-licenses/gpl-2.0.html
+# For details: https://github.com/PyCQA/pylint/blob/master/COPYING
+
+import textwrap
+
+
+def normalize_text(text, line_len=80, indent=""""):
+    """"""Wrap the text on the given line length.""""""
+    return ""\n"".join(
+        textwrap.wrap(
+            text, width=line_len, initial_indent=indent, subsequent_indent=indent
+        )
+    )","Seems odd to have a module just for this function, is there a way to move it somewhere else?",py,1,1,1
"@@ -140,6 +140,11 @@ def main():
     inspect_p.add_argument(""package"", type=str, help=HANDLE)
     inspect_p.set_defaults(func=command.inspect)
 
+    rm_p = subparsers.add_parser(""rm"")
+    rm_p.add_argument(""package"", type=str, help=HANDLE)
+    rm_p.add_argument(""-f"", ""--force"", action=""store_true"", help=""Remove without prompting"")
+    rm_p.set_defaults(func=command.rm)
+
     args = parser.parse_args()
 
     # Convert argparse.Namespace into dict and clean it up.","Given a single name, are we sure about ""rm"" vs ""uninstall"" which makes it clear that this is local. Sorry for the late question... quilt rm/del/delete is ambiguous whether it applies server-side, client-side or both... also, if you intend to someday add metadata-delete-only, you might want to spec this out now, so the syntax won't be awkward...",py,1,1,0
"@@ -689,8 +689,15 @@ class YOLACTProtonet(BaseModule):
         prototypes = prototypes.permute(0, 2, 3, 1).contiguous()
 
         num_imgs = x.size(0)
-        # Training state
-        if self.training:
+
+        # The reason for not using self.is_training is that
+        # val workflow will have a dimension mismatch error.
+        # Note that this writing method is very tricky.
+        # Fix https://github.com/open-mmlab/mmdetection/issues/5978
+        is_train_or_val_workflow = (coeff_pred[0].dim() == 4)
+
+        # Train or val workflow
+        if is_train_or_val_workflow:
             coeff_pred_list = []
             for coeff_pred_per_level in coeff_pred:
                 coeff_pred_per_level = \",self.is_training or self.training?,py,1,0,1
"@@ -8,8 +8,8 @@ from enum import Enum
 import re
 
 PUBLIC = 'public' # This username is blocked by Quilt signup
-VALID_NAME_RE = re.compile(r'^[a-zA-Z]\w*$')
-EMAILREGEX = re.compile(r'^([^\s@]+)@([^\s@]+)$')
+VALID_NAME_RE = re.compile(r'^[a-zA-Z]\w*$', re.UNICODE)
+VALID_EMAIL_RE = re.compile(r'^([^\s@]+)@([^\s@]+)$')
 
 class PaymentPlan(Enum):
     FREE = 'free'",This shouldn't change - usernames can't actually have non-ascii characters.,py,1,1,1
"@@ -75,6 +75,16 @@ class Resize(object):
 
     @staticmethod
     def random_select(img_scales):
+        """"""Randomly select an img_scale when ``multiscale_mode=='value'``
+
+        Args:
+            img_scales (list[tuple]): Images scales for selection.
+
+        Returns:
+            tuple: Image scale selected.
+            int: The index of selected image scale.
+        """"""
+
         assert mmcv.is_list_of(img_scales, tuple)
         scale_idx = np.random.randint(len(img_scales))
         img_scale = img_scales[scale_idx]",Randomly select an image scale from the given candidates. (There is no restrict that it can only be used with ``multiscale_mode=='value'``),py,1,1,1
"@@ -140,6 +140,10 @@ class DocumentWithTableNavigation(TextContainerObject,ScriptableObject):
 				destCol+=1 if movement==""next"" else -1
 		raise LookupError
 
+	lastTableSelection = None
+	lastTableAxis = None
+	lastTableCoordinate = None
+	lastTableCoordinateSpan = None
 	def _tableMovementScriptHelper(self, movement=""next"", axis=None):
 		if isScriptWaiting():
 			return","Have you considered using four variables here, lastRow, lastRowSpan, lastCol and lastCOlSpan? While it adds two extra variables, I think it makes things a bit easier to follow. Also, please make these private variables, i.e. add add an underscore prefix",py,1,1,1
"@@ -486,6 +486,9 @@ class FirewallRules(object):
           InvalidFirewallRuleError: One or more rules failed validation.
         """"""
         for rule in rules:
+            if not isinstance(rule, dict):
+                raise InvalidFirewallRuleError(
+                    'Invalid rule type. Found %s expected %s', type(rule), dict)
             self.add_rule(rule, network_name=network_name)
 
     def add_rule(self, rule, network_name=None):","I believe the check should be before this for loop, i.e. make sure we are getting a list of rules.",py,1,1,1
"@@ -33,8 +33,8 @@ from nupic.encoders import MultiEncoder
 
 _VERBOSITY = 0  # how chatty the demo should be
 _SEED = 1956  # the random seed used throughout
-_DATA_PATH = ""extra/hotgym/rec-center-hourly.csv""
-_OUTPUT_PATH = ""test_output.csv""
+_DATA_PATH = ""../prediction/data/extra/hotgym/rec-center-hourly.csv""
+_OUTPUT_PATH = ""network-demo-output.csv""
 _NUM_RECORDS = 2000
 
 # Config field for SPRegion","You should not have to do this. Please undo this change. If it doesn't work, you may need to set `NTA_DATA_PATH` but it should default correctly.",py,1,1,1
"@@ -24,7 +24,7 @@
 Some unit tests for the AutoscaleConnection
 """"""
 
-import unittest
+from __future__ import print_function
 import time
 from boto.ec2.autoscale import AutoScaleConnection
 from boto.ec2.autoscale.activity import Activity","`print_function` is not required for `print('some string')` to work since we support Python 2.6+, it is only required for more complex invocations of the print function (like passing keyword args). You can remove this import.",py,1,1,1
"@@ -21,8 +21,11 @@ def main(argv):
         .filter(Instance.keywords_tsv.is_(None))
     )
 
-    for instance, owner, name in rows:
+    for idx, (instance, owner, name) in enumerate(rows):
+        print(""%s/%s/%s"" % (owner, name, instance.hash))
         instance.keywords_tsv = keywords_tsvector(owner, name, instance.contents)
+        if (idx + 1) % 100 == 0:
+            db.session.commit()
 
     db.session.commit()
     print(""Done!"")",extremely minor: if you use `%s/%s:%s` it will be consistent with install syntax. i guess we won't need to install from the logs.,py,1,1,1
"@@ -2,6 +2,12 @@ import urllib
 import netlib.http
 from textwrap import dedent
 
+import sys, re
+if (sys.version_info > (3, 0)):
+    from urllib.parse import urlparse
+else:
+    import urlparse
+
 
 def curl_command(flow):
     data = ""curl """,@mhils started using `six` for py2/3 compatible imports in recent commits to master. Maybe you could try to adopt it here as well?,py,0,1,1
"@@ -8,10 +8,11 @@ from mmdet.core import (anchor_inside_flags, build_anchor_generator,
                         multiclass_nms, unmap)
 from ..builder import HEADS, build_loss
 from .base_dense_head import BaseDenseHead
+from .dense_test_mixins import BBoxTestMixin
 
 
 @HEADS.register_module()
-class AnchorHead(BaseDenseHead):
+class AnchorHead(BaseDenseHead, BBoxTestMixin):
     """"""Anchor-based head (RPN, RetinaNet, SSD, etc.).
 
     Args:","RPNHead has a mixin `RPNTestMixin`, can these two mixins somehow be merged to avoid confusion?",py,1,1,1
"@@ -73,6 +73,17 @@ def init():
     download_manager.install(webenginesettings.private_profile)
     objreg.register('webengine-download-manager', download_manager)
 
+    # Clear visited links on web history clear
+    hist = objreg.get('web-history')
+    hist.history_cleared.connect(
+        webenginesettings.default_profile.clearAllVisitedLinks)
+    hist.history_cleared.connect(
+        webenginesettings.private_profile.clearAllVisitedLinks)
+    hist.url_cleared.connect(
+        lambda url: webenginesettings.default_profile.clearVisitedLinks([url]))
+    hist.url_cleared.connect(
+        lambda url: webenginesettings.private_profile.clearVisitedLinks([url]))
+
 
 # Mapping worlds from usertypes.JsWorld to QWebEngineScript world IDs.
 _JS_WORLD_MAP = {","No strong feelings on this one, but might be worth making it a for-loop maybe? (`for profile in [webenginesettings.default_profile, webenginesettings.private_profile]: ...`)",py,1,1,1
"@@ -62,9 +62,9 @@ class SDRCategoryEncoder(Encoder):
     # enable certain experiments.
     #
     # ""5"" is arbitrary -- this is just to catch bad parameter choices
-    #if self.w >= self.n - 4:
-    #  raise RuntimeError(""Number of bits in SDR (%d) must be much smaller than ""
-    #                     ""the output width (%d)"" % (self.w, self.n))
+    if (self.n/self.w) < 2: # w is 50% of total len
+      raise RuntimeError(""Number of ON bits in SDR (%d) must be much smaller than ""
+                         ""the output width (%d)"" % (self.w, self.n))
 
     # Another arbitrary cutoff to catch likely mistakes
     if self.w < 3:",This check is probably a little more reasonable for category encoders.,py,1,1,1
"@@ -22,6 +22,7 @@ from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
 
 
 class Options(object):
+    KEY = ""goog:chromeOptions""
 
     def __init__(self):
         self._binary_location = ''",nice touch since Google likes to change things every now and then.,py,1,0,0
"@@ -389,11 +389,13 @@ class Configuration(object):
         configVar = os.environ['NTA_CONF_DIR']
         # Return as a list of paths
         configPaths = configVar.split(':')
-      elif os.path.exists(os.path.join(
-          nupic.rootDir, 'conf', 'site', 'default')):
-        configPaths = [os.path.join(nupic.rootDir, 'conf', 'site', 'default')]
-      else:
+      elif (
+          not os.path.exists(os.path.join(
+              nupic.rootDir, 'conf', 'site', 'default')) and
+          os.path.exists(os.path.join(nupic.rootDir, 'conf', 'default'))):
         configPaths = [os.path.join(nupic.rootDir, 'conf', 'default')]
+      else:
+        configPaths = [os.path.join(nupic.rootDir, 'conf', 'site', 'default')]
         
       return configPaths
 ","@scottpurdy : os.path.join(nupic.rootDir, 'conf', 'site', 'default') was the intended location of the site-specific defaults. Why are we allowing for non-determinism in this new logic? The tests used to work fine with the intended location.",py,0,1,1
"@@ -73,12 +73,12 @@ class MPLRendererTest(ComparisonTestCase):
     def test_get_size_row_plot(self):
         plot = self.renderer.get_plot(self.image1+self.image2)
         w, h = self.renderer.get_size(plot)
-        self.assertEqual((w, h), (576, 258))
+        self.assertEqual((w, h), (576, 255))
 
     def test_get_size_column_plot(self):
         plot = self.renderer.get_plot((self.image1+self.image2).cols(1))
         w, h = self.renderer.get_size(plot)
-        self.assertEqual((w, h), (288, 510))
+        self.assertEqual((w, h), (288, 505))
 
     def test_get_size_grid_plot(self):
         grid = GridSpace({(i, j): self.image1 for i in range(3) for j in range(3)})",At least the changes here are small...,py,0,0,1
"@@ -359,7 +359,17 @@ class Interface(param.Parameterized):
         else:
             return data.dtype
 
-
+    @classmethod
+    def replace_value(cls, data, nodata):
+        """"""
+        Replace `nodata` value in data with NaN
+        """"""
+        data = data.astype('float64')
+        mask = data != nodata
+        if hasattr(data, 'where'):
+            return data.where(mask, np.NaN)
+        return np.where(mask, data, np.NaN)
+        
     @classmethod
     def select_mask(cls, dataset, selection):
         """"""",I guess this duplicates `apply_nodata._replace_value` in `plotting.util` a bit but that is probably ok...,py,1,1,1
"@@ -293,10 +293,9 @@ class ScalarEncoder(Encoder):
 
   def _checkReasonableSettings(self):
     """"""(helper function) check if the settings are reasonable for SP to work""""""
-    # checks for likely mistakes in encoder settings
     if self.w < 21:
-      raise ValueError(""Number of bits in the SDR (%d) must be greater than 2, and recommended >= 21 (use forced=True to override)""
-                         % self.w)
+      raise ValueError(""Number of bits in the SDR (%d) must be greater than 21 ""
+        ""and recommended >= 21 (use forced=True to override)."" % self.w)
 
 
   def getDecoderOutputFieldTypes(self):",This statement repeats itself: > Number of bits in the SDR (%d) must be greater than 21 and recommended >= 21 Can you simplify to: > Number of bits in the SDR (%d) must be >= 21,py,1,1,1
"@@ -126,11 +126,14 @@ class ClassBalancedDataset(object):
             no oversampling. For categories with ``f_c < oversample_thr``, the
             degree of oversampling following the square-root inverse frequency
             heuristic above.
+        include_bkg (bool): Whether to include pure background images as an
+            independent category during autobalancing. Default: False.
     """"""
 
-    def __init__(self, dataset, oversample_thr):
+    def __init__(self, dataset, oversample_thr, include_bkg=False):
         self.dataset = dataset
         self.oversample_thr = oversample_thr
+        self.include_bkg = include_bkg
         self.CLASSES = dataset.CLASSES
 
         repeat_factors = self._get_repeat_factors(dataset, oversample_thr)",How about `include_empty` or just `include_background`? `bkg` is a little bit hard to guess.,py,1,1,1
"@@ -181,7 +181,9 @@ class DataFrameConversionTest(ReusedSQLTestCase, SQLTestUtils, TestUtils):
         self.assert_eq(kdf.to_latex(sparsify=False), pdf.to_latex(sparsify=False))
         self.assert_eq(kdf.to_latex(index_names=False), pdf.to_latex(index_names=False))
         self.assert_eq(kdf.to_latex(bold_rows=True), pdf.to_latex(bold_rows=True))
-        self.assert_eq(kdf.to_latex(encoding='ascii'), pdf.to_latex(encoding='ascii'))
+        # TODO: error in pandas >= 1.0.0:
+        # `ValueError: buf is not a file name and encoding is specified.`
+        # self.assert_eq(kdf.to_latex(encoding='ascii'), pdf.to_latex(encoding='ascii'))
         self.assert_eq(kdf.to_latex(decimal=','), pdf.to_latex(decimal=','))
 
     def test_to_records(self):",Can we fix this case to match with pandas 1.0.0?,py,1,0,1
"@@ -43,16 +43,16 @@ def insert_user_stats(user_id, artists, recordings, releases, artist_count):
 
     artist_stats = {
         'count': artist_count,
-        'all_time': artists,
+        'prev_month': artists,
     }
 
     recording_stats = {
-        'all_time': recordings,
+        'prev_month': recordings,
     }
 
 
     release_stats = {
-        'all_time': releases,
+        'prev_month': releases,
     }
 
 ","We should prolly just specify the month here in the key, like `2019-01` so that we know exactly which month the data is for. With prev month, we might have data for different months for different users.",py,1,1,1
"@@ -47,9 +47,10 @@ class RemoteScheduler(Scheduler):
     Scheduler proxy object. Talks to a RemoteSchedulerResponder.
     """"""
 
-    def __init__(self, host='localhost', port=8082, connect_timeout=None):
+    def __init__(self, host='localhost', port=8082, url_prefix='', connect_timeout=None):
         self._host = host
         self._port = port
+        self._url_prefix = url_prefix
 
         config = configuration.get_config()
 ",Can you put the `url_prefix argument` after `connect_timeout` to be backward compatible.,py,1,1,1
"@@ -1,8 +1,13 @@
 from random import random
 
+<<<<<<< HEAD
+=======
+from bzt.utils import to_json
 from tests import BZTestCase, r
 
+>>>>>>> cba72f5388bd3647b636c773e6893428e37da306
 from bzt.modules.aggregator import ConsolidatingAggregator, DataPoint, KPISet, AggregatorListener
+from tests import BZTestCase, r
 from tests.mocks import MockReader
 
 ","This is unintentional, obviously",py,1,0,1
"@@ -24,6 +24,9 @@ import cPickle as pickle
 import numpy
 import unittest2 as unittest
 
+from nupic.support.unittesthelpers.alogrithm_test_helpers \
+     import getNumpyRandomGenerator
+
 from nupic.bindings.algorithms import FlatSpatialPooler as CPPFlatSpatialPooler
 from nupic.bindings.math import GetNTAReal, Random
 from nupic.research.flat_spatial_pooler import (",Nit: PEP 8 says to prefer using parentheses for implicit line continuations rather than backslashes. Up to you.,py,1,1,1
"@@ -99,7 +99,7 @@ test_cfg = dict(
 )
 # dataset settings
 dataset_type = 'CocoDataset'
-data_root = 'data/coco/'
+data_root = '/data1/home/zhez/data_local/coco/'
 img_norm_cfg = dict(
     mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
 data = dict(",This change is unnecessary.,py,1,0,1
"@@ -126,7 +126,9 @@ def _get_instance():
         with DagsterInstance.get() as instance:
             yield instance
     else:
-        with tempfile.TemporaryDirectory() as tempdir:
+        # make the temp dir in the cwd since default temp dir roots
+        # have issues with FS notif based event log watching
+        with tempfile.TemporaryDirectory(dir=os.getcwd()) as tempdir:
             click.echo(
                 f""Using temporary directory {tempdir} for storage. This will be removed when dagit exits.\n""
                 ""To persist information across sessions, set the environment variable DAGSTER_HOME to a directory to use.\n""",does this have any cleanup issues if dagit crashes or something?,py,1,1,1
"@@ -68,6 +68,7 @@ class NamespaceTest(ReusedSQLTestCase, SQLTestUtils):
 
     def test_concat_index_axis(self):
         pdf = pd.DataFrame({""A"": [0, 2, 4], ""B"": [1, 3, 5], ""C"": [6, 7, 8]})
+        # TODO: pdf.columns.names = [""ABC""]
         kdf = ks.from_pandas(pdf)
 
         ignore_indexes = [True, False]",Let me address this later.,py,0,0,1
"@@ -87,6 +87,6 @@ class ForsetiClientInstaller(ForsetiInstaller):
             'FORSETI_BUCKET': bucket_name[len('gs://'):],
             'BUCKET_LOCATION': self.config.bucket_location,
             'GCP_CLIENT_SERVICE_ACCOUNT': self.gcp_service_acct_email,
-            'BRANCH_OR_RELEASE': 'branch-name: ""{}""'.format(self.branch),
+            'FORSETI_TARGET': 'forseti-target: ""{}""'.format(self.branch),
             'FORSETI_SERVER_ZONE': self.server_zone
         }","Now that I see this here, is there any reason why `forseti-target` attribute is defined here, rather in the yaml.in files?",py,1,1,1
"@@ -380,7 +380,7 @@ public class Actions {
 
     // Of course, this is the offset from the centre of the element. We have no idea what the width
     // and height are once we execute this method.
-    LOG.info(""When using the W3C Action commands, offsets are from the center of element"");
+    LOG.finest(""When using the W3C Action commands, offsets are from the center of element"");
     return moveInTicks(target, xOffset, yOffset);
   }
 ","Again, the existing level is correct --- we're letting users know about something that might cause there tests to fail.",py,1,1,1
"@@ -9,12 +9,13 @@ try:
     old_bokeh = True
 except ImportError:
     from bokeh.models import Component as PlotObject
-    from bokeh._json_encoder import serialize_json
+    from bokeh.core.json_encoder import serialize_json
     old_bokeh = False
 
 import param
 
 from ...core.data import ArrayColumns
+from .util import models_to_json
 
 
 class Callback(param.ParameterizedFunction):",`old_bokeh` isn't a great name as one day the latest version will become old! I would consider stating the version explicitly...i.e `bokeh_XX`.,py,1,1,1
"@@ -1139,18 +1139,7 @@ class GlobalCommands(ScriptableObject):
 			try:
 				c = ord(info.text)
 			except TypeError:
-				# This might be a character taking multiple code points.
-				# If it is a 32 bit character, encode it to UTF-32 and calculate the ord manually.
-				# In Python 3, this is no longer necessary.
-				try:
-					encoded = info.text.encode(""utf_32_le"")
-				except UnicodeEncodeError:
-					c = None
-				else:
-					if len(encoded)==4:
-						c = sum(ord(cp)<<i*8 for i, cp in enumerate(encoded))
-					else:
-						c = None
+				c = None
 			if c is not None:
 				speech.speakMessage(""%d,"" % c)
 				speech.speakSpelling(hex(c))","In python 3, a character in a string is always one code point. Therefore this code is now obsolete.",py,1,1,1
"@@ -112,7 +112,7 @@ class AbstractServiceConfig(object):
         raise NotImplementedError()
 
 
-class AbstractInventoryConfig(dict):
+class AbstractInventoryConfig(object):
     """"""Abstract base class for service configuration. This class
     is used to implement dependency injection for the gRPC services.""""""
 ",Will this break other part of the code? if it's not a dictionary you can no longer access using the .get(key) method.,py,1,1,1
"@@ -23,12 +23,6 @@ Usage:
       --rules <rules path> \\
       --engine_name <rule engine name> \\
       --output_path <output path (optional)> \\
-      --db_host <Cloud SQL database hostname/IP> \\
-      --db_user <Cloud SQL database user> \\
-      --db_name <Cloud SQL database name (required)> \\
-      --sendgrid_api_key <API key to auth SendGrid email service> \\
-      --email_sender <email address of the email sender> \\
-      --email_recipient <email address of the email recipient>
 """"""
 
 ",Do we need to list the config arg here?,py,1,1,1
"@@ -249,9 +249,9 @@ class JUnitTester(JavaTestRunner, HavingInstallableTools):
                 props.write(""target_%s=%s\n"" % (index, item.replace(os.path.sep, '/')))
 
         class_path = os.pathsep.join(self.base_class_path)
-        junit_command_line = [""java"", ""-cp"", class_path, ""taurusjunit.CustomRunner"", self.props_file]
+        junit_cmd_line = [""java"", ""-cp"", class_path, ""-Djna.nosys=true"", ""taurusjunit.CustomRunner"", self.props_file]
 
-        self._start_subprocess(junit_command_line)
+        self._start_subprocess(junit_cmd_line)
 
 
 class TestNGTester(JavaTestRunner, HavingInstallableTools):","If it's for Windows only, maybe add it conditionally?",py,1,1,1
"@@ -0,0 +1,19 @@
+# -*- coding: UTF-8 -*-
+#A part of NonVisual Desktop Access (NVDA)
+#Copyright (C) 2016 NV Access Limited
+#This file is covered by the GNU General Public License.
+#See the file COPYING for more details.
+
+""""""
+Contains upgrade steps for the NVDA configuration files. These steps are run to ensure that a configuration file
+complies with the latest schema (@see configSpec.py).
+
+To add a new step (after modifying the schema and incrementing the schema version number) add a new method to this
+module. The method name should be in the form ""upgradeConfigFrom_X_to_Y"" where X is the previous schema version, and Y
+is the current schema version. The argument profile will be a configobj.ConfigObj object. The function should ensure 
+that no information is lost, while updating the ConfigObj to meet the requirements of the new schema.
+""""""
+
+from logHandler import log
+
+# add upgrade steps here.",Please provide a docstring here which explains what this module is and how to add steps.,py,1,1,1
"@@ -779,7 +779,7 @@ class GlobalCommands(ScriptableObject):
                 if scriptHandler.getLastScriptRepeatCount()>=1:
                         if curObject.TextInfo!=NVDAObjectTextInfo:
                                 textList=[]
-                                if curObject.name and isinstance(curObject.name, basestring) and not curObject.name.isspace():
+                                if curObject.name and isinstance(curObject.name, str) and not curObject.name.isspace():
                                         textList.append(curObject.name)
                                 try:
                                         info=curObject.makeTextInfo(textInfos.POSITION_SELECTION)",Could you also split this one while at it?,py,1,1,1
"@@ -262,15 +262,13 @@ class DynamicOutput(
         )
 
 
-MetadataValues = Union[str, float, int, Dict, EventMetadataEntry]
-
-
 @whitelist_for_serdes
 class AssetObservation(
     NamedTuple(
         ""_AssetObservation"",
         [
             (""asset_key"", AssetKey),
+            (""description"", Optional[str]),
             (""metadata_entries"", List[EventMetadataEntry]),
             (""partition"", Optional[str]),
         ],",maybe these core changes should be part of a separate diff than the frontend/graphql changes?,py,1,1,1
"@@ -12,7 +12,7 @@ from .package import Package, PackageException
 from .util import BASE_DIR
 
 # start with alpha (_ may clobber attrs), continue with alphanumeric or _
-VALID_NAME_RE = re.compile(r'^[a-zA-Z]\w*$')
+VALID_NAME_RE = re.compile(r'^[a-zA-Z]\w*(:[a-zA-Z]\w*)?$')
 CHUNK_SIZE = 4096
 
 # Helper function to return the default package store path","Technically the prefix is the optional part, not the suffix. Just a nitpick",py,1,1,1
"@@ -180,8 +180,12 @@ class MetastoreClient(HiveClient):
     def table_location(self, table, database='default', partition=None):
         with HiveThriftContext() as client:
             if partition is not None:
-                partition_str = self.partition_spec(partition)
-                thrift_table = client.get_partition_by_name(database, table, partition_str)
+                try:
+                    import hive_metastore.ttypes
+                    partition_str = self.partition_spec(partition)
+                    thrift_table = client.get_partition_by_name(database, table, partition_str)
+                except hive_metastore.ttypes.NoSuchObjectException as e:
+                    return ''
             else:
                 thrift_table = client.get_table(database, table)
             return thrift_table.sd.location",can you fix this flake8 issue? `./luigi/contrib/hive.py:187:71: F841 local variable 'e' is assigned to but never used` (btw you can run `tox -e flake8` locally to test),py,0,1,1
"@@ -178,6 +178,7 @@ confspec = ConfigObj(StringIO(
 	reportPage = boolean(default=true)
 	reportLineNumber = boolean(default=False)
 	reportLineIndentation = boolean(default=False)
+	reportToneIndentation = boolean(default=False)
 	reportParagraphIndentation = boolean(default=False)
 	reportTables = boolean(default=true)
 	includeLayoutTables = boolean(default=False)","I think we should rename this to `reportLineIndentationWithTones` or `lineIndentationTones`, since it isn't clear that this is related to line indentation (as opposed to paragraph indentation).",py,1,1,1
"@@ -34,6 +34,7 @@ class BasicAuthAuthenticationPolicy(base_auth.BasicAuthAuthenticationPolicy):
                 return
 
             hmac_secret = settings[""userid_hmac_secret""]
+            # Unsure how to use fstring with *args
             credentials = ""{}:{}"".format(*credentials)
             userid = utils.hmac_digest(hmac_secret, credentials)
             return userid","I would say that `f""{credentials[0]}:{credentials[1]""` is fine. Or leave the format() call",py,1,1,1
"@@ -6,6 +6,8 @@ from kinto.core.schema import (Any, HeaderField, QueryField, HeaderQuotedInteger
                                FieldList, TimeStamp, URL)
 from kinto.core.utils import native_value
 
+POSTGRESQL_MAX_INTEGER_VALUE = 9223372036854775807
+
 
 class TimeStamp(TimeStamp):
     """"""This schema is deprecated, you shoud use `kinto.core.schema.TimeStamp` instead.""""""",`2**64 / 2`,py,0,0,0
"@@ -169,6 +169,9 @@ class MainWindow(QWidget):
         objreg.register('message-bridge', message_bridge, scope='window',
                         window=self.win_id)
 
+        if config.val.window.hide_decoration:
+            window_flags = Qt.CustomizeWindowHint | Qt.NoDropShadowWindowHint
+            self.setWindowFlags(Qt.Window | window_flags)
         self.setWindowTitle('qutebrowser')
         self._vbox = QVBoxLayout(self)
         self._vbox.setContentsMargins(0, 0, 0, 0)",This should be handled in `_on_config_changed` too if possible so it can be set without requiring a restart. Not sure if it's possible to just change the flags after the window has been shown though - but maybe a `self.hide()` and `self.show()` helps.,py,1,1,1
"@@ -595,9 +595,9 @@ class Params(Stream):
         if parameters is None:
             parameters = [p for p in parameterized.params() if p != 'name']
         super(Params, self).__init__(parameterized=parameterized, parameters=parameters, **params)
+        self._memoize = True
         if watch:
-            for p in self.parameters:
-                self.parameterized.param.watch(self._listener, p)
+            self.parameterized.param.watch(self._listener, self.parameters)
 
     def _validate_rename(self, mapping):
         for k, v in mapping.items():","Little bit confused as the the `watch` argument: it doesn't seem to be state (either an attribute or a parameter) but is set through the constructor. Are there cases where you expect users to set `watch=False` even if watch could be supported by the param version? If not, I would remove this argument so that the param version check is sufficient to know whether watch is being used or not (something you need to determine in `Dynamic` later...)",py,1,1,0
"@@ -46,11 +46,7 @@ class TestEndpointLoading(unittest.TestCase):
 
     def test_load_endpoint_json(self):
         endpoints = load_endpoint_json(boto.ENDPOINTS_PATH)
-        self.assertTrue('ec2' in endpoints)
-        self.assertEqual(
-            endpoints['ec2']['us-east-1'],
-            'ec2.us-east-1.amazonaws.com'
-        )
+        self.assertTrue('partitions' in endpoints)
 
     def test_merge_endpoints(self):
         defaults = {",Would this be a breaking change to have partitions as the top layered key?,py,1,1,1
"@@ -173,7 +173,7 @@ public class DefaultConditionRunner implements ConditionRunner {
     }
 
     protected void log(String message) {
-      logger.info(new Date() + "" - "" + message);
+      logger.finest(new Date() + "" - "" + message);
     }
 
   }",This method is designed to allow the condition runner to tell users something interesting. The current `INFO` log level is correct.,py,1,1,1
"@@ -62,14 +62,13 @@ class Swagger(object):
         self.responses = {}
         self.paths = OrderedDict()
 
-    def _load(self, swagger_spec_path):
-        with open(swagger_spec_path) as fds:
-            swagger_content = fds.read()
+    def _load(self, swagger_spec_fd):
+        swagger_content = swagger_spec_fd.read()
         try:
             self.swagger = yaml_ordered_load(swagger_content, yaml.SafeLoader)
-            self.log.info(""Loaded Swagger spec %s"", swagger_spec_path)
+            self.log.info(""Loaded Swagger spec %s"", swagger_spec_fd)
         except IOError as exc:
-            raise TaurusConfigError(""Error when parsing Swagger file '%s': %s"" % (swagger_spec_path, exc))
+            raise TaurusConfigError(""Error when parsing Swagger file '%s': %s"" % (swagger_spec_fd, exc))
 
     def _validate_swagger_version(self):
         swagger_version = self.swagger.get(""swagger"", self.swagger.get(""openapi""))","Actually, it's not necessary to call `read()` on a stream, as `yaml_ordered_load()` already accepts both strings and streams.",py,1,1,1
"@@ -356,6 +356,12 @@ MSGS = {
         ""Emitted when a dict key is not hashable ""
         ""(i.e. doesn't define __hash__ method)."",
     ),
+    ""E1141"": (
+        ""Dict is not iterable"",
+        ""dict-iter-missing-items"",
+        ""Emitted when trying to iterate through""
+        ""a dict without calling .items()"",
+    ),
     ""W1113"": (
         ""Keyword argument before variable positional arguments list ""
         ""in the definition of %s function"",","Let's add a bit more context here, since the dictionary is actually iterable, but it's going to raise an error if we don't call `items()` on it. So maybe something along the lines of `Unpacking a dictionary in iteration without calling .items()`?",py,1,1,1
"@@ -72,7 +72,11 @@ class Anomaly(object):
   _supportedModes = (MODE_PURE, MODE_LIKELIHOOD, MODE_WEIGHTED)
 
 
-  def __init__(self, slidingWindowSize=None, mode=MODE_PURE, binaryAnomalyThreshold=None):
+  def __init__(self, 
+               slidingWindowSize=None,
+               mode=MODE_PURE,
+               binaryAnomalyThreshold=None,
+               claBurnInPeriod=300):
     """"""
     @param slidingWindowSize (optional) - how many elements are summed up;
         enables moving average on final anomaly score; int >= 0",So I can specify `claBurnInPeriod=0` and get the previous behavior?,py,1,1,1
"@@ -363,6 +363,8 @@ class ConfigManager(QObject):
             _get_value_transformer({'false': 'none', 'true': 'debug'}),
         ('ui', 'keyhint-blacklist'):
             _get_value_transformer({'false': '*', 'true': ''}),
+        ('hints', 'auto-follow'):
+            _get_value_transformer({'false': 'never', 'true': 'unique-match'}),
     }
 
     changed = pyqtSignal(str, str)","I think `full-match` would be closer to the current `true` behaviour, right? On the other hand, probably `unique-match` makes more sense as the new default.",py,1,1,1
"@@ -211,6 +211,10 @@ class Task(object):
 
     _event_callbacks = {}
 
+    # Priority of the task: the scheduler should favor available
+    # tasks with higher priority values first.
+    priority = 0
+
     @classmethod
     def event_handler(cls, event):
         """""" Decorator for adding event handlers """"""",This name conflicts with luigi.hadoop.BaseHadoopJobTask which uses priority for hadoop scheduling priority,py,1,1,1
"@@ -932,6 +932,9 @@ class UserResource:
                 'description': 'Invalid value for {}'.format(param)
             }
 
+            if value == '':
+                raise_invalid(self.request, **error_details)
+
             # Ignore specific fields
             if param.startswith('_') and param not in ('_since',
                                                        '_to',",I guess this test is not only for `_since` and for other fields it might be useful to be able to search for an empty value.,py,1,1,1
"@@ -47,6 +47,7 @@ VIOLATION_RESOURCES = {
     'LOCATION_VIOLATION': 'location_violations',
     'LOG_SINK_VIOLATION': 'log_sink_violations',
     'RETENTION_VIOLATION': 'retention_violations',
+    'ROLE_VIOLATION': 'custom_role_violations',
     'SERVICE_ACCOUNT_KEY_VIOLATION': (
         'service_account_key_violations'),
     'EXTERNAL_PROJECT_ACCESS_VIOLATION': 'external_project_access_violations'","Change this to either `'CUSTOM_ROLE_VIOLATION': 'custom_role_violations',` or `'ROLE_VIOLATION': 'role_violations',` So that is matches the pattern of other violations.",py,1,1,1
"@@ -239,12 +239,15 @@ class FSAFHead(RetinaHead):
             labels_list,
             list(range(len(losses_cls))),
             min_levels=argmin)
-        # Clamp num_pos to 1e-3 to prevent 0/0
-        num_pos = torch.cat(pos_inds, 0).sum().float().clamp(min=1e-3)
+        num_pos = torch.cat(pos_inds, 0).sum().float()
         acc = self.calculate_accuracy(cls_scores, labels_list, pos_inds)
         for i in range(len(losses_cls)):
-            losses_cls[i] /= num_pos
-            losses_bbox[i] /= num_pos
+            if num_pos == 0:
+                avg_factor = num_pos + float(num_total_neg)
+            else:
+                avg_factor = num_pos
+            losses_cls[i] /= avg_factor
+            losses_bbox[i] /= avg_factor
         return dict(
             loss_cls=losses_cls,
             loss_bbox=losses_bbox,",The computation of `avg_factor` can be moved out of the for-loop.,py,1,1,1
"@@ -67,11 +67,11 @@ public abstract class AbstractWebDriverEventListener implements WebDriverEventLi
     // Do nothing.
   }
 
-  public void beforeChangeValueOf(WebElement element, WebDriver driver) {
+  public void beforeChangeValueOf(WebElement element, WebDriver driver, CharSequence[] value) {
     // Do nothing.
   }
 
-  public void afterChangeValueOf(WebElement element, WebDriver driver) {
+  public void afterChangeValueOf(WebElement element, WebDriver driver, CharSequence[] value) {
     // Do nothing.
   }
 ","change 'value' to keysToSend, here and in other references in this commit. 'value' implies the user is getting the value of the element, rather than just the keys we're sending to it.",py,1,1,1
"@@ -16,7 +16,10 @@ import param
 from .dimension import Dimension, Dimensioned, ViewableElement
 from .ndmapping import OrderedDict, NdMapping, UniformNdMapping
 from .tree import AttrTree
-from .util import (unique_array, get_path, make_path_unique, int_to_roman)
+from .util import (
+    unique_array, get_path, make_path_unique, int_to_roman,
+    unique_iterator
+)
 from . import traversal
 
 ",At this point isn't it better to use ``util`` as a qualified namespace?,py,1,1,1
"@@ -195,7 +195,10 @@ def main():
         if args.eval:
             eval_kwargs = cfg.get('evaluation', {}).copy()
             # hard-code way to remove EvalHook args
-            for key in ['interval', 'tmpdir', 'start', 'gpu_collect']:
+            for key in [
+                    'interval', 'tmpdir', 'start', 'gpu_collect', 'save_best',
+                    'key_indicator', 'rule'
+            ]:
                 eval_kwargs.pop(key, None)
             eval_kwargs.update(dict(metric=args.eval, **kwargs))
             print(dataset.evaluate(outputs, **eval_kwargs))",Other scripts such as `benchmark.py` may also be affected.,py,0,0,1
"@@ -19,3 +19,8 @@
 
 import pytest_bdd as bdd
 bdd.scenarios('tabs.feature')
+
+
+@bdd.when(""I wait for a prompt"")
+def wait_for_prompt(quteproc):
+    quteproc.wait_for(message='Asking question *')","You can simply do `And I wait for ""Asking question *"" in the log` in the `feature` file (though you might want to include some portion of the question text as well)",py,1,1,1
"@@ -27,6 +27,12 @@ class LoadImageFromFile(object):
         results['img'] = img
         results['img_shape'] = img.shape
         results['ori_shape'] = img.shape
+        # Set initial values for default meta_keys
+        results['pad_shape'] = img.shape
+        results['flip'] = False
+        results['scale_factor'] = 1.0
+        cnum = 1 if len(img.shape) < 3 else img.shape[2]
+        results['img_norm_cfg'] = [[0.0] * cnum, [1.0] * cnum, False]
         return results
 
     def __repr__(self):",Use a more specific variable name like `num_channels`.,py,1,1,1
"@@ -0,0 +1,13 @@
+""""""Molecule Application Module.""""""
+from ansible_compat.runtime import Runtime
+
+
+class App:
+    """"""App class that keep runtime status.""""""
+
+    def __init__(self) -> None:
+        """"""Create a new app instance.""""""
+        self.runtime = Runtime(isolated=True)
+
+
+app = App()",Is this an attempt to make a mutable singleton? Why not initialize it during the startup sequence and then pass around DI-style?,py,1,1,1
"@@ -112,6 +112,10 @@ class AddonHalt(MitmproxyException):
     pass
 
 
+class TypeError(MitmproxyException):
+    pass
+
+
 """"""
     Net-layer exceptions
 """"""",This looks wrong - we should use a regular Python TypeError?,py,1,1,1
"@@ -0,0 +1,6 @@
+import ConfigParser
+import os,binascii
+
+cfgfile = open(""/{{cookiecutter.repo_name}}/{{cookiecutter.repo_name}}/{{cookiecutter.repo_name}}.ini"",'w') #enter path of file
+parser = ConfigParser.SafeConfigParser()
+parser.set('authentication_configuration','kinto.userid_hmac_secret', binascii.b2a_hex(os.urandom(8)))","The leading `/` in the path here, migth be the source of your trouble",py,1,1,1
"@@ -19,8 +19,7 @@
 # http://numenta.org/licenses/
 # ----------------------------------------------------------------------
 
-from collections import defaultdict, namedtuple
-
+from collections import defaultdict
 
 
 class SynapseData(object):","I think we want 3 blank lines above this, not 2. ""Separate top level functions and classes by three blank lines.""",py,1,1,1
"@@ -37,9 +37,9 @@ class FunctionHooker(object):
 	def __init__(self,targetDll,importDll,funcName,newFunction):
 		hook=NVDAHelper.localLib.dllImportTableHooks_hookSingle(targetDll,importDll,funcName,newFunction)
 		if hook:
-			print ""hooked %s""%funcName
+			print(""hooked %s""%funcName)
 		else:
-			print ""could not hook %s""%funcName
+			print(""could not hook %s""%funcName)
 			raise RuntimeError(""could not hook %s""%funcName)
 
 	def __del__(self):","Actually, the print statements in this file should have always been log.debug calls. Currently they are just noise going to stdout.",py,1,1,1
"@@ -83,7 +83,8 @@ class YamlConfig:
     def __init__(self):
         self._filename = os.path.join(standarddir.config(auto=True),
                                       'autoconfig.yml')
-        self.values = {}
+        self._values = {}
+        self._changed = None
 
     def init_save_manager(self, save_manager):
         """"""Make sure the config gets saved properly.","FWIW I'd prefer this to be called `self._dirty` as it's called that in other places, and when we add a `changed` signal, it's harder to mix those two up. Also, why set it to `None` here and not `False`?",py,1,1,1
"@@ -0,0 +1,6 @@
+# -*- coding: UTF-8 -*-
+# A part of NonVisual Desktop Access (NVDA)
+# Copyright (C) 2018 NV Access Limited, Łukasz Golonka
+# This file may be used under the terms of the GNU General Public License, version 2 or later.
+# For more details see: https://www.gnu.org/licenses/gpl-2.0.html
+from mplayerc import *",Could you please add an empty line before and after this line?,py,1,1,1
"@@ -176,8 +176,8 @@ def _get_mapped_solids_dict(
     with user_code_error_boundary(
         DagsterConfigMappingFunctionError, _get_error_lambda(current_stack)
     ):
-        mapped_solids_config = graph_def.config_mapping.config_fn(
-            config_mapped_solid_config.value.get(""config"", {})
+        mapped_solids_config = graph_def.config_mapping.resolve(
+            config_mapped_solid_config.value.get(""config"", {}), config_has_been_validated=True
         )
 
     # Dynamically construct the type that the output of the config mapping function will",how do we handle enums in composite descent? is it under test at all?,py,1,1,1
"@@ -18,6 +18,7 @@ from __future__ import absolute_import
 from __future__ import division
 from __future__ import print_function
 
+import threading
 import concurrent.futures
 from google.apputils import datelib
 ","nit: threading is part of the standard library, so it should be with __future__ section.",py,1,1,1
"@@ -416,9 +416,9 @@ This initializes all modules such as audio, IAccessible, keyboard, mouse, and GU
 		log.warning(""Java Access Bridge not available"")
 	except:
 		log.error(""Error initializing Java Access Bridge support"", exc_info=True)
-	import winConsoleHandler
-	log.debug(""Initializing winConsole support"")
-	winConsoleHandler.initialize()
+	import winConsoleHandlerLegacy
+	log.debug(""Initializing legacy winConsole support"")
+	winConsoleHandlerLegacy.initialize()
 	import UIAHandler
 	log.debug(""Initializing UIA support"")
 	try:",Why did you rename this as well?,py,1,1,1
"@@ -0,0 +1,12 @@
+from __future__ import absolute_import, print_function, division
+
+from mitmproxy import ctxmanager
+
+_flow = None
+_log = None
+_master = None
+
+
+flow = ctxmanager.Facade(lambda: _flow)
+log = ctxmanager.Facade(lambda: _log)
+master = ctxmanager.Facade(lambda: _master)",Can we avoid the whole Facade dance and just assign to `ctx.flow` etc. in `handlecontext`?,py,1,1,1
"@@ -694,7 +694,13 @@ class ColorbarPlot(ElementPlot):
             self._cbar_extend = 'max'
 
         # Define special out-of-range colors on colormap
-        cmap = copy.copy(plt.cm.get_cmap(opts.get('cmap')))
+        cmap = opts.get('cmap')
+        if isinstance(cmap, list):
+            cmap = mpl_colors.ListedColormap(cmap)
+        elif isinstance(cmap, util.basestring):
+            cmap = copy.copy(plt.cm.get_cmap(cmap))
+        else:
+            cmap = copy.copy(cmap)
         colors = {}
         for k, val in self.clipping_colors.items():
             if isinstance(val, tuple):",What is all the copying about?,py,1,0,1
"@@ -174,6 +174,9 @@ class ElementPlot(BokehPlot, GenericElementPlot):
         default=None, class_=(util.basestring, TickFormatter, FunctionType), doc=""""""
         Formatter for ticks along the x-axis."""""")
 
+    x2rotation = param.Integer(default=None, bounds=(0, 360), doc=""""""
+        Rotation angle of the xticks."""""")
+
     _categorical = False
 
     # Declare which styles cannot be mapped to a non-scalar dimension",Rotation angle of _which_ xticks?,py,1,0,1
"@@ -5202,6 +5202,15 @@ class DataFrameTest(ReusedSQLTestCase, SQLTestUtils):
         kdf = ks.Series([]).to_frame()
         self.assert_eq(pdf.last_valid_index(), kdf.last_valid_index())
 
+    def test_last(self):
+        from pandas.tseries.offsets import DateOffset
+
+        index = pd.date_range(""2018-04-09"", periods=4, freq=""2D"")
+        pdf = pd.DataFrame([1, 2, 3, 4], index=index)
+        kdf = ks.from_pandas(pdf)
+        self.assert_eq(pdf.last(""1D""), kdf.last(""1D""))
+        self.assert_eq(pdf.last(DateOffset(days=1)), kdf.last(DateOffset(days=1)))
+
     def test_first_valid_index(self):
         pdf = pd.DataFrame(
             {""a"": [None, 2, 3, 2], ""b"": [None, 2.0, 3.0, 1.0], ""c"": [None, 200, 400, 200]},",You can import it at the import block at the header of this file.,py,1,1,1
"@@ -66,7 +66,8 @@ class PythonModelWrapper(object):
     @lazy_property
     def _model_udf(self):
         spark = default_session()
-        return spark_udf(spark, self._path, self._run_id, result_type=self._return_type)
+        model_uri = ""runs:/{run_id}/{path}"".format(run_id=self._run_id, path=self._path)
+        return spark_udf(spark, model_uri=model_uri, result_type=self._return_type)
 
     def __str__(self):
         return ""PythonModelWrapper({})"".format(str(self._model))","Seems like `run_id` is optional according to `load_model` signature, what if it's `None`?",py,1,1,1
"@@ -1310,3 +1310,14 @@ class IndexesTest(ReusedSQLTestCase, TestUtils):
 
         for lv, output in zip(level_names, outputs):
             self.assertEqual(output, kdf.index._get_level_number(lv))
+
+    def test_abs(self):
+        pidx = pd.Index([-2, -1, 0, 1])
+        kidx = ks.from_pandas(pidx)
+
+        self.assert_eq(abs(pidx), abs(kidx))
+        self.assert_eq(np.abs(pidx), np.abs(kidx))
+
+        kidx = ks.from_pandas(pd.MultiIndex.from_tuples([(1, 2)], names=[""level1"", ""level2""]))
+        with self.assertRaisesRegexp(TypeError, ""perform __abs__ with this index""):
+            abs(kidx)",nit: we have `ks.MultiIndex.from_tuples`.,py,1,0,1
"@@ -0,0 +1,15 @@
+""""""Test case for typevar-name-missing-variance with default settings""""""
+
+from typing import TypeVar
+
+# Name set by regex pattern
+TypeVarsShouldBeLikeThis = TypeVar(""TypeVarsShouldBeLikeThis"")
+TypeVarsShouldBeLikeThis_contra = TypeVar(
+    ""TypeVarsShouldBeLikeThis_contra"", contravariant=True
+)
+TypeVarsShouldBeLikeThis_co = TypeVar(""TypeVarsShouldBeLikeThis_co"", covariant=True)
+
+# Name using the standard style
+T_GoodName = TypeVar(""T_GoodName"")  # [invalid-name]
+T_GoodName_co = TypeVar(""T_GoodName_co"", covariant=True)  # [invalid-name]
+T_GoodName_contra = TypeVar(""T_GoodName_contra"", contravariant=True)  # [invalid-name]",Better to remove the `T_` prefix,py,1,0,1
"@@ -293,9 +293,8 @@ class OptionsManagerMixIn:
             msg = ""No config file found, using default configuration""
         print(msg, file=sys.stderr)
 
-    @staticmethod
     def _parse_toml(
-        config_file: Union[Path, str], parser: configparser.ConfigParser
+        self, config_file: Union[Path, str], parser: configparser.ConfigParser
     ) -> None:
         """"""Parse and handle errors of a toml configuration file.""""""
         with open(config_file, encoding=""utf-8"") as fp:",Might want to add an explanation for why we get here. Can we get the incorrect item from the ValueError message? If so we might be able to pass it as an `args`.,py,1,1,1
"@@ -7710,9 +7710,9 @@ defaultdict(<class 'list'>, {'col..., 'col...})]
 
         Examples
         --------
-        >>> df = ks.DataFrame({'A': {0: 'a', 1: 'b', 2: 'c'},
-        ...                    'B': {0: 1, 1: 3, 2: 5},
-        ...                    'C': {0: 2, 1: 4, 2: 6}},
+        >>> df = ks.DataFrame({'A': {'0': 'a', '1': 'b', '2': 'c'},
+        ...                    'B': {'0': '1', '1': '3', '2': '5'},
+        ...                    'C': {'0': '2', '1': '4', '2': '6'}},
         ...                   columns=['A', 'B', 'C'])
         >>> df
            A  B  C",Why changed here? Seems not related?,py,1,0,0
"@@ -47,15 +47,12 @@ import json
 import random
 import tempfile
 import unittest2 as unittest
+from pkg_resources import resource_filename
 
-from nupic.data.datasethelpers import findDataset
 from nupic.data.file_record_stream import FileRecordStream
 from nupic.engine import Network
-from nupic.research import fdrutilities as fdrutils
 from nupic.encoders import MultiEncoder
-from nupic.regions.RecordSensorFilters.ModifyFields import ModifyFields
-from nupic.support.unittesthelpers.testcasebase import (TestCaseBase,
-                                                        TestOptionParser)
+from nupic.support.unittesthelpers.testcasebase import TestCaseBase
 
 _VERBOSITY = 0         # how chatty the unit tests should be
 _SEED = 35             # the random seed used throughout",Cleaned up unused imports.,py,1,0,1
"@@ -5,6 +5,14 @@ from os import path
 from bzt.modules.siege import SiegeExecutor, DataLogReader
 from tests import BZTestCase
 from tests.mocks import EngineEmul
+from bzt.utils import is_windows
+
+
+def tool_name():
+    if is_windows():
+        return 'siege.bat'
+    else:
+        return 'siege.sh'
 
 
 def get_res_path(resource):",Look how it's done everywhere with utils.EXE_SUFFIX constant.,py,1,1,1
"@@ -121,6 +121,10 @@ class espeak_VOICE(Structure):
 	def __eq__(self, other):
 		return isinstance(other, type(self)) and addressof(self) == addressof(other)
 
+# constants that can be returned by espeak_callback
+callback_continue_synthesis=0
+callback_abort_synthesis=1
+
 t_espeak_callback=CFUNCTYPE(c_int,POINTER(c_short),c_int,POINTER(espeak_EVENT))
 
 @t_espeak_callback",Great! You worked out what these values were for. I think they should be in caps though.,py,1,1,1
"@@ -101,7 +101,8 @@ def get_template_body(req_data):
     url = req_data.get('TemplateURL')
     if url:
         response = run_safe(lambda: safe_requests.get(url, verify=False))
-        if not response or response.status_code >= 400:
+        # check error codes, and code 301 - fixes https://github.com/localstack/localstack/issues/1884
+        if not response or response.status_code == 301 or response.status_code >= 400:
             # check if this is an S3 URL, then get the file directly from there
             if '://localhost' in url or re.match(r'.*s3(\-website)?\.([^\.]+\.)?amazonaws.com.*', url):
                 parsed_path = urlparse.urlparse(url).path.lstrip('/')",Should this check for ://localhost instead be checking for HOSTNAME or HOSTNAME_EXTERNAL?,py,1,1,1
"@@ -21,7 +21,9 @@
 
 """"""Anomaly-related algorithms.""""""
 
+import collections
 import numpy
+from types import FunctionType
 
 from nupic.algorithms.anomaly_likelihood import AnomalyLikelihood
 from nupic.utils import MovingAverage","`collections` is newly imported, but not used. Please run your changes through pylint with nupic pylint configuration and fix findings related to your changes.",py,1,1,1
"@@ -407,6 +407,8 @@ class HttpLayer(base.Layer):
                 self.channel.ask(""responseheaders"", f)
 
             self.log(""response"", ""debug"", [repr(f.response)])
+            if hasattr(self, 'has_tailers') and self.has_tailers:
+                f.trailers = self.read_trailers_headers()
             self.channel.ask(""response"", f)
 
             if not f.response.stream:","Is `has_tailers` necessary? Shouldn't `flow.trailers == None` be the same information? If we really need `has_tailers`, please make it a first-class citizen of the Response object (instead of checking if it has been set during runtime), so it also serializes properly, and we can remove the `hasattr` checks.",py,1,1,1
"@@ -34,6 +34,15 @@ class CocoDataset(CustomDataset):
                'vase', 'scissors', 'teddy bear', 'hair drier', 'toothbrush')
 
     def load_annotations(self, ann_file):
+        """"""Load annotation from COCO style annotation file
+
+        Args:
+            ann_file (str): Path of annotation file.
+
+        Returns:
+            list[dict]: Annotation info from COCO api.
+        """"""
+
         self.coco = COCO(ann_file)
         self.cat_ids = self.coco.get_cat_ids(cat_names=self.CLASSES)
         self.cat2label = {cat_id: i for i, cat_id in enumerate(self.cat_ids)}",Missing the last `.`,py,1,0,1
"@@ -76,7 +76,7 @@ def check_stepfunctions(expect_shutdown=False, print_error=False):
     out = None
     try:
         # check Kinesis
-        wait_for_port_open(config.LOCAL_PORT_STEPFUNCTIONS)
+        wait_for_port_open(config.LOCAL_PORT_STEPFUNCTIONS, sleep_time=2)
         endpoint_url = f""http://127.0.0.1:{config.LOCAL_PORT_STEPFUNCTIONS}""
         out = aws_stack.connect_to_service(
             service_name=""stepfunctions"", endpoint_url=endpoint_url",Noted some interesting race conditions when the sleep time is too small on M1. Might be creating a tight loop blocking the actual startup. This seems to make it start every time.,py,1,1,1
"@@ -117,6 +117,10 @@ public class DistributorStatus {
       return up;
     }
 
+    public boolean isDocker() {
+      return up;
+    }
+
     public int getMaxSessionCount() {
       return maxSessionCount;
     }",Prefer a human-readable string rather than querying specific technologies. How would I indicate a session is running on BrowserStack? Or some custom thing?,py,1,1,1
"@@ -47,6 +47,7 @@ schemaVersion = integer(min=0, default={latestSchemaVersion})
 # Audio settings
 [audio]
         audioDuckingMode = integer(default=0)
+        idleCloseDelay = integer(default=10000,min=0,max=86400000)
 
 # Braille settings
 [braille]","Wow, a day is a bit long isn't it? May be leave out the max, or set it somewhere around an hour.",py,1,1,1
"@@ -30,7 +30,7 @@ WE_POST = r'''
 
 
 def makeJunitXML(inFileName, outFileName):
-	with open(inFileName, 'rt', encoding='UTF-8') as flake8In:
+	with open(inFileName, 'rt', encoding='ANSI', errors='replace') as flake8In:
 		errorText = flake8In.read()
 	if len(errorText) > 0:
 		# make ""with error"" xml content","@feerrenrut Do you think we might reconsider this line now that Flake8 runs in UTF-8 Mode as of #11108? `errors='replace'` is probably still a good strategy, though.",py,0,1,1
"@@ -41,6 +41,13 @@ class ImportTest(QuiltTestCase):
         assert set(dataframes._group_keys()) == set()
         assert set(dataframes._data_keys()) == {'csv', 'nulls'}
 
+        # this should contain elements
+        for node in package:
+            assert node
+        # iter over an empty GroupNode
+        for node in dataframes:
+            assert not node
+
         assert isinstance(README(), string_types)
         assert isinstance(README._data(), string_types)
         assert isinstance(dataframes.csv(), pd.DataFrame)",This doesn't actually check that package contains elements; it won't run at all if the iterator doesn't return anything. Do something like `assert list(package)` instead.,py,1,1,1
"@@ -231,7 +231,9 @@ def listComPorts(onlyAvailable=True):
 			):
 				# Ignore ERROR_INSUFFICIENT_BUFFER
 				if ctypes.GetLastError() != ERROR_INSUFFICIENT_BUFFER:
-					raise ctypes.WinError()
+					# #6007: SPDRP_FRIENDLYNAME sometimes doesn't exist/isn't valid.
+					log.debugWarning(""Couldn't get SPDRP_FRIENDLYNAME for %s: %s"" % (port, ctypes.WinError()))
+					entry[""friendlyName""] = port
 			else:
 				entry[""friendlyName""] = buf.value
 ",Unrelated to your change. While it might be unlikely I think it would be a good idea to log an insufficient buffer error.,py,0,1,1
"@@ -1,5 +1,5 @@
 from functools import update_wrapper
-from typing import Any, Callable, Dict, List, Optional, Sequence, Set, Union
+from typing import TYPE_CHECKING, Any, Callable, Dict, List, Optional, Sequence, Set, Union
 
 from dagster import check
 from dagster.core.decorator_utils import format_docstring_for_description","Oops, I'm going to move these changes that don't have anything to do with asset defs to a separate PR.",py,0,0,1
"@@ -259,6 +259,10 @@ class ElectrumWindow(QMainWindow):
     def load_wallet(self, wallet):
         import electrum
         self.wallet = wallet
+        self.blockchain = self.wallet.verifier.blockchain
+        test_height_store = self.wallet.storage.get('blockht')
+        if test_height_store and not self.network.is_connected():
+            self.blockchain.local_height = self.wallet.storage.get('blockht')
         self.accounts_expanded = self.wallet.storage.get('accounts_expanded',{})
         self.current_account = self.wallet.storage.get(""current_account"", None)
 ","When loading the offline wallet, rather than somehow transporting the 20MB blockchain headers file, I stored the most recent height in the offline sync data. It reads here if it exists in the wallet, and if it is offline. This is to allow offline wallets that for some reason go online to update height via internet and not interfere. (I wasn't sure if it would)",py,1,1,1
"@@ -1207,6 +1207,8 @@ class Frame(object, metaclass=ABCMeta):
         >>> df['b'].sum(min_count=3)
         nan
         """"""
+        axis = validate_axis(axis)
+        numeric_only = None if axis == 1 else numeric_only
 
         def sum(spark_column, spark_type):
             if isinstance(spark_type, BooleanType):",`numeric_only = None if axis == 1 and numeric_only is True else numeric_only`?,py,1,1,1
"@@ -888,6 +888,17 @@ class WebDriver(BaseWebDriver):
         """"""
         self.execute(Command.MINIMIZE_WINDOW)
 
+    def print_page(self, print_option_arg = None):
+        """"""
+        Takes PDF of the current page.
+        The driver makes a best effort to return a PDF based on the provided parameters.
+        """"""
+        options = {}
+        if print_option_arg:
+            options = print_option_arg.print_options
+
+        return self.execute(Command.PRINT_PAGE, options)['value']
+
     @property
     def switch_to(self):
         """"""",Let's not use a form of hungarian notation in naming our variables,py,1,1,1
"@@ -1277,6 +1277,10 @@ class DictionaryEntryDialog(wx.Dialog):
                 return DictionaryEntryDialog.TYPE_LABELS_ORDERING[typeRadioValue]
 
         def onOk(self,evt):
+                if not self.patternTextCtrl.GetValue():
+                        # Translators: This is an error message to let the user know that the pattern field in the dictionary entry is not valid.
+                        gui.messageBox(_(""A pattern is required.""), _(""Dictionary Entry Error""), wx.OK|wx.ICON_WARNING, self)
+                        return 
                 try:
                         self.dictEntry=speechDictHandler.SpeechDictEntry(self.patternTextCtrl.GetValue(),self.replacementTextCtrl.GetValue(),self.commentTextCtrl.GetValue(),bool(self.caseSensitiveCheckBox.GetValue()),self.getType())
                 except Exception as e:",Would it be a better user experience to disable the OK button when there is no text in the pattern field?,py,1,1,1
"@@ -95,6 +95,11 @@ CORS_HEADERS = [
     'Access-Control-Request-Headers', 'Access-Control-Request-Method'
 ]
 
+LOCATION_CONSTRAINT_VALID_REGION = ['af-south-1', 'ap-east-1', 'ap-northeast-1', 'ap-northeast-2', 'ap-northeast-3',
+    'ap-south-1', 'ap-southeast-1', 'ap-southeast-2', 'ca-central-1', 'cn-north-1', 'cn-northwest-1, EU',
+    'eu-central-1', 'eu-north-1', 'eu-south-1', 'eu-west-1', 'eu-west-2', 'eu-west-3', 'me-south-1', 'sa-east-1',
+    'us-east-2', 'us-gov-east-1', 'us-gov-west-1', 'us-west-1', 'us-west-2']
+
 
 def event_type_matches(events, action, api_method):
     """""" check whether any of the event types in `events` matches the","nit: Looks like a typo in string `'cn-northwest-1, EU'`. Also, I think we should probably rather match for `us-east-1` (rather than matching against all the other regions here) - to my knowledge `us-east-1` is literally the only region that is an exception when it comes to `LocationConstraint`.",py,1,1,1
"@@ -14,7 +14,7 @@ def evaluateTarget(requestContext, target):
     return result
 
 
-def evaluateTokens(requestContext, tokens, replacements=None):
+def evaluateTokens(requestContext, tokens, replacements=None, pipedArg=None):
   if tokens.template:
     arglist = dict()
     if tokens.template.kwargs:",Could you please elaborate how pipedArg is passed here?,py,1,1,1
"@@ -297,6 +297,14 @@ class SensorExecutionArgs(
         )
 
 
+@whitelist_for_serdes
+class NotebookDataArgs(namedtuple(""_NotebookDataArgs"", ""notebook_path"")):
+    def __new__(cls, notebook_path):
+        return super(NotebookDataArgs, cls).__new__(
+            cls, notebook_path=check.str_param(notebook_path, ""notebook_path"")
+        )
+
+
 @whitelist_for_serdes
 class ExternalJobArgs(
     namedtuple(",slightly dubious about having an object wrapper for a string param - seems unlikely we would want other serdes objects as args here - if ever any other args,py,1,1,1
"@@ -376,7 +376,16 @@ class PackageStore(object):
         objfiles = [self.object_path(h) for h in hash_list]
         dataset = ParquetDataset(objfiles)
         table = dataset.read(nthreads=4)
-        dataframe = table.to_pandas()
+        try:
+            dataframe = table.to_pandas()
+        except:
+            # Try again to convert the table after removing
+            # the possibly buggy Pandas-specific metadata.
+            meta = table.schema.metadata.copy()
+            meta.pop(b'pandas')
+            newtable = table.replace_schema_metadata(meta)
+            dataframe = newtable.to_pandas()
+
         return dataframe
 
     def _read_parquet_spark(self, hash_list):","Catch a more specific exception - `AssertionError`, `Exception`, etc..; you don't want to catch things like `KeyboardInterrupt` or `SystemExit`.",py,1,1,1
"@@ -46,7 +46,9 @@ public class HTMLTestResults {
   private final HTMLSuiteResult suite;
 
   private static final String HEADER = ""<html>\n"" +
-      ""<head><style type='text/css'>\n"" +
+      ""<head>\n""+
+      ""<meta charset=\""UTF-8\"">\n""+
+      ""<style type='text/css'>\n"" +
       ""body, table {\n"" +
       ""    font-family: Verdana, Arial, sans-serif;\n"" +
       ""    font-size: 12;\n"" +","Is there a recommended quote style for attributes? I see single and double here, double further down.",py,1,1,1
"@@ -119,6 +119,7 @@ exec 2>&1
 # Ubuntu update.
 sudo apt-get update -y
 sudo apt-get upgrade -y
+sudo apt-get update && sudo apt-get --assume-yes install google-cloud-sdk
 
 USER_HOME=/home/ubuntu
 ","Can we separate this change into another PR, since it's not directly related to switching to the image version? Generally speaking, it's good practice to do this separation so that any problems are easier to troubleshoot and find.",py,0,1,1
"@@ -19,3 +19,7 @@
 # http://numenta.org/licenses/
 # ----------------------------------------------------------------------
 __version__ = ""0.3.0.dev0""
+
+import os
+NUPIC_ROOT = os.environ.get('NUPIC', os.path.dirname(os.path.realpath(__file__)))
+",Have you tried get the absolute path of `__file__` and so discard $NUPIC completely?,py,1,1,1
"@@ -32,9 +32,9 @@ import csv
 import json
 import os
 import math
+from pkg_resources import resource_filename
 
 from nupic.algorithms.anomaly import computeRawAnomalyScore
-from nupic.data.datasethelpers import findDataset
 from nupic.data.file_record_stream import FileRecordStream
 from nupic.engine import Network
 from nupic.encoders import MultiEncoder","nit: put blank line before pkg_resources, it is a third-party lib",py,1,1,1
"@@ -689,8 +689,15 @@ class YOLACTProtonet(BaseModule):
         prototypes = prototypes.permute(0, 2, 3, 1).contiguous()
 
         num_imgs = x.size(0)
+
+        # The reason for not using self.is_training is that
+        # val workflow will have a dimension mismatch error.
+        # Note that this writing method is very tricky.
+        # Fix https://github.com/open-mmlab/mmdetection/issues/5978
+        is_training = (coeff_pred[0].dim() == 4)
+
         # Training state
-        if self.training:
+        if is_training:
             coeff_pred_list = []
             for coeff_pred_per_level in coeff_pred:
                 coeff_pred_per_level = \",use another name rather than is_training.,py,1,0,1
"@@ -21,6 +21,8 @@ import com.google.common.base.Charsets;
 import com.google.common.io.ByteStreams;
 import com.google.common.net.MediaType;
 
+import com.sun.org.glassfish.gmbal.ManagedObject;
+
 import org.apache.http.Header;
 import org.apache.http.HttpEntity;
 import org.apache.http.HttpHost;","Again, you don't want to depend on glassfish.",py,1,0,1
"@@ -35,15 +35,10 @@ def parse_args():
         help='whether not to evaluate the checkpoint during training')
     group_gpus = parser.add_mutually_exclusive_group()
     group_gpus.add_argument(
-        '--gpus',
+        '--gpu-id',
         type=int,
-        help='number of gpus to use '
-        '(only applicable to non-distributed training)')
-    group_gpus.add_argument(
-        '--gpu-ids',
-        type=int,
-        nargs='+',
-        help='ids of gpus to use '
+        default=0,
+        help='id of gpu to use '
         '(only applicable to non-distributed training)')
     parser.add_argument('--seed', type=int, default=None, help='random seed')
     parser.add_argument(",We should add deprecation warning of --gpu-ids and --gpus to indicate users that they are deprecated and useless. We should not delete them immediately.,py,1,1,1
"@@ -42,7 +42,7 @@ def _check_tcpdump():
         return False
 
     # On some systems, --version does not exist on tcpdump
-    return proc.returncode == 0 or output.startswith(b'Usage: tcpdump ')
+    return proc.returncode == 0 or output.startswith(b'Usage: tcpdump ') or output.startswith(b'tcpdump: unrecognized option')
 
 
 # This won't be used on Windows",This line is longer than 79 characters. Please split it.,py,1,1,1
"@@ -94,7 +94,7 @@ def test_index_view_at_path_prefix():
             res = client.get(""/dagster-path/"")
             assert res.status_code == 200
             assert b""You need to enable JavaScript to run this app"" in res.data
-            assert b'{""pathPrefix"": ""/dagster-path""}' in res.data
+            assert b'""pathPrefix"": ""/dagster-path""' in res.data
 
 
 def test_graphql_view():",Also add an asset for the telemetry value?,py,1,1,1
"@@ -24,6 +24,10 @@ from datetime import datetime
 from functools import wraps
 from os.path import splitext, basename
 
+from django.conf import settings
+from django.utils.timezone import make_aware
+from graphite.logger import log
+
 try:
   import cPickle as pickle
   USING_CPICKLE = True",eliminate unneeded try/except,py,0,1,1
"@@ -276,7 +276,7 @@ def in_nested_list(nested_list, obj):
 
 def _get_break_loop_node(break_node):
     """"""
-    Returns the loop node that holds the break node in arguments.
+    Returns the loop node that holds the break or return node in arguments.
 
     Args:
         break_node (astroid.Break): the break node of interest.",Can the code that uses this be changed to use `checkers.utils.get_node_first_ancestor_of_type`? This function is basically doing the same I believe.,py,1,1,1
"@@ -23,7 +23,11 @@ class AnchorHead(BaseDenseHead, BBoxTestMixin):
         anchor_generator (dict): Config dict for anchor generator
         bbox_coder (dict): Config of bounding box coder.
         reg_decoded_bbox (bool): If true, the regression loss would be
-            applied on decoded bounding boxes. Default: False
+            applied directly on decoded bounding boxes, meaning both the
+            predicted boxes and regression targets are with absolute
+            coordinates format. Default False. It should be set to
+            `True` when using `IoULoss`, `GIoULoss`, or `DIoULoss`
+            in the bbox head.
         loss_cls (dict): Config of classification loss.
         loss_bbox (dict): Config of localization loss.
         train_cfg (dict): Training config of anchor head.",`meaning both the predicted boxes and regression targets are with absolute` -> `converting both the predicted boxes and regression targets to absolute xxx`,py,1,1,1
"@@ -29,6 +29,13 @@ from pyspark.sql import Column
 from pyspark.sql.functions import pandas_udf
 import pyspark.sql.types as types
 
+from databricks import koalas as ks  # For running doctests and reference resolution in PyCharm.
+
+
+__all__ = ['Col', '_make_fun', 'pandas_wrap', 'as_spark_type',
+           'as_python_type', 'infer_pd_series_spark_type']
+
+
 T = typing.TypeVar(""T"")
 
 ",I think `__all__` usually doesn't include `_*` functions.,py,1,1,1
"@@ -29,7 +29,7 @@ from boto.s3.key import Key
 from luigi.s3 import S3Client
 
 
-if sys.version_info[:2] == (3, 4):
+if (3, 4, 0) <= sys.version_info[:3] < (3, 4, 3):
     # spulec/moto#308
     mock_s3 = unittest.skip('moto mock doesn\'t work with python3.4')
 ","Out of curiosity, why it doesn't work on < Python 3.4.3?",py,1,0,1
"@@ -4546,6 +4546,17 @@ class DataFrameTest(ReusedSQLTestCase, SQLTestUtils):
         finally:
             sys.stdout = prev
 
+    def test_repartition(self):
+        kdf = ks.DataFrame({""age"": [5, 5, 2, 2], ""name"": [""Bob"", ""Bob"", ""Alice"", ""Alice""]})
+
+        new_kdf = kdf.spark.repartition(7)
+        self.assertEqual(new_kdf.to_spark().rdd.getNumPartitions(), 7)
+
+        kdf = kdf.set_index(""age"")
+        new_kdf = kdf.spark.repartition(5)
+        self.assertEqual(new_kdf.to_spark().rdd.getNumPartitions(), 5)
+        self.assertEqual(kdf.index.name, new_kdf.index.name)
+
     def test_mad(self):
         pdf = pd.DataFrame(
             {","Shall we also test `self.assert_eq(kdf.sort_index(), new_kdf.sort_index())`?",py,1,1,1
"@@ -760,6 +760,14 @@ class ChannelDB(SqlDB):
     def get_node_info_for_node_id(self, node_id: bytes) -> Optional['NodeInfo']:
         return self._nodes.get(node_id)
 
+    def get_node_infos(self) -> Dict[bytes, NodeInfo]:
+        with self.lock:
+            return self._nodes
+
+    def get_node_policies(self) -> Dict[Tuple[bytes, ShortChannelID], Policy]:
+        with self.lock:
+            return self._policies
+
     def to_dict(self) -> dict:
         """""" Generates a graph representation in terms of a dictionary.
 ",should we create a copy here? the lock as-is does not do much; the dict is passed by reference,py,1,1,1
"@@ -29,14 +29,14 @@ def test_config_build_detector():
     from mmdet.models import build_detector
 
     config_dpath = _get_config_directory()
-    print('Found config_dpath = {!r}'.format(config_dpath))
+    print(f'Found config_dpath = {config_dpath!r}')
 
     import glob
     config_fpaths = list(glob.glob(join(config_dpath, '**', '*.py')))
     config_fpaths = [p for p in config_fpaths if p.find('_base_') == -1]
     config_names = [relpath(p, config_dpath) for p in config_fpaths]
 
-    print('Using {} config files'.format(len(config_names)))
+    print(f'Using {len(config_names)} config files')
 
     for config_fname in config_names:
         config_fpath = join(config_dpath, config_fname)",The `!r` is unnecessary.,py,1,0,1
"@@ -154,13 +154,15 @@ class CustomWindow(AutoPropertyObject):
 	def _get__wClass(cls):
 		return WNDCLASSEXW(
 			cbSize=ctypes.sizeof(WNDCLASSEXW),
-			lpfnWndProc=cls._rawWindowProc,
+			lpfnWndProc=_rawWindowProc,
 			hInstance=appInstance,
 			lpszClassName=cls.className,
 		)
 
 	_abstract_className = True
 
+	className: str
+
 	@classmethod
 	def _get_className(cls) -> str:
 		""""""The class name of this window.""""""",I think the `cls.` part of this line suggests that this is intentional.,py,1,1,1
"@@ -135,7 +135,7 @@ class ResamplingOperation(Operation):
 
         xtype = 'numeric'
         if isinstance(xstart, datetime_types) or isinstance(xend, datetime_types):
-            xstart, xend = dt_to_int(xstart), dt_to_int(xend)
+            xstart, xend = dt_to_int(xstart, 'ns'), dt_to_int(xend, 'ns')
             xtype = 'datetime'
         elif not np.isfinite(xstart) and not np.isfinite(xend):
             if element.get_dimension_type(x) in datetime_types:","Wondering if life might be easier/ less error-prone if instead of ``dt_to_int(x, 'ns')`` and ``dt_to_int(x)`` you had two separate utilities: ``dt_to_ns`` and ``dt_to_us``...",py,1,1,1
"@@ -102,11 +102,14 @@ class TaskProcess(multiprocessing.Process):
         self.timeout_time = time.time() + worker_timeout if worker_timeout else None
 
     def _run_get_new_deps(self):
+        run_again = False
         try:
             task_gen = self.task.run(tracking_url_callback=self.tracking_url_callback)
         except TypeError as ex:
             if 'unexpected keyword argument' not in getattr(ex, 'message', ex.args[0]):
                 raise
+            run_again = True
+        if run_again:
             task_gen = self.task.run()
         if not isinstance(task_gen, types.GeneratorType):
             return None",what is this if statement - it's pretty horrible,py,1,0,1
"@@ -25,6 +25,9 @@ import logging
 
 import pytest
 import jinja2
+from helpers.utils import CallbackChecker
+from PyQt5.QtCore import QUrl
+from qutebrowser.utils.debug import qenum_key
 
 try:
     from PyQt5.QtWebKit import QWebSettings","Please also import the `utils` and `debug` modules here, and group the imports correctly.",py,1,1,1
"@@ -1,7 +1,9 @@
-_base_ = './faster_rcnn_r50_fpn_1x_coco.py'
+_base_ = './faster_rcnn_r50_caffe_fpn_mstrain_1x_coco.py'
 model = dict(roi_head=dict(bbox_head=dict(num_classes=1)))
 classes = ('person', )
 data = dict(
     train=dict(classes=classes),
     val=dict(classes=classes),
     test=dict(classes=classes))
+
+load_from = 'http://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_bbox_mAP-0.398_20200504_163323-30042637.pth'  # noqa",Rename the configs to be `faster_rcnn_r50_fpn_mstrain_1x_coco-person.py`,py,1,1,1
"@@ -119,11 +119,11 @@ class ActiveExecution:
             )
             if self._interrupted:
                 raise DagsterExecutionInterruptedError(
-                    f""Execution of pipeline was interrupted before completing the execution plan. {state_str}""
+                    f""Execution of job/pipeline was interrupted before completing the execution plan. {state_str}""
                 )
             else:
                 raise DagsterInvariantViolationError(
-                    f""Execution of pipeline finished without completing the execution plan. {state_str}""
+                    f""Execution of job/pipeline finished without completing the execution plan. {state_str}""
                 )
 
         # See verify_complete - steps for which we did not observe a failure/success event are in an unknown","even with `JobDefinition`, will we not know if it's a job or a pipeline?",py,1,1,1
"@@ -81,3 +81,12 @@ class APITimelineEvent(pydantic.BaseModel):
     user_name: str
     created: int
     metadata: APIEventMetadata
+
+class APIRecommendationNotificationTimelineEvent(pydantic.BaseModel):
+    # since `id` is not sent in APITimelineEvent
+    # this field is needed for deletion of Recommendation and Notification Events
+    id: int
+    event_type: UserTimelineEventType
+    user_name: str
+    created: int
+    metadata: APIEventMetadata","You can instead add the `id` field to APITimelineEvent. If all entities are not going to have it, you can make it as `id: Optional[int]`.",py,1,1,1
"@@ -2192,8 +2192,8 @@ defaultdict(<class 'list'>, {'col..., 'col...})]
         internal = self._internal.copy(sdf=sdf, data_columns=[c.name for c in applied])
         return DataFrame(internal)
 
-    # TODO: add axis parameter
-    def diff(self, periods=1):
+    # TODO: axis should support 1 or 'columns' either
+    def diff(self, periods: int = 1, axis: int = 0):
         """"""
         First discrete difference of element.
 ",At this moment?,py,0,0,0
"@@ -16,6 +16,8 @@ MAX_HEAP_SIZE = ""256m""
 # todo: will be replaced with plugin mechanism
 PROCESS_THREAD = None
 
+default_region = ""us-east-1""
+
 
 def get_command(backend_port):
     cmd = (",Let's better remove this and use `stepfunctions_listener.default_region` in line 30 below.. (We can fix this in a follow-up PR..),py,0,1,1
"@@ -32,6 +32,7 @@ import email.generator
 import email.encoders
 import email.mime.multipart
 import email.message
+from quopri import encodestring
 
 from PyQt5.QtCore import QUrl
 ","Please only import modules (i.e. `import quopri` and use `encodestring.quopri`), as this makes things much more readable IMHO.",py,1,1,1
"@@ -127,10 +127,14 @@ class RemoteFileSystem(luigi.target.FileSystem):
         return exists
 
     def _ftp_exists(self, path, mtime):
+        path_parts = path.split('/')
+        path = '/'.join(path_parts[:-1])
+        fn = path_parts[-1]
+
         files = self.conn.nlst(path)
 
         exists = False
-        if files:
+        if fn in files:
             if mtime:
                 mdtm = self.conn.sendcmd('MDTM ' + path)
                 modified = datetime.datetime.strptime(mdtm[4:], ""%Y%m%d%H%M%S"")",Does this assignment make sense?? You seem to overwrite it right afterwards in the loop no?,py,1,1,1
"@@ -44,7 +44,7 @@ public abstract class NewSessionQueue implements HasReadyState {
 
   public abstract boolean offerFirst(HttpRequest request, RequestId requestId);
 
-  public abstract Optional<HttpRequest> poll();
+  public abstract Optional<HttpRequest> poll(RequestId requestId);
 
   public abstract int clear();
 ","The expected behaviour for `poll` would be to match what `Deque` does, which is: > Retrieves and removes the head of the queue represented by this deque As such, you shouldn't need the `RequestId` here.",py,1,1,1
"@@ -42,7 +42,7 @@ extras_require[""examples""] = extras_require[""recommended""] + [
     ""ffmpeg"",
     ""cftime"",
     ""netcdf4"",
-    ""dask"",
+    ""dask<=2020.12.0"",
     ""scipy"",
     ""shapely"",
     ""scikit-image""","Ideally we'd fix the regression in a separate PR, rather than pin this here.",py,0,1,1
"@@ -76,7 +76,7 @@ public class TestEdgeDriver extends RemoteWebDriver implements WebStorage, Locat
                 .findFirst().orElseThrow(WebDriverException::new);
 
         service = (EdgeDriverService) builder.withVerbose(true).withLogFile(logFile.toFile()).build();
-        LOG.info(""edgedriver will log to "" + logFile);
+        LOG.fine(""edgedriver will log to "" + logFile);
         service.start();
         Runtime.getRuntime().addShutdownHook(new Thread(() -> service.stop()));
       }",This is deliberately at this level.,py,1,0,1
"@@ -264,6 +264,16 @@ class BuildTest(QuiltTestCase):
         with assertRaisesRegex(self, build.BuildException, r'Bad yaml syntax.*build_bad_syntax\.yml'):
             build.build_package(None, 'test_syntax_error', PACKAGE, path)
 
+    def test_build_no_contents_node(self):
+        """"""
+        Attempt to build a yml file without contents node nor packages
+        """"""
+        mydir = os.path.dirname(__file__)
+        path = os.path.join(mydir, './build_no_contents_node.yml')
+
+        with assertRaisesRegex(self, build.BuildException, r'Error in build_no_contents_node.yml'):
+            build.build_package(None, 'no_contents', PACKAGE, path)
+
     def test_build_checks_yaml_syntax_error(self):    # pylint: disable=C0103
         """"""
         Attempt to build a yml file with a syntax error",Docstring inaccurate: You tested 'packages' elsewhere,py,1,1,1
"@@ -104,7 +104,7 @@ def check_for_software_updates(flash_message=False):
     :return: True if you have latest version, else False if you need to upgrade
              or None if server was not reachable.
     """"""
-    from invenio.config import CFG_VERSION
+    from invenio.version import __version__ as invenio_version
     from invenio.base.i18n import _
     try:
         find = re.compile('Invenio v[0-9]+.[0-9]+.[0-9]+(\-rc[0-9])?'",we can use `invenio.version` instead,py,1,0,1
"@@ -144,7 +144,9 @@ def _process_recommendations(recommendations, count, artist_type, user_name, off
         err_msg = 'No recommendations for user {}, please try again later.'.format(user_name)
         raise APINoContent(err_msg, payload={'last_updated': int(getattr(recommendations, 'created').timestamp())})
 
-    count = min(count, MAX_ITEMS_PER_GET)
+    # For the purpose of experimenting with recommendations, we're allowing to fetch at most
+    # 1K recommendations.
+    count = min(count, 1000)
 
     return mbid_list[offset:offset+count], total_mbid_count
 ","This should really be a defined constant, tied the number of recommendations we generate. For expediency sake, maybe open a ticket for improving that so we can merge this faster?",py,1,1,1
"@@ -987,6 +987,7 @@ class BrowseModeDocumentTextInfo(textInfos.TextInfo):
 
 	def getControlFieldSpeech(self, attrs, ancestorAttrs, fieldType, formatConfig=None, extraDetail=False, reason=None):
 		textList = []
+		role=attrs.get('role')
 		landmark = attrs.get(""landmark"")
 		if formatConfig[""reportLandmarks""] and fieldType == ""start_addedToControlFieldStack"" and landmark:
 			try:",This line is no longer necessary.,py,1,0,1
"@@ -262,6 +262,19 @@ def define_model(model_name, dbengine, model_seed):
                primary_key=True),
     )
 
+    groups_settings = Table(
+        '{}_groups_settings'.format(model_name),
+        base.metadata,
+        Column('group_name',
+               ForeignKey('{}.name'.format(members_tablename)),
+               primary_key=True),
+        Column('settings',
+               Text(16777215)),
+    )
+
+
+
+
     def get_string_by_dialect(db_dialect, column_size):
         """"""Get Sqlalchemy String by dialect.
         Sqlite doesn't support collation type, need to define different",@blueandgold I'm still somewhat unfamiliar with the model stuff and want to confirm that Im not missing anything I need here. For instance I probably need bindings or queries? Lets chat tomorrow,py,0,0,1
"@@ -103,7 +103,11 @@ class Message(serializable.Serializable):
         ce = self.headers.get(""content-encoding"")
         if ce:
             try:
-                return encoding.decode(self.raw_content, ce)
+                content = encoding.decode(self.raw_content, ce)
+                # A client may illegally specify a byte -> str encoding here (e.g. utf8)
+                if isinstance(content, str):
+                    raise ValueError(""Invalid Content-Encoding: {}"".format(ce))
+                return content
             except ValueError:
                 if strict:
                     raise","If it is a client, shouldn't we raise a ProtocolException or something similar?",py,1,1,1
"@@ -0,0 +1,19 @@
+from flask import Blueprint
+from werkzeug.exceptions import NotFound
+
+
+# Blueprint to contain the view that returns 404 if API calls are made to
+# the web app instead of the api flask application
+api_404_bp = Blueprint('api_404', __name__)
+
+
+@api_404_bp.route('/1/submit_listens', methods=['GET', 'POST'])
+@api_404_bp.route('/1/user/<user_name>/listens', methods=['GET'])
+@api_404_bp.route('/2.0/', methods=['GET', 'POST'])
+@api_404_bp.route('/api/auth/', methods=['GET', 'POST'])
+def webapp_api_call(user_name=None):
+    """"""
+    This route is used to raise 404s when api calls are made to the webapp
+    instead of the api.
+    """"""
+    raise NotFound(""Incorrect address used in call to API, please use api.listenbrainz.org instead."")","The body of this message should be JSON, in the same format as other error messages sent by the API.",py,1,1,1
"@@ -124,7 +124,7 @@ def range(start: int,
 
 
 def read_csv(path, header='infer', names=None, usecols=None,
-             mangle_dupe_cols=True, parse_dates=False, comment=None):
+             mangle_dupe_cols=True, parse_dates=False, comment=None, index_col=None):
     """"""Read CSV (comma-separated) file into DataFrame.
 
     Parameters",We should put the `index_col` argument betwen `names` and `usecols` to follow pandas'?,py,1,1,1
"@@ -48,9 +48,8 @@ class TestFileCompletion:
         return _get_prompt_func
 
     @pytest.mark.parametrize('steps, where, subfolder', [
-        (1, 'next', '..'),
-        (1, 'prev', 'c'),
-        (2, 'next', 'a'),
+        (1, 'next', 'a'),
+        (2, 'next', 'b'),
         (2, 'prev', 'b'),
     ])
     def test_simple_completion(self, tmp_path, get_prompt, steps, where,",You can leave this one as it still should work. Going to the previous item once still falls in `c`.,py,1,1,1
"@@ -44,6 +44,12 @@ from luigi.cmdline_parser import CmdlineParser
 _no_value = object()
 
 
+class ParameterVisibility(object):
+    PUBLIC = 0
+    HIDDEN = 1
+    PRIVATE = 2
+
+
 class ParameterException(Exception):
     """"""
     Base exception.",You can use the enum class that's built into python. (there's a 2.7 backport we're already using),py,1,1,1
"@@ -853,7 +853,11 @@ class UIA(Window):
 		# Windows 8.x toast, although a form of tool tip, is covered separately.
 		elif UIAControlType==UIAHandler.UIA_ToolTipControlTypeId:
 			clsList.append(ToolTip)
-		elif self.UIAElement.cachedFrameworkID in (""InternetExplorer"",""MicrosoftEdge""):
+		elif(
+			self.UIAElement.cachedFrameworkID in (""InternetExplorer"", ""MicrosoftEdge"")
+			# But not for Internet Explorer
+			and not self.appModule.appName == 'iexplore'
+		):
 			from . import edge
 			if UIAClassName in (""Internet Explorer_Server"",""WebView"") and self.role==controlTypes.ROLE_PANE:
 				clsList.append(edge.EdgeHTMLRootContainer)","I'm pretty confident that Internet Explorer can be removed here, as that would only be true for the mshtml implementation, not edgeHTML. And, we would want this fix for any mshtml embedding, not just the Internet Explorer application.",py,1,1,1
"@@ -131,7 +131,12 @@ def create_full_filename(basename, filename):
     encoding = sys.getfilesystemencoding()
     filename = utils.force_encoding(filename, encoding)
     basename = utils.force_encoding(basename, encoding)
-    if os.path.isabs(filename) and os.path.isdir(filename):
+
+    if filename.endswith('/'):
+        # The path is a directory we want to store the file in (rather than the
+        # path *to* the file).
+        return os.path.join(filename, basename)
+    elif os.path.isabs(filename) and os.path.isdir(filename):
         # We got an absolute directory from the user, so we save it under
         # the default filename in that directory.
         return os.path.join(filename, basename)",Shouldn't this be `os.sep` so it works on Windows with `\` too?,py,1,1,1
"@@ -517,8 +517,8 @@ class VoiceSettingsDialog(SettingsDialog):
 		# Translators: This is a label for a setting in voice settings (an edit box to change voice pitch for capital letters; the higher the value, the pitch will be higher).
 		capPitchChangeLabel=wx.StaticText(self,-1,label=_(""Capital pitch change percentage""))
 		settingsSizer.Add(capPitchChangeLabel)
-		self.capPitchChangeEdit=wx.TextCtrl(self,wx.NewId())
-		self.capPitchChangeEdit.SetValue(str(config.conf[""speech""][getSynth().name][""capPitchChange""]))
+		self.capPitchChangeEdit=wx.SpinCtrl(self, min=0, max=100,
+			initial=config.conf[""speech""][getSynth().name][""capPitchChange""])
 		settingsSizer.Add(self.capPitchChangeEdit,border=10,flag=wx.BOTTOM)
 		# Translators: This is the label for a checkbox in the
 		# voice settings dialog.","The minimum here is -100, not 0. (The value is relative, not multiplicative.) Do these controls support negative values?",py,1,1,1
"@@ -162,9 +162,9 @@ class FCOSHead(nn.Module):
         pos_bbox_preds = flatten_bbox_preds[pos_inds]
         pos_bbox_targets = flatten_bbox_targets[pos_inds]
         pos_centerness = flatten_centerness[pos_inds]
-        pos_centerness_targets = self.centerness_target(pos_bbox_targets)
 
         if num_pos > 0:
+            pos_centerness_targets = self.centerness_target(pos_bbox_targets)
             pos_points = flatten_points[pos_inds]
             pos_decoded_bbox_preds = distance2bbox(pos_points, pos_bbox_preds)
             pos_decoded_target_preds = distance2bbox(pos_points,",We can also move `pos_bbox_targets = flatten_bbox_targets[pos_inds]` to here.,py,1,1,1
"@@ -971,7 +971,7 @@ class _tls_sessions(object):
                 if len(sid) > 12:
                     sid = sid[:11] + ""...""
                 res.append((src, dst, sid))
-        colwidth = map(lambda x: max(map(lambda y: len(y), x)), apply(zip, res))
+        colwidth = [max([len(y) for y in x]) for x in zip(*res)]
         fmt = ""  "".join(map(lambda x: ""%%-%ds""%x, colwidth))
         return ""\n"".join(map(lambda x: fmt % x, res))
 ",Use a generator () instead of [],py,1,0,1
"@@ -231,6 +231,14 @@ def file(recid, filename):
             return send_file(file_, mimetype='application/octet-stream',
                              attachment_filename=filename)
         return send_file(document['uri'])
+
+    from invenio.modules.documents.utils import _get_legacy_bibdocs
+    for fullpath, permission in _get_legacy_bibdocs(recid, filename=filename):
+        if not permission:
+            error = 401
+            continue
+        return send_file(fullpath)
+
     abort(error)
 
 ",Why the previous lines are reading the whole file into memory :scream: ?,py,1,1,1
"@@ -717,7 +717,8 @@ class UserResource(object):
 
         :raises: :class:`pyramid.httpexceptions.HTTPBadRequest`
         """"""
-        if not self.model.id_generator.match(six.text_type(record_id)):
+        is_string = isinstance(record_id, six.text_type)
+        if not is_string or not self.model.id_generator.match(record_id):
             error_details = {
                 'location': 'path',
                 'description': ""Invalid record id""",I think the right fix would be to convert the id as a string rather than raising an error.,py,1,1,1
"@@ -108,8 +108,9 @@ class TestCloudFormationCreateStack(CloudFormationConnectionBase):
 
     def test_create_stack_fails(self):
         self.set_http_response(status_code=400, reason='Bad Request',
-                               body='Invalid arg.')
-        with self.assertRaises(self.service_connection.ResponseError):
+            body='{""Error"": {""Code"": 1, ""Message"": ""Invalid arg.""}}')
+        with self.assertRaisesRegexp(self.service_connection.ResponseError,
+            'Invalid arg.'):
             api_response = self.service_connection.create_stack(
                 'stack_name', template_body=SAMPLE_TEMPLATE,
                 parameters=[('KeyName', 'myKeyName')])",This probably needs more tests that just this modified one. How about a test that validates the parsed attributes of the exception given a JSON error message?,py,1,1,1
"@@ -49,7 +49,8 @@ class FCOSHead(nn.Module):
                      use_sigmoid=True,
                      loss_weight=1.0),
                  conv_cfg=None,
-                 norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)):
+                 norm_cfg=dict(type='GN', num_groups=32, requires_grad=True),
+                 center_sample_radius=0):  # 0 for disable `center sampling`
         super(FCOSHead, self).__init__()
 
         self.num_classes = num_classes",This is somewhat misleading. It may be better to add a parameter `center_sampling` to indicate whether or not using center sampling.,py,1,1,1
"@@ -424,6 +424,17 @@ public class NodeTest {
     return baseDir;
   }
 
+  //Test that the draining command sets Host status to DRAINING
+  @Test
+  public void drainingNodeStatusDraining() {
+
+  }
+
+  //Test that a draining node doesn't accept new sessions by any means
+  //Test that a draining node continues to run its sessions and accept new WebDriver commands
+  //Test that a node will shut down once all sessions are finished
+  //Test that RemoteNode will post the correct command oto the LocalNode
+
   private CreateSessionRequest createSessionRequest(Capabilities caps) {
     return new CreateSessionRequest(
             ImmutableSet.copyOf(Dialect.values()),",Is this only to set the node to draining?   I think we can do that inside `Before` or something?,py,1,1,1
"@@ -73,11 +73,8 @@ class ConsistentHashRing:
 
   def compute_ring_position(self, key):
     if self.hash_type == 'fnv1a_ch':
-      big_hash = '{:x}'.format(int(fnv32a( str(key) )))
-      if len(big_hash) > 4:
-          small_hash = int(big_hash[:4], 16) ^ int(big_hash[4:], 16)
-      else:
-          small_hash = int(big_hash, 16)
+      big_hash = int(fnv32a(str(key)))
+      small_hash = (big_hash >> 16) ^ (big_hash & 0xffff)
     else:
       big_hash = compactHash(str(key))
       small_hash = int(big_hash[:4], 16)","I see that here we don't have the same python version check as in carbon, we should make them consistent. The best solution may be to use `big_hash = int(fnv32a(six.binary_type(key)))` for both 2.x and 3.x.",py,1,1,1
"@@ -1,8 +1,10 @@
 import uuid
 import time
+import sys
 from collections import deque
 
 import param
+from unittest import SkipTest
 import numpy as np
 from holoviews import Dimension, NdLayout, GridSpace, Layout, NdOverlay
 from holoviews.core.spaces import DynamicMap, HoloMap, Callable",Don't want to be too much of a stickler but imports are generally organized by stdlib then external libraries.,py,1,1,1
"@@ -400,7 +400,7 @@ class HadoopJobRunner(JobRunner):
 
     def __init__(self, streaming_jar, modules=None, streaming_args=None,
                  libjars=None, libjars_in_hdfs=None, jobconfs=None,
-                 input_format=None, output_format=None,
+                 archives=None, input_format=None, output_format=None,
                  end_job_with_atomic_move_dir=True):
         def get(x, default):
             return x is not None and x or default",Why not add as last argument?,py,1,0,1
"@@ -138,6 +138,8 @@ class Register(abc.ABCMeta):
         return global_params.iteritems()
 
 
+_event_callbacks = {}
+
 class Task(object):
     __metaclass__ = Register
 ",I think this should go into the Task class.,py,1,0,1
"@@ -33,6 +33,7 @@ class RouteTable(TaggedEC2Object):
         self.id = None
         self.vpc_id = None
         self.routes = []
+        self.propagatingvgws = []
         self.associations = []
 
     def __repr__(self):",Any reason this is not `propagating_vgws` instead of all one word?,py,1,1,1
"@@ -148,10 +148,10 @@ def dynamize_value(val):
 if six.PY2:
     class Binary(object):
         def __init__(self, value):
-            if isinstance(value, six.text_type):  # Support only PY2 for backward compatibility.
-                value = value.encode('utf-8')
-            elif not isinstance(value, bytes):
+            if not isinstance(value, (bytes, six.text_type)):
                 raise TypeError('Value must be a string of binary data!')
+            if not isinstance(value, bytes):
+                value = value.encode(""utf-8"")
 
             self.value = value
 ",I believe that `unicode` should still be encoded to UTF-8. The internal representation (`value`) of the `Binary` class should always be `bytes`.,py,1,1,1
"@@ -27,7 +27,13 @@ MeshType = itk.Mesh[PixelType, Dimension]
 mesh = MeshType.New()
 
 # Create Vector Container and Store values in it for each Point
-v = itk.VectorContainer[itk.UL, PixelType].New()
+# For windows use itk.ULL
+if hasattr(itk.VectorContainer, 'ULAD'):
+    IdentifierType = itk.UL
+else:
+    IdentifierType = itk.ULL
+
+v = itk.VectorContainer[IdentifierType, PixelType].New()
 v.Reserve(NumberOfPoints)
 
 for i in range(NumberOfPoints):","A generic way to check for Windows is `if os.name == 'nt'`. But if the one you wrote here works, we should keep it.",py,1,1,1
"@@ -345,7 +345,7 @@ class GFLHead(AnchorHead):
          bbox_weights_list, num_total_pos, num_total_neg) = cls_reg_targets
 
         num_total_samples = reduce_mean(
-            torch.tensor(num_total_pos).cuda()).item()
+            torch.tensor(num_total_pos).float().cuda()).item()
         num_total_samples = max(num_total_samples, 1.0)
 
         losses_cls, losses_bbox, losses_dfl,\","`torch.tensor(num_total_pos, dtype=torch.float, device=device)`",py,1,0,0
"@@ -11,6 +11,8 @@ from .transforms import (ImageTransform, BboxTransform, MaskTransform,
 from .utils import to_tensor, random_scale
 from .extra_aug import ExtraAugmentation
 
+from imagecorruptions import corrupt
+
 
 @DATASETS.register_module
 class CustomDataset(Dataset):",Third-party imports may be moved before relative imports.,py,1,1,1
"@@ -111,8 +111,8 @@ def hierarchical(keys):
     ndims = len(keys[0])
     if ndims <= 1:
         return True
-    dim_vals = zip(*keys)
-    combinations = (zip(*dim_vals[i:i+2])
+    dim_vals = list(zip(*keys))
+    combinations = (list(zip(*dim_vals[i:i+2]))
                     for i in range(ndims-1))
     hierarchies = []
     for combination in combinations:",Is the second list needed here? Seems like `combination` in the nested for loop below is only used as an iterator.,py,1,1,1
"@@ -656,7 +656,13 @@ class TabbedBrowser(tabwidget.TabWidget):
             key: mark identifier; capital indicates a global mark
         """"""
         # strip the fragment as it may interfere with scrolling
-        url = self.current_url().adjusted(QUrl.RemoveFragment)
+        try:
+            url = self.current_url().adjusted(QUrl.RemoveFragment)
+        except qtutils.QtValueError:
+            # show an error only if the mark is not automatically set
+            if key != ""'"":
+                message.error(self._win_id, ""Failed to set mark: url invalid"")
+            return
         point = self.currentWidget().page().currentFrame().scrollPosition()
 
         if key.isupper():","Never use a bare `except:`, that'd catch any exception (even a typo somewhere, for example). This should be `except qtutils.QtValueError:` instead.",py,1,1,1
"@@ -47,6 +47,9 @@ def molecule_provisioner_section_data():
                 'instance-1': [{
                     'foo': 'bar'
                 }],
+                'localhost': [{
+                    'foo': 'baz'
+                }]
             },
             'group_vars': {
                 'example_group1': [{",This and line 156 below adds coverage for the special case of localhost host_vars,py,0,0,1
"@@ -42,11 +42,12 @@ class TestProcessProxyOptions:
         assert self.p()
 
     def test_certs(self, tdata):
-        self.assert_noerr(
-            ""--cert"",
-            tdata.path(""mitmproxy/data/testkey.pem""))
-        with pytest.raises(Exception, match=""does not exist""):
-            self.p(""--cert"", ""nonexistent"")
+        with pytest.raises(Exception, match=""ambiguous option""):
+            self.assert_noerr(
+                ""--cert"",
+                tdata.path(""mitmproxy/data/testkey.pem""))
+            with pytest.raises(Exception, match=""does not exist""):
+                self.p(""--cert"", ""nonexistent"")
 
 
 class TestProxyServer:",Is this change intentional? The double-indented `.raises` doesn't make much sense to me.,py,1,1,1
"@@ -926,9 +926,12 @@ a metaclass class method."",
                     continue
                 if isinstance(attribute.expr, nodes.Name) and attribute.expr.name in (
                     ""self"",
+                    ""cls"",
                     node.name,
                 ):
-                    # self.__attrname / node_name.__attrname
+                    # self.__attrname
+                    # cls.__attrname
+                    # node_name.__attrname
                     break
                 if isinstance(attribute.expr, nodes.Call):
                     # type(self).__attrname","I think we already fixed something really similar in another MR, we have a duplication between this and ``child.expr.name in (""self"", ""cls"", node.name)`` line 969/972.",py,1,1,1
"@@ -63,7 +63,7 @@ def configdata_init(monkeypatch):
 class TestEarlyInit:
 
     def test_config_py_path(self, args, init_patch, config_py_arg):
-        config_py_arg.write('c.colors.hints.bg = ""red""\n')
+        config_py_arg.write('config.load_autoconfig()\nc.colors.hints.bg = ""red""\n')
         configinit.early_init(args)
         expected = 'colors.hints.bg = red'
         assert config.instance.dump_userconfig() == expected",I'd prefer using `'\n'.join` here as well to make it a bit more readable (and consistent).,py,1,1,1
"@@ -44,9 +44,9 @@ class Model(object):
   def __init__(self, inferenceType):
     """""" Model constructor.
 
-    Args:
-      inferenceType: An opfutils.InferenceType value that specifies the type
+      @param inferenceType: An opfutils.InferenceType value that specifies the type
           of inference (i.e. TemporalNextStep, Classification, etc.).
+      @param header format of data going into the model, from nupic.data.file_record_stream.py
     """"""
     self._numPredictions = 0
     self.__inferenceType =  inferenceType",This function doesn't take a `header` parameter...,py,1,1,1
"@@ -125,6 +125,18 @@ class Index(IndexOpsMixin):
         """""" Returns the data type as defined by Spark, as a Spark DataType object.""""""
         return self.to_series().spark_type
 
+    @property
+    def has_duplicates(self) -> bool:
+        """"""
+        If index has duplicates, return True, otherwise False.
+        """"""
+        idx_column = self._kdf._sdf.select(self._scol)
+        deduplicate_idx_column = idx_column.drop_duplicates()
+
+        if idx_column.count() == deduplicate_idx_column.count():
+            return False
+        return True
+
     @property
     def name(self) -> Union[str, Tuple[str, ...]]:
         """"""Return name of the Index.""""""",This runs Spark jobs twice. Can we use `F.count` and `F.countDistinct` instead?,py,1,1,1
"@@ -29,6 +29,7 @@ class _ResourceEvent:
         self.request = request
 
     def __repr__(self):
+        # Not sure what proper conversion to fstring is
         return ""<{klass} action={action} uri={uri}>"".format(
             klass=self.__class__.__name__, **self.payload
         )",This is probably better to leave it with format(),py,1,1,1
"@@ -37,6 +37,15 @@ class MonitorMixinBase(object):
 
 
   def __init__(self, *args, **kwargs):
+    """"""
+    Note: If you set the kwarg ""__name__"", then pretty-printing of traces and
+          metrics will include the name you specify as a tag before every title.
+    """"""
+    self.name = None
+    if ""__name__"" in kwargs:
+      self.name = kwargs[""__name__""]
+      del kwargs[""__name__""]
+
     super(MonitorMixinBase, self).__init__(*args, **kwargs)
 
     # Mapping from key (string) => trace (Trace)",It would be better if this kwarg had some unique prefix rather than following this pattern.,py,1,1,1
"@@ -220,6 +220,12 @@ _options = [
             ""'plotting.sample_ratio' should be 1.0 >= value >= 0.0."",
         ),
     ),
+    Option(
+        key=""plotting.backend"",
+        doc=(""Backend to use for plotting. Default is matplotlib.""),
+        default=""matplotlib"",
+        types=str,
+    ),
 ]  # type: List[Option]
 
 _options_dict = dict(zip((option.key for option in _options), _options))  # type: Dict[str, Option]",Could you add a list of currently supported backends?,py,1,0,1
"@@ -76,7 +76,7 @@ public class ProtocolHandshake {
 
         if (result.isPresent()) {
           Result toReturn = result.get();
-          LOG.info(String.format(""Detected dialect: %s"", toReturn.dialect));
+          LOG.finest(String.format(""Detected dialect: %s"", toReturn.dialect));
           return toReturn;
         }
       }",This is an incorrect change. The dialect spoken is an important part of the handshake and should be communicated to users.,py,1,1,1
"@@ -582,7 +582,7 @@ public class DistributorTest {
         );
 
         Session firefoxSession = distributor.newSession(createRequest(firefoxPayload)).getSession();
-        LOG.info(String.format(""Firefox Session %d assigned to %s"", i, chromeSession.getUri()));
+        LOG.finer(String.format(""Firefox Session %d assigned to %s"", i, chromeSession.getUri()));
 
         boolean inFirefoxNodes = firefoxNodes.stream().anyMatch(node -> node.getUri().equals(firefoxSession.getUri()));
         boolean inChromeNodes = chromeNodes.stream().anyMatch(node -> node.getUri().equals(chromeSession.getUri()));","Since this is in a test, I imagine that the choice of `info` level was deliberate.",py,1,1,1
"@@ -3419,7 +3419,15 @@ class Elfcar(VolumetricData):
             poscar (Poscar): Poscar object containing structure.
             data: Actual data.
         """"""
-        super().__init__(poscar.structure, data)
+        # allow for poscar or structure files to be passed
+        if isinstance(poscar, Poscar):
+            tmp_struct = poscar.structure
+            self.poscar = poscar
+        elif isinstance(poscar, Structure):
+            tmp_struct = poscar
+            self.poscar = Poscar(poscar)
+
+        super().__init__(tmp_struct, data)
         # TODO: modify VolumetricData so that the correct keys can be used.
         # for ELF, instead of ""total"" and ""diff"" keys we have
         # ""Spin.up"" and ""Spin.down"" keys",Can you modify the docstring to reflect the fact that you can also pass a `Structure` ?,py,1,1,1
"@@ -167,7 +167,7 @@ class View(collections.abc.Sequence):
 
     def load(self, loader):
         loader.add_option(
-            ""view_filter"", typing.Optional[str], None,
+            ""view_filter"", typing.Optional[str], """",
             ""Limit the view to matching flows.""
         )
         loader.add_option(",Is there a reason why you changed the default?,py,1,1,1
"@@ -56,6 +56,19 @@ def setup_json_serializer(config):
     config.add_renderer(""json"", renderer)
 
 
+def setup_csp_headers(config):
+    """"""Content-Security-Policy HTTP response header helps reduce XSS risks on
+    modern browsers by declaring, which dynamic resources are allowed to load.
+    On APIs, we disable everything.
+    """"""
+    disable_all = ""default-src 'none'; "" ""frame-ancestors 'none'; "" ""base-uri 'none'; ""
+
+    def on_new_response(event):
+        event.response.headers.setdefault(""Content-Security-Policy"", disable_all)
+
+    config.add_subscriber(on_new_response, NewResponse)
+
+
 def setup_version_redirection(config):
     """"""Add a view which redirects to the current version of the API.
     """"""","Why not just `""default-src 'none'; frame-ancestors 'none'; base-uri 'none';""`? Why the trailing space in the string?",py,1,1,1
"@@ -6,6 +6,10 @@ from kinto.core.schema import (Any, HeaderField, QueryField, HeaderQuotedInteger
                                FieldList, TimeStamp, URL)
 from kinto.core.utils import native_value
 
+POSTGRESQL_MAX_INTEGER_VALUE = 2**64 / 2
+
+POSITIVE_BIG_INTEGER = colander.Range(min=0, max=POSTGRESQL_MAX_INTEGER_VALUE)
+
 
 class TimeStamp(TimeStamp):
     """"""This schema is deprecated, you shoud use `kinto.core.schema.TimeStamp` instead.""""""","In other parts of code we used lowercase for validators, but anything is fine, i guess.",py,1,1,1
"@@ -50,7 +50,9 @@ class SnakebiteHdfsClient(hdfs_abstract_client.HdfsFileSystem):
     def list_path(path):
         if isinstance(path, list) or isinstance(path, tuple):
             return path
-        if isinstance(path, str) or isinstance(path, unicode):
+        # TODO: Should this be:
+        # isinstance(path, (six.text_type, six.binary_type))?
+        if isinstance(path, six.string_types):
             return [path, ]
         return [str(path), ]
 ",Do you know the answer to the TODO @gpoulin ?,py,0,0,1
"@@ -108,7 +108,11 @@ class NdWidget(param.Parameterized):
         super(NdWidget, self).__init__(**params)
         self.id = plot.comm.target if plot.comm else uuid.uuid4().hex
         self.plot = plot
-        self.dimensions, self.keys = drop_streams(plot.streams,
+        streams = []
+        for stream in plot.streams:
+            if any(k in plot.dimensions for k in stream.contents):
+                streams.append(stream)
+        self.dimensions, self.keys = drop_streams(streams,
                                                   plot.dimensions,
                                                   plot.keys)
 ",I assume this bit is simply a bug fix and otherwise unrelated?,py,0,0,1
"@@ -181,6 +181,7 @@ def do_register_localstack_plugins():
             listener=stepfunctions_listener.UPDATE_STEPFUNCTIONS))
 
     except Exception as e:
+        print('exception', e)
         if not os.environ.get(ENV_SCRIPT_STARTING_DOCKER):
             print('Unable to register plugins: %s' % e)
             sys.stdout.flush()",Let's remove this `print` please.,py,1,0,1
"@@ -660,7 +660,7 @@ class CaiTemporaryStore(object):
             return '/'.join(asset_pb.name.split('/')[:-4])
 
         elif (asset_pb.asset_type.startswith('google.appengine') or
-              asset_pb.asset_type.startswith('google.bigquery') or
+              asset_pb.asset_type.startswith('google.cloud.bigquery') or
               asset_pb.asset_type.startswith('google.spanner') or
               asset_pb.asset_type.startswith('google.cloud.kms')):
             # Strip off the last two segments of the name to get the parent",Minor nit: Can we make these alphabetical?,py,1,1,1
"@@ -49,7 +49,7 @@ class BuildTest(QuiltTestCase):
 
         # Verify cache contents
         srcpath = os.path.join(mydir, 'data/10KRows13Cols.csv')
-        path_hash = build._path_hash(srcpath, 'csv', {})
+        path_hash = build._path_hash(srcpath, 'csv',  {'parse_dates': ['Date0']})
         assert os.path.exists(teststore.cache_path(path_hash))
         
         # Build again using the cache",this works but it's super fragile; @kevinemoore can you get this info from build.yml? other unit tests will need the logic.,py,0,1,1
"@@ -236,6 +236,7 @@ class dim(object):
     # Unary operators
     def __neg__(self): return dim(self, operator.neg)
     def __not__(self): return dim(self, operator.not_)
+    def __invert__(self): return dim(self, operator.inv)
     def __pos__(self): return dim(self, operator.pos)
 
     # Binary operators",Thanks. Are there any other operators missing?,py,1,1,1
"@@ -152,4 +152,11 @@ class RPN(BaseDetector):
         Returns:
             np.ndarray: The image with bboxes drawn on it.
         """"""
+        if kwargs is not None:
+            if 'score_thr' in kwargs:
+                kwargs.pop('score_thr')
+            if 'text_color' in kwargs:
+                kwargs.pop('text_color')
+            if 'bbox_color' in kwargs:
+                kwargs['colors'] = kwargs.pop('bbox_color')
         mmcv.imshow_bboxes(data, result, top_k=top_k, **kwargs)","can we simply use kwargs.pop('score_thr', None) ?",py,1,1,1
"@@ -39,6 +39,7 @@ with open('README.rst') as fobj:
 install_requires = [
     'tornado>=4.0,<5',
     'python-daemon<3.0',
+    'toml',
 ]
 
 if os.environ.get('READTHEDOCS', None) == 'True':",No version specification?,py,1,0,1
"@@ -11,6 +11,13 @@ from .custom import CustomDataset
 
 @DATASETS.register_module()
 class XMLDataset(CustomDataset):
+    """"""XML dataset for detection.
+
+    Args:
+        min_size (int|float|None, optional): The minimum size of bounding
+            boxes in the images. If the size of a bounding box is less than
+            ``min_size``, it would be add to ignored field.
+    """"""
 
     def __init__(self, min_size=None, **kwargs):
         super(XMLDataset, self).__init__(**kwargs)","`int | float | None` or `int | float, optional`",py,1,0,0
"@@ -65,7 +65,7 @@ def safePow(a, b):
   if b is None: return None
   try:
     result = math.pow(a, b)
-  except ValueError:
+  except:
     return None
   return result
 ",Would be very nice if you can preserve this part.,py,1,0,1
"@@ -106,9 +106,12 @@ def get_listens(user_name):
     if time_range < 1 or time_range > MAX_TIME_RANGE:
         log_raise_400(""time_range must be between 1 and %d."" % MAX_TIME_RANGE)
 
-    # if no max given, use now()
     if max_ts and min_ts:
-        log_raise_400(""You may only specify max_ts or min_ts, not both."")
+        if max_ts < min_ts:
+            log_raise_400(""max_ts should be greater than min_ts"")
+        
+        if (max_ts - min_ts) > MAX_TIME_RANGE * 432000:
+            log_raise_400(""time_range specified by min_ts and max_ts should be less than %d."" % MAX_TIME_RANGE)
 
     db_conn = webserver.create_timescale(current_app)
     (min_ts_per_user, max_ts_per_user) = db_conn.get_timestamps_for_user(user_name)","what does this number mean? Is it number of seconds in a day? If so, it'd be good to add a constant at the beginning of the file with a name that describes its purpose.",py,1,1,1
"@@ -0,0 +1,6 @@
+from dagster import graph
+
+
+@graph
+def graph_one():
+    pass",Nitpick: include newline at end of file.,py,1,1,1
"@@ -368,7 +368,7 @@ class CenterNetHead(BaseDenseHead, BBoxTestMixin):
         if labels.numel() == 0:
             return bboxes, labels
 
-        out_bboxes, keep = batched_nms(bboxes[:, :4], bboxes[:, -1], labels,
+        out_bboxes, keep = batched_nms(bboxes[:, :4], bboxes[:, -1].contiguous(), labels,
                                        cfg.nms_cfg)
         out_labels = labels[keep]
 ","To be on the safe side, it is best to add contiguous to bboxes.",py,1,1,1
"@@ -45,7 +45,8 @@ public class Grid {
 
   public List<Node> getNodes() {
     return distributorStatus.get().getNodes().stream()
-      .map(summary -> new Node(summary.getNodeId(), summary.getUri(), summary.isUp(), summary.getMaxSessionCount()))
+      .map(summary -> new Node(summary.getNodeId(), summary.getUri(), summary.isUp(),
+                               summary.getMaxSessionCount(), summary.getStereotypes()))
       .collect(ImmutableList.toImmutableList());
   }
 ",Break things on to one parameter per line now.,py,1,1,1
"@@ -58,8 +58,9 @@ class DeltaXYWHBBoxCoder(BaseBBoxCoder):
         """"""Apply transformation `pred_bboxes` to `boxes`.
 
         Args:
-            boxes (torch.Tensor): Basic boxes.
-            pred_bboxes (torch.Tensor): Encoded boxes with shape
+            bboxes (torch.Tensor): Basic boxes. Shape (B, N, 4) or (N, 4)
+            pred_bboxes (torch.Tensor): Encoded boxes with
+               shape (B, N, 4) or (N, 4)
             max_shape (tuple[int], optional): Maximum shape of boxes.
                 Defaults to None.
             wh_ratio_clip (float, optional): The allowed ratio between",max_shape may be tuple[tuple],py,1,0,1
"@@ -1,10 +1,13 @@
 import logging
 import sqlalchemy
 import uuid
+import json
 
 from datetime import datetime
 from listenbrainz import db
 from listenbrainz.db.exceptions import DatabaseException
+from data.model.similar_user_model import SimilarUserRecord, SimilarUsers
+from typing import Tuple, List
 
 
 logger = logging.getLogger(__name__)",lets try to use ujson for speed,py,1,1,1
"@@ -443,6 +443,8 @@ class ImportsChecker(BaseChecker):
         for name, _ in node.names:
             if name != '*':
                 self._add_imported_module(node, '%s.%s' % (imported_module.name, name))
+            else:
+                self._add_imported_module(node, imported_module.name)
 
     @check_messages(*(MSGS.keys()))
     def leave_module(self, node):","This makes sense, don't know why it was ignored previously",py,1,1,1
"@@ -43,7 +43,7 @@ class BoundZmqEventBus implements EventBus {
     Addresses xpubAddr = deriveAddresses(address, publishConnection);
     Addresses xsubAddr = deriveAddresses(address, subscribeConnection);
 
-    LOG.info(String.format(""XPUB binding to %s, XSUB binding to %s"", xpubAddr, xsubAddr));
+    LOG.finest(String.format(""XPUB binding to %s, XSUB binding to %s"", xpubAddr, xsubAddr));
 
     xpub = context.createSocket(SocketType.XPUB);
     xpub.setImmediate(true);",This change is unhelpful: it precludes users from knowing which ports are being used for what purpose within the system.,py,1,1,1
"@@ -428,7 +428,9 @@ SEQUENCE_TYPES = {
 }
 
 
-def _emit_no_member(node, owner, owner_name, ignored_mixins=True, ignored_none=True):
+def _emit_no_member(
+    node, owner, owner_name, ignored_mixins, ignored_none, mixin_class_rgx
+):
     """"""Try to see if no-member should be emitted for the given owner.
 
     The following cases are ignored:",Why are the default values gone away?,py,1,1,1
"@@ -0,0 +1,6 @@
+from .utils import verify_model
+
+
+__all__ = [
+    'verify_model'
+]",No need to design `test_onnx` as python package.,py,0,0,1
"@@ -154,6 +154,7 @@ class CompletionModel(QAbstractItemModel):
         """"""Override QAbstractItemModel::columnCount.""""""
         # pylint: disable=unused-argument
         return 3
+        # pylint: enable=unused-argument
 
     def canFetchMore(self, parent):
         """"""Override to forward the call to the categories.""""""","No need for this, as pylint already only turns things off for this function and it's needed for the entire function.",py,1,1,1
"@@ -90,8 +90,8 @@ class PipelineBuilder(object):
                 else:
                     api = api_class(self.global_configs,
                                     version=api_version)
-            except api_errors.ApiExecutionError as e:
-                LOGGER.error('Failed to execute API %s, v=%s\n%s',
+            except api_errors.ApiInitializationError as e:
+                LOGGER.error('Failed to initialize API %s, v=%s\n%s',
                              api_class_name, api_version, e)
                 raise api_errors.ApiInitializationError(e)
 ","This can just be the following, since you are re-raising the same exception now: raise",py,1,1,1
"@@ -23,7 +23,8 @@ def main(args=None):
 
     parser = argparse.ArgumentParser(description=""Kinto Command-Line ""
                                                  ""Interface"")
-    commands = ('init', 'start', 'migrate', 'delete-collection', 'version')
+    commands = ('init', 'start', 'migrate', 'delete-collection', 'version',
+                'rebuild-quotas')
     subparsers = parser.add_subparsers(title='subcommands',
                                        description='Main Kinto CLI commands',
                                        dest='subcommand',",nitpick: we could add `rebuild-quotas` only if plugin is included?,py,1,1,1
"@@ -1,12 +1,14 @@
 # -*- coding: UTF-8 -*-
-#globalCommands.py
-#A part of NonVisual Desktop Access (NVDA)
-#This file is covered by the GNU General Public License.
-#See the file COPYING for more details.
-#Copyright (C) 2006-2018 NV Access Limited, Peter Vágner, Aleksey Sadovoy, Rui Batista, Joseph Lee, Leonard de Ruijter, Derek Riemer, Babbage B.V., Davy Kager, Ethan Holliger, Łukasz Golonka
+# globalCommands.py
+# A part of NonVisual Desktop Access (NVDA)
+# This file is covered by the GNU General Public License.
+# See the file COPYING for more details.
+# Copyright (C) 2006-2020 NV Access Limited, Peter Vágner, Aleksey Sadovoy, Rui Batista, Joseph Lee, Leonard de Ruijter, Derek Riemer, Babbage B.V., Davy Kager, Ethan Holliger, Łukasz Golonka, Accessolutions, Julien Cochuyt  # noqa: E501 line too long
 
 import time
 import itertools
+from typing import Optional
+
 import tones
 import audioDucking
 import touchHandler",Why not split the line?,py,1,0,1
"@@ -26,6 +26,9 @@ class StatsAPITestCase(IntegrationTestCase):
         sent_count = payload['count']
         received_count = data['count']
         self.assertEqual(sent_count, received_count)
+        sent_total_count = payload['count']
+        received_total_count = data['total_count']
+        self.assertEqual(sent_total_count, received_total_count)
         sent_artist_list = payload['all_time']['artists']
         received_artist_list = data['artists']
         self.assertListEqual(sent_artist_list, received_artist_list)",`total_count` is not obvious. Can we make the name more explicit? `total_artist_count`,py,1,1,1
"@@ -41,7 +41,7 @@ install_requires = [
     # https://pagure.io/python-daemon/issue/18
     'python-daemon<2.2.0',
     'python-dateutil==2.7.5',
-    'enum34>1.1.0;python_version<""3.4""',
+    'enum34>1.1.0;python_version<""3.4""'
 ]
 
 if os.environ.get('READTHEDOCS', None) == 'True':",trailing commas in Python lists are valid. Are you saying pip has a problem with this?,py,1,1,1
"@@ -177,6 +177,15 @@ class PyRegion(object):
     name: the name of the output
     """"""
 
+  def getAlgorithm(self):
+    """"""
+    Returns the underlying algorithm that is performing the computation.
+    This method should be overridden by the region subclass.
+
+    Returns None if there is no underlying algorithm for the region.
+    """"""
+    return None
+
   def getParameter(self, name, index):
     """"""Default implementation that return an attribute with the requested name
 ","I don't think this makes sense to add. The return value for a region of unknown type is an unknown object. It would only make sense if we required all regions to have an ""algorithm"" object that subclasses the some common base class.",py,1,1,1
"@@ -2,16 +2,17 @@ import types
 import logging
 import traceback
 from moto.s3 import models as s3_models, responses as s3_responses, exceptions as s3_exceptions
-from moto.s3.responses import minidom, MalformedXML, undo_clean_key_name, is_delete_keys
+from moto.s3.responses import (minidom, MalformedXML, undo_clean_key_name, is_delete_keys)
 from moto.s3.exceptions import S3ClientError
 from moto.s3bucket_path import utils as s3bucket_path_utils
 from localstack import config
 from localstack.utils.aws import aws_stack
-from localstack.services.s3 import s3_listener
+from localstack.services.s3 import s3_listener, s3_utils
 from localstack.utils.server import multiserver
 from localstack.utils.common import wait_for_port_open, get_free_tcp_port
 from localstack.services.infra import start_moto_server
 from localstack.services.awslambda.lambda_api import BUCKET_MARKER_LOCAL
+from urllib.parse import urlparse
 
 LOG = logging.getLogger(__name__)
 ",nit: braces could be removed,py,1,1,1
"@@ -15,12 +15,14 @@
 """"""Base GCP client which uses the discovery API.""""""
 import logging
 import threading
+import httplib2
+from retrying import retry
+
 import googleapiclient
+
 from googleapiclient import discovery
-import httplib2
 from oauth2client import client
 from ratelimiter import RateLimiter
-from retrying import retry
 
 from google.cloud import forseti as forseti_security
 from google.cloud.forseti.common.gcp_api import _supported_apis",Please alpha sort these.,py,1,1,1
"@@ -1,17 +1,15 @@
 import inspect
 from functools import update_wrapper
-from typing import TYPE_CHECKING, Callable, Generator, List, Optional, Union
+from typing import TYPE_CHECKING, Callable, Generator, List, Optional, Sequence, Union
 
 from dagster import check
 from dagster.core.definitions.sensor import RunRequest, SensorDefinition, SkipReason
 from dagster.core.errors import DagsterInvariantViolationError
 
-from ....seven import funcsigs
-from ...decorator_utils import get_function_params
 from ...errors import DagsterInvariantViolationError
 from ..events import AssetKey
 from ..graph import GraphDefinition
-from ..pipeline import PipelineDefinition
+from ..job import JobDefinition
 from ..sensor import AssetSensorDefinition, RunRequest, SensorDefinition, SkipReason
 
 if TYPE_CHECKING:",should we asspire to remove `job` if we have `jobs` ? both isnt the worst i guess,py,1,1,1
"@@ -97,10 +97,13 @@ class AdminDirectoryClient(_base_client.BaseClient):
         request = members_stub.list(groupKey=group_key,
                                     maxResults=FLAGS.max_results_admin_api)
 
-        results = self._build_paged_result(
+        paged_results = self._build_paged_result(
             request, members_stub, self.rate_limiter)
 
-        return [item.get('members', []) for item in results]
+        group_members = []
+        for page in paged_results:
+            group_members.extend(page.get('members', []))
+        return group_members
 
 
     def get_groups(self, customer_id='my_customer'):","If you're up for fixing this once, if not just open an issue, but we should write another helper method to un-bundle the results of a paged request. It'd accept just one argument, the string of the key and do what you're doing on lines 103-106",py,1,1,1
"@@ -133,10 +133,13 @@ def get_port_from_custom_rules(method, path, data, headers):
     if re.match(r'^/queue/[a-zA-Z0-9_-]+$', path):
         return config.PORT_SQS
 
+    if path == '/' and to_bytes('QueueName=') in data_bytes:
+        return config.PORT_SQS
+
     # TODO: move S3 public URLs to a separate port/endpoint, OR check ACLs here first
     stripped = path.strip('/')
     data_bytes = to_bytes(data or '')
-    if method == 'GET' and '/' in stripped:
+    if method in ['GET', 'HEAD'] and '/' in stripped:
         # assume that this is an S3 GET request with URL path `/<bucket>/<key ...>`
         return config.PORT_S3
 ",Move this above 136 to fix the linting error,py,1,1,1
"@@ -34,7 +34,7 @@ module Beaker
       install_update_server = answer_for(@options, :q_install_update_server, 'y')
 
       the_answers.map do |key, value|
-        the_answers[key][:q_update_server_host] = update_server_host
+        the_answers[key][:q_update_server_host] = update_server_host if the_answers[key]
       end
       the_answers[master.name][:q_install_update_server] = install_update_server
 ",In what case is this answer empty?,rb,1,1,1
"@@ -173,7 +173,7 @@ public class DefaultConditionRunner implements ConditionRunner {
     }
 
     protected void log(String message) {
-      logger.info(new Date() + "" - "" + message);
+      logger.finest(new Date() + "" - "" + message);
     }
 
   }",This method is designed to allow the condition runner to tell users something interesting. The current `INFO` log level is correct.,rb,1,1,1
"@@ -0,0 +1,9 @@
+<% if @subscription_coupon.valid? %>
+  $("".totalprice"").html('<%= t(""subscriptions.discount.#{@subscription_coupon.duration}"", final_price: @subscription_coupon.apply(@purchase.price), full_price: @purchase.price, duration_in_months: @subscription_coupon.duration_in_months) %>');
+  $("".coupon .error"").hide();
+  $(""#total a"").hide();
+  $("".coupon"").hide();
+  $(""#purchase_stripe_coupon_id"").val(""<%= @subscription_coupon.code %>"");
+<% else %>
+  $("".coupon .error"").show();
+<% end %>","I'd vote that new js be written in coffeescript instead, with us converting the old stuff when we happen to touch it.",rb,1,1,1
"@@ -5,7 +5,7 @@
         <th><%= _('Organisation') %>&nbsp;<%= paginable_sort_link('orgs.name') %></th>
         <th><%= _('Administrator Email') %>&nbsp;<%= paginable_sort_link('orgs.contact_email') %></th>
         <th><%= _('Organisation Type(s)') %>&nbsp;<%= paginable_sort_link('orgs.org_type') %></th>
-        <th><%= _('Templates') %>&nbsp;<%= paginable_sort_link('orgs.updated_at') %></th>
+        <th><%= _('Templates') %></th>
         <th class=""sorter-false""><span aria-hidden=""false"" class=""sr-only""><%= _('Actions') %></span></th>
       </tr>
     </thead>",good you removed this sortable field. Sorting by updated_at when the field name was Templates seems odd,rb,1,1,1
"@@ -230,11 +230,10 @@ MESSAGE
           def dartfmt
             args = task[:dartfmt]
 
-            if args.is_a?(String)
-              sh.echo ""dartfmt arguments aren't supported."", ansi: :red
-            end
-
-            sh.if package_direct_dependency?('dart_style'), raw: true do
+            # If specified `-dartfmt: custom` and there is a dependency on `dart_style` we
+            # will use the custom (pinned) version of dart_style to run formatting checks
+            # instead of the SDK.
+            sh.if args == 'custom' and package_direct_dependency?('dart_style'), raw: true do
               sh.raw 'function dartfmt() { pub run dart_style:format ""$@""; }'
             end
 ",Uh...wouldn't `custom` be passed to the args here?,rb,1,1,1
"@@ -28,10 +28,11 @@ Puppet::Functions.create_function(:run_task) do
   end
 
   def run_task(task_name, targets, task_args = nil)
+    task_args ||= {}
     r = Bolt::ExecutionResult.from_bolt(
       run_task_raw(task_name, targets, task_args)
     )
-    if !r.ok && task_args && task_args['_abort'] != false
+    if !r.ok && !task_args['_catch_errors']
       raise Bolt::RunFailure.new(r, 'run_task', task_name)
     end
     r",task_args could still be nil.,rb,1,1,1
"@@ -131,7 +131,7 @@ public class DriverCommandExecutor extends HttpCommandExecutor implements Closea
         Thread.currentThread().interrupt();
         throw new WebDriverException(""Timed out waiting for driver server to stop."", e);
       } finally {
-        executorService.shutdownNow();
+        executorService.shutdown();
       }
 
     } else {","For the command executor, which in turn, uses the HTTP client to talk to the WebDriver, the client might have high-timeout values set, so the shutdown can take a long time if we wait for it to complete, especially if multiple-long running threads are there. I think it might be a good idea in general to couple the shutdown() with `awaitTermination()` with a timeout, if the ongoing tasks do not complete within that timeout then call `shutdownNow()`. What do you think?",rb,1,1,0
"@@ -19,6 +19,12 @@ module Travis
           super
           if version == 'nightly'
             install_python_nightly
+            return
+          end
+
+          sh.if ""! -f #{virtualenv_activate}"" do
+            sh.echo ""#{version} is not installed; attempting download"", ansi: :yellow
+            install_python_archive( version )
           end
         end
 ",why not just change this line to `install_python_archive('nightly')` and remove the nightly method?,rb,1,1,1
"@@ -116,7 +116,14 @@ The `puppetfile` section of the configuration file configures how to retrieve mo
 
 ## Transport configuration options
 
-Transport configuration options can be set in both the configuration file and inventory file.
+Transport configuration options can be set in the inventory file. Options at
+the inventory's top level will apply to all targets.
+
+### The transport option
+
+<% @transport_option[:options].each do |option, desc| -%>
+| `<%= option %>` | <%= desc %> | <%= @transport_option[:defaults][option].to_s %> |
+<% end %>
 
 <% @transports[:options].each do |transport, options| %>
 ### <%= transport %>","Definitely work for another ticket, but I think we need to look at creating separate ref pages for each config/inventory file. This is quickly getting confusing.  ",rb,1,1,1
"@@ -18,4 +18,9 @@
   .trail-titles li.<%= topic.slug.parameterize %> {
     border-color: <%= topic.color %>;
   }
+
+  .trail.<%= topic.slug.parameterize %> .topic-label {
+    background: <%= topic.color %>;
+    color: <%= topic.color_accent %>;
+  }
 <% end %>","Just noticed that this seems to be just CSS and not SASS. It shouldn't be done as part of this pull request, but do we want to support SASS in here? The nesting is a little prettier and we currently can't use Bourbon mixins or anything.",rb,1,1,1
"@@ -1,3 +1,4 @@
+# -*- coding: utf-8 -*-
 require 'resolv'
 require 'inifile'
 require 'timeout'",Is this something we need to be adding to all the Beaker source files?,rb,1,1,1
"@@ -34,7 +34,7 @@ module Selenium
           driver.manage.timeouts.implicit_wait = 6
 
           driver.find_element(id: 'adder').click
-          driver.find_element(id: 'box0')
+          expect { driver.find_element(id: 'box0') }.not_to raise_error(WebDriver::Error::NoSuchElementError)
         end
 
         it 'should still fail to find an element with implicit waits enabled' do",This should just be `.not_to raise_error` otherwise it potentially hides errors,rb,1,1,1
"@@ -35,9 +35,9 @@ module Blacklight
         fields = Array.wrap(view_config.html_title_field)
         f = fields.detect { |field| document.has? field }
         f ||= 'id'
-        field_values(field_config(f))
+        field_values(field_config(f), no_html: true)
       else
-        heading
+        heading(no_html: true)
       end
     end
 ",This bothers me a little bit because it isn't actually used in blacklight.. It almost makes me wonder if we're appropriately using `field_values` here at all. I'd like to put a little more thought into it before we ship this.,rb,1,1,1
"@@ -35,13 +35,13 @@ public class BaseSuite {
   public static ExternalResource testEnvironment = new ExternalResource() {
     @Override
     protected void before() {
-      log.info(""Preparing test environment"");
+      log.finest(""Preparing test environment"");
       GlobalTestEnvironment.get(SeleniumTestEnvironment.class);
       System.setProperty(""webdriver.remote.shorten_log_messages"", ""true"");
     }
     @Override
     protected void after() {
-      log.info(""Cleaning test environment"");
+      log.finest(""Cleaning test environment"");
       TestEnvironment environment = GlobalTestEnvironment.get();
       if (environment != null) {
         environment.stop();",This is in test code: understanding what we're doing is important in this context.,rb,1,0,1
"@@ -10,7 +10,7 @@ class Duplicate < ActiveRecord::Base
   validates :comment, length: { maximum: 1000 }, allow_blank: true
 
   def resolve!(editor_account)
-    good_project.editor_account = bad_project.editor_account = editor_account
+    @editor_account = good_project.editor_account = bad_project.editor_account = editor_account
     Duplicate.transaction { RESOLVES.each { |r| send(""resolve_#{r}!"") } }
   end
 ",Do we even need to set `good_project.editor_account` and `bad_project.editor_account`? I can't see that they are used any longer. Do they need to be set for something else?,rb,1,1,1
"@@ -11,10 +11,14 @@ describe Bolt::WinRM do
 
   let(:host) { ENV['BOLT_WINRM_HOST'] || 'localhost' }
   let(:port) { ENV['BOLT_WINRM_PORT'] || 55985 }
+  let(:ssl_port) { ENV['BOLT_WINRM_SSL_PORT'] || 55986 }
   let(:user) { ENV['BOLT_WINRM_USER'] || ""vagrant"" }
   let(:password) { ENV['BOLT_WINRM_PASSWORD'] || ""vagrant"" }
   let(:command) { ""echo $env:UserName"" }
-  let(:winrm) { Bolt::WinRM.new(host, port, user, password) }
+  let(:config) { Bolt::Config.new(transports: { winrm: { insecure: true } }) }
+  let(:ssl_config) { Bolt::Config.new(transports: { winrm: { ca_cert: 'resources/cert.pem' } }) }
+  let(:winrm) { Bolt::WinRM.new(host, port, user, password, config: config) }
+  let(:winrm_ssl) { Bolt::WinRM.new(host, ssl_port, user, password, config: ssl_config) }
   let(:echo_script) { <<PS }
 foreach ($i in $args)
 {",I guess this is an automatic mapping (i.e. I don't see the `Vagrantfile` updated to map 5986 to 55986)?,rb,1,1,1
"@@ -11,11 +11,15 @@ feature 'Account Settings' do
 
   scenario 'user views paid purchases' do
     user = create(:user)
-    create_list(:paid_purchase, 3, user: user)
+    create_list(:paid_purchase, 4, user: user, created_at: 6.minutes.ago)
+    purchase_two = create(:paid_purchase, user: user, created_at: 5.minutes.ago)
+    purchase_one = create(:paid_purchase, user: user, created_at: 1.minutes.ago)
 
     visit edit_my_account_path(as: user)
 
     expect_to_see_my_paid_purchases(user)
+    expect(purchase_one.purchaseable_name).
+      to appear_before(purchase_two.purchaseable_name)
   end
 
   scenario 'user with no purchases' do","Place the . on the next line, together with the method name.",rb,1,1,1
"@@ -186,13 +186,11 @@ module Paginable
     @args.except(*PAGINATION_QUERY_PARAMS).to_param
   end
 
-  # TODO: We would be better served here passing these arguments as a Ruby double splat
-  # rubocop:disable Lint/UnusedMethodArgument
   def stringify_query_params(page: 1, search: @args[:search],
                              sort_field: @args[:sort_field],
                              sort_direction: nil)
 
-    query_string = {}
+    query_string = { page: page }
     query_string[""search""] = search if search.present?
     if sort_field.present?
       query_string[""sort_field""] = sort_field",this was a separate issue that I stumbled across while testing,rb,0,0,1
"@@ -25,6 +25,9 @@ public interface Span extends AutoCloseable, TraceContext {
   Span setAttribute(String key, Number value);
   Span setAttribute(String key, String value);
 
+  Span addEvent(String name);
+  Span addEvent(String name, long timestamp);
+
   Span setStatus(Status status);
 
   @Override",We don't need this additional method.,rb,1,1,0
"@@ -0,0 +1,7 @@
+<script type=""text/javascript"">
+  analytics.track('Purchased',
+    <%= raw purchased_hash(purchase_amount, purchase_name).to_json %>
+  );
+</script>
+
+<%= render 'conversions/adwords', purchase_amount: purchase_amount %>",Does Segment.io not handle Google Adwords conversions?,rb,1,1,1
"@@ -0,0 +1,13 @@
+# frozen_string_literal: true
+
+require_relative '../../test_helper'
+
+class TestDeprecateSpace < Test::Unit::TestCase
+  def setup
+    @tester = Faker::Space
+  end
+
+  def launch_vehicule
+    assert @tester.character.match(/\w+/)
+  end
+end",copy and   it should be `@tester.launch_vehicule.match` :),rb,1,0,0
"@@ -28,7 +28,17 @@ class Dispatcher
   end
 
   def requires_approval_notice?(approval)
-    true
+    if approval.cart.getProp('origin') == 'ncr'
+      self.with_approval_notice_requirements { approval.is_final_approval? }
+    else
+      true
+    end
+  end
+
+  def with_approval_notice_requirements &requirements
+    if block_given?
+      requirements.call
+    end
   end
 
   def self.initialize_dispatcher(cart)","This could turn into a rules block that we pull out of here, potentially covering all of the different clients and addressing other client-specific functions",rb,1,1,1
"@@ -70,7 +70,7 @@ public class NodeOptions {
       Capabilities caps = info.getCanonicalCapabilities();
       builders.stream()
           .filter(builder -> builder.score(caps) > 0)
-          .peek(builder -> LOG.info(String.format(""Adding %s %d times"", caps, info.getMaximumSimultaneousSessions())))
+          .peek(builder -> LOG.finest(String.format(""Adding %s %d times"", caps, info.getMaximumSimultaneousSessions())))
           .forEach(builder -> {
             DriverService.Builder freePortBuilder = builder.usingAnyFreePort();
 ",This is an informational message that allows someone to read the console output and understand how the grid node is configured. Please leave.,rb,1,1,1
"@@ -1,7 +1,7 @@
 class Trail < ActiveRecord::Base
   extend FriendlyId
 
-  validates :name, presence: true
+  validates :name, :description, presence: true
 
   has_many :steps, dependent: :destroy
   has_many :exercises, through: :steps","If we add this validation, we also probably want a migration which sets a value for existing trails. Otherwise, all existing trails will become invalid.",rb,1,1,1
"@@ -14,11 +14,9 @@ class HomeController < ApplicationController
   def index
     if user_signed_in?
       name = current_user.name(false)
-      # TODO: Investigate if this is even relevant anymore.
-      # The name var will never be blank here because the logic in
-      # User says to return the email if the firstname and surname are empty
-      # regardless of the flag passed in
-      if name.blank?
+      # The RolesController defaults the firstname and surname (both required fields)
+      # to 'FirstName' and 'Surname' when a plan is shared with an unknown user
+      if name == ""First Name Surname""
         redirect_to edit_user_registration_path
       else
         redirect_to plans_url",Came across this recently in DMPTool and decided to just fix here,rb,0,0,1
"@@ -25,3 +25,4 @@ class ChromeRemoteConnection(RemoteConnection):
         self._commands[""launchApp""] = ('POST', '/session/$sessionId/chromium/launch_app')
         self._commands[""setNetworkConditions""] = ('POST', '/session/$sessionId/chromium/network_conditions')
         self._commands[""getNetworkConditions""] = ('GET', '/session/$sessionId/chromium/network_conditions')
+        self._commands['ExecuteCDP'] = ('POST', '/session/$sessionId/goog/cdp/execute')",Should this be camelCase to match the above commands? I am not the expert here so maybe Lucas or David can chime in.,rb,0,1,1
"@@ -115,7 +115,8 @@ module.exports = function exec(command, opt_options) {
 
   var proc = childProcess.spawn(command, options.args || [], {
     env: options.env || process.env,
-    stdio: options.stdio || 'ignore'
+    stdio: options.stdio || 'ignore',
+    detached: true
   });
 
   // This process should not wait on the spawned child, however, we do","You're welcome to surface this option through the API, but I'm not going to make this the default behavior.",rb,1,1,1
"@@ -0,0 +1,19 @@
+class NameUnnamedRedactions < ActiveRecord::Migration[5.0]
+  def self.up
+    Redaction.find_each do |redaction|
+        if redaction.title.empty?
+            redaction.title = redaction.id.to_s
+            redaction.save!
+        end
+    end
+  end
+
+  def self.down
+    Redaction.find_each do |redaction|
+        if redaction.title.eql? redaction.id.to_s
+            redaction.title = """"
+            redaction.save!
+        end
+    end
+  end
+end",Indentation should be the standard two spaces please.,rb,1,1,1
"@@ -0,0 +1,19 @@
+<% reports.each do |report| %>
+  <div class=""reports"">
+    <div style=""float:left"">
+      <%= link_to user_thumbnail(report.user), :controller => :user, :action =>:view, :display_name => report.user.display_name %>
+    </div>
+    <%= t("".reported_by_html"", :user_name => report.user.display_name, :user_url => url_for(:controller => :user, :action => :view, :display_name => report.user.display_name)) %> <br/>
+    <span class=""deemphasize"">
+      <%= t("".updated_at"", :datetime => l(report.updated_at.to_datetime, :format => :friendly)) %>
+    </span>
+    <br/>
+    <span class=""deemphasize"">
+      <%= t "".category"", category: report.category %>
+    </span>
+    <br/>
+    <%= report.details %>
+    <br/>
+  </div>
+  <hr>
+<% end %>","As this is inside the loop, and hence only contains one report, this seems like the wrong class name to use?",rb,1,1,1
"@@ -3,12 +3,12 @@ module Subscriber
     before_filter :authorize
 
     def index
-      @invoices = SubscriptionInvoice.
+      @invoices = Invoice.
         find_all_by_stripe_customer_id(current_user.stripe_customer_id)
     end
 
     def show
-      @invoice = SubscriptionInvoice.new(params[:id])
+      @invoice = Invoice.new(params[:id])
       ensure_invoice_belongs_to_user
     end
 ","Place the . on the next line, together with the method name.",rb,1,1,1
"@@ -153,6 +153,11 @@ module Faker
         regexify(/IT\d{2,4}\/\d{2,10}/)
       end
 
+      # Get a random Russian tax number.
+      def russian_tax_number(region: nil, type: :legal)
+        inn_number(region, type)
+      end
+
       private
 
       # Mod11 functionality from https://github.com/badmanski/mod11/blob/master/lib/mod11.rb",I think we could add a formatted/unformatted keyword parameter for this method. What do you think?,rb,1,1,1
"@@ -48,6 +48,10 @@ module RSpec::Core
           options[:libs] << dir
         end
 
+        parser.on('-i') do
+          raise OptionParser::InvalidOption.new
+        end
+
         parser.on('-r', '--require PATH', 'Require a file.') do |path|
           options[:requires] ||= []
           options[:requires] << path","In @fj's example he had put `--I`. I'm curious why you put `-i` here? Actually, I think maybe both should raise an error.",rb,0,1,1
"@@ -0,0 +1,19 @@
+<% modifiable = !template.customization_of.present? && template.id.present? && (template.org_id = current_user.org.id) %>
+<% details_path = modifiable ? edit_org_admin_template_path(template.id) : template.id.present? ? org_admin_template_path(template.id) : org_admin_templates_path %>
+<ul class=""nav nav-tabs"" role=""tablist"">
+  <li role=""presentation"" <%= isActivePage(details_path) ? ' class=active' : '' %>>
+    <%= link_to(_('Template details'), details_path, { 'aria-controls': 'show_template', role: 'tab' }) %>
+  </li>
+  <% template.phases.each do |phase| %>
+    <% phase_path = phase.modifiable? ? edit_org_admin_template_phase_path(template.id, phase.id) : org_admin_template_phase_path(template.id, phase.id) %>
+    <li role=""presentation"" <%= isActivePage(phase_path) ? ' class=active' : '' %>>
+      <%= link_to(phase.title, phase_path, { 'aria-controls': ""#{phase.id}"", role: 'tab' }) %>
+    </li>
+  <% end %>
+  <!-- Add another phase button -->
+  <% if modifiable %>
+    <li role=""presentation"" <%= isActivePage(new_org_admin_template_phase_path(template.id)) ? ' class=active' : '' %>>
+      <%= link_to(_('Add new phase'), new_org_admin_template_phase_path(template.id), { 'aria-controls': 'add_phase', role: 'tab' }) %>
+    </li>
+  <% end %>
+</ul>",why don't we add modifiable? method into template model instead?,rb,1,1,1
"@@ -1,4 +1,5 @@
 require 'spec_helper'
+require 'pp'
 
 class ClassMixedWithDSLHelpers
   include Beaker::DSL::Helpers",Doesn't look like you're actually using this anywhere?,rb,0,0,0
"@@ -76,12 +76,13 @@ class ApplicationController < ActionController::Base
 
   def authenticate_user!
     if not_signed_in?
-      flash[:error] = 'You need to sign in for access to this page.'
+      flash[:error] = ""You need to sign in for access to this page.""
       return_to_param = make_return_to(""Previous"", request.fullpath)
       session[:return_to] = return_to_param
       redirect_to root_url(return_to: return_to_param)
-    elsif session[:return_to]
-      session.delete(:return_to)
+    elsif current_user.inactivated?
+      redirect_to root_url
+      flash[:error] = ""You are not allowed to login because your account has been inactivated. Please <a href='/feedback'>contact an administrator</a>.""
     end
   end
 ",@pkarman I removed this because I wasn't sure why it was here - thoughts? Happy to re-introduce and write a test for it if we need it :),rb,0,0,1
"@@ -67,11 +67,11 @@ public abstract class AbstractWebDriverEventListener implements WebDriverEventLi
     // Do nothing.
   }
 
-  public void beforeChangeValueOf(WebElement element, WebDriver driver) {
+  public void beforeChangeValueOf(WebElement element, WebDriver driver, CharSequence[] value) {
     // Do nothing.
   }
 
-  public void afterChangeValueOf(WebElement element, WebDriver driver) {
+  public void afterChangeValueOf(WebElement element, WebDriver driver, CharSequence[] value) {
     // Do nothing.
   }
 ","change 'value' to keysToSend, here and in other references in this commit. 'value' implies the user is getting the value of the element, rather than just the keys we're sending to it.",rb,1,1,1
"@@ -0,0 +1,18 @@
+RSpec::Support.require_rspec_core ""formatters/base_formatter""
+
+module RSpec
+  module Core
+    module Formatters
+      # @private
+      class CFormatter < BaseFormatter
+        Formatters.register self, :example_failed, :dump_profile
+
+        def example_failed(failure)
+          output.puts ""#{failure.example.location}:#{failure.example.description}""
+        end
+
+        def dump_profile(_profile); end
+      end
+    end
+  end
+end",You don't need to do this if you don't register `dump_profile`,rb,1,1,1
"@@ -601,7 +601,8 @@ module Travis
           when 'bioc-devel'
             config[:bioc_required] = true
             config[:bioc_use_devel] = true
-            normalized_r_version('devel')
+            config[:r] = 'release'
+            normalized_r_version
           when 'bioc-release'
             config[:bioc_required] = true
             config[:bioc_use_devel] = false",Is there a reason you aren't using `normalized_r_version('release')`?,rb,1,1,1
"@@ -35,7 +35,13 @@ describe AuthHashService, '#find_or_create_user_from_auth_hash' do
   end
 
   context 'with an existing user' do
-    it 'finds the user' do
+    it ""finds the user by email"" do
+      existing_user = create(:user, email: auth_hash[""info""][""email""])
+
+      expect(existing_user).to eq AuthHashService.new(auth_hash).find_or_create_user_from_auth_hash
+    end
+
+    it ""finds the user by auth_provider and auth_uid"" do
       existing_user = create(:user, auth_provider: 'github', auth_uid: 1)
 
       expect(existing_user).to eq AuthHashService.new(auth_hash).find_or_create_user_from_auth_hash",Line is too long. [99/80],rb,1,1,1
"@@ -0,0 +1,16 @@
+module VanityHelpers
+  def vanity_signup_count
+    tracked_events_for(Vanity.playground.metric(:signups))
+  end
+
+  def tracked_events_for(metric)
+    events_from_today =
+      Vanity::Metric.data(metric, Date.today, Date.today).first
+    count_of_todays_events = events_from_today.second
+  end
+
+  def stub_ab_test_result(experiment, choice)
+    Vanity.playground.experiment(experiment).identify {}
+    Vanity.playground.experiment(experiment).chooses(choice)
+  end
+end",Useless assignment to variable - `count_of_todays_events`.,rb,1,1,1
"@@ -93,7 +93,7 @@ public class Docker {
       throw new WebDriverException(""Unable to pull container: "" + name);
     }
 
-    LOG.info(String.format(""Pull of %s:%s complete"", name, tag));
+    LOG.fine(String.format(""Pull of %s:%s complete"", name, tag));
 
     return findImage(new ImageNamePredicate(name, tag))
         .orElseThrow(() -> new DockerException(",Waiting for the pull takes a long time. This message informs the user that at least one of the images being pulled is available. Please leave.,rb,1,1,1
"@@ -7,4 +7,8 @@ RSpec.configure do |config|
   config.before(:suite) do
     # FactoryBot.lint
   end
+
+  config.append_after(:each) do
+    FactoryBot.rewind_sequences
+  end
 end","This ensures that all of our `sequence` calls in factories get reset to 1 between tests. I noticed that section numbers were generated sequentially, but would not match the customized version as the original template would be in the 60's and the customized template would always start at 1 as it's generated by our logic.",rb,1,1,1
"@@ -0,0 +1,9 @@
+class KissmetricsClientFactory
+  def self.client
+    if Rails.env.test?
+      FakeKissmetrics::HttpClient.new('fake-api-key')
+    else
+      Kissmetrics::HttpClient.new(KISSMETRICS_API_KEY)
+    end
+  end
+end",Do we really need the Factory in this class name?,rb,1,1,1
"@@ -20,6 +20,11 @@ class User < ActiveRecord::Base
   has_many :outgoing_delegations, class_name: 'ApprovalDelegate', foreign_key: 'assigner_id'
   has_many :outgoing_delegates, through: :outgoing_delegations, source: :assignee
 
+  has_many :incoming_delegations, class_name: 'ApprovalDelegate', foreign_key: 'assignee_id'
+  has_many :incoming_delegates, through: :incoming_delegations, source: :assigner
+
+  has_many :completed_steps, class_name: ""Step"", foreign_key: ""completer""
+
   def self.active
     where(active: true)
   end",surprised code climate isn't yelling about single quotes. Seems like that integration is a bit flaky these days...,rb,1,0,0
"@@ -11,6 +11,13 @@ class Post < ActiveRecord::Base
 
   scope :by_newest, -> { order('posts.created_at desc') }
   scope :by_unanswered, -> { joins(:topic).where(topics: { posts_count: 1 }).by_newest }
+  # DISTINCT ON is a Postgres extension to the SQL standard so it won't work on other databases.
+  scope :most_recent, lambda {
+    joins(""INNER JOIN (
+            SELECT DISTINCT ON (topic_id) topic_id, id FROM posts ORDER BY topic_id, created_at DESC
+          ) most_recent ON (most_recent.id=posts.id)"")
+  }
+  scope :open_topics, -> { joins(:topic).where(topics: { closed: false }).by_newest }
 
   def body=(value)
     super(value ? value.fix_encoding_if_invalid!.strip_tags.strip : nil)",How about renaming it to `open_topics`?,rb,1,1,1
"@@ -44,6 +44,11 @@ module RSpec
         end
         self
       end
+
+      def clear
+        @values.clear
+        self
+      end
     end
   end
 end",Mind adding a spec to `set_spec.rb` for this?,rb,1,1,1
"@@ -34,6 +34,7 @@
 #  image_content_type  :string
 #  auth_provider       :string
 #  home_tile           :integer
+#  tou_agreed          :datetime
 #
 # Indexes
 #",What does this map in PostgreSQL? We should be using `timestamp with time zone` for a purpose like this.,rb,1,1,1
"@@ -102,8 +102,17 @@ module Ncr
         # skip state machine
         self.proposal.update(status: 'approved')
       else
-        approvers = emails.map{|e| User.for_email(e)}
-        self.proposal.approvers = approvers
+        individuals = emails.map do |email|
+          user = User.for_email(email)
+          # Reuse existing approvals, if present
+          if existing = self.proposal.existing_approval_for(user)
+            existing
+          else
+            Approvals::Individual.new(user: user)
+          end
+        end
+
+        self.proposal.root_approval = Approvals::Serial.new(child_approvals: individuals)
       end
     end
 ","Do we need to worry about a `root_approval` already existing here, or can we safely assume this will only be called on the initial setup?",rb,1,1,1
"@@ -44,6 +44,10 @@ import java.util.List;
  * </code>
  */
 public abstract class By {
+  static {
+    WebDriverException.scheduleIpHostResolving();
+  }
+
   /**
    * @param id The value of the ""id"" attribute to search for
    * @return a By which locates elements by the value of the ""id"" attribute.","we shouldn't add a bunch of static initializers 'everywhere' in the code. Probably just one would be good, during the construction of the 'RemoteWebDriver' class.",rb,1,1,1
"@@ -0,0 +1,5 @@
+package org.openqa.selenium.grid.distributor.remote;
+
+public class RemoteDistributorTest {
+
+}",Probably best not to have an empty test....,rb,1,1,1
"@@ -1,4 +1,4 @@
 <% showusername = true if showusername.nil? %>
 <table id=""changeset_list"">
-  <%= render :partial => 'changeset', :locals => {:showusername => showusername}, :collection => @edits unless @edits.nil? %>
+  <%= render :partial => 'changeset/changeset', :locals => {:showusername => showusername}, :collection => @edits unless @edits.nil? %>
 </table>",This change should be unnecessary - rendering the `changset` partial from a changeset view should default to the one in the same view.,rb,1,1,1
"@@ -11,6 +11,7 @@
 #
 # Indexes
 #
+#  fk_rails_fe95df7db0                (identifier_scheme_id)
 #  index_user_identifiers_on_user_id  (user_id)
 #
 # Foreign Keys",Is the UserIdentifier model sticking around for a release to migrate the objects over to the new Identifier model?,rb,1,1,1
"@@ -13,13 +13,14 @@ module RSpec
       # @overload before(scope, &block)
       #   @param scope [Symbol] `:example`, `:context`, or `:suite`
       #     (defaults to `:example`)
-      # @overload before(scope, conditions, &block)
+      # @overload before(scope, *conditions, &block)
       #   @param scope [Symbol] `:example`, `:context`, or `:suite`
       #     (defaults to `:example`)
-      #   @param conditions [Hash]
-      #     constrains this hook to examples matching these conditions e.g.
+      #   @param conditions [Array<Symbol>, Hash] constrains this hook to
+      #     examples matching these conditions e.g.
       #     `before(:example, :ui => true) { ... }` will only run with examples
-      #     or groups declared with `:ui => true`.
+      #     or groups declared with `:ui => true`. Symbols will be transformed
+      #     into hash entries with `true` values.
       # @overload before(conditions, &block)
       #   @param conditions [Hash]
       #     constrains this hook to examples matching these conditions e.g.","I'm still unsure about the changes in all this file, can you show some sample renders before / after? They imply the main use case is an array of symbols with a hash as an afterthought when really we expect this to be a hash 99% of the time.",rb,1,1,1
"@@ -1,6 +1,18 @@
 require ""rails_helper""
 
+include ActionView::Helpers::DateHelper
+
 feature ""Subscriber views decks"" do
+  scenario ""and hasn't started a deck"" do
+    flashcard = create(:flashcard)
+
+    visit decks_path(as: create(:subscriber))
+
+    within("".decks-area"") do
+      expect(page).to have_content(never_attempted)
+    end
+  end
+
   scenario ""and starts a deck"" do
     flashcard = create(:flashcard)
 ",Useless assignment to variable - `flashcard`.,rb,1,1,1
"@@ -27,6 +27,7 @@ module Beaker
     # @option opts [Beaker::Logger] :logger A {Beaker::Logger} object
     def timesync host, opts
       logger = opts[:logger]
+      ntp_server = opts[:ntp_server] ? opts[:ntp_server] : NTPSERVER
       block_on host do |host|
         logger.notify ""Update system time sync for '#{host.name}'""
         if host['platform'].include? 'windows'",Any possible value in having an ntp server per host? @branan ?,rb,0,1,1
"@@ -0,0 +1,11 @@
+<%= form_tag(url, method: :get, remote: true, class: 'form-inline') do %>
+  <div class=""form-group"">
+    <div class=""input-group"">
+      <span class=""input-group-addon"" id=""search-addon"">
+        <span class=""glyphicon glyphicon-search"" aria-hidden=""true""></span>
+      </span>
+      <%= text_field_tag(:search, nil, class: 'form-control', 'aria-describedby': 'search-addon', 'aria-required': true) %>
+    </div>
+  </div>
+  <%= submit_tag(_('Search'), class: 'btn btn-default', style: 'margin-top: 8px;') %>
+<% end %>","We should use fontawesome here since we're using it everywhere else. `class=""fa fa-search""` should work",rb,1,1,1
"@@ -1,4 +1,6 @@
 $_rspec_core_load_started_at = Time.now
+require 'thread'
+
 require 'rbconfig'
 
 require ""rspec/support""","If possible, this needs delaying until someone actively uses the feature, reason being is we try **very** hard not to pollute a users code base with std library stuff, which this would.",rb,1,1,1
"@@ -343,9 +343,7 @@ module Bolt
     end
 
     def list_tasks
-      outputter.print_table(pal.list_tasks)
-      outputter.print_message(""\nUse `bolt task show <task-name>` to view ""\
-                              ""details and parameters for a specific task."")
+      outputter.print_tasks(pal.list_tasks, pal.list_modulepath)
     end
 
     def show_plan(plan_name)","Can we just override ""list_tasks"" in the human outputter instead of adding a new method?",rb,1,1,1
"@@ -7,7 +7,7 @@ csp_policy = {
   :form_action => %w['self'],
   :frame_ancestors => %w['self'],
   :frame_src => %w['self'],
-  :img_src => %w['self' data: www.gravatar.com *.wp.com tile.openstreetmap.org *.tile.openstreetmap.org *.tile.thunderforest.com tileserver.memomaps.de *.openstreetmap.fr],
+  :img_src => %w['self' data: www.gravatar.com *.wp.com tile.openstreetmap.org *.tile.openstreetmap.org *.tile.thunderforest.com tileserver.memomaps.de *.openstreetmap.fr *.global.ssl.fastly.net],
   :manifest_src => %w['self'],
   :media_src => %w['none'],
   :object_src => %w['self'],",I'd make this an override in the `embed` method of the export controller rather than enabling it globally.,rb,0,0,1
"@@ -1,6 +1,6 @@
 C2::Application.routes.draw do
   ActiveAdmin.routes(self)
-  root :to => 'home#index'
+  root to: ""home#index""
   get '/error' => 'home#error'
   get '/profile'  => 'profile#show'
   post '/profile' => 'profile#update'","If you're going to change that one, why not change them all and get it done with?",rb,1,1,1
"@@ -1,6 +1,12 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 # SPDX - License - Identifier: Apache - 2.0
 
+# Purpose
+# This code example demonstrates how to set the access control list (ACL)
+# on an Amazon Simple Storage Solution (Amazon S3) bucket for the given owner.
+
+# snippet-start:[s3.s3_set_bucket_acls.rb]
+
 require 'aws-sdk-s3'
 
 # Sets the access control list (ACL) on an Amazon S3 bucket for the",Simple Storage **Service**,rb,0,0,0
"@@ -2,4 +2,13 @@ module NotifierHelper
   def fp(text)
     format_paragraph(text, 72, 0)
   end
+
+  def link_to_user(display_name)
+    link_to(
+      display_name,
+      user_url(display_name, :host => SERVER_URL),
+      :target => ""_blank"",
+      :style => ""text-decoration: none; color: #222; font-weight: bold""
+    )
+  end
 end","I added the `link_to_user` helper to declutter the template a bit, but then it means this Ruby file now contains some CSS instructions. What's the proper Rails way to do this?",rb,0,0,1
"@@ -83,6 +83,14 @@ class User < ActiveRecord::Base
     [purchased_subscription, team_subscription].compact.detect(&:active?)
   end
 
+  def annualized_payment
+    plan.annualized_payment
+  end
+
+  def discounted_annual_payment
+    plan.discounted_annual_payment
+  end
+
   private
 
   def team_subscription","Had a thought about this: we could make the upgrade route `/individual_plan/:id/annual_billing`, and then I could avoid these delegators. Worth it?",rb,0,1,1
"@@ -469,6 +469,13 @@ Rails.application.routes.draw do
     resources :license_permissions
   end
 
+  namespace 'api', defaults: { format: :json } do
+    namespace 'v1' do
+      post 'unsubscribe'
+      post 'jwt'
+    end
+  end
+
   get 'sitemap_index.xml', controller: 'sitemap', action: 'index', format: 'xml'
   get 'sitemaps/:ctrl/:page.xml', controller: 'sitemap', action: 'show', format: 'xml'
 ",Add a jwt and enlistment resource under the namespace v1,rb,1,1,1
"@@ -135,7 +135,8 @@ class PathResolver
   # This operation considers posix paths, windows paths, and file URLs.
   #
   # Unix absolute paths and UNC paths start with slash. Windows roots can start
-  # with a drive letter. Absolute paths in the browser start with file://.
+  # with a drive letter. Absolute paths may start with file://, http://, or
+  # https:// when the IO module is xmlhttprequest (Opal runtime only).
   #
   # path - the String path to check
   #",I didn't know that `start_with?` accepts a list of arguments! It's good to know :smile:,rb,0,0,1
"@@ -1,13 +1,14 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
-# SPDX - License - Identifier: Apache - 2.0
+# SPDX-License-Identifier: Apache-2.0
 
+# Purpose:
 # This code example allows a federated user with a limited set of
-# permissions to list the objects in an Amazon S3 bucket.
+# permissions to list the objects in an Amazon Simple Storage Solution (Amazon S3) bucket.
 
+# snippet-start:[s3.ruby.auth_federation_token_request_test.rb]
 # Prerequisites:
 #  - An existing Amazon S3 bucket.
 
-# snippet-start:[s3.ruby.auth_federation_token_request_test.rb]
 require 'aws-sdk-s3'
 require 'aws-sdk-iam'
 require 'json'",Simple Storage **Service**,rb,0,0,0
"@@ -6,6 +6,10 @@ feature ""User creates a subscription"" do
     sign_in
   end
 
+  after do
+    clean_up_stripe_coupons
+  end
+
   scenario ""doesn't create a Stripe subscription with an invalid credit card"" do
     subscribe_with_invalid_credit_card
     expect(current_user).not_to have_active_subscription",Thoughts on having this as a global `after` hook in the file with the Stripe fake?,rb,1,1,1
"@@ -38,12 +38,16 @@
 <% content_for :javascript do %>
 <script type=""text/javascript"">
   function workshop_details(workshop) {
+    if(workshop.online) {
+      return "" Online"";
+    }
+
     var details = [];
     for (var s=0; s<workshop.active_sections.length; s++) {
       details.push(workshop.active_sections[s].section.city);
     }
     if(details.length > 0) {
-      return "" in "" + details.join("" and "");
+      return "" in-person in "" + details.join("" and "");
     } else {
       return """";
     }","What do you think about adding an `else {` block to wrap the rest of this method, instead of using an early return guard?",rb,1,1,1
"@@ -0,0 +1,16 @@
+<% 
+  tool_name = Rails.configuration.branding[:application][:name]
+  helpdesk_email = Rails.configuration.branding[:organisation][:helpdesk_email]
+
+  # Override the default Rails route helper for the contact_us page IF an alternate contact_us url was defined
+  # in the branding config file
+  contact_us = Rails.application.config.branding[:organisation][:contact_us_url] || contact_us_url
+%>
+<p>
+  <%= _('All the best') %>
+  <br />
+  <%= _('The %{tool_name} team') %{:tool_name => tool_name} %>
+</p>
+<p>
+  <%= _('You may change your notification preferences on your profile page.') %>&nbsp;<%= _('Please do not reply to this email.') %>&nbsp;<%= raw(_('If you have any questions or need help, please contact us at %{helpdesk_email} or visit %{contact_us}') %{ :helpdesk_email => mail_to(helpdesk_email, helpdesk_email, subject: email_subject), :contact_us => link_to(contact_us, contact_us) }) %>
+</p>","Nice partial, it was copied/pasted across many mails...",rb,1,0,1
"@@ -76,7 +76,7 @@ public class ProtocolHandshake {
 
         if (result.isPresent()) {
           Result toReturn = result.get();
-          LOG.info(String.format(""Detected dialect: %s"", toReturn.dialect));
+          LOG.finest(String.format(""Detected dialect: %s"", toReturn.dialect));
           return toReturn;
         }
       }",This is an incorrect change. The dialect spoken is an important part of the handshake and should be communicated to users.,rb,1,1,1
"@@ -6,7 +6,7 @@
 
     <%- if params[:q] and params[:search_field] and params[:search_field] != blacklight_config.default_search_field -%>
       <li><%= t 'blacklight.search.zero_results.search_fields', :search_fields => search_field_label(params) %> - 
-      <%= link_to t('blacklight.search.zero_results.search_everything'), url_for(params_for_search(:search_field=>blacklight_config.default_search_field.key)) %>
+      <%= link_to t('blacklight.search.zero_results.search_everything'), params_for_search(:params => params.merge(:search_field=>blacklight_config.default_search_field.key)) %>
       </li>
     <%- end %>
 ",But you are passing one here.,rb,0,0,1
"@@ -44,7 +44,7 @@ public abstract class NewSessionQueue implements HasReadyState {
 
   public abstract boolean offerFirst(HttpRequest request, RequestId requestId);
 
-  public abstract Optional<HttpRequest> poll();
+  public abstract Optional<HttpRequest> poll(RequestId requestId);
 
   public abstract int clear();
 ","The expected behaviour for `poll` would be to match what `Deque` does, which is: > Retrieves and removes the head of the queue represented by this deque As such, you shouldn't need the `RequestId` here.",rb,1,1,1
"@@ -0,0 +1,11 @@
+class AddReadEmailPermission < ActiveRecord::Migration
+  def up
+    add_column :oauth_tokens, :allow_read_email, :boolean, :null => false, :default => false
+    add_column :client_applications, :allow_read_email, :boolean, :null => false, :default => false
+  end
+
+  def down
+    remove_column :client_applications, :allow_read_email
+    remove_column :oauth_tokens, :allow_read_email
+  end
+end",If you make that `def change` then you won't need the `down` routine at all.,rb,1,1,1
"@@ -21,9 +21,12 @@ class PurchasesController < ApplicationController
     end
 
     if @purchase.save
+      create_subscription if @purchaseable.subscription?
+
       km_http_client.record(@purchase.email, ""Submit Payment"", { ""Product Name"" => @purchaseable.name, ""Order Total"" => @purchase.price })
       track_purchase_if_paid(@purchase)
-      redirect_to @purchase.success_url
+
+      redirect_to success_url
     else
       @active_card = retrieve_active_card
       render :new","To follow Tell, Don't Ask here: tell the purchaseable to do something (`@purchaseable.add_to current_user`) and then implement the correct behavior for each type. Inflecting on the `@purchaseable` and then varying behavior here tightly couples the controller to the behavior for this specific purchaseable, and means you'll have to special case every purchaseable type as you add them.",rb,1,1,0
"@@ -0,0 +1,18 @@
+require 'travis/build/appliances/base'
+module Travis
+  module Build
+    module Appliances
+      class MavenCentralMirror < Base
+        GOOGLE_MAVEN_MIRROR='https://maven-central.storage-download.googleapis.com/repos/central/data/'
+        def apply
+          sh.raw bash('travis_maven_central_mirror')
+          sh.raw ""travis_maven_central_mirror #{GOOGLE_MAVEN_MIRROR}""
+        end
+
+        def apply?
+          config[:os] != 'windows'
+        end
+      end
+    end
+  end
+end",can this please be configurable via config as we might not want to set a mirror by default,rb,1,1,1
"@@ -56,6 +56,8 @@ module Travis
           const = self.class.const_get(name.to_s.camelize)
           const.new(script, sh, data, config) if const && run_addon?(const)
         rescue NameError
+        rescue
+          raise Travis::Build::AddonConfigError.new(name)
         end
 
         def addon_config",Does this need to be a bare `rescue`? Would `rescue StandardError => e` with `e` _at least_ being logged be acceptable?,rb,1,1,1
"@@ -16,7 +16,7 @@ describe ClientSummarizer do
 
   describe ""Ncr::WorkOrder"" do
     it ""builds summary"" do
-      wo = create(:ncr_work_order, amount: 123)
+      create(:ncr_work_order, amount: 123)
       summarizer = ClientSummarizer.new(client_namespace: ""Ncr"")
       summary = summarizer.run
       expect(summary.total).to eq(123)",why throw away the variable assignment? and why in this PR?,rb,0,1,1
"@@ -98,7 +98,8 @@ EOF
 
     def generate_blacklight_marc_demo
       if options[:marc]
-        gem ""blacklight-marc"", ""~> 5.0""
+        blacklight_marc = String.new('blacklight-marc')
+        gem blacklight_marc, '~> 6.0'
 
         Bundler.with_clean_env do
           run ""bundle install""",Why this line?,rb,1,0,1
"@@ -64,7 +64,7 @@ module Bolt
              end
 
       data = load_defaults(project).push(
-        filepath: project.config_file,
+        filepath: configfile,
         data: conf,
         logs: logs,
         deprecations: []","If you pass `--configfile /path/to/bolt.yaml`, we will actually load `/path/to/bolt-project.yaml` if it exists. Will this cause us to instead report that we loaded `/path/to/bolt.yaml` when we didn't?",rb,1,1,1
"@@ -2,7 +2,10 @@ class ShowsController < ApplicationController
   layout ""landing_pages""
 
   def show
-    @show = Show.friendly.find(params[:id])
+    @show = ShowListing.new(
+      Show.friendly.find(params[:id]),
+      current_user,
+    )
 
     respond_to do |format|
       format.html do",Put a comma after the last parameter of a multiline method call.,rb,1,1,1
"@@ -21,14 +21,13 @@ class SubscriptionMailer < BaseMailer
     )
   end
 
-  def subscription_receipt(email, plan_name, amount, stripe_invoice_id)
-    @plan_name = plan_name
+  def subscription_receipt(email, amount, stripe_invoice_id)
     @amount = amount
     @stripe_invoice_id = stripe_invoice_id
 
     mail(
       to: email,
-      subject: ""[Learn] Your #{plan_name} receipt and some tips""
+      subject: '[Learn] Your receipt and some tips'
     )
   end
 ",Prefer single-quoted strings when you don't need string interpolation or special symbols.,rb,1,1,1
"@@ -2,6 +2,9 @@ class DashboardsController < ApplicationController
   before_action :authorize
 
   def show
-    @catalog = Catalog.new
+    @topics = TopicsWithResources.new(
+      topics: Topic.dashboard,
+      factory: TopicWithResourcesFactory.new(catalog: Catalog.new)
+    )
   end
 end",There's some duplication in dependency management here which I'd like to resolve in a subsequent pull request by introducing Payload.,rb,1,1,1
"@@ -66,4 +66,15 @@ describe Practice do
       expect(result.map(&:name)).to eq([""Started""])
     end
   end
+
+  describe ""#quizzes"" do
+    it ""returns all the quizzes"" do
+      user = build_stubbed(:user)
+      quiz = create(:quiz)
+
+      practice = Practice.new(user)
+
+      expect(practice.quizzes).to eq([quiz])
+    end
+  end
 end","Since there's only one `quiz`, do you think using `eq` is more direct?",rb,1,1,1
"@@ -76,6 +76,13 @@ describe 'apply_prep' do
       end
     end
 
+    it 'fails if version task is not found' do
+      Puppet::Pal::ScriptCompiler.any_instance.expects(:task_signature).with('puppet_agent::version')
+      is_expected.to run.with_params(hostnames).and_raise_error(
+        Bolt::Error, 'puppet_agent::version could not be found'
+      )
+    end
+
     it 'fails if version check fails' do
       failed_results = Bolt::ResultSet.new(
         targets.map { |t| Bolt::Result.new(t, error: { 'msg' => 'could not get version' }) }",We expect this to happen because users may have used their own puppet_agent package?,rb,1,1,1
"@@ -0,0 +1,14 @@
+require File.expand_path(File.dirname(__FILE__) + '/test_helper.rb')
+
+class TestFakerImage < Test::Unit::TestCase
+  def setup
+    @tester = Faker::Image
+  end
+
+  def test_urls
+    Google::Search::Image.stub :initialize, Google::Search::Image do
+      assert @tester.urls('test',1).is_a?(Array)
+    end
+  end
+
+end",How about now? @tejasbubane,rb,0,0,0
"@@ -110,7 +110,7 @@ class ErrorHandler(object):
                             value = message
                             try:
                                 message = message['message']
-                            except TypeError:
+                            except KeyError:
                                 message = None
                     else:
                         message = value.get('message', None)",could you change this to instead of being a `try.. except` be `message = message.get('message')`,rb,1,1,1
"@@ -36,10 +36,17 @@ module Selenium
       SOCKET_LOCK_TIMEOUT = 45
       STOP_TIMEOUT        = 20
 
+      @executable = nil
+      @missing = ''
+
+      class << self
+        attr_accessor :executable, :missing_text
+      end
+
       attr_accessor :host
 
       def initialize(executable_path, port, *extra_args)
-        @executable_path = executable_path
+        @executable_path = binary_path(executable_path)
         @host            = Platform.localhost
         @port            = Integer(port)
         @extra_args      = extra_args",Is this `@missing_text` ?,rb,1,0,1
"@@ -1,17 +1,11 @@
 <li class=""subscription"">
   <% if subscription.active? %>
     <p><strong><%= subscription.plan.name %></strong> <br /> Active since <%= subscription.created_at.to_s(:simple) %></p>
-    <% if subscription.scheduled_for_cancellation_on %>
+    <% if subscription.scheduled_for_cancellation? %>
       <p><%= t('subscriptions.cancellation_scheduled_on', date: subscription.scheduled_for_cancellation_on.to_s(:simple)) %></p>
     <% end %>
   <% else %>
     <p>Canceled on <%= subscription.deactivated_on.to_s(:simple) %></p>
   <% end %>
-  <% if subscription.active? && subscription.scheduled_for_cancellation_on.blank? %>
-    <%= link_to t('subscriptions.change_plan'), edit_subscription_path %>
-  <% end %>
-  <%= link_to 'View all invoices', subscriber_invoices_path, class: 'invoices' %>
-  <% if subscription.active? && subscription.scheduled_for_cancellation_on.blank? %>
-    <%= link_to t('subscriptions.cancel'), new_subscriber_cancellation_path, class: 'cancel' %>
-  <% end %>
+  <%= render 'subscriptions/management', subscription: subscription %>
 </li>",This compound condition is duplicated above.,rb,1,1,1
"@@ -117,6 +117,19 @@ module Faker
         regexify(bothify(fetch(key)))
       end
 
+      def mercosur_license_plate(legacy_state_abreviation = NOT_GIVEN, state_abreviation: '')
+        key = 'vehicle.mercosur_license_plate'
+        if legacy_state_abreviation != NOT_GIVEN
+          warn_with_uplevel ""Passing `state_abreviation` with the 1st argument of `Vehicle.mercosur_license_plate` is deprecated. Use keyword argument like `Vehicle.mercosur_license_plate(state_abreviation: ...)` instead."", uplevel: 1
+          state_abreviation = legacy_state_abreviation
+        end
+        
+        return regexify(bothify(fetch(key))) if state_abreviation.empty?
+
+        key = key + '.by_state.' + state_abreviation
+        regexify(bothify(fetch(key)))
+      end
+
       def singapore_license_plate
         key = 'vehicle.license_plate'
         plate_number = regexify(bothify(fetch(key)))","Not sure if the `legacy_state_abreviation` is required in this particular case, since there was no previous implementation of this method, so not including it wouldn't be a breaking change.",rb,1,1,1
"@@ -1,5 +1,6 @@
 require 'erb'
 require 'shellwords'
+require 'set'
 
 module RSpec
   module Core","An aside, are we not worried about polluting stdlib here?",rb,0,0,1
"@@ -77,6 +77,6 @@ feature 'An OAuth client authenticates', js: true do
 
   def verify_signed_in_user_details(json, checked_user)
     user = json['user']
-    user['email'].should eq checked_user.email
+    expect(user['email']).to eq checked_user.email
   end
 end",Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,1,1,1
"@@ -61,7 +61,9 @@
     <article>
       <figure id=""bullet-3"" class=""journey-bullet"">3.</figure>
       <h2>Enroll in premium, hands-on video tutorials</h2>
-      <p>Our video tutorials are more than just video tutorials. You&rsquo;ll build real apps and communicate directly with a thoughtbot developer or designer. Begin an online video tutorial as soon as you sign up.</p>
+      <p>Our video tutorials go beyond passive learning. You&rsquo;ll build
+      real apps and communicate directly with a thoughtbot developer or
+      designer. You can begin one as soon as you sign up.</p>
     </article>
     <figure class=""supporting-visual two-stacked"">
       <div>",`You can begin as soon as you sign up.`?,rb,1,0,0
"@@ -0,0 +1,10 @@
+require 'test_helper'
+
+describe 'FeedbacksController' do
+  it 'creates feedback' do
+    assert_difference('Feedback.count') do
+      post :create, feedback: { rating: 5, uuid: 'e91fc264-12345', more_info: 1, project_name: 'Ruby On Rails' }
+    end
+    assert_response :success
+  end
+end",This can be expanded to include the `project_id` and the `ip_address`.,rb,1,1,1
"@@ -7,6 +7,7 @@ require 'optparse'
 module Bolt
   class BoltOptionParser < OptionParser
     OPTIONS = { inventory: %w[nodes targets query rerun description],
+                group: %w[nodes targets query rerun description],
                 authentication: %w[user password private-key host-key-check ssl ssl-verify],
                 escalation: %w[run-as sudo-password],
                 run_context: %w[concurrency inventoryfile save-rerun],","I don't think this command will actually do anything with these options. I'd remove this, and modify the line below to not include it.",rb,1,1,1
"@@ -38,6 +38,9 @@ try:
 except NameError:
     pass
 
+if sys.version > '3':
+    long = int
+
 
 class WebElement(object):
     """"""Represents a DOM element.",Should be `if sys.version_info[0] > 2:`,rb,1,1,1
"@@ -29,7 +29,7 @@ class User < ActiveRecord::Base
   end
 
   def first_name
-    name.split("" "").first
+    name.split(' ').first
   end
 
   def last_name",Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,1,1,1
"@@ -22,8 +22,8 @@ var iam = new AWS.IAM({apiVersion: '2010-05-08'});
 
 iam.getAccessKeyLastUsed({AccessKeyId: 'ACCESS_KEY_ID'}, function(err, data) {
   if (err) {
-    console.log(""Error"", err);
+    throw err;
   } else {
-    console.log(""Success"", data.AccessKeyLastUsed);
+    console.log(""Last Access Key used: "" + data.AccessKeyLastUsed);
   }
 });","I changed all the error console logs to throws, since these examples are written as command line tools. This will cause the script to properly report an error, vs exiting with a successful exit code.",rb,1,1,1
"@@ -1,2 +1,16 @@
 class PagesController < HighVoltage::PagesController
+  include HighVoltage::StaticPage
+
+  layout :layout_for_page
+
+  private
+
+  def layout_for_page
+    case params[:id]
+    when ""tapas-for-teams""
+      ""splash""
+    when ""tapas-for-one""
+      ""splash""
+    end
+  end
 end",Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,1,1,1
"@@ -48,4 +48,8 @@ module ProposalDelegate
   def client
     self.class.client
   end
+
+  def slug_matches?(user)
+    user.client_slug == client
+  end
 end",should we write a little unit test for this so that if it changes we have a test failure?,rb,1,1,1
"@@ -1,5 +1,5 @@
 <div id=""blacklight-modal"" class=""modal fade"" tabindex=""-1"" role=""dialog"" aria-labelledby=""modal menu"" aria-hidden=""true"">
-  <div class=""modal-dialog"" role=""document"">
+  <div class=""modal-dialog modal-lg"" role=""document"">
     <div class=""modal-content"">
     </div>
   </div>",Would it be useful for us to make this configurable/easily overridable in some way? It might be useful to have smaller modals particularly if a dev never configures a facet to use the A-Z pagination. \\_()_/,rb,1,1,1
"@@ -1,5 +1,5 @@
 module DashboardsHelper
-  def learn_live_link(&block)
+  def upcase_live_link(&block)
     if current_user_has_access_to?(:office_hours)
       link_to OfficeHours.url, target: ""_blank"", &block
     else",maybe just `chat_room_link`?,rb,1,1,1
"@@ -600,7 +600,7 @@ img.intercom-interblocks-article-author-avatar-image {
 
 <p>Hi <%= @user.first_name %>,</p>
 
-<p><%= @video.email_body_text %></p>
+<p><%= @html_content %></p>
 
 <p style=""text-align: center"">
 <ic-block data-generated-at=""14775965965790.22154604114587806"" data-type=""button"" data-link-url=""<%= video_url(@video, @utm_params) %>"" data-text=""Check it Out"" data-id=""block-ember4053"" data-align=""center""><zws>&#8203;</zws><insert contenteditable=""false""><insert-point></insert-point></insert><a class=""intercom-h2b-button"" href=""<%= video_url(@video, @utm_params) %>"" contenteditable=""false""><%= @video.email_cta_label %></a><insert contenteditable=""false""><insert-point></insert-point></insert><zws>&#8203;</zws></ic-block>",I think you'll need an HTML safe somewhere to get the uneacapef HTML.,rb,1,1,1
"@@ -269,8 +269,12 @@ module Beaker
     def get_domain_name(host)
       domain = nil
       search = nil
-      if ((host['platform'] =~ /windows/) and not host.is_cygwin?)
-        resolv_conf = host.exec(Command.new('type C:\Windows\System32\drivers\etc\hosts')).stdout
+      if host['platform'] =~ /windows/
+        if host.is_cygwin?
+          resolv_conf = host.exec(Command.new(""cat /cygdrive/c/Windows/System32/drivers/etc/hosts"")).stdout
+        else
+          resolv_conf = host.exec(Command.new('type C:\Windows\System32\drivers\etc\hosts')).stdout
+        end
       else
         resolv_conf = host.exec(Command.new(""cat /etc/resolv.conf"")).stdout
       end","I'm not a fan of hardcoded system drives, but if it works...",rb,1,0,1
"@@ -374,6 +374,14 @@ module Asciidoctor
       result = []
       pgwide_attribute = (node.option? 'pgwide') ? ' pgwide=""1""' : nil
       result << %(<#{tag_name = node.title? ? 'table' : 'informaltable'}#{common_attributes node.id, node.role, node.reftext}#{pgwide_attribute} frame=""#{node.attr 'frame', 'all'}"" rowsep=""#{['none', 'cols'].include?(node.attr 'grid') ? 0 : 1}"" colsep=""#{['none', 'rows'].include?(node.attr 'grid') ? 0 : 1}"">)
+
+      if (node.option? 'breakable')
+        result << %(<?dbfo keep-together=""auto""?>)
+      end 
+      else if (node.option? 'unbreakable')
+        result << %(<?dbfo keep-together=""always""?>)
+      end 
+
       result << %(<title>#{node.title}</title>) if tag_name == 'table'
       if (width = (node.attr? 'width') ? (node.attr 'width') : nil)
         TABLE_PI_NAMES.each do |pi_name|",Could you remove this `end` and use `elseif` on the next line instead of `else if`? You can see similar examples elsewhere in this file.,rb,1,1,1
"@@ -1,6 +1,7 @@
 <div class=""row"">
   <div class=""col-md-12"">
     <h1>Usage statistics</h1>
+    <p><%= _('Use the filters to generate organisational usage statistics for a custom date range. The graphs display new users and plans for your organisation over the past year. You can download a CSV report for each graph.') %></p>
   </div>
 </div>
 <div class=""row"">","this hint should help to mitigate any confusion, nite to see it",rb,1,0,1
"@@ -46,7 +46,7 @@ module RSpec
 
           examples.select do |ex|
             file_scoped_include?(ex.metadata, ids, locations) do
-              !exclusions.include_example?(ex) && non_scoped_inclusions.include_example?(ex)
+              (exclusions.empty? || !exclusions.include_example?(ex)) && non_scoped_inclusions.include_example?(ex)
             end
           end
         end",Why? (not had enough   yet   ),rb,1,0,0
"@@ -0,0 +1,17 @@
+RSpec.configure do |config|
+  config.before do
+    allow(Kernel).to receive(:srand).and_raise NotImplementedError,
+      ""#{Kernel}.srand should always be stubbed or mocked. "" +
+      ""This appears to be an unintended call.""
+
+    allow(RSpec::Core::Random).to receive(:srand).and_raise NotImplementedError,
+      ""#{RSpec::Core::Random}.srand should always be stubbed or mocked. "" +
+      ""This appears to be an unintended call.""
+
+    if defined?(::Random)
+      allow(::Random).to receive(:srand).and_raise NotImplementedError,
+        ""#{::Random}.srand should always be stubbed or mocked. "" +
+        ""This appears to be an unintended call.""
+    end
+  end
+end",Why did you feel the need to add these checks? I'm not sure what I think of them yet....,rb,1,0,1
"@@ -13,6 +13,9 @@ module BrowseHelper
     if version
       name = t 'printable_name.with_version', :id => name, :version => object.version.to_s
     end
+    # stop here if redacted to avoid giving away redacted version tags.
+    return name if object.redacted?
+
     if object.tags.include? ""name:#{I18n.locale}""
       name = t 'printable_name.with_name',  :name => object.tags[""name:#{I18n.locale}""].to_s, :id => name
     elsif object.tags.include? 'name'","I think I'd rather have `unless object.redacted?` around the next block rather than an early return, which is generally considered bad form.",rb,1,1,1
"@@ -11,6 +11,19 @@ class Subscription < ActiveRecord::Base
   validates :plan_type, presence: true
   validates :user_id, presence: true
 
+  def self.restarting_today
+    where.not(deactivated_on: nil).
+      where(
+        reactivated_on: nil,
+        scheduled_for_reactivation_on: Time.zone.today,
+      )
+  end
+
+  def self.restarting_in_two_days
+    where.not(deactivated_on: nil).
+      where(scheduled_for_reactivation_on: Time.zone.today + 2.days)
+  end
+
   def self.canceled_in_last_30_days
     canceled_within_period(30.days.ago, Time.zone.now)
   end",Indent ) the same as the start of the line where ( is.,rb,1,1,1
"@@ -20,7 +20,7 @@ class OrganizationDecorator < Cherry::Decorator
 
   class << self
     def select_options
-      options = Organization.active.order('lower(name)').pluck(:name, :id)
+      options = Organization.active.select(:name, :id).order('lower(name)').map { |org| [org.name, org.id] }
       options.unshift(['Unaffiliated', ''])
       options.push(['Other', ''])
     end","Is this change driven by function, style, performance or some other consideration?",rb,1,1,1
"@@ -83,7 +83,7 @@ describe Query::Proposal::Search, elasticsearch: true do
       user = create(:user, client_slug: ""test"")
 
       proposal1 = create(:proposal, id: 199, requester: user)
-      test_client_request1 = create(:test_client_request, proposal: proposal1)
+      create(:test_client_request, proposal: proposal1)
       proposal1.reindex
 
       test_client_request2 = create(:test_client_request, project_title: ""199 rolly chairs for 1600 Penn Ave"")",why throw away the return value?,rb,1,1,1
"@@ -258,6 +258,10 @@ module Travis
           # information.
           dump_log(""out"")
 
+          # If a fold (like dump log) is the last command it is not folded, so
+          # add a dummy command
+          sh.cmd 'TRUE', echo: false
+
           # Check revdeps, if requested.
           if @devtools_installed and config[:r_check_revdep]
             sh.echo ""Checking reverse dependencies""","I don't think this works. If you want a command that does nothing, you can try `true`, `;`, or `:`.",rb,1,1,1
"@@ -1,4 +1,7 @@
 class SubscribeOldChangesets < ActiveRecord::Migration[4.2]
+  class Changeset < ActiveRecord::Base
+  end
+
   def up
     Changeset.find_each do |changeset|
       changeset.subscribers << changeset.user unless changeset.subscribers.exists?(changeset.user.id)",I think this will fail if there are changesets in the database as the migration relies on the `subscribers` and `user` associations on the changeset.,rb,1,1,1
"@@ -120,8 +120,8 @@ describe Mongoid::Clients::Factory do
 
             let(:config) do
               {
-                default: { hosts: [ ""127.0.0.1:27017"" ], database: database_id },
-                secondary: { uri: ""mongodb://127.0.0.1:27017,127.0.0.1:27018/mongoid_test"" }
+                default: { hosts: [ ""127.0.0.1:30000"" ], database: database_id },
+                secondary: { uri: ""mongodb://127.0.0.1:30000,127.0.0.1:30001/mongoid_test"" }
               }
             end
 ","Because of the SDAM changes in the driver since the last release, this test broke when run with the master branch of the driver due to the host on localhost:27017 being removed (the warning said it was because it was a standalone and there were multiple seeds). Given that the tests don't actually need to do anything with the server, I figured it was easier to just change the ports to ones that we never actually run tests against.",rb,1,1,1
"@@ -19,6 +19,8 @@ package org.openqa.grid.web;
 
 import com.google.common.collect.Maps;
 
+import com.sun.org.glassfish.gmbal.ManagedObject;
+
 import org.openqa.grid.internal.Registry;
 import org.openqa.grid.internal.utils.GridHubConfiguration;
 import org.openqa.grid.web.servlet.DisplayHelpServlet;",And again. The reason it's bad is that if someone uses a JDK not produced by Oracle they won't have this class.,rb,0,1,1
"@@ -26,7 +26,7 @@ module Unix
         'puppetbin'        => '/opt/puppet/bin/puppet',
         'puppetbindir'     => '/opt/puppet/bin',
         'puppetsbindir'    => '/opt/puppet/sbin',
-        'systembindir'     => '/opt/puppet/bin',
+        'privatebindir'    => '/opt/puppet/bin',
         'puppetvardir'     => '/var/opt/lib/pe-puppet',
         'hieradatadir'     => '/var/lib/hiera',
         'hieraconf'        => '/etc/puppetlabs/puppet/hiera.yaml',","@kevpl I just noticed the PE default is wrong, it needs to be the same as AIO (/opt/puppetlabs/puppet/bin). Not an issue currently, but something we'll need to come back to.",rb,0,0,1
"@@ -212,7 +212,14 @@ module Blacklight
     end
 
     def search_builder_class
-      super || Blacklight::Solr::SearchBuilder
+      super || locate_search_builder_class
+    end
+
+    def locate_search_builder_class
+      ::SearchBuilder
+    rescue NameError
+      Deprecation.warn(Configuration, ""Your application is missing the SearchBuilder. Have you run `rails generate blacklight:search_builder`? Falling back to Blacklight::Solr::SearchBuilder"")
+      Blacklight::Solr::SearchBuilder
     end
 
     def default_per_page",Do we really need to deprecation `Blacklight::Solr::SearchBuilder`? It seems like it works fine as-is for common uses..,rb,1,1,1
"@@ -25,8 +25,14 @@ module Bolt
     # hierarchy, falling back to the default if we reach the root.
     def self.find_boltdir(dir)
       dir = Pathname.new(dir)
-      if (dir + BOLTDIR_NAME).directory?
-        new(dir + BOLTDIR_NAME, 'embedded')
+      # allows for any case of Boltdir, BoltDir, boltdir, etc
+      # note: we're sorting the directories here so that we consistently pick the
+      #       same Boltdir between runs, and we always choose the lexicographical ""less""
+      #       Boltdir name rather than whatever the first name we run into as returned by
+      #       the filesystem
+      boltdirs = dir.children.sort.select { |c| c.directory? && c.basename.to_s.casecmp?(BOLTDIR_NAME) }
+      if !boltdirs.empty?
+        new(boltdirs.first, 'embedded')
       elsif (dir + 'bolt.yaml').file? || (dir + 'bolt-project.yaml').file?
         new(dir, 'local')
       elsif dir.root?",We should issue a warning and say which one we're using if more than one is found.,rb,1,1,1
"@@ -0,0 +1,19 @@
+class NameUnnamedRedactions < ActiveRecord::Migration[5.0]
+  def self.up
+  	# after titles are fixed we change the column so to not be null
+    change_column_null ""redactions"", ""title"", false
+    # gets each redaction
+    # sets redaction title equal to a string of the id if there is no title
+    Redaction.find_each do |redaction|
+      if redaction.title.empty?
+        redaction.title = redaction.id.to_s
+        redaction.save!
+      end
+    end
+  end
+
+  def self.down
+  	# for down-migration we allow title column to be null
+    change_column_null ""redactions"", ""title"", true
+  end
+end","I think you might need to fill in the titles first, and then change the column constraint afterwards.",rb,1,1,1
"@@ -7,12 +7,13 @@ class PostsController < ApplicationController
   before_action :find_forum_and_topic_records, only: [:create]
 
   def index
-    @posts = Post.paginate(page: params[:page], per_page: 10)
+    all_posts = Post.all
+    @posts = all_posts.paginate(page: params[:page], per_page: 10)
   end
 
   def create
     @post = build_new_post
-    if verify_recaptcha(model: @post) && @post.save
+    if @post.save
       post_notification(@post)
       redirect_to topic_path(@topic)
     else",This looks better the previous way.,rb,1,0,1
"@@ -1,7 +1,7 @@
 require 'test_helper'
 
 class PersonTest < ActiveSupport::TestCase
-  before { Rails.cache }
+  before { Person::Cached.stubs(:count).returns(Person.count) }
 
   describe 'searchable_factor' do
     let(:person) { create(:account).person }",I thought we were going to remove the `Person::Cached` class based upon our decision to not implement caching in the ohloh-ui code at this time and that we would like to try relying on the Rails 4 Russian Doll Caching model of view fragments.,rb,1,1,1
"@@ -0,0 +1,19 @@
+class ConvertAttachmentToPaperclip < ActiveRecord::Migration
+  def self.up
+    change_table :attachments do |attachment|
+      attachment.rename :filename, :attachment_file_name
+      attachment.rename :size, :attachment_file_size
+      attachment.rename :content_type, :attachment_content_type
+      attachment.datetime :attachment_updated_at 
+
+      # Removing child thumbnails as its not required for paperclip 
+      Attachment.delete_all(""parent_id is not null"")
+
+      attachment.remove :parent_id, :thumbnail, :width, :height, :is_default
+    end
+  end
+
+  def self.down
+    raise ActiveRecord::IrreversibleMigration, ""Cannot recover deleted data""
+  end
+end","This was a change from the `change` method to `self.up` and `self.down` with the `IrreversibleMigration`, isn't it? I think we missed the restriction that we do not want any migrations in the ohloh-ui repository: they all have to be in the ohloh repository for tracking. That said; we would not be able to apply this migration until we are ready to deploy PURR in to production since it would break the `attachment` model. However, we would want to run this migration every Monday after successful restoration of the production database into ohloh-qa-db.",rb,1,1,0
"@@ -20,7 +20,7 @@ module RSpec
         # @example
         #    format_duration(1) #=>  ""1 minute 1 second""
         #    format_duration(135.14) #=> ""2 minutes 15.14 seconds""
-        def format_duration(duration)
+        def self.format_duration(duration)
           precision = case
                       when duration < 1;    SUB_SECOND_PRECISION
                       when duration < 120;  DEFAULT_PRECISION","Should these be module functions instead, so `Helpers` can still act like a module? ""Class"" methods on modules have always confused me.",rb,1,1,1
"@@ -98,7 +98,7 @@ class ProposalPolicy
 
   def pending_approval!
     check(self.pending_approver? || self.pending_delegate?,
-          ""A response has already been logged a response for this proposal"")
+          ""A response has already been logged for this proposal"")
   end
 
   def visible_proposals","would it be possible to do something like`""This proposal has already been approved by #{approver.email_address}""` ? are there situations other than an already approved proposal where someone would see this error msg?",rb,1,1,1
"@@ -187,6 +187,16 @@ describe Blacklight::SearchBuilder do
     end
   end
 
+  describe ""#facet"" do
+    it ""should be nil if no value is set"" do
+      expect(subject.facet).to be_nil
+    end
+
+    it ""should set facet value"" do
+      expect(subject.facet('format').facet).to eq 'format'
+    end
+  end
+
   describe ""#search_field"" do
     it ""should use the requested search field"" do
       blacklight_config.add_search_field 'x'",Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,1,1,1
"@@ -91,6 +91,14 @@ module Bolt
       Logging.logger[:root].appenders.any?
     end
 
+    def self.stream
+      @stream
+    end
+
+    def self.stream=(stream)
+      @stream = stream
+    end
+
     # A helper to ensure the Logging library is always initialized with our
     # custom log levels before retrieving a Logger instance.
     def self.logger(name)","If `@stream` is set from `configure`, then we could probably just update this to be a single `stream?` method that can be called from the shell classes?",rb,1,1,1
"@@ -0,0 +1,17 @@
+require 'travis/build/appliances/base'
+
+module Travis
+  module Build
+    module Appliances
+      class NpmRegistry < Base
+        def apply
+          if data[:npm_registry]
+            sh.fold ""npm_registry"" do
+              sh.export 'NPM_CONFIG_REGISTRY', data[:npm_registry], echo: true
+            end
+          end
+        end
+      end
+    end
+  end
+end",This logic should be moved to `apply?`.,rb,0,1,1
"@@ -1,9 +1,12 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 # SPDX - License - Identifier: Apache - 2.0
 
+# Purpose
 # This code example demonstrates how to use an RSA public key to
 # encrypt content and then upload that encrypted content
-# to an Amazon S3 bucket.
+# to an Amazon Simple Storage Solution (Amazon S3) bucket.
+
+# snippet-start:[s3.ruby.s3_add_cspk_encrypt_item]
 
 require 'aws-sdk-s3'
 require 'openssl'",Simple Storage **Service**,rb,0,0,0
"@@ -117,7 +117,7 @@ Puppet::Functions.create_function(:run_plan, Puppet::Functions::InternalFunction
         # undef/nil
         result = catch(:return) do
           scope.with_global_scope do |global_scope|
-            closure.call_by_name_with_scope(global_scope, params, true)
+            executor.run_plan(global_scope, closure, params)
           end
           nil
         end&.value",@McdonaldSeanp I think this will help you longterm too but heads up.,rb,0,0,1
"@@ -7,12 +7,14 @@ class Cart < ActiveRecord::Base
   has_many :approvals
   has_many :approval_users, through: :approvals, source: :user
   has_one :approval_group
+  has_many :user_roles, through: :approval_group
   has_one :api_token
   has_many :comments, as: :commentable
   has_many :properties, as: :hasproperties
 
   #TODO: after_save default status
   #TODO: validates_uniqueness_of :name
+  validates :flow, presence: true, inclusion: {in: ApprovalGroup::FLOWS}
 
 
   def update_approval_status","Consider adding a validation for flow on ApprovalGroup too. Looking ahead to building out the UI for adding an approval group, we would likely need to give the admins the ability to indicate it there.",rb,1,1,1
"@@ -8,7 +8,12 @@ module Blacklight
       # @param [Array<String>] options explicit spellcheck options to render
       def initialize(response:, options: nil)
         @response = response
-        @options = options || @response&.spelling&.words
+        @options = options
+        if @response&.spelling&.collation
+          @options = [@response.spelling.collation]
+        elsif @response&.spelling&.words
+          @options = response.spelling.words
+        end
       end
 
       def link_to_query(query)","There's a change in behavior here that I don't think is intentional: Prior to the PR, a passed options param will always provide the value of `@options`; here, either form of spelling suggestion will override it. Was this intentional?",rb,0,1,1
"@@ -255,7 +255,7 @@ module Blacklight::UrlHelperBehavior
 
     # Delete any request params from facet-specific action, needed
     # to redir to index action properly. 
-    new_params.except! *Blacklight::Solr::FacetPaginator.request_keys.values
+    new_params.except! *blacklight_config.facet_paginator_class.request_keys.values
 
     new_params 
   end",Line is too long. [83/80],rb,1,1,1
"@@ -1,6 +1,6 @@
 FactoryGirl.define do
   factory :user do
-    client_slug { ENV['CLIENT_SLUG_DEFAULT'] || 'ncr' }
+    client_slug { ENV['CLIENT_SLUG_DEFAULT'] || nil }
     sequence(:email_address) {|n| ""user#{n}@example.com"" }
     sequence(:first_name) {|n| ""FirstName#{n}"" }
     sequence(:last_name) {|n| ""LastName#{n}"" }","maybe we should just set to `nil` rather than using env var? I haven't ever set it, so not sure what the use case for env var is.",rb,1,1,1
"@@ -526,6 +526,7 @@ module Bolt
     end
 
     def apply_manifest(code, targets, filename = nil, noop = false)
+      Puppet[:tasks] = false
       ast = pal.parse_manifest(code, filename)
 
       executor = Bolt::Executor.new(config.concurrency, analytics, noop)",Was this a bug?,rb,1,0,1
"@@ -0,0 +1,15 @@
+# frozen_string_literal: truer
+
+equire_relative 'test_helper'
+
+def setup
+  @tester = Faker::GratefulDead
+end
+
+def test_player
+  assert @tester.player.match(/\w/)
+end
+
+def test_song
+  assert @tester.song.match(/\w/)
+end",It should be `true` instead of `truer`.,rb,1,1,1
"@@ -27,10 +27,11 @@ class IdentifierPresenter
     return _(""None defined"") if id.new_record? || id.value.blank?
 
     without = id.value_without_scheme_prefix
-    return id.value unless without != id.value && !without.starts_with?(""http"")
+    prefix = with_scheme_name ? id.identifier_scheme.description + "": "" : ''
+    return prefix + id.value unless without != id.value && !without.starts_with?(""http"")
 
     ""<a href=\""#{id.value}\"" class=\""has-new-window-popup-info\""> "" \
-      ""#{with_scheme_name ? id.identifier_scheme.description : ''}: #{without}</a>""
+      ""#{prefix} #{without}</a>""
   end
 
   private",Looks like rubocop prefers double quotes for the final `''` here,rb,1,1,1
"@@ -20,9 +20,17 @@ module Mongoid
   # against the database.
   class Criteria
     include Enumerable
+
+    # @api private
+    alias :_enumerable_find :find
+
     include Contextual
     include Queryable
     include Findable
+
+    # @api private
+    alias :_findable_find :find
+
     include Inspectable
     include Includable
     include Marshalable",why not put the aliases in the `Findable` module (inside the `included do` block)?,rb,1,1,1
"@@ -23,7 +23,7 @@
       .imagery(iD.data.imagery)
       .taginfo(iD.services.taginfo())
       .embed(true)
-      .assetPath(""/iD/"") <%# Cant use asset_path('iD/') in production. %>
+      .assetPath(""iD/"")
       .assetMap(<%= assets(""iD"").to_json.html_safe %>)
       .locale(""<%= locale %>"", ""<%= asset_path(""iD/locales/#{locale}.json"") %>"")
       .preauth({",Do we know why this didn't work in production before and does now?,rb,1,0,1
"@@ -11,6 +11,10 @@ module ProductsHelper
     ""https://upcase.com/video_tutorials/21-intermediate-ruby-on-rails""
   end
 
+  def state_class_for(exercise)
+    exercise.status_for(current_user).state.parameterize
+  end
+
   def exercise_link(url, options = {}, &block)
     if current_user_has_access_to?(:exercises)
       link_to url, options, &block","This is going to run a lot of queries on the dashboard and products index; I'm not sure it will perform acceptably. When displaying the tooltips for trails, we'll have an `ExerciseWithProgress`, which will respond to `state`. One option would be to use this and define a default, empty `state` on `Exercise`. Thoughts?",rb,1,1,1
"@@ -0,0 +1,7 @@
+# frozen_string_literal: true
+# encoding: utf-8
+
+class Order
+  include Mongoid::Document
+  field :status, type: Mongoid::StringifiedSymbol
+end",Please add a newline a the end of file.,rb,1,1,1
"@@ -3,7 +3,7 @@ FactoryGirl.define do
 
   factory :api_token do
     access_token
-    step
+    step { create(:approval_step) }
     expires_at { Time.current + 7.days }
   end
 end",this is the actual fix?,rb,1,0,1
"@@ -34,5 +34,6 @@
     <%= if_administrator(:li) do %>
       <%= link_to t('diary_entry.diary_entry.hide_link'), hide_diary_entry_path(:display_name => diary_entry.user.display_name, :id => diary_entry.id), :method => :post, :data => { :confirm => t('diary_entry.diary_entry.confirm') } %>
     <% end %>
+
   </ul>
 </div>",The whole change for this file is this empty line. Is it right?,rb,1,1,1
"@@ -1,9 +1,10 @@
 <figure class=""tile weekly-iteration <%= topic_slugs(video) %>"">
   <%= link_to video, title: video.name do %>
-    <%= render video.teachers %>
-    <h2>Weekly Iteration</h2>
     <h1><%= video.name %></h1>
-    <h3><%= teacher_names(video.teachers) %></h3>
-    <p class=""description""><%= truncate_html(format_markdown(video.notes)) %></p>
+    <%= render video.teachers %>
+    <h3 class=""teacher-names""><%= teacher_names(video.teachers) %></h3>
+    <p class=""description"">
+      <%= truncate_html(video.summary_or_notes, length: 250) %>
+    </p>
   <% end %>
 </figure>","I see `video.summary || video.notes` being used in more than one place, which suggests it might be business logic. How about `video.summary_or_notes`, or `video.description`?",rb,1,1,1
"@@ -14,7 +14,7 @@ HTTP_ERRORS = [Timeout::Error,
                Net::HTTPHeaderSyntaxError,
                Net::ProtocolError]
 
-SMTP_SERVER_ERRORS = [TimeoutError,
+SMTP_SERVER_ERRORS = [Timeout::Error,
                       IOError,
                       Net::SMTPUnknownError,
                       Net::SMTPServerBusy,",Freeze mutable objects assigned to constants.,rb,1,0,1
"@@ -1,5 +1,11 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
-# SPDX - License - Identifier: Apache - 2.0
+# SPDX-License-Identifier: Apache-2.0
+
+# Purpose
+# s3-ruby-example-access-permissions.rb demonstrates how to set the access control list (ACL) for an
+# Amazon Simple Storage Solution (Amazon S3) bucket for public access.
+
+# snippet-start:[s3.ruby.s3-ruby-example-access-permissions]
 
 require 'aws-sdk-s3'
 require 'net/http'",Simple Storage **Service**,rb,0,0,0
"@@ -1,5 +1,18 @@
 feature ""Approve a Gsa18F procurement"" do
   context ""when signed in as the approver"" do
+    context ""last step is completed"" do
+      it ""sends one email to the requester"" do
+        procurement.individual_steps.first.complete!
+        deliveries.clear
+
+        login_as(purchaser)
+        visit proposal_path(proposal)
+        click_on(""Mark as Purchased"")
+
+        expect(deliveries.length).to eq(1)
+      end
+    end
+
     it ""the step execution button is correctly marked"" do
       login_as(approver)
 ",Would it be useful to ensure it sent the message to the right person?,rb,1,1,1
"@@ -0,0 +1,13 @@
+<!-- We participate in the US government's analytics program. See the data at analytics.usa.gov. -->
+<script id=""_fed_an_ua_tag"" src=""https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js""></script>
+<!-- 18F analytics -->
+<script>
+  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
+  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
+  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
+  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
+
+  ga('create', 'UA-48605964-27', 'auto');
+  ga('set', 'anonymizeIp', true);
+  ga('send', 'pageview');
+</script>","Probably a good idea to set this as an environmental variable/setting, if only to allow us swap it out in different environments.",rb,1,1,1
"@@ -0,0 +1,7 @@
+class CompareRepositoriesController < ApplicationController
+  before_action :tool_context, only: :index
+
+  def chart
+    render json: RepositoryComparisionChart.build.to_json, layout: false
+  end
+end","Hey Alex, if RepositoryComparisonChart is a module why is it that line 5 does not fail if it wasn't included in this file?",rb,0,1,1
"@@ -1,4 +1,4 @@
-class ReplaceRegistrationLinkWithChargifyIdOnSections < ActiveRecord::Migration
+class ReplaceRegistrationLinkWithChargifyIdOnSections < ActiveRecord::Migration[4.2]
   def self.up
     remove_column :sections, :registration_link
     add_column :sections, :chargify_id, :string",Metrics/LineLength: Line is too long. [84/80],rb,1,1,1
"@@ -26,6 +26,7 @@ module Ncr
     before_validation :normalize_values
     before_update :record_changes
 
+    validates :amount, presence: true
     validates :cl_number, format: {
       with: /\ACL\d{7}\z/,
       message: ""must start with 'CL', followed by seven numbers""",spec for this? Looks like we don't have any validation specs in the spec file for this model -- would love to hear about why! Is there a philosophical opposition to specs for AR validations (I know many hold the view that they are not important because it's basically just double checking that you wrote a validation rather than testing behavior),rb,1,1,0
"@@ -41,6 +41,16 @@ describe RSpec do
     end
   end
 
+  describe "".current_example"" do
+    it ""sets the example being executed"" do
+      group = RSpec::Core::ExampleGroup.describe(""an example group"")
+      example = group.example(""an example"")
+
+      RSpec.current_example = example
+      expect(RSpec.current_example).to be(example)
+    end
+  end
+
   describe ""::reset"" do
     it ""resets the configuration and world objects"" do
       config_before_reset = RSpec.configuration",This spec seems to duplicate the one above (IMO) -- is there anything new being tested here?,rb,1,1,1
"@@ -20,6 +20,7 @@ from selenium.common.exceptions import NoSuchFrameException
 from selenium.common.exceptions import StaleElementReferenceException
 from selenium.common.exceptions import WebDriverException
 from selenium.common.exceptions import NoAlertPresentException
+from selenium.common.exceptions import ElementNotVisibleException
 
 """"""
  * Canned ""Expected Conditions"" which are generally useful within webdriver",Is this an oversight for some code in the body?,rb,1,1,1
"@@ -28,11 +28,15 @@
 #  template_id                       :integer
 #  org_id                            :integer
 #  funder_id                         :integer
+#  grant_id                          :integer
+#  api_client_id                     :integer
 #
 # Indexes
 #
-#  index_plans_on_template_id  (template_id)
-#  index_plans_on_funder_id    (funder_id)
+#  index_plans_on_template_id   (template_id)
+#  index_plans_on_funder_id     (funder_id)
+#  index_plans_on_grant_id      (grant_id)
+#  index_plans_on_api_client_id (api_client_id)
 #
 # Foreign Keys
 #",We can do a pass through the code for all these TODO's after the Rails 5 migration. Thanks for keeping these up to date,rb,1,1,1
"@@ -4,6 +4,8 @@ class OrgsController < ApplicationController
 
   include OrgSelectable
 
+  skip_before_action :verify_authenticity_token, only: %w[search]
+
   after_action :verify_authorized, except: %w[
     shibboleth_ds shibboleth_ds_passthru search
   ]",switch to pass auth token,rb,1,0,1
"@@ -16,6 +16,11 @@
     <span class=""divider"">
       <h4 class=""text"">Video</h4>
     </span>
+
+    <% if @video.trail.present? %>
+      <%= render ""trails/progress"", trail: @video.trail %>
+    <% end %>
+
     <%= render @video.preview, name: @video.name %>
 
     <section class='video-notes'>","I couldn't get this working locally, so it probably looks rough around the edges",rb,1,1,1
"@@ -82,7 +82,7 @@ module Mongoid
     def extract_embedded_attributes(attributes)
       atomic_position.split(""."").inject(attributes) do |attrs, part|
         attrs = attrs[part =~ /\d/ ? part.to_i : part]
-        attrs
+        attrs || {}
       end
     end
   end","I don't think this is correct. If there are not attributes at the specified path (`atomic_position`), this method should probably return nil and the docstring should be updated to reflect that.",rb,1,1,1
"@@ -18,6 +18,8 @@ module RSpec::Core
       @failed_examples = []
       @pending_examples = []
       @duration = @start = @load_time = nil
+      @profiler = Profiler.new
+      register_listener @profiler, *Profiler::NOTIFICATIONS
     end
 
     # @private",:+1: I much prefer having this owned by the reporter rather than config.,rb,1,1,1
"@@ -36,7 +36,6 @@
                     plan: nil,
                     phase: phase,
                     readonly: true,
-                    question_guidance: {},
                     edit: false,
                     guidance_groups: [],
                     base_template_org: template.base_org,",Removed unused variable.,rb,1,1,1
"@@ -0,0 +1,5 @@
+package org.openqa.selenium.grid.session.remote;
+
+public class SessionTest {
+
+}",And another empty test. Please remove until there's content.,rb,1,1,1
"@@ -450,6 +450,14 @@ class Plan < ActiveRecord::Base
     end
   end
 
+  ## Update plan identifier.
+  #
+  # Returns Boolean
+  def add_identifier!(identifier)
+    self.update(identifier: identifier)
+    save!
+  end
+
   ##
   # Whether or not the plan is associated with users other than the creator
   #",I like this being a function on the plan model so we can update it's behavior if we decide to go with some kind of identifier other than the plan's ID,rb,1,1,1
"@@ -20,6 +20,8 @@ C2::Application.routes.draw do
   match ""/auth/:provider/callback"" => ""auth#oauth_callback"", via: [:get]
   get ""/auth/failure"" => ""auth#failure""
   post ""/logout"" => ""auth#logout""
+  resources :users, only: [:update]
+
   resources :help, only: [:index, :show]
 
   # mandrill-rails",Sweet! +100 for the better security and standards-compliance this change gives us.,rb,1,0,1
"@@ -1,7 +1,7 @@
 Puppet::DataTypes.create_type('Target') do
   interface <<-PUPPET
     attributes => {
-      host => String[1],
+      uri => String[1],
       options => { type => Hash[String[1], Data], value => {} }
     }
     PUPPET",I don't think we have any tests that use this.,rb,0,1,1
"@@ -227,14 +227,14 @@ module RSpec
               rescue Pending::SkipDeclaredInExample
                 # no-op, required metadata has already been set by the `skip`
                 # method.
-              rescue Exception => e
+              rescue AllExceptionsExcludingDangerousOnesOnRubiesThatAllowIt => e
                 set_exception(e)
               ensure
                 run_after_example
               end
             end
           end
-        rescue Exception => e
+        rescue Support::AllExceptionsExceptOnesWeMustNotRescue => e
           set_exception(e)
         ensure
           @example_group_instance = nil # if you love something... let it go",Namespaced here but not above?,rb,0,1,1
"@@ -14,12 +14,12 @@ module CommunicartMailerHelper
     end
   end
 
-  def approve_all_url(approval)
+  def approve_all_url(approval, action = 'approve')
     approval_response_url(
       cart_id: approval.cart_id,
       user_id: approval.user_id,
       cch: approval.api_token.access_token,
-      approver_action: 'approve'
+      approver_action: action
     )
   end
 end","Last thing! Can we update the method name, since it's not always for approvals?",rb,1,1,1
"@@ -2,6 +2,7 @@
 
 require 'pathname'
 require 'bolt/pal'
+require 'bolt/config'
 
 module Bolt
   class Project","This circular dependency seems weird, but I don't think we can remove the project dependency from config and I'm not sure where else to put `system_path` that makes sense...",rb,1,1,1
"@@ -161,6 +161,17 @@ module Beaker
       FileUtils.rm_rf(@vagrant_path)
     end
 
+    #snapshotting depends on https://github.com/scalefactory/vagrant-multiprovider-snap
+    def take_snapshot(hostname,snapshot_name)
+      @logger.debug ""Creating snapshot of #{hostname}""
+      vagrant_cmd(""snap take #{hostname} --name=#{snapshot_name}"")
+    end
+
+    def restore_snapshot(hostname,snapshot_name)
+      @logger.debug ""Restoring snapshot of #{hostname}""
+      vagrant_cmd(""snap rollback #{hostname} --name=#{snapshot_name}"")
+    end
+
     def vagrant_cmd(args)
       Dir.chdir(@vagrant_path) do
         exit_status = 1","I know that the rest of this file isn't properly yard doc-ed, but please include yard docs for any new methods.",rb,1,1,1
"@@ -0,0 +1,17 @@
+require ""rails_helper""
+
+feature ""Subscriber switches to discounted subscription"" do
+  scenario ""by accepting alternate offer"" do
+    discounted_annual_plan = create(:discounted_annual_plan)
+
+    sign_in_as_user_with_subscription
+    visit my_account_path
+    click_link I18n.t(""subscriptions.cancel"")
+    click_button I18n.t(""subscriptions.accept_discounted_annual_subscription"")
+
+    expect(page).to(
+      have_content(I18n.t(""subscriptions.flashes.discount.success""))
+    )
+    expect(@current_user.reload.plan).to eq discounted_annual_plan
+  end
+end",Line is too long. [82/80],rb,1,1,1
"@@ -63,6 +63,17 @@ module Beaker
         raise ""Unable to create OpenStack Network instance (api_key: #{@options[:openstack_api_key]}, username: #{@options[:openstack_username]}, auth_url: #{@options[:openstack_auth_url]}, tenant: #{@options[:openstack_tenant]})""
       end
 
+      # Validate openstack_volume_support setting value, reset to boolean if passed via ENV value string
+      if not @options[:openstack_volume_support].is_a?(TrueClass) || @options[:openstack_volume_support].is_a?(FalseClass)
+        if @options[:openstack_volume_support].match(/\btrue\b/i)
+          @options[:openstack_volume_support] = true
+        elsif @options[:openstack_volume_support].match(/\bfalse\b/i)
+          @options[:openstack_volume_support] = false
+        else
+          raise ""Invalid value provided for CONFIG setting openstack_volume_support, current value #{@options[:openstack_volume_support]}""
+        end
+      end
+
     end
 
     #Provided a flavor name return the OpenStack id for that flavor","@ipcrm this seems like an awful lot of work for what you're trying to get at. Is there some use case where a string or something like that must be passed in, so you can't just rely on this being of type `TrueClass` or `FalseClass`? We would prefer to rely on people setting the yaml correctly and failing on the case when people have set the wrong type for these. That keeps the code here simple, and in places like hypervisors or parsers, it's not a lot of wasted time to fail since things are just getting started. also, it seems to be the case that if someone passed in a `FalseClass` `false` value, this wouldn't set the `@options[:openstack_volume_support]` value correctly, would it? I would imagine the outer if statement would need an else case to take care of that, no?",rb,0,1,0
"@@ -16,6 +16,10 @@ class Topic < ActiveRecord::Base
 
   friendly_id :name, use: [:slugged, :finders]
 
+  def self.explorable
+    where(explorable: true)
+  end
+
   def to_s
     name
   end","I don't see this mentioned in the PR description. What does ""explorable"" mean?",rb,0,1,1
"@@ -190,6 +190,9 @@ class Purchase < ActiveRecord::Base
       full_price = purchaseable.send(:""#{variant}_price"")
       if coupon
         coupon.apply(full_price)
+      elsif stripe_coupon_id.present?
+        subscription_coupon = SubscriptionCoupon.new(stripe_coupon_id)
+        subscription_coupon.apply(full_price)
       else
         full_price
       end","After doing the Prime launch, I think refactoring `Purchase` would a good way to spend time while we collect post-launch data. Getting this `if` statement out using dependency injection would help remove some complexity.",rb,1,1,1
"@@ -8,6 +8,7 @@ class UserRolesController < ApplicationController
   before_action :require_valid_role
   before_action :not_in_role, :only => [:grant]
   before_action :in_role, :only => [:revoke]
+  before_action :not_revoke_admin_current_user
 
   def grant
     @this_user.roles.create(:role => @role, :granter => current_user)",This should only be applied to the `revoke` method but in fact this is so specific that I don't think there's any point making it a filter - the point of filters is that they can be shared across multiple methods but these even has the method name in it's name so clearly it only ever makes sense to apply it to revoke. As such I would just put the logic in the `revoke` method and get rid of the filter.,rb,1,1,1
"@@ -4,12 +4,11 @@ module Ncr
     MAX_UPLOADS_ON_NEW = 10
 
     def new
-      @approver_email = self.suggested_approver_email
+      @model_instance.approving_official_email = self.suggested_approver_email
       super
     end
 
     def create
-      @approver_email = params[:approver_email]
       super
     end
 ",I tend to use `self` for class methods only - thoughts on just using `suggested_approver_email` here?,rb,1,1,1
"@@ -10,4 +10,9 @@ module FeatureSpecHelper
     setup_mock_auth(:myusa, user)
     visit '/auth/myusa'
   end
+
+  def focus_field(field_id)
+    execute_script ""document.getElementById('#{field_id}').scrollIntoView()""
+    execute_script ""$('##{field_id}').focus()""
+  end
 end","since we'er only using this method once right now, I'd suggest putting it in the spec file where it is being used. Easier to check it out that way!",rb,1,1,1
"@@ -0,0 +1,13 @@
+require 'travis/build/appliances/base'
+
+module Travis
+  module Build
+    module Appliances
+      class AddGithubHostKey < Base
+        def apply
+          sh.raw %(grep '^github\\.com,' ~/.ssh/known_hosts >&/dev/null || echo 'github.com,204.232.175.90 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==' >> ~/.ssh/known_hosts)
+        end
+      end
+    end
+  end
+end",Can you use `ssh-keyscan` instead of a hardcoded key?,rb,1,1,1
"@@ -57,8 +57,7 @@ class TestFakerInternetOmniauth < Test::Unit::TestCase
     auth                  = @tester.google(name: custom_name)
     info                  = auth[:info]
     extra_raw_info        = auth[:extra][:raw_info]
-    id_info               = auth[:id_info]
-
+    
     assert_instance_of String, info[:name]
     assert_equal 2, word_count(info[:name])
     assert_equal custom_name, info[:name]",These variables are not being used. Why are we still declaring them? Copy and   again?,rb,1,1,1
"@@ -0,0 +1,19 @@
+require_relative ""../../../db/chores/roles_conversion""
+
+describe RolesConversion do
+  describe ""#ncr_budget_approvers"" do
+    it ""should convert NCR budget approvers"" do
+      expect {
+        RolesConversion.new.ncr_budget_approvers
+      }.to_not change { User.count }
+    end
+
+    it ""should be idempotent based on client_slug+role"" do
+      with_env_var('NCR_BA61_TIER1_BUDGET_MAILBOX', 'someoneelse@example.com') do
+        expect {
+          RolesConversion.new.ncr_budget_approvers
+        }.to_not change { User.count }
+      end
+    end
+  end
+end",this seems brittle. what happens when we (inevitably) reorganize the file structure of the tests?,rb,1,1,1
"@@ -2,7 +2,7 @@
   tool_name = Rails.configuration.branding[:application][:name]
   link = accept_invitation_url(@resource, :invitation_token => @token)
   helpdesk_email = Rails.configuration.branding[:organisation][:helpdesk_email]
-  contact_us_url = Rails.configuration.branding[:organisation][:contact_us_url] || contact_us_url
+  contact_us = (Rails.configuration.branding[:organisation][:contact_us_url] || contact_us_url)
   email_subject = _('Query or feedback related to %{tool_name}') %{ :tool_name => tool_name }
 %>
 <% FastGettext.with_locale FastGettext.default_locale do %>","thanks for changing it, the rename is for sure safer!",rb,1,0,1
"@@ -27,7 +27,7 @@ describe 'episodes/index.xml.builder' do
     end
 
     it 'has an updated date of the most recently published episode' do
-      @xml.css('channel pubDate').first.text.should == 1.day.ago.xmlschema.to_s
+      @xml.css('channel pubDate').first.text.should == 1.day.ago.to_s(:rfc822)
     end
 
     it 'includes both episodes' do",Its unfortunate that the previous tests didn't catch the incorrect format because we're just testing against itself. This change has the same problem. Do you think it'd be better to actually check the string has the right format more manually?,rb,1,1,1
"@@ -6,6 +6,15 @@ RSpec.describe RSpec::Core::Formatters::BaseFormatter do
   let(:output)    { StringIO.new }
   let(:formatter) { RSpec::Core::Formatters::BaseFormatter.new(output) }
 
+  describe '#notifications' do
+    it 'knows which notifications it responds to' do
+      expect(formatter.notifications).to eq([
+        :start, :example_group_started, :example_started, :example_pending,
+        :example_failed, :dump_summary, :close
+      ])
+    end
+  end
+
   describe ""read_failed_line"" do
     it ""deals gracefully with a heterogeneous language stack trace"" do
       exception = double(:Exception, :backtrace => [",This exact list seems to make for a brittle spec. What value do you find in listing them all out here? It's duplicating what's already in the `notifications` method...,rb,1,1,1
"@@ -146,7 +146,7 @@ module RSpec::Core
       # Returns the message generated for this failure line by line.
       #
       # @return [Array(String)] The example failure message
-      def message_lines
+      def message_lines(default_color_proc=lambda {|x| x })
         @lines ||=
           begin
             lines = [""Failure/Error: #{read_failed_line.strip}""]",This seems more convoluted then what you had before :(. @JonRowe -- can you suggest a way to do this that you'd be satisfied with?,rb,0,0,1
"@@ -13,6 +13,7 @@ module Beaker
 
       aws
     }
+    let( :options ) { make_opts.merge({ 'logger' => double().as_null_object }) }
     let(:amispec) {{
       ""centos-5-x86-64-west"" => {
         :image => {:pe => ""ami-sekrit1""},","Your spacing style differs from the rest of the file, see the ( :options ) you have here. I can see it in other places in the patch.",rb,0,1,1
"@@ -4,7 +4,7 @@ MYUSA_URL = ENV['MYUSA_URL'] || 'https://alpha.my.usa.gov'
 
 Rails.application.config.middleware.use OmniAuth::Builder do
   provider :myusa, MYUSA_KEY, MYUSA_SECRET, {
-    scope: 'profile.email',
+    scope: 'profile.email profile.first_name profile.last_name',
     client_options: {
       site: MYUSA_URL,
       token_url: ""/oauth/authorize""",That Was Easy:tm:,rb,0,0,1
"@@ -110,7 +110,7 @@ describe RSpec::Core::Formatters::BaseTextFormatter do
     context 'for #share_examples_for' do
       it 'outputs the name and location' do
 
-        share_examples_for 'foo bar' do
+        group.share_examples_for 'foo bar' do
           it(""example name"") { expect(""this"").to eq(""that"") }
         end
 ",Why the need to change from `share_examples_for` to `group.share_examples_for` here and elsewhere? It suggests that you've made this much more of a breaking change...,rb,1,1,1
"@@ -4,3 +4,5 @@
 
 <%= t(""mailer.cancelation_mailer.cta"") %>
 <%= proposal_url(@proposal) %>
+
+<%= t(""mailer.footer"", feedback_url: feedback_url) %>",Just to make sure - This is a template that needs a second pass right? The footer is a part of the actual base template again.,rb,1,1,1
"@@ -1,6 +1,8 @@
 module EnvironmentSpecHelper
   # @todo rewrite using with_env_vars
   def with_18f_procurement_env_variables
+    ENV['DISABLE_SANDBOX_WARNING'] = 'true'
+
     old_approver_email = ENV['GSA18F_APPROVER_EMAIL']
     old_purchaser_email = ENV['GSA18F_PURCHASER_EMAIL']
 ","I know you were just following what the rest of the rest of the method is doing, but mind converting all of them to use `with_env_vars`?",rb,1,1,1
"@@ -201,6 +201,9 @@ r lw(\n(.lu*75u/100u).'
         result << %(.sp
 #{counter}. #{manify terms.map {|dt| dt.text }.join ' '}
 .RS 4)
+      when 'horizontal'
+        result << %(.TP
+#{manify terms.map {|dt| dt.text }.join(', '), whitespace: :normalize})
       else
         result << %(.sp
 #{manify terms.map {|dt| dt.text }.join(', '), whitespace: :normalize}",I tried this and it doesn't seem to have any effect. Can you clarify how the TP macro works?,rb,1,1,1
"@@ -544,7 +544,7 @@ module RSpec
       def reporter
         @reporter ||= begin
                         add_formatter('progress') if formatters.empty?
-                        add_formatter(RSpec::Core::Formatters::DeprecationFormatter, deprecation_stream, output_stream)
+                        formatters << RSpec::Core::Formatters::DeprecationFormatter[deprecation_stream, output_stream]
                         Reporter.new(*formatters)
                       end
       end",Wait what are the `[` brackets doing here?,rb,1,1,1
"@@ -1,7 +1,5 @@
 class Exercise < ActiveRecord::Base
-  has_many :classifications, as: :classifiable, dependent: :destroy
   has_many :statuses, as: :completeable, dependent: :destroy
-  has_many :topics, through: :classifications
   has_one :trail, through: :step, as: :completeables
   has_one :step, dependent: :destroy, as: :completeable
 ",Should we have a migration to delete classification data for exercises? Is there any?,rb,1,1,1
"@@ -4,18 +4,6 @@
     <h1 id=""project_title"">The Communicart for Common Acquisition Platform</h1>
   </div>
   <div class=""home-main-body"">
-        <% unless signed_in? %>
-        <div class=""lightbox"">
-            <div class=""needs-auth"">
-              <h3>Please sign in</h3>
-              <p>In order to view this page, you'll need to sign in with a MyUSA account.</p>
-              <link href='//fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
-              <link href='//s3.amazonaws.com/myusa-static/button.min.css' rel='stylesheet' type='text/css'>
-              <%= link_to 'Connect with MyUSA', ""/auth/myusa"", :class => 'btn btn-social btn-myusa' %>
-            </div>
-        </div>
-        <% end %>
-
       <div class=""row"">
         <div class=""col-sm-12"">
           <h2 id=""project_tagline"">&quot;P-Card holders deserve easy, modern, automated management of their shopping carts.&quot;</h2>",Can we get rid of the lightbox JS/CSS if we're not using it?,rb,1,1,1
"@@ -322,9 +322,13 @@ HELP
 
     def execute_plan(options)
       Bolt.config = options
-      result = run_plan(options[:object],
-                        options[:task_options],
-                        options[:modules])
+      begin
+        result = run_plan(options[:object],
+                          options[:task_options],
+                          options[:modules])
+      rescue Puppet::Error
+        raise Bolt::CLIError, ""Exiting because of an error in Puppet code""
+      end
       puts result
     end
 ",if you raise Bolt::CLIError here it will also set a failure exit code,rb,1,1,1
"@@ -0,0 +1,18 @@
+#!/usr/bin/env ruby
+# frozen_string_literal: true
+
+def facter_executable
+  if ENV.key? 'Path'
+    ENV['Path'].split(';').each do |p|
+      if p =~ /Puppet\\bin\\?$/
+        return File.join(p, 'facter')
+      end
+    end
+    'C:\Program Files\Puppet Labs\Puppet\bin\facter'
+  else
+    '/opt/puppetlabs/puppet/bin/facter'
+  end
+end
+
+# Delegate to facter
+exec(facter_executable, '--json')","I want to double check this works, but this all makes sense to me.",rb,1,1,1
"@@ -509,7 +509,8 @@ module Blacklight::SolrHelper
     # override any field-specific default in the solr request handler. 
     solr_params[:""f.#{facet_field}.facet.limit""]  = limit + 1
     solr_params[:""f.#{facet_field}.facet.offset""] = ( input.fetch(Blacklight::Solr::FacetPaginator.request_keys[:page] , 1).to_i - 1 ) * ( limit )
-    solr_params[:""f.#{facet_field}.facet.sort""] = input[  Blacklight::Solr::FacetPaginator.request_keys[:sort] ] if  input[  Blacklight::Solr::FacetPaginator.request_keys[:sort] ]   
+    solr_params[:""f.#{facet_field}.facet.sort""] = input[  Blacklight::Solr::FacetPaginator.request_keys[:sort] ] if  input[  Blacklight::Solr::FacetPaginator.request_keys[:sort] ]
+    solr_params[:""f.#{facet_field}.facet.prefix""] = input.fetch(Blacklight::Solr::FacetPaginator.request_keys[:prefix] , """") 
     solr_params[:rows] = 0
 
     return solr_params","I think it'd be better not to send the facet.prefix at all, if no prefix is required (although I supposed solr probably checks if the string is null or empty when applying defaults?)",rb,1,1,1
"@@ -163,8 +163,10 @@ module Blacklight::FacetsHelperBehavior
   # @option options [Array<String>]  an array of classes to add to count span.
   # @return [String]
   def render_facet_count(num, options = {})
-    classes = (options[:classes] || []) << ""facet-count""
-    content_tag(""span"", t('blacklight.search.facets.count', :number => number_with_delimiter(num)), :class => classes)
+    classes = (options[:classes] || [])
+    content_tag(""div"", :class => ""facet-count"") do
+      content_tag(""span"", t('blacklight.search.facets.count', :number => number_with_delimiter(num)), :class => classes)
+    end
   end
   
   ##",What benefit does the new `div` give us?,rb,1,1,1
"@@ -1,5 +1,5 @@
 # Load the Rails application.
-require File.expand_path('../application', __FILE__)
+require_relative 'application'
 
 # Initialize the Rails application.
-Upcase::Application.initialize!
+Rails.application.initialize!",Style/StringLiterals: Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,0,1,1
"@@ -1,13 +1,13 @@
 class Loader
   def self.import_articles_and_topics(posts)
     posts.each do |post|
+      next if post[:tags].include?(""this week in open source"")
       article = Article.find_or_initialize_by_title_and_published_on(post[:title],post[:published_at])
       unless article.persisted?
         article.body_html = post[:body_html]
         article.tumblr_url = post[:tumblr_url]
         article.save!
         post[:tags].each do |tag|
-          puts tag.downcase
           topic = Topic.find_by_slug(tag.downcase.parameterize)
           if topic.nil?
             topic = Topic.new",Can we make this more generic and create an array of potential tags to be excluded from the import? There will be more.,rb,1,1,1
"@@ -0,0 +1,13 @@
+ActiveAdmin.register ScheduledReport do
+  permit_params :name, :report_id, :frequency, :user_id
+
+  form do |f|
+    f.inputs ""Scheduled Report"" do
+      f.input :name
+      f.input :report
+      f.input :user
+      f.input :frequency, as: :select, collection: [""daily"", ""weekly"", ""monthly""]
+    end
+    f.actions
+  end
+end",should we clarify in the UI when each of these types of reports is sent out?,rb,1,1,1
"@@ -64,6 +64,19 @@ describe ""when running a plan that manipulates an execution result"", ssh: true d
       end
     end
 
+    context 'with $future flag' do
+      it 'exposes `status` method for result and renames `result` to `value`' do
+        with_tempfile_containing('conf', { future: true }.to_json) do |conf|
+          params = { nodes: uri }.to_json
+          additional_flags = config_flags + ['--configfile', conf.path.to_s]
+          result = run_cli(['plan', 'run', 'results::test_result', ""--params"", params] + additional_flags)
+          expect(@log_output.readlines)
+            .to include(""NOTICE  Puppet : Result status: success\n"")
+          expect(JSON.parse(result).first).to include('value')
+        end
+      end
+    end
+
     it 'exposes errrors for results' do
       params = { target: uri }.to_json
       output = run_cli(['plan', 'run', 'results::test_error', ""--params"", params] + config_flags)",We should update run_cli to unset `$future`,rb,1,1,1
"@@ -378,6 +378,18 @@ describe RSpec::Core::ConfigurationOptions, :isolated_directory => true, :isolat
       expect(parse_options[:formatters]).to eq([['local']])
     end
 
+    it ""parses options file correctly if erb code has trimming options"" do
+      File.open(""./.rspec"", ""w"") do |f|
+        f << ""<% if 1 == 1 -%>\n""
+        f << ""--format local\n""
+        f << ""<%- end %>\n""
+      end
+
+      expect do
+        expect(parse_options[:formatters]).to eq([['local']])
+      end.to_not raise_error(SyntaxError)
+    end
+
     context ""with custom options file"" do
       it ""ignores project and global options files"" do
         File.open(""./.rspec"", ""w"") {|f| f << ""--format project""}","`if 1 == 1` seems like a convulated way to have an `if true` conditional...any reason not to just use `if true`? That more clearly states the intention, I think.",rb,1,1,1
"@@ -40,6 +40,9 @@ module Travis
             sh.cmd 'CURL_USER_AGENT=""Travis-CI $(curl --version | head -n 1)""'
             case config[:os]
             when 'linux'
+              if config[:julia] == 'nightly' && config[:arch] == 'arm64'
+                sh.failure 'Nightly Julia binaries are not available for AArch64'
+              end
               sh.cmd 'mkdir -p ~/julia'
               sh.cmd %Q{curl -A ""$CURL_USER_AGENT"" -s -L --retry 7 '#{julia_url}' } \
                        '| tar -C ~/julia -x -z --strip-components=1 -f -'",Is this a typo?,rb,1,0,1
"@@ -327,6 +327,16 @@ class FirefoxProfile(object):
                     rc.append(node.data)
             return ''.join(rc).strip()
 
+        def parse_manifest_json(content):
+            """"""Extracts the details from the contents of a WebExtensions `manifest.json` file.""""""
+            manifest = json.loads(content)
+            return {
+                'id': manifest['applications']['gecko']['id'],
+                'version': manifest['version'],
+                'name': manifest['version'],
+                'unpack': False,
+            }
+
         if not os.path.exists(addon_path):
             raise IOError('Add-on path does not exist: %s' % addon_path)
 ",The id is not mandatory for web extensions. Could you update this to support a web extension without an id?,rb,1,1,1
"@@ -9,10 +9,15 @@ FactoryGirl.define do
     rwa_number ""R1234567"" # TODO remove, since it's not applicable for BA61
     org_code Ncr::Organization.all[0].to_s
     project_title ""NCR Name""
+    sequence(:approving_official_email) {|n| ""approver#{User.count}@some-cartoon-show.com"" }
     association :proposal, flow: 'linear'
 
     trait :with_approvers do
+      # TODO use wo.setup_approvals_and_observers instead
       association :proposal, :with_serial_approvers, flow: 'linear'
+      after :create do |wo|
+        wo.approving_official_email = wo.approving_official.email_address
+      end
     end
 
     trait :is_emergency do",PT story for this?,rb,0,0,0
"@@ -95,6 +95,16 @@ module Rails
         end
       end
 
+      # Expose database runtime to controller for logging.
+      initializer ""mongoid.log_runtime"" do
+        require ""mongoid/railties/controller_runtime""
+        ActiveSupport.on_load(:action_controller) do
+          include ::Mongoid::Railties::ControllerRuntime
+        end
+      end
+
+
+
       config.after_initialize do
         # Unicorn clears the START_CTX when a worker is forked, so if we have
         # data in START_CTX then we know we're being preloaded. Unicorn does",:scissors: empty spaces please.,rb,1,1,0
"@@ -40,7 +40,7 @@ public class BazelBuild {
     if (target == null || """".equals(target)) {
       throw new IllegalStateException(""No targets specified"");
     }
-    log.info(""\nBuilding "" + target + "" ..."");
+    log.finest(""\nBuilding "" + target + "" ..."");
 
     ImmutableList.Builder<String> builder = ImmutableList.builder();
     builder.add(""bazel"", ""build"", target);",This is to let people know that the tooling is doing something during a build. Please leave.,rb,1,1,1
"@@ -37,11 +37,10 @@ class Proposal < ActiveRecord::Base
   visitable # Used to track user visit associated with processed proposal
 
   has_many :steps
-  has_many :individual_steps, ->{ individual }, class_name: ""Steps::Individual""
   has_many :approval_steps, class_name: ""Steps::Approval""
   has_many :purchase_steps, class_name: ""Steps::Purchase""
-  has_many :completers, through: :individual_steps, source: :completer
-  has_many :api_tokens, through: :individual_steps
+  has_many :completers, through: :steps, source: :completer
+  has_many :api_tokens, through: :steps
   has_many :attachments, dependent: :destroy
   has_many :comments, -> { order(created_at: :desc) }, dependent: :destroy
 ",does this need a scope to `individual` -- the parent (root) step will never have a completer.,rb,1,1,1
"@@ -626,6 +626,8 @@ context 'Substitutions' do
       assert_equal %q{<a href=""mailto:author+website@4fs.no"">author+website@4fs.no</a>}, para.sub_macros(para.source)
       para = block_from_string('john@domain.uk.co')
       assert_equal %q{<a href=""mailto:john@domain.uk.co"">john@domain.uk.co</a>}, para.sub_macros(para.source)
+      para = block_from_string('bert&ernie@sesamestreet.com')
+      assert_equal %q{<a href=""mailto:bert&amp;ernie@sesamestreet.com"">bert&amp;ernie@sesamestreet.com</a>}, para.apply_subs(para.source)
     end
 
     test 'should ignore escaped inline email address' do",For a second I read Bernie! Feel the Bern,rb,0,0,0
"@@ -201,7 +201,9 @@ module RSpec
         attr_reader :example
 
         Example.public_instance_methods(false).each do |name|
-          define_method(name) { |*a, &b| @example.__send__(name, *a, &b) }
+          unless name.to_sym == :run
+            define_method(name) { |*a, &b| @example.__send__(name, *a, &b) }
+          end
         end
 
         Proc.public_instance_methods(false).each do |name|","I tend to prefer using a `next` guard clause, but that's just subjective preference :). Not a merge blocker.",rb,0,0,1
"@@ -449,7 +449,11 @@ module Beaker
             if host.is_pe?
               bounce_service( host, 'pe-httpd' )
             else
-              stop_puppet_from_source_on( host ) if puppet_master_started
+              if puppet_master_started
+                stop_puppet_from_source_on( host )
+              else
+                dump_puppet_log(host)
+              end
             end
 
           rescue Exception => teardown_exception",If I understand this correctly `puppet_master_started` won't be set if backing up the puppet.conf or laying down the new puppet.conf errors and so in those cases there will always be a `teardown_exception` of `NoMethodError`. Does that seem correct? I think we should probably initialize `puppet_master_started` to `false` before the begin block if my reading of this is correct.,rb,1,1,1
"@@ -0,0 +1,14 @@
+MAIL_SETTINGS = {
+  :address        => 'smtp.sendgrid.net',
+  :port           => '587',
+  :authentication => :plain,
+  :user_name      => ENV['SENDGRID_USERNAME'],
+  :password       => ENV['SENDGRID_PASSWORD'],
+  :domain         => 'heroku.com'
+}
+
+if ENV[""EMAIL_RECIPIENTS""]
+  Mail.register_interceptor(
+    RecipientInterceptor.new(ENV.fetch(""EMAIL_RECIPIENTS""))
+  )
+end",Put a comma after the last parameter of a multiline method call.,rb,1,1,1
"@@ -4,10 +4,9 @@
     <!-- if the user has projects -->
     <p>
       <% if @plans.count > 0 %>
-        <%= _('The table below lists the plans that you have created, and any that have been shared with you by others.') %><br />
-        <%= _('These can be edited, shared, exported or deleted at anytime.')%>
+        <%= _('The table below lists the plans that you have created, and that have been shared with you by others. You can edit, share, download, make a copy, or remove these plans at any time.')%>
       <% else %>
-        <strong><%= _(""Welcome."") %></strong><br />
+        <strong><%= _(""Welcome"") %></strong><br />
         <%= _(""You are now ready to create your first DMP."") %><br />
         <%= _(""Click the 'Create plan' button below to begin."")%>
       <% end %>",not sure when this got merged but we should get the habit of using length instead of count to avoid an extra query,rb,1,1,1
"@@ -29,7 +29,7 @@ import org.openqa.selenium.remote.service.DriverService;
  *
  * @see <a href=""https://chromium.googlesource.com/chromium/src/+/master/chrome/test/chromedriver/client/command_executor.py"">List of ChromeWebdriver commands</a>
  */
-class ChromeDriverCommandExecutor extends DriverCommandExecutor {
+public class ChromeDriverCommandExecutor extends DriverCommandExecutor {
 
   private static final ImmutableMap<String, CommandInfo> CHROME_COMMAND_NAME_TO_URL = ImmutableMap.of(
       ChromeDriverCommand.LAUNCH_APP,",This states very clearly that this is a derivative of Chrome and not Chromium. Do we need to extract an abstract `ChromiumCommandExecutor` and have both Edge and Chrome derive from that?,rb,1,1,1
"@@ -5,10 +5,14 @@ class AuthController < ApplicationController
   def oauth_callback
     auth = request.env[""omniauth.auth""]
     return_to_path = fetch_return_to_path
-    do_user_auth(auth)
-    session[:token] = auth.credentials.token
-    flash[:success] = ""You successfully signed in""
-    redirect_to return_to_path || proposals_path
+    begin
+      do_user_auth(auth)
+      session[:token] = auth.credentials.token
+      flash[:success] = ""You successfully signed in""
+      redirect_to return_to_path || proposals_path
+    rescue => _error
+      render :failure
+    end
   end
 
   def failure",is it possible to rescue a particular error rather than any error? Ideally we do not rescue all errors so we can surface errors we care about and rescue those we want to ignore.,rb,1,1,1
"@@ -3,7 +3,7 @@
 
 # Purpose:
 # sns-ruby-example-create-topic.rb demonstrates how to create an Amazon Simple Notification Services (SNS) topic using
-# the AWS SDK for JavaScript (v3).
+# the AWS SDK for Ruby.
 
 # Inputs:
 # - REGION",Simple Notification **Service** (singular),rb,0,0,0
"@@ -1,10 +1,13 @@
 # Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 # SPDX - License - Identifier: Apache - 2.0
 
+# Purpose
+# This code example demonstrates how to configure an Amazon Simple Storage Solution (Amazon S3) bucket as a static website.
+
+# snippet-start:[s3.s3_ruby_bucket_website.rb]
+
 require 'aws-sdk-s3'
 
-# Configures an Amazon S3 bucket as a static website.
-#
 # Prerequisites:
 #
 # - An Amazon S3 bucket.",Simple Storage **Service**,rb,0,0,0
"@@ -12,6 +12,9 @@
     <h2 class=""parent-collection"">
       <%= link_to @video.watchable_name, @video.watchable %>
     </h2>
+    <h3 class=""page-header__time-to-complete"">
+      <%= ""#{@video.length_in_minutes} minutes"" %>
+    </h3>
   </header>
 <% end %>
 ","Do we want to wrap this block with `video.show_timing?`. Tbh I'm okay with the video length on all videos, so maybe we don't need `video.show_timing?` at all? I do still want to limit showing the trail timing to the RoR5 trail, since our exercise time estimate isn't precise and it seems like a less expected feature",rb,1,1,1
"@@ -201,6 +201,14 @@ module RSpec
           end
         end
 
+        # Just like `subject`, except the block is invoked by an implicit `before`
+        # hook. This serves a dual purpose of setting up state and providing a
+        # memoized reference to that state.
+        def subject!(name=nil, &block)
+          subject(name, &block)
+          before { __send__(:subject) }
+        end
+
         attr_reader :explicit_subject_block
 
         private",It'd be good to have full yard docs for this....care to take a stab at that?,rb,1,1,1
"@@ -7,3 +7,9 @@ get(
   as: :book,
   constraints: LicenseableConstraint.new(Book)
 )
+
+get '/backbone-js-on-rails' => redirect('https://gumroad.com/l/backbone-js-on-rails')
+get '/geocoding-on-rails' => redirect('https://gumroad.com/l/geocoding-on-rails')
+get '/ios-on-rails' => redirect('https://gumroad.com/l/ios-on-rails')
+get '/ios-on-rails-beta' => redirect('https://gumroad.com/l/ios-on-rails')
+get '/ruby-science' => redirect('https://gumroad.com/l/ruby-science')",I actually think this is `ios-on-rails-beta`,rb,1,0,1
"@@ -4,6 +4,12 @@
 <div class=""text-box-wrapper"">
   <div class=""text-box"">
     <p>Thank you for purchasing <%= @purchaseable.name %>.</p>
+
+    <% if subscription = current_user.subscription and !subscription.active? %>
+      <p>It appears you stopped subscribing to <%= @purchaseable.name %> on
+      <%= l subscription.deactivated_on, format: :long %>. If you would like
+      to resubscribe, please <%= mail_to 'learn@thoughtbot.com', 'contact us' %>.</p>
+    <% end %>
   </div>
 </div>
 ",What do you think about extracting this conditional into a method?,rb,1,1,1
"@@ -47,7 +47,7 @@ public class DeleteNamedQueryExample {
             System.exit(1);
         }
 
-        String name = args[0];
+        String name =""sampleQuery"" ;  //args[0];
         AthenaClient athenaClient = AthenaClient.builder()
                 .region(Region.US_WEST_2)
                 .build();",Did you intend to ignore the command line arg?,rb,1,1,1
"@@ -93,6 +93,19 @@ describe TeamPlan do
     end
   end
 
+  describe '#fulfill' do
+    it 'starts a subscription' do
+      user = build_stubbed(:user)
+      purchase = build_stubbed(:purchase, user: user)
+      plan = build_stubbed(:team_plan)
+      fulfillment = stub_subscription_fulfillment(purchase)
+
+      plan.fulfill(purchase, user)
+
+      expect(fulfillment).to have_received(:fulfill)
+    end
+  end
+
   def team_plan
     build(:team_plan)
   end",Looks like one more instance of the method pointed out above.,rb,0,0,1
"@@ -1848,7 +1848,7 @@ function fullyResolveKeys(obj) {
  * If there are no listeners registered with the flow, the error will be
  * rethrown to the global error handler.
  *
- * Refer to the {@link ./promise} module documentation fora  detailed
+ * Refer to the {@link ./promise} module documentation for a  detailed
  * explanation of how the ControlFlow coordinates task execution.
  *
  * @final",there is still `2` spaces after `a` here.. :P,rb,1,1,1
"@@ -1,4 +1,5 @@
 module Reverification
+  # rubocop:disable ClassLength
   class Process
     PILOT_AMOUNT = 5000
     class << self","Would be great, if we can avoid disabling/enabling the `ClassLength`",rb,1,1,1
"@@ -0,0 +1,18 @@
+# frozen_string_literal: true
+
+require 'bolt/error'
+require 'bolt/config/transport'
+
+module Bolt
+  class Config
+    class Sudoable < Transport
+      private def validate
+        run_as_cmd = config['run-as-command']
+        if run_as_cmd && (!run_as_cmd.is_a?(Array) || run_as_cmd.any? { |n| !n.is_a?(String) })
+          raise Bolt::ValidationError,
+                ""run-as-command must be an Array of Strings, received #{run_as_cmd.class} #{run_as_cmd.inspect}""
+        end
+      end
+    end
+  end
+end","I don't think this class provides enough value to be worth the extra complexity, especially since it's only performing half its job (it should also be _defining_ the options associated with `sudo` not just validating them).",rb,1,1,1
"@@ -8,9 +8,17 @@ class TemplatePolicy < ApplicationPolicy
   end
   
   def index?
-    user.can_super_admin? || user.can_modify_templates?
+    user.can_super_admin?
   end
 
+  def organisational?
+    user.can_modify_templates?
+  end
+  
+  def customisable?
+    user.can_modify_templates?
+  end
+  
   def new?
     user.can_super_admin? || user.can_modify_templates?
   end",org_admins should not see index page?,rb,1,1,1
"@@ -0,0 +1,9 @@
+FactoryGirl.define do
+  factory :twelve_month_summary do
+    association :analysis
+    affiliated_committers_count 2
+    affiliated_commits_count 2
+    outside_committers_count 2
+    outside_commits_count 2
+  end
+end",Why all the count attributes set to static values? Shouldn't these be random?,rb,1,1,0
"@@ -77,14 +77,16 @@ module Beaker
       # @return [Result]   An object representing the outcome of *command*.
       # @raise  [FailTest] Raises an exception if *command* obviously fails.
       def on(host, command, opts = {}, &block)
-        unless command.is_a? Command
+        block_on host do | host |
+          if command.is_a? Command
+            command = command.cmd_line(host)
+          end
           cmd_opts = {}
+          #add any additional environment variables to the command
           if opts[:environment]
             cmd_opts['ENV'] = opts[:environment]
           end
           command = Command.new(command.to_s, [], cmd_opts)
-        end
-        block_on host do | host |
           @result = host.exec(command, opts)
 
           # Also, let additional checking be performed by the caller.","I understand that `Beaker::Command` is in scope here as `Command` and that it is relatively common to use the unqualified in-scope name of a class/module both in the Ruby community and in Beaker, but I am curious if you are aware of any reasons not to use the fully-qualified version? I personally prefer less ambiguity where possible, but I'm not suggesting a change should be made--just interested in discussion about coding conventions within Beaker.",rb,1,1,0
"@@ -22,7 +22,7 @@ feature 'Visitor updates password' do
     visit_password_reset_page_for user
     change_password_to ''
 
-    page.should have_content I18n.t('flashes.failure_after_update')
+    expect(page).to have_content I18n.t('flashes.failure_after_update')
     user_should_be_signed_out
   end
 ",Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.,rb,1,1,1
"@@ -37,6 +37,12 @@ module Selenium
         def bridge_class
           Bridge
         end
+
+        def print_page(**options)
+          options[:page_ranges] &&= Array(options[:page_ranges])
+
+          bridge.print_page(options)
+        end
       end # Driver
     end # Firefox
   end # WebDriver",Same here. and all others.,rb,0,0,0
"@@ -0,0 +1,7 @@
+describe Searchable do
+  describe "".rebuild_index"" do
+    it ""should rebuild the index"" do
+      expect(Proposal.rebuild_index).not_to raise
+    end
+  end
+end",should probably `create(:proposal)` here at least once so there is something to index.,rb,1,1,1
"@@ -520,6 +520,12 @@ webdriver.WebDriver.prototype.call = function(fn, opt_scope, var_args) {
  * Schedules a command to wait for a condition to hold, as defined by some
  * user supplied function. If any errors occur while evaluating the wait, they
  * will be allowed to propagate.
+ *
+ * <p>In the event a condition returns a Promise, the polling loop will wait 
+ * for it to be resolved and use the resolved value for evaluating whether the
+ * condition has been satisfied. The resolution time for a promise is factored
+ * into whether a wait has timed out.
+ *
  * @param {function():boolean} fn The function to evaluate as a wait condition.
  * @param {number} timeout How long to wait for the condition to be true.
  * @param {string=} opt_message An optional message to use if the wait times",Will you link to {!webdriver.promise.Promise} here?,rb,1,1,1
"@@ -9,9 +9,7 @@ module Beaker
     |   V   |
     |   |   | ""
 
-    attr_reader :options, :logger
-
-
+    attr_reader :logger, :options, :network_manager
     def initialize
       @timestamp = Time.now
       # Initialize a logger object prior to parsing; this should be overwritten whence",I'm also pretty sure that we no longer need to have this as a readable class var.,rb,0,1,1
"@@ -13,7 +13,7 @@ module Beaker
     SLEEPWAIT = 5
     TRIES = 5
     UNIX_PACKAGES = ['curl', 'ntpdate']
-    FREEBSD_PACKAGES = ['curl']
+    FREEBSD_PACKAGES = ['curl', 'perl5']
     WINDOWS_PACKAGES = ['curl']
     PSWINDOWS_PACKAGES = []
     SLES10_PACKAGES = ['curl']","Not sure how neccesary this is, as perl is included by default on all bsd builds apparently, but cant hurt (only takes a few secs to check it)",rb,1,1,1
